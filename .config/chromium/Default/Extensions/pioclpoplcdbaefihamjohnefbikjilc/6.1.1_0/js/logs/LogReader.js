function LogReader(p){function q(b){b.length?(e=b,m.readEntries(q,r)):p()}function r(){log.error("Error reading log directory.");p()}function n(b,d){if(e.length)if(f==e.length){if("arraybuffer"===d){for(var a=new Uint8Array(h),k=0,g=0;g<c.length;g++)a.set(new Uint8Array(c[g]),k),k+=c[g].byteLength;c=a.buffer}b(c);f=0;c="";l=!1;h=0}else{0===f&&"arraybuffer"===d&&(c=[]);if("arraybuffer"===d){k="\n\n"+e[f].name+"\n";a=new Uint8Array(k.length);for(g=0;g<k.length;g++)a[g]=k.charCodeAt(g);c.push(a.buffer);
h+=a.buffer.byteLength}else c+=e[f].name+"\n";e[f].file(function(a){"arraybuffer"===d?v(a,function(){c.push(this.result);h+=this.result.byteLength;f++;n(b,d)}):s(a,function(){c+=this.result+"\n\n";f++;n(b)})},t)}}function s(b,d){var a=new FileReader;a.onloadend=d;a.readAsText(b)}function v(b,d){var a=new FileReader;a.onloadend=d;a.readAsArrayBuffer(b)}function t(){log.error("readLogFailed.");l=!1}var u,m,e=[],f,c,h,l;f=0;c="";l=!1;h=0;webkitRequestFileSystem(PERSISTENT,Log.maxLogSize,function(b){u=
b;m=u.root.createReader();m.readEntries(q,r)},function(b){log.error("Failed to init FileSystem.")});this.getLog=function(b,d){e[b].file(function(a){s(a,function(a){d(this.result)})},t)};this.getLogsProperties=function(b){for(var d=[],a=0;a<e.length;a++){d.push({});for(var c=0;c<b.length;c++)d[a][b[c]]=e[a][b[c]]}return d};this.startExportLogs=function(b,c){l||(l=!0,n(b,c))};Object.preventExtensions(this)}Object.preventExtensions(LogReader);
