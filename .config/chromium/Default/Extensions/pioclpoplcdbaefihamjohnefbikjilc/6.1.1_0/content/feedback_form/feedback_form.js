var NAME=FEEDBACK_FORM_NAME,closeButton,systemInfo,title,details,rating,sInfo=GlobalUtils.generateSystemInfo();
window.addEventListener("DOMContentLoaded",function(){closeButton=document.querySelector("#close");systemInfo=document.querySelector("#systemInfo");title=document.querySelector("#title");details=document.querySelector("#details");rating=document.querySelector("#rating");GlobalUtils.localize(document.body);systemInfo.innerText+=":\n"+sInfo.browser+"\n"+sInfo.os+"\n"+navigator.language;closeButton.addEventListener("click",closeForm);closeButton.addEventListener("keypress",function(a){13==a.keyCode&&
closeForm()});document.querySelector("#send").addEventListener("click",submit);title.addEventListener("keypress",function(a){13==a.keyCode&&submit()});startSecretGeneration();Browser.sendToExtension({name:"main_getConfig",bootstrapInfo:{name:null},returnName:"feedbackFormConfig"})});function closeForm(){port.postMessage({name:"closeFeedbackForm"})}function msgHandlerConfig(a,b,c){/china/i.test(a.bootstrapInfo.name)&&(document.body.className+=" china")}
function submit(){var a=title.value.trim(),b=details.value.trim();""==a||""==b?Browser.sendToExtension({name:"showAlert",msg:Browser.i18n.getMessage("allFieldsRequired")}):(Browser.sendToExtension({name:"sendAppFeedback",title:a,details:b,os:sInfo.os,browser:sInfo.browser,rating:parseInt(rating.selectedOptions[0].value)}),closeForm())}Browser.addMessageHandlers({feedbackFormConfig:msgHandlerConfig});
