Type.registerNamespace("OSF");OSF.AppSpecificSetup=function(){};OSF.AppSpecificSetup._setupFacade=function(n,t,i){n.$9xS(i);t.getLocalizedCSSFilePath=OSF.AppSpecificSetup.$853;t.getLocalizedImageFilePath=OSF.AppSpecificSetup.$855};OSF.AppSpecificSetup.$853=function(n){var t=n==="MOEErrorUx.css";var i=_g.$V.get_$I().get_$2z().get_$WO()?"moeerroruxrtl.css":n;return t?_y.$x.$w.$82g(i.toLowerCase()):""};OSF.AppSpecificSetup.$855=function(n){var t=n==="Progress.gif"||n==="agavedefaulticon96x96.png"||n==="moe_status_icons.png";return t?_y.$x.$w.$xp(n.toLowerCase()):""};Type.registerNamespace("_d");_d.$1Iq=function(){};_d.$1Iq.registerInterface("_d.$1Iq");_d.$10S=function(){};_d.$10S.prototype={thirdParty:1,owaUrlParameters:2,owaContext:3,unitTest:4};_d.$10S.registerEnum("_d.$10S",!1);_d.$18e=function(){};_d.$18e.registerInterface("_d.$18e");var ISharingCalendarViewModelFactory=function(){};ISharingCalendarViewModelFactory.registerInterface("ISharingCalendarViewModelFactory");var ICalendarSharingPermissionsViewModelFactory=function(){};ICalendarSharingPermissionsViewModelFactory.registerInterface("ICalendarSharingPermissionsViewModelFactory");var ISubscribeCalendarViewModelFactory=function(){};ISubscribeCalendarViewModelFactory.registerInterface("ISubscribeCalendarViewModelFactory");var ICalendarPickerGroupNodeViewModel=function(){};ICalendarPickerGroupNodeViewModel.registerInterface("ICalendarPickerGroupNodeViewModel");var ICalendarPickerModernGroupsViewModel=function(){};ICalendarPickerModernGroupsViewModel.registerInterface("ICalendarPickerModernGroupsViewModel");var ICalendarPickerModernGroupsProvider=function(){};ICalendarPickerModernGroupsProvider.registerInterface("ICalendarPickerModernGroupsProvider");_d.$xn=function(){};_d.$xn.registerInterface("_d.$xn");var ICalendarPickerViewModel=function(){};ICalendarPickerViewModel.registerInterface("ICalendarPickerViewModel");_d.$xk=function(){};_d.$xk.registerInterface("_d.$xk");var ICalendarEventSearchViewModel=function(){};ICalendarEventSearchViewModel.registerInterface("ICalendarEventSearchViewModel");var ICalendarEventSearchViewModelFactory=function(){};ICalendarEventSearchViewModelFactory.registerInterface("ICalendarEventSearchViewModelFactory");var ICalendarSurfaceTimelineViewModel=function(){};ICalendarSurfaceTimelineViewModel.registerInterface("ICalendarSurfaceTimelineViewModel");_d.$1J7=function(){};_d.$1J7.registerInterface("_d.$1J7");_d.$14S=function(){};_d.$14S.prototype={Zero:0,ThirtyMinutes:18e5,OneHour:36e5,NinetyMinutes:54e5,TwoHours:72e5,AllDay:-1,Custom:-2};_d.$14S.registerEnum("_d.$14S",!1);_d.$vO=function(){};_d.$vO.prototype={singleDay:0,week:1};_d.$vO.registerEnum("_d.$vO",!1);_d.$4U=function(){};_d.$4U.prototype={inBoxRuleFrom:0,inBoxRuleTo:1,deliveryReportTo:2,deliveryReportFrom:3,groupsOwners:4,groupsMembers:5,groupsGroupModerators:6,groupsSenders:7,groupsAllowedSenders:8,voiceMailOptionsAmong:9,voiceMailOptionsTo:10,teamMailbox:11};_d.$4U.registerEnum("_d.$4U",!1);_d.$1J4=function(){};_d.$1J4.registerInterface("_d.$1J4");_d.$1JF=function(){};_d.$1JF.registerInterface("_d.$1JF");var IPrintCalendarViewModelFactory=function(){};IPrintCalendarViewModelFactory.registerInterface("IPrintCalendarViewModelFactory");var IEmailRemindersViewModel=function(){};IEmailRemindersViewModel.registerInterface("IEmailRemindersViewModel");var IEmailRemindersViewModelFactory=function(){};IEmailRemindersViewModelFactory.registerInterface("IEmailRemindersViewModelFactory");_d.$1JM=function(){};_d.$1JM.registerInterface("_d.$1JM");_d.$1JW=function(){};_d.$1JW.registerInterface("_d.$1JW");_d.$1JR=function(){};_d.$1JR.registerInterface("_d.$1JR");_d.$oH=function(){};_d.$oH.prototype={required:0,optional:1,resource:2,organizer:3};_d.$oH.registerEnum("_d.$oH",!1);_d.$1He=function(){};_d.$1He.registerInterface("_d.$1He");_d.$1Hh=function(){};_d.$1Hh.registerInterface("_d.$1Hh");_d.$1Hg=function(){};_d.$1Hg.registerInterface("_d.$1Hg");_d.$15F=function(){};_d.$15F.prototype={};_d.$15F.registerEnum("_d.$15F",!1);_d.$xl=function(){};_d.$xl.registerInterface("_d.$xl");_d.$1IW=function(){};_d.$1IW.registerInterface("_d.$1IW");_d.$19m=function(){};_d.$19m.registerInterface("_d.$19m");_d.$nR=function(){};_d.$nR.prototype={day:1,month:2,week:3};_d.$nR.registerEnum("_d.$nR",!1);_d.$1IG=function(){};_d.$1IG.registerInterface("_d.$1IG");_d.$1LO=function(){};_d.$1LO.registerInterface("_d.$1LO");_d.$sd=function(n){this.$4bH=n};_d.$1CF=function(n,t){this.$2D0=n;this.$2yF=t};_d.$1A4=function(){};_d.$1A4.registerInterface("_d.$1A4");_d.$wb=function(){};_d.$wb.prototype={firstLast:0,lastFirst:1};_d.$wb.registerEnum("_d.$wb",!1);_d.$1IK=function(){};_d.$1IK.registerInterface("_d.$1IK");_d.$1IL=function(){};_d.$1IL.registerInterface("_d.$1IL");var IModernGroupCardViewModelFactory=function(){};IModernGroupCardViewModelFactory.registerInterface("IModernGroupCardViewModelFactory");var IModernGroupMembershipPivotViewModel=function(){};IModernGroupMembershipPivotViewModel.registerInterface("IModernGroupMembershipPivotViewModel");_d.$1I7=function(){};_d.$1I7.registerInterface("_d.$1I7");_d.$1Ij=function(){};_d.$1Ij.registerInterface("_d.$1Ij");_d.$1Ii=function(){};_d.$1Ii.registerInterface("_d.$1Ii");var IInlineExploreListViewModelFactory=function(){};IInlineExploreListViewModelFactory.registerInterface("IInlineExploreListViewModelFactory");var IInlineExploreListViewModel=function(){};IInlineExploreListViewModel.registerInterface("IInlineExploreListViewModel");_d.$rA=function(){};_d.$rA.registerInterface("_d.$rA");function CoreViewModelsComponent(){}CoreViewModelsComponent.prototype={$1aH:function(n,t,i){var r=this;n.$Ax(_d.$ra).$AHm(IMailComposeDiscardManager).$AHn().$AHo(function(){return new _d.$ra(n.$2AC(IMailComposeActionFactory))});var u=this;n.$Ax(_d.$Mg).$AHm(IMailComposeActionFactory).$AHn().$AHo(function(){return new _d.$Mg});n.$Ax(_d.$5r.$59H).$AHm(IPeopleSuggestionLoader).$AHn();n.$Ax(_d.$5r.$59H).$AHm(IPeopleSuggestionLoader).$AHn();var f=this;n.$Ax(_d.$5O).$AHn().$AHo(function(){return new _d.$5O(n.$2AC(_d.$tJ),n.$2AC(_0365f.$L),n.$2AC(_a.$4g),n.$2AC(_h.$O4),n.$2AC(_a.$k),n.$2AC(_g.$V))});var e=this;n.$Ax(_d.$D8).$AHm(IPopOutHelper).$AHn().$AHo(function(){return new _d.$D8(n.$2AC(_y.$yY))});var o=this;n.$Ax(_d.$9d).$AHm(IPopOutViewModel).$AHn().$AHo(function(){return new _d.$9d(n.$2AC(_y.$N),n.$2AC(IPopOutHelper),n.$2AC(_a.$UD),n.$2AC(_a.$38),n.$2AC(_y.$GP))});var s=this;n.$Ax(_d.$re).$AHn().$AHo(function(){return new _d.$re(n.$2AC(IInferenceTracker),n.$2AC(_g.$V),n.$2AC(IMailComposeContextFactory),n.$2AC(_d.$Mg))});var h=this;n.$Ax(_c.$ou).$AHn().$AHo(function(){var t=n.$2AC(_h.$O4);return!t.get_$Mk()&&!OwaApplication.$jA?new _c.$ou(n.$2AC(_cc.$1P),n.$2AC(_0365f.$L),n.$2AC(_js.$Bt)):null});var c=this;n.$Ax(_d.$oh).$AHn().$AHo(function(){return new _d.$oh(n.$2AC(_a.$3k),n.$2AC(_y.$N),n.$2AC(IMailComposeContextFactory),n.$AGX(_d.$j7),n.$2AC(_cc.$Kq))});var l=this;n.$Ax(_d.$cM).$AHn().$AHo(function(){return new _d.$cM(n.$2AC(_d.$EZ),n.$2AC(_y.$N),n.$2AC(_g.$F7),n.$2AC(_d.$an),n.$2AC(_cc.$1P),n.$AGY(IAttachmentWellViewModelFactory),n.$2AC(_a.$38),n.$AGY(IEmailRemindersViewModelFactory),n.$AGW(IComposeCalendarItemViewModelFactory))});var a=this;n.$Ax(_d.$j5).$AHn().$AHo(function(){return new _d.$j5(n.$2AC(_d.$EZ),n.$2AC(_y.$N),n.$2AC(_g.$F7),n.$2AC(_cc.$Kq),n.$2AC(_d.$cM),n.$2AC(_a.$38))});var v=this;n.$Ax(_d.$oX).$AHn().$AHo(function(){return new _d.$oX(n.$2AC(_d.$DM),n.$2AC(_d.$PB),n.$2AC(_d.$j5),n.$2AC(_d.$7T))});var y=this;n.$Ax(_d.$IB).$AHn().$AHo(function(){return new _d.$IB(n.$2AC(_cc.$O5),n.$2AC(_cc.$Kq),n.$2AC(_cc.$1P),i.get_$9Z()==="Mouse"?n.$2AC(_d.$an):null,n.$2AC(_y.$N),n.$2AC(_g.$3u),n.$AGY(ICalendarSurfaceTimelineViewModel),n.$AGY(ITodosViewModel),n.$2AC(_0365f.$L))});var p=this;n.$Ax(_d.$PE).$AHn().$AHo(function(){return new _d.$PE(n.$2AC(_d.$3e),n.$AGW(ICalendarEventSearchViewModelFactory),n.$2AC(_0365f.$L))});var w=this;n.$Ax(_d.$7T).$AHn().$AHo(function(){return new _d.$7T});var b=this;n.$Ax(_d.$J5).$AHm(IExtensibilityStatistics).$AHn().$AHo(function(){return new _d.$J5});var k=this;n.$Ax(_d.$pc).$AHn().$AHo(function(){return new _d.$pc(n.$2AC(_g.$Rc),n.$2AC(IExtensibilityStatistics),n.$2AC(_a.$38))});var d=this;n.$Ax(_d.$pf).$AHn().$AHo(function(){return new _d.$pf});var g=this,nt=this;n.$Ax(_d.$pe).$AHn().$AHo(function(){var t=n.$2AC(_g.$V);return new _d.$pe(t.get_$Tt(),t.get_$2z().get_$Fn(),t.get_$2z().get_$AM(),t.get_$13().get_$E6(),n.$2AC(_y.$N),n.$2AC(IItemReadingPaneContextFactory),n.$2AC(_y.$Gw),n.$2AC(IMailComposeContextFactory),n.$2AC(IMailComposeActionFactory),n.$2AC(_a.$k),n.$2AC(_a.$4g),n.$2AC(_a.$3k),n.$2AC(_a.$Dy))}).$AHp(function(t){t.$LG=n.$2AC(_d.$It);t.$IX=n.$2AC(_d.$YX);t.$Ev=n.$2AC(_d.$DM)});var tt=this;n.$Ax(_d.$RJ).$AHm(IExtensibilityViewModelFactory).$AHn().$AHo(function(){var t=n.$2AC(_g.$V);return new _d.$RJ(n.$2AC(_a.$2L),n.$2AC(_d.$pf),t.get_$2z().get_$7l(),i.get_$9ex(),n.$2AC(_a.$4g),n.$2AC(_a.$k),n.$2AC(_y.$N),n.$2AC(_0365f.$L),n.$2AC(_d.$pc),n.$2AC(_d.$pe),n.$2AC(IExtensibilityStatistics))});var it=this;n.$Ax(_d.$It).$AHm(ICalendarItemDetailsViewModelFactory).$AHn().$AHo(function(){return new _d.$It(n.$2AC(_d.$PB),n.$2AC(_d.$l8),n.$2AC(_d.$RJ),n.$2AC(_d.$WJ),n.$2AC(_d.$EZ),n.$2AC(_cc.$Kq),n.$2AC(_y.$N),n.$2AC(_d.$cM),n.$2AC(_a.$3k),n.$2AC(_a.$k))});var rt=this;n.$Ax(_cmm.$bE).$AHn().$AHo(function(){return new _cmm.$bE(n.$2AC(_cc.$1P),n.$2AC(_a.$3k),n.$2AC(_y.$N),n.$AGW(ICalendarItemDetailsViewModelFactory))});var ut=this;n.$Ax(_d.$o7).$AHn().$AHo(function(){return new _d.$o7(n.$2AC(_y.$N),n.$2AC(_y.$4n),n.$2AC(_a.$3k),n.$2AC(IMailComposeContextFactory),n.$2AC(_a.$k))});if(i.get_$UB()!=="SharedHoverCard"){var ft=this;n.$Ax(_d.$yt).$AHm(IItemPartPartnerViewModelFactory).$AHn().$AHo(function(){return new _d.$yt(n.$2AC(_cmm.$es),n.$2AC(_d.$aw),n.$2AC(_d.$o7),n.$2AC(_a.$3k),n.$2AC(_d.$LY),n.$AGY(IModernGroupsProvider),n.$2AC(_a.$38),n.$2AC(_a.$4g))})}var et=this;n.$Ax(IMailComposeContextFactory).$AHn().$AHo(function(){return new _d.$1Ar(n.$2AC(_y.$lC),n.$2AC(_a.$Dy))});var ot=this;n.$Ax(_d.$yu).$AHm(IItemReadingPaneContextFactory).$AHn().$AHo(function(){return new _d.$yu});var st=this;n.$Ax(IMailResponseViewModelFactory).$AHn().$AHo(function(){return new _d.$re(n.$2AC(IInferenceTracker),n.$2AC(_g.$3u),n.$2AC(IMailComposeContextFactory),n.$2AC(_d.$Mg))});var ht=this;n.$Ax(_d.$PB).$AHn().$AHo(function(){return new _d.$PB(n.$2AC(_y.$ef),n.$2AC(_cmm.$lL),n.$2AC(_d.$oh),n.$2AC(_a.$k),n.$AGX(_d.$og),n.$AGX(_d.$j7),n.$2AC(_g.$TF),n.$2AC(_a.$8F))});var ct=this;n.$Ax(_d.$an).$AHn().$AHo(function(){return new _d.$an(n.$2AC(_y.$N),n.$2AC(_cc.$1P),n.$2AC(_a.$3k))});var lt=this;n.$Ax(_d.$og).$AHn().$AHo(function(){return new _d.$og(n.$2AC(_d.$DM),n.$2AC(_d.$It),n.$2AC(_y.$N),n.$2AC(_cc.$1P))});var at=this;n.$Ax(_d.$tJ).$AHn().$AHo(function(){return new _d.$tJ(n.$2AC(_y.$N))});var vt=this;n.$Ax(_d.FindRecipientMailComposeViewModelFactory).$AHm(IFindRecipientMailComposeViewModelFactory).$AHn().$AHo(function(){return new _d.FindRecipientMailComposeViewModelFactory(n.$2AC(_a.$3k),n.$2AC(_y.$Xr))});var yt=this;n.$Ax(_d.$IK).$AHm(_rw.$192).$AHo(function(){return new _d.$IK(n.$2AC(_a.$3k),n.$2AC(_y.$Xr))});var pt=this;n.$Ax(IUnsupportedItemReadingPaneViewModel).$AHo(function(){return new _d.$DH(n.$2AC(_y.$x))});var wt=this;n.$Ax(_d.$56).$AHm(_y.$1A6).$AHo(function(){return new _d.$56(n.$2AC(_0365f.$L),n.$AGY(IAttachmentWellViewModelFactory),n.$2AC(_a.$38),n.$AGW(IAttachmentsFilePickerPanelViewModel))});var bt=this;n.$Ax(_d.$123).$AHm(ITaskReadingPaneViewModelFactory).$AHn().$AHo(function(){return new _d.$123(n.$2AC(_0365f.$L),n.$AGY(IAttachmentWellViewModelFactory),n.$2AC(_a.$38),n.$AGW(IAttachmentsFilePickerPanelViewModel))});var kt=this;n.$Ax(_d.$hm).$AHo(function(){return new _d.$hm(n.$2AC(_0365f.$L),n.$AGY(IAttachmentWellViewModelFactory),n.$2AC(_a.$38),n.$AGW(IAttachmentsFilePickerPanelViewModel))});var dt=this;n.$Ax(_d.$SE).$AHm(IPeopleSearchSuggestionAdaptorViewModel).$AHo(function(){return new _d.$SE(n.$2AC(_y.$N),n.$2AC(_d.$EZ),n.$2AC(_a.$38))});var gt=this;n.$Ax(_d.$j7).$AHm(ICalendarMailComposeConductorFactory).$AHn().$AHo(function(){return new _d.$j7(n.$2AC(IMailComposeViewModelFactory),n.$2AC(_y.$N))});var ni=this;n.$Ax(_d.$EZ).$AHm(_y.$Xr).$AHn().$AHo(function(){return new _d.$EZ(n.$2AC(_d.$TQ),n.$2AC(_y.$N),n.$2AC(_a.$38),n.$2AC(_a.$3k))});var ti=this;n.$Ax(_d.$fe).$AHn().$AHo(function(){return new _d.$fe(n.$2AC(_y.$N),n.$2AC(_h.$5N),n.$2AC(_d.$EZ))});var ii=this;n.$Ax(_d.$TQ).$AHm(ICompositePersonaViewModelFactory).$AHn().$AHo(function(){return new _d.$TQ(n.$2AC(_y.$N),n.$AGX(_d.$LY))});var ri=this;n.$Ax(_d.$ZL).$AHn().$AHo(function(){return new _d.$ZL(n.$2AC(_d.$TQ),n.$2AC(_y.$N),n.$2AC(_a.$38),n.$2AC(_a.$3k))});var ui=this;n.$Ax(_d.$zF).$AHm(IMeCardViewModelFactory).$AHn().$AHo(function(){return new _d.$zF(n.$2AC(_g.$F7),n.$AGY(IChatManagerFactory),n.$2AC(_d.$EZ),n.$2AC(_a.$3k),n.$2AC(_y.$N),n.$2AC(_a.$38),n.$2AC(_a.$4g))});var fi=this,ei=this;n.$Ax(_d.$sD).$AHn().$AHo(function(){return new _d.$sD}).$AHp(function(t){t.$5q=n.$2AC(_d.$EZ)});var oi=this,si=this;n.$Ax(_d.$qA).$AHn().$AHo(function(){return new _d.$qA}).$AHp(function(t){t.$5q=n.$2AC(_d.$EZ)});var hi=this,ci=this;n.$Ax(_d.$qB).$AHn().$AHo(function(){return new _d.$qB(n.$2AC(_d.$DR),n.$2AC(_y.$T7))}).$AHp(function(t){t.$5q=n.$2AC(_d.$EZ)});var li=this,ai=this;n.$Ax(_d.$qH).$AHn().$AHo(function(){return new _d.$qH}).$AHp(function(t){t.$5q=n.$2AC(_d.$EZ)});var vi=this,yi=this;n.$Ax(_d.$sE).$AHn().$AHo(function(){return new _d.$sE}).$AHp(function(t){t.$2bC=n.$2AC(_d.$sD)});var pi=this;n.$Ax(_d.$Vw).$AHn().$AHo(function(){return new _d.$Vw(n.$2AC(_y.$N),n.$2AC(_d.$ZL))});if(i.get_$9Z()!=="Mouse")if(i.get_$9Z()==="TouchNarrow"){var wi=this;n.$Ax(_d.$zu).$AHm(IOptionsViewModel).$AHo(function(){return new _d.$zt(n.$2AC(_0365f.$L),n.$2AC(_d.$rA))})}else{var bi=this;n.$Ax(_d.$zu).$AHm(IOptionsViewModel).$AHo(function(){return new _d.$9b(n.$2AC(_0365f.$L),n.$2AC(_d.$rA),n.$2AC(_a.$4g),n.$2AC(_y.$UB),n.$2AC(_a.$k))})}var ki=this;n.$Ax(_d.$Zv).$AHn().$AHo(function(){return new _d.$Zv(n.$2AC(_y.$N),n.$2AC(_g.$V))});var di=this,gi=this;n.$Ax(_d.$Fm).$AHm(ISchedulingViewModelFactory).$AHn().$AHo(function(){return new _d.$Fm(n.$2AC(_d.$DR),n.$2AC(_y.$N),n.$2AC(_g.$V),n.$2AC(_d.$Zv),n.$2AC(_d.$gT),n.$2AC(_d.$ie),n.$2AC(_a.$3k),n.$2AC(_js.$Bt),n.$2AC(_g.$TF),n.$2AC(_0365f.$L))}).$AHp(function(t){t.$3Y3=n.$2AC(_d.$Vw);t.$10y=n.$2AC(_d.$ZL);t.$Je=n.$2AC(_d.$PB)});var nr=this,tr=this;n.$Ax(_d.$fi).$AHn().$AHo(function(){return new _d.$fi(n.$2AC(_a.$PR),n.$2AC(_y.$N),n.$2AC(_a.$8F))}).$AHp(function(t){t.$134=n.$2AC(_d.$TQ);t.$5q=n.$2AC(_d.$EZ)});var ir=this,rr=this;n.$Ax(_d.$z6).$AHm(ILocationViewModelFactory).$AHn().$AHo(function(){return new _d.$z6(n.$2AC(_y.$N))}).$AHp(function(t){t.$5q=n.$2AC(_d.$EZ)});var ur=this,fr=this;n.$Ax(_d.$l9).$AHn().$AHo(function(){return new _d.$l9(n.$2AC(_d.$fi),n.$2AC(_y.$N),n.$2AC(_a.$8F))}).$AHp(function(t){t.$5q=n.$2AC(_d.$EZ)});var er=this;n.$Ax(_d.$l7).$AHn().$AHo(function(){return new _d.$l7(n.$2AC(_a.$PR),n.$2AC(_a.$8F))});var or=this;n.$Ax(_d.$l8).$AHn().$AHo(function(){return new _d.$l8(n.$2AC(_a.$PR),n.$2AC(_a.$8F))});var sr=this;n.$Ax(_d.$gT).$AHn().$AHo(function(){return new _d.$gT(n.$2AC(_a.$3k))});var hr=this;n.$Ax(_d.$PX).$AHn().$AHo(function(){return new _d.$PX(n.$2AC(_a.$3k),n.$2AC(_g.$V).get_$5U(),n.$2AC(_y.$N))});var cr=this;n.$Ax(_d.$oG).$AHn().$AHo(function(){return new _d.$oG(n.$2AC(_d.$ZL),n.$2AC(_y.$N),n.$2AC(_a.$3k),n.$AGW(IFindRecipientMailComposeViewModelFactory))});var lr=this;n.$Ax(_d.$p6).$AHn().$AHo(function(){return new _d.$p6(n.$2AC(_d.$oG),n.$AGX(_d.$mY),n.$2AC(_y.$N),n.$2AC(_a.$3k),n.$2AC(_a.$Dy))});var ar=this;n.$Ax(_d.$FA).$AHn().$AHo(function(){return new _d.$FA(n.$2AC(_g.$V).get_$2z(),n.$2AC(_a.$3k))});var vr=this;n.$Ax(_d.$lk).$AHn().$AHo(function(){return new _d.$lk(n.$2AC(_d.$FA),n.$2AC(_cc.$1P))});var yr=this;n.$Ax(IMeetNowManagerFactory).$AHn().$AHo(function(){return new _d.$1BB(n.$2AC(_d.$FA),n.$2AC(_a.$3k),n.$2AC(_a.$8F))});var pr=this;n.$Ax(_d.$pA).$AHn().$AHo(function(){return new _d.$pA(n.$2AC(_d.$lk),n.$2AC(_a.$3k))});var wr=this;n.$Ax(_d.$DM).$AHm(IComposeCalendarItemViewModelFactory).$AHn().$AHo(function(){var t=new _d.$DM(n.$2AC(_d.$Zv),n.$2AC(ISchedulingViewModelFactory),n.$2AC(_d.$PX),n.$2AC(_d.$l9),n.$2AC(_d.$PB),n.$2AC(_d.$p6),n.$2AC(_g.$V),n.$2AC(_a.$3k),n.$2AC(_y.$N),n.$2AC(_a.$38),n.$AGX(_cc.$Kq),n.$2AC(_d.$kC),n.$2AC(_0365f.$L),n.$2AC(_d.$pA),n.$2AC(_d.$p5),n.$2AC(_g.$TF),n.$2AC(_d.$an),n.$AGY(IAttachmentWellViewModelFactory),n.$AGY(IExtensibilityViewModelFactory),n.$2AC(_a.$Dy),n.$2AC(_a.$4g),n.$AGW(IAttachmentsFilePickerPanelViewModel));var i=n.$2AC(_y.$GP);var r=n.$2AC(IPopOutHelper);i.registerPopoutDependencies(r.$1xk(_d.$DM),[n.$2AC(_cc.$1P)]);return t});var br=this,kr=this;n.$Ax(_d.$WJ).$AHn().$AHo(function(){return new _d.$WJ(n.$2AC(_y.$N))}).$AHp(function(t){t.$7F=n.$2AC(_rw.$ZA)});var dr=this;n.$Ax(_d.$ie).$AHn().$AHo(function(){return new _d.$ie(n.$2AC(_d.$PX),n.$2AC(_y.$N))});var gr=this;n.$Ax(_d.$p5).$AHn().$AHo(function(){return new _d.$p5(n.$2AC(_d.$PX),n.$2AC(_d.$Zv),n.$2AC(_d.$gT),n.$2AC(_y.$N))});var nu=this;n.$Ax(_d.$It).$AHn().$AHm(ICalendarReadingPaneViewModelFactory).$AHo(function(){var t=new _d.$It(n.$2AC(_d.$PB),n.$2AC(_d.$l8),n.$2AC(_d.$RJ),n.$2AC(_d.$WJ),n.$2AC(_d.$EZ),n.$2AC(_cc.$Kq),n.$2AC(_y.$N),n.$2AC(_d.$cM),n.$2AC(_a.$3k),n.$2AC(_a.$k));var i=n.$2AC(_y.$GP);var r=n.$2AC(IPopOutHelper);i.registerPopoutDependencies(r.$1xk(_d.$It),[n.$2AC(_cc.$1P)]);return t});var tu=this;n.$Ax(_d.$DR).$AHn().$AHo(function(){return new _d.$DR(n.$2AC(_a.$3k),n.$2AC(_a.$38),n.$2AC(_0365f.$L))});var iu=this;n.$Ax(_d.$aw).$AHn().$AHo(function(){var t=new _d.$aw(n.$AGW(ISharingCalendarViewModelFactory),n.$2AC(_cc.$Gf),n.$2AC(_0365f.$L),n.$2AC(_y.$N),n.$2AC(_cc.$1P),n.$2AC(_a.$3k),n.$2AC(_g.$QX));var i=n.$2AC(_y.$GP);var r=n.$2AC(IPopOutHelper);i.registerPopoutDependencies(r.$1xk(_d.$aw),[n.$2AC(_cc.$1P)]);return t});var ru=this;n.$Ax(_d.$C0).$AHo(function(){return new _d.$C0(n.$2AC(_0365f.$L),n.$2AC(_g.$3u))});var uu=this;n.$Ax(_d.$Ix).$AHo(function(){return new _d.$Ix(n.$AGY(IChatManagerFactory))});var fu=this;n.$Ax(_d.$NR).$AHo(function(){return new _d.$NR(n.$AGY(IChatManagerFactory))});n.$Ax(_d.$Dl).$AHn();var eu=this;n.$Ax(_d.$sc).$AHn().$AHo(function(){return new _d.$sc(n.$2AC(_0365f.$L),n.$2AC(_d.$Dl))});var ou=this;n.$Ax(_d.$ub).$AHn().$AHo(function(){return new _d.$ub(n.$2AC(_d.$Dl))});if(i.get_$9Z()==="Mouse"){var su=this;n.$Ax(INotificationTrayViewModel).$AHn().$AHo(function(){var i=n.$2AC(_g.$V);if(!i.get_$5z().get_$5o())return new _d.$zk;var t=new _d.$LN;_g.$V.get_$I().get_$13().get_$4Mk()&2&&t.$12D(n.$2AC(_d.$C0));t.$12D(n.$2AC(_d.$Ix));t.$12D(n.$2AC(_d.$NR));t.$12D(new _d.$SQ(n.$2AC(_d.$5O),i,n.$2AC(_0365f.$L)));t.$12D(n.$2AC(_d.$Dl));n.$2AC(_d.$sc);n.$2AC(_d.$ub);return t})}else{var hu=this;n.$Ax(INotificationTrayViewModel).$AHn().$AHo(function(){return new _d.$zk})}var cu=this;n.$Ax(_d.$YX).$AHm(IMailComposeViewModelFactory).$AHn().$AHo(function(){return new _d.$YX(n.$2AC(IExtensibilityViewModelFactory),n.$2AC(_rw.$ZA),n.$2AC(_d.$kC),n.$2AC(_d.$mY),n.$2AC(IMailComposeContextFactory),n.$2AC(_d.$Mg),n.$2AC(_d.$EZ),n.$2AC(_y.$N),n.$2AC(_d.$Yq),n.$2AC(_d.$ra),n.$2AC(_y.$GP),n.$2AC(_0365f.$L),n.$AGY(IAttachmentWellViewModelFactory),n.$2AC(_a.$38),n.$2AC(_a.$Dy),n.$AGW(IAttachmentsFilePickerPanelViewModel),n.$2AC(IInferenceTracker),n.$2AC(_g.$PM),n.$2AC(_a.$4g),n.$2AC(_g.$F7).get_$6oU())});var lu=this;n.$Ax(_d.$sK).$AHo(function(){return new _d.$sK(n.$2AC(_d.$Vw))});var au=this;n.$Ax(_y.$Gw).$AHm(_y.$Gw).$AHo(function(){return new _d.$1AF(n.$2AC(_y.$dz),n.$AGY(IChatProviderFactory),n.$2AC(_y.$N),n.$2AC(_g.$V))});var vu=this;n.$Ax(_y.$qt).$AHo(function(){return new _d.$1A7(n.$2AC(_y.$N),n.$2AC(_y.$dz),n.$2AC(_d.$It),n.$AGW(ITaskReadingPaneViewModelFactory))});var yu=this;n.$Ax(_a.$W2).$AHn().$AHo(function(){return new _a.$W2});var pu=this;n.$Ax(_d.$Wy).$AHn().$AHo(function(){return new _d.$Wy(n.$2AC(_y.$N),n.$2AC(_g.$3u),n.$2AC(_0365f.$L),n.$2AC(_h.$5N),n.$2AC(IInferenceTracker),n.$AGW(IMailErrorHandler),n.$2AC(_h.$Rb))});var wu=this;n.$Ax(_d.$Wy.$4Tb).$AHn().$AHo(function(){return new _d.$Wy.$4Tb(n.$2AC(_d.$Wy))});var bu=this;n.$Ax(_d.$xz).$AHn().$AHo(function(){return new _d.$FW});var ku=this;n.$Ax(_d.$kC).$AHn().$AHo(function(){return new _d.$kC(n.$2AC(_y.$N),n.$2AC(_g.$3u),n.$2AC(_d.$xz))});var du=this;n.$Ax(_d.$Nw).$AHm(IModuleHelpProvider).$AHn().$AHo(function(){var t=n.$2AC(_g.$F7);return new _d.$Nw(t.get_$5co(),t.get_$WH(),n.$2AC(_a.$8F),n.$2AC(_d.$Yq),n.$2AC(_y.$6u),i.get_$9Z(),n.$2AC(_y.$N))});var gu=this;n.$Ax(_d.$Yq).$AHm(_d.$19m).$AHn().$AHo(function(){return new _d.$Yq(n.$2AC(_h.$O4),n.$2AC(_y.$N),n.$2AC(_g.$V).get_$Nq().AllowOfflineOn,n.$2AC(_0365f.$L))});var nf=this;n.$Ax(_d.$jM).$AHm(_d.$jM).$AHn().$AHo(function(){return new _d.$jM(n.$2AC(_y.$N),n.$2AC(_a.$3k),n.$AGY(IChatProviderFactory),n.$2AC(_d.$l7),n.$2AC(_d.$DM),n.$2AC(IMailComposeContextFactory),n.$2AC(_g.$QX),n.$2AC(_a.$8F))});var tf=this;n.$Ax(_d.$m0).$AHm(_d.$m0).$AHn().$AHo(function(){return new _d.$m0(n.$2AC(_y.$N),n.$2AC(_a.$8F),n.$2AC(_d.$EZ),n.$2AC(_d.$jM))});var rf=this;n.$Ax(_d.$l4).$AHm(_d.$l4).$AHn().$AHo(function(){return new _d.$l4(n.$2AC(_y.$N),n.$2AC(_d.$l3))});var uf=this,ff=this;n.$Ax(_d.$l3).$AHm(_d.$l3).$AHn().$AHo(function(){return new _d.$l3(n.$2AC(_y.$N))}).$AHp(function(t){t.$183=n.$2AC(_d.$LY)});var ef=this,of=this;n.$Ax(_d.$Gb).$AHm(_d.$10H).$AHn().$AHo(function(){return new _d.$Gb(n.$2AC(_y.$N),n.$2AC(_a.$38),n.$2AC(_a.$3k),n.$AGY(IChatProviderFactory),n.$2AC(_d.$l4),n.$2AC(_d.$fi),n.$2AC(_d.$l7),n.$2AC(_d.$sE),n.$2AC(_d.$qA),n.$2AC(_d.$qB),n.$2AC(_d.$qH),n.$2AC(IMailComposeContextFactory),n.$AGY(IModernGroupCardViewModelFactory),n.$2AC(_y.$6W),n.$2AC(_g.$QX),n.$2AC(_a.$8F))}).$AHp(function(t){t.$hC=n.$2AC(_d.$m0)});var sf=this;n.$Ax(_d.$LY).$AHm(_d.$LY).$AHn().$AHo(function(){return new _d.$LY(n.$2AC(_y.$N),n.$2AC(_a.$38),n.$AGY(IChatProviderFactory),n.$2AC(_d.$10H))});var hf=this;n.$Ax(IModernGroupCardFacade).$AHn().$AHo(function(){var t=n.$2AC(_d.$LY);return t.$E(new _d.$Ic,0)});var cf=this;n.$Ax(_d.$tD).$AHn().$AHo(function(){return new _d.$tD});var lf=this;n.$Ax(_d.$pE).$AHn().$AHo(function(){return new _d.$pE(n.$2AC(_a.$3k))});var af=this;n.$Ax(_d.$VW).$AHm(ISharedFolderViewModel).$AHo(function(){return new _d.$VW(n.$2AC(_d.$DR),n.$2AC(_a.$3k))});var vf=this;n.$Ax(_d.$YB).$AHm(IInstantSearchFactory).$AHn().$AHo(function(){return new _d.$YB(n.$2AC(IInferenceTracker),n.$2AC(_g.$F7).get_$b6(),n.$2AC(_a.$38))});var yf=this;n.$Ax(_d.$fR).$AHm(IOpenAnotherMailboxViewModel).$AHo(function(){return new _d.$fR(n.$2AC(_0365f.$L),n.$2AC(_d.$DR))});var pf=this;n.$Ax(_d.$5M).$AHm(IMailFolderPermissionsDialogViewModel).$AHo(function(){return new _d.$5M(n.$2AC(_d.$DR),n.$2AC(_a.$3k))});var wf=this;n.$Ax(_d.$Rm).$AHm(IMailErrorHandler).$AHn().$AHo(function(){return new _d.$Rm(n.$2AC(_0365f.$L))});var bf=this;n.$Ax(_d.$SC).$AHn().$AHo(function(){return _d.$SC.$7nH(n.$2AC(_y.$N),n.$2AC(_a.$Hf),n.$2AC(_a.$38),n.$AGY(IGroupsNavigationViewModelFactory))})},$82P:function(){return[new _a.$6K(_d.$tD,2,9),new _a.$6K(_y.$lH,1,13),new _a.$6K(_d.$5O,2,9),new _a.$6K(_a.$6B,2,1),new _a.$6K(_c.$ou,2,9),new _a.$6K(_y.$sL,2,9),new _a.$6K(_d.$Wy.$4Tb,2,9),new _a.$6K(_d.$pE,2,9)]}};_d.$9d=function(n,t,i,r,u){this.$4C=new Sys.EventHandlerList;_d.$9d.initializeBase(this);this.$B=n;this.$uM=t;this.$Cs=i;this.$1H=r;this.$S3=u};function $1Xf(n,t,i,r){var u=t[r];_js.$8.$15(u)||(i[r]=u)}function $4sn(n,t,i,r,u,f){var e;if($5(t))throw Error.argumentNull("factory");if($5(r))e=n.$uM.$3pd(t,i,f);else{e=n.$uM.$3pc(t,r,f);r.get_$4Td()&&!$4so(n,u)&&(window.document.title=r.get_$4Td())}return e}function $4so(n,t){return n.$Cs.get_$3r()!==1&&!!n.$1H&&n.$1H.$3N("InstantPopout")&&Array.contains(_d.$9d.$6Ty,n.$uM.$1xk(t))}function $75c(n,t,i,r,u){var e=window.location.href;var f=_a.$3P.$1Ho(e);$1Xf(n,f,i,"flights");$1Xf(n,f,i,"features");$1Xf(n,f,i,"traceMessageMaxLength");$1Xf(n,f,i,"traceComponents");$1Xf(n,f,i,"traceLevel");$1Xf(n,f,i,"perfTraceLevel");$1Xf(n,f,i,"analyticsEnabled");n.$6E(t,i,r,u,"_blank")}function $75e(n,t,i,r,u,f){if(!n.$uM.$3Xw(t))throw Error.argumentType("The parameter vmType should be ViewModel type!");if($5(n.$2b7))throw Error.invalidOperation("No pop-out event handler was added, the system can not handle the pop out request!");var e=n.$2b7(n,u,"_blank");if(e&&!e.closed){var o=$4sn(n,i(),r,f,t,e);if(o.length>1)throw Error.invalidOperation("Popping up more than one view model is not currently supported for projection popout.");n.$2cD.$7Yd(o[0],e,f?f.get_$4Td():null)}}function $75d(n,t,i,r,u,f){var e=$4sn(n,t(),i,r,f,null);if(e.length>1)throw Error.invalidOperation("Popping up more than one view model is not supported in touch environments. Please contact the Shell team if you have this requirement.");n.$B.$fj(e[0],0,u)}_d.$9d.prototype={$B:null,$uM:null,$2cD:null,$2b7:null,$Cs:null,$1H:null,$S3:null,add_$6S1:function(n){this.$4C.addHandler("OpenWindowRequested",n)},remove_$6S1:function(n){this.$4C.removeHandler("OpenWindowRequested",n)},get_$6OH:function(){return this.$2b7},set_$6OH:function(n){this.$2b7;this.$2b7=n;return n},get_$9hk:function(){if(!this.$2cD){this.$2cD=new _y.$1Cp(this.$S3);window.popOutProjectionManager=this.$2cD}return this.$2cD},$6E:function(n,t,i,r,u){if(!this.$uM.$3Xw(n))throw Error.argumentType("The parameter vmType should be ViewModel type!");var f=this.$4C.getHandler("OpenWindowRequested");if($5(f))throw Error.invalidOperation("No pop-out event handler was added, the system can not handle the pop out request!");var o=this.$uM.$1xk(n);var e=null;r&&(e=this.$uM.$88N(Object.getType(r)));u=$5(u)?"_blank":u;f(this,new _y.$1C9(o,t,i,r,e,u))},$9hh:function(n,t,i,r){this.$6S0(n,t,i,r,null,!1)},$6S0:function(n,t,i,r,u,f){if(!this.$uM.$3Xw(n))throw Error.argumentType("The parameter vmType should be ViewModel or IParameterableViewModelFactory type!");this.$B.get_$L()==="Mouse"?$4so(this,n)?$75e(this,n,t,i,r,u):$75c(this,n,i,r,u):$75d(this,t,i,u,f,n)}};_d.$D8=function(n){this.$$d_$86d=Function.createDelegate(this,this.$86d);this.$3MU=n};_d.$D8.$7eG=function(n,t){if(_d.$D8.$3VK)return 4;var i=_d.$D8.$6Y1(n,t);return i?_y.$F3.$5cJ(i)?3:2:1};_d.$D8.$6Y1=function(n,t){return!_js.$8.$15(t)&&n?n.getContext(t):null};function $75b(n,t){if(!n.$3Xw(t))throw Error.argument("The pop out control only supports creating ViewModels by passing in a IParameterizeableViewModelFactory");var i=n.$3MU.$2AD(t);$5(i)&&(i=new t);if($5(i))throw Error.argument(String.format("Could not instantiate IParameterizeableViewModelFactory {0}",t));return i}function $75a(n,t,i){if(!$5(i.get_$26V())&&i.get_$26V().length>0){t.get_mainWindowInstance()&&!t.get_mainWindowInstance().closed&&new _y.$lu(t.get_mainWindowInstance(),i.get_$26V());for(var u=i.get_$26V(),e=u.length,r=0;r<e;++r){var f=u[r];_h.$1L.get_$I().$IB(f.get_$Q(),f)}}}function $4sm(n,t,i,r){var u=this;t.add_$19w(function(){_a.$42.$Gf(i.get_mainWindowInstance(),function(n){i.deRegisterWindow(r)})})}_d.$D8.prototype={$eX:null,$pb:null,$3MU:null,get_$6jD:function(){if(!this.$eX){this.$eX={};this.$eX.ReadMessageItem=_y.$Gw;this.$eX.ItemReadingPaneViewModelPopOutFactory=_y.$Gw;this.$eX.Chat=IChatViewModelFactory;this.$eX.ItemAttachment=_y.$qt;this.$eX.ComposeCalendarItemViewModelFactory=_d.$DM;this.$eX.OwaOptionPeoplePickerViewModelFactory=_d.$sK;this.$eX.CalendarItemDetailsViewModelFactory=_d.$It;this.$eX.ISharingCalendarViewModelFactory=ISharingCalendarViewModelFactory;this.$eX.IMailComposeViewModelFactory=_d.$YX;this.$eX.PersonaCardViewModelFactory=_d.$Gb;this.$eX.TaskReadingPaneViewModelPopOutFactory=_d.$hm;this.$eX.IAttachmentViewModelPopoutFactory=IAttachmentViewModelPopoutFactory;this.$eX.CalendarShareMessageViewModelFactory=_d.$aw}return this.$eX},get_$3Ur:function(){if(!this.$pb){this.$pb={};this.$pb.ItemReadingPaneContext=_y.$4k;this.$pb.AttendeeContext=_d.$Cm;this.$pb.ComposeCalendarItemContext=_d.$84;this.$pb.SchedulingPopOutContext=_d.$3a;this.$pb.LocationPopOutContext=_d.$8Z;this.$pb.CalendarItemDetailsContext=_d.$P9;this.$pb.PersonaCardViewModelContext=_d.$5Y;this.$pb.MailComposeContext=_d.$S;this.$pb.ChatPopOutContext=_y.$PJ;this.$pb.TaskReadingPaneContext=_d.$8q}return this.$pb},$3Xw:function(n){return Type.isClass(n)&&(_a.$FF===n||n.inheritsFrom(_a.$FF)||n.implementsInterface(_y.$19p))||Type.isInterface(n)},$1xk:function(n){var t=this.get_$6jD();for(var i in t){var r={key:i,value:t[i]};var u=r.value;if(n===u)return r.key}return n.getName()},$88u:function(n){return this.get_$6jD()[n]},$88N:function(n){var t=this.get_$3Ur();for(var i in t){var r={key:i,value:t[i]};var u=r.value;if(n===u)return r.key}throw Error.invalidOperation("Type "+n.toString()+" must be found in SymbolToPopOutContextTypeMappingTable");},$86d:function(n){if(!(n in this.get_$3Ur()))throw Error.invalidOperation("Symbol "+n+" must be found in SymbolToPopOutContextTypeMappingTable");return this.get_$3Ur()[n]},$9mX:function(n,t){this.get_$3Ur()[n]=t},$89A:function(n,t,i,r,u){var f=null;var o=$75b(this,i);var e=r.wid;var s=_d.$D8.$6Y1(t,e);_a.$42.$1Kh=e;var h=_d.$D8.$7eG(t,e);switch(h){case 4:f=this.$3pc(o,_d.$D8.$3VK,u);_d.$D8.$3VK=null;break;case 1:f=this.$3pd(o,r,u);break;case 2:$4sm(this,n,t,e);_y.$F3.$5Ox(s,this.$3MU);f=this.$3pd(o,r,u);break;case 3:$4sm(this,n,t,e);_y.$F3.$5Ox(s,this.$3MU);var c=_y.$F3.$7rk(s,this.$$d_$86d);$75a(this,t,c);f=this.$3pc(o,c,u);break;default:_a.$3.$9t(!0,"Unknown PopOutMode "+_d.$10S.toString(h));break}if(!f||!f.length)throw Error.argument("The ViewModel provided in the url is not valid!");n.$6hr(f[0],n.$aZ());return f},$3pc:function(n,t,i){var r;if(_y.$yW.isInstanceOfType(n)){var u=n;r=u.$7oA(t)}else r=[n.$wx(t,i)];return r},$3pd:function(n,t,i){var r;if(_y.$yW.isInstanceOfType(n)){var u=n;r=u.$9qK(t)}else r=[n.$br(t,i)];return r}};_d.$QK=function(n,t){_d.$QK.initializeBase(this);this.$28w=new _C(n,_d.$QK.$A);this.set_$eS(t)};_d.$QK.prototype={$28w:null,$4cE:!1,get_$1I2:function(){return this.$28w},get_$eS:function(){return this.$4cE},set_$eS:function(n){this.$4cE=n;$N(this,"ShowPopOutControl");return n}};_d.$Vg=function(){this.$2ZC=-1};_d.$Vg.prototype={$4BN:0,$4BW:null,$6j1:0,$C:0,get_$7cU:function(){return this.$C?Math.round(this.$6j1/this.$C):-1},$6Q:function(n,t){this.$C++;this.$6j1+=n;if(n>=this.$4BN){this.$4BN=n;this.$4BW=t}(this.$2ZC===-1||n<this.$2ZC)&&(this.$2ZC=n)},$1JG:function(){if(!this.$C)return"";var n=$5(this.$4BW)?"":this.$4BW;var t=[this.$2ZC,this.get_$7cU(),this.$4BN,n];return t.join(",")}};_d.$EC=function(n,t,i,r){this.$$d_$1ov=Function.createDelegate(this,this.$1ov);this.$$d_$A4m=Function.createDelegate(this,this.$A4m);this.$$d_$1BY=Function.createDelegate(this,this.$1BY);this.$$d_$7fM=Function.createDelegate(this,this.$7fM);this.$$d_$8Sx=Function.createDelegate(this,this.$8Sx);this.$$d_$2JT=Function.createDelegate(this,this.$2JT);_d.$EC.initializeBase(this);this.$5kJ=n;this.$1RM=t;this.$2g=i;this.$k=r;this.$iR=new _C(this.$$d_$2JT,_d.$EC.$A);this.$1FO=new _C(this.$$d_$8Sx,_d.$EC.$A,this.$2g,"CalendarEntry",this.$$d_$7fM)};function $6ye(n){var t={};if(n.$2g.get_$6T()&&n.$2g.get_$6T().get_$C()>0){var i=n.$2g.get_$6T().$6W();t["Compose Form Item Categories"]=i}return t}function $6yf(n){n.$a7||n.set_$1tH(new _y.$C8(n.$1RM,n.$$d_$1ov))}function $6yd(n){return _g.$2o.$1xT(n.$2g)}function $6yc(n,t,i){var f=this;var u=new _y.$32("dummy",new _C(function(){},_d.$EC.$A));var e=this;var r=new _y.$32(t,new _C(function(){$6yg(n,u)},_d.$EC.$A));u=r;r.$7vB();r.set_$3Vs(i);return r}function $6yg(n,t){var i=t.$2E;var r=null;var u=null;t.get_$3Vs()?r=i:u=i;n.$1BY(r,u,!1)}_d.$EC.prototype={$iR:null,$1FO:null,$5kJ:!1,$2g:null,$1RM:null,$k:null,$NM:null,$a7:null,$2JD:null,add_$2sA:function(n){this.$2G("CategoriesChanged",n)},remove_$2sA:function(n){this.$2H("CategoriesChanged",n)},get_$1tH:function(){return this.$a7},set_$1tH:function(n){if(this.$a7!==n){this.$a7=n;$3(this,"CategoryManagementDialog")}return n},get_$5FH:function(){return this.$2g.get_$6T()},get_$5Ga:function(){this.$NM||(this.$NM=new _y.$GB(this.$1RM,this.$$d_$1BY,this.$iR,this.$1FO));return this.$NM},$82G:function(){if(this.$2JD)return this.$2JD;this.$2JD=new(_0365f.$n.$$(_y.$32));if(this.$1RM&&!this.$2g.get_$Gj()){var t=this.$1RM.$4ct();var i=this.$2g.get_$6T()?this.$2g.get_$6T().$6W():new Array(0);i.sort(this.$$d_$A4m);for(var f=t.length,e=i.length,n=0,r=0;n<f;n++){var u=!1;if(r<e&&t[n].get_$1N()===i[r]){u=!0;r++}this.$2JD.$D($6yc(this,t[n].get_$1N(),u))}}return this.$2JD},$3xI:function(){return this.$2g.get_$Gj()?null:this.get_$5Ga().$1ab()},$4Th:function(){this.get_$5Ga().$1tj($6ye(this),1)},$1BY:function(n,t,i){var r=this.$2g.get_$6T();var u=_g.$Bx.$1ot(r,i,t,n);this.$2g.set_$6T(u);$6J(this,"CategoriesChanged")},$2JT:function(){this.$1BY(null,null,!0)},$7fM:function(){var n=this.$2g.get_$5V();return this.$5kJ&&(_g.$E2.isInstanceOfType(n)&&!n.get_$1EM()||this.$2g.get_$az())?!0:!1},$8Sx:function(){$6yf(this);this.$a7.$VM()},$1ov:function(n,t,i){var r=new _h.$iE(n,t,i,$6yd(this));var u=this;r.add_$29(function(){var n=r.$3X8;u.$1RM.set_$1RN(n);$3(u,"MasterCategories")});r.add_$21(_cc.$5o.$1DI);this.$k.$11(r)},$A4m:function(n,t){var i=n.toLowerCase();var r=t.toLowerCase();return i.localeCompare(r)}};_d.$an=function(n,t,i){this.$B=n;this.$2M=t;this.$k=i};_d.$an.prototype={$B:null,$2M:null,$k:null,$8V:function(n){if(!this.$2M.get_$HJ()){_js.Trace.logError(_a.$0.$Jf,"Make sure that calendarcache is loaded before creating CalendarCategoryViewModel");return null}var t=this.$2M.$2OY(n.get_$28());return t?new _d.$EC(this.$B.get_$9l(),t,n,this.$k):null}};_d.$G5=function(n){this.$$d_$7f3=Function.createDelegate(this,this.$7f3);this.$$d_$9ng=Function.createDelegate(this,this.$9ng);this.$$d_$3mm=Function.createDelegate(this,this.$3mm);this.$$d_$7fD=Function.createDelegate(this,this.$7fD);this.$$d_$9oG=Function.createDelegate(this,this.$9oG);_d.$G5.initializeBase(this);_a.$3.$m(n,"itemViewModel");this.$5p=n;$6yj(this);var t=this;this.$2dY=new _C(this.$$d_$9oG,_d.$G5.$A,this,"CanRemoveWithConfirmation",function(){return t.get_$7fT()});var i=this;this.$2rk=new _C(this.$$d_$7fD,_d.$G5.$A,this,"CanCancelWithConfirmation",function(){return i.get_$7eo()});this.$Pr=new _C(this.$$d_$3mm,_d.$G5.$A)};function $6yj(n){var t=this;n.$5p.$Y("CanCancel",function(){$3(n,"CanCancelWithConfirmation")});var i=this;n.$5p.$Y("CanRemove",function(){$3(n,"CanRemoveWithConfirmation")})}_d.$G5.prototype={$5p:null,$2dY:null,$2rk:null,$Pr:null,$wn:null,$1tl:null,$wm:null,$135:!1,get_$7fT:function(){return this.$5p.get_$Vp()},get_$7eo:function(){return this.$5p.get_$iN()},get_$1tm:function(){return this.$wn},set_$1tm:function(n){if(this.$wn!==n){this.$wn=n;$3(this,"ConfirmDialogTitle")}return n},get_$3nS:function(){return this.$1tl},set_$3nS:function(n){if(this.$1tl!==n){this.$1tl=n;$3(this,"ConfirmDialogMessage")}return n},get_$2tA:function(){return this.$wm},set_$2tA:function(n){if(this.$wm!==n){this.$wm=n;$3(this,"ConfirmDialogButtonDataList")}return n},get_$OQ:function(){return this.$135},set_$OQ:function(n){if(this.$135!==n){this.$135=n;$3(this,"ConfirmDialogIsShown")}return n},$3mm:function(){this.set_$OQ(!1)},$9oG:function(){this.set_$1tm(_nbs.NonBootStrings.l_DeleteEvent_Text);this.set_$3nS(_nbs.NonBootStrings.l_AreYouSureYouWantToDeleteThisEvent_Text);var n=new _js.$c;n.$D(new _a.$2E(new _C(this.$$d_$9ng,_d.$G5.$A),_nbs.NonBootStrings.l_DeleteButtonLabel_Text));n.$D(new _a.$2E(this.$Pr,_nbs.NonBootStrings.l_ConfirmDialog_Back_Text));this.set_$2tA(n);this.set_$OQ(!0)},$7fD:function(){this.set_$1tm(_nbs.NonBootStrings.l_CancelEvent_Text);this.set_$3nS(_nbs.NonBootStrings.l_AreYouSureYouWantToCancelTheEvent_Text);var n=new _js.$c;n.$D(new _a.$2E(new _C(this.$$d_$7f3,_d.$G5.$A),_u.Strings.l_Yes_Text,_nbs.NonBootStrings.l_YouWillHaveAnOpportunityToTypeAMessageToAttendees_Text));n.$D(new _a.$2E(this.$Pr,_nbs.NonBootStrings.l_ConfirmDialog_Back_Text,_nbs.NonBootStrings.l_ReturnToTheEvent_Text));this.set_$2tA(n);this.set_$OQ(!0)},$9ng:function(){this.$Pr.$s();this.$5p.$Tg.$s()},$7f3:function(){this.$Pr.$s();this.$5p.$7I.$s()}};_d.$Is=function(n){this.$$d_$9P5=Function.createDelegate(this,this.$9P5);_d.$Is.initializeBase(this);this.$1A=n};function $4ph(n){if($5(n.$2g)){n.$2QZ="";return}n.$2g.get_$Ao()?n.$2g.get_$y().$9K(n.$2g.get_$20())?n.$2g.get_$5R()?$2kl(n,8,8):$2kl(n,11,11):n.set_$5ei(n.$2g.get_$y().$2b(8)):n.$2g.get_$1eg()?$2kl(n,11,11):$2kl(n,11,18)}function $2kl(n,t,i){n.set_$5ei(String.format(_nbs.NonBootStrings.l_CalendarDragDrop_InfoTip_Text,n.$2g.get_$y().$2b(t),n.$2g.get_$20().$2b(i)))}_d.$Is.prototype={$1A:null,$2g:null,$2QZ:null,get_$5Q:function(){return this.$2g},set_$5Q:function(n){if(this.$2g!==n){if(this.$2g){this.$2g.$q("Start",this.$$d_$9P5);this.$2g.$q("End",this.$$d_$9P5)}this.$2g=n;$4ph(this);if(this.$2g){this.$2g.$Y("Start",this.$$d_$9P5);this.$2g.$Y("End",this.$$d_$9P5)}}return n},get_$5ei:function(){return this.$2QZ},set_$5ei:function(n){if(this.$2QZ!==n){this.$2QZ=n;$3(this,"InfoTipString")}return n},get_$nd:function(){return!this.$1A.get_$y8()},$9P5:function(n,t){$4ph(this)}};_d.$5e=function(n,t){this.$$d_$9bY=Function.createDelegate(this,this.$9bY);this.$$d_$9Na=Function.createDelegate(this,this.$9Na);this.$$d_$3JA=Function.createDelegate(this,this.$3JA);_d.$5e.initializeBase(this,[new Array(0)]);_a.$3.$K(n,"calendarItemViewModel");this.$p=n;n.$v.get_$Gj()&&(this.$uF=this.$p.$1aY());if(t){this.$qZ=n.$v.get_$Gj()?t.$8V(this.$uF.$v):t.$8V(n.$v);this.$qZ&&this.$qZ.add_$2sA(this.$$d_$3JA)}$6yu(this)};_d.$5e.$1rL=function(n,t){var i=n.length;t();n.length!==i&&Array.add(n,new _0365m.$8w)};_d.$5e.$2Od=function(n,t,i,r,u){if(u&&r){var f=new _0365m.$2c([new _0365m.$o(t,null,r),new _0365m.$o(i,null,u)]);return new _0365m.$HH(n,null,f)}return u?new _0365m.$o(i,null,u):r?new _0365m.$o(n,null,r):null};_d.$5e.$3ws=function(n,t){if(!t){_js.Trace.logWarning(_a.$0.$1c,"Empty context sub-menu generated for item. OptionText: {0}",n);return new _0365m.$HH(n,null,new _0365m.$2c([]))}for(var r=t.$14.get_$C(),u=new Array(r),i=0;i<r;++i)u[i]=t.$14.get_$3o(i).$3g();return new _0365m.$HH(n,null,new _0365m.$2c(u))};_d.$5e.$5Vx=function(n,t,i){if($5(i))return new _0365m.$o(n,null,t);for(var u=i.$14.get_$C(),f=new Array(u),r=0;r<u;++r)f[r]=i.$14.get_$3o(r).$3g();return new _0365m.$HH(n,null,new _0365m.$2c(f))};function $6yu(n){if(n.$p.$v.get_$1MQ()){var t=[];var i=n.$p.$v;var r=i.get_$Gj();var f=this;_d.$5e.$1rL(t,function(){i.get_$wV()&&Array.add(t,new _0365m.$o(_nbs.NonBootStrings.l_JoinOnlineMeeting_LowerCase_Text,null,n.$p.$b1))});var e=this;_d.$5e.$1rL(t,function(){i.get_$Ue()&&!i.get_$Hq()&&Array.add(t,new _0365m.$o(_cc.$Jn.$5ZA(n.$p.$v,1),null,n.$p.$5p.$Tg))});var o=this;_d.$5e.$1rL(t,function(){Array.add(t,_d.$5e.$2Od(_nbs.NonBootStrings.l_Open_LowerCase_Text,_nbs.NonBootStrings.l_OpenOccurrence_LowerCase_Text,_nbs.NonBootStrings.l_OpenSeries_LowerCase_Text,n.$p.$h0.$ic(1,!1),r?n.$p.$h0.$ic(1,!0):null))});$6yv(n,t);if(i.get_$12n()){Array.add(t,$6yq(n));if(n.$qZ){n.$1Zg=n.$qZ.$3xI();if(n.$1Zg){n.$1Zg.$I9.$Y("IsShown",n.$$d_$9Na);Array.add(t,n.$1Zg)}}Array.add(t,new _0365m.$8w)}$6yt(n,r,t,i);$6ys(n,r,t,i);t.length>0&&Array.removeAt(t,t.length-1);for(var u=0;u<t.length;u++)t[u].set_$uE(n);n.$14.$6S(t)}}function $6yv(n,t){var i=n.$p.$v;var r=i.get_$Gj();var u=this;_d.$5e.$1rL(t,function(){i.get_$fJ()&&Array.add(t,new _0365m.$o(_u.Strings.l_Reply_LowerCase_Text,null,n.$p.$Qj.$Ir));i.get_$iP()&&Array.add(t,new _0365m.$o(_u.Strings.l_ReplyAll_LowerCase_Text,null,n.$p.$Qj.$JT));var r=$6yr(n);r&&Array.add(t,r)})}function $6yr(n){var t=null;var i=null;if(n.$p.$v.get_$Gj()){i=n.$uF.$Qj.$IN;n.$p.$v.get_$fI()&&(t=n.$p.$Qj.$IN)}else n.$p.$v.get_$fI()&&(t=n.$p.$Qj.$IN);return _d.$5e.$2Od(_u.Strings.l_Forward_LowerCase_Text,_nbs.NonBootStrings.l_ForwardOccurrence_LowerCase_Text,_nbs.NonBootStrings.l_ForwardSeries_LowerCase_Text,t,i)}function $6ys(n,t,i,r){var u=n.$p.$Rg;var f=this;_d.$5e.$1rL(i,function(){n.$p.$v.get_$az()||!r.get_$JC()||r.get_$Hq()||r.get_$Ue()?n.$p.$5p.$Tg.$2T&&!r.get_$Ue()&&Array.add(i,_d.$5e.$2Od(_u.Strings.l_Delete_LowerCase_Text,_nbs.NonBootStrings.l_DeleteOccurrence_LowerCase_Text,_nbs.NonBootStrings.l_DeleteSeries_LowerCase_Text,n.$p.$5p.$Tg,t?n.$uF.$5p.$Tg:null)):r.get_$EE()?Array.add(i,_d.$5e.$3ws(_u.Strings.l_Delete_LowerCase_Text,u.$2LU)):Array.add(i,_d.$5e.$5Vx(_u.Strings.l_Delete_LowerCase_Text,u.$2vH,u.$2LU));r.get_$iN()&&Array.add(i,_d.$5e.$2Od(_nbs.NonBootStrings.l_CancelMeeting_LowerCase_Text,_nbs.NonBootStrings.l_CancelOccurrence_LowerCase_Text,_nbs.NonBootStrings.l_CancelSeries_LowerCase_Text,n.$p.$5p.$7I,t?n.$uF.$5p.$7I:null))})}function $6yt(n,t,i,r){var u=n.$p.$Rg;var f=this;_d.$5e.$1rL(i,function(){if(n.$p.$v.get_$az())r.get_$Ue()||Array.add(i,_d.$5e.$2Od(_nbs.NonBootStrings.l_AddToMyCalendar_Lowercase_Text,_nbs.NonBootStrings.l_AddToMyCalendar_Occurrence_Text,_nbs.NonBootStrings.l_AddToMyCalendar_Series_Text,n.$p.$5p.$3hf,t?n.$uF.$5p.$3hf:null));else{$3aZ(n,r.get_$1BS(),i,r.get_$EE(),_nbs.NonBootStrings.l_AcceptItem_LowerCase_Text,u.$2GW,u.$3gT);$3aZ(n,r.get_$1BW(),i,r.get_$EE(),_nbs.NonBootStrings.l_TentativelyAcceptItem_LowerCase_Text,u.$2i2,u.$4fc);$3aZ(n,r.get_$12l(),i,r.get_$EE(),_nbs.NonBootStrings.l_DeclineItem_LowerCase_Text,u.$2L9,u.$2vH);u.get_$2rw()&&Array.add(i,_d.$5e.$3ws(_ucmm.MeetingMsgStrings.l_ProposeNewTime_LowerCase_Text,u.$4Uf))}})}function $3aZ(n,t,i,r,u,f,e){t&&(r?Array.add(i,_d.$5e.$3ws(u,f)):Array.add(i,_d.$5e.$5Vx(u,e,f)))}function $6yq(n){for(var u=null,t=0;t<_d.$5e.$2C0.length;t++)_d.$5e.$2C0[t].$3Z===n.$p.$v.get_$99()&&(u=_d.$5e.$2C0[t]);var i=new _d.$Ul(_nbs.NonBootStrings.l_Calendar_ItemContextMenu_ShowAs_Text,null,n.$$d_$9bY,_d.$5e.$2C0,u);i.set_$6f3(!1);i.set_$2a(!n.$p.$v.get_$2Ru());for(var r=0;r<_d.$5e.$2C0.length;r++)i.$I9.$14.get_$3o(r).$224="CalendarItemTemplates.ShowAsMenuItemTemplate";return i}_d.$5e.prototype={$p:null,$uF:null,$1Zg:null,$qZ:null,$49:function(){if(this.$qZ){this.$qZ.remove_$2sA(this.$$d_$3JA);this.$1Zg&&this.$1Zg.$I9.$q("IsShown",this.$$d_$9Na)}_js.$9.prototype.$49.call(this)},$9Na:function(n,t){this.$1Zg.$I9.$30&&this.$qZ.$4Th()},$9bY:function(n){if(this.$uF){this.$uF.$v.set_$99(n);this.$uF.$5p.$BS()}else{this.$p.$v.set_$99(n);this.$p.$5p.$BS()}},$3JA:function(){if(this.$uF){this.$uF.$v.set_$6T(this.$qZ.get_$5FH());this.$uF.$5p.$BS()}else{this.$p.$v.set_$6T(this.$qZ.get_$5FH());this.$p.$5p.$BS()}}};_d.$CN=function(n,t,i,r,u,f,e,o,s){this.$$d_$1Qq=Function.createDelegate(this,this.$1Qq);_d.$CN.initializeBase(this);_a.$3.$m(n,"item");this.$k5=t;this.$3Ly=f;this.$1FX=i;this.$Je=r;this.$2rN=u;this.$1RE=e;this.$mM=o;this.$Vb=s;$6zV(this,n)};function $6zU(n){n.$8GQ();n.$h0=n.$2rN.$8V(n);n.$Qj=n.$k5.$8V(n.$v,null,n.$1RE.$$d_$E);n.$EO=new _cc.$10n(n.$v,new _g.$1DG,n.$v.get_$y(),n.$v.get_$20())}function $6zV(n,t){t.$3RZ();n.set_$1Tl(t);n.set_$5Q(n.$6c.$3g())}_d.$CN.prototype={$YE:!1,$k5:null,$3Ly:null,$1FX:null,$Je:null,$2rN:null,$1RE:null,$Vb:null,$mM:null,$6c:null,$v:null,$Qj:null,$5p:null,$h0:null,$EO:null,$b1:null,$5T0:!1,$Rg:null,get_$1Q9:function(){return $5(this.$6c.get_$i())&&$5(this.$v.get_$i())},get_$1Ke:function(){return this.$6c.get_$JC()||this.$v.get_$JC()},get_$AFj:function(){return this.$6c.get_$JC()&&this.$v.get_$JC()},get_$8UD:function(){return this.$Rg},set_$8UD:function(n){if(this.$Rg!==n){this.$Rg=n;$3(this,"MeetingResponseViewModel")}return n},get_$5Q:function(){return this.$v},set_$5Q:function(n){if(this.$v!==n){this.$v=n;$6zU(this);this.set_$hI(this.$v.get_$PU()?this.$v.get_$ub():_d.$CN.$1TP);var t=this;this.set_$21y(new _C(this.$$d_$1Qq,_d.$CN.$A,this.$v,"CanJoin",function(){return t.$v.get_$wV()}));$3(this,"CalendarItem")}return n},get_$hI:function(){return this.$v.get_$PU()?this.$v.get_$ub():_d.$CN.$1TP},set_$hI:function(n){if(this.get_$hI()!==n){this.$v.set_$PU(n!==_d.$CN.$1TP);this.$v.get_$PU()&&this.$v.get_$ub()!==n&&this.$v.set_$ub(n);$3(this,"ReminderSelectedValue")}return n},get_$21y:function(){return this.$b1},set_$21y:function(n){if(this.$b1!==n){this.$b1=n;$3(this,"JoinCommand")}return n},get_$1zS:function(){if($5(this.$6c.get_$28())){if(!_g.$h.$1i.doesIdEqualName(this.$v.get_$28(),"calendar"))return!0}else if(this.$5hQ())return!0;return this.get_$5cH()},get_$5cH:function(){return this.$6c.get_$2i()!==this.$v.get_$2i()||this.$6c.get_$5R()!==this.$v.get_$5R()||!_a.$7.$4N(this.$6c.get_$y(),this.$v.get_$y())||!_a.$7.$4N(this.$6c.get_$20(),this.$v.get_$20())||this.$6c.get_$99()!==this.$v.get_$99()||this.$6c.get_$PU()!==this.$v.get_$PU()||this.$6c.get_$ub()!==this.$v.get_$ub()||this.$6c.get_$8F()!==this.$v.get_$8F()||this.$6c.get_$EE()!==this.$v.get_$EE()||!_g.$C.$4N(this.$6c.get_$4g(),this.$v.get_$4g())||!_g.$C.$4N(this.$6c.get_$M2(),this.$v.get_$M2())||_g.$3i.$1Lo(this.$6c.get_$7G(),this.$v.get_$7G())||_g.$3i.$1Lo(this.$6c.get_$8D(),this.$v.get_$8D())||_g.$3i.$1Lo(this.$6c.get_$9F(),this.$v.get_$9F())||_g.$O3.$5CT(this.$6c.get_$nP(),this.$v.get_$nP())||_g.$y.$5CP(this.$6c.get_$6T(),this.$v.get_$6T())||this.$5T0?!0:this.$v.get_$5c1()},get_$8Ci:function(){return _g.$3i.$1Lo(this.$6c.get_$7G(),this.$v.get_$7G())||_g.$3i.$1Lo(this.$6c.get_$8D(),this.$v.get_$8D())},get_$1Tl:function(){return this.$6c},set_$1Tl:function(n){if(this.$6c!==n){this.$6c=n;this.$5Km()}return n},get_$DI:function(){return this.$YE},set_$DI:function(n){this.$YE=n;$3(this,"IsDraft");return n},get_$2i:function(){return this.$v.get_$2i()},$5hQ:function(){return!$5(this.$6c.get_$28())&&!$5(this.$v.get_$28())&&!_g.$28.$4N(this.$v.get_$28(),this.$6c.get_$28())},$ABQ:function(n){this.set_$5Q(n)},$ABR:function(n){this.set_$5Q(n);this.$AD5()},$1aY:function(){if(!this.$v.get_$Gj())throw Error.invalidOperation("Cannot create partial recurring master model from a non-recurring event.");var n=this.$mM.$1aY(this.$6c);return this.$Je.$8V(n)},$AD5:function(){this.$6c.$2ED(this.$v.get_$3C());this.$5Km()},$iq:function(){this.set_$5Q(this.$6c.$3g())},$5rE:function(){this.$5T0=!0},$8GQ:function(){this.$5p=this.$3Ly.$E(this)},$5Km:function(){this.set_$8UD(this.$1FX.$8V(this.$6c,1))},$1Qq:function(){this.$Vb.$TS(this.$v.get_$2Ti())}};_d.$PB=function(n,t,i,r,u,f,e,o){this.$k5=n;this.$1FX=t;this.$mM=e;this.$1A=r;this.$3Ly=i;this.$2rN=u;this.$1RE=f;this.$Vb=o};_d.$PB.prototype={$k5:null,$1FX:null,$1A:null,$3Ly:null,$mM:null,$1RE:null,$2rN:null,$Vb:null,get_$9ge:function(){return this.$3Ly},get_$2Ut:function(){return this.$1RE.get_$1n()},get_$7eQ:function(){return this.$2rN.get_$1n()},$8V:function(n){return new _d.$CN(n,this.$k5,this.$1FX,this,this.get_$7eQ(),this.get_$9ge(),this.get_$2Ut(),this.$mM,this.$Vb)}};_d.$5f=function(n,t,i,r,u,f){this.$$d_$7yN=Function.createDelegate(this,this.$7yN);this.$$d_$7yL=Function.createDelegate(this,this.$7yL);this.$$d_$7yM=Function.createDelegate(this,this.$7yM);this.$$d_$7yK=Function.createDelegate(this,this.$7yK);this.$$d_$4Y5=Function.createDelegate(this,this.$4Y5);this.$$d_$6bf=Function.createDelegate(this,this.$6bf);this.$$d_$9uQ=Function.createDelegate(this,this.$9uQ);this.$$d_$BS=Function.createDelegate(this,this.$BS);this.$$d_$9J=Function.createDelegate(this,this.$9J);this.$$d_$34=Function.createDelegate(this,this.$34);this.$$d_$7ZH=Function.createDelegate(this,this.$7ZH);this.$$d_$7ZI=Function.createDelegate(this,this.$7ZI);_d.$5f.initializeBase(this);this.$1W=t;this.$B=i;this.$95=f;this.$g=n;this.$7A=r;this.$1RE=u;$6zN(this);var e=this;this.$3hf=new _C(this.$$d_$7ZI,_d.$5f.$A,this,"CanAddToMyCalendar",function(){return e.get_$1BT()});var o=this;this.$2oZ=new _C(this.$$d_$7ZH,_d.$5f.$A,this,"CanAddToMyCalendar",function(){return o.get_$1BT()});var s=this;this.$Tg=new _C(this.$$d_$34,_d.$5f.$A,this,"CanRemove",function(){return s.get_$Vp()});var h=this;this.$7I=new _C(this.$$d_$9J,_d.$5f.$A,this,"CanCancel",function(){return h.get_$iN()});var c=this;this.$DO=new _C(this.$$d_$BS,_d.$5f.$A,this,"CanSave",function(){return c.get_$1ZZ()});var l=this;this.$4Zq=new _C(this.$$d_$9uQ,_d.$5f.$A,this,"CanSend",function(){return l.get_$mT()});var a=this;this.$6bg=new _C(this.$$d_$6bf,_d.$5f.$A,this,"CanSend",function(){return a.get_$mT()});var v=this;this.$6ZG=new _C(this.$$d_$4Y5,_d.$5f.$A,this,"CanSaveDraft",function(){return v.get_$7fY()});var y=this;this.$3sL=new _C(this.$$d_$34,_d.$5f.$A,this,"CanDiscardDraft",function(){return y.get_$7fG()})};function $4pu(n,t){n.$i5=_a.$6.$1X(_d.$5f.$A,t,!0);_a.$6.stPT(_d.$5f.$A,t,3);var r=new _g.$W3;r.ItemId=_h.$7b.$3xz(n.$g.$6c);var u=_g.$2o.$1xT(n.$g.$6c);var i=new _cc.$ic(r,u);var f=this;i.add_$21(function(i){if(n.$i5){_a.$6.$19(n.$i5,null,_cc.$1Lo.$6v.$ft(i),_cc.$1Lo.$6v.$Q6(i),null);n.$i5=null}_a.$6.endPT(t);_cc.$5o.$1DI(i)});var e=this;i.add_$29(function(r){$1q4(n,"AddCalendarItemToMyCalendarAction",i);if(n.$i5){_a.$6.$19(n.$i5,null,"",_cc.$1Lo.$6v.$Q6(r),null);n.$i5=null}_a.$6.endPT(t)});n.$1W.$11(i)}function $6zM(n,t,i){var u=t?2:0;var r=n.$g.$v;if(i){r=n.$g.$6c;r.set_$y(n.$g.$v.get_$y().$i6(1));r.set_$20(n.$g.$v.get_$20().$i6(1))}else $5(n.$g.$v.$IO)||n.$g.$v.$IO.$s();return new _cc.$9i(r,u,_cc.$6R.$30q(r),_g.$2o.$1xT(r))}function $2FG(n,t,i,r,u){if(t&&i)throw Error.invalidOperation("Cannot send and save as draft.");var f=new(_0365f.$n.$$(_a.$2X));var h=!1;if(n.$g.get_$1Q9())f.$D($6zM(n,t,i));else{if(i)throw Error.invalidOperation("Cannot save a draft of an existing calendar item.");$5(n.$g.$v.$IO)||n.$g.$v.$IO.$s();if(n.$g.get_$5cH()){var c=new _cc.$Ft(n.$g.$6c,n.$g.$v,r,n.$g.$6c.get_$JF(),_cc.$6R.$30q(n.$g.$v),_g.$2o.$1xT(n.$g.$6c));f.$D(c);n.$95.$7vH(c)}if(n.$g.$5hQ()){h=!0;var a=n.$85Y();f.$D(a)}}if(f.get_$C()>0){for(var e=null,l=f.get_$3O(),v=l.length,o=0;o<v;++o){var s=l[o];$6zO(n,s,u);if(e){var p=this;e.add_$29(function(t){n.$1W.$11(s)})}e=s}var y=f.get_$3o(f.get_$C()-1);$6zP(n,y,i,h,t);n.$1W.$11(f.get_$3o(0))}else $1q4(n,t?"SendCalendarItemAction":"SaveCalendarItemAction",null)}function $6zO(n,t,i){var r=this;t.add_$21(function(t){i||_cc.$5o.$1DI(t);$1q4(n,"PersistActionFailed",t)})}function $6zP(n,t,i,r,u){var f=this;t.add_$29(function(f){var e;e=i?"SaveDraftCalendarItemAction":r?"MoveCalendarItemAction":u?"SendCalendarItemAction":"SaveCalendarItemAction";$1q4(n,e,t)})}function $1q4(n,t,i){$BF(n,"Completed",t,i)}function $6zN(n){n.$g.$v.$3RZ();n.$g.$v.$Y("RequiredAttendees",n.$$d_$7yK);n.$g.$v.$Y("OptionalAttendees",n.$$d_$7yK);n.$g.$v.$Y("Resources",n.$$d_$7yK);n.$g.$v.$Y("IsCancelled",n.$$d_$7yM);n.$g.$v.$3O9(n.$$d_$7yL);n.$g.$Y("IsDraft",n.$$d_$7yN)}function $4pv(n){$3u(n,"CanSend","CanSave")}_d.$5f.prototype={$3hf:null,$2oZ:null,$Tg:null,$7I:null,$DO:null,$4Zq:null,$6bg:null,$6ZG:null,$3sL:null,$1RE:null,$g:null,$1W:null,$B:null,$7A:null,$95:null,$i5:null,add_$2t:function(n){this.$2G("Completed",n)},remove_$2t:function(n){this.$2H("Completed",n)},get_$1BT:function(){return!this.$B.get_$FG()&&this.$g.$6c.get_$1BT()&&!this.$g.$6c.get_$Ue()},get_$7fE:function(){return this.get_$1BT()&&!this.$g.$6c.get_$Hq()},get_$Vp:function(){return this.get_$12n()&&(this.$g.$6c.get_$Ue()||this.$g.$6c.get_$Vp())},get_$iN:function(){return this.$g.$6c.get_$iN()&&this.$g.$6c.get_$JC()},get_$1ZZ:function(){return!this.$g.get_$1Ke()&&!this.$g.$v.get_$Ue()&&this.$g.$v.get_$Hq()},get_$mT:function(){return this.$g.get_$1Ke()&&this.$g.$v.get_$Hq()},get_$7fY:function(){return this.$g.$v.get_$Hq()},get_$7fG:function(){return this.$g.$YE},get_$fH:function(){return!this.$B.get_$FG()&&this.$g.$v.get_$fH()},get_$12n:function(){return!this.$B.get_$FG()&&this.$g.$v.get_$12n()},get_$1MQ:function(){return(!this.$B.get_$FG()||!_d.$1s.$3sG&&!this.$g.$v.get_$dB())&&this.$g.$v.get_$1MQ()},get_$8Sd:function(){return this.$1RE.$E()},$7ZI:function(){$4pu(this,"AddToMyCalendarFromSurfaceContextMenu")},$7ZH:function(){$4pu(this,"AddToMyCalendarFromCalendarReadingPaneOrPeekForm")},$34:function(){var t=this.$g.$6c;t.get_$47Z()&&(t=this.$g.$1aY().$v);var i=_cc.$1Lo.$1c.$A3w(t.get_$az());var n=new _c.$15N(t,"MoveToDeletedItems",_cc.$6R.$30q(this.$g.$v),_g.$2o.$1xT(this.$g.$6c));n.$4Zk=2;var u=this;n.add_$21(function(n){i&&_a.$6.$19(i,null,_cc.$1Lo.$6v.$ft(n),_cc.$1Lo.$6v.$Q6(n),null);_cc.$5o.$1DI(n)});var r=this;n.add_$29(function(t){i&&_a.$6.$19(i,null,"",_cc.$1Lo.$6v.$Q6(t),null);$1q4(r,"RemoveCalendarItemAction",n)});this.$1W.$11(n)},$9J:function(){var n=this.get_$8Sd();var t=this.$7mj();this.$B.get_$9l()&&$1q4(this,"CancelCalendarItemAction",null);n.$TO(t)},$7mj:function(){var n=this.$7A.$Fx(!0,!1);n.set_$3w(8);n.set_$NA(!0);var t=_g.$2o.$1xT(this.$g.$6c);n.set_$149(t);t&&n.set_$5ea(!0);if(this.$g.$6c.get_$yR()){this.$g.$v.$IO&&this.$g.$v.$IO.$s();n.$yB(this.$g.$6c)}else{n.set_$15W(!0);n.set_$dv(this.$g.$6c.get_$i());n.set_$s8(_g.$2o.$s8(this.$g.$6c))}return n},$BS:function(){$2FG(this,!1,!1,0,!1)},$9s3:function(){$2FG(this,!1,!1,0,!0)},$9uQ:function(){$2FG(this,!0,!1,3,!1)},$6bf:function(){$2FG(this,!0,!1,4,!1)},$4Y5:function(){$2FG(this,!1,!0,0,!1)},$6Q:function(){this.$g.get_$1Ke()?this.$6bf():this.$BS()},$85Y:function(){return new _h.$KJ([this.$g.$v],this.$g.$v.get_$28(),0)},$7yK:function(n,t){this.$g.$v.$3O9(this.$$d_$7yL);$4pv(this)},$7yL:function(n,t){$4pv(this)},$7yM:function(n,t){$3(this,"CanSave")},$7yN:function(n,t){$3(this,"CanDiscardDraft")}};_d.$oh=function(n,t,i,r,u){this.$1W=n;this.$B=t;this.$95=u;this.$7A=i;this.$1RE=r};_d.$oh.prototype={$1RE:null,$1W:null,$B:null,$7A:null,$95:null,get_$3kf:function(){return this.$95},get_$2Ut:function(){return this.$1RE.get_$1n()},$E:function(n){return new _d.$5f(n,this.$1W,this.$B,this.$7A,this.get_$2Ut(),this.get_$3kf())}};_d.$CM=function(n,t,i,r,u){_d.$CM.initializeBase(this);this.$B=n;this.$p=r;this.$Ev=i;this.$LG=t;this.$2M=u};function $6zD(n){if(n.$2b2){_a.$6.$19(n.$2b2);n.$2b2=null}_a.$6.endPT("OpenCalendarItemOnReadingPane")}function $6zC(n){if(n.$2b1){_a.$6.$19(n.$2b1);n.$2b1=null}_a.$6.endPT("OpenCalendarItemOnComposeForm")}function $6zB(n,t,i,r){$4po(n,n.$LG,t);_a.$6.stPT(_a.$0.$6y,"OpenCalendarItemOnReadingPane",3);n.$2b2=t?_a.$6.$1X(_a.$0.$6y,"OpenCalendarSeriesItemOnReadingPane",!0):_a.$6.$1X(_a.$0.$6y,"OpenCalendarItemOnReadingPane",!0);var u=$4pp(n,t);var f=$4pn(n);var s=this;var e=function(t){r&&r(t);$6zD(n)};var o=n.$LG.$br(u.$3E,null,e);n.$B.$fj(o,f,!1);i&&i()}function $4pn(n){if(n.$B.get_$9l()){var t=n.$B.$aZ();return _d.$3d.isInstanceOfType(t.get_$7T())||_d.$z.isInstanceOfType(t.get_$7T())?1:0}else return 1}function $6zA(n,t,i,r){$4po(n,n.$Ev,t);_a.$6.stPT(_a.$0.$6y,"OpenCalendarItemOnComposeForm",3);n.$2b1=t?_a.$6.$1X(_a.$0.$6y,"OpenCalendarSeriesItemOnComposeForm",!0):_a.$6.$1X(_a.$0.$6y,"OpenCalendarItemOnComposeForm",!0);var u=$4pp(n,t);var f=$4pn(n);var e=_a.$6.acss(_a.$0.$6y,"Setting ComposeCalendarItemVM");var h=this;var o=function(t){r&&r(t);$6zC(n)};var s=n.$Ev.$br(u.$3E,null,o);_a.$6.aces(e);n.$B.$fj(s,f,!1);i&&i()}function $4pp(n,t){var i=new _y.$9S;t?i.$9xC(new _h.$7b(n.$p.$v.get_$i())):i.$ZT(n.$p.$v.get_$i());var r=n.$2M.$1xE(n.$p.$v.get_$28());r&&r.get_$Mj()&&i.set_$149(r.get_$AX());return i}function $4po(n,t,i){}_d.$CM.prototype={$LG:null,$Ev:null,$B:null,$p:null,$2M:null,$2b2:null,$2b1:null,get_$2rr:function(){return this.get_$5GC()||this.get_$5GD()},get_$5GC:function(){return this.$p.$5p.get_$fH()},get_$7fP:function(){return this.$p.$5p.get_$fH()&&this.get_$5GE()},get_$5GD:function(){return this.$p.$5p.get_$1MQ()},get_$7fQ:function(){return this.$p.$5p.get_$1MQ()&&this.get_$5GE()},get_$5GE:function(){return this.$p.$v.get_$Gj()},$ic:function(n,t,i,r){var e=null;var u=null;var f=null;switch(n){case 1:var o=this;e=function(){$6zB(o,t,i,r)};u="CanOpenItemInRead";var s=this;f=function(){return s.get_$5GD()};if(t){u="CanOpenSeriesInRead";var h=this;f=function(){return h.get_$7fQ()}}break;case 0:var c=this;e=function(){$6zA(c,t,i,r)};u="CanOpenItemInCompose";var l=this;f=function(){return l.get_$5GC()};if(t){u="CanOpenSeriesInCompose";var a=this;f=function(){return a.get_$7fP()}}break}return new _C(e,_d.$CM.$A,this,u,f)}};_d.$og=function(n,t,i,r){this.$Ev=n;this.$LG=t;this.$B=i;this.$2M=r};_d.$og.prototype={$B:null,$Ev:null,$LG:null,$2M:null,$8V:function(n){return new _d.$CM(this.$B,this.$LG,this.$Ev,n,this.$2M)}};_d.$Lx=function(){this.$$d_$417=Function.createDelegate(this,this.$417);this.$$d_$7qx=Function.createDelegate(this,this.$7qx);this.$$d_$7qw=Function.createDelegate(this,this.$7qw);this.$$d_$7r7=Function.createDelegate(this,this.$7r7);_d.$Lx.initializeBase(this);var n=this;this.$3rc=new _C(this.$$d_$7r7,this.get_$1a(),this,"CanDeleteItemOrSeries",function(){return n.get_$7fF()})};_d.$Lx.$im=function(n){var t=n.$5p;var i=n.$Rg;t.$Tg.$2T?t.$Tg.$s():t.$7I.$2T?t.$7I.$s():i.$r5.$2T&&i.$r5.$s()};function $6zQ(n){if(!n.$1bA){var t=new _js.$c;t.$D(new _a.$2E(new _C(n.$$d_$7qw,n.get_$1a()),_ucmm.MeetingMsgStrings.l_Occurrence_LowerCase_Text));t.$D(new _a.$2E(new _C(n.$$d_$7qx,n.get_$1a()),_ucmm.MeetingMsgStrings.l_Series_LowerCase_Text));t.$D(new _a.$2E(new _C(n.$$d_$417,n.get_$1a()),_nbs.NonBootStrings.l_ConfirmDialog_Back_Text));n.set_$7rO(t)}}function $6zR(n){n.set_$2Rf(!0)}_d.$Lx.prototype={$3rc:null,$1zm:!1,$1bA:null,$39:null,get_$yw:function(){return this.$39},set_$yw:function(n){this.$39=n;$3u(this,"ItemViewModel","CanDeleteItemOrSeries");return n},get_$7fF:function(){return!$5(this.$39)&&!this.$39.get_$1Q9()&&(this.$39.$5p.get_$Vp()||this.$39.$5p.get_$iN()||this.$39.$Rg.get_$12l())},get_$2Rf:function(){return this.$1zm},set_$2Rf:function(n){if(this.$1zm!==n){this.$1zm=n;$3(this,"IsDeleteRecurringEventDialogShown")}return n},get_$7rO:function(){return this.$1bA},set_$7rO:function(n){if(n!==this.$1bA){this.$1bA=n;$3(this,"DeleteRecurringEventDialogButtonData")}return n},get_$1a:function(){return _a.$0.$1c},$7r7:function(){if(this.$39){var n=this.$39.$v;if(n.get_$Gj()){$6zQ(this);$6zR(this)}else _d.$Lx.$im(this.$39)}},$7qw:function(){this.$417();_d.$Lx.$im(this.$39)},$7qx:function(){this.$417();var n=this.$39.$1aY();_d.$Lx.$im(n)},$417:function(){this.set_$2Rf(!1)}};_d.$En=function(){};_d.$En.$7uD=function(n){return String.format("\tStart: '{0}', End: '{1}', ItemId: '{2}'",n.get_$y(),n.get_$20(),_d.$En.$1Ct(n))};_d.$En.$1Ct=function(n){var t=n.get_$i();return!t||!t.Id?"<null>":t.Id};_d.$1NB=function(){_d.$1NB.initializeBase(this)};_d.$9B=function(){};_d.$9B.$E=function(n,t,i,r){var f=_a.$6.$1X(n,t,!0);_a.$6.acsa(n,t);var u=null;if(f){u=new _d.$9B;u.$1C5=f;u.$6qD=i;u.$lK=t;u.$1z=n;u.$3u3=r}return u};function $3ab(n,t){_a.$6.acea(null,n.$lK);n.$6qD&&n.$1C5&&_a.$6.$19(n.$1C5,null,t,n.$137,n.$3qV);_a.$6.endPT(null)}_d.$9B.prototype={$1C5:null,$lK:null,$3qV:null,$6qD:!1,$3u3:!1,$5Su:1,$1z:null,$137:null,$8TU:function(){--this.$5Su>0||$3ab(this)},$7zU:function(n){$3ab(this,n)},$5Ru:function(){this.$3u3?_js.Trace.logWarning(this.$1z,"EndTrace was called for an animation based scenario."):$3ab(this)}};_d.$M0=function(n,t){_d.$M0.resolveInheritance();this.apcl=this.$Y;this.rpcl=this.$q;_d.$M0.initializeBase(this,[n]);_a.$3.$m(t,"date");this.$7v=t;var i=_d.$M0.$5Y0(t,n);this.$2R=i.$2R;this.$3H=i.$3H};_d.$M0.$5Y0=function(n,t){var i;var r;i=n.$2U(t.get_$y())>0?n:t.get_$y();var u=n.$2w(1);r=u.$2U(t.get_$20())<0?u:t.get_$20();return new _h.$4i(i,r)};_d.$M0.prototype={$7v:null,$2R:null,$3H:null,get_$5n:function(){return this.$7v},set_$5n:function(n){this.$7v=n;return n},get_$y:function(){return this.$2R},get_$20:function(){return this.$3H}};_d.$1N1=function(n){this.$$d_$3kz=Function.createDelegate(this,this.$3kz);_d.$1N1.resolveInheritance();this.apcl=this.$Y;this.rpcl=this.$q;_d.$1N1.initializeBase(this);_a.$3.$m(n,"calendarItemModel");this.$2g=n;this.$2g.add_$83(this.$$d_$3kz)};_d.$1N1.prototype={$2g:null,get_$i:function(){return this.$2g.get_$i()},get_$y:function(){return this.$2g.get_$y()},get_$20:function(){return this.$2g.get_$20()},get_$2i:function(){return this.$2g.get_$2i()},get_$5R:function(){return this.$2g.get_$5R()},get_$99:function(){return this.$2g.get_$99()},get_$5V:function(){return this.$2g.get_$5V()},get_$ju:function(){return this.$2g.get_$ju()},get_$2bE:function(){return this.$2g.get_$2bE()},get_$Gj:function(){return this.$2g.get_$Gj()},get_$20e:function(){return this.$2g.get_$20e()},get_$2Ru:function(){return this.$2g.get_$2Ru()},get_$G5:function(){return this.$2g.get_$G5()},get_$dB:function(){return this.$2g.get_$dB()},get_$4g:function(){return this.$2g.get_$4g()},get_$Ao:function(){return this.$2g.get_$Ao()},get_$1eg:function(){return this.$2g.get_$1eg()},get_$FS:function(){return this.$2g.get_$FS()},get_$48D:function(){return this.$2g.get_$48D()},get_$Hq:function(){return this.$2g.get_$Hq()},get_$fH:function(){return this.$2g.get_$fH()},$49:function(){this.$2g.remove_$83(this.$$d_$3kz);_a.$1.prototype.$49.call(this)},$3kz:function(n,t){$3(this,t)}};_d.$aw=function(n,t,i,r,u,f,e){this.$1Vm=n;this.$J=i;this.$B=r;this.$2M=u;this.$4R=t;this.$k=f;this.$AI=e};_d.$aw.prototype={$1Vm:null,$J:null,$B:null,$2M:null,$4R:null,$k:null,$AI:null,$E:function(n){return this.$AI.get_$1c()?new _d.$Eo(n,this.$4R,this.$1Vm,this.$J,this.$B,this.$2M,this.$k):null}};_d.$Eo=function(n,t,i,r,u,f,e){this.$$d_$9Ia=Function.createDelegate(this,this.$9Ia);this.$$d_$9LE=Function.createDelegate(this,this.$9LE);this.$$d_$1rJ=Function.createDelegate(this,this.$1rJ);this.$$d_$9yU=Function.createDelegate(this,this.$9yU);_d.$Eo.initializeBase(this);this.$1BO=n;this.$1Vm=i;this.$J=r;this.$B=u;this.$6e1=new _C(this.$$d_$9yU,_d.$Eo.$A);this.$5F2=new _C(this.$$d_$1rJ,_d.$Eo.$A);this.$2M=f;this.$4R=t;this.$2RC=!1;this.$k=e;$6zf(this)};function $6zf(n){n.set_$6em(!1);n.set_$6gL(!1);var t=$6zg(n);if(t&&!_g.$h.$1i.doesIdEqualName(t,"sentitems")){var i=this;n.$2M.$1Oh(function(){n.set_$6gL(n.$B.get_$L()==="Mouse")});n.set_$6em(!0)}}function $6zg(n){var t;if(n.$1BO.get_$28()&&_g.$h.$1i.idToName(n.$1BO.get_$28())===_g.$Ae.$Wg){var i=_h.$8s.$88m(n.$1BO.get_$28());if(i)t=i.get_$o();else{_js.Trace.logError(_d.$Eo.$A,"Not able to found the WellKnownFolder for the Share message");t=null}}else t=n.$1BO.get_$28();return t}function $6zd(n){var t=this;_js.$J.get_$I().$40(_a.$0.$6E,"PopOutClose",function(){window.self.close()})}function $6ze(n){var t=new(_0365f.$n.$$(String));if(n.$1BO.get_$8j()){var i=this;n.$1BO.get_$8j().$Bd(function(n){var i=n;i.get_$Bw()==="application/x-sharing-metadata-xml"&&t.$D(i.get_$3l().Id)})}return t.$6W()}function $6zh(n,t){for(var u=n.$2M.get_$m2(),i=0;i<u.get_$C();++i)for(var f=u.get_$3o(i),r=0;r<f.get_$CW().get_$C();r++){var e=f.get_$CW().get_$3o(r);if(e.get_$i().Id===t.Id){n.$4R.$2ei(e,null);return}}}_d.$Eo.prototype={$1BO:null,$4R:null,$6e1:null,$B:null,$J:null,$1Vm:null,$2M:null,$k:null,$5F2:null,$3SO:!1,$3TI:!1,$2RC:!1,$XM:null,get_$5D9:function(){this.$XM||(this.$XM=$6ze(this));return this.$XM},get_$6em:function(){return this.$3SO},set_$6em:function(n){if(this.$3SO!==n){this.$3SO=n;$3(this,"ShowAddButton")}return n},get_$6gL:function(){return this.$3TI},set_$6gL:function(n){if(this.$3TI!==n){this.$3TI=n;$3(this,"ShowShareBackButton")}return n},$jr:function(){},$9yU:function(){var n=this;this.$1Vm.$E(function(t){t.$4Qi(n.$2M.get_$ik().get_$9U(),n.$1BO.get_$8m().Mailbox,!0)})},$1rJ:function(){if(!this.$2RC){this.$2RC=!0;var n=new _c.$12r(this.$1BO.get_$i());n.add_$21(this.$$d_$9LE);this.$B.get_$9l()&&n.add_$29(this.$$d_$9Ia);this.$k.$11(n);this.$B.get_$9l()||$6zd(this)}},$9LE:function(n){this.$2RC=!1;_cc.$5o.$1DI(n)},$9Ia:function(n){var i=n;this.$J.$9lH(_y.$H5,new _y.$H5(1,null));var t=this;this.$2M.$AF(function(){t.$2RC=!1;$6zh(t,i.$6Fj)})}};_d.$1GT=function(n){_d.$1GT.initializeBase(this);this.$SO=n};_d.$1GT.prototype={$SO:null,get_$y:function(){return this.$SO.get_$y()},set_$y:function(n){if(!this.get_$y()||!this.get_$y().$4i(n)){var t=this.get_$DE();this.$SO.set_$y(n.$3g());this.$SO.set_$20(n.$9v(t));$AO(this,"Start","End")}return n},get_$20:function(){return this.$SO.get_$20()},set_$20:function(n){if(!this.get_$20()||!this.get_$20().$4i(n)){n.$2U(this.get_$y())<0?this.$SO.set_$20(this.get_$y().$3g()):this.$SO.set_$20(n.$3g());$N(this,"End")}return n},get_$5R:function(){return this.$SO.get_$5R()},set_$5R:function(n){if(this.get_$5R()===n)return n;this.$SO.set_$5R(n);$N(this,"IsAllDayEvent");return n},get_$DE:function(){return this.get_$20().$5u(this.get_$y())},set_$DE:function(n){if(n!==this.get_$DE()){var t=n-this.get_$DE();this.set_$20(this.get_$20().$9v(t))}return n}};_d.$Jf=function(n){_d.$Jf.initializeBase(this);this.$t=this.$7mY();this.$XB=new Array(7);for(var t=0;t<7;t++)this.$XB[t]=0;this.set_$y(n)};_d.$Jf.$qh=function(n,t){var r=n;var u=t;var i=(r.get_$Ao()?0:1)-(u.get_$Ao()?0:1);i||(i=r.get_$y().$5u(u.get_$y()));i||(i=_d.$Jf.$5n7(u)-_d.$Jf.$5n7(r));i||(i=r.get_$2i()?u.get_$2i()?r.get_$2i().localeCompare(u.get_$2i()):1:-1);return i};_d.$Jf.$5n7=function(n){return Math.floor(n.get_$20().$5u(n.get_$y())/6e4)};_d.$Jf.prototype={$t:null,$XB:null,$27A:0,$6F:null,$So:null,$4js:null,$2Er:null,get_$y:function(){return this.$6F},set_$y:function(n){if(!this.$6F&&n||this.$6F&&n&&!this.$6F.$4i(n)){this.$6F=n;this.$So=this.$6F.$2w(7);for(var t=this.$t.get_$C()-1;t>=0;--t)this.$2SG(this.$t.get_$3o(t))||this.$t.$6C(t);this.$4js=_a.$2F.$NZ(this.$6F,1,!0);this.$2Er=new _h.$4i(this.$6F,this.$So);Array.removeAt(this.$4js,this.$4js.length-1);$3u(this,"Start","WeekDateRange")}return n},get_$4NX:function(){return this.$27A},set_$4NX:function(n){this.$27A=n;return n},get_$6ku:function(){return this.$XB},set_$6ku:function(n){this.$XB=n;$He(this,_d.$Jf.$6kv);return n},get_$A8h:function(){return this.$XB[0]},get_$A8i:function(){return this.$XB[1]},get_$A8j:function(){return this.$XB[2]},get_$A8k:function(){return this.$XB[3]},get_$A8l:function(){return this.$XB[4]},get_$A8m:function(){return this.$XB[5]},get_$A8n:function(){return this.$XB[6]},$2SG:function(n){var t=new _h.$4i(this.$6F,this.$So);return t.$1QE(n)},$7mY:function(){return new _a.$Rx(_d.$Jf.$qh)}};_d.$1ND=function(n,t,i,r,u,f){_d.$1ND.initializeBase(this,[n,t,r,i,u,f])};_d.$1ND.prototype={$3qt:null,$2a2:null,get_$1uR:function(){return null},get_$1ZS:function(){return 5},get_$5Ng:function(){this.$3qt||(this.$3qt=new _d.$Sy(this.get_$1uR()));return this.$3qt},get_$3IL:function(){return this.$2a2},set_$3IL:function(n){if(this.$2a2!==n){this.$2a2=n;$3(this,"NoItemsMessage")}return n},$5ae:function(){},$5af:function(){}};_d.$1NN=function(n,t,i,r,u,f){this.$$d_$9U7=Function.createDelegate(this,this.$9U7);_d.$1NN.initializeBase(this,[n,t,i,r,u,f]);this.$t=new _a.$Rx(_cc.$7U.$7hx);this.$t.add_$1Y(this.$$d_$9U7)};_d.$1NN.prototype={$t:null,$5Y3:function(){return this.$t.get_$C()},$84q:function(){return this.$t.get_$C()},$3hD:function(n){for(var r=n.length,f=_a.$6.acss(_a.$0.$6y,"AgendaDefaultVM_AddItems_"+r),e=this.$t.$6hu(),u,t,i=0;i<r;i++){t=n[i];if(this.$1n0(t)){u=$1q3(this,t,this.$H9);e.$6S(u)}}this.$t.$5Rg();_a.$6.aces(f)},$IB:function(n){var t=$1q3(this,n,this.$H9);this.$t.$6S(t)},$D9:function(n){this.$t.$34(n)},$7o6:function(n,t){return new _d.$Ji(n,t,this.$PL)},$2AB:function(){_d.$1s.prototype.$2AB.call(this);this.$t.$1t()},$9U7:function(n,t){this.set_$3IL(this.$t.get_$C()?null:_nbs.NonBootStrings.l_Calendar_NoAgendaItems_Text)}};_d.$nw=function(n,t,i,r,u){_d.$nw.initializeBase(this,[n,!1,t,i,r,u])};_d.$nw.prototype={$1mL:null,get_$1N:function(){return"AgendaViewModel"},get_$1CU:function(){return 0},get_$2ni:function(){return String.format(_nbs.NonBootStrings.l_CalendarAgendaView_AT_Region_Text,this.get_$4Ux())},get_$40p:function(){return this.get_$9I().$2b(3).toLocaleUpperCase()},get_$6pd:function(){return this.get_$9I().$2b(21)},get_$9t3:function(){return this.$1mL},set_$9t3:function(n){if(this.$1mL!==n){this.$1mL=n;$3(this,"SelectedAgendaItem");this.get_$15O()||this.$1g.set_$x6(n)}return n},$6VJ:function(){var n=this.$1g.$95.$3xB(this.$EU);this.$2AB();this.$3hD(n)},$7h7:function(){if(this.$1mL){this.$1mL=null;$3(this,"SelectedAgendaItem")}},get_$9I:function(){return _d.$1s.prototype.get_$9I.call(this)},set_$9I:function(n){_d.$1s.prototype.set_$9I.call(this,n);$3u(this,"HeaderText","WatermarkText");return n},$6VK:function(){_d.$1s.prototype.$6VK.call(this);this.$6VJ()},$2JM:function(){return!1}};_d.$Ji=function(n,t,i){_d.$Ji.initializeBase(this,[n,t]);this.$PL=i};_d.$Ji.prototype={$PL:null,get_$y:function(){return this.get_$5lk()?this.$7v:this.$2g.get_$y()},get_$20:function(){return this.$2g.get_$20()},get_$DE:function(){var i=this.$2g.get_$5R();var t=this.$2g.get_$y();var n=this.$2g.get_$20();if(t.$2U(n)>0)throw Error.argumentOutOfRange("Cannot retrieve duration string. The start DateTime cannot be later than the end DateTime");i&&n.$9v(1).$4i(n.$2w(1).$4D())&&(n=n.$9v(1));var r=Math.floor((n.$5X()-t.$5X())/1e3);return _a.$7.$2zs(r)},get_$4fw:function(){return this.get_$5lk()?this.$7v.$2b(18):this.get_$Ao()?"":this.$2g.get_$y().$2b(18)},get_$8OP:function(){return this.$2g.get_$20().$9v(-1).$2U(this.$7v)>=0&&!this.$2g.get_$y().$9K(this.$7v)},get_$5lk:function(){return!this.$2g.get_$Ao()&&this.$2g.get_$y().$2U(this.$7v)<0&&this.$2g.get_$20().$4D().$4i(this.$7v)},get_$8KI:function(){return this.$2g.get_$y().$2U(this.$7v)<=0&&!this.$2g.get_$20().$9v(-1).$9K(this.$7v)},get_$8DA:function(){return!this.get_$ju()},$84D:function(){return this.$7v.$5YS().toString()},$3kz:function(n,t){_d.$1N1.prototype.$3kz.call(this,n,t);var r=t==="Start";if(r){var i=this.get_$y().$4D();this.$2g.get_$1X7()&&(i=i.$2w(this.$2g.get_$1X7()));this.$7v=i}r||t==="End"?$He(this,_d.$Ji.$5Nf):t==="CalendarItemType"?$3(this,"IsOccurrenceOrException"):t==="Sensitivity"?$3(this,"IsPrivate"):t==="Categories"&&$3(this,"HasNoCategories")}};_d.$Sy=function(n){this.$H5={};this.$Xm=n};function $4p8(n,t){return n.$Xm?n.$Xm.$4h5(t):t}function $6y2(n,t){var i=t.$84D();if(i in n.$H5)return n.$H5[i];var u=t.$7v.$2b(3).toUpperCase();var r=new _cc.$VZ(u,i);n.$H5[i]=r;return r}_d.$Sy.prototype={$H5:null,$Xm:null,get_$47C:function(){return!1},$C0:function(){return!0},$5WU:function(n,t){var i=$4p8(this,n);var r=$4p8(this,t);var u=!r||!!i.$7v.$9K(r.$7v);var f=new _0365m.$do($6y2(this,i),u);if(this.$Xm){this.$Xm.$3sd(i);this.$Xm.$3sd(r)}return f}};_d.$1s=function(n,t,i,r,u,f){this.$$d_$9WH=Function.createDelegate(this,this.$9WH);this.$$d_$7sR=Function.createDelegate(this,this.$7sR);this.$$d_$7XC=Function.createDelegate(this,this.$7XC);this.$$d_$9ed=Function.createDelegate(this,this.$9ed);this.$$d_$6Hx=Function.createDelegate(this,this.$6Hx);this.$$d_$9Wc=Function.createDelegate(this,this.$9Wc);this.$$d_$9vO=Function.createDelegate(this,this.$9vO);this.$$d_$6Ny=Function.createDelegate(this,this.$6Ny);this.$$d_$1k0=Function.createDelegate(this,this.$1k0);this.$$d_$3K7=Function.createDelegate(this,this.$3K7);this.$$d_$9NH=Function.createDelegate(this,this.$9NH);this.$$d_$6I7=Function.createDelegate(this,this.$6I7);this.$$d_$9Vt=Function.createDelegate(this,this.$9Vt);this.$$d_$6In=Function.createDelegate(this,this.$6In);this.$$d_$9Ou=Function.createDelegate(this,this.$9Ou);this.$$d_$5dJ=Function.createDelegate(this,this.$5dJ);this.$$d_$9m4=Function.createDelegate(this,this.$9m4);this.$$d_$7kB=Function.createDelegate(this,this.$7kB);this.$$d_$5ae=Function.createDelegate(this,this.$5ae);this.$$d_$5af=Function.createDelegate(this,this.$5af);this.$$d_$3zR=Function.createDelegate(this,this.$3zR);this.$$d_$7jz=Function.createDelegate(this,this.$7jz);this.$$d_$1Va=Function.createDelegate(this,this.$1Va);this.$$d_$9eI=Function.createDelegate(this,this.$9eI);this.$$d_$2b3=Function.createDelegate(this,this.$2b3);this.$$d_$5KU=Function.createDelegate(this,this.$5KU);this.$$d_$lq=Function.createDelegate(this,this.$lq);this.$$d_$7mS=Function.createDelegate(this,this.$7mS);this.$$d_$7mU=Function.createDelegate(this,this.$7mU);this.$$d_$7mT=Function.createDelegate(this,this.$7mT);this.$$d_$7mR=Function.createDelegate(this,this.$7mR);this.$$d_$1Ti=Function.createDelegate(this,this.$1Ti);this.$$d_$9N3=Function.createDelegate(this,this.$9N3);this.$$d_$6I1=Function.createDelegate(this,this.$6I1);this.$$d_$9Qn=Function.createDelegate(this,this.$9Qn);this.$2Zh=new _js.$c;this.$1sp=-1;_d.$1s.initializeBase(this);var o=_a.$6.acss(_a.$0.$1c,"CalendarBaseViewModel:Init");this.$1g=f;this.$Je=i;this.$Ev=r;this.$6QG=u;this.$1Qm=this.$1g.$B.get_$L()==="Mouse";this.$2Rb=!0;this.$1JO=t;this.$36w=!1;if(this.$1JO){this.$1g.$95.add_$5TN(this.$$d_$9Qn);this.$1g.$95.add_$2rI(this.$$d_$6I1)}this.$1g.$95.add_$5F4(this.$$d_$9N3);this.$1g.$J.$Hd(_a.$D5,this.$$d_$1Ti);this.$9k=!1;var s=this;this.$2tx=new _C(this.$$d_$7mR,this.get_$1a(),this,"CanCreateItem",function(){return s.get_$5Fw()});var h=this;this.$5LR=new _C(this.$$d_$7mT,this.get_$1a(),this.$1g,"CanCreateItemOnCalendar",function(){return h.$1g.get_$1ZX()});var c=this;this.$3os=new _C(this.$$d_$7mU,this.get_$1a(),this,"CanCreateItem",function(){return c.get_$5Fw()});var l=this;this.$2ty=new _C(this.$$d_$7mS,this.get_$1a(),this.$1g,"CanCreateItemOnCalendar",function(){return l.$1g.get_$1ZX()});var a=this;this.$4iG=new _C(this.$$d_$lq,this.get_$1a(),this,"CanUpdateItemDetails",function(){return a.get_$7fh()});var v=this;this.$ca=new _C(this.$$d_$5KU,this.get_$1a(),this.$1g,"CanCreateItemOnCalendar",function(){return v.$1g.get_$1ZX()});var y=this;this.$PL=new _C(this.$$d_$2b3,this.get_$1a(),this,"CanOpenItem",function(){return y.get_$2rr()});var p=this;this.$27w=new _C(this.$$d_$9eI,this.get_$1a(),this,"CanOpenItem",function(){return p.get_$2rr()});var w=this;this.$3Qz=new _C(this.$$d_$1Va,this.get_$1a(),this,"CanSelectItem",function(){return w.get_$7fZ()});this.$qn=new _C(this.$$d_$7jz,this.get_$1a());this.$nC=new _C(this.$$d_$3zR,this.get_$1a());this.$2P6=new _C(this.$$d_$5af,this.get_$1a());this.$2P5=new _C(this.$$d_$5ae,this.get_$1a());this.$3oK=new _C(this.$$d_$7kB,this.get_$1a());this.$4MG=new _C(this.$$d_$9m4,this.get_$1a());this.$32S=new _C(this.$$d_$5dJ,this.get_$1a());this.$er=n;this.$3b=n;this.$26f={};var e=_a.$2F.$NZ(this.$er,this.get_$1CU(),!1,this.$1g.$b.get_$13().get_$MF().get_$O9());this.$H9=$2kf(this);this.$EU=new _h.$4i(e[0],e[1]);this.$1BK=$6yL(this);this.$1g.$Y("CurrentItem",this.$$d_$9Ou);this.$1g.$Y("CurrentItemModel",this.$$d_$6In);this.$1g.$Y("IsModuleSidePanelExpanded",this.$$d_$9Vt);if(this.$1g.$B.get_$L()==="Mouse"){$4pX(this);this.$1g.$Y("CanCreateItemOnCalendar",this.$$d_$6I7)}_a.$6.aces(o);if(this.$1g.$Cl){this.$1g.$Cl.get_$4SI().add_$1Y(this.$$d_$9NH);this.$1g.$Cl.get_$I6().add_$1Y(this.$$d_$3K7)}};_d.$1s.$7eE=function(n,t){switch(n){case-1:return!1;case 0:case 1:return!0;default:return t>0}};_d.$1s.$4W1=function(n,t){for(var r,i=t.get_$C()-1;i>=0;i--){r=t.get_$3o(i);if(n.get_$FS()){if(r.get_$FS()){t.$6C(i);break}}else r.get_$FS()||r.get_$i().Id!==n.get_$i().Id||t.$6C(i)}};_d.$1s.$6lF=function(n){_a.$6.$19(null,n.$2tm);_a.$6.endPT("CreateCalendarItemDefault")};_d.$1s.$A92=function(n){_a.$6.$19(null,n.$2tm);_a.$6.endPT("CreateAllDayCalendarItem")};function $3aW(n,t){$3aY(n,!1);n.$6jG();n.set_$3qo($2kf(n));t&&n.$6VK();$3aY(n,n.$2RZ)}function $4pT(n,t){if(n.get_$Hg()){n.get_$Hg().$7zU(t);n.set_$Hg(null)}}function $3aU(n){var t=new _d.$Wc;t.set_$3SR("Free");t.set_$PU(!1);t.set_$5R(!0);t.set_$DE(_a.$2F.$1K4(2));n.$Av&&n.$Av.$EX.$2T&&t.set_$2i(n.$Av.get_$2i());_js.$8.$a(t.get_$2i())||t.set_$2Nj(!0);return t}function $6yL(n){return n.$1g.$B.get_$FG()?null:new _d.$Lx}function $2kd(n,t){for(var u=0,i=0,e=t.get_$C();i<e;i++)if(_g.$K5.isInstanceOfType(t.get_$3o(i))){var f=t.get_$3o(i);var r=f.get_$20();var o=f.get_$y().$4D();var s=r.$9K(r)?r.$4D().$9v(86399999):r.$9v(-1);var h=new _h.$4i(o,s);h.$mb(n.get_$9I(),!0,!0)&&u++}return u}function $4pV(n){var t=new _d.$Wc;n.get_$9I().$9K(_a.$7.get_$2F())?t.set_$y(_a.$2F.$2tp(n.get_$9I(),n.$1g.$b.get_$13().get_$MF().get_$vk())):t.set_$y(_a.$2F.$3oa(_a.$7.get_$2F()));t.set_$DE(18e5);n.$1g.$Cw&&t.set_$1ML(n.$1g.$Cw.get_$9U());if(n.$Av&&n.$Av.$EX.$2T){t.set_$2i(n.$Av.get_$2i());t.set_$y(n.$Av.get_$y())}_js.$8.$a(t.get_$2i())||t.set_$2Nj(!0);return t}function $2kg(n){n.set_$3qn(n.$3xW(n.$er))}function $6yQ(n,t){t.$2sl.$2q.length>0&&n.$1g.$95.$5Xq(t.$iL)&&n.$3hD(t.$2sl.$2q)}function $6yR(n,t){t.$3B.length>0&&n.$4W7(t.$3B)}function $6yS(n,t){t.$3B.length>0&&n.$9oW(t.$2q,t.$3B)}function $1q3(n,t,i){for(var u=[],r,e,f=0,o=i.length;f<o;f++){r=i[f];e=new _h.$4i(r,r.$2w(1));e.$1QE(t)&&Array.add(u,n.$7o6(t,r))}n.$26f[t.get_$i().Id]=u;return u}function $2kf(n){var t=_a.$2F.$NZ(n.get_$9I(),n.get_$1CU(),!0,n.$1g.$b.get_$13().get_$MF().get_$O9());Array.removeAt(t,t.length-1);return t}function $2ke(n){n.$D9(n.$Av);n.$Av=null;$4pU(n)}function $6yP(n,t){var i=_a.$6.acss(_a.$0.$6y,"GetItemsForAddedCalendar");n.$1g.$95.$2A7(n.get_$1N(),t,n.$EU,n.get_$1ZS());$11z(n);_a.$6.aces(i)}function $4pW(n){$11z(n);if(n.$9k&&n.$1JO){$3aV(n);n.$1sp=n.$1g.$95.get_$3RC()}else n.$1sp=-1}function $3aV(n){var t=_a.$6.acss(_a.$0.$6y,"GetItems");if(!n.$1g.$Cl){_a.$6.aces(t);return}n.set_$5hv(!1);n.set_$yc(!1);n.$2AB();$11z(n);n.$1g.$95.$6SU(n.get_$1N(),n.get_$5Y4(),n.get_$1ZS());n.$1g.$95.$9or(n.get_$1N(),n.get_$5Y4(),n.get_$1ZS());$11z(n);_a.$6.aces(t)}function $3aX(n){n.$1JO&&n.set_$yc(n.$1g.$95.get_$12g()>=1)}function $6yK(n,t,i,r){_a.$6.stPT(_a.$0.$1c,"CreateCalendarItemDefault",3);_a.$6.$1X(_a.$0.$1c,r);var u=_a.$6.acss(_a.$0.$1c,"Create ComposeCalendarItemViewModel");$5(n.$Av)||n.$D9(n.$Av);var f=n.$Ev.$br(t.$3E,null,_d.$1s.$6lF,r);_a.$6.aces(u);n.$1g.$B.$fj(f,0,i)}function $6yJ(n,t){for(var i=0,r=t.get_$C();i<r;i++)t.get_$3o(i).$Y("AssignedCalendarColor",n.$$d_$6Hx)}function $6yN(n,t){for(var i=0,r=t.get_$C();i<r;i++)t.get_$3o(i).$q("AssignedCalendarColor",n.$$d_$6Hx)}function $4pX(n){n.get_$5GO()&&!n.$1pB?n.set_$6pE(n.$7oe()):!n.get_$5GO()&&n.$1pB&&n.set_$6pE(null)}function $6yZ(n){n.$1BK&&n.$1BK.set_$yw(n.$1g.get_$9T())}function $11z(n){if(n.$1JO){n.set_$353(n.$1g.$95.get_$12g()===-1||n.$1g.$95.get_$12g()===2);n.set_$5jb(_d.$1s.$7eE(n.$1g.$95.get_$12g(),n.$1g.$Cl?n.$1g.$Cl.get_$4SI().get_$C():0))}}function $6yb(n,t){if(n.$1Qm){$6ya(n,t);$3aY(n,t)}}function $6ya(n,t){n.$1Qm&&(t?n.$2Rb?n.set_$38J(String.format(_nbs.NonBootStrings.l_CalendarViewLoaded_AT_LiveRegion_Text,n.get_$4Ux(),n.$5Y3())):n.set_$38J(String.format(_nbs.NonBootStrings.l_CalendarViewSelectedDateLoaded_AT_LiveRegion_Text,n.$5Y3())):n.set_$38J(null))}function $3aY(n,t){n.$1Qm&&(t?n.set_$6aV(String.format(_nbs.NonBootStrings.l_CalendarViewSelectedDateLoaded_AT_LiveRegion_Text,n.$84q())):n.set_$6aV(null))}function $6yU(n){var i=n.$1g.get_$9T().$h0;var t=i.$ic(1,!1);if(t.$2T){t.$s();t.$1R()}}function $6yW(n){if(!n.$27x){var t=new _js.$c;t.$D(new _a.$2E(new _C(n.$$d_$9ed,n.get_$1a()),_nbs.NonBootStrings.l_Calendar_OpenUpdatedMeeting_EditButton_Text,_nbs.NonBootStrings.l_Calendar_OpenUpdatedMeeting_EditButtonDesc_Text));t.$D(new _a.$2E(n.$32S,_nbs.NonBootStrings.l_Calendar_OpenUpdatedMeeting_DiscardButton_Text,_nbs.NonBootStrings.l_Calendar_OpenUpdatedMeeting_DiscardButtonDesc_Text));n.set_$9ec(t)}}function $6yX(n){n.set_$36V(!0)}function $6yO(n){n.$1g.get_$9T()&&n.$1g.get_$9T().$iq()}function $6yV(n){n.$1m6=_cc.$1Lo.$1c.$Xc.$A3x(n.$Av.get_$5R(),n.$Av.$2g.get_$az());var t=n.$Je.$8V(n.$Av.$2g);t.$5p.add_$2t(n.$$d_$9WH);t.$5p.$9s3();$4pU(n)}function $4pU(n){n.$26n&&n.$26n.$2T&&n.$26n.$s()}function $6yT(n){if(!(n.$2Zh.get_$C()>0)){n.$2Zh.$D(new _a.$2E(n.$4MG,_nbs.NonBootStrings.l_CalendarNaturalInputConfirmDialogContinueEditTitle_LowerCase_Text,_nbs.NonBootStrings.l_CalendarNaturalInputConfirmDialogContinueEditSubTitle_Text));var t=this;n.$2Zh.$D(new _a.$2E(new _C(function(){n.set_$6FT(!0);n.set_$36G(!1);$2ke(n)},_a.$0.$1c),_nbs.NonBootStrings.l_CalendarNaturalInputConfirmDialogDiscardTitle_LowerCase_Text,_nbs.NonBootStrings.l_CalendarNaturalInputConfirmDialogDiscardSubTitle_Text))}}function $6yY(n,t){}function $3aT(n,t){var i=!1;if(n.$1g.$S1){var r=n.$1g.$S1.$p.$v.get_$i();var u=n.$1g.get_$9T()?n.$1g.get_$9T().$v.get_$i():null;if(t||r!==u){n.$1g.$S1.set_$1O(!1);i=!0}if(i&&r!==u){n.$1g.$S1.$1R();n.$1g.set_$6QF(null)}}else i=!0;return i}function $6yI(n){return!!n.$1g.$B.get_$p0().get_$8o().get_$C()}function $6yM(n,t){return!_h.$4i.$4N(n.$EU,n.$3xW(t))}_d.$1s.prototype={$1JO:!0,$Ev:null,$Je:null,$6QG:null,$1g:null,$2tx:null,$5LR:null,$3os:null,$2ty:null,$4iG:null,$ca:null,$PL:null,$27w:null,$3Qz:null,$qn:null,$nC:null,$2P6:null,$2P5:null,$3oK:null,$32S:null,$26f:null,$1Qm:!1,$4MG:null,$Oo:!1,$1pB:null,$26n:null,$EU:null,$H9:null,$er:null,$3b:null,$2vX:null,$9k:!1,$2Bw:!1,$2RZ:!1,$1Q5:!1,$1EH:!1,$20j:!1,$27x:null,$Av:null,$1BK:null,$1Ps:!1,$36w:!1,$1Qn:null,$3Qf:null,$2Rb:!1,$3Hp:!1,$36F:!1,$1EN:!1,$mR:null,$1m6:null,add_$2rF:function(n){this.$2G("CalendarColorsChanged",n)},remove_$2rF:function(n){this.$2H("CalendarColorsChanged",n)},add_$2wY:function(n){this.$2G("DisplayedDateChanging",n)},remove_$2wY:function(n){this.$2H("DisplayedDateChanging",n)},get_$6pE:function(){return this.$1pB},set_$6pE:function(n){if(this.$1pB!==n){this.$1pB=n;$3(this,"ViewContextMenuViewModel")}return n},get_$5jb:function(){return this.$1Q5},set_$5jb:function(n){if(this.$1Q5!==n){this.$1Q5=n;$3(this,"IsLoadingItems")}return n},get_$45h:function(){return this.$1EN},set_$45h:function(n){if(n!==this.$1EN){this.$1EN=n;$3(this,"IsItemContextMenuShown")}return n},get_$36G:function(){return this.$36F},set_$36G:function(n){if(n!==this.$36F){n&&$6yT(this);this.$36F=n;$3(this,"IsNaturalInputSaveDialogShown")}return n},get_$6FT:function(){return this.$3Hp},set_$6FT:function(n){if(n!==this.$3Hp){this.$3Hp=n;$3(this,"NaturalInputSaveDialogShouldRestoreFocus")}return n},get_$6FS:function(){return this.$26n},set_$6FS:function(n){if(this.$26n!==n){this.$26n=n;$3(this,"NaturalInputExitCommand")}return n},get_$353:function(){return this.$1EH},set_$353:function(n){if(this.$1EH!==n){this.$1EH=n;$3(this,"IsErrorLoadingItems")}return n},get_$7vt:function(){return _nbs.NonBootStrings.l_LoadingError_Text},get_$Gg:function(){return this.$9k},set_$Gg:function(n){if(this.$9k!==n){this.$9k=n;n?this.$3Iw():this.$6Iw()}return n},get_$3SA:function(){return this.$2Bw},set_$3SA:function(n){if(this.$2Bw!==n){this.$2Bw=n;n&&this.$2JM()}return n},get_$5Fw:function(){return!this.$1g.$B.get_$FG()},get_$2rr:function(){return!!this.$Av||!!this.$1g.get_$9T()&&this.$1g.get_$9T().$h0.get_$2rr()},get_$7fZ:function(){return this.get_$2rr()},get_$7fh:function(){return this.$1g.get_$9T()?this.$1g.get_$9T().$v.get_$fH():!1},get_$15O:function(){return this.$1Ps},set_$15O:function(n){if(this.$1Ps!==n){this.$1Ps=n;this.$6I2()}return n},get_$5G2:function(){return this.$1g.$B.get_$L()==="Mouse"},get_$3qn:function(){return this.$EU},set_$3qn:function(n){if($5(n))throw Error.argumentNull("DateRange");if($5(this.$EU)||!this.$EU.$4i(n)){this.$EU=n;this.set_$3qo($2kf(this));$4pW(this);$3u(this,"DateRange","AccessibleName")}return n},get_$9I:function(){return this.$er},set_$9I:function(n){if(!$5(n)&&!_a.$7.$4N(this.$er,n)){var t=$5(this.$er)||!_a.$7.$4N(this.$er.$4D(),n.$4D());this.$er=n;$3aW(this,t);$3(this,"VMSelectedDate")}return n},get_$YK:function(){return this.$Oo},set_$YK:function(n){if(n===this.$Oo)return n;this.$Oo=n;var t=this.$1g.$b.get_$13();if(n){t.$Y("WeekStartDay",this.$$d_$1k0);t.get_$MF().$Y("WorkDays",this.$$d_$6Ny)}else{t.$q("WeekStartDay",this.$$d_$1k0);t.get_$MF().$q("WorkDays",this.$$d_$6Ny)}return n},$2JM:function(){return this.$1g.$95.$2JM()},$4aM:function(n){this.$3b=n;$3(this,"DisplayedDate");this.set_$9I(n)},get_$3zU:function(){return 0},get_$Ak:function(){return this.$3b},set_$Ak:function(n){if(this.$2vX){$3(this,"DisplayedDate");return n}if(!_a.$7.$4N(this.$3b,n)){var t=this.$jB("DisplayedDateChanging");if(t&&$6yM(this,n)){var i=!this.$3b||n.$2U(this.$3b)<0;this.$2vX=n;t(i,this.$$d_$9vO)}else this.$4aM(n)}return n},get_$3qo:function(){return this.$H9},set_$3qo:function(n){_a.$3.$K(n,"DateRangeArray cannot be null");if(!_a.$2F.$4N(this.$H9,n)){this.$H9=n;$3(this,"DateRangeArray")}return n},get_$3Ho:function(){return this.$Av},set_$3Ho:function(n){if(this.$Av!==n){this.$Av=n;$3(this,"CanOpenItem")}return n},get_$36V:function(){return this.$20j},set_$36V:function(n){if(this.$20j!==n){this.$20j=n;$3(this,"IsOpenUpdatedMeetingDialogShown")}return n},get_$9ec:function(){return this.$27x},set_$9ec:function(n){if(n!==this.$27x){this.$27x=n;$3(this,"OpenUpdatedMeetingDialogButtonData")}return n},get_$yc:function(){return this.$36w},set_$yc:function(n){if(this.$36w!==n){this.$36w=n;$3(this,"IsReadyToShowData")}return n},get_$38J:function(){return this.$1Qn},set_$38J:function(n){if(this.$1Qn!==n){this.$1Qn=n;$3(this,"ItemsLoadedNotificationMessage")}return n},get_$6aV:function(){return this.$3Qf},set_$6aV:function(n){if(this.$3Qf!==n){this.$3Qf=n;$3(this,"SelectedDateItemsLoadedNotificationMessage")}return n},get_$8Jk:function(){return this.$2Rb},set_$8Jk:function(n){if(this.$2Rb!==n){this.$2Rb=n;$3(this,"IsDateInItemsLoadedNotificationMessage")}return n},get_$5hv:function(){return this.$2RZ},set_$5hv:function(n){if(this.$2RZ!==n){this.$2RZ=n;$6yb(this,n);$3(this,"IsDataProcessed")}return n},get_$4Ux:function(){return this.get_$Ak().$2b(3)},get_$Hg:function(){return this.$mR},set_$Hg:function(n){if(this.$mR!==n){this.$mR=n;$3(this,"CalendarScenarioContext")}return n},get_$5Y4:function(){return this.$EU},$3Iw:function(){this.$1g.$95.add_$2rQ(this.$$d_$9Wc);this.set_$3SA(!0);this.$1sp!==this.$1g.$95.get_$3RC()&&this.$1JO&&$3aV(this);this.$1g.$Cl&&$6yJ(this,this.$1g.$Cl.get_$I6());$11z(this)},$6Iw:function(){this.$1g.$95.remove_$2rQ(this.$$d_$9Wc);this.set_$3SA(!1);this.$1g.$Cl&&$6yN(this,this.$1g.$Cl.get_$I6())},get_$5FK:function(){return this.$Je},get_$1a:function(){return _a.$0.$1c},get_$5Fx:function(){return!this.$Av&&this.$1g.get_$1ZX()&&!this.get_$15O()&&this.$1g.get_$8Ja()},get_$5GO:function(){return this.$1g.get_$1ZX()},$mi:function(n){if(!$6yI(this)){$3aT(this,!0);var t=this.$5Ze();$6yK(this,t,!1,n?n:"CreateCalendarItemDefault")}},$7mR:function(){this.$mi("CreateItemByClickNewEventButton")},$7mS:function(){this.$mi("CreateItemByClickOrTapOnSurface")},$7mT:function(){this.$mi("CreateItemByContextMenu")},$7mU:function(){this.$mi("CreateItemByHotkey")},$lq:function(){var n=_a.$6.$1X(this.get_$1a(),"UpdateItemViaDrop",!0);var i=this.$1g.get_$9T().$v;if(i.get_$JC()){$6yW(this);$6yX(this);_a.$6.$19(n)}else{$6yY(this,"Save");var t=this.$1g.get_$9T();var r=this;t.$5p.add_$2t(function(t,i){i.$1d?n&&_a.$6.$19(n,"UpdateItemViaDrop",_cc.$1Lo.$6v.$ft(i),_cc.$1Lo.$6v.$Q6(i),null):n&&_a.$6.$19(n,"UpdateItemViaDrop",null,_cc.$1Lo.$6v.$Q6(i),null)});t.$5p.$6Q()}},$5KU:function(){_a.$6.stPT(_a.$0.$1c,"CreateAllDayCalendarItem",3);_a.$6.$1X(_a.$0.$1c,"CreateAllDayCalendarItem");var n=_a.$6.acss(_a.$0.$1c,"ComposeCalendarItemViewModelAllDay");$5(this.$Av)||this.$D9(this.$Av);var t=this.$81F();this.$Av&&this.$Av.$EX.$2T&&(this.$Av=null);var i=this.$Ev.$br(t.$3E,null,_d.$1s.$A92,"CreateAllDayCalendarItem");_a.$6.aces(n);this.$1g.$B.$7C(i)},$1Va:function(){this.$1g.$B.get_$L()==="TouchNarrow"&&this.$2b3()},$9eI:function(){this.$2b3("CreateItemByHotkeyEnter")},$2b3:function(n){if(!$5(this.$Av)&&this.$Av.$EX.$2T){this.$D9(this.$Av);this.$Av.get_$Ao()?this.$5KU():n?this.$mi(n):this.$mi("CreateItemByClickOrTapOnSurface");return}var t=this.$1g.get_$9T();if(!$5(t)&&!$5(t.$v)&&!t.get_$1Q9()){$3aT(this,!0);$6yU(this)}},$3zR:function(){var n=_a.$7.get_$2F().$4D();this.set_$9I(new _a.$7(n.get_$4S(),n.get_$3T(),n.get_$5n(),this.$er.get_$ED(),this.$er.get_$Gp(),this.$er.get_$Tm(),this.$er.get_$zs()));this.$1g.$J.$9lH(_d.$j9,new _d.$j9)},$6gV:function(){_js.Trace.logInfo(_a.$0.$1c,"ShowTodos");var n=this;this.$1g.$6kT.$E(function(t){if(n.$1g.$B.$aZ().get_$8o().$76(t))_js.Trace.logInfo(_a.$0.$1c,"Stack already contains the Todos popup so ignoring the event");else{_js.Trace.logInfo(_a.$0.$1c,"Asking shell to popup the Todos VM");n.$1g.$B.$7C(t)}})},$5af:function(){throw Error.notImplemented();},$5ae:function(){throw Error.notImplemented();},$aD:function(){if(this.$1g){this.$1g.set_$9T(null);this.$1g.set_$x6(null)}},$7oe:function(){return this.$1g.$B.get_$FG()?null:new _0365m.$2c([new _0365m.$o(_u.Strings.l_NewString_LowerCase_Text,null,this.$ca)])},$49:function(){if(this.$1JO){this.$1g.$95.remove_$5TN(this.$$d_$9Qn);this.$1g.$95.remove_$2rI(this.$$d_$6I1)}this.$1g.$J.$11q(_a.$D5,this.$$d_$1Ti);this.set_$YK(!1);this.$1g.$95.remove_$5F4(this.$$d_$9N3);this.$1g.$q("CurrentItem",this.$$d_$9Ou);this.$1g.$q("CurrentItemModel",this.$$d_$6In);this.$1g.$q("IsModuleSidePanelExpanded",this.$$d_$9Vt);this.$1g.$B.get_$L()==="Mouse"&&this.$1g.$q("CanCreateItemOnCalendar",this.$$d_$6I7);if(this.$1g.$Cl){this.$1g.$Cl.get_$4SI().remove_$1Y(this.$$d_$9NH);this.$1g.$Cl.get_$I6().remove_$1Y(this.$$d_$3K7)}this.$ca.$1R();this.$2ty.$1R();_a.$1.prototype.$49.call(this)},$3xW:function(n){var t=_a.$2F.$NZ(n,this.get_$1CU(),!1,this.$1g.$b.get_$13().get_$MF().get_$O9());return new _h.$4i(t[0],t[1])},$5Ze:function(){return $4pV(this)},$81F:function(){var n=$3aU(this);n.set_$y(_a.$2F.$2tp(this.get_$9I(),this.$1g.$b.get_$13().get_$MF().get_$vk()));n.set_$1ML(this.$1g.$Cw.get_$9U());return n},$6jG:function(){this.set_$Ak(this.get_$9I())},$6VK:function(){$2kg(this)},$ADf:function(){$5(this.$1g.get_$9T())||$5(this.$1g.get_$9T().$v.get_$y())||this.$1g.get_$9T().$v.get_$Ao()||(this.$er=new _a.$7(this.$er.get_$4S(),this.$er.get_$3T(),this.$er.get_$5n(),this.$1g.get_$9T().$v.get_$y().get_$ED(),this.$1g.get_$9T().$v.get_$y().get_$Gp(),0))},$9Qn:function(n,t){if(this.$9k){this.$1sp=this.$1g.$95.get_$3RC();var i=this.$1g.$95.$3xB(this.$EU);var r=_a.$6.acss(_a.$0.$1c,"CalDataLoaded:"+this.get_$1N());this.$2AB();this.$3hD(i);this.$6Hy(n,t);$11z(this);$3aX(this);this.get_$Hg()&&(this.get_$Hg().$137=t.$137);this.$1g.$95.get_$12g()===2&&$4pT(this,"Failed to load some calendar folders");_a.$6.aces(r)}},$9Wc:function(n,t){var i=t.$2sl;var r=_a.$6.acss(_a.$0.$5o,"OnNotification");if(!this.$9k)throw Error.invalidOperation(String.format("[CalendarBaseViewModel: {0}] Inactive view model should not listen to cache changes.",this.get_$1N()));this.$1sp=this.$1g.$95.get_$3RC();try{switch(i.$2Z){case 0:$6yQ(this,t);break;case 2:$6yR(this,i);break;case 4:this.$2AB();break;case 3:$6yS(this,i);break}}finally{$3aX(this);$11z(this)}_a.$6.aces(r)},$9N3:function(){_js.Trace.logInfo(this.get_$1a(),"CalendarBaseViewModel:CheckAndReloadCache, ShouldReloadCacheOnStale: {0}",this.$2Bw);this.$2Bw&&this.$2JM()},$4W7:function(n){for(var t,r,u,i,f=0,o=n.length;f<o;++f){t=n[f];i=t.get_$i().Id;if(this.$1n0(t))if(i in this.$26f){r=this.$26f[i];for(var e=0,s=r.length;e<s;e++){u=r[e];this.$D9(u);u.$1R()}delete this.$26f[i]}else this.$D9(t)}},$2AB:function(){var t=this.$26f;for(var i in t)for(var u={key:i,value:t[i]},r=u.value,n=0,f=r.length;n<f;n++)r[n].$1R()},$9oW:function(n,t){this.$4W7(n);this.$3hD(t)},$1n0:function(n){return this.$EU.$2R.$2U(n.get_$y())<=0&&this.$EU.$3H.$2U(n.get_$y())>0||this.$EU.$3H.$2U(n.get_$20())>=0&&this.$EU.$2R.$2U(n.get_$20())<0||n.get_$y().$2U(this.$EU.$2R)<=0&&n.get_$20().$2U(this.$EU.$3H)>=0},$7o6:function(n,t){return new _d.$M0(n,t)},$6HN:function(n){this.$1g.$B.get_$L()!=="Mouse"&&n!==this.$1g.$2M.get_$ik()&&this.$1g.$Cl.get_$I6().$76(this.$1g.$2M.get_$ik())||this.$1g.set_$x4(n)},$9ZO:function(n){if(this.$1g.$Cw===n){var t=this.$1g.$Cl.get_$I6().$79(this.$1g.$2M.get_$ik());t<0&&(t=this.$1g.$B.get_$L()==="Mouse"?0:this.$1g.$Cl.get_$I6().get_$C()-1);this.$1g.set_$x4(this.$1g.$Cl.get_$I6().get_$3o(t))}},$3K7:function(n,t){if(this.$9k){var i;switch(t.$2Z){case 0:for(var r=0,f=t.$2q.length;r<f;r++){i=t.$2q[r];i.$Y("AssignedCalendarColor",this.$$d_$6Hx);this.$1JO&&$6yP(this,i);this.$6HN(i)}break;case 2:for(var u=0,e=t.$3B.length;u<e;u++){i=t.$3B[u];i.$q("AssignedCalendarColor",this.$$d_$6Hx);$11z(this);$3aX(this);this.$9ZO(i)}break;case 3:throw Error.notImplemented();case 4:this.$1JO&&$3aV(this);break}}},$6Hy:function(n,t){this.set_$5hv(!0)},$6I1:function(n,t){if(this.$1g.$95.get_$12g()===-1){this.get_$Hg()&&(this.get_$Hg().$137=t.$137);$4pT(this,"Failed to load all calendars")}$11z(this)},$9um:function(n){return n},$7XC:function(){if(this.$Av)if(_js.$8.$a(this.$Av.get_$2i())){var n=null;this.$Av&&(n=this.$Av.get_$5R()?_a.$6.$1X(this.get_$1a(),"DiscardNaturalInputAllDayItem",!0):_a.$6.$1X(this.get_$1a(),"DiscardNaturalInputItem",!0));$2ke(this);if(n){_a.$6.$19(n);n=null}}else{this.$Av.$EX.set_$69(!1);$6yV(this)}},$7sR:function(){var n=null;this.$Av&&(n=this.$Av.get_$5R()?_a.$6.$1X(this.get_$1a(),"DiscardNaturalInputAllDayItem",!0):_a.$6.$1X(this.get_$1a(),"DiscardNaturalInputItem",!0));$2ke(this);if(n){_a.$6.$19(n);n=null}},$6I2:function(){this.$1Ps?this.$1g.$95.$3Uq():this.$1g.$95.$3PQ();$3(this,"IsDraggingItem")},$ADB:function(){if(!this.$1g.$B.get_$FG()){var n=$3aT(this);n&&this.$1g.get_$9T()&&this.$1g.get_$9T().$v.get_$1MQ()&&this.$1g.set_$6QF(this.$6QG.$E(this.$1g.get_$9T()))}},$9Ou:function(n,t){if(this.$9k){$He(this,_d.$1s.$6Il);this.$ADB();this.$ADf();$6yZ(this)}},$6I7:function(n,t){this.$9k&&$4pX(this)},$1Ti:function(n){this.set_$YK(n.$9k)},$6Hx:function(n,t){$BF(this,"CalendarColorsChanged",this,n)},$9Vt:function(n,t){this.$9k&&$3(this,"LayoutResize")},$6In:function(n,t){if(this.$9k)if(this.$1g.$aH){var i;i=_g.$2o.isInstanceOfType(this.$1g.$aH)?this.$1g.$aH:this.$1g.$aH.$2g;this.$1g.get_$9T()&&i===this.$1g.get_$9T().$6c||this.$1g.set_$9T(this.get_$5FK().$8V(i))}else this.$1g.set_$9T(null)},$9ed:function(){var n=this.$1g.get_$9T().$v;var t=new _d.$Gk;t.set_$i(n.get_$i());t.set_$y(n.get_$y());t.set_$DE(n.get_$20().$5u(n.get_$y()));t.set_$5R(n.get_$5R());var i=this.$1g.$2M.$1xE(n.get_$28());i&&i.get_$Mj()&&t.set_$149(i.get_$AX());var r=this.$Ev.$br(t.$3E,null,_d.$1s.$6lF);this.$5dJ();this.$1g.$B.$7C(r)},$5dJ:function(){$6yO(this);this.set_$36V(!1)},$7kB:function(){if(this.$1g.$B.get_$L()==="Mouse"&&this.get_$5Fx()){this.$1g.set_$x6(null);var n=new _g.$1q;n.EmailAddress=this.$1g.$b.get_$2z().get_$AM();n.Name=this.$1g.$b.get_$2z().get_$Fn();n.MailboxType="Mailbox";var t=this.$Ev.get_$3ky().$1u1(n);t.set_$5R(!0);t.set_$99("Free");t.set_$PU(!1);this.set_$3Ho(new _d.$oj(this.$9um(t),new _C(this.$$d_$7XC,this.get_$1a()),new _C(this.$$d_$7sR,this.get_$1a())));this.$IB(this.$Av)}},$9WH:function(n,t){if(t.$1d){this.set_$36G(!0);this.$1g.set_$x6(null);this.$1g.set_$9T(null);if(this.$1m6){_a.$6.$19(this.$1m6,null,_cc.$1Lo.$6v.$ft(t),_cc.$1Lo.$6v.$Q6(t),null);this.$1m6=null}}else{$2ke(this);if(this.$1m6){_a.$6.$19(this.$1m6,null,"",_cc.$1Lo.$6v.$Q6(t),null);this.$1m6=null}}},$9m4:function(){this.set_$6FT(!1);this.set_$36G(!1);this.$Av.$EX.set_$69(!0)},$9NH:function(n,t){this.$9k&&$11z(this)},$7jz:function(){var n=this.$1g.get_$9T()?this.$1g.get_$9T().$6c:null;if(n){var t=_g.$8z.$5L9(n);var i=_y.$AT.$3oj(t);_a.$Kv.$2fh(JsonParser.serialize(i.$Od()))}},$1k0:function(n,t){$2kg(this)},$6Ny:function(n,t){var r=this.$3xW(this.get_$9I());if(r.$4i(this.$EU)){var i=$2kf(this);if(!_a.$2F.$4N(this.$H9,i)){this.set_$3qo(i);$4pW(this)}}else $2kg(this)},$9vO:function(){var n=this.$2vX;this.$2vX=null;n&&this.$4aM(n)}};_d.$oX=function(n,t,i,r){this.$Ev=n;this.$Je=t;this.$1MN=i;this.$a4=r};_d.$oX.prototype={$Ev:null,$Je:null,$1MN:null,$a4:null,$3oJ:function(n,t){return new _d.$nw(n,this.$Ev,this.$Je,this.$1MN,t)},$5Ki:function(n,t){return new _d.$G6(n,this.$Ev,this.$Je,this.$1MN,t)},$5MO:function(n,t,i){return new _d.$ov(n,this.$Ev,this.$Je,this.$1MN,t,i,this.$a4)},$5MK:function(n,t,i){return new _d.$M1(n,this.$Ev,this.$Je,this.$1MN,t,i,this.$a4)},$5Lf:function(n,t,i,r){var u=_a.$6.acss(_a.$0.$1c,"CreateMonthAgendaVM");var f=new _d.$zP(this.$3oJ(n,r),n,this.$Ev,this.$Je,this.$1MN,i,r);_a.$6.aces(u);return f}};_d.$13n=function(n,t,i){_d.$13n.initializeBase(this,[_nbs.NonBootStrings.l_ChangeCalendarColorContextMenuTitle_LowerCase_Text,null,n,t,i]);this.set_$6f3(!1);this.$5BL=!1;this.set_$3UY("CalendarColorPickerTemplates.ColorGridMenuItemTemplate")};_d.$oZ=function(n,t){this.$$d_$9v0=Function.createDelegate(this,this.$9v0);this.$$d_$9v1=Function.createDelegate(this,this.$9v1);this.$$d_$9O6=Function.createDelegate(this,this.$9O6);_d.$oZ.initializeBase(this);_a.$3.$m(n,"Need calendar entry for calendar we are managing the color for.");_a.$3.$m(t,"Error message handler must be specified.");this.$KP=n;this.$5F5=$6yh(this);this.$59N=t};function $6yh(n){var t=new Array(10);t[0]=new _d.$Uk(_nbs.NonBootStrings.l_AutomaticCalendarColorContextMenuTitle_LowerCase_Text,null,-1,"CalendarColorPickerTemplates.AutomaticColorMenuItemTemplate");for(var i=0;i<9;i++)t[i+1]=new _d.$Uk(_g.$j1.toString(i).toLocaleLowerCase(),null,i,"CalendarColorPickerTemplates.ColorMenuItemTemplate");n.$5sM=new _d.$13n(n.$$d_$9O6,t,t[n.$KP.get_$XW()+1]);return t}_d.$oZ.prototype={$KP:null,$5F5:null,$59N:null,$5sM:null,$Jr:!1,$GH:null,get_$1zQ:function(){return this.$Jr},set_$1zQ:function(n){if(this.$Jr!==n){this.$Jr=n;$3(this,"IsActionPending")}return n},$9O6:function(n){if(!this.$Jr){var t=n;if(this.$KP.get_$nY()){this.$KP.set_$1Ls(t);this.$KP.set_$XW(t);return}this.$GH=_a.$6.$1X(_a.$0.$1c,"SetCalendarColor",!0);var i=new _c.$11L(this.$KP,t);i.add_$21(this.$$d_$9v1);i.add_$2t(this.$$d_$9v0);this.set_$1zQ(!0);OwaApplication.$1W.$11(i)}},$9v1:function(n){this.$5F5[this.$KP.get_$XW()+1].$2BG();if(this.$GH){_a.$6.$19(this.$GH,"SetCalendarColor",_cc.$1Lo.$6v.$ft(n),_cc.$1Lo.$6v.$Q6(n),null);this.$GH=null}this.$59N(n.get_$cp())},$9v0:function(n){this.set_$1zQ(!1);if(this.$GH){_a.$6.$19(this.$GH,"SetCalendarColor",null,_cc.$1Lo.$6v.$Q6(n),null);this.$GH=null}}};_d.$13p=function(){_d.$13p.initializeBase(this)};_d.$13p.prototype={$7YA:function(n){for(var t=0,i=this.$t.length;t<i;t++)if(_cc.$7U.$qh(this.$t[t],n)>0){Array.insert(this.$t,t,n);return}Array.add(this.$t,n)}};_d.$Jm=function(){this.$t=new _js.$c};_d.$Jm.$9px=function(n,t){for(var i=0,r=t.length;i<r;i++)_d.$Jm.$6XZ(n,t[i]);return n};_d.$Jm.$6XZ=function(n,t){_a.$3.$K(n,"source");_a.$3.$K(t,"item");var i=_d.$Jm.$5Ws(n,t);var o=i.length;if(o){for(var r=i[0],u,f=1;f<o;f++){u=i[f].$t;for(var e=0,c=u.length;e<c;e++)r.$D(u[e])}r.$D(t);var h=n.$79(r);n.$VI(h,i.length);n.$6r(h,r)}else{var s=new _d.$13p;s.$D(t);_d.$Jm.$3h9(n,s)}};_d.$Jm.$3h9=function(n,t){for(var i=0,r=n.get_$C();i<r;i++){var u=n.get_$3o(i);if(t.$74.$2U(u.$74)<0){n.$6r(i,t);return}}n.$D(t)};_d.$Jm.$5Ws=function(n,t){for(var e=[],i,r,u,f=0,o=n.get_$C();f<o;f++){i=n.get_$3o(f);r=i.$74;u=t.get_$20();if(t.get_$y().$2U(i.$8Q)<0&&u.$2U(r)>0)Array.add(e,i);else if(u.$2U(r)<=0)break}return e};function $6yk(n,t){for(var i,r=0,u=n.$t.get_$C();r<u;r++){i=n.$t.get_$3o(r);if(i.$74.$2U(t.get_$y())<=0&&i.$8Q.$2U(t.get_$20())>=0)return i}return null}_d.$Jm.prototype={$t:null,$D:function(n){_a.$3.$K(n,"item");_d.$Jm.$6XZ(this.$t,n)},$34:function(n){_a.$3.$K(n,"item");var t=$6yk(this,n);if(!t){_js.Trace.logError(_a.$0.$6y,"Could not find conflict group for item: {0}",_d.$En.$1Ct(n));return!1}if(!t.$34(n)){_js.Trace.logError(_a.$0.$6y,"Failed to remove item from conflict group. Item: {0}",_d.$En.$1Ct(n));return!1}var i=this.$t.$79(t);if(i===-1||i>this.$t.get_$C()){_js.Trace.logError(_a.$0.$6y,"Unable to find index of item's conflict group for item: {0}",_d.$En.$1Ct(n));return!1}this.$t.$6C(i);for(var u=_d.$Jm.$9px(new _js.$c,t.$t),r=u.get_$C()-1;r>=0;r--)this.$t.$6r(i,u.get_$3o(r));return!0},$3tD:function(){for(var t=this.$t.get_$C(),i=new Sys.StringBuilder(String.format("\nConflict resolver conflict groups: {0}\n",t)),n=0;n<t;n++){var r=this.$t.get_$3o(n);i.append(r.$3tD())}return i.toString()}};_d.$IB=function(n,t,i,r,u,f,e,o,s){this.$$d_$9XL=Function.createDelegate(this,this.$9XL);this.$$d_$9VU=Function.createDelegate(this,this.$9VU);_d.$IB.initializeBase(this);_a.$3.$K(u,"owaShell");_a.$3.$K(f,"userConfiguration");this.$B=u;this.$b=f;this.$J=s;this.$Cl=n;this.$95=t;this.$2M=i;this.$2JH=r;this.$4fx=e;this.$6kT=o;this.$B.get_$L()==="Mouse"&&(this.$yV=f.get_$5U().get_$2rU());s&&s.$Hd(_cc.$lJ,this.$$d_$9VU)};function $6ym(n){if($6yl(n)&&n.$4fx){var t=this;n.$4fx.$E(function(t){n.set_$5N2(t)})}else n.set_$5N2(null)}function $6yl(n){if(n.$B.get_$L()==="TouchNarrow")return!1;var t=n.$Cw;return t?t.get_$Mj():!1}_d.$IB.prototype={$Cl:null,$95:null,$2M:null,$B:null,$b:null,$2K:null,$S1:null,$aH:null,$Cw:null,$2Kc:null,$2JH:null,$J:null,$4fx:null,$6kT:null,$yV:!1,$3TV:!1,$2gg:0,$1nl:!1,$2uh:null,get_$9T:function(){return this.$2K},set_$9T:function(n){if(this.$2K!==n){this.$2K=n;this.$B.get_$FG()||this.$B.get_$L()!=="Mouse"||!this.$2K||this.$2K.get_$1Q9()?this.set_$5Mf(null):this.set_$5Mf(new _d.$5e(this.$2K,this.$2JH));$3(this,"CurrentItem")}return n},get_$5N2:function(){return this.$2uh},set_$5N2:function(n){if(this.$2uh!==n){this.$2uh=n;$3(this,"CurrentTimeline")}return n},get_$x6:function(){return this.$aH},set_$x6:function(n){if(this.$aH!==n){this.$aH=n;this.$aH&&this.$B.get_$L()==="Mouse"&&this.set_$x4(this.$aH.get_$5V());$3(this,"CurrentItemModel")}return n},get_$5Mf:function(){return this.$2Kc},set_$5Mf:function(n){if(this.$2Kc!==n){this.$2Kc=n;$3(this,"CurrentItemContextMenuViewModel")}return n},get_$x4:function(){return this.$Cw},set_$x4:function(n){if(n!==this.$Cw){this.$Cw=n;$6ym(this);$3u(this,"CurrentCalendarModel","CanCreateItemOnCalendar")}return n},get_$1EX:function(){return this.$yV},set_$1EX:function(n){if(this.$yV!==n){this.$yV=n;$3(this,"IsModuleSidePanelExpanded")}return n},get_$6gg:function(){return this.$3TV},set_$6gg:function(n){if(this.$3TV!==n){this.$3TV=n;$3(this,"SidePanelItemsLoadedNotificationEnabled")}return n},get_$3TW:function(){return this.$2gg},set_$3TW:function(n){if(this.$2gg!==n){this.$2gg=n;$3(this,"SidePanelMonthPickerCount")}return n},get_$8Ja:function(){if(!this.$Cw)return!1;var n=this.$2M.$xm(this.$Cw.get_$9U());return this.$95.$5Xq(n.get_$o())},get_$1ZX:function(){if($5(this.$Cw))return!1;var n=this.$2M.$xm(this.$Cw.get_$9U());return!this.$B.get_$FG()&&!!n&&n.$2rm(this.$Cw)},get_$6QF:function(){return this.$S1},set_$6QF:function(n){if(this.$S1!==n){this.$S1&&this.$S1.$q("IsShown",this.$$d_$9XL);this.$S1=n;this.$S1&&this.$S1.$Y("IsShown",this.$$d_$9XL);$3(this,"PeekViewModel")}return n},$49:function(){this.$J&&this.$J.$11q(_cc.$lJ,this.$$d_$9VU);_a.$1.prototype.$49.call(this)},$9XL:function(n,t){this.$1nl=!!(this.$1nl|!!this.$S1)},$9VU:function(n){this.set_$x4(n.$CV)}};_d.$7T=function(){this.$$d_$9NP=Function.createDelegate(this,this.$9NP);this.$2Tx=_a.$7.get_$2F();_d.$7T.initializeBase(this)};function $4pa(n){if(!n.$mS){n.$2Tx=_a.$7.get_$2F();n.$mS=_js.$J.get_$I().$p3(_a.$0.$1c,"CalendarDateTimeNotification",n.$$d_$9NP,_d.$7T.$5N4)}}function $4pZ(n){n.$mS&&(n.$mS=_js.$J.get_$I().$5A(n.$mS))}_d.$7T.prototype={$mS:null,$2rZ:0,add_$5Fb:function(n){this.$2G("CalendarTimeChanged",n);++this.$2rZ==1&&$4pa(this)},remove_$5Fb:function(n){this.$2H("CalendarTimeChanged",n);--this.$2rZ||$4pZ(this)},add_$2Ij:function(n){this.$2G("CalendarDateChanged",n);++this.$2rZ==1&&$4pa(this)},remove_$2Ij:function(n){this.$2H("CalendarDateChanged",n);--this.$2rZ||$4pZ(this)},$9NP:function(){var n=_a.$7.get_$2F();var t=!!this.$2Tx.$9K(n);this.$2Tx=n;$BF(this,"CalendarTimeChanged",this,n);t&&$BF(this,"CalendarDateChanged",this,n)}};_d.$G6=function(n,t,i,r,u){this.$$d_$6HT=Function.createDelegate(this,this.$6HT);this.$$d_$9cA=Function.createDelegate(this,this.$9cA);_d.$G6.initializeBase(this,[n,t,i,r,u]);var f=_a.$6.acss(_a.$0.$1c,"CalendarDayViewModel:Init");this.set_$9I(n);this.$nw=new _0365m.$o(_nbs.NonBootStrings.l_SplitLabel_Caps_Text,_d.$4.get_$6hg(),new _C(this.$$d_$9cA,this.get_$1a()),!1,null,null,null,_d.$4.get_$6hj());this.$3kp=new _d.$G4([this.get_$9I()],this.$Cr,this.$1g.$Cl.get_$I6(),u.$2M,this.$1g.$b,this.$1g.$J);_a.$6.aces(f)};function $6yn(n){if(!$5(n.$1KB)){n.$1KB.$1t();for(var i=Math.min(2,n.$Cr.get_$C()),t=0;t<i;t++)n.$1KB.$D(n.$Cr.get_$3o(t));$3u(n,"CanShowInAgenda","ShowInAgendaItems")}}_d.$G6.prototype={$1KB:null,$3kp:null,$Ra:!1,$1nE:null,$nw:null,get_$1CU:function(){return 0},get_$1N:function(){return"CalendarDayViewModel"},get_$1ZS:function(){return 1},get_$6l4:function(){return this.$1g.$B.get_$L()!=="TouchNarrow"?null:this.$1nE?this.$1KB:this.$Cr},get_$37Q:function(){return this.$Ra},set_$37Q:function(n){if(this.$Ra!==n){this.$Ra=n;var t=[this.get_$9I()];if(this.$Ra){this.$3kp.set_$bu(t);this.set_$3pn(this.$3kp);this.$nw.set_$1Q(_nbs.NonBootStrings.l_MergeLabel_Caps_Text);this.$nw.set_$Am(_d.$4.get_$8UP());this.$nw.set_$IS(_d.$4.get_$8UV())}else{this.$1CR.set_$bu(t);this.set_$3pn(this.$1CR);this.$nw.set_$1Q(_nbs.NonBootStrings.l_SplitLabel_Caps_Text);this.$nw.set_$Am(_d.$4.get_$6hg());this.$nw.set_$IS(_d.$4.get_$6hj())}$3u(this,"IsSideBySideMode","CanDimItems")}return n},get_$5G2:function(){return!this.$Ra&&_d.$1s.prototype.get_$5G2.call(this)},get_$3lu:function(){return this.$1g.$Cl.get_$I6().get_$C()>1},get_$5GP:function(){return!$5(this.$1KB)&&this.$Cr.get_$C()>this.$1KB.get_$C()},get_$A0r:function(){return this.get_$5GP()?String.format(_nbs.NonBootStrings.l_Calendar_ShowInAgendaLabel_Text,this.$Cr.get_$C()-this.$1KB.get_$C()):""},get_$A0q:function(){return this.$1nE},set_$A0q:function(n){if(this.$1nE!==n){this.$1nE=n;if(this.$1nE){this.$1KB=new _0365f.$Fq(_cc.$7U.$qh);this.$Cr.add_$1Y(this.$$d_$6HT)}else{this.$1KB=null;this.$Cr.remove_$1Y(this.$$d_$6HT)}$3(this,"ShowInAgendaCommand")}return n},get_$2ni:function(){return String.format(_nbs.NonBootStrings.l_CalendarDayView_AT_Region_Text,this.get_$4Ux())},$5af:function(){this.set_$Hg(_d.$9B.$E(_a.$0.$1c,"DayView_GoPrev",!0,!0));this.set_$Ak(this.get_$Ak().$2w(-1))},$5ae:function(){this.set_$Hg(_d.$9B.$E(_a.$0.$1c,"DayView_GoNext",!0,!0));this.set_$Ak(this.get_$Ak().$2w(1))},$2zo:function(n){return this.$Ra?$2FF(this,this.get_$9I(),n,0):_d.$7o.prototype.$2zo.call(this,n)},$5Ze:function(){if(!this.$Ra)return _d.$7o.prototype.$5Ze.call(this);var n=$4pV(this);if(this.$Av&&this.$Av.$EX.$2T){n.set_$y(this.$Av.get_$y());n.set_$DE(this.$Av.get_$20().$5u(this.$Av.get_$y()));this.$D9(this.$Av);this.set_$3Ho(null)}else{if(this.$Q9){n.set_$y($2ki(this,this.get_$9I(),this.$Q9.$M5));var t=this.$1g.$Cl.get_$I6().get_$3o(this.$Q9.$M5.$Jh);t&&n.set_$1ML(t.get_$9U());this.set_$2P8(null)}n.set_$DE(_a.$2F.$1K4(this.$nD));n.set_$1ML(this.$1g.$Cw.get_$9U())}return n},$81F:function(){if(this.$Ra){var n=$3aU(this);n.set_$y(_a.$2F.$2tp(this.get_$9I(),this.$1g.$b.get_$13().get_$MF().get_$vk()));if(this.$Y5){var t=this.$1g.$Cl.get_$I6().get_$3o(this.$Y5.$M5.$Jh);t&&n.set_$1ML(t.get_$9U())}return n}else return _d.$7o.prototype.$81F.call(this)},$6dB:function(n){if(!this.$Ra)return _d.$7o.prototype.$6dB.call(this,n);n.set_$y($2ki(this,this.get_$9I(),this.$Q9.$M5));n.set_$20($2ki(this,this.get_$9I(),this.$Q9.$1mc).$9v(_a.$2F.$1K4(this.$nD)));n.set_$5V(this.$1g.$Cl.get_$I6().get_$3o(this.$Q9.$M5.$Jh));return n},$9um:function(n){if(!this.$Ra)return _d.$7o.prototype.$9um.call(this,n);n.set_$y(this.get_$9I());n.set_$20(this.get_$9I());n.set_$5V(this.$1g.$Cl.get_$I6().get_$3o(this.$Y5.$M5.$Jh));return n},$6HN:function(n){if(this.$1g.$B.get_$L()==="TouchNarrow")_d.$1s.prototype.$6HN.call(this,n);else if(!this.$Ra){this.$1g.set_$x4(n);this.$1g.$Cl.get_$I6().get_$C()===2&&this.set_$37Q(!0)}},$3K7:function(n,t){if(this.$9k){_d.$1s.prototype.$3K7.call(this,n,t);this.$nw.set_$r(!this.get_$3lu());this.set_$37Q(this.$Ra&&this.get_$3lu())}},$6HT:function(n,t){$6yn(this)},$9cA:function(){this.set_$37Q(!this.$Ra)}};_d.$7o=function(n,t,i,r,u){this.$$d_$9T4=Function.createDelegate(this,this.$9T4);this.$$d_$6Iv=Function.createDelegate(this,this.$6Iv);this.$$d_$9SV=Function.createDelegate(this,this.$9SV);this.$$d_$9LP=Function.createDelegate(this,this.$9LP);this.$$d_$9SR=Function.createDelegate(this,this.$9SR);this.$$d_$7mx=Function.createDelegate(this,this.$7mx);_d.$7o.initializeBase(this,[n,!0,i,t,r,u]);var f=_a.$6.acss(_a.$0.$1c,"CalendarDayWeekBaseVM:Init");this.$Cr=new _0365f.$Fq(_cc.$7U.$qh);this.$t=new _js.$c;this.$3p3=new _C(this.$$d_$7mx,this.get_$1a());this.$4PE=new _C(this.$$d_$9SR,this.get_$1a());this.$4O2=new _C(this.$$d_$9LP,this.get_$1a());this.$6K7=new _C(this.$$d_$9SV,this.get_$1a());this.$1g.$B.get_$L()==="Mouse"&&$4pd(this);this.$nD=$4pb(this);this.$1CR=new _d.$GD(this.$H9,this.$Cr,this.$1g,u.$2M,this.$1g.$b,this.$1g.$J);this.$OS=this.$1CR;this.$Y("DateRangeArray",this.$$d_$6Iv);_a.$6.aces(f)};function $2FE(n,t,i){return $2FF(n,null,t,i)}function $2ki(n,t,i){return $2FF(n,t,i,0)}function $2FF(n,t,i,r){t||(t=n.$1CR.get_$bu()[i.$Jh]);$5(r)&&(r=0);var u=36e5/_a.$2F.$1K4(n.$nD);var f=60/u;var e=Math.floor((i.$Tj+r)/u);var o=(i.$Tj+r)%u*f;return new _a.$7(t.get_$4S(),t.get_$3T(),t.get_$5n(),e,o,0)}function $4pb(n){if(n.$1g.$B.get_$L()==="TouchNarrow")return 3;if(n.$1g.$B.get_$L()==="TouchWide")return 2;switch(n.$1g.$b.get_$13().get_$jL()){case 15:return 1;case 30:return 2}return 3}function $6yo(n){return n.$1g.$B.get_$FG()?null:new _0365m.$2c([new _0365m.$o(_u.Strings.l_NewString_LowerCase_Text,null,n.$ca)])}function $4pc(n,t){_js.Trace.logInfo(n.get_$1a(),"Ignoring click on the grid: {0}",n.$1g.$1nl);n.$1g.$1nl?n.$1g.$1nl=!1:t.$2T&&t.$s()}function $4pd(n){n.$1g.get_$1ZX()&&!n.$1rX?n.set_$5BG($6yo(n)):!n.$1g.get_$1ZX()&&n.$1rX&&n.set_$5BG(null)}_d.$7o.prototype={$3p3:null,$4PE:null,$4O2:null,$6K7:null,$1CR:null,$OS:null,$1rX:null,$nD:0,$Cr:null,$t:null,$sJ:!1,$Q9:null,$1DY:null,$Y5:null,$344:!1,get_$8If:function(){return this.$344},set_$8If:function(n){if(n!==this.$344){this.$344=n;$3(this,"IsAllDayItemContextMenuShown")}return n},get_$dE:function(){return this.$sJ},set_$dE:function(n){if(this.$sJ!==n){this.$sJ=n;$3(this,"IsUpdatingItems")}return n},get_$3pn:function(){return this.$OS},set_$3pn:function(n){if(this.$OS!==n){this.$OS=n;$3(this,"CurrentColumnProviderViewModel")}return n},get_$5BG:function(){return this.$1rX},set_$5BG:function(n){if(this.$1rX!==n){this.$1rX=n;$3(this,"AllDayWellContextMenuViewModel")}return n},get_$rZ:function(){return this.$1g.$B.get_$L()==="Mouse"?54:this.$1g.$B.get_$L()==="TouchWide"?60:52},get_$5ak:function(){return this.$nD===2?this.get_$rZ()/2:this.$nD===1?this.get_$rZ()/4:this.get_$rZ()},get_$3zU:function(){return this.$1g.$B.get_$L()==="TouchNarrow"?50:this.$1g.$B.get_$L()==="TouchWide"?63:58},get_$89q:function(){return this.$nD},set_$89q:function(n){if(this.$nD!==n){this.$nD=n;$3(this,"GridlineInterval")}return n},get_$89r:function(){return $5(this.$Q9)?null:this.$2zo(this.$Q9.$M5)},get_$89o:function(){return $5(this.$Y5)?null:this.$2zo(this.$Y5.$M5)},get_$6q6:function(){return this.$1g.$b.get_$13().get_$MF().get_$vk()},get_$2P8:function(){return this.$Q9},set_$2P8:function(n){if(this.$Q9!==n){this.$Q9=n;_d.$G4.isInstanceOfType(this.$OS)&&this.$1g.$Cl&&this.$Q9&&this.$1g.set_$x4(this.$1g.$Cl.get_$I6().get_$3o(this.$Q9.$M5.$Jh));$3(this,"GridSelectedRowColumnIndex")}return n},get_$5aj:function(){return this.$1DY},set_$5aj:function(n){if(this.$1DY!==n){this.$1DY=n;$3(this,"GridHoveredRowColumnIndex")}return n},get_$315:function(){return this.$Y5},set_$315:function(n){if(n&&n.$4i(this.$Y5))return n;this.$Y5=n;_d.$G4.isInstanceOfType(this.$OS)&&this.$1g.$Cl&&this.$Y5&&this.$1g.set_$x4(this.$1g.$Cl.get_$I6().get_$3o(this.$Y5.$M5.$Jh));$3(this,"GridAllDaySelectedRowColumnIndex");return n},get_$YK:function(){return _d.$1s.prototype.get_$YK.call(this)},set_$YK:function(n){if(n===this.get_$YK())return n;_d.$1s.prototype.set_$YK.call(this,n);var t=this.$1g.$b.get_$13();n?t.$Y("HourIncrement",this.$$d_$9T4):t.$q("HourIncrement",this.$$d_$9T4);return n},$5Y3:function(){return this.$t.get_$C()+this.$Cr.get_$C()},$84q:function(){return $2kd(this,this.$t)+$2kd(this,this.$Cr)},$2zo:function(n){return $2FF(this,this.$1CR.get_$bu()[n.$Jh],n,0)},$3hD:function(n){var u=n.length;var e=_a.$6.acss(_a.$0.$6y,"CalendarDayWeekBaseVM:AddItems_"+u);this.set_$dE(!0);for(var f=[],i=[],t,r=0;r<u;r++){t=n[r];this.$1n0(t)&&(t.get_$Ao()?Array.add(f,t):t.get_$y().$4D().$2U(t.get_$20().$4D())?Array.addRange(i,$1q3(this,t,this.$H9)):Array.add(i,t))}this.$Cr.$6S(f);this.$t.$6S(i);this.set_$dE(!1);_a.$6.aces(e)},$IB:function(n){var t=_a.$6.acss(_a.$0.$6y,"CalendarDayWeekBaseVM:AddItem");n.get_$Ao()?this.$Cr.$D(n):n.get_$y().$4D().$2U(n.get_$20().$4D())?this.$t.$6S($1q3(this,n,this.$H9)):this.$t.$D(n);_a.$6.aces(t)},$D9:function(n){var t=_a.$6.acss(_a.$0.$6y,"CalendarDayWeekBaseVM:RemoveItem");var i=n===this.$Av&&!n.$2g.get_$5R();n.get_$Ao()&&!i?_d.$1s.$4W1(n,this.$Cr):_d.$1s.$4W1(n,this.$t);_a.$6.aces(t)},$2AB:function(){this.set_$dE(!0);this.$Cr.$1t();this.$t.$1t();_d.$1s.prototype.$2AB.call(this);this.set_$dE(!1)},$7oe:function(){return this.$1g.$B.get_$FG()?null:new _0365m.$2c([new _0365m.$o(_u.Strings.l_NewString_LowerCase_Text,null,this.$5LR)])},$6I7:function(n,t){_d.$1s.prototype.$6I7.call(this,n,t);$4pd(this)},$5Ze:function(){var n=_d.$1s.prototype.$5Ze.call(this);if(!$5(this.$Av)&&this.$Av.$EX.$2T){n.set_$DE(this.$Av.get_$20().$5u(this.$Av.get_$y()));this.$D9(this.$Av);this.set_$3Ho(null)}else{if(!$5(this.$Q9)){n.set_$y($2FE(this,this.$Q9.$M5));this.set_$2P8(null)}n.set_$DE(_a.$2F.$1K4(this.$nD))}return n},$81F:function(){var n=$3aU(this);var t=this.get_$9I();$5(this.$Y5)||this.$Y5.$M5.$Jh>=0&&this.$Y5.$M5.$Jh<this.$1CR.get_$bu().length&&(t=this.$1CR.get_$bu()[this.$Y5.$M5.$Jh]);this.$1g&&this.$1g.$Cw&&n.set_$1ML(this.$1g.$Cw.get_$9U());n.set_$y(_a.$2F.$2tp(t,this.$1g.$b.get_$13().get_$MF().get_$vk()));return n},$9um:function(n){var t=this.$1CR.get_$bu()[this.$Y5.$M5.$Jh];n.set_$y(t);n.set_$20(t);n.set_$5V(this.$1g.$Cw);return n},$6dB:function(n){n.set_$y($2FE(this,this.$Q9.$M5));n.set_$20($2FE(this,this.$Q9.$1mc,1));n.set_$5V(this.$1g.$Cw);return n},$84C:function(){return this.$1g.$B.get_$L()==="Mouse"?this.$3p3:this.$2ty},$81E:function(){return this.$1g.$B.get_$L()==="Mouse"?this.$3oK:this.$ca},$6Iv:function(n,t){this.$OS&&this.$OS.set_$bu(this.$H9);this.set_$315(null);this.set_$2P8(null)},$9T4:function(n,t){this.set_$89q($4pb(this))},$9SR:function(){$4pc(this,this.$84C())},$9LP:function(){$4pc(this,this.$81E())},$9SV:function(){var n;(n=this.$1g).$1nl=!!(n.$1nl|this.$1g.$yV)},$7mx:function(){if(this.get_$5Fx()){this.$1g.set_$x6(null);var n=new _g.$1q;n.EmailAddress=this.$1g.$b.get_$2z().get_$AM();n.Name=this.$1g.$b.get_$2z().get_$Fn();n.MailboxType="Mailbox";var t=this.$Ev.get_$3ky().$1u1(n);this.set_$3Ho(new _d.$oj(this.$6dB(t),new _C(this.$$d_$7XC,this.get_$1a()),new _C(this.$$d_$7sR,this.get_$1a())));this.$t.$D(this.$Av)}}};_d.$Qx=function(){};_d.$G7=function(){};_d.$Qz=function(n,t,i,r,u){this.$$d_$9NG=Function.createDelegate(this,this.$9NG);this.$$d_$9dT=Function.createDelegate(this,this.$9dT);_d.$Qz.initializeBase(this,[n.get_$Bb(),t,i,!0]);_a.$3.$K(n,"calendar");this.$6me=new _C(this.$$d_$9dT,_a.$0.$1c);this.$4Yp=r;this.$Cl=u;this.$AQ=n;this.$AQ.$Y("CalendarName",this.$$d_$9NG)};_d.$Qz.prototype={$6me:null,$4Yp:null,$Cl:null,$AQ:null,get_$AAv:function(){return String.format(_nbs.NonBootStrings.l_CalendarHeaderUnselectCalendar_Aria_Text,this.$AQ.get_$Bb())},get_$9sz:function(){return String.format(_nbs.NonBootStrings.l_CalendarHeaderSelectCalendar_Aria_Text,this.$AQ.get_$Bb())},$49:function(){this.$AQ.$q("CalendarName",this.$$d_$9NG);_js.$9.prototype.$49.call(this)},$9dT:function(){this.$Cl.$3Ww(this.$AQ)},$9NG:function(n,t){this.set_$1Q(this.$AQ.get_$Bb())}};_d.$Kp=function(n,t,i,r){_d.$Kp.initializeBase(this);n&&t&&i&&n.$v.get_$fH()&&(r===4?$6zT(this,t,i):(r===1||r===2||r===3)&&$6zS(this,n,t,i,r))};_d.$Kp.$7lA=function(){return new _d.$Kp(null,null,null,0)};_d.$Kp.$E=function(n,t,i,r){return new _d.$Kp(n,t,i,r)};function $6zT(n,t,i){if(t.get_$Ao()){n.$2rz=i.$mb(t.get_$y(),!0,!0);n.$2s0=i.$mb(t.get_$20(),!0,!0)}}function $6zS(n,t,i,r,u){if(_d.$M0.isInstanceOfType(i)){n.$3lp=!t.$v.get_$y().$2U(i.get_$y());n.$3lo=!t.$v.get_$20().$2U(i.get_$20());n.$2rz=!1;n.$2s0=!1}else{n.$3lp=!t.$v.get_$Ao();n.$3lo=!t.$v.get_$Ao();n.$2rz=u!==1&&t.$v.get_$Ao()&&r.$mb(i.get_$y(),!0,!0);n.$2s0=u!==1&&t.$v.get_$Ao()&&r.$mb(i.get_$20(),!0,!0)}}_d.$Kp.prototype={$3lp:!1,$3lo:!1,$2rz:!1,$2s0:!1,get_$7fX:function(){return this.$3lp},get_$7fU:function(){return this.$3lo},get_$7fV:function(){return this.$2rz},get_$7fW:function(){return this.$2s0}};_d.$vg=function(){this.$t=[]};_d.$vg.prototype={$74:null,$8Q:null,$t:null,$D:function(n){_a.$3.$K(n,"item");(!this.$t.length||n.get_$y().$2U(this.$74)<0)&&(this.$74=n.get_$y().$3g());(!this.$t.length||n.get_$20().$2U(this.$8Q)>0)&&(this.$8Q=n.get_$20().$3g());this.$7YA(n)},$34:function(n){_a.$3.$K(n,"item");var t=Array.remove(this.$t,n);t||_js.Trace.logError(_a.$0.$6y,"Failed to remove ICalendarSurfaceItem object from group, item id: {0}. ",_d.$En.$1Ct(n));return t},$3tD:function(){var t=this.$t.length;var n=new Sys.StringBuilder;n.appendLine(String.format("Conflict group --> Date Range: '{0} - {1}', Item Count: {2}",this.$74,this.$8Q,t));n.appendLine(String.format("Items: ",t));for(var i=0;i<t;i++){var r=this.$t[i];n.appendLine(_d.$En.$7uD(r))}return n.toString()},$7YA:function(n){Array.add(this.$t,n)}};_d.$3e=function(n,t,i){this.$$d_$4j5=Function.createDelegate(this,this.$4j5);this.$$d_$4QI=Function.createDelegate(this,this.$4QI);this.$$d_$9VK=Function.createDelegate(this,this.$9VK);this.$$d_$6LI=Function.createDelegate(this,this.$6LI);this.$$d_$1Ti=Function.createDelegate(this,this.$1Ti);this.$$d_$6gV=Function.createDelegate(this,this.$6gV);this.$$d_$3zR=Function.createDelegate(this,this.$3zR);this.$$d_$6fZ=Function.createDelegate(this,this.$6fZ);this.$$d_$9zn=Function.createDelegate(this,this.$9zn);this.$$d_$3K7=Function.createDelegate(this,this.$3K7);this.$$d_$6Ih=Function.createDelegate(this,this.$6Ih);this.$$d_$4cX=Function.createDelegate(this,this.$4cX);this.$$d_$A2K=Function.createDelegate(this,this.$A2K);this.$$d_$6Np=Function.createDelegate(this,this.$6Np);this.$$d_$6Nn=Function.createDelegate(this,this.$6Nn);this.$$d_$2gF=Function.createDelegate(this,this.$2gF);_d.$3e.initializeBase(this);var u=_a.$6.acss(_a.$0.$1c,"CalendarLayoutVM:Init");this.$1H=i;this.$7V=t;this.$qT=n;this.$12e=new _js.$c;this.$2Id={};this.$39t=new _y.$FO;this.$bz=new _C(this.$$d_$2gF,_d.$3e.$A);this.$2Ea=new _C(this.$$d_$6Nn,_a.$0.$1c);this.$1XN=new _C(this.$$d_$6Np,_a.$0.$1c);if(this.$7V.$B.get_$L()!=="TouchNarrow"){this.$1Jb=new _C(this.$$d_$A2K,_d.$3e.$A);this.$1Ja=new _C(this.$$d_$4cX,_d.$3e.$A);this.$1ss=new _js.$c;this.$mL=new _js.$c;this.$7V.$Y("CurrentCalendarModel",this.$$d_$6Ih);var r=this.$7V.$Cl.get_$I6();r.add_$1Y(this.$$d_$3K7);r.get_$C()>0&&$4pw(this,r.$6W())}else this.$4be=new _C(this.$$d_$9zn,_d.$3e.$A);this.$11L=new _C(this.$$d_$6fZ,_d.$3e.$A);this.$nC=new _C(this.$$d_$3zR,_d.$3e.$A);this.$6gW=new _C(this.$$d_$6gV,_d.$3e.$A);this.$35=_a.$7.get_$2F();if(this.$7V.$B.get_$L()!=="Mouse"){this.set_$6k(_y.$22.$Aj(this,null,null));this.$3y.set_$1JV(!0)}this.$7V.$J.$Hd(_a.$D5,this.$$d_$1Ti);_a.$6.aces(u)};function $1Kx(n,t){n.$6pI=t;n.$Hs?$6zZ(n,n.$Hs.get_$1N(),t):$4px(n,t)}function $4px(n,t){n.$7V.set_$x6(null);var i=null;var r=!1;if(t in n.$2Id)i=n.$2Id[t];else{switch(t){case"DayViewModel":i=n.$qT.$5Ki(n.$35,n.$7V);break;case"WorkWeekViewModel":i=n.$qT.$5MO(n.$35,n.$7V.$B.get_$L()==="Mouse"?n.$bz:null,n.$7V);break;case"WeekViewModel":i=n.$qT.$5MK(n.$35,n.$7V.$B.get_$L()==="Mouse"?n.$bz:null,n.$7V);break;case"MonthAgendaViewModel":i=n.$qT.$5Lf(n.$35,!0,n.$bz,n.$7V);r=!0;break;case"AgendaViewModel":i=n.$qT.$3oJ(n.$35,n.$7V);break;default:break}n.$2Id[t]=i}var u=n.$Hs?n.$Hs.get_$1N():null;n.set_$Ed(i);n.get_$Ed().set_$Hg(n.$mR);r&&n.get_$Ed().set_$dD(n.$EF);var f=this;_js.$J.get_$I().$40(_a.$0.$1c,"CalendarLayoutViewModel",function(){$6zY(n,u,i.get_$1N())})}function $6zZ(n,t,i){var r=n.$jB("ViewChanging");r&&r(t,n.$$d_$4j5)}function $6zY(n,t,i){var r=n.$jB("ViewChanged");r&&r(t,i)}function $120(n,t,i){i===undefined&&(i=!0);_a.$6.stPT(_a.$0.$1c,"SwitchCalendarView",3);n.set_$Hg(_d.$9B.$E(_a.$0.$1c,t,!0,i))}function $6za(n){n.get_$4C0()&&(_d.$G6.isInstanceOfType(n.get_$Ed())?n.get_$4C0().set_$r(!n.get_$Ed().get_$3lu()):n.get_$4C0().set_$r(!0))}function $6zc(n){_d.$92.isInstanceOfType(n.$Hs)?n.set_$1oO(2):_d.$M1.isInstanceOfType(n.$Hs)?n.set_$1oO(3):n.set_$1oO(1)}function $6zX(n,t){if(!n.$7V.$B.get_$FG()){n.$9v6(t);_h.$2D.$qg(n.$7V.$b.get_$5U().get_$Tz(),OwaApplication.$1W)}}function $4pw(n,t){for(var r=t.length,i=0;i<r;i++)$6zW(n,t[i]);$He(n,_d.$3e.$4OK)}function $6zW(n,t){var i=null;var u=this;var r=new _C(function(){n.set_$3Qd(i)},_d.$3e.$A);i=n.$7kY(t,r);n.$mL.$D(i)}function $6zb(n,t,i){for(var r=t,u=t+i;r<u;r++)n.$mL.get_$3o(r).$1R();n.$mL.$VI(t,i);$He(n,_d.$3e.$4OK)}_d.$3e.prototype={$qT:null,$7V:null,$39t:null,$bz:null,$4be:null,$1Jb:null,$1Ja:null,$11L:null,$nC:null,$6gW:null,$2Ea:null,$1XN:null,$2Id:null,$12e:null,$1H:null,$Oo:!1,$Hs:null,$35:null,$ef:0,$5Bi:null,$6pI:null,$1ss:null,$mL:null,$116:null,$nw:null,$mR:null,add_$4j9:function(n){this.$2G("ViewChanging",n)},remove_$4j9:function(n){this.$2H("ViewChanging",n)},add_$4j7:function(n){this.$2G("ViewChanged",n)},remove_$4j7:function(n){this.$2H("ViewChanged",n)},add_$2wY:function(n){this.$2G("DisplayedDateChanging",n)},remove_$2wY:function(n){this.$2H("DisplayedDateChanging",n)},get_$3KT:function(){return this.$2Ea},get_$3KV:function(){return this.$1XN},get_$KN:function(){return this.$7V.$B.get_$L()!=="Mouse"?_y.$1Mq.prototype.get_$KN.call(this):0},get_$5Bb:function(){return!0},get_$Ed:function(){return this.$Hs},set_$Ed:function(n){if(this.$Hs!==n){var i=_a.$6.acss(_a.$0.$1c,"MainVM_"+n.get_$1N());var t=null;if(this.$Hs){this.$Hs.remove_$83(this.$$d_$6LI);this.$Hs.remove_$2wY(this.$$d_$9VK);this.$Hs.set_$Gg(!1);t=this.get_$Ed().get_$9I();this.get_$Ed().set_$Ak(t);this.$Hs.set_$Hg(null)}this.$Hs=n;$6zX(this,this.$Hs.get_$1ZS());_js.Trace.logWarning(_a.$0.$1c,"[CalendarLayoutViewModel] MainViewModel: Before activating view model '{0}'",this.$Hs.get_$1N());this.$7V.$B.get_$L()!=="TouchNarrow"&&$6za(this);this.$12e.$76(n)||this.$12e.$D(n);if(t){this.get_$Ed().set_$Ak(t);this.get_$Ed().set_$9I(t)}this.$Hs.add_$83(this.$$d_$6LI);this.$Hs.add_$2wY(this.$$d_$9VK);$6zc(this);this.$35=n.get_$9I();this.$Hs.set_$Gg(!0);$3(this,"MainViewModel");this.$39t.$N9(n);_a.$6.aces(i)}return n},$9VK:function(n,t){var i=this.$jB("DisplayedDateChanging");i?i(n,t):t()},get_$1oO:function(){return this.$ef},set_$1oO:function(n){if(n!==this.$ef){this.$ef=n;$3u(this,"TimeStripMode","DisplayedDateString")}return n},get_$CD:function(){return this.$35},set_$CD:function(n){this.$35.$4i(n)||this.get_$Ed().set_$9I(n);return n},get_$5Q5:function(){if($5(this.get_$Ed())||$5(this.get_$Ed().get_$Ak()))return"";var n;var t=this.get_$Ed().get_$Ak();switch(this.$ef){case 1:n=t.$2b(3);break;case 2:n=t.$2b(2);break;case 3:var i=_a.$7.$Mb(t);var r=i.$2w(6);n=_a.$7.$2OZ(i,r);break;default:throw Error.notImplemented("Unexpected TimeStrip mode");}if(this.$7V.$B.get_$L()==="Mouse"&&_d.$M1.isInstanceOfType(this.get_$Ed())&&this.$7V.$b.get_$13().get_$la()){var u=_a.$7.$Mb(t).$2w(6);return _js.$8.$4B(_nbs.NonBootStrings.l_CalendarHeaderWeekNumbers_Text,n,_a.$7.$3zH(u))}return n},get_$Hg:function(){return this.$mR},set_$Hg:function(n){this.$mR=n;this.get_$Ed()&&this.get_$Ed().set_$Hg(n);return n},get_$3Qd:function(){return this.$116},set_$3Qd:function(n){if(this.$116!==n){this.$116&&this.$116.set_$2L(!1);this.$116=n;if(this.$116){this.$116.set_$2L(!0);this.$7V.set_$x4(this.$116.$AQ)}$3(this,"SelectedCalendarHeaderItem")}return n},get_$4C0:function(){if(!this.$nw&&_d.$G6.isInstanceOfType(this.get_$Ed())){this.$nw=this.get_$Ed().$nw;this.$1ss.$6r(0,this.$nw)}return this.$nw},get_$YK:function(){return this.$Oo},set_$YK:function(n){if(n===this.$Oo)return n;this.$Oo=n;var t=this.$7V.$b.get_$13();n?t.$Y("ShowWeekNumbers",this.$$d_$4QI):t.$q("ShowWeekNumbers",this.$$d_$4QI);return n},$2nz:function(){this.$7V.$2M.$1Oh();if(this.$7V.$B.get_$FG()){this.$7V.set_$x4(this.$7V.$2M.get_$ik());this.$5Bi=String.format(_nbs.NonBootStrings.l_AnonymousCalendarDisplayNameFormat_Text,this.$7V.$Cw.get_$Bb(),this.$7V.$b.get_$2z().get_$Fn())}else this.$7V.set_$x4(this.$7V.$Cl.get_$I6().get_$3o(0))},$2gF:function(){$1Kx(this,"DayViewModel")},$9zn:function(){throw Error.notImplemented();},$A2K:function(){throw Error.notImplemented();},$4cX:function(){throw Error.notImplemented();},$6fZ:function(){throw Error.notImplemented();},$ABq:function(n,t){throw Error.notImplemented();},$3zR:function(){if(this.$Hs&&this.$Hs.$nC.$2T){this.$Hs.$nC.$s();this.$Hs.get_$1ZS()!==3||_a.$2F.$2Rc(this.$Hs.$H9,this.$Hs.get_$9I())||this.$4cX()}},$6gV:function(){this.$Hs&&this.$Hs.$6gV()},$49:function(){this.$7V.$J.$11q(_a.$D5,this.$$d_$1Ti);this.set_$YK(!1);_a.$1.prototype.$49.call(this)},$4j5:function(){$4px(this,this.$6pI)},$6LI:function(n,t){if(t==="VMSelectedDate"){this.$35=this.$Hs.get_$9I();$3(this,"SelectedDate")}else t==="DisplayedDate"&&$3(this,"DisplayedDateString");$3(this,t)},$6Nn:function(){_js.Trace.logInfo(_a.$0.$1c,"CalendarLayoutViewModel activated");this.$Hs&&this.$Hs.set_$3SA(!0)},$6Np:function(){_js.Trace.logInfo(_a.$0.$1c,"CalendarLayoutViewModel deactivated");this.$Hs&&this.$Hs.set_$3SA(!1)},$4cG:function(n){switch(n){case 1:this.$2fY(1);break;case 3:this.$7V.$B.get_$FG()?this.$2fY(2):this.$2fY(3);break;case 2:this.$2fY(2);break;case 4:this.$2fY(4);break;default:throw Error.argumentOutOfRange("viewType");}},$4dL:function(){var n=null;var t=!0;switch(this.get_$9iT()){case 1:n="NavigateToCalendarDay";break;case 4:n="NavigateToCalendarMonth";break;case 2:n="NavigateToCalendarWeek";break;case 3:n="NavigateToCalendarWorkWeek";break;case 5:n="NavigateToCalendarAgenda";t=!1;break}n&&this.set_$Hg(_d.$9B.$E(_a.$0.$1c,n,!0,t))},$7kY:function(n,t){return new _d.$Qz(n,null,null,t,this.$7V.$Cl)},$4QI:function(n,t){$3(this,"DisplayedDateString")},get_$5FF:function(){var n=this.$7V.$Cl.get_$I6();var t=n.get_$C();return!t||t===1&&n.get_$3o(0).get_$1Pq()},$3K7:function(n,t){switch(t.$2Z){case 0:$4pw(this,t.$2q);break;case 2:$6zb(this,t.$4b,t.$3B.length);break;default:throw Error.notImplemented();}},$6Ih:function(n,t){$3u(this,"CanShareCalendar","CanPrint");if(this.$7V.$Cw)for(var i,r=0,u=this.$mL.get_$C();r<u;r++){i=this.$mL.get_$3o(r);if(this.$7V.$Cw.$4i(i.$AQ)){this.set_$3Qd(i);return}}},$1Ti:function(n){this.set_$YK(n.$9k)}};_d.$PE=function(n,t,i){this.$$d_$9NA=Function.createDelegate(this,this.$9NA);this.$$d_$9Pj=Function.createDelegate(this,this.$9Pj);this.$$d_$9XX=Function.createDelegate(this,this.$9XX);this.$KU=new _y.$FO;_d.$PE.initializeBase(this);this.$SZ=n;this.$5F9=t;this.$J=i;this.$J.$Hd(_d.$WQ,this.$$d_$9XX);this.$J.$Hd(_d.$G7,this.$$d_$9Pj)};_d.$PE.prototype={$SZ:null,$5F9:null,$J:null,$aI:null,$41:function(){this.$KU.get_$8o().$1t();this.$KU.$BQ(this.$SZ)},get_$2Ks:function(){return this.$KU.get_$7T()},get_$2Zj:function(){return this.$KU.get_$8o()},get_$5Mw:function(){return this.$aI},set_$5Mw:function(n){if(this.$aI===n)return n;this.$aI=n;var t=ICalendarEventSearchViewModel.isInstanceOfType(this.get_$2Ks())?this.get_$2Ks():null;t&&t.set_$Ky(n);if(!n&&t){this.$KU.$BP();t.dispose();return n}n&&!t&&this.$5F9.$E(this.$$d_$9NA);return n},$49:function(){this.$J.$11q(_d.$WQ,this.$$d_$9XX);this.$J.$11q(_d.$G7,this.$$d_$9Pj);_js.$9.prototype.$49.call(this)},$9XX:function(n){this.set_$5Mw(n.$7k)},$9Pj:function(n){this.set_$5Mw(null)},$9NA:function(n){if(!this.$aI){_js.Trace.logInfo(_d.$PE.$1a,"Event Search factory was loaded but search context was not set.");return}var t=n.$E();t.set_$Ky(this.$aI);this.$KU.$BQ(t)}};_d.$Iu=function(n){this.$3zh=n};_d.$Iu.prototype={$3zh:0};_d.$oj=function(n,t,i){_d.$oj.initializeBase(this,[n]);this.$EX=t;this.$aQ=i};_d.$oj.prototype={$EX:null,$aQ:null};_d.$j9=function(){};_d.$WQ=function(n){_js.$3.$m(n,"searchContext");this.$7k=n};_d.$WQ.prototype={$7k:null};_d.$Iw=function(n,t,i,r){this.$$d_$9Zu=Function.createDelegate(this,this.$9Zu);this.$$d_$9WK=Function.createDelegate(this,this.$9WK);this.$$d_$9VJ=Function.createDelegate(this,this.$9VJ);this.$3Y8=new _js.$c;_d.$Iw.initializeBase(this);this.$SZ=n;this.$Po=t;this.$J=t.$J;this.$B=t.$B;this.$1RG=i;this.$pU=this.$SZ.get_$CD();this.$SZ.$Y("MainViewModel",this.$$d_$9VJ);this.$J.$Hd(_d.$j9,this.$$d_$9WK);this.$B.get_$L()!=="Mouse"&&this.$1RG.get_$2Zj().add_$1Y(this.$$d_$9Zu);if(r){var u=this;r.$E(function(n){u.set_$7Zp(n)})}};function $6zi(n){if(!_d.$3e.isInstanceOfType(n.get_$7p4())||!n.$Ar){_js.Trace.logInfo(_d.$Iw.$1a,"Module visibility changed but no action was taken. IsVisible: {0}",n.$Ar);return}n.$SZ.get_$Ed()&&n.$SZ.get_$Ed().$aD();n.$Ar&&!n.$B.get_$48K()&&n.$SZ.$3zR()}function $6zj(n){n.set_$6k(_y.$MY.isInstanceOfType(n.$1RG.get_$2Ks())?n.$1RG.get_$2Ks().get_$6k():null)}_d.$Iw.prototype={$SZ:null,$1RG:null,$Po:null,$J:null,$B:null,$pU:null,$2HJ:null,$Ar:!1,get_$7p4:function(){return this.$1RG.get_$2Ks()},get_$7Zp:function(){return this.$2HJ},set_$7Zp:function(n){if(this.$2HJ!==n){this.$2HJ=n;$3(this,"AllModernGroupsViewModel")}return n},get_$5qh:function(){return this.$1RG.get_$2Zj()},get_$2CK:function(){return this.$pU},set_$2CK:function(n){if(n!==this.$pU){this.$pU=n;$3(this,"SidePanelDisplayedDate")}return n},get_$1t1:function(){return this.$SZ.get_$Ed()},get_$Dl:function(){return this.$Ar},set_$Dl:function(n){if(this.$Ar!==n){this.$Ar=n;$6zi(this)}return n},$41:function(){this.$3Y8.$D(this.$SZ);this.$1RG.$41();this.$SZ.$2nz()},$7b0:function(n){switch(n.$a5){case 2:this.$SZ.$6fZ();break;case 1:this.$SZ.$4cX();break;case 0:this.$SZ.$2gF();break}this.$SZ.get_$Ed().set_$9I(n.$1Dw)},$9ju:function(n){_c.$F8.$9jt(n,this.$SZ)},$6O4:function(){this.$SZ.get_$Ed().$3os.$2T&&this.$SZ.get_$Ed().$3os.$s()},$49:function(){this.$J.$11q(_d.$j9,this.$$d_$9WK);this.$1RG.get_$2Zj().remove_$1Y(this.$$d_$9Zu);_a.$1.prototype.$49.call(this)},$9VJ:function(n,t){$3(this,"CalendarViewModel")},$9WK:function(n){this.set_$2CK(this.$SZ.get_$CD())},$9Zu:function(n,t){$6zj(this)}};_d.$M1=function(n,t,i,r,u,f,e){this.$$d_$6nn=Function.createDelegate(this,this.$6nn);_d.$M1.initializeBase(this,[n,t,i,r,f]);var o=_a.$6.acss(_a.$0.$1c,"CalendarWeekViewModel:Init");this.$bz=u;$4py(this);e&&e.add_$2Ij(this.$$d_$6nn);_a.$6.aces(o)};function $4py(n){n.$1CS?n.$1CS.$1t():n.$1CS=new _js.$c;for(var t,i,u=_a.$7.get_$2F(),r=0,f=n.$OS.get_$bu().length;r<f;r++){t=n.$OS.get_$bu()[r];i=new _d.$Wq(t,n.$bz);t.$9K(u)||i.set_$2L(!0);n.$1CS.$D(i)}}function $6zk(n){var u=_a.$7.get_$2F().$4D();if(n.$H9.length===n.$1CS.get_$C())for(var t=0,f=n.$H9.length;t<f;t++){var i=n.$H9[t];var r=n.$1CS.get_$3o(t);r.set_$5n(i);r.set_$2L(i.$4i(u))}else $4py(n)}_d.$M1.prototype={$bz:null,$1CS:null,$2Av:null,get_$1CU:function(){return 1},get_$1N:function(){return"CalendarWeekViewModel"},get_$1ZS:function(){return 2},get_$9t9:function(){return this.$2Av},set_$9t9:function(n){if(this.$2Av!==n){this.$2Av=n;this.$2Av&&this.set_$9I(this.$2Av.$7v)}return n},get_$4Ux:function(){return _a.$7.$2OZ(this.$EU.$2R,this.$EU.$3H.$2w(-1))},get_$2ni:function(){return String.format(_nbs.NonBootStrings.l_CalendarWeekView_AT_Region_Text,this.get_$4Ux())},$5af:function(){this.set_$Hg(_d.$9B.$E(_a.$0.$1c,"WeekView_GoPrev",!0,!0));this.set_$Ak(this.$EU.$2R.$2w(-7))},$5ae:function(){this.set_$Hg(_d.$9B.$E(_a.$0.$1c,"WeekView_GoNext",!0,!0));this.set_$Ak(this.$EU.$2R.$2w(7))},$IB:function(n){n.get_$Ao()?this.$Cr.$D(n):n.get_$y().$4D().$2U(n.get_$20().$4D())?this.$t.$6S($1q3(this,n,this.$H9)):this.$t.$D(n)},$3Iw:function(){_d.$1s.prototype.$3Iw.call(this);this.$6nn(this,_a.$7.get_$2F())},$6Iv:function(n,t){_d.$7o.prototype.$6Iv.call(this,n,t);$6zk(this)},$6nn:function(n,t){for(var r,i=0,u=this.$H9.length;i<u;i++){r=this.$H9[i];this.$1CS.get_$3o(i).set_$2L(!r.$9K(t))}}};_d.$149=function(n,t,i,r,u){_d.$149.initializeBase(this,[n,t,i,r,null,u,null])};_d.$149.prototype={get_$1CU:function(){return 5}};_d.$ov=function(n,t,i,r,u,f,e){_d.$ov.initializeBase(this,[n,t,i,r,u,f,e])};_d.$ov.prototype={get_$1CU:function(){return 2},get_$1N:function(){return"CalendarWorkWeekViewModel"},get_$1ZS:function(){return 3},get_$2ni:function(){return String.format(_nbs.NonBootStrings.l_CalendarWorkWeekView_AT_Region_Text,this.get_$4Ux())},get_$5Y4:function(){var n=_a.$2F.$NZ(this.get_$9I(),1,!1,this.$1g.$b.get_$13().get_$MF().get_$O9());return new _h.$4i(n[0],n[1])},$1n0:function(n){if(_d.$1s.prototype.$1n0.call(this,n))for(var t=0,r=this.$OS.get_$bu().length;t<r;t++){var i=this.$OS.get_$bu()[t];var u=new _h.$4i(i,i.$2w(1));if(u.$1QE(n))return!0}return!1},$3Iw:function(){_d.$M1.prototype.$3Iw.call(this);_a.$2F.$2Rc(this.$H9,this.get_$9I())||this.set_$9I(this.$H9[0])}};_d.$Wq=function(n,t){_d.$Wq.initializeBase(this,[_d.$Wq.$5VA(n),null,t,!0]);this.$7v=n};_d.$Wq.$5VA=function(n){return String.format("{0} {1}",n.$2b(19),_a.$7.$cu(n.get_$EA(),2))};_d.$Wq.prototype={$7v:null,get_$5n:function(){return this.$7v},set_$5n:function(n){if(n&&!_a.$7.$4N(this.$7v,n)){this.$7v=n;$N(this,"FormattedDate")}return n},get_$7zx:function(){return _d.$Wq.$5VA(this.$7v)}};_d.$zP=function(n,t,i,r,u,f,e){this.$$d_$9LN=Function.createDelegate(this,this.$9LN);_d.$zP.initializeBase(this,[t,i,r,u,f,e]);this.$qD=n};_d.$zP.prototype={$qD:null,get_$1N:function(){return"MonthAgendaViewModel"},get_$9I:function(){return _d.$1s.prototype.get_$9I.call(this)},set_$9I:function(n){_d.$1s.prototype.set_$9I.call(this,n);this.$qD.set_$9I(n);return n},get_$15O:function(){return _d.$1s.prototype.get_$15O.call(this)},set_$15O:function(n){_d.$1s.prototype.set_$15O.call(this,n);this.$qD.set_$15O(n);return n},$6Hy:function(n,t){_d.$1s.prototype.$6Hy.call(this,n,t);this.$qD.$6VJ()},$6Nx:function(n,t){_d.$1NQ.prototype.$6Nx.call(this,n,t);this.$1g.$aH&&this.$qD.$7h7()},$3Iw:function(){_d.$92.prototype.$3Iw.call(this);this.$qD.set_$Gg(!0);this.$qD.add_$83(this.$$d_$9LN)},$6Iw:function(){_d.$1s.prototype.$6Iw.call(this);this.$qD.set_$Gg(!1);this.$qD.remove_$83(this.$$d_$9LN)},$9LN:function(n,t){t==="VMSelectedDate"?this.set_$9I(this.$qD.get_$9I()):t==="SelectedAgendaItem"&&this.$qD.$1mL&&this.$aD()}};_d.$12W=function(n,t,i){_d.$12W.initializeBase(this,[n]);this.$1CT=t;this.$1J7=i};_d.$12W.prototype={$1CT:null,$1J7:null,$mR:null,add_$2rF:function(n){this.$2G("CalendarColorsChanged",n)},remove_$2rF:function(n){this.$2H("CalendarColorsChanged",n)},get_$Hg:function(){return this.$mR},set_$Hg:function(n){this.$mR=n;return n},get_$4NX:function(){return _d.$Jf.prototype.get_$4NX.call(this)},set_$4NX:function(n){_d.$Jf.prototype.set_$4NX.call(this,n);this.$mR&&(this.$mR.$5Su=n);return n},get_$8PW:function(){return this.$t.get_$C()},$7yF:function(n){$BF(this,"CalendarColorsChanged",this,n)},$aD:function(){}};_d.$iV=function(n,t,i,r,u,f,e,o,s){_d.$iV.initializeBase(this,[n,t,i]);this.$U1=s;this.$1BK=e;this.$PL=r;this.$27w=u;this.$qn=f;this.$4Lr=o};_d.$iV.prototype={$U1:0,$1BK:null,$4Lr:null,$PL:null,$27w:null,$qn:null,$12:null,$1EN:!1,$1Ps:!1,get_$45h:function(){return this.$1EN},set_$45h:function(n){if(n!==this.$1EN){this.$1EN=n;$3(this,"IsItemContextMenuShown")}return n},get_$1ZS:function(){return 4},get_$1p:function(){return this.$12},set_$1p:function(n){if(this.$12!==n){this.$12=n;$3(this,"SelectedItem")}return n},get_$15O:function(){return this.$1Ps},set_$15O:function(n){if(this.$1Ps!==n){this.$1Ps=n;$3u(this,"IsDraggingItem","ShouldPeekBeEnabled")}return n},get_$9yz:function(){return!this.$1Ps&&this.$4Lr.$B.get_$L()==="Mouse"},$aD:function(){this.set_$1p(null)}};_d.$1NQ=function(n,t,i,r,u,f){this.$$d_$6Nx=Function.createDelegate(this,this.$6Nx);_d.$1NQ.initializeBase(this,[n,t,i,r,f]);this.$bz=u;$4sE(this)};_d.$1NQ.prototype={$47L:!1,$bz:null,$7oj:function(n,t){var i=new _d.$iV(t,this.$bz,this.$3oK,this.$PL,this.$27w,this.$qn,this.$1BK,this.$1g,n);i.$Y("SelectedItem",this.$$d_$6Nx);return i},$6VK:function(){_d.$92.prototype.$6VK.call(this);var n=this.$1g.$aH;if(n&&!this.get_$15O()){var r=n.get_$y();var u=n.get_$20();var i=this.get_$9I().$4D();var f=i.$2w(1).$9v(-1);var e=new _h.$4i(r,u);if(!e.$2pp(i,f)){for(var t=0,o=this.$AN.length;t<o;t++)this.$AN[t].set_$1p(null);this.$1g.set_$x6(null)}}},$6I2:function(){for(var n=0,t=this.$AN.length;n<t;n++)this.$AN[n].set_$15O(this.get_$15O());_d.$1s.prototype.$6I2.call(this)},$6Nx:function(n,t){if(!this.$47L){this.$47L=!0;var i=n;var r;this.$1g.set_$x6(i.$12);for(var u=0,f=this.$AN.length;u<f;u++){r=this.$AN[u];r!==i&&r.set_$1p(i.$12)}this.$47L=!1}}};_d.$92=function(n,t,i,r,u){this.$$d_$9N5=Function.createDelegate(this,this.$9N5);_d.$92.initializeBase(this,[n,!0,i,t,r,u]);this.$AN=new Array(6);this.add_$2rF(this.$$d_$9N5)};_d.$92.$1xl=function(n){var t=_a.$2F.$NZ(n,3);var i=new _a.$7(n.get_$4S(),n.get_$3T(),1,t[0].get_$ED(),t[0].get_$Gp(),t[0].get_$Tm());t[1]=_a.$7.$Mb(i.$IC(1).$2w(-1)).$2w(7);return t};function $4sE(n){for(var r=_a.$2F.$NZ(n.get_$9I(),3)[0],i,t=0;t<6;++t){i=r.$2w(t*7);n.$AN[t]=n.$7oj(t,i)}}function $4sF(n){var t=_d.$92.$1xl(n.get_$Ak());var i=new _h.$4i(t[0],t[1]);return!i.$mb(n.get_$9I(),!0,!1)||!i.$4i(n.$EU)}function $4sG(n,t){n.set_$Ak(new _a.$7(n.get_$2jc().$6F.get_$4S(),n.get_$2jc().$6F.get_$3T(),1).$IC(t?1:-1))}function $4sH(n){for(var i=_a.$6.acss(_a.$0.$1c,"MonthVM:UpdateDisplayedDateInWeeks"),r=_a.$2F.$NZ(n.get_$Ak(),3)[0],t=0;t<6;++t)n.$AN[t].set_$y(r.$2w(t*7));_a.$6.aces(i)}_d.$92.prototype={$AN:null,$27P:null,$EF:!1,get_$1N:function(){return"MonthViewModel"},get_$Hg:function(){return _d.$1s.prototype.get_$Hg.call(this)},set_$Hg:function(n){_d.$1s.prototype.set_$Hg.call(this,n);for(var t=0,i=this.$AN.length;t<i;t++)this.$AN[t].$mR=n;return n},get_$dD:function(){return this.$EF},set_$dD:function(n){if(this.$EF!==n){this.$EF=n;$3(this,"IsTransitionedIn")}return n},get_$1CU:function(){return 3},get_$9P6:function(){return this.$27P},set_$9P6:function(n){if(n!==this.$27P){this.$27P=n;$3(this,"OnDateClickedCommand")}return n},get_$1ZS:function(){return 4},$3Iw:function(){var n=_d.$92.$1xl(this.get_$Ak());this.set_$3qn(new _h.$4i(n[0],n[1]));_d.$1s.prototype.$3Iw.call(this)},$4aM:function(n){_d.$1s.prototype.$4aM.call(this,n);$4sH(this);$3aW(this,!0)},get_$4jm:function(){return this.$AN[0]},get_$4jn:function(){return this.$AN[1]},get_$2jc:function(){return this.$AN[2]},get_$4jo:function(){return this.$AN[3]},get_$4jp:function(){return this.$AN[4]},get_$4jq:function(){return this.$AN[5]},get_$3zU:function(){return 12},get_$4Ux:function(){return this.get_$Ak().$2b(2)},get_$2ni:function(){return String.format(_nbs.NonBootStrings.l_CalendarMonthView_AT_Region_Text,this.get_$4Ux())},$5Y3:function(){for(var t=0,n=0,i=this.$AN.length;n<i;n++)t+=this.$AN[n].get_$8PW();return t},$84q:function(){for(var r=0,n,t,i=0,u=this.$AN.length;i<u;i++){n=this.$AN[i];t=n.$t;t&&n.$2Er.$mb(this.get_$9I(),!0,!0)&&(r+=$2kd(this,t))}return r},$5af:function(){this.set_$Hg(_d.$9B.$E(_a.$0.$1c,"MonthView_GoPrev",!0,!0));$4sG(this,!1)},$5ae:function(){this.set_$Hg(_d.$9B.$E(_a.$0.$1c,"MonthView_GoNext",!0,!0));$4sG(this,!0)},$aD:function(){_d.$1s.prototype.$aD.call(this);for(var n=0,t=this.$AN.length;n<t;n++)this.$AN[n].$aD()},$3xW:function(n){var t=_d.$92.$1xl(n);return new _h.$4i(t[0],t[1])},$3hD:function(n){for(var h=[],t,r,u,c=n.length,l=_a.$6.acss(_a.$0.$6y,"MonthVM:AddItems_"+c),f=0;f<6;++f)Array.add(h,this.$AN[f].$t.$6hu());for(var e=0;e<c;++e){t=n[e];if(this.$1n0(t)){r=!t.get_$Ao()&&t.get_$y().$4D().$2U(t.get_$20().$4D())?$1q3(this,t,this.$H9):[t];for(var i=0;i<6;++i)for(var o=0,a=r.length;o<a;++o){u=r[o];this.$AN[i].$2SG(u)&&h[i].$D(u)}}}for(var s=0;s<6;++s)this.$AN[s].$t.$5Rg();_a.$6.aces(l)},$IB:function(n){var r=_a.$6.acss(_a.$0.$6y,"MonthVM:AddItem");var t;if(this.$1n0(n))for(var i=0;i<6;++i){t=this.$AN[i];t.$2SG(n)&&t.$t.$D(n)}_a.$6.aces(r)},$D9:function(n){for(var t,i=0;i<6;++i){t=this.$AN[i];t.$2SG(n)&&_d.$1s.$4W1(n,t.$t)}},$2AB:function(){for(var n=0,t=this.$AN.length;n<t;++n)this.$AN[n].$t.$1t();_d.$1s.prototype.$2AB.call(this)},$49:function(){var n;this.remove_$2rF(this.$$d_$9N5);for(var t=0,i=this.$AN.length;t<i;t++){n=this.$AN[t];n&&n.$1R()}_d.$1s.prototype.$49.call(this)},$6jG:function(){$4sF(this)&&_d.$1s.prototype.$6jG.call(this)},$6VK:function(){$4sF(this)&&this.set_$3qn(this.$3xW(this.get_$Ak()))},$9um:function(n){n.set_$y(this.get_$9I().$4D());n.set_$20(n.get_$y().$2w(1).$9v(-1));n.set_$5V(this.$1g.$Cw);return n},$1k0:function(n,t){_d.$1s.prototype.$1k0.call(this,n,t);$4sH(this);$3aW(this,!1)},$9N5:function(n,t){for(var i=0,r=this.$AN.length;i<r;i++)this.$AN[i].$7yF(t)}};_d.$ZE=function(n){this.$AQ=n};_d.$ZE.prototype={$AQ:null};_d.$G4=function(n,t,i,r,u,f){this.$$d_$6Nz=Function.createDelegate(this,this.$6Nz);this.$$d_$9N4=Function.createDelegate(this,this.$9N4);_d.$G4.initializeBase(this,[n,t,r,u,f]);_a.$3.$K(i,"calendars");this.$4R0=i;this.$GW=i.$3g();this.$4R0.add_$1Y(this.$$d_$9N4);this.set_$rY($6yi(this));this.$2M.add_$3YV(this.$$d_$6Nz)};function $4pY(n,t){if(t.get_$99()!=="Free"){var i=n.$GW.$79(t.get_$5V());i>=0&&i<n.$W9.get_$C()&&n.$W9.get_$3o(i).set_$3hu($2kh(n,t.get_$5V()))}}function $6yi(n){for(var r=new _js.$c,t,u=n.$Em[0].$4D(),i=0,f=n.$GW.get_$C();i<f;i++){t=n.$GW.get_$3o(i);r.$D(new _d.$9f(n.$2M.$1d0(t),u,t,$2kh(n,t)))}return r}function $2kh(n,t){for(var i,r=null,u=0,f=n.$Cr.get_$C();u<f;u++){i=n.$Cr.get_$3o(u);if(i.get_$5V().$4i(t)&&i.get_$99()!=="Free"){r||(r=new(_0365f.$n.$$(_g.$K5)));r.$D(i)}}return r}_d.$G4.prototype={$GW:null,$4R0:null,$14a:function(n){return this.$GW.$79(n.get_$5V())},$2O6:function(n){return 1},$5aK:function(n){var t;var i,r;var u=this;var f=(r=this.$W9.$2il(function(t){return t.$AQ===n},i={val:t}),t=i.val,r);return t},$4QV:function(n,t){for(var i=0,u=this.$GW.get_$C();i<u;i++){var r=this.$GW.get_$3o(i);var f=this.$W9.get_$3o(i);f.$6n2(r,$2kh(this,r),this.$5aK(r).$vl)}_d.$1MU.prototype.$4QV.call(this,n,t)},$49:function(){this.$2M.remove_$3YV(this.$$d_$6Nz);this.$4R0.remove_$1Y(this.$$d_$9N4);_d.$1MU.prototype.$49.call(this)},$6nI:function(){for(var n=0,t=this.$GW.get_$C();n<t;n++)this.$W9.get_$3o(n).set_$5n(this.$Em[0].$4D())},$6HT:function(n,t){switch(t.$2Z){case 0:for(var i=0,u=t.$2q.length;i<u;i++)$4pY(this,t.$2q[i]);break;case 2:for(var r=0,f=t.$3B.length;r<f;r++)$4pY(this,t.$3B[r]);break}},$9N4:function(n,t){var i;var r=t.$4b;switch(t.$2Z){case 0:for(var f=t.$2q,u=r,o=r+f.length;u<o;u++){var s=u-r;i=f[s];this.$GW.$6r(u,i);this.$W9.$6r(u,new _d.$9f(this.$2M.$1d0(i),this.$Em[0].$4D(),i,$2kh(this,i)))}break;case 2:for(var e=0,h=t.$3B.length;e<h;e++){this.$GW.$6C(r);this.$W9.$6C(r)}break;default:break}$N(this,"ColumnCount")},$6Nz:function(n){for(var i,t=0,r=this.$GW.get_$C();t<r;t++)if(_g.$9I.isInstanceOfType(this.$GW.get_$3o(t))){i=this.$GW.get_$3o(t);i.get_$AX()===n&&this.$W9.get_$3o(t).set_$6q8(this.$2M.$1d0(i))}}};_d.$9f=function(n,t,i,r){this.$$d_$9Os=Function.createDelegate(this,this.$9Os);_d.$9f.initializeBase(this);_a.$3.$K(n,"workingHoursModel");_a.$3.$K(t,"date");this.$vl=n;this.$7v=t;this.set_$1c(i);this.$12H=[];this.set_$3hu(r);$2kk(this)};function $2kk(n){n.$2R1=$4pf(n,n.$vl.get_$vk(),0);n.$2R0=$4pf(n,n.$vl.get_$1pV(),1440)}function $4pg(n){n.set_$XW(n.$AQ?n.$AQ.$Jb:-1)}function $4pf(n,t,i){return n.$vl.$8PE(n.$7v.$Bp(1440-t).get_$EA())?(1440+t)%1440:i}function $4pe(n,t){Array.clear(n.$12H);if(t){$2kj(n,t,n.$12H,"OOF");$2kj(n,t,n.$12H,"Busy");$2kj(n,t,n.$12H,"Tentative");$2kj(n,t,n.$12H,"WorkingElsewhere")}}function $2kj(n,t,i,r){for(var u,e=i.length,f=0,o=t.get_$C();f<o;f++){u=t.get_$3o(f);u.get_$99()===r&&$6yp(n,i,e,u)}}function $6yp(n,t,i,r){for(var u,f=null,e=i;e<t.length;e++){u=t[e];if(r.get_$y().$2U(u.$8Q)<0&&r.get_$20().$2U(u.$74)>0)if(f){Array.addRange(f.$t,u.$t);Array.removeAt(t,e);e--}else{f=u;f.$D(r)}}if(!f){u=new _d.$vg;u.$D(r);Array.add(t,u)}}_d.$9f.prototype={$vl:null,$cR:0,$AQ:null,$2R1:0,$2R0:0,$7v:null,$Cr:null,$12H:null,$31W:!1,get_$1c:function(){return this.$AQ},set_$1c:function(n){if(this.$AQ!==n){this.$AQ&&this.$AQ.$q("AssignedCalendarColor",this.$$d_$9Os);n&&n.$Y("AssignedCalendarColor",this.$$d_$9Os);this.$AQ=n;$4pg(this)}return n},get_$5n:function(){return this.$7v},set_$5n:function(n){_a.$3.$K(n,"date");if(!_a.$7.$4N(this.$7v,n)){this.$7v=n;$2kk(this);$3(this,"Date")}return n},get_$6q8:function(){return this.$vl},set_$6q8:function(n){if(this.$vl!==n){this.$vl=n;$2kk(this);$3(this,"WorkingHoursModel")}return n},get_$8Cv:function(){return this.$31W},set_$8Cv:function(n){if(this.$31W!==n){this.$31W=n;$3(this,"ResponseMessage")}return n},get_$8PF:function(){return this.$2R1<=this.$2R0},get_$XW:function(){return this.$cR},set_$XW:function(n){if(this.$cR!==n){this.$cR=n;$3(this,"CalendarColor")}return n},get_$3hu:function(){return this.$Cr},set_$3hu:function(n){if(this.$Cr!==n){this.$Cr=n;$4pe(this,this.$Cr);$3(this,"AllDayItems")}return n},$6n2:function(n,t,i){_a.$3.$K(i,"workingHours");_a.$3.$K(n,"calendar");this.set_$1c(n);this.$vl=i;$4pe(this,t);$2kk(this);$3(this,"CalendarProperties")},$9Os:function(n,t){$4pg(this)}};_d.$WP=function(n,t){this.$Tj=n;this.$Jh=t};_d.$WP.prototype={$Tj:0,$Jh:0,$4i:function(n){if(n){var t=n;return this.$Tj===t.$Tj&&this.$Jh===t.$Jh}return!1}};_d.$oe=function(n,t){_a.$3.$K(n,"selectionStart");_a.$3.$K(t,"selectionEnd");this.$M5=new _d.$WP(Math.min(n.$Tj,t.$Tj),Math.min(n.$Jh,t.$Jh));this.$1mc=new _d.$WP(Math.max(n.$Tj,t.$Tj),Math.max(n.$Jh,t.$Jh))};_d.$oe.prototype={$M5:null,$1mc:null,$4i:function(n){if(n&&Object.getType(n).isInstanceOfType(this)){var t=n;return this.$M5.$4i(t.$M5)&&this.$1mc.$4i(t.$1mc)}return!1}};_d.$GD=function(n,t,i,r,u,f){this.$$d_$6Nz=Function.createDelegate(this,this.$6Nz);this.$$d_$6Ih=Function.createDelegate(this,this.$6Ih);_d.$GD.initializeBase(this,[n,t,r,u,f]);this.$1g=i;this.$1aq=$5(i.$Cw)?_cc.$1P.$3Ic:r.$1d0(i.$Cw);this.set_$rY($4qc(this));i.$Y("CurrentCalendarModel",this.$$d_$6Ih);this.$2M.add_$3YV(this.$$d_$6Nz)};function $4qc(n){for(var i=new _js.$c,t=0,r=n.$Em.length;t<r;t++)i.$D(new _d.$9f(n.$1aq,n.$Em[t].$4D(),n.$1g.$Cw,$3ar(n,n.$Em[t])));return i}function $3ar(n,t){if(!n.$1g.$Cw)return null;for(var i,r=null,u=0,f=n.$Cr.get_$C();u<f;u++){i=n.$Cr.get_$3o(u);if(i.get_$5V()&&i.get_$5V().$4i(n.$1g.$Cw)&&i.get_$99()!=="Free"&&i.get_$y().$9K(t)<=0&&i.get_$20().$9v(-1).$9K(t)>=0){r||(r=new(_0365f.$n.$$(_g.$K5)));r.$D(i)}}return r}function $3as(n){for(var t=0,i=n.$W9.get_$C();t<i;t++){var r=n.$W9.get_$3o(t);r.$6n2(n.$1g.$Cw,$3ar(n,n.$Em[t]),n.$1aq)}}_d.$GD.prototype={$1g:null,$1aq:null,$14a:function(n){for(var t=0,i=this.$Em.length;t<i;t++)if(n.get_$y().$2U(this.$Em[t].$2w(1))<0)return t;return-1},$2O6:function(n){for(var i=this.$14a(n),t=i+1;t<this.$Em.length&&n.get_$20().$9v(-1).$2U(this.$Em[t])>0;)t++;return t-i},$49:function(){this.$2M.remove_$3YV(this.$$d_$6Nz);this.$1g.$q("CurrentCalendarModel",this.$$d_$6Ih);_d.$1MU.prototype.$49.call(this)},$6nI:function(){if(this.$Em.length===this.$W9.get_$C())for(var n=0,t=this.$Em.length;n<t;n++)this.$W9.get_$3o(n).set_$5n(this.$Em[n].$4D());else this.set_$rY($4qc(this))},$6HT:function(n,t){for(var i=0,r=this.$Em.length;i<r;i++)this.$W9.get_$3o(i).set_$3hu($3ar(this,this.$Em[i]))},$4QV:function(n,t){$3as(this);_d.$1MU.prototype.$4QV.call(this,n,t)},$6Ih:function(n,t){if(this.$1g.$Cw){this.$1aq=this.$2M.$1d0(this.$1g.$Cw);$3as(this)}},$6Nz:function(n){if(_g.$9I.isInstanceOfType(this.$1g.$Cw)){var t=this.$1g.$Cw;if(t.get_$AX()===n){this.$1aq=this.$2M.$1d0(t);for(var r,i=0,u=this.$W9.get_$C();i<u;i++){r=this.$W9.get_$3o(i);r.set_$6q8(this.$1aq)}t.get_$AX()===this.$b.get_$2z().get_$AM()&&$3as(this)}}}};_d.$1MU=function(n,t,i,r,u){this.$$d_$4QV=Function.createDelegate(this,this.$4QV);this.$$d_$1Ti=Function.createDelegate(this,this.$1Ti);this.$$d_$6HT=Function.createDelegate(this,this.$6HT);_d.$1MU.resolveInheritance();this.apcl=this.$Y;this.rpcl=this.$q;this.dispose=this.$1R;_d.$1MU.initializeBase(this);_a.$3.$K(n,"dateRange");this.$Em=n;this.$2M=i;this.$Cr=t;this.$Cr.add_$1Y(this.$$d_$6HT);this.$b=r;this.$J=u;this.$J.$Hd(_a.$D5,this.$$d_$1Ti)};_d.$1MU.prototype={$Cr:null,$2M:null,$J:null,$W9:null,$iU:0,$Em:null,$b:null,$Oo:!1,get_$bu:function(){return this.$Em},set_$bu:function(n){if(this.$Em!==n){this.$Em=n;this.$6nI();$N(this,"SelectedDateRange")}return n},get_$IG:function(){return this.$iU},set_$IG:function(n){if(this.$iU!==n){this.$iU=n;$N(this,"ColumnWidth")}return n},get_$qf:function(){return this.$W9.get_$C()},get_$rY:function(){return this.$W9},set_$rY:function(n){if(this.$W9!==n){this.$W9=n;$N(this,"GridColumnViewModelCollection")}return n},get_$YK:function(){return this.$Oo},set_$YK:function(n){if(n===this.$Oo)return n;this.$Oo=n;var t=this.$b.get_$13().get_$MF();if(n){t.$Y("WorkDays",this.$$d_$4QV);t.$Y("WorkHoursStartTimeInMinutes",this.$$d_$4QV);t.$Y("WorkHoursEndTimeInMinutes",this.$$d_$4QV)}else{t.$q("WorkDays",this.$$d_$4QV);t.$q("WorkHoursStartTimeInMinutes",this.$$d_$4QV);t.$q("WorkHoursEndTimeInMinutes",this.$$d_$4QV)}return n},$4QV:function(n,t){this.$6nI()},$49:function(){this.$J.$11q(_a.$D5,this.$$d_$1Ti);this.set_$YK(!1);_js.$9.prototype.$49.call(this)},$1Ti:function(n){this.set_$YK(n.$9k)}};_d.$Cm=function(){_d.$Cm.initializeBase(this)};_d.$Cm.prototype={get_$1BA:function(){return this.$W(_d.$Cm.$3jK)},set_$1BA:function(n){this.$M(_d.$Cm.$3jK,n);return n},get_$1l:function(){return this.$W(_d.$Cm.$1O6)},set_$1l:function(n){this.$M(_d.$Cm.$1O6,n);return n},get_$C0:function(){return this.$W(_d.$Cm.$21e)},set_$C0:function(n){this.$M(_d.$Cm.$21e,n);return n},get_$26V:function(){return null},get_$4Td:function(){return null}};_d.$51=function(n,t,i,r,u,f,e){this.$$d_$6He=Function.createDelegate(this,this.$6He);this.$$d_$6MU=Function.createDelegate(this,this.$6MU);this.$$d_$4O8=Function.createDelegate(this,this.$4O8);_d.$51.initializeBase(this,[f,n,t,i,r,u,e])};_d.$51.$1aV=function(n,t,i){var r=new _d.$Cm;r.set_$1l(n);r.set_$1BA(t);r.set_$C0(i);return r};function $6y9(n,t){var i=new _js.$c;var r=this;n.$1U.$Bd(function(n){var r=n.$5B;t===r.$a1&&i.$D(n)});return i}function $3aR(n,t){$4pF(n,!1);if(t){n.$2g.get_$7G().$1t();n.$2g.get_$8D().$1t();n.$2g.get_$9F().$1t();$4pE(n,t)}else{$3aQ(n,n.$2g.get_$7G(),0);$3aQ(n,n.$2g.get_$8D(),1);$3aQ(n,n.$2g.get_$9F(),2)}}function $4pF(n,t){t||n.$1U.remove_$1Y(n.$$d_$6MU);n.$1U.$1t();t||n.$1U.add_$1Y(n.$$d_$6MU)}function $3aQ(n,t,i){for(var r=0;r<t.get_$C();r++){var u=_d.$51.$1aV(t.get_$3o(r).get_$6u(),i,!0);$3aP(n,u,!1)}}function $4pE(n,t){for(var i=0;i<t.get_$C();i++)$3aP(n,t.get_$3o(i),!0)}function $3aP(n,t,i){i||n.$1U.remove_$1Y(n.$$d_$6MU);if(t.get_$C0()){var r=n.$5q.$ib(_pc.$l.$Dh(t.get_$1l()),n.$1Ui,!0,n.$29Z);r.set_$1BA(t.get_$1BA());r.$Y("AttendeeType",n.$$d_$6He);n.$1LW(r)}else n.$2Gt(_pc.$l.$Dh(t.get_$1l()));i||n.$1U.add_$1Y(n.$$d_$6MU)}function $4pI(n,t){switch(t){case 0:return n.$2g.get_$7G().get_$AIt();case 1:return n.$2g.get_$8D().get_$AIt();case 2:return n.$2g.get_$9F().get_$AIt();default:throw Error.argumentOutOfRange("Unknown AttendeeTypeType: "+_d.$oH.toString(t));}}function $6yA(n,t){switch(t){case 0:return 1;case 1:return 0;default:throw Error.invalidOperation("Operation supported only for Required and Optional Attendees");}}function $4pJ(n,t){var i=$4pI(n,t.get_$1BA());var r=t.get_$1l();var u=this;i.$Dn(function(n){if(_g.$2R.$4i(r,n.get_$6u())){i.$34(n);return!0}return!1})}function $4pD(n,t){var i=$4pI(n,t.get_$1BA());i.$D(_g.$3i.$xh(t.get_$1l()))}function $6yB(n,t){switch(t.$2Z){case 0:var i=this;Array.forEach(t.$2q,function(t){t.$5B.$Y("AttendeeType",n.$$d_$6He);var i=t.$5B;var r=_d.$51.$1aV(i.$ab(),i.$a1,t.$Ne);$4pD(n,r)});break;case 2:var r=this;Array.forEach(t.$3B,function(t){var i=t.$5B;i.$q("AttendeeType",n.$$d_$6He);var r=t.$5B.$ab();var u=_d.$51.$1aV(r,i.$a1,t.$Ne);$4pJ(n,u)});break;case 3:case 4:throw Error.invalidOperation("People Picker only supports adding and removing attendees from the underlying recipient well.");}}function $4pH(n,t){var i=new _js.$c;var r=this;t.$Bd(function(t){i.$D($4pG(n,t))});return i}function $4pG(n,t){var i=t.$5B;var r=_d.$51.$5Nv;_d.$Lj.isInstanceOfType(i)&&(r=i.$a1);return _d.$51.$1aV(i.$ab(),r,t.$Ne)}_d.$51.prototype={$2g:null,get_$4SP:function(){return $6y9(this,0)},set_$4SP:function(n){var t=$4pH(this,n);if(this.$4b6!=="TouchNarrow"){var i=this;this.$1U.$Bd(function(n){var r=$4pG(i,n);r.get_$1BA()&&t.$D(r)});$4pF(this,!0)}$4pE(this,t);return n},get_$5FI:function(){return this.$2g},set_$5FI:function(n){if(this.$2g){this.$2g.$q("RequiredAttendees",this.$$d_$4O8);this.$2g.$q("OptionalAttendees",this.$$d_$4O8);this.$2g.$q("Resources",this.$$d_$4O8)}this.$2g=n;if(this.$2g){this.$2g.$Y("RequiredAttendees",this.$$d_$4O8);this.$2g.$Y("OptionalAttendees",this.$$d_$4O8);this.$2g.$Y("Resources",this.$$d_$4O8)}return n},$41:function(n,t){this.set_$5FI(n);this.$1U.add_$1Y(this.$$d_$6MU);$3aR(this,t)},$81m:function(){this.$1DF();return $4pH(this,this.$1U)},$7Yp:function(n){if(n){var t=_d.$51.$1aV(n,2,!0);$3aP(this,t,!1)}},$9o1:function(n){if(n){var i=this;var t=this.$1U.$Dn(function(t){return _g.$2R.$4i(n,t.$5B.$ab())});t<this.$1U.get_$C()&&this.$3Od(this.$1U.get_$3o(t).$5B)}},$7h6:function(n){n?n===1?this.$2g.get_$8D().$1t():n===2&&this.$2g.get_$9F().$1t():this.$2g.get_$7G().$1t();$3aR(this)},$49:function(){this.set_$5FI(null);this.$1U.remove_$1Y(this.$$d_$6MU);_rw.$36.prototype.$49.call(this)},$4O8:function(n,t){$3aR(this)},$6MU:function(n,t){$6yB(this,t)},$6He:function(n,t){var r=!0;var i=n;var u=$6yA(this,i.$a1);var f=_d.$51.$1aV(i.$ab(),u,r);$4pJ(this,f);var e=_d.$51.$1aV(i.$ab(),i.$a1,r);$4pD(this,e)}};_d.$oG=function(n,t,i,r){this.$B=t;this.$10y=n;this.$7XO=i;this.$2py=r};_d.$oG.prototype={$B:null,$7XO:null,$10y:null,$2py:null,$E:function(){return new _d.$51(7,_y.$17.$XR,null,!0,this.$10y,this.$B.get_$L(),this.$2py)}};_d.$DL=function(n,t,i,r,u){this.$$d_$9q0=Function.createDelegate(this,this.$9q0);this.$$d_$6Xc=Function.createDelegate(this,this.$6Xc);this.$$d_$7pS=Function.createDelegate(this,this.$7pS);_d.$DL.initializeBase(this,[t,i,r,u]);this.$2g=n;this.$MN=this.$AH.get_$BT();this.$3hR="AddRoom_ComposeForm"};function $4q2(n){var t=new _h.$4i(n.$2g.get_$y(),n.$2g.get_$20());n.$OL.set_$MO(n.$2g.get_$y());n.$OL.set_$5s7(n.$2g.get_$y().$4D());n.$AH.set_$bu(t)}function $3ag(n){var t=n.$2g.get_$9F();$4p7(n);t&&t.get_$C()>0?n.$AH.set_$BT(t.get_$3o(0).get_$6u()):n.$AH.set_$BT(null);$4p6(n);n.$MN=n.$AH.get_$BT();$3aN(n)}function $3ae(n){n.set_$5Mu(n.$2g.get_$9F())}function $3af(n){n.set_$5Mu(null)}_d.$DL.prototype={$2g:null,$MN:null,$1ao:null,add_$9Zz:function(n){this.$2G("OnRoomSelectionChanged",n)},remove_$9Zz:function(n){this.$2H("OnRoomSelectionChanged",n)},$5m:function(){if(!this.$vx){_d.$Ek.prototype.$5m.call(this);$3ag(this);$4q2(this)}},$6VP:function(){_d.$Ek.prototype.$6VP.call(this);this.$2g.$Y("Start",this.$$d_$7pS);this.$2g.$Y("End",this.$$d_$7pS);this.$2g.$Y("Resources",this.$$d_$6Xc);$3ae(this)},$4ho:function(){$3af(this);this.$2g.$q("Start",this.$$d_$7pS);this.$2g.$q("End",this.$$d_$7pS);this.$2g.$q("Resources",this.$$d_$6Xc);_d.$Ek.prototype.$4ho.call(this)},get_$5Mu:function(){return this.$1ao},set_$5Mu:function(n){if(this.$1ao!==n){this.$1ao&&this.$1ao.remove_$1Y(this.$$d_$9q0);this.$1ao=n;this.$1ao&&this.$1ao.add_$1Y(this.$$d_$9q0)}return n},$7pS:function(n,t){$4q2(this)},$6an:function(n,t){_d.$Ek.prototype.$6an.call(this,n,t);var i=this.$MN;this.$MN=this.$AH.get_$BT();$3af(this);i&&this.$2g.get_$9F().get_$C()>0&&this.$2g.get_$9F().get_$3o(0).get_$6u().EmailAddress===i.EmailAddress&&this.$2g.get_$9F().$6C(0);this.$MN&&this.$2g.get_$9F().$6r(0,_g.$3i.$xh(this.$MN));$3ae(this);var r=this.$jB("OnRoomSelectionChanged");r&&r(i,this.$MN)},$6Xc:function(n,t){$3af(this);$3ae(this);$3ag(this)},$9q0:function(n,t){$3ag(this);t.$2Z===2&&t.$3B.length===1&&t.$3B[0].get_$6u().Name===this.$2g.get_$4g().get_$1o()&&this.$2g.set_$4g(_g.$3V.$qp())}};_d.$p5=function(n,t,i,r){this.$2NK=n;this.$3Xc=t;this.$2AL=i;this.$B=r};_d.$p5.prototype={$3Xc:null,$2AL:null,$2NK:null,$B:null,$E:function(n){var u=_cc.$1P.$5Kx(!0);var t=this.$3Xc.$E(n,u);var r=this.$2AL.$5Ks(n,t);var i=this.$2AL.$E(n,t,r);t.set_$6ZU(i);var f=this.$2NK.$7lq(i,r);return new _d.$DL(n.$v,t,i,f,this.$B)}};_d.$Js=function(n,t,i,r,u,f){this.$$d_$4Pt=Function.createDelegate(this,this.$4Pt);this.$$d_$6MU=Function.createDelegate(this,this.$6MU);this.$$d_$9M9=Function.createDelegate(this,this.$9M9);this.$$d_$3ve=Function.createDelegate(this,this.$3ve);this.$$d_$4P2=Function.createDelegate(this,this.$4P2);this.$$d_$3PB=Function.createDelegate(this,this.$3PB);this.$$d_$5oS=Function.createDelegate(this,this.$5oS);_d.$Js.initializeBase(this);this.$B=r;this.$k=u;this.$2g=n;this.$7F=i;this.$1V3=t;this.$49U=new _C(this.$$d_$5oS,_a.$0.$dz);this.$1H=f;var e=this;this.$2dq=new _C(this.$$d_$3PB,_a.$0.$1c,this,"IsRecipientWellPopulated",function(){return e.get_$5l5()})};function $4q3(n){if(n.$2QW){n.$LT=new _d.$14R(n.$CC,n.$2QW,n.$k,n.$1H);$2km(n)}}function $2km(n,t){n.$LT&&n.$LT.$19y(t)}_d.$Js.prototype={$2g:null,$B:null,$7F:null,$1V3:null,$49U:null,$k:null,$2dq:null,$1H:null,$CC:null,$2QW:null,$LT:null,$2os:null,$3Wu:null,$Qm:null,$4jd:!1,get_$4VJ:function(){return this.$CC},set_$4VJ:function(n){if(this.$CC===n)return n;if(this.$CC){if(this.$CC.get_$6A()){if(this.$4jd){this.$CC.$q("FindRecipientViewModel",this.$$d_$4P2);this.$4jd=!1}this.$CC.get_$6A().rpcl("QueryString",this.$$d_$3ve);this.$CC.get_$6A().set_$2KQ(null)}this.$CC.remove_$ki(this.$$d_$9M9);this.$CC.$1U.remove_$1Y(this.$$d_$6MU);this.$CC.$1R()}this.$CC=n;if(this.$CC){var t=this.$CC.get_$6A();if(t){t.apcl("QueryString",this.$$d_$3ve);t.set_$2KQ(this.$2dq)}else{this.$4jd=!0;this.$CC.$Y("FindRecipientViewModel",this.$$d_$4P2)}this.$CC.add_$ki(this.$$d_$9M9);this.$CC.$1U.add_$1Y(this.$$d_$6MU);$4q3(this);this.$3ve()}$3(this,"RecipientWellViewModel");return n},$41:function(n){this.set_$4VJ(this.$7F.$E());this.$CC.$41(this.$2g,n)},get_$8Fo:function(){return this.$2QW},set_$8Fo:function(n){if(this.$2QW!==n){this.$2QW=n;$4q3(this)}return n},get_$nI:function(){return this.$CC.$1Ph||!!this.$CC.get_$6A()&&!_js.$8.$a(this.$CC.get_$6A().get_$7D())},get_$5l5:function(){return!!this.$CC&&(this.$CC.$1U.get_$C()>0||!!this.$CC.get_$6A()&&!_js.$8.$a(this.$CC.get_$6A().get_$7D()))},$3PB:function(n,t){$2km(this);this.$2os=n;this.$3Wu=t;this.$CC.$1wt()},$49:function(){this.set_$4VJ(null);if(this.$Qm){this.$Qm.remove_$1m4(this.$$d_$4Pt);this.$Qm.$1R();this.$Qm=null}_a.$1.prototype.$49.call(this)},$9M9:function(n){$2km(this,!0);if(n){if(this.$2os){this.$2os();this.$2os=null}}else if(this.$3Wu){this.$3Wu();this.$3Wu=null}},$5oS:function(){this.$CC.$1DF();_a.$g.$8n.$D("VM.PeoplePicker.Launched",_a.$7.get_$2F());if(this.$Qm)this.$Qm.$6ni(this.$CC.get_$4SP());else{this.$Qm=this.$1V3.$5M1(this.$CC.get_$4SP(),_nbs.NonBootStrings.l_RichPeoplePickerRequired_Text);this.$Qm.add_$1m4(this.$$d_$4Pt)}this.$B.$7C(this.$Qm)},$4Pt:function(n){this.$CC.set_$4SP(n)},$3ve:function(n,t){$3(this,"IsRecipientWellPopulated")},$4P2:function(n,t){var r=n;var i=r.get_$6A();i.apcl("QueryString",this.$$d_$3ve);i.set_$2KQ(this.$2dq)},$6MU:function(n,t){$2km(this);this.$3ve()}};_d.$vJ=function(n){this.$1IS=new(_0365f.$n.$$(_y.$2W));this.$1IS.$D(n)};_d.$vJ.prototype={$1IS:null,get_$ZI:function(){return this.$1IS}};_d.$14R=function(n,t,i,r){_d.$14R.initializeBase(this,[t]);this.$CC=n;this.$4B0=new _d.$46(i,new _d.$vJ(n),t,r);this.$4B0.$41()};_d.$14R.prototype={$CC:null,$4B0:null,$43r:!1,$19y:function(n){this.$43r=n;_cc.$8v.prototype.$19y.call(this);this.$43r=!1},$8Rn:function(){this.$TX=[67]},$80c:function(){this.$43r&&this.$CC.$1Ph&&this.$x.$2j(67);this.$4B0.$2hZ()}};_d.$p6=function(n,t,i,r,u){this.$7F=n;this.$1V3=t;this.$B=i;this.$k=r;this.$1H=u};_d.$p6.prototype={$1H:null,$B:null,$k:null,$7F:null,$1V3:null,$E:function(n){return new _d.$Js(n,this.$1V3.get_$1n(),this.$7F,this.$B,this.$k,this.$1H)}};_d.$M3=function(n){this.$NN=n};_d.$M3.$4VF=function(n){switch(n){case 0:return 0;case 1:return 1;default:throw Error.invalidOperation("Attendee type not supported");}};function $4q4(n,t,i){var u=n.$NN.$XO.$CC;if(u.$1U.get_$C()+i.get_$C()>100)return!1;for(var r=0;r<i.get_$C();r++){var f=i.get_$3o(r);var e=u.$3hO(f);e.set_$1BA(t)}return!0}_d.$M3.prototype={$NN:null,$2OX:function(){return this.$NN.$p.$v.get_$4g().get_$1o()},$9wX:function(n){this.$NN.$p.$v.set_$4g(_g.$3V.$139(n))},$5A3:function(n,t){t.val=0;var r=_y.$AT.$3oj(n);if(this.$NN.$5f){var i=new(_0365f.$n.$$(_y.$du));this.$NN.$5f.$1rO(r,i);if(!i.get_$C()){_js.Trace.logInfo(_a.$0.$5l,"Attachment not added - max number exceeded.");t.val=9001;return null}return i.get_$3o(0)}else{_js.Trace.logInfo(_a.$0.$5l,"Attachment not added - max number exceeded.");t.val=9001;return null}},$59u:function(n,t,i){i.val=0;var r=this.$NN.$5f;if(r){var u=new _d.$12O(n,t);return r.$59v(u)}_js.Trace.logError(_a.$0.$5l,"ComposeFormNotReadyForAttachments in calendar module");i.val=9015;return null},$86v:function(n){for(var r=new _js.$c,i=this.$NN.$XO.$CC.$1U,u=_d.$M3.$4VF(n),t=0;t<i.get_$C();t++)u===i.get_$3o(t).$5B.$a1&&r.$D(i.get_$3o(t));return r},$9xA:function(n,t){var i=_d.$M3.$4VF(n);this.$NN.$XO.$CC.$7h6(i);$4q4(this,i,t)},$A9h:function(n,t){return $4q4(this,_d.$M3.$4VF(n),t)},$9xX:function(n){this.$NN.$p.$v.set_$2i(n)},$14l:function(){return this.$NN.$p.get_$2i()},$30n:function(){return this.$NN.$LN.$qo.$2R},$2zu:function(){return this.$NN.$LN.$qo.$3H},$9xV:function(n){var t=this.$NN.$LN;var i=t.$xN===-1;t.set_$rD(-2);t.set_$y(n);if(i){var r=n.$2Gs(24);t.set_$20(r)}},$AAC:function(n){var t=this.$NN.$LN;if(t.$xN===-1){var i=t.get_$y();var u=new _a.$7(i.get_$4S(),i.get_$3T(),i.get_$5n(),0,0,0,0,i.$NI);t.set_$rD(-2);t.set_$y(u)}var r=n.$5u(t.get_$y());if(r<0)return!1;if(r>72e5||r%18e5){t.set_$rD(-2);t.set_$20(n)}else t.set_$rD(r);return!0},$8HK:function(n){var t=new _d.$r6(n,!0);this.$NN.set_$Jn(t)},$9ig:function(n){var t=new _d.$sw(n);this.$NN.set_$Jn(t)},$2zf:function(){return this.$NN.$21D?"HTML":"Text"},$2OW:function(){var n=this.$NN.$p.$v.get_$i();return n?n.Id:null},$3xd:function(){this.$NN.$p.$v.get_$HD()||this.$NN.$p.$v.set_$HD(new(_a.$1r.$$(_g.$L7,_g.$Cv)));return this.$NN.$p.$v.get_$HD().get_$AIt()},$8TX:function(){this.$NN.$5rE()},$A4a:function(){var n=new _y.$b6(null);this.$NN.set_$Jn(n)},$7gB:function(n){var t=new _y.$b6(n);this.$NN.set_$Jn(t)}};_d.$84=function(n){_d.$84.initializeBase(this);if(!$5(n)){$5(n.$v.$IO)||n.$v.$IO.$s();this.set_$5Q(n.$v.$3g());this.set_$1Tl(n.$6c.$3g())}};_d.$84.$$cctor=function(){_d.$84.$2qL.set_$HL(new _a.$EP(_d.$Cm))};_d.$84.prototype={get_$5Q:function(){return this.$W(_d.$84.$1sw)},set_$5Q:function(n){this.$M(_d.$84.$1sw,n);return n},get_$1Tl:function(){return this.$W(_d.$84.$4Qz)},set_$1Tl:function(n){this.$M(_d.$84.$4Qz,n);return n},get_$2qK:function(){return this.$W(_d.$84.$2qL)},set_$2qK:function(n){this.$M(_d.$84.$2qL,n);return n},get_$DI:function(){return this.$W(_d.$84.$1zu)},set_$DI:function(n){this.$M(_d.$84.$1zu,n);return n},get_$2Nj:function(){return this.$W(_d.$84.$3wO)},set_$2Nj:function(n){this.$M(_d.$84.$3wO,n);return n},get_$26V:function(){return!$5(this.get_$1Tl())&&!$5(this.get_$1Tl().get_$i())?[this.get_$1Tl()]:null},get_$4Td:function(){return null}};_d.$p7=function(n,t,i,r,u,f){_d.$p7.initializeBase(this,[u]);this.$2g=n;this.$20d=t;this.$2MY=i;this.$6OJ=r;this.$1l8=f};function $6zn(n){if(!n.$20d)if(n.$2g.get_$JF())n.$x.$2j(4800);else if(n.$2g.get_$Gj()&&n.$2MY.$2T){var t=n.$2MY.get_$MT();n.$x.$ID(4700,null,_nbs.NonBootStrings.l_EditSeries_Text,t)}}_d.$p7.prototype={$2g:null,$20d:!1,$2MY:null,$6OJ:null,$1l8:null,$8Rn:function(){this.$TX=[6200,4600,975,4800,4700,6701,6702]},$80c:function(){this.$2g.get_$JC()&&this.$2g.get_$1c()&&!this.$2g.get_$5Si()&&this.$x.$2j(975);$3a5(this,this.$2g,!0);$6zn(this);$3a6(this,this.$1l8,this.$6OJ.get_$MT(),_nbs.NonBootStrings.l_ViewSchedulingAssistantAction_Text)}};_d.$Wc=function(n){this.$3E=n||{}};_d.$Wc.prototype={$3E:null,get_$2i:function(){return this.$3E.Subject},set_$2i:function(n){this.$3E.Subject=n;return n},get_$4g:function(){return this.$3E.Location},set_$4g:function(n){this.$3E.Location=n;return n},get_$3M:function(){return this.$3E.Body},set_$3M:function(n){this.$3E.Body=n;return n},get_$y:function(){return this.$3E.Start},set_$y:function(n){this.$3E.Start=n;return n},get_$2Nj:function(){return this.$3E.ForceDirty?Boolean.parse(this.$3E.ForceDirty):!1},set_$2Nj:function(n){this.$3E.ForceDirty=n.toString();return n},get_$DE:function(){var n=this.$3E.Duration;return String.isInstanceOfType(n)?Number.parseInvariant(n):n},set_$DE:function(n){this.$3E.Duration=n;return n},get_$1ML:function(){if($5(this.$3E.CalendarId))return null;return new _g.$3R(this.$3E.CalendarId)},set_$1ML:function(n){$5(n)?delete this.$3E.CalendarId:this.$3E.CalendarId=n.Id;return n},get_$7G:function(){return this.$3E.RequiredAttendees},set_$7G:function(n){this.$3E.RequiredAttendees=n;return n},get_$8D:function(){return this.$3E.OptionalAttendees},set_$8D:function(n){this.$3E.OptionalAttendees=n;return n},get_$3SR:function(){var n="Busy";if($5(this.$3E.ShowAs))return n;try{n=this.$3E.ShowAs}catch(t){}return n},set_$3SR:function(n){this.$3E.ShowAs=n;return n},get_$PU:function(){return this.$3E.ReminderIsSet?Boolean.parse(this.$3E.ReminderIsSet):!0},set_$PU:function(n){this.$3E.ReminderIsSet=n.toString();return n},get_$5R:function(){return $5(this.$3E.IsAllDayEvent)?!1:Boolean.parse(this.$3E.IsAllDayEvent)},set_$5R:function(n){this.$3E.IsAllDayEvent=n.toString();return n},$7gQ:function(n){return n in this.$3E}};_d.$z=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g){this.$$d_$9Zw=Function.createDelegate(this,this.$9Zw);this.$$d_$5Cw=Function.createDelegate(this,this.$5Cw);this.$$d_$3iw=Function.createDelegate(this,this.$3iw);this.$$d_$5fb=Function.createDelegate(this,this.$5fb);this.$$d_$12A=Function.createDelegate(this,this.$12A);this.$$d_$3Iv=Function.createDelegate(this,this.$3Iv);this.$$d_$9hm=Function.createDelegate(this,this.$9hm);this.$$d_$9aK=Function.createDelegate(this,this.$9aK);this.$$d_$9Zq=Function.createDelegate(this,this.$9Zq);this.$$d_$9Zr=Function.createDelegate(this,this.$9Zr);this.$$d_$4O=Function.createDelegate(this,this.$4O);this.$$d_$9Tj=Function.createDelegate(this,this.$9Tj);this.$$d_$ADL=Function.createDelegate(this,this.$ADL);this.$$d_$3Jw=Function.createDelegate(this,this.$3Jw);this.$$d_$6Xc=Function.createDelegate(this,this.$6Xc);this.$$d_$7eL=Function.createDelegate(this,this.$7eL);this.$$d_$8KM=Function.createDelegate(this,this.$8KM);this.$$d_$9Mp=Function.createDelegate(this,this.$9Mp);this.$$d_$2t9=Function.createDelegate(this,this.$2t9);this.$$d_$6XL=Function.createDelegate(this,this.$6XL);this.$$d_$6HX=Function.createDelegate(this,this.$6HX);this.$$d_$6HZ=Function.createDelegate(this,this.$6HZ);this.$$d_$4Oy=Function.createDelegate(this,this.$4Oy);this.$$d_$9TY=Function.createDelegate(this,this.$9TY);this.$$d_$ACd=Function.createDelegate(this,this.$ACd);this.$$d_$9hg=Function.createDelegate(this,this.$9hg);this.$$d_$5CG=Function.createDelegate(this,this.$5CG);this.$$d_$9LK=Function.createDelegate(this,this.$9LK);this.$$d_$5g4=Function.createDelegate(this,this.$5g4);this.$$d_$5Pp=Function.createDelegate(this,this.$5Pp);this.$$d_$ABS=Function.createDelegate(this,this.$ABS);this.$$d_$9ZF=Function.createDelegate(this,this.$9ZF);this.$$d_$6MV=Function.createDelegate(this,this.$6MV);this.$$d_$9Q6=Function.createDelegate(this,this.$9Q6);this.$$d_$3JA=Function.createDelegate(this,this.$3JA);this.$$d_$7nB=Function.createDelegate(this,this.$7nB);this.$$d_$4Oa=Function.createDelegate(this,this.$4Oa);this.$$d_$7c4=Function.createDelegate(this,this.$7c4);this.$$d_$bq=Function.createDelegate(this,this.$bq);this.$$d_$tx=Function.createDelegate(this,this.$tx);this.$$d_$7lM=Function.createDelegate(this,this.$7lM);this.$$d_$9lL=Function.createDelegate(this,this.$9lL);this.$$d_$9f9=Function.createDelegate(this,this.$9f9);this.$$d_$9f8=Function.createDelegate(this,this.$9f8);this.$$d_$AEp=Function.createDelegate(this,this.$AEp);this.$$d_$AEq=Function.createDelegate(this,this.$AEq);this.$$d_$8FJ=Function.createDelegate(this,this.$8FJ);this.$$d_$8FL=Function.createDelegate(this,this.$8FL);this.$$d_$8FI=Function.createDelegate(this,this.$8FI);this.$$d_$3mm=Function.createDelegate(this,this.$3mm);this.$$d_$iq=Function.createDelegate(this,this.$iq);this.$$d_$9Ii=Function.createDelegate(this,this.$9Ii);this.$$d_$9gc=Function.createDelegate(this,this.$9gc);this.$$d_$28e=Function.createDelegate(this,this.$28e);this.$$d_$6o0=Function.createDelegate(this,this.$6o0);this.$$d_$9bc=Function.createDelegate(this,this.$9bc);this.$$d_$6mx=Function.createDelegate(this,this.$6mx);this.$$d_$6E=Function.createDelegate(this,this.$6E);_d.$z.initializeBase(this);this.$95=h;this.$1m7=n;this.$39V=t;this.$Je=i;this.$2sy=o;this.$B=r;this.$4U=u;this.$21D=w;this.$k=s;this.$b=a;this.set_$21R(!1);this.$40F=!1;this.$2t4=v;this.$E7=b;this.$RQ=k;this.$2tm="CreateCalendarItemDefault";this.$Ka=d;this.$15Z=g;this.$1v=f;this.$bi=new _d.$QK(this.$$d_$6E,!1);this.$cG=new _y.$iW;this.$1UM=2;this.$c=c;this.$1A=l;this.$2sx=y;this.$1st=p;this.$1x0=_d.$R8.$5L6();this.$Y("BlockView",this.$$d_$6mx);this.$Y("IsUploadingAttachment",this.$$d_$6mx);this.$Y("ShowMoreDetails",this.$$d_$9bc);this.$Y("ComposeOnlineMeetingViewModel",this.$$d_$6o0);var nt=this;this.$28f=new _C(this.$$d_$28e,_d.$z.$A,this,"CanPersistChanges",function(){return nt.get_$2rt()});var tt=this;this.$4YA=new _C(this.$$d_$9gc,_d.$z.$A,this,"CanSave",function(){return tt.get_$1ZZ()});var it=this;this.$4Zg=new _C(this.$$d_$9gc,_d.$z.$A,this,"CanSend",function(){return it.get_$mT()});this.$3Ki=new _C(this.$$d_$9Ii,_d.$z.$A);var rt=this;this.$6fa=new _C(function(){_a.$6.$1X(_a.$0.$1c,"ClickOnMoreDetailsButton");rt.set_$199(!0);_a.$6.$19(null,"ClickOnMoreDetailsButton")},_d.$z.$A);this.$EW=new _C(this.$$d_$iq,_d.$z.$A);this.$Pr=new _C(this.$$d_$3mm,_d.$z.$A);this.$5e5=new _C(this.$$d_$8FI,_d.$z.$A);this.$5e9=new _C(this.$$d_$8FL,_d.$z.$A);this.$5e6=new _C(this.$$d_$8FJ,_d.$z.$A);this.$4iu=new _C(this.$$d_$AEq,_d.$z.$A);this.$6og=new _C(this.$$d_$AEp,_d.$z.$A);this.$6P5=new _C(this.$$d_$9f8,_d.$z.$A);this.$6P4=new _C(this.$$d_$9f9,_d.$z.$A);this.$u7=new _C(this.$$d_$9lL,_d.$z.$A);this.$rN=e.$5L2(this.$1v,this.$28f);if(this.$B.get_$L()!=="Mouse"){var ut=_a.$6.acss(_a.$0.$IE,"ApplicationBar:CreateRaw");this.set_$6k(_y.$22.$Aj(this));_a.$6.aces(ut)}};_d.$z.$3y6=function(n){for(var i=new Array(n.get_$C()),t=0;t<n.get_$C();t++)i[t]=n.get_$3o(t);return i.join(";")};function $703(n,t){var i=t.$3g();if(i.get_$5R()&&!_a.$7.$4N(i.get_$y(),i.get_$20())){i.set_$20(i.get_$20().$1Al(-1));i.$Ww()}var r=n.$Je.$8V(i);n.$4i7&&n.$4i7.$7az(r.$v);$4qC(n,r)}function $4qC(n,t,i){var f=_a.$6.acsa(_a.$0.$1c,"Initialize",!0);n.set_$1sy(t);$70R(n,n.$p.$v);n.$1Ha=n.$p.$h0.$ic(0,!0,n.$$d_$9LK);n.$E4=n.$p.$5p.$4Zq;$700(n);$701(n,i);n.set_$5Qp(new _d.$Dv(n.$p.$v));n.set_$g7(new _y.$5u);$706(n,n.get_$FS());$4qG(n);$70Q(n);n.set_$3kq(new _d.$G5(n.$p.$5p));$704(n);n.$29o=_d.$R8.$3pR(n.$p);$3(n,"ReminderPickerOptions");$70C(n);n.$6mx(null,null);var r=n.$p.$v.get_$1P();var u=r?r.get_$AIt():null;var e=this;n.$E7.$E(function(t){n.$B.get_$L()==="TouchNarrow"?n.set_$60(t.$1aa(n.$p.$v.get_$i(),u,!1,!0,null,!0,n.$x,null)):n.set_$60(t.$1aZ(n.$p.$v.get_$i(),u,!1,3,!0,null,!0,n.$x,null));n.set_$5KK(_d.$bB.$5LO(n.$B,n.$E7,n.$5f,_d.$z.$A))});var o=this;n.$RQ.$E(function(t){n.set_$1c6(t.$5Kh(new _d.$M3(n),n.$$d_$5CG));$2kn(n)});$70E(n);$2kn(n);n.$p.$v.$Ww();n.set_$4cN($3ai(n));n.set_$446($3ah(n));$6zz(n);$705(n);n.$4iF();var s=this;n.get_$Jf().$1Oh(function(){$70B(n);_a.$6.acea(f)})}function $70B(n){n.set_$5Ix(n.$2t4.$E(n.$p.$v,n.$1v));$702(n);n.set_$D2(!0);$3(n,"BlockView")}function $704(n){n.set_$5pj(n.$39V.$E(n.$p.$v.get_$4g(),n.$$d_$9hg,n.get_$4h()));n.$F1.$Y("Location",n.$$d_$ACd);n.$40K=$4q5(n)}function $3aj(n){if(n.$B.get_$L()!=="Mouse")throw Error.invalidOperation("Compose view can only be popped out in MUI");if(!n.$B.get_$9l())throw Error.invalidOperation("Compose view can only be popped out from the main window");}function $70Q(n){n.$bi.set_$eS(n.$B.get_$L()==="Mouse"&&n.$B.get_$9l());$3(n,"ShowPopOutControl")}function $6zs(n){var t=new _d.$84(n.$p);t.set_$DI(n.$p.$YE);t.set_$2qK(n.$XO.$CC.$81m());return t}function $2kn(n){n.$B.get_$L()==="Mouse"?$70P(n):$70O(n);n.$bq()}function $70D(n,t){if(n.$B.get_$L()!=="Mouse"){t.add_$27U(n.$$d_$4Oy);t.add_$27L(n.$$d_$6HZ);t.add_$3J1(n.$$d_$6HX)}}function $70M(n,t){if(n.$B.get_$L()!=="Mouse"){t.remove_$27U(n.$$d_$4Oy);t.remove_$27L(n.$$d_$6HZ);t.remove_$3J1(n.$$d_$6HX)}}function $4qD(n){n.set_$3nJ(new _d.$4Q(n.$p.$EO,n.get_$Jf().$1d0(n.$p.$v.get_$5V()),n.$1v,n.$B));n.$ET.set_$1O(!1);n.$ET.set_$A1h(!n.$p.$v.get_$Gj())}function $701(n,t){n.$XO=n.$2sy.$E(n.$p.$v);var i=!t||!t.get_$2qK()||!t.get_$2qK().get_$C()?null:t.get_$2qK();n.$XO.$41(i)}function $705(n){_a.$61.$2v&&(n.$28t=new _d.$14W(n,n.$k,n.$B))}function $70E(n){n.$B.add_$KA(n.$$d_$bq);n.$B.add_$UA(n.$$d_$2t9);n.$B.add_$19w(n.$$d_$9Mp)}function $70N(n){n.$B.remove_$KA(n.$$d_$bq);n.$B.remove_$UA(n.$$d_$2t9);n.$B.remove_$19w(n.$$d_$9Mp)}function $70C(n){n.$p.$v.$Y("IsEventAMeeting",n.$$d_$8KM);n.$p.$v.$Y("Calendar",n.$$d_$7eL);n.$p.$v.$Y("Resources",n.$$d_$6Xc);n.$p.$5p.add_$2t(n.$$d_$3Jw);n.$p.$v.$Y("Location",n.$F1.$$d_$8S1);n.$p.$v.$Y("Start",n.$$d_$ADL);n.$p.$v.$Y("IsAllDayEvent",n.$$d_$9Tj);n.$p.$5p.$Y("CanSend",n.$$d_$6mx);n.$p.$5p.$Y("CanSave",n.$$d_$6mx);n.$p.$Y("IsDraft",n.$$d_$6o0)}function $70L(n){n.$p.$v.$q("IsEventAMeeting",n.$$d_$8KM);n.$p.$v.$q("Calendar",n.$$d_$7eL);n.$p.$v.$q("Resources",n.$$d_$6Xc);n.$p.$5p.remove_$2t(n.$$d_$3Jw);n.$p.$v.$q("Location",n.$F1.$$d_$8S1);n.$p.$v.$q("Start",n.$$d_$ADL);n.$p.$v.$q("IsAllDayEvent",n.$$d_$9Tj);n.$p.$5p.$q("CanSend",n.$$d_$6mx);n.$p.$5p.$q("CanSave",n.$$d_$6mx);n.$p.$q("IsDraft",n.$$d_$6o0)}function $4qB(n,t){for(var f=new _js.$c,e=n.get_$Jf().get_$m2(),r=0;r<e.get_$C();++r)for(var o=e.get_$3o(r),u=0;u<o.get_$CW().get_$C();u++){var i=o.get_$CW().get_$3o(u);if((!_g.$9I.isInstanceOfType(i)||!i.get_$20n())&&(!t||$4qF(n,i,t.EmailAddress))){var s=n.get_$Jf().$xm(i.get_$9U());s.$2rm(i)&&f.$D(s)}}return f}function $4qF(n,t,i){if(_g.$E2.isInstanceOfType(t)&&!t.get_$1EM())return n.$b.get_$2z().get_$AM()===i;if(_g.$9I.isInstanceOfType(t)){var r=t;return!r.get_$20n()&&r.get_$AX()===i}return!1}function $3ah(n){var t=n.$1pZ?n.$1pZ.get_$C():0;return t<2?!1:n.$p.$v.get_$17e()?!1:n.$p.get_$1Q9()?!0:n.$p.$v.get_$JC()?!1:n.get_$8JS()?!n.$p.$v.get_$Gj():!1}function $3ai(n){return n.$p.$v.get_$JC()&&n.$p.$v.get_$5Si()}function $702(n){n.$p.$v.get_$28()||n.$p.$v.set_$5V(n.get_$Jf().get_$ik());$70A(n)}function $70A(n){var t=n.$p.$v.get_$1c();if(t){if(!t.$2rm(n.$p.$v.get_$5V())){_js.Trace.logInfo(_d.$z.$A,"Cannot create content on Calendar:{0}. Reverting to DefaultCalendar",n.$p.$v.get_$1c().get_$1o());n.$p.$v.set_$5V(n.get_$Jf().get_$ik());n.$p.$6c.set_$5V(n.get_$Jf().get_$ik())}}else{var i=[_ucc.CalCoreStrings.l_ErrorCalendarActionFailed_Text,_u.Strings.l_ErrorAccessDenied_Text];_a.$4Y.$VN(i,0,n.$$d_$4O);return}$4qK(n);n.$p.$v.$Ww();n.$6o0();n.$5en();$4qD(n)}function $706(n,t){switch(n.$B.get_$L()){case"Mouse":n.set_$199(!0);break;default:n.$B.get_$9l()?n.set_$199(!t):n.set_$199(!0);break}}function $1AM(n,t,i,r){n.$Bt.set_$1tm(t);n.$Bt.set_$3nS(i);n.$Bt.set_$2tA(r);n.$3Jt&&n.$3Jt.$s()}function $70G(n){if(!n.$41w&&_js.$8.$a(n.$p.$v.get_$2i())){$1AM(n,n.$p.$v.get_$JC()?_nbs.NonBootStrings.l_NoMeetingTitle_Text:_nbs.NonBootStrings.l_NoEventTitle_Text,n.$p.get_$1Ke()?_nbs.NonBootStrings.l_AreYouSureYouWantToSendThisEventToAttendees_Text:_nbs.NonBootStrings.l_AreYouSureYouWantToSaveTheEventWithoutATitle_Text,n.get_$7v9());n.$Bt.set_$OQ(!0);return!0}return!1}function $70H(n){if(!n.$41y&&_cc.$Cp.$20N(n.$p.$v)&&n.$p.get_$1Ke()){$1AM(n,_nbs.NonBootStrings.l_EventOccursInThePastTitle_Text,_nbs.NonBootStrings.l_AreYouSureYouWantToSendThisEventToAttendees_Text,n.get_$7wK());n.$Bt.set_$OQ(!0);return!0}return!1}function $70J(n){if(!n.get_$FS()&&n.$p.get_$AFj()&&!$707(n)){if(!n.get_$1zS()&&!n.$40F){$1AM(n,_nbs.NonBootStrings.l_Calendar_Compose_NoChanges_Text,_nbs.NonBootStrings.l_Calendar_Compose_NoChanges_Description_Text,n.get_$9uD());n.$Bt.set_$OQ(!0);return!0}if(n.$p.get_$8Ci()){$1AM(n,_nbs.NonBootStrings.l_SendUpdateToAttendees_Text,"",n.get_$9uE());n.$Bt.set_$OQ(!0);return!0}}return!1}function $70I(n){if(!n.$41z&&!n.get_$FS()&&n.$p.$6c.get_$M2()&&!n.$p.$6c.get_$M2().$4i(n.$p.$v.get_$M2())){$1AM(n,_nbs.NonBootStrings.l_ExceptionsLostWarning_Text,"",n.get_$8SN());n.$Bt.set_$OQ(!0);return!0}return!1}function $707(n){return!!n.$p.$v.get_$y()&&!n.$p.$v.get_$y().$4i(n.$p.$6c.get_$y())||!!n.$p.$v.get_$20()&&!n.$p.$v.get_$20().$4i(n.$p.$6c.get_$20())||!$5(n.$p.$v.get_$EE())&&n.$p.$v.get_$EE()!==n.$p.$6c.get_$EE()||!$5(n.$p.$v.get_$5R())&&n.$p.$v.get_$5R()!==n.$p.$6c.get_$5R()||n.$F1.$1eW||!!n.$p.$v.get_$4g()&&!n.$p.$v.get_$4g().$4i(n.$p.$6c.get_$4g())||!!n.$p.$v.get_$M2()&&!n.$p.$v.get_$M2().$4i(n.$p.$6c.get_$M2())||!n.$p.$v.get_$M2()&&!!n.$p.$6c.get_$M2()}function $4qL(n,t,i){n.$XO.$3PB(t,i)}function $3ak(n,t){n.$F1.$4iK();if(n.$p.$v.get_$5R()){n.$p.$v.set_$y(n.$LN.$qo.$2R);n.$p.$v.set_$20(n.$LN.$qo.$3H.$9v(-1))}if(n.$p.$6c.get_$1c()!==n.$p.$v.get_$1c()){_a.$6.$1X(_d.$z.$A,"CalendarChanged");_a.$6.$19(null,"CalendarChanged")}var i=null;var r="";if(n.$E4.$2T){i=_cc.$1Lo.$1c.$Xc.$6i1(!0,n.get_$FS(),n.get_$YL(),n.$B.get_$L(),!n.get_$eS(),!n.$v0,n.$p.$v.get_$az());r=_cc.$1Lo.$1c.$Xc.$2Kx(t,n.get_$FS(),n.get_$YL(),n.$p,n.$LN,n.$ET);n.$E4.$s();n.set_$3nG(_nbs.NonBootStrings.l_Sending_Text);n.set_$21R(!0);var u=this;n.$p.$5p.add_$2t(function(n,t){n==="PersistActionFailed"?_cc.$1Lo.$1c.$Xc.$2xW(i,_cc.$1Lo.$6v.$ft(t),_cc.$1Lo.$6v.$Q6(t),r):n==="SendCalendarItemAction"&&_cc.$1Lo.$1c.$Xc.$2xW(i,"",_cc.$1Lo.$6v.$Q6(t),r)})}else if(n.$p.$5p.$DO.$2T){i=_cc.$1Lo.$1c.$Xc.$6i1(!1,n.get_$FS(),n.get_$YL(),n.$B.get_$L(),!n.get_$eS(),!n.$v0,n.$p.$v.get_$az());r=_cc.$1Lo.$1c.$Xc.$2Kx(t,n.get_$FS(),n.get_$YL(),n.$p,n.$LN,n.$ET);n.$p.$5p.$DO.$s();n.set_$3nG(_nbs.NonBootStrings.l_Saving_Text);n.set_$21R(!0);var f=this;n.$p.$5p.add_$2t(function(n,t){n==="PersistActionFailed"?_cc.$1Lo.$1c.$Xc.$2xW(i,_cc.$1Lo.$6v.$ft(t),_cc.$1Lo.$6v.$Q6(t),r):n==="SaveCalendarItemAction"&&_cc.$1Lo.$1c.$Xc.$2xW(i,"",_cc.$1Lo.$6v.$Q6(t),r)})}else _js.Trace.logError(_d.$z.$A,"Neither saveCommand nor sendCommand had their canExecute properties equals to true and thus neither got executed.");n.$yk&&n.$F1.$7Z8(n.$p.$v.get_$4g())}function $4q6(n){if(n.$40K){$1AM(n,_nbs.NonBootStrings.l_OverwriteLocationTitle_Text,String.format.apply(null,[_nbs.NonBootStrings.l_OverwriteLocationDescription_Text].concat([n.$p.$v.get_$4g().get_$1o(),_d.$z.$3y6($4q9(n))])),n.get_$9fB());n.$Bt.set_$OQ(!0);return}$3al(n)}function $3al(n){var t=null;var i=n.$p.$v.get_$9F();if(i&&i.get_$C()>0){var r=n.$p.$v.get_$9F().get_$3o(0);t=_g.$3V.$7m0(r);t.set_$iD(_d.$z.$3y6($6zw(n)))}n.$p.$v.set_$4g(t)}function $4qI(n){n.$p.$v.set_$4g(_g.$3V.$139(_nbs.NonBootStrings.l_OnlineMeetingDisplayLocation_Text))}function $4q5(n){var i=$4q9(n);var r=$6zy(n,n.$F1.$4E.get_$1o());if(i.get_$C()!==r.get_$C())return!0;for(var t=0;t<i.get_$C();t++)if(i.get_$3o(t)!==r.get_$3o(t))return!0;return!1}function $4q9(n){return $4qA(n,0)}function $6zw(n){return $4qA(n,1)}function $4qA(n,t){var r=new(_a.$3f.$$(String));var u=n.$p.$v.get_$9F();if(u)for(var i=t;i<n.$p.$v.get_$9F().get_$C();i++){var f=n.$p.$v.get_$9F().get_$3o(i);r.$D(f.get_$6u().Name)}return r}function $6zy(n,t){var r=new(_a.$3f.$$(String));if(t)for(var e=t.split(";"),u=e,o=u.length,i=0;i<o;++i){var f=u[i];_js.$8.$15(f)||r.$D(f.trim())}return r}function $4qG(n){var t=_cc.$Cp.$3z3(n.$p.$v)+1;n.set_$7cC(t>1?String.format(_nbs.NonBootStrings.l_ManyAttendees_Caps_Text,t):_nbs.NonBootStrings.l_Calendar_Compose_AddAttendees_Text)}function $4qH(n,t,i,r){if(i!=="defaultMode"){_js.Trace.logError(_d.$z.$A,"Compose is only supported on CalendarItemRequestMode.DefaultMode. RequestMode:{0}",i);return}n.set_$199(!0);var f=_a.$6.acss(_a.$0.$6y,"RetrieveCalendarItem");var u="HTML";n.$21D||(u="Text");n.$f9=n.$95.$1cp(300,t,n.$$d_$9Zr,n.$$d_$9Zq,r,null,u,i);_a.$6.aces(f)}function $70R(n,t){if(n.$B.get_$L()==="Mouse"&&t.get_$3M().get_$3s()!=="HTML"){var i=_js.$8.$4B("BodyType should always be HTML on Mouse Layout. Current BodyType: {0}",t.get_$3M().get_$3s());_js.Trace.logError(_d.$z.$A,i);throw Error.invalidOperation("Not able to edit a meeting with this Body Type. "+i);}}function $4q7(n){n.$p.$5p.$3sL.$2T&&n.$p.$5p.$3sL.$s()}function $6zt(n){var i=_cc.$1Lo.$1c.$I4.$A3u(n.$B.get_$L()==="Mouse"&&!n.get_$eS());if(n.get_$4Ue().get_$C()>0){var t=$6zu(n,n.$p.$6c,n.$p.$v,n.get_$4Ue());t.add_$6ZT(n.$$d_$9aK);return t}else return n.$1m7.$E(n.$p,n.$LN,n.$$d_$9hm,!1,n.get_$FS(),i)}function $6zu(n,t,i,r){var u=new _cc.$tW(i);var f=new _cc.$NE(_ucmm.MeetingMsgStrings.l_CurrentMeetingTime_Text,t);u.set_$1Wq(new(_0365f.$n.$$(_cc.$NE)));u.get_$1Wq().$D(f);u.get_$1Wq().$6S(r.$6W());u.set_$4g5(_nbs.NonBootStrings.l_NewTimesProposedLabel_Text);return n.$1m7.$7ns(u)}function $4qE(n,t){n.set_$199(!0);if(t)n.$5f.$u9(t,null,null);else if(n.$4U&&n.$4U.$3N("AttachmentsFilePicker")&&_y.$x.$w.get_$L()!=="TouchNarrow"){var i=_a.$6.$1X(_a.$0.$1P,"AttachmentsFilePickerPanelOpen",!0);_js.Trace.logInfo(_a.$0.$6y,"Opening OWA's file picker from calendar compose");$70K(n,i)}else{_js.Trace.logInfo(_a.$0.$l,"Opening OS's file picker");n.$5f.$u9(!1,null,null)}}function $70K(n,t){if(n.$Ka){var i=this;n.$Ka.$E(function(i){n.$rJ=i;n.$rJ&&n.$rJ.$VM(n.$5f,t,!0)})}}function $708(n){var i=!0;if(n.$ET.$ZJ&&!_cc.$IZ.isInstanceOfType(n.$ET.$ZJ)){var t=n.$p.$EO.$1xQ();if(t){n.$1v.$2u(0,t,null);return!1}}if(n.$p.$v.get_$JC()&&n.$rN.$40R(n.$p.$v,n.$5f.get_$1P()))return!1;if(_a.$61.$2v&&n.get_$mT()&&n.$28t&&n.$28t.$8Cs()){_js.Trace.logInfo(_d.$z.$A,"Not valid to send since policy violation detected");n.$1v.$2u(0,n.$28t.$83F(),null);return!1}return i}function $70P(n){var t=[];var u=$6zr(n);u.get_$C()>0&&Array.add(t,new _0365m.$HH(_nbs.NonBootStrings.l_IncludeMenuButtonText_Text,null,new _0365m.$2c(u.get_$3O())));if(!n.get_$FS()){n.$p.$v.get_$wV()&&Array.add(t,new _0365m.$o(_nbs.NonBootStrings.l_JoinOnlineMeeting_LowerCase_Text,null,n.$p.$b1));var i=new(_0365f.$n.$$(_0365m.$o));n.$p.$v.get_$fJ()&&i.$D(new _0365m.$o(_u.Strings.l_Reply_LowerCase_Text,null,n.$p.$Qj.$Ir));n.$p.$v.get_$iP()&&i.$D(new _0365m.$o(_u.Strings.l_ReplyAll_LowerCase_Text,null,n.$p.$Qj.$JT));n.$p.$v.get_$fI()&&i.$D(new _0365m.$o(_u.Strings.l_Forward_LowerCase_Text,null,n.$p.$Qj.$IN));i.get_$C()>0&&(i.get_$C()>1?Array.add(t,new _0365m.$HH(_u.Strings.l_Reply_LowerCase_Text,null,new _0365m.$2c(i.get_$3O()))):Array.add(t,i.get_$3o(0)))}n.$p.$v.get_$Gj()&&Array.add(t,new _0365m.$o(_nbs.NonBootStrings.l_OpenSeries_LowerCase_Text,null,n.$1Ha));var r=null;if(n.$R0){r=n.$R0.$3xI();r&&Array.add(t,r)}n.set_$2Jy(t.length?new _0365m.$2c(t):null);r&&n.$DU.$Y("IsShown",n.$$d_$3Iv)}function $6zr(n){var f=$4q8(n);var t=new(_0365f.$n.$$(_0365m.$o));var i=f;for(var r in i){var u={key:r,value:i[r]};t.$D(new _0365m.$o(u.key,null,u.value))}return t}function $6zq(n){var f=$4q8(n);var t=new(_0365f.$n.$$(_y.$32));var i=f;for(var r in i){var u={key:r,value:i[r]};t.$D(new _y.$32(u.key,u.value))}return t}function $700(n){var i=this;n.$2Gp=new _C(n.$$d_$12A,_d.$z.$A,n,"",function(){return n.$1A.get_$2Hx()&&!n.$1A.get_$6n()});var r=this;n.$1PU=new _C(n.$$d_$5fb,_d.$z.$A,n,"",function(){return n.$21D});var t;t=n.$c.$5i(n.$c.get_$B9())?n.$c.get_$B9().get_$bW():n;var u=this;n.$1Lu=new _C(n.$$d_$3iw,_d.$z.$A,t,"CameraAvailable",function(){return n.$c.$5i(n.$c.get_$B9())&&n.$c.get_$B9().get_$bW().get_$2Iv()});var f=this;n.$1Lv=new _C(n.$$d_$5Cw,_d.$z.$A,t,"GalleryAvailable",function(){return n.$c.$5i(n.$c.get_$B9())&&n.$c.get_$B9().get_$bW().get_$2zN()})}function $6zv(n){n.$2Gp.$1R();n.$2Gp=null;n.$1PU.$1R();n.$1PU=null;n.$1Lu.$1R();n.$1Lu=null;n.$1Lv.$1R();n.$1Lv=null}function $4q8(n){var t={};n.$2Gp.$2T&&(t[_nbs.NonBootStrings.l_AttachmentSubmenuItem_LowerCase_Text]=n.$2Gp);n.$1Lu.$2T&&(t[_nbs.NonBootStrings.l_NewPhotoSubmenuItemText_Text]=n.$1Lu);n.$1Lv.$2T&&(t[_nbs.NonBootStrings.l_PhotoFromGallerySubmenuItemText_Text]=n.$1Lv);n.$1PU.$2T&&(t[_nbs.NonBootStrings.l_PictureSubmenuItem_LowerCase_Text]=n.$1PU);return t}function $70O(n){var r=new(_0365f.$n.$$(_y.$2Q));var e=!!n.$4U&&n.$4U.$3N("ComposeApps");n.get_$mT()?r.$D(new _y.$2Q(_y.$d.get_$1JE(),_y.$d.get_$2fA(),_nbs.NonBootStrings.l_SendItemMobile_Text,n.$28f)):r.$D(new _y.$2Q(_y.$d.get_$BS(),_y.$d.get_$1Iy(),_nbs.NonBootStrings.l_SaveItemMobile_Text,n.$28f));r.$D(new _y.$2Q(_y.$d.get_$El(),_y.$d.get_$9sA(),_nbs.NonBootStrings.l_SchedulingAssistant_AppBarButtonText_Text,n.$3Ki));e&&n.$6l&&r.$D(new _y.$2Q(_y.$d.get_$2ph(),_y.$d.get_$5CM(),_nbs.NonBootStrings.l_AppsTouch_Text,n.$6l.$1nA));r.$D(new _y.$2Q(_y.$d.get_$9J(),_y.$d.get_$LH(),_nbs.NonBootStrings.l_CancelItemMobile_Text,n.$EW));var t=new(_0365f.$n.$$(_y.$32));if(!n.get_$FS()){n.$p.$5p.get_$Vp()?t.$D(new _y.$32(_nbs.NonBootStrings.l_DeleteEvent_LowerCase_Text,n.$p.$5p.$Tg)):n.$p.$5p.get_$iN()&&t.$D(new _y.$32(_nbs.NonBootStrings.l_CancelEvent_LowerCase_Text,n.$p.$5p.$7I));n.$p.$v.get_$wV()&&t.$D(new _y.$32(_nbs.NonBootStrings.l_JoinOnlineMeeting_LowerCase_Text,n.$p.$b1))}var u=$6zq(n);u.get_$C()>0&&t.$D(new _y.$32(_nbs.NonBootStrings.l_IncludeMenuButtonText_Text,null,u.get_$3O()));if(n.$R0){var f=n.$R0.$82G();f.get_$C()>0&&t.$D(new _y.$32(_u.Strings.l_Categorize_Text,null,f.get_$3O()))}var i=new(_0365f.$n.$$(_y.$32));if(!n.get_$FS()){n.$p.$v.get_$fJ()&&i.$D(new _y.$32(_u.Strings.l_Reply_LowerCase_Text,n.$p.$Qj.$Ir));n.$p.$v.get_$iP()&&i.$D(new _y.$32(_u.Strings.l_ReplyAll_LowerCase_Text,n.$p.$Qj.$JT));n.$p.$v.get_$fI()&&i.$D(new _y.$32(_u.Strings.l_Forward_LowerCase_Text,n.$p.$Qj.$IN));i.get_$C()>0&&(i.get_$C()>1?t.$D(new _y.$32(_u.Strings.l_Reply_LowerCase_Text,null,i.get_$3O())):t.$D(i.get_$3o(0)))}n.$p.$v.get_$Gj()&&t.$D(new _y.$32(_nbs.NonBootStrings.l_OpenSeries_LowerCase_Text,n.$1Ha));n.$3y.set_$I3(r.get_$3O());n.$3y.set_$bB(t.get_$3O())}function $4qJ(n){n.set_$1kp(2)}function $70F(n){n.set_$1kp(7)}function $6zp(n,t,i){var r=$6zx(n,t===1,i);$1AM(n,_nbs.NonBootStrings.l_Calendar_Compose_LeaveEventFormDialog_Title_Text,null,r);n.$Bt.set_$OQ(!0)}function $709(n){return n.$7j&&!n.$Bt.$135&&n.$FQ()}function $6zx(n,t,i){var r=new _js.$c;var u;var f;if(n.$p.get_$1Ke()){u=_nbs.NonBootStrings.l_ConfirmDialog_Send_Text;f=_nbs.NonBootStrings.l_SendUpdatedEventToAttendees_Text}else{u=_nbs.NonBootStrings.l_ConfirmDialog_Save_Text;f=_nbs.NonBootStrings.l_SaveChangesMadeToThisEvent_Text}var e=this;r.$D(new _a.$2E(new _C(function(){n.$28e();i&&i()},_d.$z.$A),u,f));var o=this;r.$D(new _a.$2E(new _C(function(){n.$5Pp();i&&i()},_d.$z.$A),_u.Strings.l_ConfirmDialog_Discard_Text,_nbs.NonBootStrings.l_DontSaveChangesMadeToThisEvent_Text));if(n.$B.get_$L()==="Mouse"&&t){var s=this;r.$D(new _a.$2E(new _C(function(){n.$6E();i&&i()},_d.$z.$A),_nbs.NonBootStrings.l_ConfirmDialog_Popout_Text,_nbs.NonBootStrings.l_OpenANewWindowWhereMoreChangesCanBeMade_Text))}var h=this;r.$D(new _a.$2E(new _C(function(){n.$3mm();n.$1Kc=!1},_d.$z.$A),_u.Strings.l_ConfirmDialog_Cancel_Text,_nbs.NonBootStrings.l_ReturnToEventForFurtherEditing_Text));return r}function $4qK(n){var u=n.$p.$v.get_$5V();var t=new _g.$1q;t.MailboxType=n.$p.$v.get_$FX().Mailbox.MailboxType;t.RoutingType=n.$p.$v.get_$FX().Mailbox.RoutingType;if(_g.$E2.isInstanceOfType(u)){t.EmailAddress=n.$b.get_$2z().get_$AM();t.Name=n.$b.get_$2z().get_$Fn();n.$Vt.$10D.$1xc(n.$b.get_$2z().get_$1KU())}else{var i=u;t.EmailAddress=i.get_$AX();if(i.get_$nc())t.Name=i.get_$Bb();else{var f=n.get_$Jf().$3xD(i.get_$AX());f&&(t.Name=f.get_$Bb())}n.$Vt.$10D.$1xc(i.get_$2bO())}var r=new _g.$Bc;r.Mailbox=t;n.$p.$v.set_$FX(r);n.$p.$6c.set_$FX(r)}function $6zz(n){n.$1Mv=n.$2sx.$E(n.$p);n.$1Mv.add_$9Zz(n.$$d_$9Zw);n.$1Mv.$5m()}function $6zo(n){n.$B7||n.$1R()}_d.$z.prototype={$1st:null,$1v:null,$1x0:null,$1m7:null,$39V:null,$B:null,$rN:null,$4YA:null,$4Zg:null,$28f:null,$3Ki:null,$EW:null,$6fa:null,$5e5:null,$5e9:null,$5e6:null,$Pr:null,$4iu:null,$6og:null,$6P5:null,$6P4:null,$c:null,$1A:null,$21D:!1,$Je:null,$bi:null,$95:null,$b:null,$2sy:null,$2t4:null,$2sx:null,$Ka:null,$15Z:!1,$1Ha:null,$1PU:null,$1Lu:null,$1Lv:null,$2Gp:null,$3Jt:null,$3J8:null,$1UM:0,$yk:!1,$5Uy:!1,$XO:null,$7j:!1,$2RN:!1,$2CF:!1,$cG:null,$F1:null,$p:null,$R0:null,$x:null,$LT:null,$k:null,$29o:null,$1pZ:null,$LN:null,$f9:null,$ET:null,$v0:!1,$5f:null,$Vt:null,$Bt:null,$3jJ:null,$2Jm:null,$1lj:null,$DC:null,$41w:!1,$41y:!1,$41z:!1,$d8:!1,$E4:null,$DU:null,$40K:!1,$4i7:null,$1Kc:!1,$1VJ:null,$2DN:null,$192:!1,$37o:!1,$40F:!1,$1Mv:null,$1tx:null,$E7:null,$RQ:null,$6l:null,$aO:null,$2tm:null,$4U:null,$28t:null,$u7:null,$1l8:null,$rJ:null,add_$6MS:function(n){this.$2G("Ready",n)},remove_$6MS:function(n){this.$2H("Ready",n)},get_$1c6:function(){return this.$6l},set_$1c6:function(n){if(n!==this.$6l){if(this.$6l){$70M(this,this.$6l);this.$6l.$78()}this.$6l=n;if(this.$6l){$70D(this,this.$6l);this.$6l.$5m()}$3(this,"ExtensibilityViewModel")}return n},get_$2Jy:function(){return this.$DU},set_$2Jy:function(n){if(n!==this.$DU){this.$DU=n;$3(this,"ContextMenu")}return n},get_$5pj:function(){return this.$F1},set_$5pj:function(n){if(this.$F1!==n){this.$F1=n;$3(this,"LocationWellViewModel")}return n},get_$7cC:function(){return this.$3jJ},set_$7cC:function(n){if(this.$3jJ!==n){this.$3jJ=n;$3(this,"AttendeeLabel")}return n},get_$4h:function(){return _y.$1Mq.prototype.get_$4h.call(this)},set_$4h:function(n){_y.$1Mq.prototype.set_$4h.call(this,n);this.$F1&&(this.$F1.$3m=n);return n},get_$1BF:function(){return this.$yk||!this.get_$Jf().get_$HJ()},get_$5gp:function(){return this.$p.$v.get_$5R()&&this.get_$YL()},get_$8Ng:function(){return!this.$p.$v.get_$5R()&&this.get_$YL()},get_$YL:function(){return!$5(this.$ET)&&!$5(this.$ET.$EO)&&!_cc.$IZ.isInstanceOfType(this.$ET.$EO.get_$I1())},get_$FS:function(){return this.$p.$YE||this.$p.get_$1Q9()},get_$KN:function(){return this.$B.get_$L()!=="Mouse"?1:0},get_$60:function(){return this.$5f},set_$60:function(n){if(this.$5f!==n){if(this.$5f){this.$5f.remove_$17Z(this.$$d_$7lM);this.$5f.remove_$tx(this.$$d_$tx);this.$5f.remove_$4jK(this.$$d_$bq);this.$5f.rpcl("IsInProgress",this.$$d_$7c4);this.$5f.rpcl("EditorCallContext",this.$$d_$7c4)}if(n){n.add_$17Z(this.$$d_$7lM);n.add_$tx(this.$$d_$tx);n.add_$4jK(this.$$d_$bq);n.apcl("IsInProgress",this.$$d_$7c4);n.apcl("EditorCallContext",this.$$d_$7c4)}this.$5f=n;$3(this,"AttachmentWellViewModel")}return n},get_$5Ix:function(){return this.$Vt},set_$5Ix:function(n){if(this.$Vt!==n){if(this.$Vt){this.$Vt.remove_$6Hn(this.$$d_$7lM);this.$Vt.remove_$4Oa(this.$$d_$4Oa);this.$Vt.$q("IsInProgress",this.$$d_$7nB);this.$Vt.$1R()}if(n){n.add_$6Hn(this.$$d_$7lM);n.add_$4Oa(this.$$d_$4Oa);n.$Y("IsInProgress",this.$$d_$7nB)}this.$Vt=n;this.$Vt&&this.$Vt.$10D.$1xc(this.$b.get_$2z().get_$1KU());$3(this,"ComposeOnlineMeetingViewModel")}return n},get_$3kq:function(){return this.$Bt},set_$3kq:function(n){if(this.$Bt!==n){this.$Bt=n;$3(this,"CalendarConfirmDialogViewModel")}return n},get_$199:function(){return this.$v0},set_$199:function(n){if(n!==this.$v0){this.$v0=n;$3(this,"ShowMoreDetails")}return n},get_$446:function(){return this.$2RN},set_$446:function(n){if(this.$2RN!==n){this.$2RN=n;$3(this,"IsCalendarPickerEnabled")}return n},get_$4cN:function(){return this.$2CF},set_$4cN:function(n){if(this.$2CF!==n){this.$2CF=n;$3(this,"ShowRequestResponses")}return n},get_$mT:function(){var n=!!this.$E4&&this.$E4.$2T;return!this.get_$1BF()&&(n||this.get_$5h9())},get_$1ZZ:function(){var n=!!this.$p&&this.$p.$5p.$DO.$2T;return!this.get_$1BF()&&!this.get_$5h9()&&n},get_$A09:function(){return this.$B.get_$L()==="Mouse"&&this.get_$FS()},get_$A0O:function(){return this.$B.get_$L()==="Mouse"&&!this.get_$FS()&&!this.$p.get_$1Ke()&&this.$p.$v.get_$Vp()},get_$A08:function(){return this.$B.get_$L()==="Mouse"&&!this.get_$FS()&&this.$p.get_$1Ke()&&this.$p.$v.get_$iN()},get_$1lk:function(){return this.$1lj},set_$1lk:function(n){this.$1lj=n;$3(this,"ResizeEditorCommand");return n},get_$D2:function(){return this.$7j},set_$D2:function(n){if(this.$7j!==n){this.$7j=n;$3(this,"IsInitialized")}return n},get_$2rt:function(){var n=!!this.$p&&(this.$p.$5p.get_$1ZZ()||this.$p.$5p.get_$mT());return n&&!this.$yk&&!this.$37o},get_$g7:function(){return this.$x},set_$g7:function(n){if(this.$x!==n){this.$x&&this.$AAq(this.$x);this.$x=n;this.$x&&this.$9mR(this.$x);$3(this,"InfoBarViewModel")}return n},get_$1sy:function(){return this.$p},set_$1sy:function(n){this.$p=n;$3(this,"CalendarItemViewModel");return n},get_$3kn:function(){return this.$R0},set_$3kn:function(n){if(this.$R0!==n){this.$R0&&this.$R0.remove_$2sA(this.$$d_$3JA);n&&n.add_$2sA(this.$$d_$3JA);this.$R0=n;$3(this,"CalendarCategoryViewModel")}return n},get_$5Qp:function(){return this.$LN},set_$5Qp:function(n){if(this.$LN!==n){this.$LN&&this.$LN.$q("DurationSelectedValue",this.$$d_$9Q6);n&&n.$Y("DurationSelectedValue",this.$$d_$9Q6);this.$LN=n;$3(this,"DurationViewModel")}return n},get_$3nJ:function(){return this.$ET},set_$3nJ:function(n){if(this.$ET!==n){if(this.$ET){this.$ET.$q("RecurrenceSelected",this.$$d_$6MV);this.$ET.$EO.$K6.$q("StartDate",this.$$d_$9ZF);this.$ET.$EO.$q("Model",this.$$d_$ABS);this.$AAp(this.$ET)}this.$ET=n;if(this.$ET){this.$ET.$Y("RecurrenceSelected",this.$$d_$6MV);this.$ET.$EO.$K6.$Y("StartDate",this.$$d_$9ZF);this.$ET.$EO.$Y("Model",this.$$d_$ABS);this.$9mQ(this.$ET);this.$4iF()}$3(this,"ComposeRecurrenceViewModel")}return n},get_$7sP:function(){var n=new _js.$c;n.$D(new _a.$2E(this.$28f,this.get_$mT()?_nbs.NonBootStrings.l_ConfirmDialog_Send_Text:_nbs.NonBootStrings.l_ConfirmDialog_Save_Text,this.get_$mT()?_nbs.NonBootStrings.l_SendEventToAttendees_Text:_nbs.NonBootStrings.l_SaveChangesMadeToThisEvent_Text));var t=_nbs.NonBootStrings.l_YourChangesWillNotBeSaved_Text;this.$p.get_$1Ke()?t=_nbs.NonBootStrings.l_EventWillNotBeSent_Text:this.get_$FS()&&(t=_nbs.NonBootStrings.l_ThisEventWillBeDeleted_Text);n.$D(new _a.$2E(new _C(this.$$d_$5Pp,_d.$z.$A),_u.Strings.l_ConfirmDialog_Discard_Text,t));n.$D(new _a.$2E(this.$Pr,_u.Strings.l_ConfirmDialog_Cancel_Text,_nbs.NonBootStrings.l_ReturnToEventForFurtherEditing_Text));return n},get_$7v9:function(){var n=new _js.$c;n.$D(new _a.$2E(this.$5e5,this.get_$mT()?_nbs.NonBootStrings.l_ConfirmDialog_Send_Text:_nbs.NonBootStrings.l_ConfirmDialog_Save_Text));n.$D(new _a.$2E(this.$Pr,_nbs.NonBootStrings.l_ConfirmDialog_Back_Text));return n},get_$7wK:function(){var n=new _js.$c;n.$D(new _a.$2E(this.$5e9,_nbs.NonBootStrings.l_ConfirmDialog_Send_Text));n.$D(new _a.$2E(this.$Pr,_nbs.NonBootStrings.l_ConfirmDialog_Back_Text));return n},get_$9uE:function(){var n=new _js.$c;n.$D(new _a.$2E(this.$6og,_nbs.NonBootStrings.l_JustAddedOrRemoved_Lowercase_Text,_nbs.NonBootStrings.l_SendUpdatesToAddedOrRemovedAttendees_Text));n.$D(new _a.$2E(this.$4iu,_nbs.NonBootStrings.l_Everyone_Lowercase_Text,_nbs.NonBootStrings.l_SendUpdatesToAllAttendees_Text));n.$D(new _a.$2E(this.$Pr,_nbs.NonBootStrings.l_CancelAndContinueEditing_Text,_nbs.NonBootStrings.l_ReturnToTheEventForFurtherEditing_SentenceCase_Text));return n},get_$9uD:function(){var n=new _js.$c;n.$D(new _a.$2E(this.$Pr,_nbs.NonBootStrings.l_Calendar_Compose_NoChanges_DontSend_Text));n.$D(new _a.$2E(this.$4iu,_nbs.NonBootStrings.l_Calendar_Compose_NoChanges_SendAnyway_Text));return n},get_$9fB:function(){var n=new _js.$c;n.$D(new _a.$2E(this.$6P5,_u.Strings.l_Yes_Text));n.$D(new _a.$2E(this.$Pr,_u.Strings.l_No_Text));return n},get_$9fA:function(){var n=new _js.$c;n.$D(new _a.$2E(this.$6P4,_u.Strings.l_Yes_Text));n.$D(new _a.$2E(this.$Pr,_u.Strings.l_No_Text));return n},get_$8SN:function(){var n=new _js.$c;n.$D(new _a.$2E(this.$5e6,this.get_$mT()?_nbs.NonBootStrings.l_ConfirmDialog_Send_Text:_nbs.NonBootStrings.l_ConfirmDialog_Save_Text));n.$D(new _a.$2E(this.$Pr,_nbs.NonBootStrings.l_ConfirmDialog_Back_Text));return n},get_$6qC:function(){return this.$1pZ},set_$6qC:function(n){if(this.$1pZ!==n){this.$1pZ=n;this.set_$446($3ah(this));$3(this,"WritableCalendars")}return n},get_$1zx:function(){return this.$d8},set_$1zx:function(n){this.$d8=n;n&&this.$p.$v.$J8.$s();return n},get_$1I2:function(){return this.$bi.get_$1I2()},get_$eS:function(){return this.$bi.get_$eS()},get_$8LN:function(){return this.$B.get_$9l()},get_$1kp:function(){return this.$1UM},set_$1kp:function(n){if(this.$1UM!==n){this.$1UM=n;$3(this,"PopupPanelSize")}return n},get_$2PH:function(){return this.$$d_$5g4},get_$7c:function(){return this.$DC},set_$7c:function(n){this.$DC=n;return n},get_$7sU:function(){return!0},get_$1zS:function(){return this.$p.get_$1zS()||this.$5Uy},get_$A7D:function(){return this.$2DN},set_$A7D:function(n){if(this.$2DN!==n){this.$2DN=n;if(this.$21D)$3(this,"TextToAppend");else{this.$p.$v.$IO&&this.$p.$v.$IO.$s();this.$p.$v.get_$3M().set_$1n(this.$p.$v.get_$3M().get_$1n()+this.$2DN)}}return n},get_$21R:function(){return this.$yk},set_$21R:function(n){if(this.$yk!==n){this.$yk=n;$3(this,"IsSubmitted");$3(this,"BlockView")}return n},get_$Jn:function(){return this.$aO},set_$Jn:function(n){this.$aO=n;$3(this,"EditorCallContext");return n},get_$3KT:function(){return this.$u7},get_$5h9:function(){return!!this.$XO&&this.$XO.get_$5l5()},get_$4YH:function(){return this.$1VJ},set_$4YH:function(n){this.$1VJ&&this.$1VJ.$1R();this.$1VJ=n;return n},get_$Jf:function(){return this.$95.$2M},get_$8Oy:function(){return this.$37o},set_$8Oy:function(n){if(this.$37o!==n){this.$37o=n;$3(this,"IsUploadingAttachment")}return n},get_$8JS:function(){return $4qF(this,this.$p.$v.get_$5V(),this.$b.get_$2z().get_$AM())},get_$5KK:function(){return this.$1tx},set_$5KK:function(n){this.$1tx=n;$3(this,"CopyPasteViewModel");return n},get_$3nG:function(){return this.$2Jm},set_$3nG:function(n){if(this.$2Jm!==n){this.$2Jm=n;$3(this,"ComposeActionString")}return n},get_$A17:function(){return!this.$p.$v.get_$Gj()},get_$A0H:function(){return this.$Vt.get_$46e()},get_$6fi:function(){return!!this.$p.$v.get_$17e()},get_$8Ij:function(){return this.get_$A17()||this.get_$A0H()||this.get_$6fi()||this.$2CF},$158:function(n){var t;t=this.$Je.$8V(n.get_$1Tl());t.$ABQ(n.get_$5Q());t.set_$DI(n.get_$DI());this.$5Uy=n.get_$2Nj();$4qC(this,t,n)},$42U:function(n){$4qH(this,n.get_$3tV(),n.get_$2zh(),n.get_$149())},$8GB:function(n){this.$4i7=n;$4qH(this,n.get_$i(),"defaultMode",n.get_$149())},$e6:function(){_y.$1Mq.prototype.$e6.call(this);this.$7j&&this.$p.$v.get_$JC()&&this.set_$199(!0)},$FZ:function(){_y.$1Mq.prototype.$FZ.call(this);this.$bq()},$4OV:function(n){this.$1Kc=!1;if(this.$1Mv&&this.$B.get_$L()!=="TouchNarrow")if(n){this.set_$4YH(null);this.$1Mv.$5m()}else this.$1Mv.$78()},$9hm:function(){if(!this.$1VJ)throw Error.invalidOperation("Cannot pop out scheduling when scheduling is not active.");$3aj(this);var n=new _d.$3a(this.$p,this.$1VJ.$d);n.set_$DI(this.$p.$YE);this.$4O();this.$B.$N3(_d.$DM,null,null,_y.$48.get_$iy(),n,!1)},$9hg:function(){if(!this.$F1||!_d.$6Q.isInstanceOfType(this.get_$4h().get_$7T()))throw Error.invalidOperation("Cannot pop out place picker when it is not active or available.");$3aj(this);var n=new _d.$8Z(this.$p,this.$F1.get_$1kj());n.set_$DI(this.$p.$YE);this.$4O();this.$B.$N3(_d.$DM,null,null,_y.$48.get_$iy(),n,!1)},$FQ:function(){return!this.$yk&&!this.$1Kc&&this.get_$1zS()},$5rE:function(){this.$p.$5rE()},$5en:function(){this.set_$3kn(this.$1st.$8V(this.$p.$v));$2kn(this)},$7lM:function(){this.$p.get_$1Q9()&&this.$p.$5p.$6ZG.$s()},$6E:function(){$3aj(this);_a.$6.$1X(_a.$0.$1c,"PopoutCalendarComposeForm");var n=$6zs(this);this.$Bt.set_$OQ(!1);this.$4O();this.$B.$N3(_d.$DM,null,null,_y.$48.get_$iy(),n,!1);_a.$6.$19(null,"PopoutCalendarComposeForm")},$ADv:function(){this.$4iF();$4qG(this);this.set_$446($3ah(this));this.set_$4cN($3ai(this))},$9mR:function(n){this.$XO.set_$8Fo(n);n.$Y("Count",this.$$d_$9TY);this.$LT=new _d.$p7(this.$p.$v,this.get_$FS(),this.$1Ha,this.$3Ki,this.$x,this.get_$4Ue());this.$LN.$Y("Start",this.$LT.$$d_$ACK);this.$LN.$Y("End",this.$LT.$$d_$ACK);this.$LN.$Y("IsAllDayEvent",this.$LT.$$d_$ACK);this.$p.$v.$Y("Calendar",this.$LT.$$d_$ACK)},$AAq:function(n){this.$LN.$q("Start",this.$LT.$$d_$ACK);this.$LN.$q("End",this.$LT.$$d_$ACK);this.$LN.$q("IsAllDayEvent",this.$LT.$$d_$ACK);this.$p.$v.$q("Calendar",this.$LT.$$d_$ACK);n.$q("Count",this.$$d_$9TY)},$9mQ:function(n){n.$EO.$K6.$Y("EndDate",this.$LT.$$d_$ACK);n.$EO.$Y("RecurrencePattern",this.$LT.$$d_$ACK)},$AAp:function(n){n.$EO.$K6.$q("EndDate",this.$LT.$$d_$ACK);n.$EO.$q("RecurrencePattern",this.$LT.$$d_$ACK)},$4iF:function(){this.$LT.$19y()},$49:function(){if(this.$7j){$6zv(this);this.$XO.$1R();$70L(this);this.$F1.$q("Location",this.$$d_$ACd);this.set_$3nJ(null);this.set_$g7(null);this.set_$3kn(null);this.set_$5Qp(null);this.set_$60(null);this.set_$5Ix(null);this.set_$4YH(null);this.set_$1c6(null)}if(this.$f9){this.$f9.$1R();this.$f9=null}this.$q("BlockView",this.$$d_$6mx);this.$q("IsUploadingAttachment",this.$$d_$6mx);this.$q("ShowMoreDetails",this.$$d_$9bc);this.$q("ComposeOnlineMeetingViewModel",this.$$d_$6o0);$70N(this);_a.$1.prototype.$49.call(this)},$6HZ:function(){this.$B.get_$L()==="TouchWide"&&this.$6l.get_$ne()&&!this.$v0&&$70F(this)},$6HX:function(){this.$B.get_$L()!=="TouchWide"||this.$v0||$4qJ(this)},$4Oy:function(){this.$B.get_$L()!=="Mouse"&&this.set_$199(!0)},$5g4:function(n,t){var i=!0;var r=!i;if(this.$Bt&&this.$Bt.$135)return i;if($709(this)){$6zp(this,t,n);return i}$6zo(this);return r},$2t9:function(n){this.$192||this.$FQ()&&n.$1Lk(_nbs.NonBootStrings.l_Calendar_BrowserWindowUnloadWarning_Text);this.$192=!0;_js.$J.get_$I().$1s(_a.$0.$1c,"ResetSkipBeforeUnloadConfirmationFlag",this.$$d_$6XL,100)},$9Mp:function(){this.$yk||$4q7(this)},$9lL:function(){$BF(this,"Ready",this,this)},$tx:function(n){this.$40F=!0;_a.$61.$2v&&this.$2ij(8)},$7c4:function(n,t){t==="IsInProgress"?this.set_$8Oy(this.$5f.get_$Bz()):t==="EditorCallContext"&&this.set_$Jn(this.$5f.get_$Jn())},$2ij:function(n){_a.$61.$2v&&this.$28t&&this.$p&&this.$28t.$2ij(this.$5f,this.$p.$v,n)},$7nB:function(n,t){this.set_$3nG(this.$Vt.$JD?_nbs.NonBootStrings.l_OnlineMeetingCreationInProgress_Text:"");this.set_$21R(this.$Vt.$JD)},$4Oa:function(n){this.$p.$v.set_$i(_0365f.$2d.$3g(this.$p.$6c.get_$i()));if(this.$p.$v.get_$4g()&&!_js.$8.$a(this.$p.$v.get_$4g().get_$1o())){$1AM(this,_nbs.NonBootStrings.l_OverwriteLocationTitle_Text,String.format.apply(null,[_nbs.NonBootStrings.l_OverwriteLocationDescription_Text].concat([this.$p.$v.get_$4g().get_$1o(),_nbs.NonBootStrings.l_OnlineMeetingDisplayLocation_Text])),this.get_$9fA());this.$Bt.set_$OQ(!0)}else $4qI(this);this.set_$A7D(n.$80n(this.$21D))},$9LK:function(){this.$1R()},$6mx:function(n,t){$3(this,"CanPersistChanges");$3(this,"CanSave");$3(this,"CanSend");$2kn(this)},$9Tj:function(n,t){if(this.$p.$v.get_$5R()){this.$p.$v.set_$99("Free");this.$p.set_$hI(_d.$CN.$1TP)}else{this.$p.$v.set_$99("Busy");this.$p.set_$hI(this.$b.get_$13().get_$1O9()?this.$b.get_$13().get_$2vU():_d.$CN.$1TP)}$3u(this,"IsAllDayAndRecurring","IsRecurringAndNotAllDay")},$6o0:function(n,t){this.$p.$YE||!this.get_$FS()?this.set_$6qC($4qB(this,this.$p.$v.get_$FX().Mailbox)):this.set_$6qC($4qB(this,null))},$3mm:function(){this.$Bt.$Pr.$s();this.$41y=!1;this.$41w=!1;this.$41z=!1;this.$3J8&&this.$3J8.$s()},$8FI:function(){this.$41w=!0;this.$Bt.$Pr.$s();this.$28e()},$8FL:function(){this.$41y=!0;this.$Bt.$Pr.$s();this.$28e()},$8FJ:function(){this.$41z=!0;this.$Bt.$Pr.$s();this.$28e()},$AEq:function(){this.$E4=this.$p.$5p.$4Zq;this.$Bt.$Pr.$s();$3ak(this)},$AEp:function(){this.$E4=this.$p.$5p.$6bg;this.$Bt.$Pr.$s();$3ak(this)},$9gc:function(){this.$28e(!0)},$28e:function(n){var t=this;var r=function(){if($708(t)&&!$70G(t)&&!$70H(t)&&!$70J(t)&&!$70I(t)){t.$Bt.set_$OQ(!1);$3ak(t,n)}};var i=this;var u=function(){i.$Pr.$2T&&i.$Pr.$s()};this.$Bt.set_$OQ(!1);$4qL(this,r,u)},$8KM:function(n,t){this.set_$199(!0);this.$ADv()},$7eL:function(n,t){$4qK(this);var i=$3ai(this);this.$5en();$4qD(this);this.$p.$v.set_$EE(i);this.set_$4cN(i)},$6Xc:function(n,t){$4q6(this)},$9f8:function(){$3al(this);this.$Bt.set_$OQ(!1)},$9f9:function(){$4qI(this);this.$Bt.set_$OQ(!1)},$9TY:function(n,t){this.$bq()},$9Q6:function(n,t){this.$bq()},$6MV:function(n,t){this.$ET.$ZJ&&!_cc.$UN.isInstanceOfType(this.$ET.$ZJ)&&_ucc.CalCoreStrings.l_EditPattern_Text===this.$ET.$ZJ&&this.$ET.set_$1O(!0);this.$bq();$L8(this,"IsAllDayAndRecurring","IsRecurring","IsRecurringAndNotAllDay")},$ABS:function(n,t){this.$p.$v.get_$1Uj()?this.$p.$v.set_$Jd("RecurringMaster"):this.$p.$v.set_$Jd("Single")},$9ZF:function(n,t){var i=this.$LN.get_$y().$5u(this.$LN.get_$y().$4D());this.$LN.set_$y(this.$ET.$EO.$K6.$6F.$4D().$9v(i))},$9bc:function(n,t){this.$v0?this.$4aw():$4qJ(this)},$9Zq:function(n){_cc.$5o.$3x1(n,this.$$d_$4O)},$9Zr:function(n){var t=_a.$6.acss(_a.$0.$6y,"LoadExistingCalendarItem");$703(this,n);_a.$61.$2v&&this.$2ij(32);_a.$6.aces(t)},$3Jw:function(n,t){if(this.get_$7c()&&(n==="RemoveCalendarItemAction"||n==="CancelCalendarItemAction"||n==="SaveCalendarItemAction"||n==="SendCalendarItemAction"||n==="MoveCalendarItemAction")){this.$4O();$BF(this,"EditingCompleted",n,null)}else if(n==="SaveDraftCalendarItemAction"){this.$p.set_$DI(!0);this.$p.$v.set_$i(this.$p.$6c.get_$i());this.$5f&&this.$5f.$18V(this.$p.$v.get_$i(),this.$p.$v.get_$1P().get_$AIt(),null);this.$Vt&&this.$Vt.$ABH(this.$p.$v)}else n==="PersistActionFailed"&&this.set_$21R(!1)},$iq:function(){this.$F1.$4iK();if(this.get_$1zS()||this.$XO.get_$nI()){$1AM(this,_nbs.NonBootStrings.l_CloseEventForm_Text,null,this.get_$7sP());this.$Bt.set_$OQ(!0)}else this.$4O()},$5Pp:function(){_a.$6.$1X(_a.$0.$1c,"DiscardComposeChanges");$4q7(this);this.$Bt.$Pr.$s();this.$4O();_a.$6.$19(null,"DiscardComposeChanges")},$4O:function(){this.$1Kc=!0;this.get_$7c()();this.$B7||this.$1R()},$9Ii:function(){_a.$6.$1X(_a.$0.$1c,"OpenSchedulingAssistantForm_ResolveAttendees");var n=this;var t=function(){_a.$6.$19(null,"OpenSchedulingAssistantForm_ResolveAttendees","",null,null);n.set_$4YH($6zt(n));var t;if(n.$B.get_$L()==="TouchNarrow")t=n.$1VJ.$1Cf;else{t=n.$1VJ;_js.Trace.logWarning(_a.$0.$1c,"Navigating to scheduling form")}n.get_$4h().$BQ(t)};var r=this;var i=function(){_a.$6.$19(null,"OpenSchedulingAssistantForm_ResolveAttendees","Attendees cannot be resolved",null,"Attendees cannot be resolved")};$4qL(this,t,i)},get_$4Ue:function(){if(this.$1l8)return this.$1l8;this.$1l8=this.$15Z?_cc.$JN.$3yc(this.$p.$6c):new(_0365f.$n.$$(_cc.$NE));return this.$1l8},$9aK:function(n){var t=this.$p.$v;this.$LN.set_$18u(n.get_$6at());t.set_$7G(n.get_$9tO());t.set_$8D(n.get_$9tK());t.set_$9F(n.get_$9tP())},$12A:function(){$4qE(this,!1)},$5fb:function(){$4qE(this,!0)},$3iw:function(){this.$5f.$4QZ()},$5Cw:function(){this.$5f.$6OB()},$ADL:function(n,t){var i=this.$p.$v.get_$y().$4D();_a.$7.$4N(this.$p.$EO.$K6.$6F.$4D(),i)||this.$p.$EO.$K6.set_$91(i)},$ACd:function(n,t){this.$p.$v.set_$4g(this.$F1.$4E);this.$40K=$4q5(this)},$3Iv:function(n,t){this.$DU.$30&&this.$R0&&this.$R0.$4Th()},$bq:function(){this.$1lj&&this.$1lj.$2T&&this.$1lj.$s()},$5CG:function(n){this.$bq()},$6dr:function(){this.set_$1kp(5)},$4aw:function(){this.set_$1kp(1)},$9Zw:function(n,t){if(t){this.$XO.$CC.$7Yp(t);this.$XO.$CC.$9o1(n);this.$B.get_$L()==="TouchNarrow"?$4q6(this):$3al(this)}},$6XL:function(){this.$192=!1},$3JA:function(){this.$bq();this.$v0||this.set_$199(!0)}};_d.$DM=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt){_a.$3.$m(g,"nativeBridge");this.$2NK=i;this.$2sy=f;this.$b=e;this.$7cS=n;this.$1m7=t;this.$39V=r;this.$Je=u;this.$k=o;this.$B=s;this.$1H=d;this.$95=c;this.$1wv=l;this.$J=a;this.$2t4=v;this.$2sx=y;this.$mM=p;this.$1st=w;this.$E7=b;this.$RQ=k;this.$1H=d;this.$4U=h;this.$c=g;this.$Ka=nt};function $4qN(n){var t=new _g.$1q;t.EmailAddress=n.$b.get_$2z().get_$AM();t.Name=n.$b.get_$2z().get_$Fn();t.MailboxType="Mailbox";var i=n.get_$3ky().$1u1(t);i.get_$3M().set_$3s(n.get_$5lO()?"HTML":"Text");return i}function $70S(n){var t=new _d.$84(null);t.set_$1Tl($4qN(n));t.set_$5Q($4qN(n));return t}function $4qM(n,t,i){t.get_$2i()&&i.set_$2i(t.get_$2i());i.set_$y(t.get_$y()||_a.$7.get_$2F());var r=t.get_$DE()===undefined?_a.$2F.$1K4(2):t.get_$DE();i.set_$20(i.get_$y().$9v(r));i.set_$99(t.get_$3SR());i.set_$5R(t.get_$5R());t.$7gQ("ReminderIsSet")?i.set_$PU(t.get_$PU()):i.set_$PU(n.$b.get_$13().get_$1O9());t.get_$7G()&&i.set_$7G(_g.$3i.$6km(t.get_$7G()));t.get_$8D()&&i.set_$8D(_g.$3i.$6km(t.get_$8D()));t.get_$4g()&&i.set_$4g(t.get_$4g());t.get_$3M()&&i.set_$3M(t.get_$3M());i.set_$28(t.get_$1ML())}_d.$DM.prototype={$b:null,$7cS:null,$39V:null,$1m7:null,$2NK:null,$Je:null,$k:null,$B:null,$1wv:null,$95:null,$J:null,$mM:null,$2sy:null,$2t4:null,$2sx:null,$1st:null,$E7:null,$RQ:null,$1H:null,$c:null,$Ka:null,$4U:null,get_$3ky:function(){return this.$mM},get_$6ZV:function(){return this.$1m7},get_$5FK:function(){return this.$Je},get_$3kf:function(){return this.$95.get_$1n()},get_$7zg:function(){return this.$1wv},get_$5lO:function(){return this.$1H.get_$Bk()},$2zO:function(n){var t=$70S(this);$4qM(this,n,t.get_$5Q());$4qM(this,n,t.get_$1Tl());t.set_$2Nj(n.get_$2Nj());return t},$br:function(n,t,i,r){var u=this.$2Qt();i&&u.add_$6MS(i);if(_d.$Gk.$C0(n))u.$8GB(new _d.$Gk(n));else if(_y.$9S.$C0(n))u.$42U(new _y.$9S(n));else{var f=this.$2zO(new _d.$Wc(n));u.$158(f)}r&&(u.$2tm=r);return u},$wx:function(n,t){var i=this.$2Qt();i.$158(n);return i},$9qK:function(n){return[this.$br(n,null)]},$7oA:function(n){var t=this.$2Qt();t.$158(n);if(_d.$3a.isInstanceOfType(n)){var i=this.get_$6ZV().$E(t.$p,t.$LN,t.$$d_$9hm,!0,t.get_$FS(),null);n.$5KM(i.$d);return[t,i]}if(_d.$8Z.isInstanceOfType(n)){var r=t.$F1.get_$1kj();n.$5KM(r);return[t,r]}return[t]},$2Qt:function(){return new _d.$z(this.get_$6ZV(),this.$39V,this.get_$5FK(),this.$B,this.$4U,new _y.$4p,this.get_$7zg(),this.$2sy,this.$k,this.get_$3kf(),this.$c,_a.UserAgent.getInstance(),this.$b,this.$2t4,this.$2sx,this.$1st,this.get_$5lO(),this.$E7,this.$RQ,this.$Ka,this.get_$8NT())},get_$8NT:function(){return this.$4U.$3N("ProposeNewTime")}};_d.$R8=function(){};_d.$R8.$3pR=function(n){var t=new _js.$c;t.$D(_d.$CN.$1TP);t.$D(0);t.$D(5);t.$D(10);t.$D(15);t.$D(30);t.$D(60);t.$D(120);t.$D(180);t.$D(240);t.$D(480);t.$D(720);t.$D(1440);t.$D(2880);t.$D(4320);t.$D(10080);t.$D(20160);if(n.get_$hI()>t.get_$3o(t.get_$C()-1))t.$D(n.get_$hI());else for(var i=0;i<t.get_$C();i++){if(n.get_$hI()===t.get_$3o(i))break;if(n.get_$hI()<t.get_$3o(i)){t.$6r(i,n.get_$hI());break}}return t};_d.$R8.$5L6=function(){var n=new _js.$c;n.$D("Free");n.$D("WorkingElsewhere");n.$D("Tentative");n.$D("Busy");n.$D("OOF");return n};_d.$Dv=function(n){this.$$d_$9d3=Function.createDelegate(this,this.$9d3);_d.$Dv.initializeBase(this);this.$2I=n;this.$SO=new _d.$1GT(n);this.$qo=$2FH(this);$70V(this);this.$SO.add_$83(this.$$d_$9d3)};_d.$Dv.$5cW=function(n,t){var i=n.$5u(t);return!!(i%864e5)};function $70W(n,t){n.$SO.set_$y(t.get_$y());n.$SO.set_$20(t.get_$20());n.set_$rD(t.get_$5R()?-1:n.get_$DE())}function $70V(n){n.$rC=new _js.$c;n.$rC.$D(0);n.$rC.$D(18e5);n.$rC.$D(36e5);n.$rC.$D(54e5);n.$rC.$D(72e5);n.$rC.$D(-1);n.$rC.$D(-2);n.set_$rD(n.$2I.get_$5R()?-1:n.get_$DE())}function $2FH(n){var t=_cc.$Cp.$3xS(n.$SO);n.$3oE=t.$3H.$5u(t.$2R);return t}_d.$Dv.prototype={$2I:null,$SO:null,$rC:null,$xN:0,$qo:null,$3oE:0,$1ZV:!1,$1ZW:!1,get_$y:function(){return this.$SO.get_$y()},set_$y:function(n){if(!this.$1ZW&&_d.$Dv.$5cW(n,this.get_$y()))throw Error.invalidOperation("Changing time part of Start is not allowed");this.$SO.set_$y(n);return n},get_$20:function(){return this.$SO.get_$20()},set_$20:function(n){if(!this.$1ZV)throw Error.invalidOperation("Changing the End date or time part are not allowed");if(!this.$1ZW&&_d.$Dv.$5cW(n,this.get_$20()))throw Error.invalidOperation("Changing time part of End is not allowed");this.$SO.set_$20(n);return n},get_$DE:function(){return this.$SO.get_$DE()},set_$DE:function(n){this.$SO.set_$DE(n);return n},get_$rD:function(){return this.$xN},set_$rD:function(n){this.$xN=n;switch(n){case 0:case 18e5:case 36e5:case 54e5:case 72e5:this.set_$3lc(!1);this.set_$3le(!0);this.$2I.set_$5R(!1);this.set_$2tg($2FH(this));this.set_$DE(this.$xN);break;case-1:this.$2I.set_$5R(!0);this.set_$2tg($2FH(this));this.set_$3lc(!0);this.set_$3le(!1);break;default:this.$xN=-2;this.$2I.set_$5R(!1);this.set_$2tg($2FH(this));this.set_$3lc(!0);this.set_$3le(!0);break}$3u(this,"DurationSelectedValue","IsAllDayEvent");return n},get_$2tg:function(){return this.$qo},set_$2tg:function(n){if(this.$qo.$4i(n))return n;this.$qo=n;$3(this,"CorrectedDateRange");return n},get_$3lc:function(){return this.$1ZV},set_$3lc:function(n){if(n!==this.$1ZV){this.$1ZV=n;$3(this,"CanChangeEndDateAndTime")}return n},get_$3le:function(){return this.$1ZW},set_$3le:function(n){if(n!==this.$1ZW){this.$1ZW=n;$3(this,"CanChangeStartAndEndTime")}return n},get_$5R:function(){return this.$2I.get_$5R()},set_$5R:function(n){if(n!==this.$2I.get_$5R()){this.$2I.set_$5R(n);$3(this,"IsAllDayEvent")}return n},add_$3Qr:function(n){this.$2G("SelectedTimeChangedEvent",n)},remove_$3Qr:function(n){this.$2H("SelectedTimeChangedEvent",n)},get_$18u:function(){return this},set_$18u:function(n){if(!_g.$WV.$4N(n,this)){$70W(this,n);$Cq(this,"SelectedTimeChangedEvent",this)}return n},$6n3:function(n,t,i){this.$SO.set_$y(n);this.$SO.set_$DE(t);this.set_$rD(i?-1:this.get_$DE())},$9d3:function(n,t){t==="Start"?$3(this,"Start"):t==="End"&&$3(this,"End");this.set_$2tg($2FH(this));$Cq(this,"SelectedTimeChangedEvent",this)}};_d.$IF=function(n,t,i,r){this.$$d_$9qc=Function.createDelegate(this,this.$9qc);this.$$d_$9On=Function.createDelegate(this,this.$9On);this.$$d_$9Oo=Function.createDelegate(this,this.$9Oo);this.$$d_$9Op=Function.createDelegate(this,this.$9Op);this.$$d_$2u5=Function.createDelegate(this,this.$2u5);this.$$d_$6fi=Function.createDelegate(this,this.$6fi);this.$$d_$4Pm=Function.createDelegate(this,this.$4Pm);_d.$IF.initializeBase(this);this.$2g=n;this.$1v=i;this.$k=r;this.$10D=t;this.set_$Bz(!1);this.$10D.add_$5Ye(this.$$d_$4Pm);this.$4c8=new _C(this.$$d_$6fi,_d.$IF.$A);var u=this;this.$3pB=new _C(this.$$d_$2u5,_d.$IF.$A,this,"IsOnlineMeetingButtonEnabled",function(){return u.get_$46d()});if(this.$2g.get_$17e()){this.set_$4PT(new _d.$s7(this.$2g.get_$17e()));this.$1Tg.set_$1O(!1)}else this.set_$4PT(null)};_d.$IF.$80X=function(n,t,i){var s=i?"<P><BR></P>":"\n";var r=[];if(t){_js.$8.$15(n.AcpInformation.TollNumber)||Array.add(r,String.format(i?_nbs.NonBootStrings.l_JoinOnlineMeetingDialInNumberForTollumberFormatRichText_Text:_nbs.NonBootStrings.l_JoinOnlineMeetingDialInNumberForTollNumberFormatPlainText_Text,n.AcpInformation.TollNumber));for(var h=i?_nbs.NonBootStrings.l_JoinOnlineMeetingDialInNumberForTollFreeNumberFormatRichText_Text:_nbs.NonBootStrings.l_JoinOnlineMeetingDialInNumberForTollFreeNumberFormatPlainText_Text,o=n.AcpInformation.TollFreeNumbers,c=o.length,u=0;u<c;++u){var l=o[u];Array.add(r,String.format(h,l))}}else for(var a=i?_nbs.NonBootStrings.l_JoinOnlineMeetingDialInNumberFormatRichText_Text:_nbs.NonBootStrings.l_JoinOnlineMeetingDialInNumberFormatPlainText_Text,f=0;f<n.Numbers.length;f++){var e=n.Numbers[f];Array.add(r,String.format(a,e.Number,e.RegionName,e.Language))}return r.length?String.format(i?_nbs.NonBootStrings.l_OnlineMeetingJoinByPhoneSectionRichText_Text:_nbs.NonBootStrings.l_OnlineMeetingJoinByPhoneSectionPlainText_Text,r.join(s)):""};function $3am(n){var i=n.$10D.$882(n.$2g);var t=new _c.$14x(n.$2g,i);t.add_$29(n.$$d_$9Op);t.add_$21(n.$$d_$9Oo);t.add_$2t(n.$$d_$9On);n.$k.$11(t)}_d.$IF.prototype={$4c8:null,$3pB:null,$10D:null,$1v:null,$k:null,$JD:!1,$2g:null,$4PS:null,$1Tg:null,$Du:null,add_$6Hn:function(n){this.$2G("OnBeforeCreateOnlineMeeting",n)},remove_$6Hn:function(n){this.$2H("OnBeforeCreateOnlineMeeting",n)},add_$4Oa:function(n){this.$2G("OnCreateOnlineMeetingSucceeded",n)},remove_$4Oa:function(n){this.$2H("OnCreateOnlineMeetingSucceeded",n)},get_$46e:function(){return!this.$2g.get_$17e()&&(this.$10D.get_$2SM()||this.get_$46d())&&!this.$2g.get_$Gj()},get_$6Kp:function(){return this.get_$46d()?_nbs.NonBootStrings.l_OnlineMeetingButton_Text:_nbs.NonBootStrings.l_OnlineMeetingButtonDisabledTooltip_Text},get_$46d:function(){return!this.$JD&&!!this.$2g&&this.$10D.$8JD(this.$2g)},get_$4PT:function(){return this.$1Tg},set_$4PT:function(n){if(this.$1Tg!==n){this.$1Tg=n;$3(this,"OnlineMeetingSettingsViewModel")}return n},get_$Bz:function(){return this.$JD},set_$Bz:function(n){if(this.$JD!==n){this.$JD=n;$3(this,"IsInProgress");this.$4Pm("")}return n},$49:function(){this.$10D.remove_$5Ye(this.$$d_$4Pm);_a.$1.prototype.$49.call(this)},$4Pm:function(n){$L8(this,"IsOnlineMeetingButtonVisible","IsOnlineMeetingButtonEnabled","OnlineMeetingButtonTitleText")},$ABH:function(n){this.$2g=n;this.$JD&&$3am(this)},$80n:function(n){if(!this.$Du)return"";var o=!$5(this.$Du.AcpInformation);var i=n?"<P><BR></P>":"\n";var s;var r;var u="";var f="";var t="";if(n){r=o?String.format(_nbs.NonBootStrings.l_OnlineMeetingParticipantPasscodeRichText_Text,this.$Du.AcpInformation.ParticipantPassCode):String.format(_nbs.NonBootStrings.l_OnlineMeetingConferenceIdRichText_Text,this.$Du.ConferenceId);var e="";_js.$8.$15(this.$Du.LogoUrl)||(e=String.format('<img src="{0}" />{1}{1}',this.$Du.LogoUrl,i));_js.$8.$15(this.$Du.HelpUrl)||(u=String.format(_nbs.NonBootStrings.l_OnlineMeetingHelpSectionRichText_Text,this.$Du.HelpUrl));_js.$8.$15(this.$Du.LegalUrl)||(f=String.format(_nbs.NonBootStrings.l_OnlineMeetingLegalSectionRichText_Text,this.$Du.LegalUrl));_js.$8.$15(this.$Du.CustomFooterText)?_js.$8.$a(e)||(t=String.format("{1}{0}{1}",e,i)):t=String.format("{1}{2}{0}{1}",this.$Du.CustomFooterText,i,e)}else{r=o?String.format(_nbs.NonBootStrings.l_OnlineMeetingParticipantPasscodePlainText_Text,this.$Du.AcpInformation.ParticipantPassCode):String.format(_nbs.NonBootStrings.l_OnlineMeetingConferenceIdPlainText_Text,this.$Du.ConferenceId);_js.$8.$15(this.$Du.HelpUrl)||(u=String.format(_nbs.NonBootStrings.l_OnlineMeetingHelpSectionPlainText_Text,this.$Du.HelpUrl));_js.$8.$15(this.$Du.LegalUrl)||(f=String.format(_nbs.NonBootStrings.l_OnlineMeetingLegalSectionPlainText_Text,this.$Du.LegalUrl));_js.$8.$15(this.$Du.CustomFooterText)||(t=String.format("{1}{0}{1}",this.$Du.CustomFooterText,i))}var h=_d.$IF.$80X(this.$Du,o,n);s=n?String.format(_nbs.NonBootStrings.l_RichTextOnlineMeetingInformationForEventComposeForm_Text,this.$Du.WebUrl,h,this.$Du.ExternalDirectoryUri,r,this.$Du.InternalDirectoryUri,u,f,t):String.format(_nbs.NonBootStrings.l_PlainTextOnlineMeetingInformationForEventComposeForm_Text,this.$Du.WebUrl,h,this.$Du.ExternalDirectoryUri,r,this.$Du.InternalDirectoryUri,u,f,t);return s},$6fi:function(){this.$1Tg&&this.$1Tg.set_$1O(!0)},$2u5:function(){_a.$6.$1X(_a.$0.$6y,"CreateOnlineMeeting");this.set_$Bz(!0);this.$Du=null;this.$2g.get_$i()?$3am(this):$BF(this,"OnBeforeCreateOnlineMeeting",this,null)},$9Op:function(n){var t=n;this.$2g.set_$2Ti(t.$Du.WebUrl);this.set_$4PT(new _d.$s7(this.$2g.get_$17e()));this.$Du=t.$Du;this.set_$Bz(!1);$BF(this,"OnCreateOnlineMeetingSucceeded",this,this);this.$4PS=""},$9Oo:function(n){this.$1v.$VN(2,[_u.Strings.l_UnableToGetOnlineMeetingInformation_Text],this.$$d_$9qc,!1,_u.Strings.l_RetryButton_LowerCase_Text,_nbs.NonBootStrings.l_Close_LowerCase_Text,_nbs.NonBootStrings.l_UnableToGetOnlineMeetingInformationDialogTitle_Text);this.$4PS=_cc.$1Lo.$6v.$ft(n)},$9On:function(n){this.$4Pm("");n.remove_$2t(this.$$d_$9On);n.remove_$29(this.$$d_$9Op);n.remove_$21(this.$$d_$9Oo);_a.$6.$19(null,"CreateOnlineMeeting",this.$4PS,_cc.$1Lo.$6v.$Q6(n))},$9qc:function(n,t){n?$3am(this):this.set_$Bz(!1)}};_d.$pA=function(n,t){this.$10D=n;this.$k=t};_d.$pA.prototype={$10D:null,$k:null,$E:function(n,t){return new _d.$IF(n,this.$10D,t,this.$k)}};_d.$14W=function(n,t,i){this.$$d_$6MI=Function.createDelegate(this,this.$6MI);this.$$d_$6MH=Function.createDelegate(this,this.$6MH);this.$$d_$6MF=Function.createDelegate(this,this.$6MF);if(_a.$61.$2v){this.$p=n;this.$Wq=new _d.$3Y(t,new _d.$vJ(n.$XO.$CC),n,n.$x,i);this.$Wq.$41();this.$Wq.set_$3Jy(this.$$d_$6MF);this.$Wq.set_$3Jx(this.$$d_$6MH);this.$Wq.set_$6MJ(this.$$d_$6MI)}};_d.$14W.prototype={$Wq:null,$p:null,$6MF:function(n){_a.$61.$2v&&this.$p.$p&&this.$p.$p.$v&&this.$p.$p.$v.set_$Vw(n)},$6MH:function(n){_a.$61.$2v&&this.$p.$p&&this.$p.$p.$v&&this.$p.$p.$v.set_$UN(n)},$6MI:function(){_a.$61.$2v&&this.$p.$2ij(64)},$2ij:function(n,t,i){if(_a.$61.$2v&&t&&t.get_$i()&&!t.get_$20e()&&!t.get_$2Ru()){_js.Trace.logInfo(_a.$0.$1c,"Prepares to submit policyTips action");var r=_a.$3T.$1xG(t.get_$2i());var u=_a.$3T.$1xG(t.$mx);var f=t.get_$i();n?this.$Wq.$2ha(f,n.get_$1P(),r,u,i):this.$Wq.$2ha(f,null,r,u,i)}},$8Cs:function(){if(!_a.$61.$2v||!this.$p.$p||!this.$p.$p.$v)return!1;switch(this.$Wq.$2zZ()){case 1:return!1;case 2:case 3:return $5(this.$p.$p.$v.get_$Vw())&&$5(this.$p.$p.$v.get_$UN());case 4:case 5:return $5(this.$p.$p.$v.get_$UN());default:return!1}},$83F:function(){if(!_a.$61.$2v)return"";switch(this.$Wq.$2zZ()){case 2:case 3:return _nbs.NonBootStrings.l_PolicyTipsBlockOverrideSend_Text;case 4:case 5:return _nbs.NonBootStrings.l_PolicyTipsBlockSend_Text;default:return""}}};_d.$4Q=function(n,t,i,r){this.$$d_$7ep=Function.createDelegate(this,this.$7ep);this.$$d_$9rk=Function.createDelegate(this,this.$9rk);this.$$d_$6NG=Function.createDelegate(this,this.$6NG);this.$$d_$AC5=Function.createDelegate(this,this.$AC5);_d.$4Q.initializeBase(this);this.$EO=n;this.$vl=t;this.$1v=i;this.$B=r;this.$Tf=_cc.$Hv.$5qn(this.$EO.$K6.$6F,this.$vl.get_$O9(),this.$B);this.$1HP=_d.$4Q.$85p();this.$4jt=_d.$4Q.$89F();this.$4VQ=_d.$4Q.$86y();this.$4Lw=_d.$4Q.$85W();$70g(this);this.set_$1TY(this.$1HP.get_$3o(0));this.set_$2jd(this.$4jt.get_$3o(0));this.set_$2ZR(this.$4Lw.get_$3o(0));this.set_$2d6(this.$4VQ.get_$3o(0));this.$EO.$Y("RecurrenceDataObject",this.$$d_$AC5);this.$EO.$Y("RecurrencePattern",this.$$d_$AC5);this.$EO.$K6.$Y("StartDate",this.$$d_$6NG);this.$DO=new _C(this.$$d_$9rk,_a.$0.$1c);this.$7I=new _C(this.$$d_$7ep,_a.$0.$1c);this.set_$DT(this);var u=new _js.$c;u.$D(new _a.$2E(this.$DO,_nbs.NonBootStrings.l_ComposeRecurrenceDialogSaveButtonTitle_Text));u.$D(new _a.$2E(this.$7I,_nbs.NonBootStrings.l_ComposeRecurrenceDialogCancelButtonTitle_Text));this.set_$St(u)};_d.$4Q.$85p=function(){var n=new _js.$c;n.$D(new _cc.$Jx(0));n.$D(new _cc.$Jh(0,0));n.$D(new _cc.$KH(0,0));n.$D(new _cc.$KI(0,"None",0));n.$D(new _cc.$Ki(0,0));n.$D(new _cc.$Lq("None",0,0));return n};_d.$4Q.$89F=function(){var n=new _js.$c;n.$D(1);n.$D(2);n.$D(4);n.$D(8);n.$D(16);n.$D(32);n.$D(64);return n};_d.$4Q.$86y=function(){var n=new _js.$c;n.$D("First");n.$D("Second");n.$D("Third");n.$D("Fourth");n.$D("Last");return n};_d.$4Q.$85W=function(){var n=new _js.$c;n.$D(0);n.$D(1);n.$D(2);n.$D(3);n.$D(4);n.$D(5);n.$D(6);n.$D(7);n.$D(8);n.$D(9);n.$D(10);n.$D(11);return n};function $1AN(n,t){return(n.$1uc&t)===t}function $70h(n){var t=_cc.$2v.$5Jz(n.$EO.$K6.$6F.get_$EA());n.set_$2vC(t);$4qU(n);n.set_$2vE(n.$EO.$K6.$6F.get_$5n().toString());n.set_$1zK("1");n.set_$2ZR(n.$EO.$K6.$6F.get_$3T());n.set_$2d6(_cc.$2v.$310(n.$EO.$K6.$6F));n.set_$2jd(t)}function $1Xb(n,t,i){t&&!$1AN(n,i)?n.set_$2vC(n.$1uc|i):!t&&$1AN(n,i)&&n.set_$2vC(n.$1uc&~i)}function $3an(n){for(var i=null,t=0;t<n.$Tf.get_$C();++t)if(_cc.$UN.isInstanceOfType(n.$Tf.get_$3o(t))&&n.$Tf.get_$3o(t).$2U(n.$EO.get_$I1())){i=n.$Tf.get_$3o(t);break}if($5(i)){var r=n.$B.get_$L()==="TouchNarrow"?n.$Tf.get_$C()-1:n.$Tf.get_$C()-2;if($5(n.$2uq)){r++;n.$Tf.$6r(r,_nbs.NonBootStrings.l_CustomPattern_Text)}n.$2uq=n.$EO.get_$I1();return n.$Tf.get_$3o(r)}else return i}function $4qT(n){var t=n.$EO.get_$I1();if(_cc.$Jx.isInstanceOfType(t)){n.set_$1TY(n.$1HP.get_$3o(0));n.set_$1zK(t.$BL.toString())}else if(_cc.$Jh.isInstanceOfType(t)){n.set_$1TY(n.$1HP.get_$3o(1));n.set_$1zK(t.$BL.toString());n.set_$2vC(t.$13Q)}else if(_cc.$KH.isInstanceOfType(t)){n.set_$1TY(n.$1HP.get_$3o(2));n.set_$1zK(t.$BL.toString());n.set_$2vE(t.$RH.toString())}else if(_cc.$KI.isInstanceOfType(t)){n.set_$1TY(n.$1HP.get_$3o(3));n.set_$1zK(t.$BL.toString());n.set_$2d6(t.$D8);n.set_$2jd(t.$RI)}else if(_cc.$Ki.isInstanceOfType(t)){n.set_$1TY(n.$1HP.get_$3o(4));n.set_$2ZR(t.$Yv);n.set_$2vE(t.$RH.toString())}else if(_cc.$Lq.isInstanceOfType(t)){n.set_$1TY(n.$1HP.get_$3o(5));n.set_$2ZR(t.$Yv);n.set_$2d6(t.$D8);n.set_$2jd(t.$RI)}n.set_$4cL(!_cc.$UN.isInstanceOfType(n.$ZJ))}function $70g(n){var t=$3an(n);n.set_$29d(t);n.set_$4cL(!_cc.$UN.isInstanceOfType(t));n.set_$6fx(!_cc.$IZ.isInstanceOfType(t))}function $4qU(n){$3(n,"MondaySelected");$3(n,"TuesdaySelected");$3(n,"WednesdaySelected");$3(n,"ThursdaySelected");$3(n,"FridaySelected");$3(n,"SaturdaySelected");$3(n,"SundaySelected")}function $70i(n){var t=n.$27C;n.set_$A0J(_cc.$Jx.isInstanceOfType(t));n.set_$A2J(_cc.$Jh.isInstanceOfType(t));n.set_$A1B(_cc.$KH.isInstanceOfType(t));n.set_$A1C(_cc.$KI.isInstanceOfType(t));n.set_$A2M(_cc.$Ki.isInstanceOfType(t));n.set_$A2L(_cc.$Lq.isInstanceOfType(t))}function $70j(n){if(_cc.$UN.isInstanceOfType(n.$ZJ)){n.$EO.set_$I1(n.$ZJ);$3ao(n)}else if(n.$ZJ===_nbs.NonBootStrings.l_CustomPattern_Text){n.$EO.set_$I1(n.$2uq);$3ao(n)}else if(n.$ZJ===_ucc.CalCoreStrings.l_EditPattern_Text){$70h(n);$4qT(n)}n.set_$6fx(!_cc.$IZ.isInstanceOfType(n.$EO.get_$I1()))}function $3ao(n){n.set_$4cL(!_cc.$UN.isInstanceOfType(n.$ZJ))}_d.$4Q.prototype={$B:null,$vl:null,$1v:null,$EO:null,$1HP:null,$4jt:null,$4Lw:null,$4VQ:null,$DO:null,$7I:null,$Tf:null,$1uc:0,$ZJ:null,$29c:null,$2L7:null,$2R2:null,$2gS:!1,$2gT:!1,$3Sf:!1,$3TS:!1,$3Sy:!1,$3Sz:!1,$3TU:!1,$3TT:!1,$2gR:!1,$26c:null,$2Et:null,$27C:null,$2uq:null,get_$9m0:function(){return this.$EO},get_$1zK:function(){return this.$2R2},set_$1zK:function(n){if(this.$2R2!==n){this.$2R2=n;$3(this,"IntervalString")}return n},get_$2vE:function(){return this.$2L7},set_$2vE:function(n){if(this.$2L7!==n){this.$2L7=n;$3(this,"DayString")}return n},get_$A1h:function(){return this.$2gS},set_$A1h:function(n){if(this.$2gS!==n){this.$2gS=n;$3(this,"ShowRecurrencePicker")}return n},get_$4cL:function(){return this.$2gT},set_$4cL:function(n){if(this.$2gT!==n){this.$2gT=n;$3(this,"ShowRecurrenceString")}return n},get_$3HI:function(){return $1AN(this,2)},set_$3HI:function(n){$1Xb(this,n,2);return n},get_$3Wj:function(){return $1AN(this,4)},set_$3Wj:function(n){$1Xb(this,n,4);return n},get_$3YM:function(){return $1AN(this,8)},set_$3YM:function(n){$1Xb(this,n,8);return n},get_$3VR:function(){return $1AN(this,16)},set_$3VR:function(n){$1Xb(this,n,16);return n},get_$2zE:function(){return $1AN(this,32)},set_$2zE:function(n){$1Xb(this,n,32);return n},get_$3Py:function(){return $1AN(this,64)},set_$3Py:function(n){$1Xb(this,n,64);return n},get_$3Um:function(){return $1AN(this,1)},set_$3Um:function(n){$1Xb(this,n,1);return n},get_$A0J:function(){return this.$3Sf},set_$A0J:function(n){if(this.$3Sf!==n){this.$3Sf=n;$3(this,"ShowDailyRecurrence")}return n},get_$A2J:function(){return this.$3TS},set_$A2J:function(n){if(this.$3TS!==n){this.$3TS=n;$3(this,"ShowWeeklyRecurrence")}return n},get_$A1B:function(){return this.$3Sy},set_$A1B:function(n){if(this.$3Sy!==n){this.$3Sy=n;$3(this,"ShowMonthlyByDayRecurrence")}return n},get_$A1C:function(){return this.$3Sz},set_$A1C:function(n){if(this.$3Sz!==n){this.$3Sz=n;$3(this,"ShowMonthlyByWeekRecurrence")}return n},get_$A2M:function(){return this.$3TU},set_$A2M:function(n){if(this.$3TU!==n){this.$3TU=n;$3(this,"ShowYearlyRecurrence")}return n},get_$A2L:function(){return this.$3TT},set_$A2L:function(n){if(this.$3TT!==n){this.$3TT=n;$3(this,"ShowYearlyByWeekRecurrence")}return n},get_$6fx:function(){return this.$2gR},set_$6fx:function(n){if(this.$2gR!==n){this.$2gR=n;$3(this,"ShowRangeFields")}return n},get_$29d:function(){return this.$ZJ},set_$29d:function(n){if(this.$ZJ!==n){this.$ZJ=n;$70j(this);$3(this,"RecurrenceSelected")}return n},get_$2ZR:function(){return this.$26c},set_$2ZR:function(n){if(this.$26c!==n){this.$26c=n;$3(this,"MonthsSelected")}return n},get_$1TY:function(){return this.$27C},set_$1TY:function(n){if(this.$27C!==n){this.$27C=n;$70i(this);$3(this,"OccursSelected")}return n},get_$2jd:function(){return this.$2Et},set_$2jd:function(n){if(this.$2Et!==n){this.$2Et=n;$3(this,"WeekdaysSelected")}return n},get_$2d6:function(){return this.$29c},set_$2d6:function(n){if(this.$29c!==n){this.$29c=n;$3(this,"RecurrenceOrderSelected")}return n},get_$9ly:function(){return this.$Tf},set_$9ly:function(n){if(this.$Tf!==n){this.$Tf=n;$3(this,"RecurrenceOptions")}return n},get_$2vC:function(){return this.$1uc},set_$2vC:function(n){this.$1uc=n;$4qU(this);return n},get_$an:function(){var n=_a.$BY.$4Rt(this.$2R2);return isNaN(n)?0:n},get_$1Nf:function(){var n=_a.$BY.$4Rt(this.$2L7);return isNaN(n)?0:n},$9rk:function(){var n=this.$27C;if(_cc.$Jx.isInstanceOfType(n))n.$BL=this.get_$an();else if(_cc.$Jh.isInstanceOfType(n)){n.$BL=this.get_$an();n.$13Q=this.$1uc}else if(_cc.$KH.isInstanceOfType(n)){n.$BL=this.get_$an();n.$RH=this.get_$1Nf()}else if(_cc.$KI.isInstanceOfType(n)){n.$BL=this.get_$an();n.$RI=this.$2Et;n.$D8=this.$29c}else if(_cc.$Ki.isInstanceOfType(n)){n.$RH=this.get_$1Nf();n.$Yv=this.$26c}else if(_cc.$Lq.isInstanceOfType(n)){n.$RI=this.$2Et;n.$Yv=this.$26c;n.$D8=this.$29c}if(n.$3Xu()){this.$1v.$2u(0,_cc.$De.$1xQ(n.$3Xu()),null);return}this.$EO.set_$I1(n.$3g());$3ao(this);this.$4f.$s()},$7ep:function(){this.set_$29d($3an(this));this.$4f.$s()},$AC5:function(n,t){this.set_$29d($3an(this));$4qT(this)},$6NG:function(n,t){for(var i=0,i=0;i<this.$Tf.get_$C();i++)if(String.isInstanceOfType(this.$Tf.get_$3o(i))||this.$Tf.get_$3o(i).$2U(this.$EO.get_$I1()))break;this.set_$9ly(_cc.$Hv.$5qn(this.$EO.$K6.$6F,this.$vl.get_$O9(),this.$B));$5(this.$2uq)||this.$Tf.$6r(this.$B.get_$L()==="TouchNarrow"?this.$Tf.get_$C():this.$Tf.get_$C()-1,_nbs.NonBootStrings.l_CustomPattern_Text);this.set_$29d(this.$Tf.get_$3o(i))}};_d.$4B=function(n,t,i,r,u){this.$$d_$9L6=Function.createDelegate(this,this.$9L6);this.$$d_$9PW=Function.createDelegate(this,this.$9PW);this.$$d_$4PD=Function.createDelegate(this,this.$4PD);this.$4C=new Sys.EventHandlerList;this.$2e4=new(_a.$3f.$$(String));_d.$4B.initializeBase(this);_a.$3.$m(r,"itemViewModel");_a.$3.$m(n,"gridUserAvailabilityCoordinator");this.$2qP=i;this.$Jp=n;this.$Sl=t;this.$b=u;this.$2Np=$70l(this);this.$6Xo=_d.$4B.$7np(r.$6c);this.$5VT=new _d.$kE;var f=_cc.$Cp.$3xS(r.$6c);this.$6Oi=f.$2R;this.$6Od=f.$3H;this.set_$MO(r.$v.get_$y());this.$20b=r.$v.get_$1eg();this.$36E=r.$v.get_$Ao();this.$Jp.add_$2rC(this.$$d_$4PD);this.$Sl.add_$2rC(this.$$d_$9PW);this.$Jp.$Y("HasActiveRequests",this.$$d_$9L6);this.$Sl.$Y("HasActiveRequests",this.$$d_$9L6)};_d.$4B.$6D=function(n){return n==="Tentative"||n==="Busy"||n==="OOF"};_d.$4B.$860=function(n,t){for(var u=t.get_$GX().get_$3O(),f=new(_a.$3f.$$(_d.$KY)),i=0;i<u.get_$C();++i){var r=new _d.$KY(u.get_$3o(i));n.$1QE(r)&&_d.$4B.$6D(r.$n6)&&f.$D(r)}return f};_d.$4B.$861=function(n,t){for(var u=new(_a.$3f.$$(_d.$KY)),i=0;i<t.get_$C();++i){var r=t.get_$3o(i);n.$1QE(r)&&_d.$4B.$6D(r.$n6)&&u.$D(r)}return u};_d.$4B.$7np=function(n){var i={};if(n.get_$i()){for(var r=new _d.$1Dc,t=null,u=0;u<n.get_$7G().get_$C();u++){t=n.get_$7G().get_$3o(u);i[t.get_$6u().EmailAddress]=r.$2x(t.get_$Th(),null)}for(var f=0;f<n.get_$8D().get_$C();f++){t=n.get_$8D().get_$3o(f);i[t.get_$6u().EmailAddress]=r.$2x(t.get_$Th(),null)}for(var e=0;e<n.get_$9F().get_$C();e++){t=n.get_$9F().get_$3o(e);i[t.get_$6u().EmailAddress]=r.$2x(t.get_$Th(),null)}var o=n.get_$FX();o?i[o.Mailbox.EmailAddress]=r.$2x("Organizer",null):_js.Trace.logError(_a.$0.$fQ,"Organizer is not expected to be null for this "+(n.get_$yR()?"full":"partial")+" calendar item, with ItemID "+n.get_$i()+". RequiredAttendees.Count = "+n.get_$7G().get_$C()+". OptionalAttendees.Count = "+n.get_$8D().get_$C()+". Resources.Count = "+n.get_$9F().get_$C()+". IsOrganizer = "+n.get_$Hq())}return i};function $3ap(n,t,i,r){for(var u=_c.$GL.$3oc(t),w=n.$Jp.$14Z(i),f=[],a=0;a<w.get_$C();a++){var e=w.get_$3o(a);if(f.length)if($5(e.get_$GX().get_$zB()))_js.Trace.logWarning(_a.$0.$fQ,"MergedFreeBusy property for a room was null");else for(var o=0;o<f.length;o++)e.get_$GX().get_$zB().charAt(o)<f[o]&&(f[o]=e.get_$GX().get_$zB().charAt(o));else if($5(e.get_$GX().get_$zB()))_js.Trace.logWarning(_a.$0.$fQ,"MergedFreeBusy property for a room was null");else for(var v=0;v<e.get_$GX().get_$zB().length;v++)Array.add(f,e.get_$GX().get_$zB().charAt(v))}u.get_$GX().$M(_c.$9m.$2VV,f.join(""));u.get_$GX().$M(_c.$9m.$2Nq,"FreeBusyMerged");if(r){var h;var y;var b,k;$3aq(n,n.$2qP,b={val:h},k={val:y});h=b.val;y=k.val;for(var d=n.$2qP===1?_a.$7.$Mb(n.$13H).$4D():n.$13H.$4D(),p=d.$3g(),c,s=h;s<y&&u.get_$GX().get_$zB().length>0;s++){c=d.$Bp((s-h+1)*n.$b.get_$13().get_$jL());var g=new _h.$4i(p,c);if(_d.$4B.$6D($1q5(n,u,s))&&_h.$4i.$1Yf(g,r)){var l=new _g.$2o;l.set_$y(p);l.set_$20(c);l.set_$99($1q5(n,u,s));u.get_$GX().get_$3O().$D(l)}p=c}}return u}function $4qX(n,t){var o=new(_a.$3f.$$(_d.$KY));var i;var r;var h=1440/n.$b.get_$13().get_$jL();var f;if(t.get_$GX().get_$zB().length===h){i=0;r=h;f=n.$Sl.$LF.$2R}else{var c,l;$3aq(n,0,c={val:i},l={val:r});i=c.val;r=l.val;f=n.$13H}for(var s=i,e=$1q5(n,t,i),u=i+1;u<r;u++){var a=$1q5(n,t,u);if(a!==e){$4qV(n,o,f,e,i,s,u);s=u;e=a}}$4qV(n,o,f,e,i,s,r);return o}function $4qV(n,t,i,r,u,f,e){if(r!=="Free"){var s=(e-f)*n.$b.get_$13().get_$jL();var o=new _g.$2o;o.set_$y(i.$4D().$Bp((f-u)*n.$b.get_$13().get_$jL()));o.set_$20(o.get_$y().$Bp(s));o.set_$99(r);t.$D(new _d.$KY(o))}}function $70o(n,t,i){for(var u="Free",e=n.$2Np.Free,f=0;f<i.get_$GX().get_$3O().get_$C();f++){var r=i.get_$GX().get_$3O().get_$3o(f);if(t.$1QE(r)){var o=n.$2Np[r.get_$99()];if(o>e){e=o;u=r.get_$99()}if(u===_d.$4B.$4Ly)break}else if(r.get_$y().$2U(t.$3H)>0)break}return u}function $70p(n,t,i){for(var u="Free",e=n.$2Np.Free,f=0;f<i.get_$C();f++){var r=i.get_$3o(f);if(t.$1QE(r)){var o=n.$2Np[r.$n6];if(o>e){e=o;u=r.$n6}if(u===_d.$4B.$4Ly)break}else if(r.$2R.$2U(t.$3H)>0)break}return u}function $70q(n,t,i){var r;if(_h.$4i.$1Yf(n.$Jp.$LF,t)){_js.Trace.logInfo(_a.$0.$fQ,"Fetching free-busy information for attendees from grid cache...");r=n.$Jp.$14Z(i)}else r=n.$Sl.$14Z(i);return r}function $4qW(n,t){var i=n.$4C.getHandler("DetailsCacheUpdateEvent");i&&i(t)}function $70m(n){var t=n.$4C.getHandler("CacheRefreshRequested");t&&t()}function $70r(n,t,i,r,u){r.val=null;i.$D(t);var e=i.$3g();var o=null;if(n.$lP&&e.$76(n.$lP.EmailAddress)){e.$34(n.$lP.EmailAddress);o=$3ap(n,n.$lP.EmailAddress,n.$2e4,null)}u.val=n.$Jp.$14Z(e);o&&u.val.$D(o);for(var f=0;f<u.val.get_$C();){if(u.val.get_$3o(f).$VZ===t){_js.Trace.logInfo(_a.$0.$fQ,"Found organizer{0} free busy model",u.val.get_$3o(f).$VZ);r.val=u.val.get_$3o(f);u.val.$6C(f);continue}f++}}function $70n(n,t,i,r,u){var l=new _js.$c;var e;var s;var a,v;$3aq(n,t,a={val:e},v={val:s});e=a.val;s=v.val;for(var y=t===1?_a.$7.$Mb(n.$13H).$4D():n.$13H.$4D(),p=y.$3g(),h,f=e;f<s;f++){var o=0;var w=$1q5(n,i,f);_d.$4B.$6D(w)&&o++;for(var c=0;c<r.get_$C();c++)_d.$4B.$6D($1q5(n,r.get_$3o(c),f))&&o++;h=y.$Bp((f-e+1)*n.$b.get_$13().get_$jL());o>0&&l.$D(new _d.$116(w,$70k(n,o,u),p,h,n.$20b,n.$36E));p=h}return l}function $3aq(n,t,i,r){var u=null;var e=0;var f=1440/n.$b.get_$13().get_$jL();switch(t){case 0:u=n.$13H.$4D();break;case 1:u=_a.$7.$Mb(n.$13H).$4D();f=f*7;break;default:throw Error.notImplemented(_d.$vO.toString(t));}e=Math.abs(n.$Jp.$LF.$2R.$5u(u));var o=6e4*n.$b.get_$13().get_$jL();i.val=e/o;r.val=i.val+f}function $1q5(n,t,i){if($5(t)||_js.$8.$a(t.get_$GX().get_$zB()))return"NoData";else{var r=t.get_$GX().get_$zB().charAt(i).toString();switch(r){case"0":return"Free";case"1":return"Tentative";case"2":return"Busy";case"3":return"OOF";case"4":return"WorkingElsewhere";case"5":return"NoData";default:_js.Trace.logError(_a.$0.$fQ,"Unexpected merged string encountered:'{0}')",r);return"NoData"}}}function $70k(n,t,i){if(!i)return 0;var r=t/i;if(r>.9&&r<1)return.9;else if(r>0&&r<.15)return.15;return r}function $4qY(n,t,i,r,u,f,e){var o;var s;var h=!1;if($5(f)){o="NoData";s=_u.Strings.l_LoadingWithEllipses_Text;u="NoError"}else{o=f;s=n.$5VT.$2x(o,null)}if(n.$6Oi.$4i(i)&&n.$6Od.$4i(r)){var c=n.$6Xo[t];if(!$5(c)){h=!0;s=c}}return new _d.$FE(t,o,s,h,u,e)}function $70l(n){var t={};t.Free=0;t.WorkingElsewhere=1;t.Tentative=2;t.Busy=3;t.OOF=4;return t}function $70s(n,t){if(_h.$4i.$1Yf(n.$Jp.$LF,n.$Sl.$LF)){var i=n.$Jp.$14Z(t);n.$Sl.$ABO(i);if(i.get_$C()!==t.get_$C()){for(var r=new(_a.$3f.$$(String)),e={},u=0;u<i.get_$C();u++)e[i.get_$3o(u).$VZ]=!0;for(var f=0;f<t.get_$C();f++){var o=t.get_$3o(f);e[o]||r.$D(o)}_js.Trace.logInfo(_a.$0.$fQ,"Requesting FB for missing effective users {0}",r);n.$Sl.$14Z(r)}}}_d.$4B.prototype={$Jp:null,$Sl:null,$5VT:null,$2qP:0,$6Oi:null,$6Od:null,$2Np:null,$6Xo:null,$b:null,$20b:!1,$36E:!1,$lP:null,$13H:null,$3AR:null,$45y:!1,$3Q8:null,add_$316:function(n){this.$Jp.add_$2rC(n)},remove_$316:function(n){this.$Jp.remove_$2rC(n)},add_$3rw:function(n){this.$4C.addHandler("DetailsCacheUpdateEvent",n)},remove_$3rw:function(n){this.$4C.removeHandler("DetailsCacheUpdateEvent",n)},get_$5s7:function(){return this.$3AR},set_$5s7:function(n){if(!_a.$7.$4N(this.$3AR,n)){if(n.$3nb())throw Error.argument("MeetingStartDate","value should not contain time part.");this.$3AR=n;this.$Sl.$6ne(this.$3AR,null)}return n},get_$MO:function(){return this.$13H},set_$MO:function(n){if(!_a.$7.$4N(this.$13H,n)){this.$13H=n;if(this.$Jp.$5mv(n))return n;var t=this.$3Q8.$3xb(!1);var i=_a.$7.$Mb(n);$70s(this,t);this.$Jp.$6ne(i,t)}return n},get_$45z:function(){return this.$45y},set_$45z:function(n){if(this.$45y!==n){this.$45y=n;$N(this,"IsLoadingData")}return n},get_$6ZU:function(){return this.$3Q8},set_$6ZU:function(n){this.$3Q8=n;return n},get_$2B3:function(){return this.$lP},set_$2B3:function(n){this.$lP=n;return n},get_$6YI:function(){return this.$2e4},$82S:function(n,t){var i=null;var r=null;t=t.$3g();var u,f;$70r(this,n,t,u={val:r},f={val:i});r=u.val;i=f.val;return $70n(this,this.$2qP,r,i,t.get_$C())},$83a:function(n){for(var i=this.$Jp.$14Z(n),r={},t=0;t<i.get_$C();t++){var u=i.get_$3o(t);r[u.$VZ]=u.$PV}return r},$87U:function(n,t,i){var a=new _h.$4i(n,t);var u={};var e=i.$3g();if(this.$lP&&e.$76(this.$lP.EmailAddress)){e.$34(this.$lP.EmailAddress);for(var o=$3ap(this,this.$lP.EmailAddress,this.$2e4,a),v=new(_a.$3f.$$(_d.$KY)),s=0;s<o.get_$GX().get_$3O().get_$C();s++)v.$D(new _d.$KY(o.get_$GX().get_$3O().get_$3o(s)));u[o.$VZ]=v}for(var y=this.$Jp.$14Z(e),h=0;h<y.get_$C();h++){var r=y.get_$3o(h);var f=null;switch(r.get_$GX().get_$2zD()){case"None":break;case"MergedOnly":f=$4qX(this,r);break;default:f=new(_a.$3f.$$(_d.$KY));for(var c,l=0;l<r.get_$GX().get_$3O().get_$C();l++){c=new _d.$KY(r.get_$GX().get_$3O().get_$3o(l));a.$1QE(c)&&f.$D(c)}break}u[r.$VZ]=f}var p=this;i.$Bd(function(n){$5(u[n])});return u},$8Cp:function(n,t,i,r){var u=new _h.$4i(n,t);if(_h.$4i.$1Yf(this.$Jp.$LF,u)){if(this.$Jp.$5bw(i))return!0;r&&this.$Jp.$14Z(i)}else{if(this.$Sl.$5bw(i))return!0;r&&this.$Sl.$14Z(i)}return!1},$2Ob:function(n,t,i,r){var f=new _h.$4i(n,t);var h=i.$3g();var c=null;if(r&&this.$lP&&h.$76(this.$lP.EmailAddress)){h.$34(this.$lP.EmailAddress);c=$3ap(this,this.$lP.EmailAddress,this.$2e4,f)}var l=$70q(this,f,h);c&&l.$D(c);for(var e={},a=0;a<l.get_$C();a++){var u=l.get_$3o(a);var o=null;var s="Free";switch(u.get_$GX().get_$2zD()){case"None":s="NoData";break;case"MergedOnly":o=_d.$4B.$861(f,$4qX(this,u));s=$70p(this,f,o);break;default:o=_d.$4B.$860(f,u);s=$70o(this,f,u);break}e[u.$VZ]=$4qY(this,u.$VZ,n,t,u.$PV,s,o)}var v=this;i.$Bd(function(i){$5(e[i])&&(e[i]=$4qY(v,i,n,t))});return e},$hG:function(){_js.Trace.logInfo(_a.$0.$fQ,"Refreshing Scheduling Grid Cache...");$70m(this);var n=this.$3Q8.$3xb(!0);this.$Jp.$hG(n,!0);if(!this.$Jp.$LF.$76(this.$Sl.$LF,!0)){_js.Trace.logInfo(_a.$0.$fQ,"Refreshing Scheduling Details Cache...");this.$Sl.$hG(n,!0)}},$ABr:function(n){this.$Jp.$4Wo(n);this.$Sl.$4Wo(n);this.$hG()},$4PD:function(n){if(this.$Jp.$LF.$76(this.$Sl.$LF,!0)){_js.Trace.logInfo(_a.$0.$fQ,"[Grid] Fire details cache event. Grid:{0} - Detail{1}",this.$Jp.$LF,this.$Sl.$LF);$4qW(this,n)}else _js.Trace.logInfo(_a.$0.$fQ,"[Grid] Suppress detail cache event. Grid:{0} - Detail{1}",this.$Jp.$LF,this.$Sl.$LF)},$9PW:function(n){if(this.$Jp.$LF.$76(this.$Sl.$LF,!0))_js.Trace.logInfo(_a.$0.$fQ,"[Detail] Suppressing details cache event. Grid:{0} - Detail{1}",this.$Jp.$LF,this.$Sl.$LF);else{_js.Trace.logInfo(_a.$0.$fQ,"[Detail] Fire details cache event. Grid:{0} - Detail{1}",this.$Jp.$LF,this.$Sl.$LF);$4qW(this,n)}},$9L6:function(n,t){this.set_$45z(this.$Jp.$2PL||this.$Sl.$2PL)}};_d.$Nf=function(){};_d.$Nf.$9uV=function(n){for(var r=[],t=0;t<n.get_$C();++t){var i={};i.DisplayName=n.get_$3o(t).get_$6u().Name;i.SmtpAddress=n.get_$3o(t).get_$6u().EmailAddress;i.RoutingType=n.get_$3o(t).get_$6u().RoutingType;Array.add(r,JsonParser.serialize(i))}return JsonParser.serialize(r)};_d.$Nf.$7ri=function(n){var i=JsonParser.deserialize(n.Properties);var t=new _js.$c;Array.forEach(i,function(n){var r=JsonParser.deserialize(n);var u=new _g.$3i;var i=new _g.$1q;i.Name=r.DisplayName;i.EmailAddress=r.SmtpAddress;i.RoutingType=r.RoutingType;u.set_$6u(i);t.$D(u)});return t};_d.$Nf.$9uW=function(n){for(var r=[],t=0;t<n.get_$C();++t){var i={};i.DisplayName=n.get_$3o(t).$CB.get_$1o();i.SmtpAddress=n.get_$3o(t).$CB.get_$1l().EmailAddress;i.RoutingType=n.get_$3o(t).$CB.get_$1l().RoutingType;i.GALContactGuid=n.get_$3o(t).$CB.get_$rS();Array.add(r,JsonParser.serialize(i))}return JsonParser.serialize(r)};_d.$Nf.$7rj=function(n){var i=JsonParser.deserialize(n.Properties);var t=new _js.$c;Array.forEach(i,function(n){var r=JsonParser.deserialize(n);var i=new _g.$1q;i.Name=r.DisplayName;i.EmailAddress=r.SmtpAddress;i.RoutingType=r.RoutingType;t.$D(i)});return t};_d.$lk=function(n,t){this.$$d_$7yI=Function.createDelegate(this,this.$7yI);this.$$d_$9NI=Function.createDelegate(this,this.$9NI);this.$$d_$9NJ=Function.createDelegate(this,this.$9NJ);_d.$lk.initializeBase(this);this.$2M=t;this.$lo=n;this.$2M.add_$2Ig(this.$$d_$9NJ);this.$2M.add_$5RI(this.$$d_$9NI)};_d.$lk.prototype={$2M:null,$lo:null,add_$5Ye:function(n){this.$2G("GetOnlineMeetingInformationCompleted",n)},remove_$5Ye:function(n){this.$2H("GetOnlineMeetingInformationCompleted",n)},get_$2SM:function(){return this.$lo.get_$2SM()},$8JD:function(n){return!!n&&!n.get_$17e()&&(_g.$E2.isInstanceOfType(n.get_$5V())&&this.$lo.get_$2SM()||_g.$9I.isInstanceOfType(n.get_$5V())&&this.$lo.$350(n.get_$5V().get_$2bO()))},$882:function(n){return!n||!n.get_$5V()?null:_g.$9I.isInstanceOfType(n.get_$5V())?n.get_$5V().get_$2bO():this.$lo.get_$2UY()},$1xc:function(n){this.$lo.$1xc(n,this.$$d_$7yI)},$49:function(){this.$2M.remove_$5RI(this.$$d_$9NI);this.$2M.remove_$2Ig(this.$$d_$9NJ);_js.$9.prototype.$49.call(this)},$7yI:function(n,t){$Fp(this,"GetOnlineMeetingInformationCompleted",this,n)},$9NI:function(n,t){var i=this.$2M.$xm(t.get_$9U());i.$2rm(t)&&!t.get_$20n()&&this.$lo.$1xc(t.get_$2bO(),this.$$d_$7yI)},$9NJ:function(n){this.$lo.$41(this.$$d_$7yI)}};_d.$s7=function(n){_d.$s7.initializeBase(this);this.$10E=n;this.set_$DT(this);var t=new _js.$c;t.$D(new _a.$2E(this.$4f,_u.Strings.l_Close_Text));this.set_$St(t)};_d.$s7.prototype={$10E:null,get_$9UZ:function(){switch(this.$10E.get_$3gb()){case"Everyone":return _nbs.NonBootStrings.l_OnlineMeetingAccessLevelEveryone_Text;case"Internal":return _nbs.NonBootStrings.l_OnlineMeetingAccessLevelInternal_Text;case"Invited":return _nbs.NonBootStrings.l_OnlineMeetingAccessLevelInvited_Text;case"Locked":return _nbs.NonBootStrings.l_OnlineMeetingAccessLevelLocked_Text;default:return""}},get_$9Ua:function(){switch(this.$10E.get_$4AM()){case"Disabled":return _nbs.NonBootStrings.l_OnlineMeetingLobbyBypassDisabled_Text;case"EnabledForGatewayParticipants":return _nbs.NonBootStrings.l_OnlineMeetingLobbyBypassEnabledForGatewayParticipants_Text;default:return""}},get_$9Ub:function(){switch(this.$10E.get_$4U5()){case"Disabled":return _nbs.NonBootStrings.l_OnlineMeetingPresentersDisabled_Text;case"Internal":return _nbs.NonBootStrings.l_OnlineMeetingPresentersInternal_Text;case"Everyone":return _nbs.NonBootStrings.l_OnlineMeetingPresentersEveryone_Text;default:return""}}};_d.$47=function(n){this.$$d_$iq=Function.createDelegate(this,this.$iq);this.$$d_$7ad=Function.createDelegate(this,this.$7ad);_d.$47.initializeBase(this,[_d.$47.$9qU(),_d.$47.$9qW(),_d.$47.$9qX(),_d.$47.$9qV(),n,null]);this.$5BJ=_d.$47.$6Xy("AllowMultipleSelection");this.$qL=new _C(this.$$d_$7ad,_a.$0.$1c);this.$EW=new _C(this.$$d_$iq,_a.$0.$1c);var t=$74G(this);this.set_$6k(_y.$22.$Aj(null,t,null));this.$3y.set_$4bh(!1);this.$AG()};_d.$47.get_$6Zj=function(){if(!_d.$47.$I5){_d.$47.$I5={};_d.$47.$I5[_d.$4U.toString(0)]=_nbs.NonBootStrings.l_OwaOptionPeoplePickerSearchBoxLabelFrom_Text;_d.$47.$I5[_d.$4U.toString(1)]=_nbs.NonBootStrings.l_OwaOptionPeoplePickerSearchBoxLabelTo_Text;_d.$47.$I5[_d.$4U.toString(2)]=_nbs.NonBootStrings.l_OwaOptionPeoplePickerSearchBoxLabelTo_Text;_d.$47.$I5[_d.$4U.toString(3)]=_nbs.NonBootStrings.l_OwaOptionPeoplePickerSearchBoxLabelFrom_Text;_d.$47.$I5[_d.$4U.toString(4)]=_nbs.NonBootStrings.l_OwaOptionPeoplePickerSearchBoxLabelOwners_Text;_d.$47.$I5[_d.$4U.toString(6)]=_nbs.NonBootStrings.l_OwaOptionPeoplePickerSearchBoxLabelGroupModerators_Text;_d.$47.$I5[_d.$4U.toString(5)]=_nbs.NonBootStrings.l_OwaOptionPeoplePickerSearchBoxLabelMembers_Text;_d.$47.$I5[_d.$4U.toString(7)]=_nbs.NonBootStrings.l_OwaOptionPeoplePickerSearchBoxLabelSenders_Text;_d.$47.$I5[_d.$4U.toString(8)]=_nbs.NonBootStrings.l_OwaOptionPeoplePickerSearchBoxLabelAllowedSenders_Text;_d.$47.$I5[_d.$4U.toString(9)]=_nbs.NonBootStrings.l_OwaOptionPeoplePickerSearchBoxLabelDefault_Text;_d.$47.$I5[_d.$4U.toString(10)]=_nbs.NonBootStrings.l_OwaOptionPeoplePickerSearchBoxLabelDefault_Text;_d.$47.$I5[_d.$4U.toString(11)]=_nbs.NonBootStrings.l_OwaOptionPeoplePickerSearchBoxLabelDefault_Text}return _d.$47.$I5};_d.$47.get_$9sK=function(){if(!_d.$47.$eE){_d.$47.$eE={};_d.$47.$eE[_d.$4U.toString(0)]=_nbs.NonBootStrings.l_OwaOptionPeoplePickerSearchBoxWaterMarkMessageSender_Text;_d.$47.$eE[_d.$4U.toString(1)]=_nbs.NonBootStrings.l_OwaOptionPeoplePickerSearchBoxWaterMarkMessageReceiver_Text;_d.$47.$eE[_d.$4U.toString(2)]=_nbs.NonBootStrings.l_OwaOptionPeoplePickerSearchBoxWaterMarkMessageReceiver_Text;_d.$47.$eE[_d.$4U.toString(3)]=_nbs.NonBootStrings.l_OwaOptionPeoplePickerSearchBoxWaterMarkMessageSender_Text;_d.$47.$eE[_d.$4U.toString(4)]=_nbs.NonBootStrings.l_OwaOptionPeoplePickerSearchBoxWaterMarkGroupOwner_Text;_d.$47.$eE[_d.$4U.toString(6)]=_nbs.NonBootStrings.l_OwaOptionPeoplePickerSearchBoxWaterMarkGroupModerator_Text;_d.$47.$eE[_d.$4U.toString(5)]=_nbs.NonBootStrings.l_OwaOptionPeoplePickerSearchBoxWaterMarkGroupMember_Text;_d.$47.$eE[_d.$4U.toString(7)]=_nbs.NonBootStrings.l_OwaOptionPeoplePickerSearchBoxWaterMarkSender_Text;_d.$47.$eE[_d.$4U.toString(8)]=_nbs.NonBootStrings.l_OwaOptionPeoplePickerSearchBoxWaterMarkAllowedSenders_Text;_d.$47.$eE[_d.$4U.toString(9)]=_nbs.NonBootStrings.l_OwaOptionPeoplePickerSearchBoxWaterMarkDefault_Text;_d.$47.$eE[_d.$4U.toString(10)]=_nbs.NonBootStrings.l_OwaOptionPeoplePickerSearchBoxWaterMarkDefault_Text;_d.$47.$eE[_d.$4U.toString(11)]=_nbs.NonBootStrings.l_OwaOptionPeoplePickerSearchBoxWaterMarkDefault_Text}return _d.$47.$eE};_d.$47.$9qU=function(){var n=window.dialogArguments;return _d.$Nf.$7ri(n)};_d.$47.$6Xy=function(n){var t=window.dialogArguments;var i=JsonParser.deserialize(t.Metadata);return i[n]};_d.$47.$9qW=function(){var n=window.dialogArguments;var t=JsonParser.deserialize(n.Metadata);var i=t.PickerCallerType;return _d.$47.get_$6Zj()[_d.$4U.toString(i)]};_d.$47.$9qX=function(){var n=window.dialogArguments;var t=JsonParser.deserialize(n.Metadata);var i=t.PickerCallerType;return _d.$47.get_$9sK()[_d.$4U.toString(i)]};_d.$47.$9qV=function(){var t=window.dialogArguments;var i=JsonParser.deserialize(t.Metadata);var r=i.PickerCallerType;var n=null;switch(r){case 0:n=_pc.$15.$xo;break;case 1:n=_pc.$15.$xo;break;case 2:n=_pc.$15.$xo;break;case 3:n=_pc.$15.$xo;break;case 4:n=_pc.$15.$1DP;break;case 6:n=_pc.$15.$1DP;break;case 5:n=_pc.$15.$1DP;break;case 7:n=_pc.$15.$1DP;break;case 8:n=_pc.$15.$1DP;break;case 9:n=_pc.$15.$xo;break;case 10:n=_pc.$15.$1DP;break;case 11:n=_pc.$15.$1DP;break;default:n=_pc.$15.$xo;break}return new _d.$2C(n,_pc.$15.$jD(),_d.$47.$6Xy("AllowAddAsSmtpAddress"))};function $74G(n){var t=new Array(2);t[0]=new _y.$2Q(_y.$d.get_$wa(),_y.$d.get_$1Zl(),_ucmm.MeetingMsgStrings.l_AcceptItem_Text,n.$qL);t[1]=new _y.$2Q(_y.$d.get_$9J(),_y.$d.get_$LH(),_u.Strings.l_Discard_Text,n.$EW);return t}_d.$47.prototype={$qL:null,$EW:null,$3y:null,$5BJ:!1,get_$6k:function(){return this.$3y},set_$6k:function(n){if(this.$3y!==n){this.$3y=n;$3(this,"ApplicationBarViewModel")}return n},$7Zr:function(n){return this.$5BJ?!0:n.get_$C()>=1?!1:!0},$9wF:function(n){n.$eL(1,new Array(0),n.get_$1u().get_$1l().EmailAddress)},$1ac:function(n){return this.$7F.$7od(_y.$17.$Km,n)},$7ad:function(){var n=window.dialogArguments;n.Properties=_d.$Nf.$9uV(this.$iH);window.close()},$iq:function(){window.close()}};_d.$sK=function(n){this.$7F=n};_d.$sK.prototype={$7F:null,$br:function(n,t){return new _d.$47(this.$7F)},$wx:function(n,t){return new _d.$47(this.$7F)}};_d.$SD=function(n,t,i,r,u,f){this.$$d_$4O8=Function.createDelegate(this,this.$4O8);this.$$d_$4Pj=Function.createDelegate(this,this.$4Pj);_d.$SD.initializeBase(this);this.$7F=u;this.$3jI=f;this.$9sJ=t;this.$52=r;this.$52.$12a();this.$52.set_$M0(i);this.$52.set_$1ls("PersonaDetailedView");this.$52.set_$QJ(!0);this.$52.set_$r(!1);this.$52.add_$hO(this.$$d_$4Pj);this.$52.set_$19t(100);this.$52.set_$1iX(0);this.$iH=n};function $74L(n,t){var i=$74O(n,t);$5(i)||$5(i.get_$1mQ())||t.get_$1u().set_$1l(i.get_$1mQ());if(!$74M(n,t.get_$1u().get_$1l().EmailAddress)){var r=new _d.$97(t.get_$1u(),n.$wI.$1Ui,!0);r.$1JC=!0;n.$9wF(r);n.$wI.$1LW(r,3)}}function $74N(n){for(var i=new _js.$c,t=0;t<n.$iH.get_$C();t++)i.$D(n.$iH.get_$3o(t).get_$6u());return n.$1ac(i)}function $74M(n,t){for(var i=0;i<n.$iH.get_$C();i++)if(n.$iH.get_$3o(i).get_$6u().EmailAddress.toLowerCase()===t.toLowerCase())return!0;return!1}function $74O(n,t){return _pc.$yX.isInstanceOfType(t)?t:null}_d.$SD.prototype={$52:null,$9sJ:null,$iH:null,$7F:null,$3jI:null,$wI:null,$1O7:null,get_$7cD:function(){return this.$wI},set_$7cD:function(n){this.$wI=n;$3(this,"AttendeeRecipientWellViewModel");return n},$AG:function(){this.$1O7={};this.set_$7cD($74N(this));this.$wI.$8i.remove_$1Y(this.$$d_$4O8);this.$wI.$8i.add_$1Y(this.$$d_$4O8);for(var n=0;n<this.$wI.$1U.get_$C();n++){var t=this.$wI.$1U.get_$3o(n);var i=this.$wI.$8i.get_$3o(n).EmailAddress;this.$1O7[i]=t}},$7Zr:function(n){return!0},$9wF:function(n){},$1ac:function(n){return this.$7F.$1ac(_y.$17.$Km,n,3)},$4Pj:function(n,t){var i=n.get_$X1();i&&this.$7Zr(this.$iH)&&($5(this.$3jI)||this.$3jI(i.get_$1u().get_$1l().EmailAddress))&&$74L(this,i)},$4O8:function(n,t){switch(t.$2Z){case 0:var i=this;Array.forEach(t.$2q,function(n){var t=i.$wI.$1U.get_$3o(i.$wI.$1U.get_$C()-1);var r=t.$5B.$18;i.$1O7[r.get_$1l().EmailAddress]=t;i.$iH.$D(_g.$3i.$xh(r.get_$1l()))});break;case 2:var r=this;Array.forEach(t.$3B,function(n){for(var i=n,t=0;t<r.$iH.get_$C();t++)if(r.$iH.get_$3o(t).get_$6u().EmailAddress.toLowerCase()===i.EmailAddress.toLowerCase()){r.$iH.$6C(t);return}});break;case 3:case 4:throw Error.argumentOutOfRange("People Picker only supports adding and removing attendees from the underlying recipient well.");}}};_d.$gT=function(n){this.$k=n};_d.$gT.prototype={$k:null,$E:function(n,t,i){var f=new _h.$4i(n.$v.get_$y(),n.$v.get_$20());var u=null;var r=n.$v.get_$9F();r&&r.get_$C()>0&&(u=r.get_$3o(0).get_$6u());return new _d.$Ij(i,f,u)},$5Ks:function(n,t){var i=new _h.$4i(n.$v.get_$y(),n.$v.get_$20());var r=this;return new _d.$F6(this.$k,t,function(){return new _c.$17s},i,_cc.$IZ.isInstanceOfType(n.$EO.get_$I1()))}};_d.$Gk=function(n){if($5(n))this.$3E={};else{if(!_d.$Gk.$C0(n))throw Error.invalidOperation("Cannot construct a UpdateCalendarItemParameters by passing a Dictionary of parameters that doesnt have an Item id and at least one more property value.");this.$3E=n}};_d.$Gk.$C0=function(n){return!$5(n[_d.$Gk.$sL])&&(!$5(n.Start)||!$5(n.Duration)||!$5(n.IsAllDayEvent))};_d.$Gk.prototype={$3E:null,get_$i:function(){if($5(this.$3E[_d.$Gk.$sL]))return null;var n=this.$3E[_d.$Gk.$sL];return _g.$1t.$2KF(n)},set_$i:function(n){$5(n)?delete this.$3E[_d.$Gk.$sL]:this.$3E[_d.$Gk.$sL]=n.Id;return n},get_$149:function(){return this.$3E.ExplicitLogonUser},set_$149:function(n){this.$3E.ExplicitLogonUser=n;return n},get_$y:function(){return this.$3E.Start},set_$y:function(n){this.$3E.Start=n;return n},get_$DE:function(){var n=this.$3E.Duration;return String.isInstanceOfType(n)?Number.parseInvariant(n):n},set_$DE:function(n){this.$3E.Duration=n;return n},get_$5R:function(){return $5(this.$3E.IsAllDayEvent)?!1:Boolean.parse(this.$3E.IsAllDayEvent)},set_$5R:function(n){this.$3E.IsAllDayEvent=n.toString();return n},$7az:function(n){$5(this.get_$y())||n.set_$y(this.get_$y());$5(this.get_$DE())||n.set_$20(n.get_$y().$9v(this.get_$DE()));$5(this.get_$5R())||n.set_$5R(this.get_$5R())}};_d.$FD=function(n,t,i,r,u,f){this.$$d_$7cR=Function.createDelegate(this,this.$7cR);this.$4C=new Sys.EventHandlerList;_d.$FD.initializeBase(this);if($5(t))throw Error.argumentNull("submitter");this.$b=i;this.$2M=f;this.$11X=t;this.$6Gm=u;this.$6Gs=r;this.$1DH={};this.$1LS=new(_a.$3f.$$(_c.$xS));$4tS(this,n)};function $4tS(n,t){var r=t.$2w(-n.$6Gs).$4D();var i=t.$2w(n.$6Gm).$4D();r.$4i(i)&&(i=i.$2w(1));n.$LF=new _h.$4i(r,i);_js.Trace.logInfo(_a.$0.$1p3,"NewCacheRange: Range:{0}",n.$LF)}function $3bp(n,t){$76v(n,t);if(t.get_$C()>0){_js.Trace.logInfo(_a.$0.$1p3,"Requesting FB:{0} - {1}",n.$LF,t.toString());var i=new _c.$xS(n.$LF.$2R,n.$LF.$3H,_d.$FD.$5VR,n.$b.get_$13().get_$jL(),t);n.$2M.$4Ve(i);i.add_$2t(n.$$d_$7cR);n.$1LS.$D(i);n.$11X.$11(i)}n.set_$40C(n.$1LS.get_$C()>0)}function $76v(n,t){for(var i=0;i<n.$1LS.get_$C();i++){var r=n.$1LS.get_$3o(i);var u=this;r.$10o.$Bd(function(n){t.$34(n)});if(!t.get_$C())return}}function $76u(n,t){var i=n.$4C.getHandler("CacheUpdateEventName");i&&i(t)}_d.$FD.prototype={$1LS:null,$6Gs:0,$6Gm:0,$2M:null,$11X:null,$b:null,$LF:null,$1DH:null,$2PL:!1,add_$2rC:function(n){this.$4C.addHandler("CacheUpdateEventName",n)},remove_$2rC:function(n){this.$4C.removeHandler("CacheUpdateEventName",n)},get_$40C:function(){return this.$2PL},set_$40C:function(n){if(this.$2PL!==n){this.$2PL=n;$N(this,"HasActiveRequests")}return n},$5mv:function(n){return this.$LF.$mb(n,!0,!1)},$6ne:function(n,t){if(!this.$5mv(n)){this.$4Wo(n);t&&$3bp(this,t)}},$ABO:function(n){for(var t=0;t<n.get_$C();t++){var i=n.get_$3o(t);this.$1DH[i.$VZ]=_c.$GL.$7jq(i,this.$LF)}},$hG:function(n,t){if(t){var i={};var r=this;n.$Bd(function(n){var t=r.$1DH[n];t&&(i[n]=t)});this.$1DH=i}$3bp(this,n)},$5bw:function(n){for(var t=0;t<n.get_$C();t++){var i=this.$1DH[n.get_$3o(t)];if(!i)return!1}return!0},$14Z:function(n){for(var i=new(_a.$3f.$$(_c.$GL)),r=new(_a.$3f.$$(String)),t=0;t<n.get_$C();t++){var u=this.$1DH[n.get_$3o(t)];u?i.$D(u):r.$D(n.get_$3o(t))}$3bp(this,r);return i},$4Wo:function(n){this.$1DH={};this.$1LS.$1t();this.set_$40C(!1);$4tS(this,n)},$7cR:function(n){var f=_a.$6.$1X(_a.$0.$1p3,"Scheduling.AvailabilityActionCompleted",!0);var t=n;t.remove_$2t(this.$$d_$7cR);if(!this.$1LS.$34(t)){_js.Trace.logInfo(_a.$0.$1p3,"Discarding FB results {0}-{1} {2} ",t.$74,t.$8Q,t.$10o);return}var i=t.$5VQ;if(t.$1d){_js.Trace.logError(_a.$0.$1p3,"{0} failed with the following error {1}",t.$1k_2,t.$1d.message);i=new _js.$c;var o=this;t.$10o.$Bd(function(n){i.$D(_c.$GL.$3oc(n))})}for(var u=0;u<i.get_$C();u++){var r=i.get_$3o(u);var e=this.$1DH[r.$VZ];e&&r.get_$GX().get_$2zD()==="None"||(this.$1DH[r.$VZ]=r)}this.set_$40C(this.$1LS.get_$C()>0);$76u(this,t.$10o);_a.$6.$19(f)}};_d.$Zv=function(n,t){this.$X4=n;this.$b=t};_d.$Zv.prototype={$X4:null,$b:null,$E:function(n,t){var i=this.$X4.get_$L()==="TouchNarrow"?0:1;var r=this.$7m5(n.$v.get_$y(),t);var u=this.$7lG(n.$v.get_$y(),t);return new _d.$4B(r,u,i,n,this.$b)},$7m5:function(n,t){return new _d.$FD(_a.$7.$Mb(n),OwaApplication.$1W,this.$b,7,14,t)},$7lG:function(n,t){return new _d.$FD(n,OwaApplication.$1W,this.$b,0,0,t)}};_d.$Lt=function(n,t,i,r,u){_d.$Lt.initializeBase(this);this.$Ek=n;this.$Ei=t;this.$KB=i;this.$7F=u;r&&this.$5ej()};function $3aO(n,t){var r=new _js.$c;if(t)for(var i=0;i<t.get_$C();i++)r.$D(t.get_$3o(i).get_$6u());return n.$7F.$mj(1,_y.$17.$1sN,r,3)}_d.$Lt.prototype={$6Wx:null,$6OU:null,$6Xd:null,$7F:null,$Ek:null,$Ei:null,$KB:null,$5ej:function(){this.$6Wx=$3aO(this,this.$Ek);this.$6OU=$3aO(this,this.$Ei);this.$6Xd=$3aO(this,this.$KB);$L8(this,"RequiredAttendeesRecipientWellViewModel","OptionalAttendeesRecipientWellViewModel","ResourcesRecipientWellViewModel")},get_$9pC:function(){return String.format(_nbs.NonBootStrings.l_RequiredAttendeesLabelAndCount_Text,this.$Ek.get_$C())},get_$9ej:function(){return String.format(_nbs.NonBootStrings.l_OptionalAttendeesLabelAndCount_Text,this.$Ei.get_$C())},get_$9q1:function(){return String.format(_nbs.NonBootStrings.l_ResourcesLabelAndCount_Text,this.$KB.get_$C())},get_$6g5:function(){return!!this.$KB&&this.$KB.get_$C()>0},get_$6g2:function(){return!!this.$Ek&&this.$Ek.get_$C()>0},get_$6fj:function(){return!!this.$Ei&&this.$Ei.get_$C()>0}};_d.$G0=function(n,t,i,r,u){_d.$G0.initializeBase(this);this.$7F=u;this.$Ti=new _d.$NP(n,t,i);r&&this.$5ew()};_d.$G0.$6dK=function(n,t){var i=n.$5B;i.$KF(1,t,0)};function $2kc(n,t,i){var o=new _js.$c;if(t)for(var u=0;u<t.get_$C();u++)o.$D(t.get_$3o(u).get_$6u());for(var r=n.$7F.$mj(1,_y.$17.$Km,o,3),f=0;f<i;f++)_d.$G0.$6dK(r.$1U.get_$3o(f),_nbs.NonBootStrings.l_AttendeeDetailsRequired_Text);for(var e=i;e<r.$1U.get_$C();e++)_d.$G0.$6dK(r.$1U.get_$3o(e),_nbs.NonBootStrings.l_AttendeeDetailsOptional_Text);return r}_d.$G0.prototype={$7F:null,$Ti:null,$59C:null,$6js:null,$5No:null,$6GC:null,get_$3gU:function(){return this.$Ti.get_$3gU()},get_$4fd:function(){return this.$Ti.get_$4fd()},get_$3qx:function(){return this.$Ti.get_$3qx()},get_$4N7:function(){return this.$Ti.get_$4N7()},get_$6ei:function(){return this.$Ti.$q6.get_$C()>0},get_$6f7:function(){return this.$Ti.$qy.get_$C()>0},get_$6gT:function(){return this.$Ti.$vI.get_$C()>0},get_$6fe:function(){return this.$Ti.$to.get_$C()>0},$5ew:function(){this.$59C=$2kc(this,this.$Ti.$q6,this.$Ti.$59D);this.$6js=$2kc(this,this.$Ti.$vI,this.$Ti.$6jt);this.$5No=$2kc(this,this.$Ti.$qy,this.$Ti.$5Np);this.$6GC=$2kc(this,this.$Ti.$to,this.$Ti.$6GD);$He(this,["AcceptedAttendeesRecipientWellViewModel","TentativelyAcceptedAttendeesRecipientWellViewModel","DeclinedAttendeesRecipientWellViewModel","NoResponseReceivedAttendeesRecipientWellViewModel"])}};_d.$Lu=function(n,t,i){this.$$d_$A01=Function.createDelegate(this,this.$A01);_d.$Lu.initializeBase(this);this.$7F=t;this.$JG=n;if(this.$JG.get_$JC()){this.$1n9=!i;this.$1n9&&(this.$4bf=new _C(this.$$d_$A01,_a.$0.$3lE));this.get_$5GU()?$6y7(this):$6y6(this)}};function $6y7(n){n.$2qH=new _d.$G0(n.$JG.get_$7G().get_$AIt(),n.$JG.get_$8D().get_$AIt(),n.$JG.get_$9F().get_$AIt(),!n.$1n9,n.$7F)}function $6y6(n){n.$2qG=new _d.$Lt(n.$JG.get_$7G().get_$AIt(),n.$JG.get_$8D().get_$AIt(),n.$JG.get_$9F().get_$AIt(),!n.$1n9,n.$7F)}_d.$Lu.prototype={$2qG:null,$2qH:null,$JG:null,$7F:null,$1n9:!1,$4bf:null,get_$5GU:function(){return this.$JG.get_$Hq()&&this.$JG.get_$EE()},get_$9zp:function(){return this.$1n9},set_$9zp:function(n){this.$1n9=n;$3(this,"ShowAllAttendeesButton");return n},$A01:function(){this.set_$9zp(!1);this.$4bf.set_$69(!1);if(this.$2qG){this.$2qG.$5ej();return}if(this.$2qH){this.$2qH.$5ew();return}}};_d.$WJ=function(n){this.$X4=n};function $6y8(n,t){var i=t.get_$7G()?t.get_$7G().get_$C():0;i+=t.get_$8D()?t.get_$8D().get_$C():0;i+=t.get_$9F()?t.get_$9F().get_$C():0;if(n.$X4.get_$L()==="Mouse"){if(i>=100)return!1}else if(i>=50)return!1;return!0}_d.$WJ.prototype={$X4:null,$7F:null,$E:function(n){return new _d.$Lu(n,this.$7F,$6y8(this,n))}};_d.$NP=function(n,t,i){_d.$NP.initializeBase(this);$6yF(this,n,t,i)};function $6yF(n,t,i,r){n.$q6=new _js.$c;n.$vI=new _js.$c;n.$qy=new _js.$c;n.$to=new _js.$c;var u,f,e,o;$3aS(n,r,u={val:n.$q6},f={val:n.$vI},e={val:n.$qy},o={val:n.$to});n.$q6=u.val;n.$vI=f.val;n.$qy=e.val;n.$to=o.val;var s,h,c,l;$3aS(n,t,s={val:n.$q6},h={val:n.$vI},c={val:n.$qy},l={val:n.$to});n.$q6=s.val;n.$vI=h.val;n.$qy=c.val;n.$to=l.val;n.$59D=n.$q6.get_$C();n.$6jt=n.$vI.get_$C();n.$5Np=n.$qy.get_$C();n.$6GD=n.$to.get_$C();var a,v,y,p;$3aS(n,i,a={val:n.$q6},v={val:n.$vI},y={val:n.$qy},p={val:n.$to});n.$q6=a.val;n.$vI=v.val;n.$qy=y.val;n.$to=p.val}function $3aS(n,t,i,r,u,f){if(!$5(t))for(var o=0;o<t.get_$C();o++){var e=t.get_$3o(o);switch(e.get_$Th()){case"Accept":case"Organizer":i.val.$D(e);break;case"Tentative":r.val.$D(e);break;case"Decline":u.val.$D(e);break;default:f.val.$D(e);break}}}_d.$NP.prototype={$q6:null,$vI:null,$qy:null,$to:null,$59D:0,$6jt:0,$5Np:0,$6GD:0,get_$3gU:function(){return String.format(_nbs.NonBootStrings.l_AcceptedAttendeesLabelAndCount_Text,this.$q6.get_$C())},get_$4fd:function(){return String.format(_nbs.NonBootStrings.l_TentativelyAcceptedAttendeesLabelAndCount_Text,this.$vI.get_$C())},get_$3qx:function(){return String.format(_nbs.NonBootStrings.l_DeclinedAttendeesLabelAndCount_Text,this.$qy.get_$C())},get_$4N7:function(){return String.format(_nbs.NonBootStrings.l_NoResponseReceivedAttendeesLabelAndCount_Text,this.$to.get_$C())}};_d.$P9=function(){_d.$P9.initializeBase(this)};_d.$P9.prototype={get_$5Q:function(){return this.$W(_d.$P9.$1sw)},set_$5Q:function(n){this.$M(_d.$P9.$1sw,n);return n},get_$26V:function(){return[this.get_$5Q()]},get_$4Td:function(){return null}};_d.$3d=function(n,t,i,r,u,f,e,o,s,h,c,l){this.$$d_$82B=Function.createDelegate(this,this.$82B);this.$$d_$82C=Function.createDelegate(this,this.$82C);this.$$d_$AAc=Function.createDelegate(this,this.$AAc);this.$$d_$AAb=Function.createDelegate(this,this.$AAb);this.$$d_$6kc=Function.createDelegate(this,this.$6kc);this.$$d_$2sc=Function.createDelegate(this,this.$2sc);this.$$d_$7iW=Function.createDelegate(this,this.$7iW);this.$$d_$829=Function.createDelegate(this,this.$829);this.$$d_$82A=Function.createDelegate(this,this.$82A);this.$$d_$3xF=Function.createDelegate(this,this.$3xF);this.$$d_$3Ju=Function.createDelegate(this,this.$3Ju);this.$$d_$6Qb=Function.createDelegate(this,this.$6Qb);this.$$d_$3Jw=Function.createDelegate(this,this.$3Jw);this.$$d_$4PX=Function.createDelegate(this,this.$4PX);this.$$d_$6E=Function.createDelegate(this,this.$6E);_d.$3d.resolveInheritance();this.apcl=this.$Y;this.rpcl=this.$q;this.dispose=this.$1R;_d.$3d.initializeBase(this);this.$1wi=l;this.$44J=c;this.$Je=n;this.$39S=t;this.$RQ=i;this.$1OH=o;this.$B=r;this.$95=u;this.$2qJ=f;this.$5q=e;this.$k=s;this.$1A=h;this.$cG=new _y.$iW;this.$bi=new _d.$QK(this.$$d_$6E,!this.$B.get_$FG()&&this.$B.get_$L()==="Mouse"&&this.$B.get_$9l());this.$B.get_$L()==="TouchNarrow"&&this.set_$6k(_y.$22.$E(this));this.$Y("IsTransitionedIn",_d.$3d.$2JQ);this.$Y("IsInitialized",_d.$3d.$2JQ)};_d.$3d.$2JQ=function(n,t){var i=n;if(i.$EF&&i.$7j){$BF(i,"Ready",i,i);i.$J6.$9K4()}};function $6z7(n,t){n.set_$1sy(n.$Je.$8V(t));n.set_$5kU(!0)}function $6yw(n){if(n.$B.get_$L()!=="Mouse")throw Error.invalidOperation("Calendar Item Details View can only be popped out in a new browser window in MUI");if(!n.$B.get_$9l())throw Error.invalidOperation("Calendar Item Details View can only be popped out from the main window");}function $6z5(n){var t=new _d.$zw(n.$5q);t.$e1=5;t.$4Sr=_y.$17.$Km;return t}function $6yy(n,t){t&&n.$p.$v.get_$JC()&&n.$p.$v.get_$Vv()&&t.$KF(1,n.$p.$v.get_$Vv().$2b(4),0)}function $3aa(n){if(n.$6l){n.get_$4h()&&_js.$9.isInstanceOfType(n.get_$4h())&&n.get_$4h().$q("ActiveNavigationStack",n.$$d_$7iW);n.$6l.$78();n.$6l=null}}function $6yx(n){n.$4f=new _C(n.$$d_$2sc,_d.$3d.$A);n.$Q2=n.$p.$h0.$ic(0,!1,n.$$d_$2sc);n.$1Ha=n.$p.$h0.$ic(1,!0,n.$$d_$2sc);n.$A8D=new _C(n.$$d_$6kc,_d.$3d.$A);n.$3Wp=new _C(n.$$d_$AAb,_a.$0.$1c);n.$3Wq=new _C(n.$$d_$AAc,_a.$0.$1c)}function $4pk(n,t){var i;i=t?n.$$d_$82C:n.$$d_$82B;n.$f9=n.$95.$1cp(300,n.$p.$v.get_$i(),i,n.$$d_$82A,n.$MV,n.$$d_$829,"HTML","unblockMode");n.$p.$v.set_$fx(!1);n.$p.$v.set_$qP(!1)}function $6z9(n){var t=n.$p.$v.get_$3M();if(t&&t.get_$3s()!=="HTML"){var i=_js.$8.$4B("BodyType should always be HTML on CalendarItemDetailsView. Current BodyType: {0}",t.get_$3s());_js.Trace.logWarning(n.get_$1a(),i)}if(!n.$B.get_$FG()){n.$6l=n.$RQ.$5Kj(n.$p.$v);n.$6l.$5m();n.get_$4h()&&_js.$9.isInstanceOfType(n.get_$4h())&&n.get_$4h().$Y("ActiveNavigationStack",n.$$d_$7iW)}$4pl(n);n.set_$2xp(n.$1OH.$E(n.$p,n.$$d_$2sc,$6z5(n),n.$6l,n.$b5,n.$3Wp,n.$3Wq));n.$J6.$3m=n.get_$4h();var r=this;n.$J6.$b5.add_$9V5(function(){$4pl(n);$4pm(n);n.$J6.$ACe(n.$b5)});n.set_$3kq(new _d.$G5(n.$p.$5p));$4pm(n)}function $6yz(n){var t=[];Array.add(t,new _a.$5V(_nbs.NonBootStrings.l_EventDetailsTitle_Text,n.$J6));if(!n.$B.get_$FG()&&n.$p.$v.get_$JC()){n.set_$7cB(n.$2qJ.$E(n.$p.$v));Array.add(t,new _a.$5V(_nbs.NonBootStrings.l_AttendeeDetailsTitle_Text,n.$2qI))}n.$b5.get_$T1()&&Array.add(t,new _a.$5V(_nbs.NonBootStrings.l_LocationDetailsTitle_Text,n.$b5));n.set_$4TG(t)}function $4pl(n){n.set_$39U(n.$39S.$E(n.get_$4h(),n.$p.$v.get_$4g(),n.$B.get_$L()));n.$1xN=new _C(n.$b5.$$d_$1xn,_d.$3d.$A)}function $4pm(n){$6yz(n);n.$B.get_$L()==="TouchNarrow"&&$6z8(n)}function $6z6(n,t){return Object.getType(n.$Wo[t].$z)}function $6z8(n){var t;var i;if(n.$B.get_$FG()||!n.$p.$v.get_$12n()){t=$6z0(n);i=$6z1(n)}else{t=n.$p.$5p.get_$fH()?$6z3(n):$6z2(n);i=n.$p.$5p.get_$fH()?$6z4(n):$4pi(n)}n.$3y.set_$I3(t);n.$3y.set_$bB(i)}function $6z2(n){var t=[];var r=this;var i=$4pj(n,function(n){return new _y.$2Q(_y.$d.get_$29z(),_y.$d.get_$6Wj(),_u.Strings.l_Reply_LowerCase_Text,null,n)});i&&Array.add(t,i);n.$p.$v.get_$Ue()||n.$p.$5p.get_$Vp()?Array.add(t,new _y.$2Q(_y.$d.get_$xE(),_y.$d.get_$xF(),_u.Strings.l_DeleteItem_LowerCase_Text,n.$Bt.$2dY)):Array.add(t,new _y.$2Q(_y.$d.get_$xE(),_y.$d.get_$xF(),_u.Strings.l_DeleteItem_LowerCase_Text,n.$p.$Rg.$r5));return t}function $6z3(n){var t=[];Array.add(t,new _y.$2Q(_y.$d.get_$cn(),_y.$d.get_$2MX(),_nbs.NonBootStrings.l_EditItemMobile_Text,n.$Q2));n.$p.$5p.get_$Vp()?Array.add(t,new _y.$2Q(_y.$d.get_$xE(),_y.$d.get_$xF(),_u.Strings.l_DeleteItem_LowerCase_Text,n.$Bt.$2dY)):n.$p.$5p.get_$iN()&&Array.add(t,new _y.$2Q(_y.$d.get_$xE(),_y.$d.get_$xF(),_nbs.NonBootStrings.l_CancelItemMobile_Text,n.$Bt.$2rk));return t}function $4pj(n,t){var i=[];n.$p.$v.get_$fJ()&&Array.add(i,new _y.$32(_u.Strings.l_Reply_LowerCase_Text,n.$p.$Qj.$Ir));n.$p.$v.get_$iP()&&Array.add(i,new _y.$32(_u.Strings.l_ReplyAll_LowerCase_Text,n.$p.$Qj.$JT));n.$p.$v.get_$fI()&&Array.add(i,new _y.$32(_u.Strings.l_Forward_LowerCase_Text,n.$p.$Qj.$IN));if(i.length<=0)return null;if(i.length===1)return i[0];return t(i)}function $6z4(n){var r=this;var i=$4pj(n,function(n){return new _y.$32(_u.Strings.l_Reply_LowerCase_Text,null,n)});var t=[];i&&Array.add(t,i);Array.addRange(t,$4pi(n));return t}function $4pi(n){var t=[];n.$1Ha.$2T&&Array.add(t,new _y.$32(_nbs.NonBootStrings.l_OpenSeries_LowerCase_Text,n.$1Ha));n.$b5.get_$T1()&&Array.add(t,new _y.$32(_nbs.NonBootStrings.l_GetDirections_LowerCase_Text,n.$1xN));n.$B.get_$L()!=="Mouse"&&n.$p.$v.get_$wV()&&Array.add(t,new _y.$32(_nbs.NonBootStrings.l_JoinOnlineMeeting_LowerCase_Text,n.$p.$b1));return t}function $6z1(n){return n.$1Ha.$2T?[new _y.$32(_nbs.NonBootStrings.l_OpenSeries_LowerCase_Text,n.$1Ha)]:new Array(0)}function $6z0(n){return new Array(0)}_d.$3d.prototype={$Je:null,$39S:null,$RQ:null,$B:null,$2qJ:null,$5q:null,$bi:null,$95:null,$1OH:null,$k:null,$1A:null,$44J:!0,$1wi:!0,$f9:null,$Q2:null,$4f:null,$1Ha:null,$A8D:null,$1xN:null,$3Wp:null,$3Wq:null,$7j:!1,$20p:!1,$3Hz:!1,$bv:0,$5lA:!1,$p:null,$cG:null,$Wo:null,$J6:null,$b5:null,$2qI:null,$Bt:null,$6l:null,$DC:null,$MV:null,add_$6MS:function(n){this.$2G("Ready",n)},remove_$6MS:function(n){this.$2H("Ready",n)},get_$4h:function(){return _y.$1Mq.prototype.get_$4h.call(this)},set_$4h:function(n){_y.$1Mq.prototype.set_$4h.call(this,n);this.$J6&&(this.$J6.$3m=n);this.$b5&&(this.$b5.$3m=n);return n},get_$20Z:function(){return this.$B.get_$L()==="Mouse"},get_$A1p:function(){return this.$p.$Rg.get_$1ZY()||this.$p.$5p.get_$fH()||this.$p.$5p.get_$Vp()||this.$p.$5p.get_$iN()},get_$1sy:function(){return this.$p},set_$1sy:function(n){if(this.$p===n)return n;if(this.$p){this.$p.$Rg.remove_$1Y4(this.$$d_$4PX);this.$p.$5p.remove_$2t(this.$$d_$3Jw);this.$p.$v.$q("IsPrivate",this.$$d_$6Qb);this.$p.$v.$q("FreeBusyType",this.$$d_$6Qb);this.$p.$v.$q("Categories",this.$$d_$6Qb);this.$p.$q("ReminderSelectedValue",this.$$d_$6Qb);this.$p.$v.$q("InboxReminders",this.$$d_$6Qb)}this.$p=n;if(this.$p){$6yx(this);$6z9(this);this.$p.$Rg.add_$1Y4(this.$$d_$4PX);this.$p.$5p.add_$2t(this.$$d_$3Jw);this.$p.$v.$Y("IsPrivate",this.$$d_$6Qb);this.$p.$v.$Y("FreeBusyType",this.$$d_$6Qb);this.$p.$v.$Y("Categories",this.$$d_$6Qb);this.$p.$Y("ReminderSelectedValue",this.$$d_$6Qb);this.$p.$v.$Y("InboxReminders",this.$$d_$6Qb)}$3(this,"CalendarItemViewModel");return n},get_$1I2:function(){return this.$bi.$28w},get_$eS:function(){return this.$bi.$4cE},get_$4TG:function(){return this.$Wo},set_$4TG:function(n){if(this.$Wo!==n){this.$Wo=n;$3(this,"PivotSelectionOptions")}return n},get_$2xp:function(){return this.$J6},set_$2xp:function(n){if(this.$J6!==n){this.$J6&&this.$J6.$1R();this.$J6=n;this.$J6&&$6yy(this,this.$J6.$10H);$3(this,"EventDetailsViewModel")}return n},get_$7cB:function(){return this.$2qI},set_$7cB:function(n){if(this.$2qI!==n){this.$2qI=n;$3(this,"AttendeeDetailsViewModel")}return n},get_$39U:function(){return this.$b5},set_$39U:function(n){if(this.$b5!==n){this.$b5=n;$3(this,"LocationViewModel")}return n},get_$3kq:function(){return this.$Bt},set_$3kq:function(n){if(this.$Bt!==n){this.$Bt=n;$3(this,"CalendarConfirmDialogViewModel")}return n},get_$D2:function(){return this.$7j},set_$D2:function(n){if(this.$7j!==n){this.set_$5kU(n);this.$7j=n;$3(this,"IsInitialized")}return n},get_$5kU:function(){return this.$20p},set_$5kU:function(n){if(this.$20p!==n){this.$20p=n;$3(this,"IsPartiallyInitialized")}return n},get_$9J0:function(){return this.$3Hz},set_$9J0:function(n){if(this.$3Hz!==n){this.$3Hz=n;$3(this,"PopupPanelSize")}return n},get_$1kp:function(){return this.$B.get_$L()==="TouchWide"?4:this.$3Hz?1:0},get_$2PH:function(){return this.$$d_$3Ju},get_$7c:function(){return this.$DC},set_$7c:function(n){this.$DC=n;return n},get_$7sU:function(){return!0},get_$6fp:function(){return this.$7j||this.$20p},get_$1mV:function(){return this.$bv},set_$1mV:function(n){if(this.$bv!==n){this.$bv=n;$3(this,"SelectedPivotIndex")}return n},get_$KN:function(){return this.$B.get_$L()==="TouchNarrow"?_y.$1Mq.prototype.get_$KN.call(this):0},get_$jp:function(){return this.$1A.get_$Vk().get_$jp()},get_$1a:function(){return _a.$0.$6y},$42U:function(n){this.set_$D2(!1);var t=null;this.$5lA=n.get_$5lB();t=this.$82D(n.get_$3tV());if(t){$6z7(this,t);this.$J6.set_$4c2(!0)}this.$f9=this.$95.$1cp(300,n.get_$3tV(),this.$$d_$3xF,this.$$d_$82A,n.get_$149(),this.$$d_$829,"HTML",n.get_$2zh())},$5es:function(n){this.set_$1sy(this.$Je.$8V(n));var t=n.get_$5V();t&&t.get_$Mj()&&(this.$MV=t.get_$AX());this.set_$D2(!0)},$9th:function(n){for(var i=new _d.$15a,r=i.$2x(n),t=0;t<this.$Wo.length;t++)if($6z6(this,t)===r){this.set_$1mV(t);return}this.set_$1mV(0)},$2sc:function(){if(!this.$44J){_js.Trace.logInfo(this.get_$1a(),"Omitting close action as it is not allowed for this CalendarItemDetailsView.");return}this.get_$7c()();this.$1R()},$82D:function(n){return this.$95.$1cr(n)},$1HR:function(){$3aa(this);_y.$1Mq.prototype.$1HR.call(this)},$6E:function(){_a.$6.$1X(this.get_$1a(),"PopoutCalendarReadingPane");$6yw(this);var n=new _d.$P9;n.set_$5Q(this.$p.$6c);this.$2sc();this.$B.$N3(_d.$It,null,null,_y.$48.get_$iy(),n,!1);_a.$6.$19(null,"PopoutCalendarReadingPane")},$3Jw:function(n,t){(n==="RemoveCalendarItemAction"||n==="CancelCalendarItemAction"||n==="AddCalendarItemToMyCalendarAction")&&this.$2sc()},$49:function(){this.$f9&&this.$f9.$1R();$3aa(this);if(this.$p){this.$p.$1R();this.set_$1sy(null)}this.set_$2xp(null);_a.$1.prototype.$49.call(this)},$6kc:function(){this.$p.$v.set_$dB(!this.$p.$v.get_$dB())},$AAb:function(){$4pk(this,!1)},$82B:function(n){this.$3xF(n);var t=new _h.$uQ(this.$p.$v);this.$k.$11(t)},$AAc:function(){$4pk(this,!0)},$82C:function(n){this.$3xF(n);var t=new _h.$nu(this.$p.$v);this.$k.$11(t)},$3xF:function(n){this.$5es(n)},$82A:function(n){_cc.$5o.$3x1(n,this.$$d_$2sc);this.set_$D2(!1)},$829:function(){this.$J6&&this.$J6.set_$4c2(!1)},$4PX:function(n){this.$2sc()},$6Qb:function(n,t){this.$p.$5p.$BS()},$7iW:function(n,t){t!=="ActiveNavigationStack"||this.get_$4h().get_$8o()&&this.get_$4h().get_$8o().get_$C()||$3aa(this)},$3Ju:function(n,t){this.$J6&&this.$J6.$3Ju();this.$1R();return!1}};_d.$It=function(n,t,i,r,u,f,e,o,s,h){this.$Je=n;this.$39S=t;this.$RQ=i;this.$2qJ=r;this.$5q=u;this.$B=e;this.$95=f;this.$1OH=o;this.$k=s;this.$1A=h};_d.$It.prototype={$1OH:null,$Je:null,$39S:null,$RQ:null,$2qJ:null,$5q:null,$B:null,$95:null,$k:null,$1A:null,get_$3kf:function(){return this.$95},get_$128:function(){return this.$k},$br:function(n,t,i,r,u){var f=this.$2Qt(i,r===undefined?!0:r,u===undefined?!0:u);f.$42U(new _y.$9S(n));return f},$9qL:function(n,t,i,r){return this.$br(n,t,null,i,r)},$wx:function(n,t){return this.$3om(n.get_$5Q())},$3om:function(n,t){var i=this.$2Qt(t,!0,!0);i.$5es(n);return i},$2Qt:function(n,t,i){var r=new _d.$3d(this.$Je,this.$39S,this.$RQ,this.$B,this.get_$3kf(),this.$2qJ,this.$5q,this.$1OH,this.get_$128(),this.$1A,t,i);n&&r.add_$6MS(n);return r}};_d.$5z=function(n,t,i,r,u,f,e){this.$$d_$9Xb=Function.createDelegate(this,this.$9Xb);this.$$d_$9Yy=Function.createDelegate(this,this.$9Yy);this.$$d_$9Yx=Function.createDelegate(this,this.$9Yx);this.$$d_$9LJ=Function.createDelegate(this,this.$9LJ);this.$$d_$7eO=Function.createDelegate(this,this.$7eO);this.$$d_$7eP=Function.createDelegate(this,this.$7eP);this.$$d_$3Jw=Function.createDelegate(this,this.$3Jw);this.$$d_$4PX=Function.createDelegate(this,this.$4PX);this.$$d_$4O=Function.createDelegate(this,this.$4O);_d.$5z.initializeBase(this);this.$95=u;this.$B=i;this.$5q=t;this.$1OH=f;this.$15Z=e;this.$Cn=r;this.$4f=new _C(this.$$d_$4O,_a.$0.$1c);this.$x=new _y.$5u;this.set_$1sy(n)};function $4pr(n){n.$p.$Rg.add_$1Y4(n.$$d_$4PX);n.$p.$5p.add_$2t(n.$$d_$3Jw)}function $4ps(n){n.$p.$Rg.remove_$1Y4(n.$$d_$4PX);n.$p.$5p.remove_$2t(n.$$d_$3Jw)}function $6zJ(n){if(!n.$p.$v.get_$yR()&&n.$p.$v.get_$1MQ()&&n.$p.$v.get_$1c().get_$KZ().Read){var i=null;var t=n.$p.$v.get_$5V();t&&t.get_$Mj()&&(i=t.get_$AX());n.$f9=n.$95.$1cp(300,n.$p.$v.get_$i(),n.$$d_$7eP,n.$$d_$7eO,i)}}function $4pt(n){n.set_$2xp(n.$1OH.$7lr(n.$p,n.$$d_$9LJ,$6zG(n)));if(n.$p.$v.get_$yR()){var t=n.$p.$h0;n.set_$9eU(t.$ic(1,!1,n.$$d_$9LJ,n.$$d_$9Yx));n.$p.$v.get_$4g()&&n.$p.$v.get_$4g().$T1()&&n.set_$9eV(t.$ic(1,!1,n.$$d_$9LJ,n.$$d_$9Yy));var i=new _d.$PA(n.$p.$v,n.$2b8,n.$x,n.$Cn);i.$19y();if(n.$p.$v.get_$EE()){n.set_$9qC(new _d.$NP(n.$p.$v.get_$7G().get_$AIt(),n.$p.$v.get_$8D().get_$AIt(),n.$p.$v.get_$9F().get_$AIt()));$6zH(n)}}}function $6zH(n){n.set_$8D9(n.$15Z&&_cc.$JN.$3yc(n.$p.$v).get_$C()>0);if(n.$2PW){var t=this;n.set_$9e8(n.$p.$h0.$ic(0,!1,function(){n.$4O()}))}}function $4pq(n,t,i){t.$9th(i)}function $6zI(n){n.$2Eb=n.$p.$5p.get_$12n()?n.$p.$v.get_$Hq()?1:2:3}function $6zF(n,t){t&&n.$2Eb!==1&&t.$KF(1,n.get_$7cE(),0)}function $6zK(n,t){t&&n.$B.get_$L()==="TouchWide"&&t.$Y("IsPersonaCardShown",n.$$d_$9Xb)}function $6zL(n,t){t&&n.$B.get_$L()==="TouchWide"&&t.$q("IsPersonaCardShown",n.$$d_$9Xb)}function $6zG(n){var t=new _d.$zw(n.$5q);var i=_y.$17.$1sN;n.$2Eb!==1&&(i=_y.$17.$Km);t.$4Sr=i;t.$e1=3;return t}_d.$5z.prototype={$B:null,$5q:null,$4f:null,$x:null,$Cn:null,$1OH:null,$15Z:!1,$p:null,$f9:null,$30:!1,$2b8:null,$3Kh:null,$Ti:null,$J6:null,$95:null,$3KX:null,$2PW:!1,$2Eb:0,get_$1O:function(){return this.$30},set_$1O:function(n){if(this.$30===n)return n;this.$30=n;this.$30&&$6zJ(this);$3(this,"IsShown");return n},get_$A07:function(){return this.$p.$v.get_$iN()&&!this.$p.$v.get_$az()},get_$A02:function(){return!this.$p.$v.get_$az()||!this.$p.$v.get_$wV()},get_$1sy:function(){return this.$p},set_$1sy:function(n){this.$p&&$4ps(this);this.$p=n;if(this.$p){$6zI(this);$4pr(this);this.$p.$Rg.set_$9zv(!this.$p.$v.get_$wV());$4pt(this)}return n},get_$2xp:function(){return this.$J6},set_$2xp:function(n){if(this.$J6!==n){if(this.$J6){$6zL(this,this.$J6.$10H);this.$J6.$1R()}this.$J6=n;if(this.$J6){$6zF(this,this.$J6.$10H);$6zK(this,this.$J6.$10H)}$3(this,"EventDetailsViewModel")}return n},get_$9qC:function(){return this.$Ti},set_$9qC:function(n){if(this.$Ti!==n){this.$Ti=n;$3(this,"ResponseTypeManagerViewModel")}return n},get_$5rb:function(){return 420},get_$zu:function(){return 320},get_$9eU:function(){return this.$2b8},set_$9eU:function(n){if(this.$2b8!==n){this.$2b8=n;$3(this,"OpenReadFormOnAttendeesPivotCommand")}return n},get_$9eV:function(){return this.$3Kh},set_$9eV:function(n){if(this.$3Kh!==n){this.$3Kh=n;$3(this,"OpenReadFormOnLocationPivotCommand")}return n},get_$5hr:function(){return!!this.$p&&!this.$p.get_$1Q9()&&this.$p.$v.get_$7fR()&&this.$B.get_$L()!=="TouchNarrow"},get_$9e8:function(){return this.$3KX},set_$9e8:function(n){if(this.$3KX!==n){this.$3KX=n;$3(this,"OpenCalendarCompose")}return n},get_$8D9:function(){return this.$2PW},set_$8D9:function(n){if(this.$2PW!==n){this.$2PW=n;$3(this,"HasNewTimeProposed")}return n},get_$7cE:function(){var n=_cc.$Cp.$3z3(this.$p.$v);return n?_js.$8.$4B(_nbs.NonBootStrings.l_AttendeesInvitedLabel_Text,n):""},$9LJ:function(){this.$4O()},$9Yx:function(n){$4pq(this,n,1)},$9Yy:function(n){$4pq(this,n,2)},$4O:function(){this.set_$1O(!1)},$9Xb:function(n,t){this.$4O()},$7eP:function(n){$4ps(this);this.$p.$ABR(n);$4pr(this);$4pt(this);$3(this,"FullItemLoaded")},$7eO:function(n){var i=n.responseCode;if(i&&i.toString()==="ErrorAccessDenied"){_js.Trace.logInfo(_a.$0.$6y,"Calendar Peek - Failed to load full calendar item because of access denied");return}var t="Calendar Peek - Failed to load full calendar item";n&&(t=String.format("{0}: {1}",t,n.message));_js.Trace.logWarning(_a.$0.$6y,t)},$4PX:function(n){this.$4O()},$3Jw:function(n,t){(n==="RemoveCalendarItemAction"||n==="CancelCalendarItemAction"||n==="AddCalendarItemToMyCalendarAction")&&this.$4O()},$49:function(){this.set_$2xp(null);this.set_$1sy(null);this.$f9&&this.$f9.$1R();_a.$1.prototype.$49.call(this)}};_d.$j5=function(n,t,i,r,u,f){this.$B=t;this.$Cn=i;this.$95=r;this.$5q=n;this.$1OH=u;this.$4U=f};_d.$j5.prototype={$B:null,$95:null,$Cn:null,$5q:null,$1OH:null,$4U:null,$E:function(n){return new _d.$5z(n,this.$5q,this.$B,this.$Cn,this.$95,this.$1OH,this.$4U.$3N("ProposeNewTime"))}};_d.$PA=function(n,t,i,r){_d.$PA.initializeBase(this,[i]);this.$JG=n;this.$Cn=r;this.$4jB=t};function $6zE(n,t,i){if(t.get_$Hq()&&t.get_$JC()&&!t.get_$EE()&&i.$2T){var r=n.$4jB.get_$MT();n.$x.$ID(1500,null,_nbs.NonBootStrings.l_ViewInvitedAttendeesInfobar_Text,r)}}_d.$PA.prototype={$JG:null,$4jB:null,$Cn:null,$8Rn:function(){this.$TX=[1500,1600,1800,2e3,1200,1700,1900,2100]},$80c:function(){if(!this.$JG.get_$az()){$6zE(this,this.$JG,this.$4jB);$4o6(this,this.$JG,this.$Cn)}$4o7(this,this.$JG)}};_d.$13z=function(n,t){_d.$13z.initializeBase(this);this.$IX=n;this.$B=t};_d.$13z.prototype={$IX:null,$B:null,$TO:function(n){_js.$J.get_$I().$19I(_a.$0.$l,_y.$CW.$3Kl(n.get_$3w()));_a.$6.acsa(_a.$0.$4h,"VM.MailCompose.Navigate");this.$YI=!1;if(this.$B.get_$9l()){n.get_$66()===1&&n.set_$66(0);this.$B.$N3(IMailComposeViewModelFactory,null,null,_y.$48.get_$T4(),n,!0)}else{var t=this.$IX.$wx(n,null);this.$B.$fj(t,1,!0)}}};_d.$j7=function(n,t){this.$$d_$E=Function.createDelegate(this,this.$E);this.$IX=n;this.$B=t};_d.$j7.prototype={$IX:null,$B:null,$E:function(n,t){return n&&t===1?n:new _d.$13z(this.$IX,this.$B)}};_d.$cL=function(n,t,i,r,u,f,e,o,s,h){_d.$cL.initializeBase(this,[u,o,s]);this.$JG=n;this.$Cn=f;this.$4jI=t;this.$3Wp=i;this.$3Wq=r;this.$1XR=e;this.$15Z=h};function $715(n){if(n.$JG.get_$JF())n.$x.$2j(4810);else if(n.$JG.get_$Gj()&&n.$4jI.$2T){var t=n.$4jI.get_$MT();n.$x.$ID(4710,null,_nbs.NonBootStrings.l_ViewSeries_Text,t)}}function $714(n){if(n.$JG.get_$fx()&&!n.$1XR){var t=n.$3Wp.get_$MT();n.$x.$ID(7700,null,_u.Strings.l_ClickHere_Text,t);var i=n.$3Wq.get_$MT();n.$x.$ID(7750,null,_u.Strings.l_ClickHere_Text,i)}}_d.$cL.prototype={$JG:null,$Cn:null,$4jI:null,$3Wp:null,$3Wq:null,$1XR:0,$15Z:!1,$8Rn:function(){this.$TX=[1200,2200,1100,1600,1800,2e3,1300,1400,1700,1900,2100,4810,4710,7700,7750,6701,6702]},$80c:function(){if(!this.$JG.get_$az()){$4o6(this,this.$JG,this.$Cn);$4o5(this,this.$JG)}$4o7(this,this.$JG);$3a5(this,this.$JG);$4o8(this,this.$JG,this.$JG.get_$WK());$715(this);$714(this);this.$15Z&&$4o9(this,this.$JG.get_$i(),_cc.$JN.$3yc(this.$JG))}};_d.$65=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p){this.$$d_$3Iv=Function.createDelegate(this,this.$3Iv);this.$$d_$4OE=Function.createDelegate(this,this.$4OE);this.$$d_$3Jw=Function.createDelegate(this,this.$3Jw);this.$$d_$8PR=Function.createDelegate(this,this.$8PR);this.$$d_$9J=Function.createDelegate(this,this.$9J);this.$$d_$34=Function.createDelegate(this,this.$34);this.$$d_$cn=Function.createDelegate(this,this.$cn);this.$$d_$5An=Function.createDelegate(this,this.$5An);this.$$d_$6kc=Function.createDelegate(this,this.$6kc);_d.$65.initializeBase(this);this.$1jW=t;this.$p=n;this.$B=u;this.$6l=f;this.$22c=e;this.$1st=h;this.$1H=v;this.$3m=null;this.$p.$v.get_$Gj()&&!this.$B.get_$FG()&&(this.$28R=this.$p.$1aY());this.$b5=new _cc.$EQ(this.$p.$v.get_$4g(),null,r,this.$B,!!this.$22c);this.$1x0=_d.$R8.$5L6();this.$29o=_d.$R8.$3pR(this.$p);this.$A8K=new _C(this.$$d_$6kc,_a.$0.$1c);this.$3he=new _C(this.$$d_$5An,_a.$0.$1c);this.$Q2=new _C(this.$$d_$cn,_a.$0.$1c);this.$Jm=new _C(this.$$d_$34,_a.$0.$1c);this.$7I=new _C(this.$$d_$9J,_a.$0.$1c);this.$3tO=this.$p.$h0.$ic(0,!1,this.$1jW);this.$6OE=this.$p.$h0.$ic(1,!1,this.$1jW);this.$3Kk=this.$p.$h0.$ic(1,!0,this.$1jW);this.set_$3kq(new _d.$G5(this.$p.$5p));if(this.$B.get_$L()!=="TouchNarrow"){$2kq(this);this.$p.$v.$Y("IsPrivate",this.$$d_$8PR);this.$6VQ=!0}if(this.$28R){this.$28R.$5p.add_$2t(this.$$d_$3Jw);this.$2MY=this.$p.$h0.$ic(0,!0,this.$1jW);this.set_$7ZG(new _0365m.$2c($716(this)));this.set_$7uZ(new _0365m.$2c($71A(this)));this.set_$7qk(new _0365m.$2c($719(this)));this.set_$7ey(new _0365m.$2c($718(this)))}if(this.$B.get_$FG()||this.$p.$v.get_$1MR())this.$x=null;else{this.$x=new _y.$5u;this.$LT=new _d.$cL(this.$p.$v,this.$3Kk,c,l,this.$x,o,_g.$V.get_$I().get_$Pl().get_$1cF(),this.$B,p,this.$1H.$3N("ProposeNewTime"));this.$LT.$19y();this.$p.$v.$Y("HasBlockedImages",this.$$d_$4OE)}var b=this.$p.$v.get_$1P();var d=b?b.get_$AIt():new _js.$c;var w=this;a.$E(function(n){w.$5f=n.$1aa(w.$p.$v.get_$i(),d,!0,!0,null,!0,w.$x,null)});var g=this.$p.$v.get_$FX()?this.$p.$v.get_$FX().Mailbox:null;this.$10H=i.$E(g);$71D(this,s);if(y&&this.get_$4bx()){var k=this;y.$E(function(n){k.set_$7v4(n.$E(k.$p.$v))})}};function $2kq(n){var t=null;t=n.$B.get_$FG()||!n.$p.$v.get_$12n()?$717(n):$71B(n);n.set_$7ux(t.length?new _0365m.$2c(t):null);n.$R0&&n.$1bh&&n.$1bh.$Y("IsShown",n.$$d_$3Iv);n.set_$9oc(n.$B.get_$FG()?null:new _0365m.$2c($71C(n)))}function $71B(n){var t=[];n.$3Kk.$2T&&Array.add(t,new _0365m.$o(_nbs.NonBootStrings.l_OpenSeries_LowerCase_Text,null,n.$3Kk));if(!$5(n.$22c)&&n.$22c.get_$T1()){n.$1xN=new _C(n.$22c.$$d_$1xn,_d.$65.$A);Array.add(t,new _0365m.$o(_nbs.NonBootStrings.l_GetDirections_LowerCase_Text,null,n.$1xN))}var i=n.$R0?n.$R0.$3xI():null;i&&Array.add(t,i);return t}function $71D(n,t){if(t&&!n.$p.$v.get_$1MR()){var i=this;t.$1Oh(function(){var t=n.$p.$v.get_$1c();if(t){n.set_$3kn(n.$1st.$8V(n.$p.$v));$2kq(n)}else _js.Trace.logError(_d.$65.$A,"Could not find Calendar with Id: {0}. See #E15:3185198 to confimr if you are hitting a known bug",n.$p.$v.get_$28())})}}function $717(n){var t=n.$p.$h0.$ic(1,!0,n.$1jW);return t.$2T?[new _0365m.$o(_nbs.NonBootStrings.l_OpenSeries_LowerCase_Text,null,t)]:new Array(0)}function $71C(n){var t=[];if(n.$p.$v.get_$JC()){n.$p.$v.get_$fJ()&&Array.add(t,new _0365m.$o(_u.Strings.l_Reply_LowerCase_Text,null,n.$p.$Qj.$Ir));n.$p.$v.get_$iP()&&Array.add(t,new _0365m.$o(_u.Strings.l_ReplyAll_LowerCase_Text,null,n.$p.$Qj.$JT));n.$p.$v.get_$fI()&&Array.add(t,new _0365m.$o(_u.Strings.l_Forward_LowerCase_Text,null,n.$p.$Qj.$IN))}else n.$p.$v.get_$fI()&&Array.add(t,new _0365m.$o(_u.Strings.l_Forward_LowerCase_Text,null,n.$p.$Qj.$IN));return t}function $716(n){return[new _0365m.$o(_nbs.NonBootStrings.l_AddToMyCalendar_Occurrence_Text,null,n.$p.$5p.$2oZ),new _0365m.$o(_nbs.NonBootStrings.l_AddToMyCalendar_Series_Text,null,n.$28R.$5p.$2oZ)]}function $71A(n){return[new _0365m.$o(_nbs.NonBootStrings.l_Calendar_ReadingPane_EditContextMenu_EditOccurrence_Text,null,n.$3tO),new _0365m.$o(_nbs.NonBootStrings.l_Calendar_ReadingPane_EditContextMenu_EditSeries_Text,null,n.$2MY)]}function $719(n){return[new _0365m.$o(_nbs.NonBootStrings.l_DeleteOccurrence_LowerCase_Text,null,n.$p.$5p.$Tg),new _0365m.$o(_nbs.NonBootStrings.l_DeleteSeries_LowerCase_Text,null,n.$28R.$5p.$Tg)]}function $718(n){return[new _0365m.$o(_nbs.NonBootStrings.l_CancelOccurrence_LowerCase_Text,null,n.$p.$5p.$7I),new _0365m.$o(_nbs.NonBootStrings.l_CancelSeries_LowerCase_Text,null,n.$28R.$5p.$7I)]}function $2kp(n,t,i,r){t&&(n.$p.$v.get_$Gj()?i.set_$1O(!0):r.$s())}_d.$65.prototype={$1st:null,$p:null,$1x0:null,$29o:null,$x:null,$1jW:null,$LT:null,$b5:null,$A8K:null,$3tO:null,$2MY:null,$3he:null,$Q2:null,$Jm:null,$7I:null,$6OE:null,$3Kk:null,$28R:null,$6VQ:!1,$10H:null,$6l:null,$B:null,$1H:null,$1bj:null,$5f:null,$22c:null,$1xN:null,$Bt:null,$R0:null,$3m:null,$1bh:null,$2A2:null,$1rT:null,$2MR:null,$2LT:null,$2Iw:null,$2C9:!1,get_$3kn:function(){return this.$R0},set_$3kn:function(n){this.$R0=n;$3(this,"CalendarCategoryViewModel");return n},get_$7v4:function(){return this.$1bj},set_$7v4:function(n){if(this.$1bj!==n){this.$1bj=n;$3(this,"EmailRemindersViewModel")}return n},get_$7ux:function(){return this.$1bh},set_$7ux:function(n){if(n!==this.$1bh){this.$1bh=n;$3(this,"EllipsesContextMenu")}return n},get_$9oc:function(){return this.$2A2},set_$9oc:function(n){if(n!==this.$2A2){this.$2A2=n;$3(this,"ReplyContextMenu")}return n},get_$7ZG:function(){return this.$1rT},set_$7ZG:function(n){if(this.$1rT!==n){this.$1rT=n;$3(this,"AddToMyCalendarContextMenuForSeries")}return n},get_$7uZ:function(){return this.$2MR},set_$7uZ:function(n){if(this.$2MR!==n){this.$2MR=n;$3(this,"EditContextMenuForSeries")}return n},get_$7qk:function(){return this.$2LT},set_$7qk:function(n){if(this.$2LT!==n){this.$2LT=n;$3(this,"DeleteContextMenuForSeries")}return n},get_$5GM:function(){return!this.$B.get_$FG()&&this.$p.$v.get_$12n()},get_$7fe:function(){return!!this.$2A2&&this.$2A2.$14.get_$C()>0},get_$5hF:function(){var n=this.$p.$v.get_$3M();return!!n&&n.get_$3s()==="HTML"},get_$7ey:function(){return this.$2Iw},set_$7ey:function(n){if(this.$2Iw!==n){this.$2Iw=n;$3(this,"CancelContextMenuForSeries")}return n},get_$4c2:function(){return this.$2C9},set_$4c2:function(n){if(this.$2C9!==n){this.$2C9=n;$3u(this,"ShowLoading","ShowEmailRemindersControl")}return n},get_$3kq:function(){return this.$Bt},set_$3kq:function(n){if(this.$Bt!==n){this.$Bt=n;$3(this,"CalendarConfirmDialogViewModel")}return n},get_$4bx:function(){return!!this.$1H&&this.$1H.$3N("EmailReminders")&&!this.$p.$v.get_$az()&&!this.$2C9},$9K4:function(){$BF(this,"Ready",this,this)},$3Ju:function(){this.$1bj&&this.$1bj.$3Ju()},$ACe:function(n){this.$22c=n;$2kq(this)},$49:function(){this.$6VQ&&this.$p.$v.$q("IsPrivate",this.$$d_$8PR);this.$LT&&this.$p.$v.$q("HasBlockedImages",this.$$d_$4OE);_a.$1.prototype.$49.call(this)},$3Iv:function(n,t){this.$1bh.$30&&this.$R0&&this.$R0.$4Th()},$6kc:function(){this.$p.$v.set_$dB(!this.$p.$v.get_$dB())},$8PR:function(n,t){$2kq(this)},$4OE:function(n,t){this.$LT.$19y()},$3Jw:function(n,t){(n==="RemoveCalendarItemAction"||n==="CancelCalendarItemAction"||n==="AddCalendarItemToMyCalendarAction")&&this.$1jW()},$5An:function(){$2kp(this,this.$p.$5p.get_$1BT(),this.$1rT,this.$p.$5p.$2oZ)},$cn:function(){$2kp(this,this.$p.$5p.get_$fH(),this.$2MR,this.$3tO)},$34:function(){$2kp(this,this.$p.$5p.get_$Vp(),this.$2LT,this.$Bt.$2dY)},$9J:function(){$2kp(this,this.$p.$5p.get_$iN(),this.$2Iw,this.$Bt.$2rk)}};_d.$cM=function(n,t,i,r,u,f,e,o,s){this.$B=t;this.$2JH=r;this.$5q=n;this.$Cn=i;this.$2M=u;this.$E7=f;this.$1H=e;this.$5RN=o;this.$Ev=s};_d.$cM.prototype={$5q:null,$B:null,$Cn:null,$2JH:null,$2M:null,$E7:null,$1H:null,$5RN:null,$Ev:null,$E:function(n,t,i,r,u,f,e){return new _d.$65(n,t,i,this.$5q,this.$B,r,u,this.$Cn,this.$2M,this.$2JH,f,e,this.$E7,this.$1H,this.$5RN,this.$Ev)},$7lr:function(n,t,i){return new _d.$65(n,t,i,this.$5q,this.$B,null,null,this.$Cn,null,this.$2JH,null,null,this.$E7,this.$1H,null,this.$Ev)}};_d.$zw=function(n){this.$5q=n};_d.$zw.prototype={$5q:null,$4Sr:0,$e1:0,$E:function(n){if(!n)return null;var i=_pc.$l.$Dh(n);var t=this.$5q.$Vu(i,this.$4Sr,!0,this.$e1);t.set_$E5(!0);return t}};_d.$7K=function(n,t,i,r,u,f,e,o,s,h){this.$$d_$6He=Function.createDelegate(this,this.$6He);this.$$d_$9Zv=Function.createDelegate(this,this.$9Zv);this.$$d_$6Ls=Function.createDelegate(this,this.$6Ls);this.$$d_$3K1=Function.createDelegate(this,this.$3K1);this.$$d_$4Pj=Function.createDelegate(this,this.$4Pj);_d.$7K.initializeBase(this);this.$7F=e;this.$10y=o;this.$2SZ=s;this.$34F=h;this.$52=f;this.$52.$12a();this.$52.set_$M0(u);this.$52.set_$1ls("PersonaDetailedView");this.$52.add_$hO(this.$$d_$4Pj);this.$Ek=n;this.$Ei=t;this.$ol=i;this.$2A9=new(_a.$3f.$$(String));this.$27z=new(_a.$3f.$$(String));this.$18m=r};function $4pL(n,t){for(var r,u,i=0;i<t.get_$C();i++){r=t.get_$3o(i);u=r.$5B;u.$7sF()}}function $4pS(n,t,i){var r=0;var f=0;var e=t;for(var o in e){var u={key:o,value:e[o]};var s=u.value;($5(s)||s.get_$6D())&&(n.$2A9.$76(u.key)?r++:n.$27z.$76(u.key)&&f++)}n.$ol.$8X&&r++;n.$18m.get_$BT()&&n.$18m.get_$3Qn().get_$6D()&&r++;$4pR(n);n.set_$9pD(_d.$FE.$3oV(r,!n.$2SZ&&!i));n.set_$9ek(_d.$FE.$3oV(f,!n.$2SZ&&!i))}function $4pR(n){var t=n.$2A9.get_$C()+1+(n.$18m.get_$BT()?1:0);n.set_$9pE(_d.$FE.$5MF(t));n.set_$9el(_d.$FE.$7oT(n.$27z.get_$C()))}function $4pO(n,t,i){for(var f,r,u=0;u<t.$1U.get_$C();u++){f=t.$1U.get_$3o(u);r=f.$5B;r.set_$1BA(i);r.$Y("AttendeeType",n.$$d_$6He)}}function $4pQ(n,t){for(var r,u,i=0;i<t.$1U.get_$C();i++){r=t.$1U.get_$3o(i);u=r.$5B;u.$q("AttendeeType",n.$$d_$6He)}}function $6yC(n,t){var r=_d.$6h.$5Vv(t.$ab());if(!$6yD(n,r)){var u=_pc.$l.$Dh(r);u.set_$1J(t.get_$1u().get_$1J());var i=n.$10y.$2tq(u,n.$bp.$1Ui,!0,0);i.$Y("AttendeeType",n.$$d_$6He);i.$1JC=!0;n.$bp.$1LW(i)}}function $6yE(n){var t=1;n.$34F||(t|=2);return t}function $4pK(n,t,i){for(var f=new _js.$c,r,u=0;u<t.get_$C();u++){r=t.get_$3o(u).get_$6u();f.$D(r);i.$D(r.EmailAddress)}return n.$7F.$1ac(_y.$17.$Km,f,$6yE(n))}function $4pM(n,t,i,r,u){switch(t.$2Z){case 0:var f=this;Array.forEach(t.$2q,function(t){var e=i.$1U.get_$3o(i.$1U.get_$C()-1);var f=e.$5B.$18;f.get_$1J()===2&&f.get_$1l().RoutingType==="MAPIPDL"&&(n.$1O7[f.get_$1l().Name]=e);n.$1O7[f.get_$1l().EmailAddress]=e;u.$D(f.get_$1l().EmailAddress);r.$D(_g.$3i.$xh(f.get_$1l()))});break;case 2:var e=this;Array.forEach(t.$3B,function(n){var i=n;u.$34(i.EmailAddress);for(var t=0;t<r.get_$C();t++)if(r.get_$3o(t).get_$6u().EmailAddress.toLowerCase()===i.EmailAddress.toLowerCase()){r.$6C(t);return}});break;case 3:case 4:throw Error.argumentOutOfRange("People Picker only supports adding and removing attendees from the underlying recipient well.");}$4pR(n);n.set_$6fk(n.$h2.$1U.get_$C()>0)}function $6yD(n,t){for(var i=t.EmailAddress.toLowerCase(),r=0;r<n.$Ek.get_$C();r++)if(n.$Ek.get_$3o(r).get_$6u().EmailAddress.toLowerCase()===i)return!0;for(var u=0;u<n.$Ei.get_$C();u++)if(n.$Ei.get_$3o(u).get_$6u().EmailAddress.toLowerCase()===i)return!0;return n.$ol.$5B.$18.get_$1l().EmailAddress.toLowerCase()===i?!0:!!n.$18m.get_$BT()&&n.$18m.get_$BT().EmailAddress.toLowerCase()===i}function $4pN(n,t){for(var i=0;i<t.$1U.get_$C();i++){var r=t.$1U.get_$3o(i);var u=t.$8i.get_$3o(i).EmailAddress;n.$1O7[u]=r}}function $4pP(n,t,i){i=i.toLowerCase();var u=this;var r=t.$1U.$Dn(function(n){return i===n.$5B.$18.get_$1l().EmailAddress.toLowerCase()});if(r<t.$1U.get_$C()){t.$3Od(t.$1U.get_$3o(r).$5B);return!0}return!1}_d.$7K.prototype={$34F:!1,$52:null,$Ek:null,$Ei:null,$7F:null,$2SZ:!1,$2A9:null,$27z:null,$18m:null,$ol:null,$10y:null,$bp:null,$h2:null,$1O7:null,$3T4:!1,$3Oz:null,$3Kp:null,$3Oy:null,$3Ko:null,get_$9pA:function(){return this.$bp},set_$9pA:function(n){this.$bp=n;$3(this,"RequiredAttendeeRecipientWellViewModel");return n},get_$9eh:function(){return this.$h2},set_$9eh:function(n){this.$h2=n;$3(this,"OptionalAttendeeRecipientWellViewModel");return n},get_$6fk:function(){return this.$3T4},set_$6fk:function(n){if(this.$3T4!==n){this.$3T4=n;$3(this,"ShowOptionalRecipientWell")}return n},get_$9pE:function(){return this.$3Oz},set_$9pE:function(n){if(this.$3Oz!==n){this.$3Oz=n;$3(this,"RequiredCountLabel")}return n},get_$9el:function(){return this.$3Kp},set_$9el:function(n){if(this.$3Kp!==n){this.$3Kp=n;$3(this,"OptionalCountLabel")}return n},get_$9pD:function(){return this.$3Oy},set_$9pD:function(n){if(this.$3Oy!==n){this.$3Oy=n;$3(this,"RequiredConflictsLabel")}return n},get_$9ek:function(){return this.$3Ko},set_$9ek:function(n){if(this.$3Ko!==n){this.$3Ko=n;$3(this,"OptionalConflictsLabel")}return n},$AG:function(){if(!$5(this.$bp)){this.$bp.$8i.remove_$1Y(this.$$d_$3K1);this.$h2.$8i.remove_$1Y(this.$$d_$6Ls);$4pQ(this,this.$bp);$4pQ(this,this.$h2)}this.$1O7={};this.$2A9.$1t();this.$27z.$1t();this.set_$9pA($4pK(this,this.$Ek,this.$2A9));this.set_$9eh($4pK(this,this.$Ei,this.$27z));if(this.$34F){$4pL(this,this.$bp.$1U);$4pL(this,this.$h2.$1U)}$4pO(this,this.$bp,0);$4pO(this,this.$h2,1);this.$bp.$8i.add_$1Y(this.$$d_$3K1);this.$h2.$8i.add_$1Y(this.$$d_$6Ls);this.set_$6fk(this.$h2.$1U.get_$C()>0);$4pN(this,this.$bp);$4pN(this,this.$h2);$4pS(this,{},!1);this.$18m.apcl("selectedRoomEmailAddress",this.$$d_$9Zv)},$5C0:function(n,t){var f=n;for(var e in f){var o={key:e,value:f[e]};var r=this.$1O7[o.key];if(!$5(r)){var s=r.$5B;var u=o.value;r.set_$6D(u.get_$6D());s.$KF(1,this.$5Vu(u),0);s.set_$5S9(_h.$NS.$5ZP(u.$PV))}}if(!$5(this.$ol)){var i=n[this.$ol.$5B.$18.get_$1l().EmailAddress];if(!$5(i)){this.$ol.set_$6D(i.get_$6D());this.$ol.$5B.$KF(1,this.$5Vu(i),0);this.$ol.$5B.set_$5S9(_h.$NS.$5ZP(i.$PV))}}$4pS(this,n,t)},$5Vu:function(n){var t=n.$r4;_js.$8.$a(n.$2Jv)||n.$2Jv===t||(t+=String.format(_nbs.NonBootStrings.l_SchedulingConflictingMeetings_Text,n.$2Jv));return t},$4Pj:function(n,t){var i=n.get_$X1();$5(i)||$6yC(this,i)},$6He:function(n,t){var i=n;i.$q("AttendeeType",this.$$d_$6He);var r=this.$10y.$2tq(i.get_$1u(),this.$bp.$1Ui,!0,i.$a1);r.$Y("AttendeeType",this.$$d_$6He);if(r.$a1){this.$bp.$3Od(i);this.$h2.$1LW(r)}else{this.$h2.$3Od(i);this.$bp.$1LW(r)}},$3K1:function(n,t){$4pM(this,t,this.$bp,this.$Ek,this.$2A9)},$6Ls:function(n,t){$4pM(this,t,this.$h2,this.$Ei,this.$27z)},$9Zv:function(n,t){this.$18m.get_$BT()&&($4pP(this,this.$bp,this.$18m.get_$BT().EmailAddress)||$4pP(this,this.$h2,this.$18m.get_$BT().EmailAddress))}};_d.$KX=function(n){this.$$d_$9XM=Function.createDelegate(this,this.$9XM);this.$$d_$9bm=Function.createDelegate(this,this.$9bm);_d.$KX.initializeBase(this);this.$lL=n;this.$lL.$Y("ShowSelectionPeek",this.$$d_$9bm);this.$Y("IsShown",this.$$d_$9XM)};function $768(n){var i=n.$lL.$296;var r=n.$lL.$5WM();var t=$764(n,i,r);n.$5Qo=_cc.$I4.$2Ow(i.$2R,i.$3H);n.$6Ww=_d.$FE.$5MF(r.get_$C());n.$5J8=_d.$FE.$3oV(t.get_$C(),!n.$lL.$2SZ&&!n.$lL.get_$40Q());n.$4jM=null;n.$3zY=null;if(t.get_$C()>0){n.$4jM=$766(n,t);t.get_$C()-4>0&&(n.$3zY=$765(n,t.get_$C()-4))}}function $765(n,t){switch(t){case 1:return _nbs.NonBootStrings.l_OneAdditionalConflict_Text;default:return _js.$8.$4B(_nbs.NonBootStrings.l_AdditionalConflicts_Text,t)}}function $764(n,t,i){var r=n.$lL.$OL.$2Ob(t.$2R,t.$3H,_g.$2R.$A8Z(i),!0);return _d.$FE.$5Ws(r)}function $766(n,t){for(var u=new _js.$c,r,i=0;i<t.get_$C()&&i<4;i++){r=t.get_$3o(i);$767(n,r);u.$D(r)}return u}function $767(n,t){if(n.$lL.$OL.get_$2B3()&&_a.$3T.$Oc(n.$lL.$OL.get_$2B3().EmailAddress)===_a.$3T.$Oc(t.$B6))t.$7K=n.$lL.$AH.get_$HZ()?n.$lL.$AH.get_$HZ().Name:n.$lL.$AH.get_$9Jf().Name;else{var i;i=n.$lL.get_$3Tw()[t.$B6];$5(i)||(t.$7K=i.Name)}}_d.$KX.prototype={$lL:null,$6Ww:null,$5J8:null,$5Qo:null,$4jM:null,$3zY:null,$30:!1,get_$1O:function(){return this.$30},set_$1O:function(n){if(this.$30!==n){this.$30=n;this.$30;$3(this,"IsShown")}return n},get_$5rb:function(){return 400},get_$zu:function(){return 330},get_$5hr:function(){return!!this.$lL.$296},$9bm:function(n,t){this.get_$5hr()&&n.$2gX?this.set_$1O(!0):this.set_$1O(!1)},$9XM:function(n,t){this.$30&&$768(this)}};_d.$116=function(n,t,i,r,u,f){_d.$116.resolveInheritance();this.apcl=this.$Y;this.rpcl=this.$q;_d.$116.initializeBase(this);this.$2R=$5(i)?null:i.$3g();this.$3H=$5(r)?null:r.$3g();this.$n6=n;this.$6QU=t;this.$4E=_g.$3V.$139("");this.$20b=u;this.$36E=f};_d.$116.prototype={$4E:null,$6QU:0,$2R:null,$3H:null,$n6:"Free",$20b:!1,$36E:!1,get_$Ao:function(){return this.$36E},get_$1eg:function(){return this.$20b},get_$i:function(){return null},get_$y:function(){return this.$2R},get_$FS:function(){return!1},get_$20:function(){return this.$3H},get_$2i:function(){return""},get_$99:function(){return this.$n6},get_$5R:function(){return!1},get_$8Ko:function(){switch(this.$n6){case"Tentative":case"Busy":case"OOF":return!1;default:return!0}},get_$5V:function(){return null},get_$ju:function(){return""},get_$4g:function(){return this.$4E},get_$48D:function(){return!1},get_$Hq:function(){throw Error.notImplemented("The IsOrganizer property is not supported in SchedulingConflictViewModel");},get_$fH:function(){throw Error.notImplemented("The CanEdit property is not supported in SchedulingConflictViewModel");}};_d.$Lj=function(n,t,i,r,u,f,e,o){this.$$d_$uz=Function.createDelegate(this,this.$uz);this.$$d_$A8E=Function.createDelegate(this,this.$A8E);_d.$Lj.initializeBase(this,[n,t,i,u,f,e,!1,null,o]);this.$a1=r;this.$1oU=new _0365m.$o(_nbs.NonBootStrings.l_MarkAsOptional_Text,null,new _C(this.$$d_$A8E,_a.$0.$El));this.$1oU.set_$r(!this.get_$5Fv());this.$1oU.$QK.set_$69(this.get_$5Fv());var s=this;this.$3Sn=new _0365m.$o(_nbs.NonBootStrings.l_ShowError_Text,null,new _C(this.$$d_$uz,_a.$0.$El,this,"CanShowError",function(){return s.get_$2s3()}));this.$3Sn.set_$r(!0);$3bk(this);Array.add(this.$fT,this.$1oU);Array.add(this.$fT,this.$3Sn);this.$1v=new _y.$4p};function $3bk(n){n.$1oU.set_$1Q(n.$a1?_nbs.NonBootStrings.l_MarkAsRequired_Text:_nbs.NonBootStrings.l_MarkAsOptional_Text)}function $4t8(n,t){var i=t.get_$1l().EmailAddress;return!!i&&i.startsWith("@")}_d.$Lj.prototype={$1oU:null,$3Sn:null,$1v:null,$a1:0,$2Mr:null,get_$2s3:function(){return!$5(this.$2Mr)&&!$4t8(this,this.get_$1u())},get_$5S9:function(){return this.$2Mr},set_$5S9:function(n){if(this.$2Mr!==n){var t=this.get_$2s3();this.$2Mr=n;if(t!==this.get_$2s3()){$3(this,"CanShowError");this.$3Sn.set_$r(!this.get_$2s3())}}return n},get_$1BA:function(){return this.$a1},set_$1BA:function(n){if(this.$a1!==n){this.$a1=n;$3bk(this);$3(this,"AttendeeType")}return n},get_$5Fv:function(){return!this.$a1||this.$a1===1},$7sF:function(){this.$1oU.set_$r(!0);this.$1oU.$QK.set_$69(!1)},$2Oh:function(){var n=_y.$17.prototype.$2Oh.call(this);if($4t8(this,n)){n=_pc.$l.$Dh(_0365f.$2d.$3g(n.get_$1l(),!0,!0));n.get_$1l().EmailAddress=null}return n},$A8E:function(){this.set_$1BA(this.$a1?0:1);$3bk(this)},$uz:function(){this.$1v.$2u(0,this.$2Mr,null,!1)}};_d.$ZL=function(n,t,i,r){_d.$ZL.initializeBase(this,[n,t,i,r]);this.$1aG=n;this.$B=t};_d.$ZL.prototype={$B:null,$1aG:null,$ib:function(n,t,i,r){return this.$2tq(n,t,i,0,r)},$2tq:function(n,t,i,r,u){return new _d.$Lj(n,t,i,r,u,this.$1aG,this.$B,this.$1H)}};_d.$3a=function(n,t){_d.$3a.initializeBase(this,[n]);if(!$5(t)){this.set_$py(t.$SU);this.set_$5SK(t.$A8.get_$y());this.set_$5SH(t.$A8.get_$20());this.set_$rD(t.$A8.$xN);this.set_$3uT(new _js.$c);this.get_$3uT().$6S(t.$NU.$6W());this.set_$3uS(new _js.$c);this.get_$3uS().$6S(t.$cq.$6W());this.set_$4R8(new _js.$c);this.get_$4R8().$6S(t.$1Hf.$6W());this.set_$4R7(new _js.$c);this.get_$4R7().$6S(t.$2bH.$6W());this.set_$4R5(new _js.$c);this.get_$4R5().$6S(t.$2bF.$6W());this.set_$6ao(t.$AH.get_$HZ());this.set_$6am(t.$AH.get_$BT());this.set_$5gu(t.$AH.get_$1YR())}};_d.$3a.$$cctor=function(){_d.$3a.$2xt.set_$HL(new _a.$EP(_g.$3i));_d.$3a.$2xs.set_$HL(new _a.$EP(_g.$3i));_d.$3a.$3L3.set_$HL(new _a.$EP(_g.$3i));_d.$3a.$3L2.set_$HL(new _a.$EP(_g.$3i));_d.$3a.$3L1.set_$HL(new _a.$EP(_g.$3i))};_d.$3a.prototype={get_$5SK:function(){return this.$W(_d.$3a.$3uU)},set_$5SK:function(n){this.$M(_d.$3a.$3uU,n);return n},get_$5SH:function(){return this.$W(_d.$3a.$3uO)},set_$5SH:function(n){this.$M(_d.$3a.$3uO,n);return n},get_$rD:function(){return this.$W(_d.$3a.$3tE)},set_$rD:function(n){this.$M(_d.$3a.$3tE,n);return n},get_$py:function(){return this.$W(_d.$3a.$4jA)},set_$py:function(n){this.$M(_d.$3a.$4jA,n);return n},get_$3uT:function(){return this.$W(_d.$3a.$2xt)},set_$3uT:function(n){this.$M(_d.$3a.$2xt,n);return n},get_$3uS:function(){return this.$W(_d.$3a.$2xs)},set_$3uS:function(n){this.$M(_d.$3a.$2xs,n);return n},get_$4R8:function(){return this.$W(_d.$3a.$3L3)},set_$4R8:function(n){this.$M(_d.$3a.$3L3,n);return n},get_$4R7:function(){return this.$W(_d.$3a.$3L2)},set_$4R7:function(n){this.$M(_d.$3a.$3L2,n);return n},get_$4R5:function(){return this.$W(_d.$3a.$3L1)},set_$4R5:function(n){this.$M(_d.$3a.$3L1,n);return n},get_$6ao:function(){return this.$W(_d.$3a.$4Z9)},set_$6ao:function(n){this.$M(_d.$3a.$4Z9,n);return n},get_$6am:function(){return this.$W(_d.$3a.$4ZA)},set_$6am:function(n){this.$M(_d.$3a.$4ZA,n);return n},get_$5gu:function(){return this.$W(_d.$3a.$43k)},set_$5gu:function(n){this.$M(_d.$3a.$43k,n);return n},$5KM:function(n){n.set_$py(this.get_$py());n.$A8.set_$rD(this.get_$rD());n.$A8.set_$y(this.get_$5SK());n.$A8.$1ZV&&n.$A8.set_$20(this.get_$5SH());n.$NU.$6S(this.get_$3uT().$6W());n.$cq.$6S(this.get_$3uS().$6W());n.$1Hf.$6S(this.get_$4R8().$6W());n.$2bH.$6S(this.get_$4R7().$6W());n.$2bF.$6S(this.get_$4R5().$6W());n.$AH.set_$HZ(this.get_$6ao());n.$AH.set_$BT(this.get_$6am());n.$AH.set_$1YR(this.get_$5gu())}};_d.$6h=function(n,t,i,r,u,f,e,o,s){this.$$d_$9bl=Function.createDelegate(this,this.$9bl);this.$$d_$27k=Function.createDelegate(this,this.$27k);this.$$d_$3K1=Function.createDelegate(this,this.$3K1);this.$$d_$9bn=Function.createDelegate(this,this.$9bn);this.$$d_$9YZ=Function.createDelegate(this,this.$9YZ);this.$$d_$9ar=Function.createDelegate(this,this.$9ar);this.$$d_$6Mt=Function.createDelegate(this,this.$6Mt);_d.$6h.initializeBase(this);this.$4g4=n;this.$p=t;this.$7uK=f;this.$4bB=o;this.$2SZ=s;this.$3tF=i;this.$OL=r;this.$AH=u;this.$1v=e;this.$2bH=new(_a.$1r.$$(_g.$3i,_g.$8U));this.$2bF=new(_a.$1r.$$(_g.$3i,_g.$8U));this.$1Hf=new(_a.$1r.$$(_g.$3i,_g.$8U));this.$NU=new(_a.$1r.$$(_g.$3i,_g.$8U));this.$cq=new(_a.$1r.$$(_g.$3i,_g.$8U));this.$A8=new _d.$Dv(new _cc.$BD(this.$p.$v.get_$y(),this.$p.$v.get_$20(),this.$p.$v.get_$5R()));this.$A8.$Y("Start",this.$$d_$6Mt);this.$A8.$Y("End",this.$$d_$6Mt);this.$A8.$Y("CorrectedDateRange",this.$$d_$9ar);this.$Y("PreviewDateRange",this.$$d_$9YZ);this.$Y("ShowSelectionPreview",this.$$d_$9bn);this.set_$py(this.$p.$v.get_$y().$4D());this.set_$2CH(!this.$A8.get_$5R());this.$36b=!0};_d.$6h.$5Vv=function(n){if(_js.$8.$a(n.EmailAddress)){n=_0365f.$2d.$3g(n,!0,!0);n.EmailAddress=n.ItemId&&!_js.$8.$a(n.ItemId.Id)?"@"+n.ItemId.Id:String.format("{0}{1}{2}","@",n.Name,n.MailboxType)}return n};_d.$6h.$A3l=function(n,t){var u={};_d.$6h.$3OR(u,n);for(var r=0;r<t.get_$C();r++)var e=t.get_$3o(r).get_$6u().EmailAddress;for(var i=0;i<t.get_$C();i++){var f=u[t.get_$3o(i).get_$6u().EmailAddress.toLowerCase()];if(f)n.$34(f);else{t.$6C(i);i--}}};_d.$6h.$81n=function(n,t,i,r){_d.$6h.$3wo(t);_d.$6h.$3wo(i);_d.$6h.$3wo(n);var u={};u[r.EmailAddress.toLowerCase()]=r;_d.$6h.$3OR(u,n);_d.$6h.$3OR(u,t);_d.$6h.$3OR(u,i)};_d.$6h.$3OR=function(n,t){for(var i=0;i<t.get_$C();i++){var u=t.get_$3o(i);var r=u.get_$6u().EmailAddress.toLowerCase();if(n[r]){_js.Trace.logInfo(_a.$0.$El,"SchedulingContext: Removing duplicated entry {0}",r);t.$6C(i);i--}else n[r]=u}};_d.$6h.$3wo=function(n){for(var t=0;t<n.get_$C();t++)_js.$8.$a(n.get_$3o(t).get_$6u().EmailAddress)&&n.set_$3o(t,_g.$3i.$xh(_d.$6h.$5Vv(n.get_$3o(t).get_$6u())))};_d.$6h.$3mc=function(n){for(var t=0;t<n.get_$C();t++){var i=n.get_$3o(t);i.get_$6u().EmailAddress.startsWith("@")&&(i.get_$6u().EmailAddress=null)}};_d.$6h.$2Hk=function(n,t){if(n===t)return!0;if(!n||!t||n.get_$C()!==t.get_$C())return!1;for(var i=0;i<n.get_$C();i++)if(!(_0365f.$2d.$4N(t.get_$3o(i).get_$6u().ItemId,n.get_$3o(i).get_$6u().ItemId)&&t.get_$3o(i).get_$6u().EmailAddress===n.get_$3o(i).get_$6u().EmailAddress))return!1;return!0};function $769(n){for(var r=n.$5WM(),u={},t=0;t<r.get_$C();t++){var i=r.get_$3o(t);$5(i)||(u[i.EmailAddress]=i)}return u}function $4t0(n){n.$4g4.$3lb();n.$2gY&&n.$36b&&n.$4g4.$1s(n.$$d_$9bl,400,_a.$0.$El)}function $76B(n){var t=n.$3tF;var i=n.$A8;return t.get_$y()!==i.get_$y()||t.get_$20()!==i.get_$20()||t.get_$DE()!==i.get_$DE()||t.$xN!==i.$xN}function $76A(n){return!_d.$6h.$2Hk(n.$2bH,n.$NU)||!_d.$6h.$2Hk(n.$2bF,n.$cq)}function $76C(n){return!n.$1Hf.get_$C()&&n.$AH.get_$BT()?!0:n.$1Hf.get_$C()>0&&!n.$AH.get_$BT()?!0:n.$1Hf.get_$C()>0&&!!n.$AH.get_$BT()&&n.$1Hf.get_$3o(0).get_$6u().EmailAddress!==n.$AH.get_$BT().EmailAddress}_d.$6h.prototype={$4g4:null,$p:null,$OL:null,$AH:null,$7uK:0,$NU:null,$cq:null,$1Hf:null,$3tF:null,$2SZ:!1,$1v:null,$A8:null,$SU:null,$296:null,$2gY:!1,$36b:!1,$4bB:!1,$2gX:!1,$4cq:null,$2bH:null,$2bF:null,get_$py:function(){return this.$SU},set_$py:function(n){if($5(n))throw Error.argumentNull("ViewStartDate");if(n.$3nb())throw Error.argument("ViewStartDate","value should not contain time part.");if(!_a.$7.$4N(this.$SU,n)){this.$SU=n;this.$OL.set_$MO(this.$SU);$3(this,"ViewStartDate")}return n},get_$2xu:function(){return this.$p.$v.get_$2i()},get_$1bv:function(){return this.$p.$v.get_$FX().Mailbox},get_$1zS:function(){return $76B(this)||$76C(this)||$76A(this)},get_$1eQ:function(){return!this.get_$YL()},get_$2rl:function(){return!this.get_$YL()},get_$6T2:function(){return this.$296},set_$6T2:function(n){if($5(n))throw Error.argumentNull("PreviewDateRange");if(!_a.$7.$4N(this.$296,n)){this.$296=n;$3(this,"PreviewDateRange")}return n},get_$2CH:function(){return this.$2gY},set_$2CH:function(n){if(this.$2gY!==n){this.$2gY=n;$3(this,"ShowSelectionPreview")}return n},get_$4cO:function(){return this.$2gX},set_$4cO:function(n){if(this.$2gX!==n){this.$2gX=n;$3(this,"ShowSelectionPeek")}return n},get_$3Tw:function(){if(!this.$4cq){this.$4cq=$769(this);this.$NU.add_$1Y(this.$$d_$3K1);this.$AH.apcl("SelectedRoomViewModel",this.$$d_$27k)}return this.$4cq},get_$40Q:function(){return!_a.$7.$4N(this.$p.$v.get_$y(),this.$A8.get_$y())||!_a.$7.$4N(this.$p.$v.get_$20(),this.$A8.get_$20())},get_$y:function(){return this.$A8.get_$y()},get_$20:function(){return this.$A8.get_$20()},get_$M2:function(){return this.$p.$v.get_$M2()},get_$JF:function(){return this.$p.$v.get_$JF()},get_$YL:function(){return!_cc.$IZ.isInstanceOfType(this.$p.$EO.get_$I1())},$7jo:function(){if(this.$4bB){this.$4bB=!1;var t;var i;var n;t=this.$p.$v.get_$7G()?this.$p.$v.get_$7G().$3g():new(_a.$1r.$$(_g.$3i,_g.$8U));i=this.$p.$v.get_$8D()?this.$p.$v.get_$8D().$3g():new(_a.$1r.$$(_g.$3i,_g.$8U));n=this.$p.$v.get_$9F()?this.$p.$v.get_$9F().$3g():new(_a.$1r.$$(_g.$3i,_g.$8U));_d.$6h.$81n(n,t,i,this.$p.$v.get_$FX().Mailbox);if(n.get_$C()>0){this.$AH.set_$BT(n.get_$3o(0).get_$6u());for(var r=1;r<n.get_$C();r++)t.$D(n.get_$3o(r))}else this.$AH.set_$BT(null);this.$2bH=t;this.$2bF=i;this.$NU.$3o8(t);this.$cq.$3o8(i);this.$1Hf.$3o8(n);this.set_$py(this.$p.$v.get_$y().$4D());this.set_$2CH(!this.$A8.get_$5R())}},$5C3:function(){this.$3tF.$6n3(this.$A8.get_$y(),this.$A8.get_$DE(),this.$A8.get_$5R())},$5C2:function(){var t=this.$NU.$3g();var n=this.$1Hf.$3g();var i=this.$cq.$3g();_d.$6h.$A3l(t,n);this.$AH.get_$BT()&&!this.$AH.get_$9tQ()&&n.$6r(0,_g.$3i.$xh(this.$AH.get_$BT()));_d.$6h.$3mc(t);_d.$6h.$3mc(i);_d.$6h.$3mc(n);_d.$6h.$2Hk(t,this.$p.$v.get_$7G())||this.$p.$v.set_$7G(t);_d.$6h.$2Hk(i,this.$p.$v.get_$8D())||this.$p.$v.set_$8D(i);_d.$6h.$2Hk(n,this.$p.$v.get_$9F())||this.$p.$v.set_$9F(n)},$5WM:function(){var n=new(_a.$3f.$$(_g.$1q));n.$D(this.get_$1bv());for(var t=0;t<this.$NU.get_$C();t++)n.$D(this.$NU.get_$3o(t).get_$6u());this.$AH.get_$BT()&&n.$D(this.$AH.get_$BT());return n},$3xb:function(n){var t=new(_a.$3f.$$(String));t.$D(this.get_$1bv().EmailAddress);for(var i=0;i<this.$NU.get_$C();i++)t.$D(this.$NU.get_$3o(i).get_$6u().EmailAddress);for(var r=0;r<this.$cq.get_$C();r++)t.$D(this.$cq.get_$3o(r).get_$6u().EmailAddress);for(var f=this.$AH.$3xb(n),u=0;u<f.get_$C();u++)t.$D(f.get_$3o(u));return t},$27k:function(n,t){this.$AH.get_$BT()&&(this.get_$3Tw()[this.$AH.get_$BT().EmailAddress]=this.$AH.get_$BT())},$3K1:function(n,t){var i;switch(t.$2Z){case 0:for(var r=t.$2q.length-1;r>=0;r--){i=t.$2q[r].get_$6u();this.get_$3Tw()[i.EmailAddress]=i}break;case 2:for(var u=t.$3B.length-1;u>=0;u--){i=t.$3B[u].get_$6u();delete this.get_$3Tw()[i.EmailAddress]}break;default:break}},$6Mt:function(n,t){var i=this.$A8.get_$y().$4D();this.$OL.set_$5s7(i);this.set_$py(i)},$9ar:function(n,t){this.$AH.set_$bu(this.$A8.$qo.$3g());this.set_$2CH(!1)},$9YZ:function(n,t){this.set_$2CH(!this.$A8.get_$5R());this.set_$4cO(!1);$4t0(this)},$9bn:function(n,t){this.set_$4cO(!1);$4t0(this)},$9bl:function(){this.set_$4cO(!this.$A8.get_$5R())}};_d.$4m=function(n,t){this.$$d_$4PD=Function.createDelegate(this,this.$4PD);this.$$d_$27k=Function.createDelegate(this,this.$27k);this.$$d_$6Ls=Function.createDelegate(this,this.$6Ls);this.$$d_$3K1=Function.createDelegate(this,this.$3K1);this.$$d_$4QU=Function.createDelegate(this,this.$4QU);this.$$d_$6K5=Function.createDelegate(this,this.$6K5);this.$$d_$6K6=Function.createDelegate(this,this.$6K6);this.$2pw={};_d.$4m.initializeBase(this,[n.$A8.get_$y(),null,null,null,t]);_a.$3.$K(t,"calendarContext");this.$d=n;this.$kw=new _js.$c;this.$mL=new _js.$c;this.$20E=this.$1g.$B.get_$L()==="Mouse";this.set_$3pn(new _d.$G4([n.$A8.get_$y()],this.$Cr,this.$kw,t.$2M,this.$1g.$b,this.$1g.$J));this.$Y("GridSelectedRowColumnIndex",this.$$d_$6K6);this.$20E&&this.$Y("GridHoveredRowColumnIndex",this.$$d_$6K5);this.$1TD=!0;this.$x9=!0;this.$d.$Y("ViewStartDate",this.$$d_$4QU);this.$d.$NU.add_$1Y(this.$$d_$3K1);this.$d.$cq.add_$1Y(this.$$d_$6Ls);this.$d.$AH.apcl("SelectedRoomViewModel",this.$$d_$27k);this.$d.$OL.add_$316(this.$$d_$4PD)};function $76D(n){n.set_$Ak(n.$d.$SU);$1qC(n,0,_g.$3i.$xh(n.$d.get_$1bv()),!0);for(var t=0;t<n.$d.$NU.get_$C();t++)$1qC(n,t+1,n.$d.$NU.get_$3o(t),!1);for(var i=0;i<n.$d.$cq.get_$C();i++)$1qC(n,i+1+n.$d.$NU.get_$C(),n.$d.$cq.get_$3o(i),!1);if(n.$d.$AH.get_$BT()){n.$MN=n.$d.$AH.get_$BT();$1qC(n,n.$kw.get_$C(),_g.$3i.$xh(n.$MN),!1)}}function $1qC(n,t,i,r){var f=i.get_$6u().EmailAddress;var e=_js.$8.$a(i.get_$6u().Name)?f:i.get_$6u().Name;var u=new _g.$9I;u.set_$Bb(e);u.set_$AX(f);u.set_$i(new _g.$1t(f));u.set_$1Ls(r?_d.$4m.$6Oa:_d.$4m.$5DO);u.set_$nc(!0);n.$kw.$6r(t,u);n.$mL.$6r(t,new _d.$Qz(u,null,null,null,n.$1g.$Cl));$3bi(n,new _d.$4m.$3ir(n.$1CY,u.get_$AX()))}function $4t4(n,t){var i=n.$kw.get_$3o(t);$4t5(n,i,!0);n.$kw.$6C(t);n.$mL.$6C(t)}function $3bi(n,t){if($4t1(n,t)){_js.Trace.logInfo(_a.$0.$El,"AddItemsForAttendee() Token already exists {0}. ",t.get_$2iu());return}var r=this;var i=function(){$76F(n,t);var i=null;$1Kz(n)&&n.$1CY===t.get_$7pq()&&(i=$4t2(n,t.get_$1l()));if(!i){_js.Trace.logInfo(_a.$0.$El,"AddItemsForAttendee() Ignore async calendar add. {0}",t.get_$2iu());return}var f=new(_a.$3f.$$(String));f.$D(i.get_$AX());var e=n.get_$Ak().$4D();var s=n.$d.$OL.$87U(e,e.$2w(1),f);var r=s[i.get_$AX()];var o=n.$d.$OL.$83a(f)[i.get_$AX()];var h=!$5(o)&&o!=="NoError";if(r)try{n.set_$dE(!0);for(var u=0;u<r.get_$C();u++){r.get_$3o(u).$AQ=i;n.$IB(r.get_$3o(u))}}finally{n.set_$dE(!1)}n.$OS.$5aK(i).set_$8Cv(h)};$76E(n,t);n.get_$AEs()?_js.$J.get_$I().$1s(_a.$0.$El,"Scheduling",i,0):i()}function $4t5(n,t,i){try{i&&n.set_$dE(!0);_js.Trace.logInfo(_a.$0.$El,"Removing calendar items of user: {0} ",t.get_$Bb());for(var f=!1,r=0;r<n.$t.get_$C();r++)if(n.$t.get_$3o(r).$AQ===t){n.$t.$6C(r);r--;f=!0}else if(f)break;for(var u=0;u<n.$Cr.get_$C();u++)if(n.$Cr.get_$3o(u).$AQ===t){n.$Cr.$6C(u);u--}}finally{i&&n.set_$dE(!1)}}function $4t3(n,t,i){switch(t.$2Z){case 0:for(var r=t.$2q.length-1;r>=0;r--){var f=i+t.$4b;$1qC(n,f,t.$2q[r],!1)}break;case 2:for(var u=t.$3B.length-1;u>=0;u--){var e=i+t.$4b;$4t4(n,e)}break;default:break}}function $1Kz(n){if(n.$x9){n.$1TD=!0;return!1}return!0}function $4t1(n,t){return!!n.$2pw[t.get_$2iu()]}function $76E(n,t){n.$2pw[t.get_$2iu()]=t}function $76F(n,t){delete n.$2pw[t.get_$2iu()]}function $4t2(n,t){for(var i=0;i<n.$kw.get_$C();i++)if(n.$kw.get_$3o(i).get_$AX()===t)return n.$kw.get_$3o(i);return null}_d.$4m.prototype={$x9:!1,$1TD:!1,$kw:null,$mL:null,$20E:!1,$d:null,$1CY:0,$MN:null,get_$UI:function(){return this.$d},get_$1CU:function(){return 0},get_$1ZS:function(){return 1},get_$1N:function(){return"SchedulingDayViewModel"},get_$3kv:function(){return 24},get_$5GI:function(){return this.$d.get_$2rl()},get_$AEs:function(){return!0},$e6:function(){this.$x9=!1;this.$d.$36b=!1;if(this.$1TD){this.$1CY++;this.$2AB();this.$kw.$1t();this.$mL.$1t();$76D(this)}},$FZ:function(){_a.$6.$19(null,"SchedulingAssistant_SwitchToDayView")},$l1:function(){this.$x9=!0;this.$1TD=!1;this.$1CY++},$TZ:function(){},$2zo:function(n){return $2FF(this,this.get_$9I(),n,0)},$49:function(){this.$q("GridSelectedRowColumnIndex",this.$$d_$6K6);this.$20E&&this.$q("GridHoveredRowColumnIndex",this.$$d_$6K5);this.$d.$NU.remove_$1Y(this.$$d_$3K1);this.$d.$cq.remove_$1Y(this.$$d_$6Ls);this.$d.$AH.rpcl("SelectedRoomViewModel",this.$$d_$27k);this.$d.$OL.remove_$316(this.$$d_$4PD);this.$OS.dispose();_d.$1s.prototype.$49.call(this)},$7o6:function(n,t){return _d.$KY.$7o5(n,t)},$4QU:function(n,t){if($1Kz(this)){this.set_$Ak(this.$d.$SU);this.$2AB();this.$1CY++;for(var i=0;i<this.$kw.get_$C();i++)$3bi(this,new _d.$4m.$3ir(this.$1CY,this.$kw.get_$3o(i).get_$AX()))}},$4PD:function(n){if($1Kz(this))try{for(var t=0;t<n.get_$C();t++){var i=$4t2(this,n.get_$3o(t));if(i){var r=new _d.$4m.$3ir(this.$1CY,i.get_$AX());if(!$4t1(this,r)){this.set_$dE(!0);$4t5(this,i,!1);$3bi(this,r)}}}}finally{this.set_$dE(!1)}},$3K1:function(n,t){$1Kz(this)&&$4t3(this,t,1)},$6Ls:function(n,t){$1Kz(this)&&$4t3(this,t,this.$d.$NU.get_$C()+1)},$27k:function(n,t){if($1Kz(this)){if(this.$MN){$4t4(this,this.$kw.get_$C()-1);this.$MN=null}if(this.$d.$AH.get_$BT()){this.$MN=this.$d.$AH.get_$BT();$1qC(this,this.$kw.get_$C(),_g.$3i.$xh(this.$MN),!1)}}},$6K6:function(n,t){if($1Kz(this)&&this.$Q9)if(this.get_$5GI()){var i=$2ki(this,this.get_$Ak(),this.$Q9.$M5);this.$d.$A8.get_$5R()?this.$d.$A8.set_$y(new _a.$7(i.get_$4S(),i.get_$3T(),i.get_$5n(),this.$d.$A8.get_$y().get_$ED(),this.$d.$A8.get_$y().get_$Gp(),this.$d.$A8.get_$y().get_$Tm(),this.$d.$A8.get_$y().get_$zs())):this.$d.$A8.set_$y(i)}else this.$d.$1v.$2u(0,_nbs.NonBootStrings.l_Calendar_CannotChangeTimeOfRecurringMeetingInSchedulingAssistant_Text,null)},$6K5:function(n,t){if($1Kz(this))if(this.$1DY){var i=this.$2zo(this.$1DY);var r=new _h.$4i(i,i.$9v(this.$d.$A8.$3oE));this.$d.set_$6T2(r)}else this.$d.set_$2CH(!1)}};_d.$4m.$3ir=function(n,t){this.$1CY=n;this.$B6=t;this.$6mP=String.format("{0}@{1}",n,t)};_d.$4m.$3ir.prototype={$1CY:0,$B6:null,$6mP:null,get_$7pq:function(){return this.$1CY},get_$1l:function(){return this.$B6},get_$2iu:function(){return this.$6mP}};_d.$5k=function(n,t,i,r,u,f){this.$$d_$27k=Function.createDelegate(this,this.$27k);this.$$d_$6Mt=Function.createDelegate(this,this.$6Mt);this.$$d_$9N0=Function.createDelegate(this,this.$9N0);this.$$d_$4O8=Function.createDelegate(this,this.$4O8);this.$$d_$9d4=Function.createDelegate(this,this.$9d4);this.$$d_$iq=Function.createDelegate(this,this.$iq);this.$$d_$5C1=Function.createDelegate(this,this.$5C1);_d.$5k.initializeBase(this);this.$d=t;this.$qL=new _C(this.$$d_$5C1,_d.$5k.$A);this.$EW=new _C(this.$$d_$iq,_d.$5k.$A);this.$12U=i;this.$1sA=new(_a.$3f.$$(String));this.$3hS=r;this.$2Dc=u;this.$5lQ=f;n.get_$L()==="TouchNarrow"&&this.set_$6k(_y.$22.$Aj(this,$76H(this),null));this.$3hS.$5m();this.$Fq=new _0365m.$2c(new Array(0));this.$LI=new _C(this.$$d_$9d4,_d.$5k.$A);this.$17j="OpenSchedulingAssistantForm"};function $76K(n){n.$d.$7jo();n.$12U.$AG();n.$1sA.$1t()}function $76G(n){n.$12U.$Ek.add_$1Y(n.$$d_$4O8);n.$12U.$Ei.add_$1Y(n.$$d_$4O8);n.$d.$OL.add_$3rw(n.$$d_$9N0);n.$d.$A8.$Y("CorrectedDateRange",n.$$d_$6Mt);n.$d.$AH.apcl("SelectedRoomViewModel",n.$$d_$27k)}function $76J(n){n.$12U.$Ek.remove_$1Y(n.$$d_$4O8);n.$12U.$Ei.remove_$1Y(n.$$d_$4O8);n.$d.$OL.remove_$3rw(n.$$d_$9N0);n.$d.$A8.$q("CorrectedDateRange",n.$$d_$6Mt);n.$d.$AH.rpcl("SelectedRoomViewModel",n.$$d_$27k)}function $76I(n){$1qD(n,n.$d.get_$1bv());for(var t=0;t<n.$d.$NU.get_$C();t++){var r=n.$d.$NU.get_$3o(t);$1qD(n,r.get_$6u())}for(var i=0;i<n.$d.$cq.get_$C();i++){var u=n.$d.$cq.get_$3o(i);$1qD(n,u.get_$6u())}if(n.get_$1Ip().get_$1dC()){$1qD(n,n.get_$1Ip().get_$BT());n.$MN=n.get_$1Ip().get_$BT()}}function $1qD(n,t){n.$1sA.$D(t.EmailAddress)}function $4t7(n,t){n.$1sA.$34(t.EmailAddress)}function $3bj(n,t){if(n.$d.get_$1eQ()){var i=n.$d.$A8.$qo;var r=n.$d.$OL.$2Ob(i.$2R,i.$3H,t,!1);n.$12U.$5C0(r,n.$d.get_$40Q())}$2lL(n)}function $2lL(n){var t=n.$d.$A8.$qo;var i=n.$d.$OL.$2Ob(t.$2R,t.$3H,n.$1sA,!1);n.$12U.$5C0(i,n.$d.get_$40Q())}function $4t6(n){n.get_$4h().$BP()}function $76H(n){var t=new Array(2);t[0]=new _y.$2Q(_y.$d.get_$wa(),_y.$d.get_$1Zl(),_nbs.NonBootStrings.l_AcceptItem_LowerCase_Text,n.$qL);t[1]=new _y.$2Q(_y.$d.get_$9J(),_y.$d.get_$LH(),_u.Strings.l_Discard_Text,n.$EW);return t}_d.$5k.prototype={$1sA:null,$d:null,$qL:null,$EW:null,$5lQ:!1,$3hS:null,$12U:null,$LI:null,$Fq:null,$MN:null,$17j:null,$2Dc:null,get_$1Ip:function(){return this.$d.$AH},get_$2xu:function(){return _js.$8.$a(this.$d.get_$2xu())?_nbs.NonBootStrings.l_DefaultEventSubject_Text:this.$d.get_$2xu()},get_$4YF:function(){return this.$d.$A8},get_$KN:function(){return 1},get_$6OK:function(){return this.$17j},set_$6OK:function(n){this.$17j!==n&&(this.$17j=n);return n},get_$A7m:function(){return this.$2Dc},set_$A7m:function(n){this.$2Dc&&this.$2Dc.$1R();this.$2Dc=n;return n},$e6:function(){_y.$1Mq.prototype.$e6.call(this);$76K(this);$76G(this);$76I(this);$3bj(this,this.$1sA)},$l1:function(){_y.$1Mq.prototype.$l1.call(this);$76J(this);this.set_$A7m(null)},$FZ:function(){_y.$1Mq.prototype.$FZ.call(this);_a.$6.$19(null,this.$17j)},$6Mt:function(n,t){$2lL(this)},$9N0:function(n){$3bj(this,n)},$4O8:function(n,t){if(t.$2Z){if(t.$2Z===2){var u=this;Array.forEach(t.$3B,function(n){var t=n;$4t7(u,t.get_$6u())});$2lL(this)}}else{var i=new(_a.$3f.$$(String));var r=this;Array.forEach(t.$2q,function(n){var t=n;i.$D(t.get_$6u().EmailAddress);$1qD(r,t.get_$6u())});$3bj(this,i)}},$5C1:function(){var n=_cc.$1Lo.$1c.$I4.$6hz(!1);this.$d.$5C3();this.$d.$5C2();$4t6(this);_cc.$1Lo.$1c.$I4.$2Mi(n,null,null,null)},$iq:function(){var n=_cc.$1Lo.$1c.$I4.$6i0(!1);$4t6(this);_cc.$1Lo.$1c.$I4.$2Mi(n,null,null,null)},$9d4:function(){this.$d.get_$2rl()||this.$d.$1v.$2u(0,_nbs.NonBootStrings.l_Calendar_CannotChangeTimeOfRecurringMeetingInSchedulingAssistant_Text,null)},$27k:function(n,t){if(!$5(this.$MN)){$4t7(this,this.$MN);this.$MN=null}if(this.get_$1Ip().get_$1dC()){$1qD(this,this.get_$1Ip().get_$BT());this.$MN=this.get_$1Ip().get_$BT()}$2lL(this)}};_d.$KY=function(n){_d.$KY.resolveInheritance();this.apcl=this.$Y;this.rpcl=this.$q;_d.$KY.initializeBase(this);this.$5S=new _g.$1t(null);this.$2R=n.get_$y();this.$3H=n.get_$20();this.$n6=n.get_$99();this.$2bI=n.get_$2i();this.$4E=$5(n.get_$4g())?_g.$3V.$139(""):n.get_$4g();if(_js.$8.$a(this.$2bI)){var t=new _d.$kE;this.$Zc=t.$2x(this.$n6,null)}else this.$Zc=this.$2bI;n.get_$y()&&n.get_$20()&&(this.$20b=n.get_$1eg())};_d.$KY.$7o5=function(n,t){var i=new _d.$KY(n);i.$AQ=n.$AQ;var r=_d.$M0.$5Y0(t,n);i.$2R=r.$2R;i.$3H=r.$3H;return i};_d.$KY.prototype={$4E:null,$Zc:null,$n6:"Free",$2bI:null,$5S:null,$20b:!1,$AQ:null,$2R:null,$3H:null,get_$i:function(){return this.$5S},get_$FS:function(){return!1},get_$Ao:function(){return this.$3H.$5u(this.$2R)>=864e5},get_$1eg:function(){return this.$20b},get_$5R:function(){return!1},get_$Gj:function(){return!1},get_$20e:function(){return!1},get_$2Ru:function(){return!1},get_$dB:function(){return!1},get_$G5:function(){return!1},get_$2bE:function(){return""},get_$4g:function(){return this.$4E},get_$y:function(){return this.$2R},get_$20:function(){return this.$3H},get_$2i:function(){return this.$Zc},get_$99:function(){return this.$n6},get_$5V:function(){return this.$AQ},set_$5V:function(n){this.$AQ=n;return n},get_$ju:function(){return""},get_$48D:function(){return!1},get_$Hq:function(){throw Error.notImplemented("The IsOrganizer property is not supported in SchedulingItemViewModel");},get_$fH:function(){throw Error.notImplemented("The CanEdit property is not supported in SchedulingItemViewModel");}};_d.$tX=function(n,t,i){_d.$tX.initializeBase(this,[n,t,i]);this.$8X=!1};_d.$tX.prototype={$8X:!1,get_$6D:function(){return this.$8X},set_$6D:function(n){if(this.$8X!==n){this.$8X=n;$3(this,"IsBusy")}return n},get_$6WL:function(){return!this.$5B||!this.$5B.$18?String.format(_nbs.NonBootStrings.l_SchedulingRemoveAttendee_AT_Button_Text,""):String.format(_nbs.NonBootStrings.l_SchedulingRemoveAttendee_AT_Button_Text,this.$5B.$18.get_$1o())}};_d.$6p=function(n,t,i,r,u,f,e){this.$$d_$5g4=Function.createDelegate(this,this.$5g4);this.$$d_$6E=Function.createDelegate(this,this.$6E);this.$$d_$2t9=Function.createDelegate(this,this.$2t9);this.$$d_$4QU=Function.createDelegate(this,this.$4QU);this.$$d_$A2I=Function.createDelegate(this,this.$A2I);this.$$d_$A0M=Function.createDelegate(this,this.$A0M);this.$$d_$9mD=Function.createDelegate(this,this.$9mD);this.$$d_$iq=Function.createDelegate(this,this.$iq);this.$$d_$5C1=Function.createDelegate(this,this.$5C1);this.$$d_$5af=Function.createDelegate(this,this.$5af);this.$$d_$5ae=Function.createDelegate(this,this.$5ae);_d.$6p.initializeBase(this);_a.$3.$K(t,"calendarContext");this.$d=n;this.$18v=i;this.$1g=t;this.$k=u;this.$2eP=new _d.$7w(n,t);this.$2eN=new _d.$4m(n,t);this.$1Cf=r;this.$2P5=new _C(this.$$d_$5ae,_d.$6p.$A);this.$2P6=new _C(this.$$d_$5af,_d.$6p.$A);this.$qL=new _C(this.$$d_$5C1,_d.$6p.$A);this.$EW=new _C(this.$$d_$iq,_d.$6p.$A);this.$4VZ=new _C(this.$$d_$9mD,_d.$6p.$A);this.$2gE=new _C(this.$$d_$A0M,_a.$0.$El);this.$2ge=new _C(this.$$d_$A2I,_a.$0.$El);var s=this.$1g.$B;var o=s.get_$L();if(o==="Mouse"){this.$1Cf.$qL.set_$MT(this.$$d_$5C1);this.$1Cf.$EW.set_$MT(this.$$d_$iq)}var h=new _0365m.$o(_nbs.NonBootStrings.l_Scheduling_Affordance_RefreshFreeBusy_Text,null,this.$4VZ);this.$1Cf.$Fq.$14.$D(h);if(o!=="Mouse"){this.set_$6k(_y.$22.$Aj(this,$76N(this),$76M(this)));o==="TouchWide"&&this.$3y.set_$2sF($76O(this))}var c=!!f&&o==="Mouse"&&s.get_$9l();this.$bi=new _d.$QK(f,c);this.$Bo=t.$b.get_$5U();this.$12e=new _js.$c;this.$12e.$D(this.$2eN);this.$12e.$D(this.$2eP);this.$KU=e;this.$Pg=new _js.$c;this.$Pg.$D(new _0365m.$o(_nbs.NonBootStrings.l_Day_LowerCase_Text,null,this.$2gE));this.$Pg.$D(new _0365m.$o(_nbs.NonBootStrings.l_Week_LowerCase_Text,null,this.$2ge));this.$d.$Y("ViewStartDate",this.$$d_$4QU);s.add_$UA(this.$$d_$2t9);this.$17j="OpenSchedulingAssistantForm"};_d.$6p.$7ks=function(n,t,i,r){var u=new _d.$G5(n.$5p);u.set_$1tm(t);u.set_$2tA(i);u.set_$OQ(r);return u};function $76S(n){n.$1g.$B.remove_$UA(n.$$d_$2t9)}function $4t9(n,t){n.$Bo.set_$4YI(t);_h.$2D.$CL(n.$Bo.get_$Tz(),n.$k)}function $3bl(n){n.$1Kc=!0;n.$B7||n.$1R();n.get_$4h().get_$7T()===n&&n.get_$4h().$BP()}function $76N(n){var t=new Array(2);t[0]=new _y.$2Q(_y.$d.get_$wa(),_y.$d.get_$1Zl(),_nbs.NonBootStrings.l_AcceptItem_LowerCase_Text,n.$qL);t[1]=new _y.$2Q(_y.$d.get_$9J(),_y.$d.get_$LH(),_u.Strings.l_Discard_Text,n.$EW);return t}function $76O(n){var t=[];Array.add(t,new _y.$2Q(_y.$d.get_$1Nf(),_y.$d.get_$5Nh(),_nbs.NonBootStrings.l_Day_LowerCase_Text,n.$2gE));Array.add(t,new _y.$2Q(_y.$d.get_$6po(),_y.$d.get_$6pq(),_nbs.NonBootStrings.l_Week_LowerCase_Text,n.$2ge));return t}function $76M(n){return[new _y.$32(_nbs.NonBootStrings.l_Scheduling_Affordance_RefreshFreeBusy_Text,n.$4VZ)]}function $76P(n,t,i){var r=new _js.$c;var u=this;r.$D(new _a.$2E(new _C(function(){var t=_cc.$1Lo.$1c.$I4.$6i0(n.get_$20w());n.$qj.set_$OQ(!1);$3bl(n);i&&i();_cc.$1Lo.$1c.$I4.$2Mi(t,null,null,null)},_a.$0.$El),_u.Strings.l_ConfirmDialog_Discard_Text,_nbs.NonBootStrings.l_DontSaveChangesMadeToThisEvent_Text));if(n.$1g.$B.get_$L()==="Mouse"&&t){var f=this;r.$D(new _a.$2E(new _C(function(){n.$qj.set_$OQ(!1);n.$6E();i&&i()},_a.$0.$El),_nbs.NonBootStrings.l_ConfirmDialog_Popout_Text,_nbs.NonBootStrings.l_OpenANewWindowWhereMoreChangesCanBeMade_Text))}var e=this;r.$D(new _a.$2E(new _C(function(){n.$qj.set_$OQ(!1);n.$1Kc=!1},_a.$0.$El),_u.Strings.l_ConfirmDialog_Cancel_Text,_nbs.NonBootStrings.l_ReturnToEventForFurtherEditing_Text));return r}function $4tA(n,t,i){n.set_$7id(_d.$6p.$7ks(n.$d.$p,_nbs.NonBootStrings.l_Calendar_Scheduling_LeaveSchedulingFormDialog_Title_Text,$76P(n,t===1,i),!0))}function $76R(n){return(!n.$qj||!n.$qj.$135)&&!n.$1Kc&&$76Q(n)}function $76Q(n){return n.get_$FQ()||n.$d.$p.get_$1zS()}function $76L(n){n.$B7||n.$1R()}_d.$6p.prototype={$2eP:null,$2eN:null,$k:null,$1Cf:null,$d:null,$1g:null,$qL:null,$EW:null,$4VZ:null,$2P5:null,$2P6:null,$Bo:null,$bi:null,$KU:null,$12e:null,$Pg:null,$2ge:null,$2gE:null,$18v:null,$ef:0,$qj:null,$1Kc:!1,$17j:null,add_$6ZT:function(n){this.$2G("SchedulingChangesApplied",n)},remove_$6ZT:function(n){this.$2H("SchedulingChangesApplied",n)},get_$6at:function(){return this.$18v.get_$18u()},get_$9tO:function(){return this.$d.$NU},get_$9tK:function(){return this.$d.$cq},get_$9tP:function(){return this.$d.$p.$v.get_$9F()},get_$5Q5:function(){var n=this.$d.$SU;switch(this.$ef){case 1:return n.$2b(3);case 3:var t=_a.$7.$Mb(n);var i=t.$2w(6);return _a.$7.$2OZ(t,i);default:return""}},get_$KN:function(){return this.$1g.$B.get_$L()!=="Mouse"?1:0},get_$6OK:function(){return this.$17j},set_$6OK:function(n){this.$17j!==n&&(this.$17j=n);return n},get_$1I2:function(){return new _C(this.$$d_$6E,_a.$0.$El)},get_$eS:function(){return this.$bi.get_$eS()},get_$1kp:function(){return 1},get_$2PH:function(){return this.$$d_$5g4},get_$1oO:function(){return this.$ef},set_$1oO:function(n){if(this.$ef!==n){this.$ef=n;$3u(this,"TimeStripMode","DisplayedDateString")}return n},get_$7id:function(){return this.$qj},set_$7id:function(n){if(this.$qj!==n){this.$qj=n;$3(this,"ConfirmationDialog")}return n},get_$FQ:function(){return!this.$1Kc&&this.$d.get_$1zS()},get_$20w:function(){return this.$1g.$B.get_$L()==="Mouse"&&!this.get_$eS()},$e6:function(){_y.$1Mq.prototype.$e6.call(this);this.$1Cf.$e6();if(this.$Bo.get_$4YI()===1){this.set_$1oO(1);this.$KU.$N9(this.$2eN);this.$Pg.get_$3o(0).set_$2L(!0)}else{this.set_$1oO(3);this.$KU.$N9(this.$2eP);this.$Pg.get_$3o(1).set_$2L(!0)}},$l1:function(){_y.$1Mq.prototype.$l1.call(this);this.$1Cf.$l1()},$FZ:function(){_y.$1Mq.prototype.$FZ.call(this);_a.$6.$19(null,this.$17j)},$5g4:function(n,t){var i=!0;var r=!i;if(this.$qj&&this.$qj.$135)return i;if($76R(this)){$4tA(this,t,n);return i}$76L(this);return r},$49:function(){$76S(this);this.$2eN.$1R();this.$2eP.$1R();_a.$1.prototype.$49.call(this)},$2t9:function(n){this.get_$FQ()&&_js.$8.$a(n.$1ID)&&n.$1Lk(_nbs.NonBootStrings.l_Calendar_BrowserWindowUnloadWarning_Text)},$5C1:function(){var n=_cc.$1Lo.$1c.$I4.$6hz(this.get_$20w());this.$d.$5C3();this.$d.$5C2();$Cq(this,"SchedulingChangesApplied",this);$3bl(this);_cc.$1Lo.$1c.$I4.$2Mi(n,null,null,null)},$iq:function(){this.get_$FQ()?$4tA(this,2,null):$3bl(this)},$5ae:function(){this.$ef===1?this.$d.set_$py(this.$d.$SU.$2w(1)):this.$d.set_$py(this.$d.$SU.$2w(7))},$5af:function(){this.$ef===1?this.$d.set_$py(this.$d.$SU.$2w(-1)):this.$d.set_$py(this.$d.$SU.$2w(-7))},$9mD:function(){this.$d.$OL.$hG()},$A0M:function(){if(this.$ef!==1){_a.$6.$1X(_a.$0.$El,"SchedulingAssistant_SwitchToDayView");this.set_$1oO(1);this.$KU.$N9(this.$2eN);$4t9(this,1);$3(this,"DisplayedDateString");this.$Pg.get_$3o(0).set_$2L(!0);this.$Pg.get_$3o(1).set_$2L(!1)}},$A2I:function(){if(this.$ef!==3){_a.$6.$1X(_a.$0.$El,"SchedulingAssistant_SwitchToWeekView");this.set_$1oO(3);this.$KU.$N9(this.$2eP);$4t9(this,2);$3(this,"DisplayedDateString");this.$Pg.get_$3o(0).set_$2L(!1);this.$Pg.get_$3o(1).set_$2L(!0)}},$4QU:function(n,t){$3(this,"DisplayedDateString")},$6E:function(){var n=_cc.$1Lo.$1c.$I4.$A3v();this.$1Kc=!0;this.$bi.get_$1I2().$s();_cc.$1Lo.$1c.$I4.$2Mi(n,null,null,null)}};_d.$Fm=function(n,t,i,r,u,f,e,o,s,h){this.$j2=n;this.$5Aa=f;this.$k=e;this.$3Xc=r;this.$2AL=u;this.$X4=t;this.$b=i;this.$44=o;this.$mM=s;this.$J=h};function $3bm(n,t,i,r,u,f,e,o,s,h){_a.$3.$m(n.$3Y3,"RecipientWellViewModelFactory");_a.$3.$m(n.$10y,"SchedulingPersonaViewModelFactory");_a.$3.$m(s,"parameters should not be null");var a=_cc.$1P.$5Kx(!0);var g=new _cc.$Kq(new _js.$c,null,a,n.$44);var p=new _d.$IB(null,g,a,null,n.$X4,n.$b,null,null,n.$J);var nt=n.$81r();var l=n.$3Xc.$E(t,a);var w=n.$2AL.$5Ks(t,l);var b=n.$2AL.$E(t,l,w);var c=new _d.$6h(new _d.$129("SchedulingContextViewModel"),t,i,l,b,nt,new _y.$4p,!u,f);l.set_$6ZU(c);var v=new _g.$9I;v.set_$nc(!0);v.set_$AX(c.get_$1bv().EmailAddress);p.set_$x4(v);var tt=n.$7kA(b,w,l);var it=new _d.$7K(c.$NU.get_$AIt(),c.$cq.get_$AIt(),$76U(n,c),c.$AH,_nbs.NonBootStrings.l_AddAttendeeWatermark_Text,n.$7lf(),n.$3Y3,n.$10y,f,e);var y=null;if(s.get_$1Wq()){var rt=new _d.$1GY(s.get_$1Wq());y=new _d.$uC(rt,c.$A8);y.$8K=s.get_$4g5()}var k=$76V(n,c,it,tt,y,o);k.set_$6OK(h);var d=new _d.$6p(c,p,c.$A8,k,n.$k,r,new _y.$FO);d.set_$6OK(h);return d}function $4tB(n,t){var i=new _g.$1q;i.EmailAddress=n.$b.get_$2z().get_$AM();i.Name=n.$b.get_$2z().get_$Fn();i.MailboxType="Mailbox";var r=n.$mM.$1u1(i);$76T(n,r,t);return r}function $76T(n,t,i){t.set_$2i(i.get_$7wM());t.set_$y(i.get_$1t0().get_$y());t.set_$20(i.get_$1t0().get_$20());t.set_$5R(i.get_$1t0().get_$5R());t.set_$7G(i.get_$7G());t.set_$8D(i.get_$8D());t.set_$9F(i.get_$9F())}function $76V(n,t,i,r,u,f){return new _d.$5k(n.$X4,t,i,r,u,f)}function $76U(n,t){var i=_pc.$l.$Dh(t.get_$1bv());var r=n.$10y.$2tq(i,_y.$17.$Km,!0,3);return new _d.$tX(r,1,!0)}_d.$Fm.prototype={$X4:null,$b:null,$J:null,$j2:null,$3Xc:null,$2AL:null,$5Aa:null,$k:null,$44:null,$10y:null,$Je:null,$3Y3:null,$mM:null,$E:function(n,t,i,r,u,f){return $3bm(this,n,t,i,r,u,!1,!1,new _cc.$tW(n.get_$5Q()),f)},$7ns:function(n){_a.$3.$m(this.$Je,"CalendarItemViewModelFactory");var t=$4tB(this,n);return $3bm(this,this.$Je.$8V(t),new _d.$Dv(n.get_$1t0()),null,!1,!0,!1,!1,n,null)},$7lu:function(n){_a.$3.$m(this.$Je,"CalendarItemViewModelFactory");var t=$4tB(this,n);return $3bm(this,this.$Je.$8V(t),new _d.$Dv(n.get_$1t0()),null,!1,!0,!0,!0,n,null)},$7kA:function(n,t,i){return this.$5Aa.$E(n,t,i)},$81r:function(){return 1},$7lf:function(){var n=this.$j2.$E(_pc.$15.$xo,_pc.$15.$jD(),!0,"PersonaDetailedView",!1,null,this.$10y);_d.$DR.$1aH(n);return n}};_d.$7w=function(n,t){this.$$d_$9e6=Function.createDelegate(this,this.$9e6);this.$$d_$6K5=Function.createDelegate(this,this.$6K5);this.$$d_$6K6=Function.createDelegate(this,this.$6K6);this.$$d_$4PD=Function.createDelegate(this,this.$4PD);this.$$d_$27k=Function.createDelegate(this,this.$27k);this.$$d_$3K1=Function.createDelegate(this,this.$3K1);this.$$d_$4QU=Function.createDelegate(this,this.$4QU);_d.$7w.resolveInheritance();this.dispose=this.$1R;_d.$7w.initializeBase(this,[n.$A8.get_$y(),null,null,null,null,t,null]);_a.$3.$K(t,"calendarContext");this.$d=n;this.$1N0=new(_a.$3f.$$(String));this.$5J9=new _d.$KX(this.$d);this.$20E=this.$1g.$B.get_$L()==="Mouse";this.$1TD=!0;this.$2vG=!0;this.$d.$Y("ViewStartDate",this.$$d_$4QU);this.$d.$NU.add_$1Y(this.$$d_$3K1);this.$d.$AH.apcl("SelectedRoomViewModel",this.$$d_$27k);this.$d.$OL.add_$316(this.$$d_$4PD);this.$Y("GridSelectedRowColumnIndex",this.$$d_$6K6);this.$20E&&this.$Y("GridHoveredRowColumnIndex",this.$$d_$6K5)};function $4tC(n){var t=n.$1g.$Cw;var i=n.$1g.$b;if(_g.$KB.isInstanceOfType(t.get_$5V())){var r=t.get_$5V();if(r.OwnerEmailAddress===i.get_$2z().get_$AM()){var u=i.get_$13().get_$MF();n.$1g.$2M.$AE9(t,u)}}}function $4tE(n){if(n.$d.$AH.get_$BT()){n.$MN=n.$d.$AH.get_$BT();n.$1N0.$D(n.$MN.EmailAddress)}}function $76W(n){n.set_$Ak(n.$d.$SU);$4tD(n);n.$1N0.$1t();for(var t=0;t<n.$d.$NU.get_$C();t++)n.$1N0.$D(n.$d.$NU.get_$3o(t).get_$6u().EmailAddress);$4tE(n)}function $1qE(n){_js.Trace.logInfo(_a.$0.$El,"WeekView PopulatingItemCollection WeekViewModel");n.$2AB();var i=n.$d.$OL.$82S(n.$d.get_$1bv().EmailAddress,n.$1N0);try{n.set_$dE(!0);for(var t=0;t<i.get_$C();t++){var r=i.get_$3o(t);n.$IB(r)}}finally{n.set_$dE(!1)}}function $4tD(n){var t=_a.$7.$Mb(n.$d.$SU.$4D());var i=t.$2w(7);n.$13C=new _h.$4i(t,i)}function $1qF(n){if(n.$2vG){n.$1TD=!0;return!1}return!0}_d.$7w.prototype={$1N0:null,$d:null,$20E:!1,$5J9:null,$MN:null,$2vG:!1,$1TD:!1,$13C:null,get_$UI:function(){return this.$d},get_$1N:function(){return"SchedulingWeekViewModel"},get_$3kv:function(){return 24},get_$5GI:function(){return this.$d.get_$2rl()},get_$Ak:function(){return _d.$1s.prototype.get_$Ak.call(this)},set_$Ak:function(n){_a.$7.$4N(_a.$7.$Mb(this.get_$Ak()).$4D(),_a.$7.$Mb(n).$4D())||_d.$1s.prototype.set_$Ak.call(this,n);return n},get_$YK:function(){return _d.$7o.prototype.get_$YK.call(this)},set_$YK:function(n){if(n===this.get_$YK())return n;_d.$7o.prototype.set_$YK.call(this,n);var t=this.$1g.$b.get_$13().get_$MF();if(n){t.$Y("WorkHoursStartTimeInMinutes",this.$$d_$9e6);t.$Y("WorkHoursEndTimeInMinutes",this.$$d_$9e6)}else{t.$q("WorkHoursStartTimeInMinutes",this.$$d_$9e6);t.$q("WorkHoursEndTimeInMinutes",this.$$d_$9e6)}return n},$e6:function(){this.$2vG=!1;this.$d.$36b=!0;if(this.$1TD){$76W(this);$1qE(this)}},$FZ:function(){_a.$6.$19(null,"SchedulingAssistant_SwitchToWeekView")},$l1:function(){this.$2vG=!0;this.$1TD=!1},$TZ:function(){},$6Ny:function(n,t){_d.$1s.prototype.$6Ny.call(this,n,t);$4tC(this)},$1k0:function(n,t){_d.$1s.prototype.$1k0.call(this,n,t);this.$d.set_$py(this.$EU.$2R);this.set_$Ak(this.$d.$SU);var i=_a.$7.$Mb(this.$d.$SU.$4D());var u=i.$2w(7);var r=new _h.$4i(i,u);if(!_a.$7.$4N(r,this.$13C)){this.$13C=r;$1qE(this)}this.$d.$OL.$ABr(this.$d.$SU)},$49:function(){this.$OS.dispose();this.$d.$q("ViewStartDate",this.$$d_$4QU);this.$d.$NU.remove_$1Y(this.$$d_$3K1);this.$d.$AH.rpcl("SelectedRoomViewModel",this.$$d_$27k);this.$d.$OL.remove_$316(this.$$d_$4PD);this.$q("GridSelectedRowColumnIndex",this.$$d_$6K6);this.$20E&&this.$q("GridHoveredRowColumnIndex",this.$$d_$6K5);_d.$1s.prototype.$49.call(this)},$3hD:function(n){throw Error.notImplemented();},$IB:function(n){this.$t.$D(n)},$4PD:function(n){$1qF(this)&&$1qE(this)},$9e6:function(n,t){$4tC(this)},$3K1:function(n,t){if($1qF(this)){switch(t.$2Z){case 0:for(var i=t.$2q.length-1;i>=0;i--)this.$1N0.$D(t.$2q[i].get_$6u().EmailAddress);break;case 2:for(var r=t.$3B.length-1;r>=0;r--)this.$1N0.$34(t.$3B[r].get_$6u().EmailAddress);break;default:break}$1qE(this)}},$4QU:function(n,t){if($1qF(this)){this.set_$Ak(this.$d.$SU);if(this.$13C.$mb(this.$d.$SU,!0,!1))_js.Trace.logInfo(_a.$0.$El,"Ignoring ViewStart :{0} because it is within the current date range:{1}",this.$d.$SU,this.$13C);else{$4tD(this);$1qE(this)}}},$6K6:function(n,t){if($1qF(this)&&this.$Q9)if(this.get_$5GI()){var i=$2FE(this,this.$Q9.$M5);this.$d.$A8.get_$5R()?this.$d.$A8.set_$y(new _a.$7(i.get_$4S(),i.get_$3T(),i.get_$5n(),this.$d.$A8.get_$y().get_$ED(),this.$d.$A8.get_$y().get_$Gp(),this.$d.$A8.get_$y().get_$Tm(),this.$d.$A8.get_$y().get_$zs())):this.$d.$A8.set_$y(i)}else this.$d.$1v.$2u(0,_nbs.NonBootStrings.l_Calendar_CannotChangeTimeOfRecurringMeetingInSchedulingAssistant_Text,null)},$6K5:function(n,t){if($1qF(this))if(this.$1DY){var i=$2FE(this,this.$1DY);var r=new _h.$4i(i,i.$9v(this.$d.$A8.$3oE));this.$d.set_$6T2(r)}else this.$d.set_$2CH(!1)},$27k:function(n,t){if($1qF(this)){if(this.$MN){this.$1N0.$34(this.$MN.EmailAddress);this.$MN=null}$4tE(this);$1qE(this)}}};_d.$1GY=function(n){this.$3VX=new(_a.$Z.$$(_cc.$NE))(n.$6W())};_d.$1GY.prototype={$3VX:null,get_$1Wq:function(){return this.$3VX}};_d.$uC=function(n,t){this.$$d_$9b6=Function.createDelegate(this,this.$9b6);this.$8K="";_d.$uC.initializeBase(this);this.$6kI=n;this.$18v=t;this.$18v.add_$3Qr(this.$$d_$9b6)};_d.$uC.prototype={$6kI:null,$18v:null,$t:null,$12:null,get_$3O:function(){if(!this.$t){var t=this.$6kI.get_$1Wq();this.$t=new(_a.$Z.$$(_d.$uD));for(var n=0;n<t.get_$C();n++){this.$t.$D(new _d.$uD(t.get_$3o(n)));this.$18v.get_$18u()&&_g.$WV.$4N(this.$18v.get_$18u(),t.get_$3o(n).$1MO)&&this.set_$1p(this.get_$3O().get_$3o(n))}}return this.$t},get_$1p:function(){return this.$12},set_$1p:function(n){if(n!==this.$12){this.$12&&this.$12.set_$2L(!1);this.$12=n;if(this.$12){this.$12.set_$2L(!0);this.$18v.remove_$3Qr(this.$$d_$9b6);this.$18v.set_$18u(this.$12.$3VW.$1MO);this.$18v.add_$3Qr(this.$$d_$9b6)}$3(this,"SelectedItem")}return n},$49:function(){this.$18v.remove_$3Qr(this.$$d_$9b6);_a.$1.prototype.$49.call(this)},$9b6:function(n){for(var i=!1,t=0;t<this.get_$3O().get_$C();t++){var r=this.get_$3O().get_$3o(t).$3VW;if(_g.$WV.$4N(r.$1MO,n)){this.set_$1p(this.get_$3O().get_$3o(t));i=!0;break}}i||this.set_$1p(null)}};_d.$uD=function(n){_d.$uD.initializeBase(this);this.$3VW=n};_d.$uD.prototype={$3VW:null,$38:!1,get_$2L:function(){return this.$38},set_$2L:function(n){if(n!==this.$38){this.$38=n;$3(this,"IsSelected")}return n}};_d.$FE=function(n,t,i,r,u,f){_d.$FE.initializeBase(this);this.$14Q=t;this.$B6=n;this.$5cO=r;this.$PV=u;this.$r4=i;this.$wo=f;this.$2Jv=$76w(this)};_d.$FE.$5Ws=function(n){var t=new _js.$c;var i=n;for(var r in i){var u={key:r,value:i[r]};var f=u.value;f.get_$6D()&&t.$D(u.value)}return t};_d.$FE.$3oV=function(n,t){var i=t?_nbs.NonBootStrings.l_ZeroNewConflicts_Text:_nbs.NonBootStrings.l_ZeroConflicts_Text;var r=t?_nbs.NonBootStrings.l_OneNewConflict_Text:_nbs.NonBootStrings.l_OneConflict_Text;var u=t?_nbs.NonBootStrings.l_ManyNewConflicts_Text:_nbs.NonBootStrings.l_ManyConflicts_Text;switch(n){case 0:return i;case 1:return r;default:return String.format(u,n)}};_d.$FE.$5MF=function(n){return String.format(_a.$8Y.$3yu(n,_nbs.NonBootStrings.l_TotalRequiredAttandees_Singular_Upper_Case_Text,_nbs.NonBootStrings.l_TotalRequiredAttandees_FirstPlural_Upper_Case_Text,_nbs.NonBootStrings.l_TotalRequiredAttandees_SecondGenitivePlural_Upper_Case_Text),n)};_d.$FE.$7oT=function(n){return String.format(_a.$8Y.$3yu(n,_nbs.NonBootStrings.l_TotalOptionalAttandees_Singular_Upper_Case_Text,_nbs.NonBootStrings.l_TotalOptionalAttandees_FirstPlural_Upper_Case_Text,_nbs.NonBootStrings.l_TotalOptionalAttandees_SecondGenitivePlural_Upper_Case_Text),n)};function $76w(n){var t="";if(n.get_$6D()&&!$5(n.$wo)){var i=n.$wo.get_$C();if(i>1)t=String.format(_nbs.NonBootStrings.l_ConflictStatus_Text,i);else if(i===1){var r=n.$wo.get_$3o(0);$5(r)||_js.$8.$a(r.$2bI)||(t=r.$2bI)}}return t}_d.$FE.prototype={$14Q:"Free",$B6:null,$r4:null,$2Jv:null,$5cO:!1,$PV:"NoError",$wo:null,$7K:null,get_$6D:function(){return this.$5cO?!1:_d.$4B.$6D(this.$14Q)}};_d.$Ek=function(n,t,i,r){this.$$d_$6an=Function.createDelegate(this,this.$6an);this.$$d_$7xn=Function.createDelegate(this,this.$7xn);_d.$Ek.initializeBase(this);this.$OL=n;this.$AH=t;this.$2yT=i;this.$B=r;this.$vx=!1;this.$3hR="AddRoom_SchedulingAssistant";this.$2NJ=new _C(this.$$d_$7xn,_d.$Ek.$A);this.$2NJ.set_$69(!1);$3aN(this)};function $4p6(n){n.$AH.apcl("SelectedRoomViewModel",n.$$d_$6an)}function $4p7(n){n.$AH.rpcl("SelectedRoomViewModel",n.$$d_$6an)}function $3aN(n){n.set_$7xo(n.$AH.get_$1dC()?_nbs.NonBootStrings.l_ChangeRoomButton_Text:_nbs.NonBootStrings.l_FindRoomButton_Text)}_d.$Ek.prototype={$AH:null,$OL:null,$vx:!1,$B:null,$2NJ:null,$2yT:null,$2yS:null,$3hR:null,get_$7xo:function(){return this.$2yS},set_$7xo:function(n){if(this.$2yS!==n){this.$2yS=n;$3u(this,"FindARoomButtonLabel","HideFindARoomControl")}return n},get_$8EA:function(){return this.$B.get_$L()==="TouchNarrow"&&this.$AH.get_$1dC()},$5m:function(){if(!this.$vx){this.$6VP();this.$vx=!0;this.$2NJ.set_$69(!0)}},$78:function(){if(this.$vx){this.$4ho();this.$vx=!1;this.$2NJ.set_$69(!1)}},$49:function(){this.$4ho();_a.$1.prototype.$49.call(this)},$6VP:function(){$4p6(this)},$4ho:function(){$4p7(this)},$6an:function(n,t){$3aN(this)},$7xn:function(){_a.$6.$1X(_a.$0.$El,this.$3hR);this.$B.get_$L()==="TouchNarrow"?this.$B.$fj(this.$2yT,0,!1):this.$2yT.set_$18B(!0)}};_d.$ie=function(n,t){this.$2NK=n;this.$B=t};_d.$ie.prototype={$2NK:null,$B:null,$E:function(n,t,i){var r=this.$2NK.$7lv(n,t);return new _d.$Ek(i,n,r,this.$B)}};_d.$G2=function(n,t){this.$$d_$AF=Function.createDelegate(this,this.$AF);this.$$d_$9le=Function.createDelegate(this,this.$9le);_d.$G2.resolveInheritance();this.apcl=this.$Y;this.rpcl=this.$q;_d.$G2.initializeBase(this);this.$1k=n;this.$61=t;this.$5s=new Sys.EventHandlerList;this.set_$3Sv(!0);this.$Y("IsDataLoaded",this.$$d_$9le);this.$Y("HasErrorOccurred",this.$$d_$9le);this.$1lv=new _C(this.$$d_$AF,_a.$0.$El)};function $1AL(n,t){var i=n.$5s.getHandler("StepCompleted");$5(i)||i(t)}_d.$G2.prototype={$61:null,$5s:null,$1lv:null,$1k:null,$9k:!1,$jZ:!1,$1Dg:!1,$1JU:!1,$1oW:0,add_$hb:function(n){this.$5s.addHandler("StepCompleted",n)},remove_$hb:function(n){this.$5s.removeHandler("StepCompleted",n)},get_$1N:function(){return this.$1k},get_$Gg:function(){return this.$9k},set_$Gg:function(n){if(this.$9k!==n){this.$9k=n;$3(this,"IsActive")}return n},get_$1eB:function(){return this.$jZ},set_$1eB:function(n){if(this.$jZ!==n){this.$jZ=n;$3u(this,"IsDataLoaded","HasNoRoomsFound")}return n},get_$40Y:function(){return this.$jZ&&!this.$1oW},get_$3Sv:function(){return this.$1JU},set_$3Sv:function(n){if(this.$1JU!==n){this.$1JU=n;$3(this,"ShowLoadingMessage")}return n},get_$14q:function(){return this.$1Dg},set_$14q:function(n){if(this.$1Dg!==n){this.$1Dg=n;$3(this,"HasErrorOccurred")}return n},get_$6kx:function(){return this.$1oW},set_$6kx:function(n){if(this.$1oW!==n){this.$1oW=n;$3u(this,"TotalNumberOfItems","HasNoRoomsFound")}return n},$7vh:function(){this.$3JT();this.set_$Gg(!0)},$7x4:function(){this.$3JW();this.set_$Gg(!1)},$9le:function(n,t){this.set_$3Sv(!this.$jZ&&!this.$1Dg)},$AF:function(){this.$3JW();this.$3JT()}};_d.$Gr=function(n,t,i,r){this.$$d_$6XW=Function.createDelegate(this,this.$6XW);this.$$d_$9cJ=Function.createDelegate(this,this.$9cJ);this.$$d_$4O=Function.createDelegate(this,this.$4O);_d.$Gr.initializeBase(this);this.$3UQ={};this.$3UQ[n.get_$1N()]=n;this.$3UQ[t.get_$1N()]=t;this.$AS=n;this.$B=i;this.$TW=!1;this.$3vU=r||"AddRoom_SchedulingAssistant";if(this.$B.get_$L()==="TouchNarrow"){var u=[new _y.$2Q(_y.$d.get_$9J(),_y.$d.get_$LH(),_u.Strings.l_Discard_Text,new _C(this.$$d_$4O,_a.$0.$El))];this.set_$6k(_y.$22.$Aj(this,u,null))}};function $71c(n,t){$5(n.$AS)||$3ay(n);n.set_$3qF(t);$3ax(n)}function $3ax(n){n.$AS.add_$hb(n.$$d_$9cJ);n.$AS.add_$83(n.$$d_$6XW);n.$AS.$7vh();n.$6XW(n,null);_a.$6.$19(null,n.$3vU)}function $3ay(n){n.$AS.remove_$hb(n.$$d_$9cJ);n.$AS.remove_$83(n.$$d_$6XW);n.$AS.$7x4()}_d.$Gr.prototype={$B:null,$3UQ:null,$AS:null,$lD:null,$TW:!1,$3vU:null,get_$18B:function(){return this.$TW},set_$18B:function(n){if(this.$TW===n)return n;this.$TW=n;$3(this,"PopupVisible");this.$TW?$3ax(this):$3ay(this);return n},get_$3qF:function(){return this.$AS},set_$3qF:function(n){if(this.$AS!==n){this.$AS=n;$3(this,"CurrentStep")}return n},get_$KN:function(){return this.$B.get_$L()==="TouchNarrow"?1:0},$e6:function(){_y.$1Mq.prototype.$e6.call(this);$3ax(this)},$l1:function(){$3ay(this);_y.$1Mq.prototype.$l1.call(this)},$FZ:function(){_y.$1Mq.prototype.$FZ.call(this);_a.$6.$19(null,this.$3vU)},$4O:function(){this.get_$4h().$BP()},$9cJ:function(n){if(_js.$8.$a(n)){this.$B.get_$L()==="TouchNarrow"?this.$4O():this.set_$18B(!1);return}var t=this.$3UQ[n];$71c(this,t)},$6XW:function(n,t){_a.$3.$m(this.$lD,"ResizeCommand cannot be null.");this.$lD.$s()}};_d.$PX=function(n,t,i){this.$k=n;this.$Bo=t;this.$B=i};function $4qu(n,t){var i=this;return new _d.$QY(n.$k,n.$Bo,t,function(){return new _c.$17q})}_d.$PX.prototype={$k:null,$Bo:null,$B:null,$7lv:function(n,t){var i=$4qu(this,n);var r=new _d.$N1(n,t);return new _d.$Gr(i,r,this.$B,"AddRoom_SchedulingAssistant")},$7lq:function(n,t){var i=$4qu(this,n);var r=new _d.$1E4(n,t);return new _d.$Gr(i,r,this.$B,"AddRoom_ComposeForm")}};_d.$Ij=function(n,t,i){this.$$d_$2ey=Function.createDelegate(this,this.$2ey);this.$$d_$9nL=Function.createDelegate(this,this.$9nL);this.$$d_$6Mz=Function.createDelegate(this,this.$6Mz);this.$$d_$4QA=Function.createDelegate(this,this.$4QA);this.$$d_$27O=Function.createDelegate(this,this.$27O);_d.$Ij.resolveInheritance();this.apcl=this.$Y;this.rpcl=this.$q;_d.$Ij.initializeBase(this);this.$2d=n;this.$2d.add_$2ux(this.$$d_$27O);this.$Em=t;this.$Y("SelectedDateRange",this.$$d_$4QA);this.$Y("selectedRoomEmailAddress",this.$$d_$6Mz);this.$4WE=new _C(this.$$d_$9nL,_a.$0.$1c);var r=this;this.$4Ms=new _C(this.$$d_$2ey,_a.$0.$1c,this,"CanSelectNextAvailableRoom",function(){return r.get_$1Za()});this.$1TQ=new _g.$1q;this.$1TQ.Name=_nbs.NonBootStrings.l_GenericRoomListName_Text;this.$1TQ.EmailAddress="@noRoomListsAvailableMailbox";this.$8d=new _0365m.$2c([]);$4sy(this);this.set_$BT(i)};function $4sy(n){n.$8d.$14.$1t();n.$8d.$14.$D(new _0365m.$o(_nbs.NonBootStrings.l_RemoveRoom_LowerCase_Text,null,n.$4WE));n.get_$1Za()&&n.$8d.$14.$D(new _0365m.$o(_nbs.NonBootStrings.l_NextAvailableRoom_LowerCase_Text,null,n.$4Ms))}function $3bg(n,t){$760(n,t);$75z(n,t);$3(n,"CanSelectNextAvailableRoom")}function $75z(n,t){if(n.get_$1Za()){var r=t.get_$6D()?0:1;var i=n.$2d.get_$rO().get_$C()-r;i?i===1?t.set_$4ZL(_nbs.NonBootStrings.l_OneAvailableRoom_Text):t.set_$4ZL(String.format(_nbs.NonBootStrings.l_ManyAvailableRooms_Text,i)):t.set_$4ZL("")}}function $760(n,t){n.$1TR?t.set_$5VS(new _d.$FE(n.$ZR.EmailAddress,"Busy",_nbs.NonBootStrings.l_NoRoomsAvailable_Text,!1,"NoError",null)):t.set_$5VS(n.$2d.$847(n.$ZR,n.$Em))}_d.$Ij.prototype={$2d:null,$8d:null,$4WE:null,$4Ms:null,$1TQ:null,$1VY:null,$40a:!1,$1rd:!1,$ZR:null,$Em:null,$un:null,$1TR:!1,get_$1Za:function(){if(!this.$2d.get_$1eQ()||!this.$1rd||!this.$2d.get_$1eB())return!1;var n=this.get_$1dC()&&!this.$un.get_$6D()?1:0;return this.$2d.get_$rO().get_$C()-n>0},get_$2Jz:function(){return this.$8d},get_$1dC:function(){return!$5(this.$un)&&!this.$1TR},get_$1YR:function(){return this.$1rd},set_$1YR:function(n){if(this.$1rd===n)return n;this.$1rd=n;$3(this,"CanSelectNextAvailableRoom");this.$1TR=!1;if(this.$1rd){this.$un=null;if(this.get_$1Za())this.$2ey();else{this.$1TR=!0;this.set_$BT(this.$1VY||this.$1TQ);this.$2d.get_$2qQ().set_$2B3(this.$ZR)}}else this.$2d.get_$2qQ().set_$2B3(null);return n},get_$HZ:function(){return this.$1VY},set_$HZ:function(n){if(this.$1VY!==n||!n&&!this.$40a){this.$40a=!0;this.$1VY=n;this.set_$1YR(!1);$3(this,"selectedRoomListEmailAddress")}return n},get_$BT:function(){return this.$ZR},set_$BT:function(n){if(this.$ZR!==n){this.$ZR=n;$3(this,"selectedRoomEmailAddress")}return n},get_$bu:function(){return this.$Em},set_$bu:function(n){if(this.$Em!==n){this.$Em=n;$3(this,"SelectedDateRange")}return n},get_$3Qn:function(){return this.$un},set_$3Qn:function(n){if(this.$un!==n){this.$un=n;$3(this,"SelectedRoomViewModel")}return n},get_$9Jf:function(){return this.$1TQ},get_$9tQ:function(){return!!this.$ZR&&(_g.$2R.$4i(this.$ZR,this.$1VY)||_g.$2R.$4i(this.$ZR,this.$1TQ))},$3xb:function(n){var t=new(_a.$3f.$$(String));if(this.$ZR){t.$D(this.$ZR.EmailAddress);n=!0}if(this.$2d.get_$1eQ()&&n)for(var r=this.$2d.get_$9qp(),i=0;i<r.get_$C();i++)t.$D(r.get_$3o(i));return t},$6Mz:function(n,t){if($5(this.$ZR)){this.set_$3Qn(null);this.set_$1YR(!1)}else{var i=new _d.$111(this.$ZR,this.$4Ms,this.$4WE);i.set_$3Sv(!this.$2d.get_$1eB());$3bg(this,i);this.set_$3Qn(i);$4sy(this)}},$4QA:function(n,t){this.$40a&&this.$2d.$5ZJ(this.$1VY,this.$Em);this.get_$1dC()&&$3bg(this,this.$un);if(this.$1rd&&(this.$un.get_$6D()||this.$1TR))if(this.get_$1Za()){this.$1TR=!1;this.$2ey();$3(this,"CanSelectNextAvailableRoom")}else{this.$1TR=!0;this.set_$BT(this.$1VY||this.$1TQ);this.$2d.get_$2qQ().set_$2B3(this.$ZR)}},$27O:function(){if(this.get_$1Za()&&(_g.$2R.$4i(this.$ZR,this.$1VY)||_g.$2R.$4i(this.$ZR,this.$1TQ))){this.$1TR=!1;this.$2ey()}else if(this.$un){this.$un.set_$3Sv(!this.$2d.get_$1eB());$3bg(this,this.$un);this.$un.get_$6D()&&this.get_$1Za()&&this.$2ey()}},$9nL:function(){this.set_$BT(null)},$2ey:function(){var n=this.$2d.$3xr(this.$ZR);var t=this.$2d.get_$rO();n=(n+1+t.get_$C())%t.get_$C();this.set_$BT(t.get_$3o(n).$B6);this.$2d.get_$2qQ().set_$2B3(this.$ZR)}};_d.$mZ=function(n,t){_d.$mZ.initializeBase(this);this.$B6=n;if(t)switch(t.$14Q){case"Free":this.$r4=_nbs.NonBootStrings.l_FreeRoom_Text;break;case"NoData":this.$r4=_nbs.NonBootStrings.l_NoDataRoom_Text;break;case"Tentative":this.$r4=_nbs.NonBootStrings.l_TentativeRoom_Text;break;case"WorkingElsewhere":this.$r4=_nbs.NonBootStrings.l_WorkingElsewhereRoom_Text;break;case"OOF":this.$r4=_nbs.NonBootStrings.l_AwayRoom_Text;break;default:this.$r4=_nbs.NonBootStrings.l_BusyRoom_Text;break}else this.$r4=""};_d.$mZ.prototype={$B6:null,$r4:null};_d.$F6=function(n,t,i,r,u){this.$$d_$9SD=Function.createDelegate(this,this.$9SD);this.$$d_$9SG=Function.createDelegate(this,this.$9SG);this.$$d_$9SH=Function.createDelegate(this,this.$9SH);this.$$d_$9PX=Function.createDelegate(this,this.$9PX);_d.$F6.resolveInheritance();this.apcl=this.$Y;this.rpcl=this.$q;_d.$F6.initializeBase(this);this.$k=n;this.$1XH=t;this.$1XH.add_$3rw(this.$$d_$9PX);this.$5ZK=i;this.$1si=new _js.$c;this.$1x2=new _js.$c;this.$10v=new(_a.$3f.$$(String));this.$2oQ={};this.$Em=r;this.$5VU=new _d.$kE;this.$5s=new Sys.EventHandlerList;this.$35M=u};_d.$F6.$5ZH=function(n,t){if(!t)return-1;var i=n.$Dn(function(n){var i=n;return _g.$2R.$4i(t,i.$B6)});return i===n.get_$C()?-1:i};function $762(n,t,i){return!t&&!i?!0:i?_g.$2R.$4i(i,t):!1}function $3bh(n){var t=null;if(n.$35M&&n.$10v.get_$C())if(n.$1XH.$8Cp(n.$Em.$2R,n.$Em.$3H,n.$10v,!0)){t=n.$1XH.$2Ob(n.$Em.$2R,n.$Em.$3H,n.$10v,!1);$4sz(n,t)}else n.$jZ=!1;else{t={};$4sz(n,t)}}function $4sz(n,t){n.$1x2.$1t();n.$1si.$1t();for(var u=[],f=[],i=0;i<n.$10v.get_$C();i++){var r=t[n.$10v.get_$3o(i)];var e=n.$2oQ[n.$10v.get_$3o(i)];r&&r.$14Q!=="Free"?Array.add(u,new _d.$mZ(e,r)):Array.add(f,new _d.$mZ(e,r))}n.$1si.$6S(u);n.$1x2.$6S(f);$761(n)}function $761(n){_js.Trace.logInfo(_a.$0.$El,"Firing Room Data Loaded {0}",n.$10v.toString());n.$jZ=!0;var t=n.$5s.getHandler("DataLoaded");$5(t)||t()}_d.$F6.prototype={$k:null,$1XH:null,$5ZK:null,$1si:null,$1x2:null,$10v:null,$5VU:null,$5s:null,$35M:!1,$2oQ:null,$Em:null,$1Dg:!1,$5cK:!1,$5Mv:null,$MN:null,$jZ:!1,$id:null,add_$2ux:function(n){this.$5s.addHandler("DataLoaded",n)},remove_$2ux:function(n){this.$5s.removeHandler("DataLoaded",n)},get_$1eB:function(){return this.$jZ},get_$rO:function(){return this.$1x2},get_$1ZJ:function(){return this.$1si},get_$1eQ:function(){return this.$35M},get_$9qp:function(){return this.$10v},get_$14q:function(){return this.$1Dg},set_$14q:function(n){if(this.$1Dg!==n){this.$1Dg=n;$3(this,"HasErrorOccurred")}return n},get_$2qQ:function(){return this.$1XH},get_$5Mc:function(){return this.$id},set_$5Mc:function(n){if(this.$id){this.$id.remove_$29(this.$$d_$9SH);this.$id.remove_$21(this.$$d_$9SG);this.$id.remove_$2t(this.$$d_$9SD)}this.$id=n;if(this.$id){this.$id.add_$29(this.$$d_$9SH);this.$id.add_$21(this.$$d_$9SG);this.$id.add_$2t(this.$$d_$9SD)}return n},$847:function(n,t){($5(this.$MN)||!_g.$2R.$4i(this.$MN,n))&&(this.$MN=n);var i;if(this.$35M){var r=new(_a.$3f.$$(String));r.$D(n.EmailAddress);this.$Em=t;i=this.$1XH.$2Ob(this.$Em.$2R,this.$Em.$3H,r,!1)}else i={};return i[n.EmailAddress]||new _d.$FE(n.EmailAddress,"NoData",this.$5VU.$2x("NoData",null),!1,"NoError",new(_a.$3f.$$(_d.$KY)))},$5ZJ:function(n,t){this.$jZ=!1;this.set_$14q(!1);this.$Em=t;if(this.$5cK&&$762(this,this.$5Mv,n))$3bh(this);else{this.$5cK=!0;this.$5Mv=n;this.$1si.$1t();this.$1x2.$1t();this.$10v.$1t();this.$2oQ={};this.set_$5Mc(this.$5ZK());this.$id.$2e3=n;this.$k.$11(this.$id)}},$3xr:function(n){return _d.$F6.$5ZH(this.$1x2,n)},$5Wf:function(n){return _d.$F6.$5ZH(this.$1si,n)},$9SG:function(n){this.set_$14q(!0)},$9SD:function(n){this.set_$5Mc(null)},$9SH:function(n){this.$1XH.get_$6YI().$1t();for(var i=0;i<this.$id.$3Pa.length;i++){var t=this.$id.$3Pa[i];this.$10v.$D(t.EmailAddress);this.$2oQ[t.EmailAddress]=t;this.$1XH.get_$6YI().$D(t.EmailAddress)}$3bh(this)},$9PX:function(n){$3bh(this)}};_d.$111=function(n,t,i){_d.$111.initializeBase(this);this.$B6=n;this.$6b1=t;this.$Tg=i};_d.$111.prototype={$B6:null,$6b1:null,$Tg:null,$14Q:null,$3R1:null,$1JU:!1,get_$5VS:function(){return this.$14Q},set_$5VS:function(n){if(this.$14Q!==n){this.$14Q=n;$L8(this,"FreeBusyStatus","IsBusy","DisplayStatus")}return n},get_$1o:function(){return this.$B6.Name},get_$6D:function(){return this.$14Q.get_$6D()},get_$7ss:function(){return this.$14Q.$r4},get_$4ZL:function(){return this.$3R1},set_$4ZL:function(n){if(this.$3R1!==n){this.$3R1=n;$3(this,"SelectNextAvailableRoomLabel")}return n},get_$3Sv:function(){return this.$1JU},set_$3Sv:function(n){if(this.$1JU!==n){this.$1JU=n;$3(this,"ShowLoadingMessage")}return n}};_d.$QY=function(n,t,i,r){this.$$d_$9SE=Function.createDelegate(this,this.$9SE);this.$$d_$9SF=Function.createDelegate(this,this.$9SF);this.$$d_$5Dj=Function.createDelegate(this,this.$5Dj);_d.$QY.initializeBase(this,["SelectARoomList",i]);this.$k=n;this.$1pE=t;this.$5ZI=r;this.$1Iq=new _js.$c;this.$Pn=new _C(this.$$d_$5Dj,_a.$0.$El)};function $76X(n){if(!n.$jZ){var t=n.$5ZI();t.add_$29(n.$$d_$9SF);t.add_$21(n.$$d_$9SE);n.$k.$11(t)}}_d.$QY.prototype={$k:null,$1pE:null,$5ZI:null,$1Iq:null,$Pn:null,get_$7vq:function(){var n=new _js.$c;n.$D(new _a.$2E(this.$1lv,_nbs.NonBootStrings.l_TryAgainButton_Text));n.$D(new _a.$2E(this.$Pn,_nbs.NonBootStrings.l_ConfirmDialog_Back_Text));return n},$9Zy:function(){if(this.$61.get_$HZ()){this.$1pE.set_$4YG(this.$61.get_$HZ().Name);this.$1pE.set_$3Q7(this.$61.get_$HZ().EmailAddress);_h.$2D.$CL(this.$1pE.get_$Tz(),this.$k);$1AL(this,"SelectARoom")}},get_$9zc:function(){return!$5(this.$1pE.get_$3Q7())&&$5(this.$61.get_$HZ())},get_$6bu:function(){return this.$jZ&&!this.$1oW},$3JT:function(){this.set_$14q(!1);if(this.get_$9zc()){var n=new _g.$1q;n.Name=this.$1pE.get_$4YG();n.EmailAddress=this.$1pE.get_$3Q7();this.$61.set_$HZ(n);$1AL(this,"SelectARoom")}else if(this.get_$6bu()){this.$61.set_$HZ(null);$1AL(this,"SelectARoom")}else $76X(this)},$3JW:function(){},$9SE:function(n){var t=n;t.remove_$29(this.$$d_$9SF);t.remove_$21(this.$$d_$9SE);this.set_$14q(!0)},$9SF:function(n){var t=n;t.remove_$29(this.$$d_$9SF);t.remove_$21(this.$$d_$9SE);this.$1Iq.$6S(t.$1Iq);this.set_$6kx(this.$1Iq.get_$C());if(this.$61.get_$HZ())for(var r=t.$1Iq,f=r.length,i=0;i<f;++i){var u=r[i];if(u.EmailAddress===this.$61.get_$HZ().EmailAddress){this.$61.set_$HZ(u);break}}this.set_$1eB(!0);if(this.get_$6bu()){this.$61.set_$HZ(null);$1AL(this,"SelectARoom")}},$5Dj:function(){this.set_$14q(!1);$1AL(this,null)}};_d.$N1=function(n,t){this.$$d_$ADg=Function.createDelegate(this,this.$ADg);this.$$d_$9QX=Function.createDelegate(this,this.$9QX);this.$$d_$27O=Function.createDelegate(this,this.$27O);this.$$d_$6Mz=Function.createDelegate(this,this.$6Mz);this.$$d_$27k=Function.createDelegate(this,this.$27k);this.$$d_$9Zx=Function.createDelegate(this,this.$9Zx);this.$$d_$7tE=Function.createDelegate(this,this.$7tE);this.$$d_$9su=Function.createDelegate(this,this.$9su);this.$$d_$9sw=Function.createDelegate(this,this.$9sw);this.$$d_$5Dj=Function.createDelegate(this,this.$5Dj);_d.$N1.initializeBase(this,["SelectARoom",n]);this.$2d=t;this.$Pn=new _C(this.$$d_$5Dj,_a.$0.$El);this.$2eh=new _C(this.$$d_$9sw,_a.$0.$El);this.$6aL=new _C(this.$$d_$9su,_a.$0.$El);this.$6ew=new _C(this.$$d_$7tE,_a.$0.$El);this.$61.apcl("selectedRoomListEmailAddress",this.$$d_$9Zx);this.$61.apcl("selectedRoomEmailAddress",this.$$d_$27k)};function $76Y(n){n.$jZ?n.$27O():n.$2d.$5ZJ(n.$61.get_$HZ(),n.$61.get_$bu())}_d.$N1.prototype={$2d:null,$2eh:null,$6aL:null,$6ew:null,$Pn:null,$1J5:null,$18s:null,$1W1:!1,$31O:!1,$31f:!1,$31h:!1,$2gB:!1,$2Pt:!1,$31Q:!1,$3SV:null,$3IO:null,$3QY:null,get_$5bs:function(){return this.$31O},set_$5bs:function(n){if(this.$31O!==n){this.$31O=n;$3(this,"HasAvailableRooms")}return n},get_$31g:function(){return this.$31f},set_$31g:function(n){if(this.$31f!==n){this.$31f=n;$3(this,"HasNoRoomsAvailable")}return n},get_$31i:function(){return this.$31h},set_$31i:function(n){if(this.$31h!==n){this.$31h=n;$3(this,"HasNoRoomsInDirectory")}return n},get_$6ev:function(){return this.$2gB},set_$6ev:function(n){if(this.$2gB!==n){this.$2gB=n;$3(this,"ShowBusyRooms")}return n},get_$5GK:function(){return this.$31Q&&this.get_$9zz()},get_$A00:function(){return this.$3SV},set_$A00:function(n){if(this.$3SV!==n){this.$3SV=n;$3(this,"ShowBusyRoomsLabel")}return n},get_$6GI:function(){return this.$3IO},set_$6GI:function(n){if(this.$3IO!==n){this.$3IO=n;$3(this,"NoRoomAvailableLabel")}return n},get_$9sv:function(){return this.$3QY},set_$9sv:function(n){if(this.$3QY!==n){this.$3QY=n;$3(this,"SelectAnyRoomLabelText")}return n},get_$6ep:function(){return this.get_$1eQ()},get_$1eQ:function(){return this.$2d.get_$1eQ()},get_$rO:function(){return this.$2d.get_$rO()},get_$1ZJ:function(){return this.$2d.get_$1ZJ()},get_$9t6:function(){return this.$1J5},set_$9t6:function(n){if(this.$1J5!==n){this.$1J5=n;this.$18s=null;$3u(this,"SelectedBusyRoom","SelectedFreeRoom");this.$61.set_$1YR(!1);this.$61.set_$BT(n?n.$B6:null)}return n},get_$6aa:function(){return this.$18s},set_$6aa:function(n){if(this.$18s!==n){this.$18s=n;this.$1J5=null;$3u(this,"SelectedFreeRoom","SelectedBusyRoom");this.$61.set_$1YR(!1);this.$61.set_$BT(n?n.$B6:null)}return n},get_$A1n:function(){return this.$1W1},set_$A1n:function(n){if(this.$1W1!==n){this.$1W1=n;$3(this,"ShowSelectARoomListButton")}return n},get_$5d8:function(){return this.$2Pt},set_$5d8:function(n){if(this.$2Pt!==n){this.$2Pt=n;$3(this,"HideListOfAvailableRooms")}return n},get_$7dk:function(){return this.$61.get_$HZ()?String.format(_nbs.NonBootStrings.l_FindingRoomsInRoomlist_Text,this.$61.get_$HZ().Name):_nbs.NonBootStrings.l_FindingRooms_Text},get_$7vr:function(){var n=new _js.$c;n.$D(new _a.$2E(this.$1lv,_nbs.NonBootStrings.l_TryAgainButton_Text));n.$D(new _a.$2E(this.$Pn,_nbs.NonBootStrings.l_ConfirmDialog_Back_Text));return n},get_$9Jg:function(){var n=new _js.$c;n.$D(new _a.$2E(this.$Pn,_nbs.NonBootStrings.l_ChangeTimeButton_Text));this.$1W1&&n.$D(new _a.$2E(this.$2eh,_nbs.NonBootStrings.l_ChangeRoomListButton_Text));return n},get_$9Jh:function(){var n=new _js.$c;this.$1W1&&n.$D(new _a.$2E(this.$2eh,_nbs.NonBootStrings.l_ChangeRoomListButton_Text));n.$D(new _a.$2E(this.$Pn,_nbs.NonBootStrings.l_ConfirmDialog_Back_Text));return n},get_$9zz:function(){return!0},get_$40H:function(){return this.$31Q},set_$40H:function(n){if(this.$31Q!==n){this.$31Q=n;$3(this,"CanShowBusyRooms")}return n},$3JT:function(){this.set_$A1n(!!this.$61.get_$HZ());this.set_$1eB(!1);this.set_$6ev(!1);this.set_$5bs(!1);this.set_$31g(!1);this.set_$31i(!1);this.set_$40H(!1);this.set_$5d8(!0);this.$61.apcl("selectedRoomEmailAddress",this.$$d_$6Mz);this.$2d.add_$2ux(this.$$d_$27O);this.$2d.apcl("HasErrorOccurred",this.$$d_$9QX);this.$2d.get_$rO().add_$1Y(this.$$d_$ADg);$76Y(this)},$3JW:function(){this.$61.rpcl("selectedRoomEmailAddress",this.$$d_$6Mz);this.$2d.remove_$2ux(this.$$d_$27O);this.$2d.rpcl("HasErrorOccurred",this.$$d_$9QX)},$9wk:function(){this.set_$6GI(this.$61.get_$HZ()?String.format(_nbs.NonBootStrings.l_NoRoomsAvailableInRoomList_Text,this.$61.get_$HZ().Name):_nbs.NonBootStrings.l_NoRoomsAvailable_Text)},$9QX:function(n,t){this.set_$14q(this.$2d.get_$14q())},$27O:function(){this.set_$1eB(!0);this.set_$6kx(this.get_$rO().get_$C()+this.get_$1ZJ().get_$C());this.set_$5bs(this.get_$rO().get_$C()>0);this.set_$40H(this.get_$1ZJ().get_$C()>0);this.set_$31g(this.$1oW>0&&!this.get_$rO().get_$C());this.set_$31i(this.get_$40Y());this.set_$A00(this.$61.get_$HZ()?String.format(_nbs.NonBootStrings.l_ShowBusyRooms_Text,this.$61.get_$HZ().Name):_nbs.NonBootStrings.l_ShowBusyRoomsWithoutRoomList_Text);this.$9wk();this.set_$5d8(this.get_$40Y())},$6Mz:function(n,t){$1AL(this,null)},$5Dj:function(){this.set_$14q(!1);this.set_$31g(!1);this.set_$31i(!1);$1AL(this,null)},$9sw:function(){this.set_$14q(!1);this.set_$31g(!1);this.set_$31i(!1);$1AL(this,"SelectARoomList")},$9su:function(){$1AL(this,null);this.$61.set_$1YR(!0)},$7tE:function(){this.set_$6ev(!0);this.set_$40H(!1)},$9Zx:function(n,t){this.set_$9sv(this.$61.get_$HZ()?String.format(_nbs.NonBootStrings.l_FindAnyAvailableRoomInRoomList_Text,this.$61.get_$HZ().Name):_nbs.NonBootStrings.l_FindAnyAvailableRoom_Text);this.set_$1eB(!1)},$27k:function(n,t){if(!this.$61.get_$1dC()&&(this.$18s||this.$1J5)){this.$18s=null;this.$1J5=null}else{var i=this.$2d.$3xr(this.$61.get_$BT());if(i>=0){this.$18s=this.get_$rO().get_$3o(i);this.$1J5=null}else{i=this.$2d.$5Wf(this.$61.get_$BT());if(i>=0){this.$1J5=this.get_$1ZJ().get_$3o(i);this.$18s=null}}}$3u(this,"SelectedBusyRoom","SelectedFreeRoom")},$ADg:function(n,t){this.$27k(null,null)}};_d.$1E4=function(n,t){_d.$1E4.initializeBase(this,[n,t])};_d.$1E4.prototype={get_$6ep:function(){return!1},$9wk:function(){this.set_$6GI(this.$61.get_$HZ()?String.format(_nbs.NonBootStrings.l_NoRoomsAvailableInRoomListComposeForm_Text,this.$61.get_$HZ().Name):_nbs.NonBootStrings.l_NoRoomsAvailableComposeForm_Text)},get_$9zz:function(){return!1}};_d.$bB=function(n,t,i){this.$$d_$9M5=Function.createDelegate(this,this.$9M5);_d.$bB.initializeBase(this);this.$E7=n;this.$5f=t;this.set_$9M6(new _C(this.$$d_$9M5,i))};_d.$bB.$5LO=function(n,t,i,r){return n.get_$L()==="Mouse"?new _d.$bB(t,i,r):null};_d.$bB.prototype={$19L:null,$vi:!1,$ty:null,$5f:null,$E7:null,get_$9M6:function(){return this.$ty},set_$9M6:function(n){if(this.$ty!==n){this.$ty=n;$3(this,"OnAttachViaStringCommand")}return n},get_$2hT:function(){return this.$19L},set_$2hT:function(n){if(this.$19L!==n){this.$19L=n;$3(this,"StringAttachContent")}return n},get_$2Em:function(){return this.$vi},set_$2Em:function(n){if(this.$vi!==n){this.$vi=n;$3(this,"WasStringAttachments")}return n},$9M5:function(){var n=this;this.$E7.$E(function(t){var i;var r,u;n.set_$2Em((u=t.$1od(n.$19L,r={val:i}),i=r.val,u));n.$vi&&n.$5f&&_js.$J.get_$I().$1s(_a.$0.$1P,"ComposeCopyPasteViewModel.OnAttachViaString",function(){n.$5f.$1rO(i,null)},0)})}};_d.$wO=function(n,t){this.$$d_$9tg=Function.createDelegate(this,this.$9tg);this.$$d_$9tn=Function.createDelegate(this,this.$9tn);_d.$wO.initializeBase(this);this.$B=n;this.$3R4=new _C(this.$$d_$9tn,_a.$0.$DD);this.$6b6=new _C(this.$$d_$9tg,_a.$0.$DD);this.$5ep(t);this.$3b=t};_d.$wO.prototype={$3R4:null,$6b6:null,$oi:null,$c6:null,$fK:!1,$35:null,$3b:null,$IT:!1,$B:null,get_$wW:function(){return this.$fK},set_$wW:function(n){if(this.$fK!==n){this.$fK=n;$3(this,"CanSelectNone")}return n},get_$3Ui:function(){return this.$c6},set_$3Ui:function(n){if(n!==this.$c6){this.$c6=n;$3(this,"SuggestedDate")}return n},get_$CD:function(){return this.$35},set_$CD:function(n){this.$35=$5(this.$35)||$5(n)?n:new _a.$7(n.get_$4S(),n.get_$3T(),n.get_$5n(),this.$35.get_$ED(),this.$35.get_$Gp(),this.$35.get_$Tm());this.$3b=this.$35;this.set_$1QK(!1);$3u(this,"DisplayedDate","SelectedDate");!$5(this.$oi)&&this.$oi.$2T&&this.$oi.$s();return n},get_$Ak:function(){return this.$3b},set_$Ak:function(n){if(!_a.$7.$4N(this.$3b,n)){this.$3b=n;$3(this,"DisplayedDate")}return n},get_$1QK:function(){return this.$IT},set_$1QK:function(n){if(this.$IT!==n){this.$IT=n;$3(this,"IsPickingMonth")}return n},get_$9hE:function(){return this.$B.get_$L()==="Mouse"?175:244},get_$9hB:function(){return this.$B.get_$L()==="Mouse"?156:217},$5ep:function(n){this.$3b=n;this.$35=n;$3u(this,"DisplayedDate","SelectedDate")},$9tn:function(){var n=_a.$7.get_$2F();$5(this.$35)||(n=new _a.$7(n.get_$4S(),n.get_$3T(),n.get_$5n(),this.$35.get_$ED(),this.$35.get_$Gp(),this.$35.get_$Tm()));this.set_$CD(n)},$9tg:function(){this.set_$CD(null)}};_d.$X9=function(n){this.$$d_$9do=Function.createDelegate(this,this.$9do);this.$$d_$9nq=Function.createDelegate(this,this.$9nq);_d.$X9.initializeBase(this);this.$j2=n;var t=this;this.$6WF=new _C(this.$$d_$9nq,_a.$0.$DD,this,"Persona",function(){return!!t.$18})};_d.$X9.prototype={$j2:null,$52:null,$6WF:null,$18:null,get_$6A:function(){if(!this.$52){this.$52=this.$j2.$E(_pc.$15.$1DP,_pc.$15.$jD(),!1,"PersonaDetailedView");this.$52.$12a();this.$52.set_$pP(!0);this.$52.set_$QJ(!0);this.$52.set_$r(!1);this.$52.add_$hO(this.$$d_$9do);this.$52.set_$19t(100);this.$52.set_$1iX(0)}return this.$52},get_$1u:function(){return this.$18},set_$1u:function(n){if(this.$18!==n){this.$18=n;$3u(this,"Persona","RemoveRecipientText")}return n},get_$6WL:function(){return!this.$18||!this.$18.get_$1sL()?String.format(_nbs.NonBootStrings.l_SchedulingRemoveAttendee_AT_Button_Text,""):String.format(_nbs.NonBootStrings.l_SchedulingRemoveAttendee_AT_Button_Text,this.$18.get_$1sL().get_$1o())},$1t:function(){this.set_$1u(null);this.get_$6A().set_$7D("")},$9do:function(n,t){var i=n.get_$X1();i&&this.set_$1u(i)},$9nq:function(){this.set_$1u(null);this.get_$6A().set_$Hr(!0)}};_d.$Nl=function(n,t,i,r,u,f){this.$$d_$6HK=Function.createDelegate(this,this.$6HK);this.$$d_$34=Function.createDelegate(this,this.$34);this.$$d_$9eF=Function.createDelegate(this,this.$9eF);_d.$Nl.initializeBase(this);_a.$3.$K(i,"folderPickerContainer shouldn't be null");_a.$3.$K(r,"owaShell shouldn't be null");_a.$3.$K(u,"passFolderCheck shouldn't be null");_a.$3.$K(f,"conductor shouldn't be null");this.$j5=i;this.$B=r;this.set_$Kb(n);this.set_$o(t);this.$6Pw=u;this.$3m=f;this.$2Gq=new _C(this.$$d_$9eF,_a.$0.$Eh);this.$Tg=new _C(this.$$d_$34,_a.$0.$Eh)};function $71q(n){n.$j5.$14I||n.$j5.$A9n();if(n.$j5.$14I){var i=this;var t=new _C(function(){n.$j5.$14I.$5g.get_$Fh()&&$4r1(n,n.$j5.$14I.$5g.get_$Fh().$25)},_a.$0.$Eh);n.$j5.$14I.$4cC(t,_nbs.NonBootStrings.l_Select_Text,_nbs.NonBootStrings.l_Select_Text)}}function $71r(n){n.$j5.$Kc||n.$j5.$A9o();if(n.$j5.$Kc){n.$j5.$Kc.$5g.$lx=new _C(n.$$d_$6HK,_a.$0.$7i);n.$3m.$BQ(n.$j5.$Kc)}}function $4r1(n,t){if(n.$6Pw(t)){n.set_$Kb(t.get_$1o());n.set_$o(t.get_$o().Id)}}_d.$Nl.prototype={$j5:null,$B:null,$6Pw:null,$3m:null,$HF:null,$2k:null,$2Gq:null,$Tg:null,get_$Kb:function(){return this.$HF},set_$Kb:function(n){if(this.$HF!==n){this.$HF=n;$3(this,"FolderName")}return n},get_$o:function(){return this.$2k},set_$o:function(n){if(this.$2k!==n){this.$2k=n;$3(this,"FolderId")}return n},$9eF:function(){switch(this.$B.get_$L()){case"Mouse":case"TouchWide":$71q(this);break;case"TouchNarrow":$71r(this);break}},$6HK:function(){var n=this.$j5.$Kc.$5g;n.get_$Fh()&&$4r1(this,n.get_$Fh().$25);n.$lx=null;this.$3m.$BP()},$34:function(){this.set_$Kb("");this.set_$o("")}};_d.$Bo=function(n,t,i){this.$$d_$9nU=Function.createDelegate(this,this.$9nU);this.$$d_$9nT=Function.createDelegate(this,this.$9nT);_d.$Bo.initializeBase(this);this.$J=n;this.$44=t;this.$B=i};function $4r2(n){var t=_h.$i.$aX("msgfolderroot");var i=_g.$2Z.$BJ("msgfolderroot");if(t&&i){n.$1wq=new _js.$c;var r=new _y.$OF(n.$J,"msgfolderroot",i,t,_g.$V.get_$I());n.$1wq.$D(r);return!0}else{$71u(n);return!1}}function $71s(n){_js.Trace.logInfo(_d.$Bo.$67,"Setting FolderPickerDialog to null");n.$1wq=null;n.set_$FM(null)}function $71t(n){_js.Trace.logInfo(_d.$Bo.$67,"Setting FolderPickerScreen to null");n.$1wq=null;n.$Kc=null}function $71u(n){var t=new _a.$4V([_nbs.NonBootStrings.l_FolderTreesIsNull_Text],0,null,0,!1,_u.Strings.l_OK_Text,null,_nbs.NonBootStrings.l_FolderPickerError_Text);n.$J.$9lH(_a.$4V,t)}_d.$Bo.prototype={$J:null,$44:null,$B:null,$1wq:null,$14I:null,$Kc:null,get_$FM:function(){return this.$14I},set_$FM:function(n){if(n!==this.$14I){this.$14I=n;$3(this,"FolderPickerDialog")}return n},$A9n:function(){if($4r2(this)){_js.Trace.logInfo(_d.$Bo.$67,"CreateFolderPickerDialog");this.set_$FM(new _y.$IM(new _y.$4N(this.$J,this.$1wq,_g.$V.get_$I(),this.$B,null,null,!0,!1,!1,null,null)));this.$44.$1s(_d.$Bo.$67,"RemovePickerDialog",this.$$d_$9nT,18e4)}},$A9o:function(){if($4r2(this)){this.$Kc=new _y.$Tw(new _y.$4N(this.$J,this.$1wq,_g.$V.get_$I(),this.$B,null,null,!0,!1,!1,null,null));this.$Kc.set_$2yy(_nbs.NonBootStrings.l_SelectFolder_Text);this.$44.$1s(_d.$Bo.$67,"RemoveFolderPickerScreen",this.$$d_$9nU,18e4)}},$9nT:function(){this.$14I.$30?this.$44.$1s(_d.$Bo.$67,"RemovePickerDialog",this.$$d_$9nT,18e4):$71s(this)},$9nU:function(){this.$Kc.$30?this.$44.$1s(_d.$Bo.$67,"RemoveFolderPickerScreen",this.$$d_$9nU,18e4):$71t(this)}};_d.$Nw=function(n,t,i,r,u,f,e){this.$40u=n;this.$Gh=t;this.$280="";this.$Vb=i;this.$1TZ=r;this.$6o=u;this.$8x=f;this.$B=e};function $72G(n,t){var i=$72D(n,t);if(i){var r=n.$Gh?"MicrosoftOffice365Help":"OWAPremiumHelp";n.$Vb.$TS(i,r,$72E(n))}}function $72F(n){return n.$B.get_$L()==="TouchWide"&&_d.$9b.isInstanceOfType(n.$B.$aZ().get_$7T())?!0:!1}function $72D(n,t){var i=null;if(n.$40u){i=_js.$8.$4B(n.$40u,_js.$1i.$9S(_y.$18S,t));n.$Gh&&(i+=n.$280)}return i}function $72E(n){return n.$8x==="Mouse"?"width=400,height=500,menubar=no,status=no,scrollbars=no,titlebar=no,toolbar=no,resizable=yes":""}_d.$Nw.prototype={$40u:null,$Gh:!1,$Vb:null,$1TZ:null,$280:null,$6o:null,$8x:0,$B:null,get_$4Qo:function(){return this.$280},set_$4Qo:function(n){this.$280=_js.$8.$15(n)?"":n.startsWith("&")?n:"&"+n;return n},$2gL:function(){var t=0;$72F(this)?t=4:this.$6o&&this.$6o.get_$6z()&&(t=this.$6o.get_$6z().$A5);var n=0;switch(t){case 0:n=0;break;case 1:n=1;break;case 2:n=2;break;case 3:n=3;break;case 4:n=5;break;default:break}this.$1JS(n)},$1JS:function(n){this.$1TZ.$AAD(_g.$1Y.$w)||$72G(this,n)}};_d.$4=function(){};_d.$4.get_$1tY=function(){return _0365m.$H.$E("close-small","x12","owa")};_d.$4.get_$2sf=function(){return _0365m.$H.$E("close-small-hover","x12","owa")};_d.$4.get_$8Sm=function(){return _0365m.$H.$E("mail-notification-white","x16","owa")};_d.$4.get_$8Sk=function(){return _0365m.$H.$E("mail-notification","x16","owa")};_d.$4.get_$7bS=function(){return _0365m.$H.$E("arrow-right-small-blue","arrow-right-small-blue","owa")};_d.$4.get_$7bT=function(){return _0365m.$H.$E("arrow-up","arrow-up","owa")};_d.$4.get_$7wJ=function(){return _0365m.$H.$E("event-notification-white","x18","owa")};_d.$4.get_$7wI=function(){return _0365m.$H.$E("event-notification","x18","owa")};_d.$4.get_$7g3=function(){return _0365m.$H.$E("chat-white","x16","owa")};_d.$4.get_$4c=function(){return _0365m.$H.$E("chat","x16","owa")};_d.$4.get_$5AI=function(){return _0365m.$H.$E("add-people","x16","owa")};_d.$4.get_$7Xq=function(){return _0365m.$H.$E("add-circle-grey-large","x32-circle","owa")};_d.$4.get_$7Xo=function(){return _0365m.$H.$E("add-circle-blue-pressed","x32-circle","owa")};_d.$4.get_$fO=function(){return _0365m.$H.$E("close-large","x18","owa")};_d.$4.get_$cW=function(){return _0365m.$H.$E("close-large-hover","x18","owa")};_d.$4.get_$1Ml=function(){return _0365m.$H.$E("close-large-disabled","x18","owa")};_d.$4.get_$9h1=function(){return _0365m.$H.$E("person-card-phone","x32-circle","owa")};_d.$4.get_$9h2=function(){return _0365m.$H.$E("person-card-phone-pressed","x32-circle","owa")};_d.$4.get_$8Ry=function(){return _0365m.$H.$E("location-card-directions-pressed","x32-circle","owa")};_d.$4.get_$9gw=function(){return _0365m.$H.$E("person-card-event-pressed","x32-circle","owa")};_d.$4.get_$9h0=function(){return _0365m.$H.$E("person-card-mail-pressed","x32-circle","owa")};_d.$4.get_$9gy=function(){return _0365m.$H.$E("person-card-i-m-pressed","x32-circle","owa")};_d.$4.get_$8Rx=function(){return _0365m.$H.$E("location-card-directions-mouse","x24-circle","owa")};_d.$4.get_$5pf=function(){return _0365m.$H.$E("location-card-directions-touch","x32-circle","owa")};_d.$4.get_$5pe=function(){return _0365m.$H.$E("location-card-directions-hover","x24-circle","owa")};_d.$4.get_$9gv=function(){return _0365m.$H.$E("person-card-event-mouse","x24-circle","owa")};_d.$4.get_$6R3=function(){return _0365m.$H.$E("person-card-event-touch","x32-circle","owa")};_d.$4.get_$6R2=function(){return _0365m.$H.$E("person-card-event-hover","x24-circle","owa")};_d.$4.get_$9gz=function(){return _0365m.$H.$E("person-card-mail-mouse","x24-circle","owa")};_d.$4.get_$6R7=function(){return _0365m.$H.$E("person-card-mail-touch","x32-circle","owa")};_d.$4.get_$6R6=function(){return _0365m.$H.$E("person-card-mail-hover","x24-circle","owa")};_d.$4.get_$9gx=function(){return _0365m.$H.$E("person-card-i-m-mouse","x24-circle","owa")};_d.$4.get_$6R5=function(){return _0365m.$H.$E("person-card-i-m-touch","x32-circle","owa")};_d.$4.get_$6R4=function(){return _0365m.$H.$E("person-card-i-m-hover","x24-circle","owa")};_d.$4.get_$8UP=function(){return _0365m.$H.$E("merge","x18","owa")};_d.$4.get_$8UV=function(){return _0365m.$H.$E("merge-hover","x18","owa")};_d.$4.get_$6hg=function(){return _0365m.$H.$E("split","x18","owa")};_d.$4.get_$6hj=function(){return _0365m.$H.$E("split-hover","x18","owa")};_d.$4.get_$3Mt=function(){return _0365m.$H.$E("print","x20","owa")};_d.$4.get_$6TF=function(){return _0365m.$H.$E("print-hover","x20","owa")};_d.$4.get_$5FY=function(){return _0365m.$H.$E("calendar-share","x20","owa")};_d.$4.get_$5FZ=function(){return _0365m.$H.$E("calendar-share-hover","x20","owa")};_d.$4.get_$7tH=function(){return _0365m.$Q.$E("doughboy_calendar.png")};_d.$4.get_$9f0=function(){return _0365m.$H.$E("other-notification-white","x16","owa")};_d.$4.get_$9ez=function(){return _0365m.$H.$E("other-notification","x16","owa")};_d.$4.get_$59m=function(){return _0365m.$H.$E("add-circle-blue","x32-circle","owa")};_d.$4.get_$59n=function(){return _0365m.$H.$E("add-circle-grey","x24-circle","owa")};_d.$4.get_$7Xp=function(){return _0365m.$H.$E("add-circle-grey-disabled","x24-circle","owa")};_d.$4.get_$59o=function(){return _0365m.$H.$E("add-circle-grey-hover","x24-circle","owa")};_d.$4.get_$7XQ=function(){return _0365m.$H.$E("success_notification","x16","owa")};_d.$4.get_$7XP=function(){return _0365m.$H.$E("fail_notification","x16","owa")};_d.$FA=function(n,t){this.$$d_$4Nz=Function.createDelegate(this,this.$4Nz);this.$$d_$9L0=Function.createDelegate(this,this.$9L0);this.$3Xl={};_d.$FA.initializeBase(this);this.$Cn=n;this.$k=t};function $4tR(n,t){return t in n.$3Xl}_d.$FA.prototype={$Cn:null,$k:null,$3zA:null,get_$2UY:function(){return this.$Cn.get_$1KU()},$41:function(n){_js.$8.$a(this.get_$2UY())||this.$1xc(this.get_$2UY(),n)},$350:function(n){return _js.$8.$a(n)?!1:$4tR(this,n)&&this.$3Xl[n]},get_$2SM:function(){return this.$350(this.get_$2UY())},$1xc:function(n,t){if(_js.$8.$a(n)){_js.Trace.logInfo(_d.$FA.$1a,"Ignoring request to fetch online meeting configuration for empty sipUri");t&&t(n,!1);return}if($4tR(this,n)){t&&t(n,this.$350(n));return}_js.Trace.logInfo(_d.$FA.$1a,String.format("Fetching user online meeting configuration for {0}",n));_a.$6.$1X(_d.$FA.$1a,"GetUserOnlineMeetingSettings");var i=new _c.$183(n);i.add_$29(this.$$d_$9L0);i.add_$21(this.$$d_$4Nz);var r=this;i.add_$2t(function(n){_a.$6.$19(null,"GetUserOnlineMeetingSettings",r.$3zA,_cc.$1Lo.$6v.$Q6(n));if(t){var i=n;var u=i.$b?i.$b.SipUri:"";t(u,r.$350(u))}});this.$k.$11(i)},$9L0:function(n){_js.Trace.logInfo(_d.$FA.$1a,"Fetching user online meeting configuration succeeded.");var t=n;this.$3Xl[t.$b.SipUri]=t.$b.IsUcwaSupported;this.$3zA=""},$4Nz:function(n){_js.Trace.logInfo(_d.$FA.$1a,"Fetching user online meeting configuration failed.");this.$3zA=_cc.$1Lo.$6v.$ft(n)}};_d.$Uf=function(n,t,i){_d.$Uf.initializeBase(this);this.$Vb=i;this.$lo=n;this.$k=t};_d.$Uf.prototype={$Vb:null,$lo:null,$k:null,$7mo:function(n,t,i){var r=new _c.$14t(this.$lo.get_$2UY(),n);var u=this;r.add_$29(function(n){_js.Trace.logInfo(_d.$Uf.$1a,"Create meet now succeeded.");var i=n;t(i.$Du.WebUrl)});var f=this;r.add_$21(function(n){_js.Trace.logInfo(_d.$Uf.$1a,"Create meet now failed.");i()});this.$k.$11(r)},$80h:function(n,t){return t?String.format(_nbs.NonBootStrings.l_PlainTextMeetNowPost_Text,_nbs.NonBootStrings.l_MeetNow_Announcement_Text,n,t):""},$41:function(n){var t=this;this.$lo.$41(function(){n&&n()})},get_$2SM:function(){return this.$lo.get_$2SM()}};_d.$1BB=function(n,t,i){this.$lo=n;this.$k=t;this.$Vb=i};_d.$1BB.prototype={$lo:null,$k:null,$Vb:null,$8V:function(){return new _d.$Uf(this.$lo,this.$k,this.$Vb)}};_d.$Uk=function(n,t,i,r){this.$$d_$2BG=Function.createDelegate(this,this.$2BG);this.$2E=n;this.$rn=t;this.$3Z=i;this.$1Hc=r};_d.$Uk.prototype={$2E:null,$1Hc:null,$rn:null,$3Z:null,$26g:null,$bC:null,$2BG:function(){$5(this.$26g)||(this.$26g.$cg!==this?this.$26g.set_$3q5(this):this.$26g.$5BL&&this.$26g.set_$3q5(null))}};_d.$Ul=function(n,t,i,r,u,f){_d.$Ul.initializeBase(this,[n,t,null,f]);this.$2qa=n;$73r(this,r);this.set_$3q5(u);this.$3KC=i};function $73r(n,t){for(var f=t.length,u=new Array(f),r=0;r<f;r++){var i=t[r];i.$26g=n;u[r]=new _0365m.$8S(i.$2E,i.$rn,new _C(i.$$d_$2BG,_a.$0.$DD),n.$cg===i,!1,null,i.$1Hc,i.$3Z);u[r].set_$6kW(!1);i.$bC=u[r]}n.set_$2Cu(new _0365m.$2c(u))}function $4sI(n){!n.$3Sb||$5(n.$cg)||_js.$8.$15(n.$cg.$2E)?n.set_$1Q(n.$2qa):_js.$8.$15(n.$2qa)?n.set_$1Q(n.$cg.$2E):n.set_$1Q(String.format("{0}: {1}",n.$2qa,n.$cg.$2E))}_d.$Ul.prototype={$2qa:null,$cg:null,$3KC:null,$3Sb:!0,$5BL:!0,$3sI:!1,get_$3q5:function(){return this.$cg},set_$3q5:function(n){if(this.$cg!==n){$5(this.$cg)||this.$3sI||this.$cg.$bC.set_$7M(!1);this.$cg=n;$5(this.$cg)||this.$3sI||this.$cg.$bC.set_$7M(!0);$N(this,"CurrentOption");$4sI(this);$5(this.$3KC)||($5(this.$cg)?this.$3KC(null):this.$3KC(this.$cg.$3Z));this.$3sI&&(this.$cg=null)}return n},get_$6f3:function(){return this.$3Sb},set_$6f3:function(n){if(this.$3Sb===n)return n;this.$3Sb=n;$4sI(this);return n}};_d.$fR=function(n,t){this.$$d_$9Wq=Function.createDelegate(this,this.$9Wq);_d.$fR.initializeBase(this);this.$J=n;this.$Q4=new _d.$X9(t);$73z(this)};function $73z(n){var t=new _y.$M8;t.set_$4o(_nbs.NonBootStrings.l_OpenAnotherMailbox_Text);t.set_$DT(n);var i=this;n.$u8=new _C(n.$$d_$9Wq,_a.$0.$2y6,n.$Q4,"Persona",function(){return!!n.$Q4.$18});t.$7W.$D(new _a.$2E(n.$u8,_nbs.NonBootStrings.l_OpenButtonText_Text));t.$7W.$D(new _a.$2E(t.$4f,_u.Strings.l_CancelButtonText_Text));n.set_$ip(t)}_d.$fR.prototype={$J:null,$u8:null,$9w:null,$Q4:null,get_$ip:function(){return this.$9w},set_$ip:function(n){if(this.$9w!==n){this.$9w=n;$3(this,"DialogViewModel")}return n},$VM:function(){this.$Q4.$1t();this.$9w.set_$1O(!0)},$9Wq:function(){if(this.$Q4.$18){this.$J.$9lH(_y.$pa,new _y.$pa(this.$Q4.$18.get_$1u().get_$1l().EmailAddress));this.$9w.$4f.$s();_a.$g.$9H("VM.MailUsage.OpenFromExplicitLogonWindow")}}};_d.$Yq=function(n,t,i,r){this.$$d_$3Sk=Function.createDelegate(this,this.$3Sk);this.$$d_$ABB=Function.createDelegate(this,this.$ABB);_a.$3.$m(n,"offlineSettings");_a.$3.$m(t,"owaShell");_a.$3.$m(r,"eventAggregator");this.$72=n;this.$B=t;this.$3hz=i;r.$Hd(_a.$NF,this.$$d_$ABB);var u=this;this.$6HA=new(_0365f.$4C.$$(_y.$s5))(function(){return new _y.$s5})};function $73y(n){n.get_$3Iq().set_$3Sk(!1);n.$B.$7C(n.get_$3Iq())}_d.$Yq.prototype={$72:null,$B:null,$6HA:null,$3hz:0,get_$3Iq:function(){return this.$6HA.get_$1n()},get_$6eb:function(){return!this.$72.get_$1p4()&&this.$72.$3T3(this.$3hz,!1)},$AAD:function(n){if(n&&!n.$Bv.$QD){if(this.$72.get_$1p4()){$73y(this);return!0}if(this.get_$6eb()){this.$3Sk();return!0}}return!1},$59p:function(n){this.get_$6eb()&&!n.$1eb(9600)&&n.$ID(9600,null,_nbs.NonBootStrings.l_OfflineDiscovery_InfoBarLink_Text,this.$$d_$3Sk)},$9nM:function(n){n.$5Z(9600)},$3Sk:function(){this.get_$3Iq().set_$3Sk(!0);this.$B.$7C(this.get_$3Iq())},$ABB:function(n){var t=n.$b;this.$3hz=t.get_$Nq().AllowOfflineOn}};_d.$4f=function(n,t){this.$$d_$39I=Function.createDelegate(this,this.$39I);this.$1NY=new Sys.EventHandlerList;_d.$4f.initializeBase(this);_a.$3.$85(n,1,1e3,"pageSize");this.$5ez=new _h.$8J(0,n);this.$XP=t;this.$7r=0;this.$12=null;this.$if=_d.$4f.$2UT;t||this.set_$1OS(!0)};function $74I(n){return n.$3qY||_d.$4f.$275}function $4sS(n,t){if(n.$24){n.$24.remove_$10F(n.$$d_$39I);_h.$31.get_$I().$1Uk(n.$24)}n.$24=t;n.set_$1p(null);n.set_$21t(!1);n.$24&&n.$24.add_$10F(n.$$d_$39I);$3(n,"Table")}function $4sR(n){if(n.$7r){if(!n.$24)return;$74J(n,n.$5ez)}}function $74J(n,t){n.$7r=2;n.set_$13F(_d.$4f.$2UT);n.set_$21t(!1);t.$1R4=1;n.$24.$Ov(t);n.$39I(n.$24,"Loading")}function $74H(n,t){if(n.$1NY){var i=n.$1NY.getHandler(t);i&&i()}}_d.$4f.prototype={$5ez:null,$12:null,$if:null,$3qY:null,$XP:0,$24:null,$7r:0,$aP:null,$21s:!1,$20T:!1,$45L:!1,$G2:!1,add_$6ac:function(n){this.$Y("SelectedItem",n)},remove_$6ac:function(n){this.$q("SelectedItem",n)},get_$GP:function(){return this.$24},set_$GP:function(n){_a.$3.$K(n,"Table");$4sS(this,n);$4sR(this);return n},get_$1p:function(){return this.$12},set_$1p:function(n){this.$9MY();this.$12=n;this.$9LM();this.$45L=!1;$3(this,"SelectedItem");return n},get_$1OS:function(){return this.$G2},set_$1OS:function(n){this.$G2=n;$3(this,"FocusItemOnSelect");return n},get_$1bt:function(){return this.$aP},set_$1bt:function(n){this.$aP=n;$3(this,"EnterKeyCommand");return n},get_$13F:function(){return this.$if},set_$13F:function(n){if(this.$if!==n){this.$if=n;$3u(this,_d.$4f.$1ai,_d.$4f.$6fR)}return n},get_$1Vu:function(){return this.$if===_d.$4f.$2UT||this.$if===_d.$4f.$4A9?!1:!0},get_$21t:function(){return this.$21s},set_$21t:function(n){if(this.$21s!==n){this.$21s=n;$3(this,_d.$4f.$2Tc)}return n},get_$8Lw:function(){return this.$20T},set_$8Lw:function(n){if(this.$20T!==n){this.$20T=n;$3(this,_d.$4f.$2SL)}return n},get_$ax:function(){return this.$if===_d.$4f.$2UT},$5lT:function(n){var t=$5(n);var i=$5(this.$24);return t&&i?!0:t||i?!1:n.get_$Q()===this.$24.$4A.get_$Q()},$5m:function(){if(!this.$7r){this.$7r=1;$4sR(this)}},$78:function(){if(this.$7r===1){this.$7r=0;$4sS(this,null)}},$9LM:function(){},$9MY:function(){},$9Uu:function(){},$1xQ:function(){return _d.$4f.$cp},$39I:function(n,t){if(n===this.$24){this.set_$8Lw(this.$24.$b3);if(!this.$24.$b3){if(this.$24.$1w.get_$C()){this.set_$13F(_d.$4f.$4A9);if(this.$XP===1&&!this.$12&&!this.$45L){this.set_$1p(this.$24.$1w.get_$3o(0));this.set_$1OS(!0)}}else{this.$24.$z2?this.set_$13F(this.$1xQ()):this.set_$13F($74I(this));this.$XP===1&&this.$12&&this.set_$1p(null)}this.$7r=1;this.set_$21t(!0);$74H(this,"LoadCompleted");this.$9Uu()}}}};_d.$7m=function(n,t){this.$$d_$2b3=Function.createDelegate(this,this.$2b3);_d.$7m.initializeBase(this);this.$B=t;this.$7p=n;this.$18T=_d.$7m.$30b();this.$PL=new _C(this.$$d_$2b3,_a.$0.$Ej);$4sq(this);if(this.$7p.get_$1Ia()&&this.$7p.get_$1Ia()!==1)throw Error.invalidOperation(String.format("Invalid value {0} for reminder group",this.$7p.get_$1Ia()));};_d.$7m.$5IY=function(n,t){_a.$3.$m(n,"object1");_a.$3.$m(t,"object2");var i=n.$7p;var r=t.$7p;return i.get_$91().$2U(r.get_$91())};_d.$7m.$30b=function(){var n=_a.$7.get_$2F();return new _a.$7(n.get_$4S(),n.get_$3T(),n.get_$5n(),n.get_$ED(),n.get_$Gp(),0)};function $4sq(n){var i=null;n.$7p.get_$1Ia()?n.$7p.get_$1Ia()===1&&(i=n.$7p.get_$1Ib()):i=n.$7p.get_$91();var t=Math.floor(i.$5u(n.$18T)/1e3);var r=_a.$7.$5XL(t<0?-t:t,!0,!0);n.$371=t<0;if(t&&r.length){n.$2iH=r[1];n.$2iI=r[0]}else{n.$2iH=_nbs.NonBootStrings.l_Reminders_Now_UpperCase_Text;n.$2iI=""}$L8(n,"TimeToItemStartUnit","TimeToItemStartValue","IsReminderOverdue")}_d.$7m.prototype={$B:null,$PL:null,$7p:null,$18T:null,$371:!1,$2iH:null,$2iI:null,get_$4fw:function(){var n="";this.$7p.get_$1Ia()?this.$7p.get_$1Ia()===1&&(n=this.$7p.get_$1Ib().$2b(18)):n=_a.$7.$wD(this.$7p.get_$91(),this.$18T)&&_a.$7.$wD(this.$7p.get_$91(),this.$7p.get_$1Cz())?String.format(_nbs.NonBootStrings.l_Reminder_DurationLabel_Text,this.$7p.get_$91().$2b(18),this.$7p.get_$1Cz().$2b(18)):String.format(_nbs.NonBootStrings.l_Reminder_DurationLabel_DifferentDay_Text,this.$7p.get_$91().$2b(18),this.$7p.get_$91().$2b(3));return n},get_$6VD:function(){return this.$18T},set_$6VD:function(n){_a.$3.$m(n,"ReferenceDateTime");this.$18T=n;return n},$6nj:function(){this.set_$6VD(_d.$7m.$30b());$4sq(this)},$2b3:function(){if(this.$7p.get_$1Ia()){if(this.$7p.get_$1Ia()===1){var t={};t.ItemID=this.$7p.get_$i().Id;this.$B.$6E(_d.$hm,null,t,_y.$48.get_$T4())}}else{var n=new _y.$9S;n.$ZT(this.$7p.get_$i());this.$B.$6E(_d.$It,null,n.$3E,_y.$48.get_$T4())}}};_d.$tJ=function(n){_d.$tJ.initializeBase(this);this.$B=n};_d.$tJ.prototype={$B:null,$8V:function(n){return new _d.$7m(n,this.$B)}};_d.$5O=function(n,t,i,r,u,f){this.$$d_$878=Function.createDelegate(this,this.$878);this.$$d_$9ZL=Function.createDelegate(this,this.$9ZL);this.$$d_$4PC=Function.createDelegate(this,this.$4PC);this.$$d_$9R0=Function.createDelegate(this,this.$9R0);this.$$d_$5If=Function.createDelegate(this,this.$5If);this.$$d_$17X=Function.createDelegate(this,this.$17X);this.$$d_$5IX=Function.createDelegate(this,this.$5IX);_d.$5O.initializeBase(this);_a.$3.$m(i,"nativeBridge");_a.$3.$m(r,"offlineSettings");_a.$3.$m(u,"userAgent");this.$4Vs=n;this.$MI=new _c.$Lh;this.$XH={};this.$72=r;this.$1A=u;this.$b=f;this.$FD=new _a.$Rx(this.$$d_$5IX);this.$FD.add_$1Y(this.$$d_$17X);this.$Q5=new _a.$Rx(this.$$d_$5If);this.$c=i;if(t){var e=this;t.$Hd(_a.$E3,function(n){n.$2SP&&e.$4Pr()})}};function $4st(n,t){for(var r=new Array(t.length),i=0;i<t.length;i++)r[i]=t[i].$7p;return r}function $4ss(n,t){var r=n.$FD.$34(t);n.$MI.$34(t.$7p);var i=t.$7p;!$5(i.get_$18R())&&i.get_$18R().Id in n.$XH&&delete n.$XH[i.get_$18R().Id];return r}function $75q(n,t){$BF(n,"BeforeRemindersRefresh",n,null);n.$17Q=_js.$J.get_$I().$5A(n.$17Q);n.$Q5.$1t();n.$1wX=!1;var o=n.$MI;n.$MI=t.$2dQ;for(var s=n.$FD.get_$C(),u=0;u<s;u++)n.$FD.get_$3o(u)&&n.$FD.get_$3o(u).$1R();n.$FD.$1t();n.$XH={};for(var h=_a.$7.get_utcNow(),i,f=-1,r=!1,e=n.$MI.get_$C()-1;e>=0;e--){i=n.$MI.get_$3o(e);if(i.get_$1Ib().$L7().$2U(h)>0)n.$Q5.$D(i);else{n.$FD.get_$C()||(f=o.$79(i));var c=!!i.get_$18R();if(!c||!(i.get_$18R().Id in n.$XH)){var l=n.$4Vs.$8V(i);n.$FD.$D(l);c&&(n.$XH[i.get_$18R().Id]=l);if(r)continue;r=f<0||!o.get_$3o(f).$4i(i)}f--}}r=!!(r|s!==n.$FD.get_$C());r&&$BF(n,"ActiveRemindersChanged",n.$FD,new _js.$Ia(4,0,[],[]));n.$Q5.get_$C()>0&&$2lJ(n,h);$2lK(n,t);n.$1wX=!0;$BF(n,"AfterRemindersRefresh",n,null)}function $75p(n,t){_js.Trace.logInfo(_a.$0.$Ej,"Scheduling reminders in PAL...");if(!n.$c.$5i(n.$c.get_$Iq()))return!1;for(var i=t.get_$hJ().Body.Reminders,u=[],f=i,o=f.length,r=0;r<o;++r){var e=f[r];e.ReminderGroup||Array.add(u,e)}_js.Trace.logInfo(_a.$0.$Ej,"Serializing {0} reminders...",i.length);var s=JsonParser.serialize(u);_js.Trace.logInfo(_a.$0.$Ej,"Scheduling {0} reminders on PAL...",i.length);var h=this,c=this;n.$c.get_$Iq().$9s8(s,function(){_js.Trace.logInfo(_a.$0.$Ej,"Schedule reminders on PAL succeeded.");$2lK(n,t)},function(i){_js.Trace.logError(_a.$0.$Ej,"Failed to schedule reminders on PAL : {0}",i.message);$2lK(n,t)});return!0}function $2lK(n,t){n.$1BR&&(n.$1BR=_js.$J.get_$I().$5A(n.$1BR));if(n.$72.get_$Mk()){_js.Trace.logInfo(_a.$0.$Ej,"Offline is enabled and so no need to schedule reminders timer");return}if(t){if(!t.$lA||t.$lA===1){var u=_a.$7.get_utcNow();var i=null;n.$MI.get_$C()===t.$z8&&n.$MI.get_$C()>=1&&(i=n.$MI.get_$3o(n.$MI.get_$C()-1).get_$1Ib().$L7());var f=u.$9v(288e5);var r=288e5;if(i)if(i.$2U(u)<=0)r=6e5;else if(i.$2U(f)<0){r=i.$5u(u);r=Math.max(r,6e5)}$4su(n,r)}}else $4su(n,6e5)}function $4su(n,t){_js.Trace.logInfo(_a.$0.$Ej,"Scheduling next GetReminers call to happen in {0} milliseconds",t);n.$1BR=_js.$J.get_$I().$1s(_a.$0.$Ej,"GetReminders",n.$$d_$878,t)}function $2lJ(n,t){n.$17Q=_js.$J.get_$I().$5A(n.$17Q);if(n.$Q5.get_$C()){var i=n.$Q5.get_$3o(n.$Q5.get_$C()-1);var r=i.get_$1Ib().$L7().$5u(t);var u=this;n.$17Q=_js.$J.get_$I().$1s(_a.$0.$Ej,"ActivateReminders",function(){n.$59U(_a.$7.get_utcNow())},r)}}function $4sr(n){var t=n.$b.get_$13().get_$1O9();var i=n.$b.get_$5z().get_$1c();var r=n.$b.get_$5z().get_$1o5();return n.$1A.get_$6n()?n.$b.get_$5z().get_$1c():t&&(i||r)}_d.$5O.prototype={$72:null,$4Vs:null,$1A:null,$b:null,$FD:null,$Q5:null,$c:null,$MI:null,$XH:null,$17Q:null,$1BR:null,$r0:null,$1wX:!0,$47q:!1,add_$59Z:function(n){this.$2G("ActiveRemindersChanged",n)},remove_$59Z:function(n){this.$2H("ActiveRemindersChanged",n)},add_$5Dv:function(n){this.$2G("BeforeRemindersRefresh",n)},remove_$5Dv:function(n){this.$2H("BeforeRemindersRefresh",n)},add_$5B9:function(n){this.$2G("AfterRemindersRefresh",n)},remove_$5B9:function(n){this.$2H("AfterRemindersRefresh",n)},$4Pr:function(){if(!$4sr(this)){this.$b.get_$13().$Y("EnableReminders",this.$$d_$9R0);this.$47q=!0;_js.Trace.logInfo(_a.$0.$Ej,"Disabling reminders entirely. EnableReminders:{0}, IsPalEnabled:{1} Seg.Calendar:{2} Seg.Tasks:{3}",this.$b.get_$13().get_$1O9(),this.$1A.get_$6n(),this.$b.get_$5z().get_$1c(),this.$b.get_$5z().get_$1o5());return}this.$6ir();if(this.$72.get_$Mk())_js.Trace.logInfo(_a.$0.$Ej,"Fetch reminders on OwaStarted event skipped as offline is enabled.");else{_js.Trace.logInfo(_a.$0.$Ej,"Fetch reminders on OwaStarted event.");this.$14j(0,null)}},$14j:function(n,t){_js.Trace.logInfo(_a.$0.$Ej,"Calling GetReminders. ReminderType = {0}",n);n&&n!==1||$2lK(this,null);this.$r0=_js.$J.get_$I().$5A(this.$r0);var i=new _c.$Xi(this.$1A.get_$6n(),this.$b.get_$5z());i.$lA=n;i.set_$5rg(this.$1A.get_$Hp()?64:200);var r=_a.$7.get_$2F();switch(n){case 0:i.$8Q=r.$2w(10);break;case 1:i.$1sR=r.$9v(_d.$5O.$4Ns);i.$8Q=i.$8Q=r.$2w(10);break;case 2:i.$8Q=r.$9v(_d.$5O.$4Ns);break}i.add_$29(this.$$d_$4PC);if(t){var u=this;i.add_$2t(function(n){t()})}OwaApplication.$1W.$11(i)},$2wT:function(n){if(!n||!n.length){_js.Trace.logInfo(_a.$0.$Ej,"DismissReminders called with no reminder to dismiss");return}var i=new _c.$wa(this.$MI,$4st(this,n),this.$c);OwaApplication.$1W.$11(i);for(var t=0;t<n.length;t++){$4ss(this,n[t]);n[t].$1R()}$2lJ(this,_a.$7.get_utcNow())},$2wO:function(){this.$2wT(this.$FD.$6W())},$3Ty:function(n,t){if(!n||!n.length){_js.Trace.logInfo(_a.$0.$Ej,"SnoozeReminders called with no reminders to snooze");return}var u=new _c.$11c($4st(this,n),t,this.$c);OwaApplication.$1W.$11(u);for(var f=_a.$7.get_utcNow(),i,r=0;r<n.length;r++){i=n[r];$4ss(this,i);this.$Q5.$D(i.$7p);this.$MI.$D(i.$7p)}$2lJ(this,f)},$59U:function(n){for(var t=[],i,r,u,f=this.$Q5.get_$C()-1;f>=0;f--){i=this.$Q5.get_$3o(f);r=this.$4Vs.$8V(i);if(i.get_$1Ib().$L7().$2U(n)<=0){var e=i.get_$18R()?i.get_$18R().Id:"";if(this.$XH[e]){u=this.$XH[e];this.$FD.$34(u);u.$1R();this.$XH[e]=r}Array.add(t,r)}else break}if(t.length>0){this.$FD.$6S(t);this.$Q5.$VI(this.$Q5.get_$C()-t.length,t.length)}$2lJ(this,n)},$6ir:function(){_js.Trace.logInfo(_a.$0.$Ej,"Subscribe for reminders notifications.");var n=new _g.$Ac;n.NotificationType="ReminderNotification";var t=new _h.$B8(n);t.$Hd(_a.$0.$Ej,"ReminderNotification",this.$$d_$9ZL,0)},$5If:function(n,t){return _c.$Lh.$2ss(t,n)},$5IX:function(n,t){return _d.$7m.$5IY(t,n)},$17X:function(n,t){this.$1wX&&$BF(this,"ActiveRemindersChanged",n,t)},$9ZL:function(n){_a.$3.$K(n,"notification");if(n.id!=="ReminderNotification")throw Error.argument("notification","Notification Id must be ReminderNotification");_js.Trace.logInfo(_a.$0.$Ej,"Received reminder notification");var t=n;if(t.shouldGetReminders){this.$r0&&(this.$r0=_js.$J.get_$I().$5A(this.$r0));var i=this;this.$r0=_js.$J.get_$I().$1s(_a.$0.$Ej,"ReminderNotification",function(){i.$14j(0,null)},8e3)}},$4PC:function(n){var t=n;_js.Trace.logInfo(_a.$0.$Ej,"GetReminders succeeded. Received {0} reminders",t.$2dQ.get_$C());$75p(this,t)||$75q(this,t)},$878:function(){_js.Trace.logInfo(_a.$0.$Ej,"GetReminers timer expired");this.$14j(0,null)},$9R0:function(n,t){if($4sr(this)){this.$6ir();this.$14j(0,null);this.$b.get_$13().$q("EnableReminders",this.$$d_$9R0);this.$47q=!1}},$49:function(){this.$47q&&this.$b.get_$13().$q("EnableReminders",this.$$d_$9R0);_a.$1.prototype.$49.call(this)}};_d.$7c=function(n){this.$$d_$6OM=Function.createDelegate(this,this.$6OM);this.$$d_$6n0=Function.createDelegate(this,this.$6n0);this.$$d_$2wO=Function.createDelegate(this,this.$2wO);this.$$d_$5Q0=Function.createDelegate(this,this.$5Q0);this.$$d_$6ND=Function.createDelegate(this,this.$6ND);this.$$d_$6My=Function.createDelegate(this,this.$6My);this.$$d_$6HR=Function.createDelegate(this,this.$6HR);this.$$d_$6Hs=Function.createDelegate(this,this.$6Hs);this.$$d_$17X=Function.createDelegate(this,this.$17X);_d.$7c.initializeBase(this);this.$Nv=n;n.$FD.add_$1Y(this.$$d_$17X);n.add_$5Dv(this.$$d_$6Hs);n.add_$5B9(this.$$d_$6HR);this.$Fi=new _js.$c;this.$Fi.$Y("Count",this.$$d_$6My);this.$uR=[];var t=this;this.$2gw=new _C(this.$$d_$6ND,_d.$7c.$A,this,"CanActOnSelectedReminders",function(){return t.get_$1t4()});var i=this;this.$2M7=new _C(this.$$d_$5Q0,_d.$7c.$A,this,"CanActOnSelectedReminders",function(){return i.get_$1t4()});this.$2wP=new _C(this.$$d_$2wO,_d.$7c.$A);this.$ek=new _C(this.$$d_$6n0,_d.$7c.$A);this.$3Kj=new _C(this.$$d_$6OM,_d.$7c.$A);this.$BU=new _js.$c;$75r(this);$3bd(this,!1);if(_y.$x.$w.get_$L()!=="Mouse"){var r=[new _y.$2Q(_y.$d.get_$hG(),_y.$d.get_$29j(),_nbs.NonBootStrings.l_Snooze_Text,this.$2gw),new _y.$2Q(_y.$d.get_$xE(),_y.$d.get_$xF(),_u.Strings.l_Dismiss_Text,this.$2M7)];this.set_$6k(_y.$22.$E(this,r,null))}};function $75t(n){for(var i,r=n.$Nv.$FD,t=0;t<r.get_$C();t++){i=r.get_$3o(t);i.$6nj()}}function $3bd(n,t){var i=[];if(n.$CE&&n.$Fi.get_$C()===1){var u=_a.$7.get_$2F();var f=n.$CE.$7p.get_$91().$Bp(-15);u.$2U(f)<=0&&Array.add(i,-15);u.$2U(f.$Bp(5))<=0&&Array.add(i,-10);u.$2U(f.$Bp(10))<=0&&Array.add(i,-5);u.$2U(n.$CE.$7p.get_$91())<=0&&Array.add(i,0)}if(!i.length||i[0]!==n.$BU.get_$3o(0)){for(var r=0;r<n.$BU.get_$C();r++)if(n.$BU.get_$3o(r)===5)break;n.$BU.$VI(0,r);i.length>0&&n.$BU.$am(0,i)}(n.$uo<n.$BU.get_$3o(0)||t)&&n.set_$3Qp(n.$BU.get_$3o(0))}function $75r(n){n.$BU.$D(5);n.$BU.$D(10);n.$BU.$D(15);n.$BU.$D(30);n.$BU.$D(60);n.$BU.$D(120);n.$BU.$D(240);n.$BU.$D(480);n.$BU.$D(720);n.$BU.$D(1440);n.$BU.$D(2880);n.$BU.$D(4320);n.$BU.$D(5760);n.$BU.$D(10080);n.$BU.$D(20160)}function $75s(n,t){if(t>0)n.$Nv.$3Ty(n.$Fi.$6W(),_a.$7.get_$2F().$Bp(t));else{var i=n.$CE.$7p.get_$91().$Bp(t);n.$Nv.$3Ty([n.$CE],i)}}_d.$7c.prototype={$ek:null,$Nv:null,$CE:null,$Fi:null,$BU:null,$uo:0,$2gw:null,$2M7:null,$2wP:null,$3Kj:null,$uR:null,get_$KN:function(){return _y.$x.$w.get_$L()!=="Mouse"?_y.$1Mq.prototype.get_$KN.call(this):0},add_$6Vm:function(n){this.$2G("ReminderOpened",n)},remove_$6Vm:function(n){this.$2H("ReminderOpened",n)},get_$VK:function(){return this.$CE},set_$VK:function(n){if(this.$CE!==n){this.$CE=n;$3(this,"SelectedReminder");$3bd(this,!0)}return n},get_$3Qp:function(){return this.$uo},set_$3Qp:function(n){if(n!==this.$uo){this.$uo=n;$3(this,"SelectedSnoozeTime")}return n},get_$6al:function(){return this.$Fi},set_$6al:function(n){this.$Fi!==n&&(this.$Fi=n);return n},get_$KE:function(){return 2},get_$1t4:function(){return this.$Fi.get_$C()>0},$6n0:function(){$75t(this);$3bd(this,!1)},$6OM:function(){if(this.$CE&&this.$CE.$PL.$2T){this.$CE.$PL.$s();$BF(this,"ReminderOpened",this.$CE,null)}},$6My:function(n,t){$3(this,"CanActOnSelectedReminders")},$6Hs:function(n,t){Array.clear(this.$uR);for(var r,u,i=0;i<this.$Fi.get_$C();i++){r=this.$Fi.get_$3o(i);u=r.$7p.get_$i().Id;Array.add(this.$uR,u)}this.set_$VK(null);this.$Fi.$1t();return},$6HR:function(n,t){var i=n.$FD;var e;var u;var r;if($5(this.$CE)){for(var f=0;f<this.$uR.length;f++){e=this.$uR[f];var o=this;u=i.$Dn(function(n){return _d.$7m.isInstanceOfType(n)&&n.$7p.get_$i().Id===e});if(u<i.get_$C()){r=i.get_$3o(u);$5(this.$CE)&&this.set_$VK(r);this.$Fi.$79(r)===-1&&this.$Fi.$D(r)}}$5(this.$CE)&&this.set_$VK(i.get_$3o(0));Array.clear(this.$uR)}},$17X:function(n,t){var u=!1;var f=!1;var i=n;switch(t.$2Z){case 0:return;case 2:for(var r=0;r<t.$3B.length;r++){u=!!(u|this.$Fi.$34(t.$3B[r]));f=!!(f|t.$3B[r]===this.$CE)}if(f||u&&!this.$Fi.get_$C()){var e=t.$4b+t.$3B.length-1;i.get_$C()>e?this.set_$VK(i.get_$3o(e)):i.get_$C()>0?this.set_$VK(i.get_$3o(i.get_$C()-1)):this.set_$VK(null)}break;case 3:this.$17X(n,new _js.$Ia(2,t.$4b,null,t.$3B));this.$17X(n,new _js.$Ia(0,t.$4b,t.$2q,null));break;case 4:this.set_$VK(null);this.$Fi.$1t();break;default:throw Error.argumentOutOfRange("evtArgs.Action");}},$6ND:function(){$75s(this,this.$uo)},$5Q0:function(){this.$Nv.$2wT(this.$Fi.$6W())},$2wO:function(){this.$Nv.$2wO()}};_d.$1De=function(n,t,i,r,u){this.$$d_$8Ha=Function.createDelegate(this,this.$8Ha);_d.$1De.initializeBase(this,[u]);this.$3AK=n;this.$2iA=t;this.$AR=i;this.$1z=r};_d.$1De.prototype={$3AK:0,$2iA:0,$lF:1,$AR:null,$40O:!1,$1z:null,$y:function(){_js.Trace.logInfo(_a.$0.$5l,"RetryTimer.Start");this.$40O=!1;this.$1s(this.$$d_$8Ha,this.$2iA,this.$1z)},$20:function(){_js.Trace.logInfo(_a.$0.$5l,"RetryTimer.End");this.$40O=!0;this.$lF=this.$3AK;this.$3lb()},$8Ha:function(){_js.Trace.logInfo(_a.$0.$5l,"RetryTimer.Callback: count {0}",this.$lF);this.$AR();if(this.$lF<this.$3AK){this.$lF++;this.$1s(this.$$d_$8Ha,this.$2iA,this.$1z)}else{_js.Trace.logInfo(_a.$0.$5l,"RetryTimer.Callback: Retry count {0} exceeds max {1}",this.$lF,this.$3AK);this.$20()}}};_d.$Qa=function(n,t,i,r){this.$2Km=this.$$gta["_d.$Qa"].T===Number||Type.isEnum(this.$$gta["_d.$Qa"].T)?0:this.$$gta["_d.$Qa"].T===Boolean?!1:null;if(!t)throw Error.argumentNull("isSameSelection");if(!i)throw Error.argumentNull("setSelection");if(!r)throw Error.argumentNull("undoSelection");this.$2Km=n;this.$5lU=t;this.$6dW=i;this.$6mM=r};_d.$Qa.$$=function(n){var t="$Qa"+"$1"+"$"+n.getName().replace(/\./g,"_");if(!_d[t]){var r=_d[t]=function(){(this.$$gta=this.$$gta||{})["_d.$Qa"]={T:n};for(var i=[],t=0;t<arguments.length;++t)i[t]=arguments[t];_d.$Qa.apply(this,i)};r.registerClass("_d."+t);var u=_d.$Qa.prototype;for(var f in u){var i={key:f,value:u[f]};"constructor"!==i.key&&(r.prototype[i.key]=i.value)}}return _d[t]};_d.$Qa.prototype={$5lU:null,$6dW:null,$6mM:null,$6Q:function(n){if(!this.$5lU(this.$2Km)){var t=this;n.$3NL(function(n){n?t.$2Km=t.$6dW():t.$6mM(t.$2Km)})}}};_d.$14M=function(n,t){_d.$14M.initializeBase(this,[t]);this.$5IO=n};_d.$14M.prototype={$5IO:null,$9ZE:function(){if(this.$ZN.get_$C()===1){var n=this.$ZN.get_$3o(0);this.$5IO.$9OE(n)}},$7o8:function(){this.$y6.$D(_nbs.NonBootStrings.l_SpeechCombinedSearchHint1_Text);this.$y6.$D(_nbs.NonBootStrings.l_SpeechCombinedSearchHint2_Text);this.$y6.$D(_nbs.NonBootStrings.l_SpeechCombinedSearchHint3_Text);this.$y6.$D(_nbs.NonBootStrings.l_SpeechCombinedSearchHint4_Text);this.$VQ=new _d.$3E(new(_d.$Vf.$$(_c.$14L))(this.$Qr),_nbs.NonBootStrings.l_SpeechCombinedScenarioListening_Text,_nbs.NonBootStrings.l_SpeechCombinedScenarioWithExample_Text,this.$y6);this.$VQ.$33x=_nbs.NonBootStrings.l_SpeechInvalidRequest_Text}};_d.$1CN=function(n,t,i){this.$$d_$1Tf=Function.createDelegate(this,this.$1Tf);this.$$d_$9cC=Function.createDelegate(this,this.$9cC);_d.$1CN.initializeBase(this,[i]);this.$59V=n;this.$6I5=t;if(this.get_$47j()){this.$VQ.set_$2hH(new _C(this.$$d_$9cC,_a.$0.$SK));this.$VQ.add_$5ml(this.$$d_$1Tf)}};_d.$1CN.prototype={$59V:null,$6I5:null,$9ZE:function(){},$7o8:function(){this.$y6.$D(_nbs.NonBootStrings.l_SpeechFindPeopleHint1_Text);this.$y6.$D(_nbs.NonBootStrings.l_SpeechFindPeopleHint2_Text);this.$y6.$D(_nbs.NonBootStrings.l_SpeechFindPeopleHint3_Text);this.$y6.$D(_nbs.NonBootStrings.l_SpeechFindPeopleHint4_Text);this.$VQ=new _d.$3E(new(_d.$Vf.$$(_c.$16N))(this.$Qr),_nbs.NonBootStrings.l_SpeechSayAContactName_Text,_nbs.NonBootStrings.l_SpeechSayAContactNameWithExample_Text,this.$y6);this.$VQ.set_$6GF(_nbs.NonBootStrings.l_SpeechFindPeopleNoResultsAvailable_Text)},$5m:function(){this.$VQ.$5m()},$9cC:function(){this.$5m();this.$59V()},$1Tf:function(n,t){if(!n.get_$Dl()){this.$VQ.$4UK||this.$6I5();this.$VQ.$78()}}};_d.$10C=function(){this.$1XQ=""};_d.$10C.prototype={$3y5:function(n){return new _c.$1CO(this.$1XQ,n)}};_d.$1N0=function(n){this.$$d_$1Tf_4=Function.createDelegate(this,this.$1Tf_4);this.$$d_$5m=Function.createDelegate(this,this.$5m);_d.$1N0.initializeBase(this);_a.$3.$m(n,"speechManager");this.$Qr=n;if(this.get_$47j()){this.$y6=new _js.$c;this.$ZN=new _js.$c;this.$7o8();this.$VQ.set_$2hH(new _C(this.$$d_$5m,_a.$0.$SK));this.$VQ.add_$5ml(this.$$d_$1Tf_4)}else this.$VQ=null};_d.$1N0.prototype={$Qr:null,$VQ:null,$ZN:null,$z1:null,$y6:null,get_$47j:function(){return this.$Qr.get_$47j()&&_g.$V.get_$I().get_$2z().get_$5ma()},$5m:function(){this.$ZN.$1t();this.$z1=this.$VQ.$3y5(this.$ZN);this.$VQ.$5m();this.$z1&&OwaApplication.$1W.$11(this.$z1)},$1Tf_4:function(n,t){if(!n.get_$Dl()){this.$9ZE();this.$VQ.$78()}}};_d.$Vf=function(n){_a.$3.$m(n,"speechManager");this.$Qr=n};_d.$Vf.$$=function(n){var t="$Vf"+"$1"+"$"+n.getName().replace(/\./g,"_");if(!_d[t]){var r=_d[t]=function(){(this.$$gta=this.$$gta||{})["_d.$Vf"]={TAction:n};for(var i=[],t=0;t<arguments.length;++t)i[t]=arguments[t];_d.$Vf.apply(this,i)};r.registerClass("_d."+t,null,_y.$19K);var u=_d.$Vf.prototype;for(var f in u){var i={key:f,value:u[f]};"constructor"!==i.key&&(r.prototype[i.key]=i.value)}}return _d[t]};_d.$Vf.prototype={$Qr:null,$3y5:function(n){var t=new this.$$gta["_d.$Vf"].TAction;t.$41(this.$Qr,n);return t}};_d.$3E=function(n,t,i,r){this.$$d_$9c8=Function.createDelegate(this,this.$9c8);this.$$d_$9c9=Function.createDelegate(this,this.$9c9);this.$$d_$3Iu=Function.createDelegate(this,this.$3Iu);this.$$d_$3US=Function.createDelegate(this,this.$3US);this.$$d_$8Dr=Function.createDelegate(this,this.$8Dr);this.$$d_$9J=Function.createDelegate(this,this.$9J);_d.$3E.initializeBase(this);this.set_$DT(this);this.$4jx=t;this.$6pt=i;this.$6hb=r;this.$1r0=n;this.set_$Fw(new _C(this.$$d_$9J,_a.$0.$SK));this.set_$8Dn(new _C(this.$$d_$8Dr,_a.$0.$SK));this.$322=!1;this.set_$6iP(new _C(this.$$d_$3US,_a.$0.$SK));this.set_$2oH(new _js.$c);this.$33x=_nbs.NonBootStrings.l_SpeechInvalidRequest_Text;this.set_$3TK(!0)};_d.$3E.$9Tn=function(n){_js.Trace.logInfo(_a.$0.$SK,"SpeechInputViewModel.OnIsErrorChanged: NewValue: {0}",n.newValue);var t=n.instance;t.$3PU.set_$r(!n.newValue);t.$12x.set_$r(!n.newValue)};_d.$3E.$9Tt=function(n){_js.Trace.logInfo(_a.$0.$SK,"SpeechInputViewModel.OnIsListeningChanged: NewValue: {0}",n.newValue);var t=n.instance;t.$Vn.set_$r(!n.newValue);t.$314.set_$r(!n.newValue)};_d.$3E.$9Ty=function(n){_js.Trace.logInfo(_a.$0.$SK,"SpeechInputViewModel.OnIsThinkingChanged: NewValue: {0}",n.newValue);var t=n.instance;t.$Vn.set_$r(!n.newValue)};function $76b(n,t){$4tG(n);switch(_a.$4h.$3we(t).$26m){case 1e3:$3bn(n);n.set_$4o(n.get_$6GF());n.set_$3TK(!1);break;case 1:$3bn(n);n.set_$4o(_nbs.NonBootStrings.l_SpeechHintTitle_Text);n.set_$3TK(!1);n.$322=!1;break;case 1003:$3bn(n);n.set_$4o(n.$33x);break;case 5:n.set_$4o(_nbs.NonBootStrings.l_SpeechNoNetworkAccess_Text);n.set_$vA(_nbs.NonBootStrings.l_SpeechNoNetworkAction_Text);break;case 4:case 3:n.set_$4o(_nbs.NonBootStrings.l_SpeechRecordingError_Text);n.set_$vA(_nbs.NonBootStrings.l_SpeechNoMicrophone_Text);break;case 1002:n.set_$4o(_nbs.NonBootStrings.l_SpeechRecordingError_Text);n.set_$vA(_nbs.NonBootStrings.l_SpeechNoSpeech_Text);break;case 1006:n.set_$4o(_nbs.NonBootStrings.l_SpeechNoResultsAvailable_Text);n.set_$vA(_nbs.NonBootStrings.l_SpeechNoContactWithEmailAddress_Text);break;case 6:n.set_$4o(_nbs.NonBootStrings.l_SpeechServerError_Text);n.set_$vA(_nbs.NonBootStrings.l_SpeechServerBusy_Text);break;case 1005:n.set_$4o(_nbs.NonBootStrings.l_SpeechServerError_Text);n.set_$vA(_nbs.NonBootStrings.l_SpeechInvalidCredentials_Text);break;case 1004:n.set_$4o(n.$33x);n.set_$vA(_nbs.NonBootStrings.l_SpeechMaxRequestsExceeded_Text);break;default:n.set_$4o(_nbs.NonBootStrings.l_SpeechServerError_Text);n.set_$vA(t.message);break}}function $3bn(n){n.set_$vA(n.$6pt);n.set_$2oH(n.$6hb)}function $4tG(n){n.set_$vA("");n.set_$4o("");n.set_$2oH(null);n.$4UK=!1;n.set_$3TK(!0)}function $76c(n){n.set_$St(new _js.$c);n.$3PU=new _a.$2E(n.get_$2hH(),_u.Strings.l_Retry_Text);n.$3PU.set_$r(!0);n.$7W.$D(n.$3PU);n.$314=new _a.$2E(n.get_$6iP(),_nbs.NonBootStrings.l_Go_Text);n.$314.set_$r(!0);n.$7W.$D(n.$314);n.$Vn=new _a.$2E(n.$4f,_u.Strings.l_ConfirmDialog_Cancel_Text);n.$Vn.set_$r(!0);n.$7W.$D(n.$Vn);n.$12x=new _a.$2E(n.$4f,_u.Strings.l_Close_Text);n.$12x.set_$r(!0);n.$7W.$D(n.$12x)}_d.$3E.prototype={$X6:null,$3PU:null,$314:null,$Vn:null,$12x:null,$6hb:null,$4jx:null,$6pt:null,$33x:null,$4UK:!1,$3TJ:!1,$31y:null,$1r0:null,$322:!1,add_$5ml:function(n){this.$Y(_d.$3E.$2TR.$1k,n)},remove_$5ml:function(n){this.$q(_d.$3E.$2TR.$1k,n)},get_$2hH:function(){return this.$W(_d.$3E.$4dQ)},set_$2hH:function(n){this.$M(_d.$3E.$4dQ,n);return n},get_$6iP:function(){return this.$W(_d.$3E.$4dc)},set_$6iP:function(n){this.$M(_d.$3E.$4dc,n);return n},get_$200:function(){return this.$W(_d.$3E.$44s)},set_$200:function(n){this.$M(_d.$3E.$44s,n);return n},get_$Dl:function(){return this.$W(_d.$3E.$2TR)},set_$Dl:function(n){this.$M(_d.$3E.$2TR,n);return n},get_$45r:function(){return this.$W(_d.$3E.$45s)},set_$45r:function(n){this.$M(_d.$3E.$45s,n);return n},get_$483:function(){return this.$W(_d.$3E.$484)},set_$483:function(n){this.$M(_d.$3E.$484,n);return n},get_$47M:function(){return this.$W(_d.$3E.$47N)},set_$47M:function(n){this.$M(_d.$3E.$47N,n);return n},get_$vA:function(){return this.$W(_d.$3E.$4dV)},set_$vA:function(n){this.$M(_d.$3E.$4dV,n);return n},get_$6GF:function(){return this.$W(_d.$3E.$4N8)},set_$6GF:function(n){this.$M(_d.$3E.$4N8,n);return n},get_$2oH:function(){return this.$W(_d.$3E.$3hF)},set_$2oH:function(n){this.$M(_d.$3E.$3hF,n);return n},get_$6hd:function(){return this.$W(_d.$3E.$4dB)},set_$6hd:function(n){this.$M(_d.$3E.$4dB,n);return n},get_$6ha:function(){return this.$X6},set_$6ha:function(n){if(n){if(this.$X6)throw Error.invalidOperation("SpeechAction cannot be set while another speech action is active");this.$X6=n;this.$X6.add_$2t(this.$$d_$3Iu);this.$X6.$Qr.add_$6iD(this.$$d_$9c9);this.$X6.$Qr.add_$5oj(this.$$d_$9c8)}else if(this.$X6){this.$X6.remove_$2t(this.$$d_$3Iu);this.$X6.$Qr.remove_$6iD(this.$$d_$9c9);this.$X6.$Qr.remove_$5oj(this.$$d_$9c8);this.$X6=null}return n},get_$3TK:function(){return this.$3TJ},set_$3TK:function(n){if(this.$3TJ!==n){this.$3TJ=n;$3(this,"ShowShortPanelSize")}return n},get_$8Dn:function(){return this.$31y},set_$8Dn:function(n){if(this.$31y!==n){this.$31y=n;$3(this,"HelpCommand")}return n},$3y5:function(n){this.set_$6ha(this.$1r0.$3y5(n));return this.$X6},$5m:function(){$76c(this);this.set_$4o(this.$4jx)},$78:function(){_js.Trace.logInfo(_a.$0.$SK,"SpeechInputViewModel.Deactivate");this.$9J()},$9c9:function(n){_js.Trace.logInfo(_a.$0.$SK,"SpeechInputViewModel.OnSpeechStateChanged: {0}",_a.$tt.toString(n));$4tG(this);this.set_$45r(n===1);this.set_$483(n===2);if(this.get_$45r()){this.set_$200(!1);this.set_$47M(!1);this.set_$4o(this.$4jx);this.set_$Dl(!0)}else if(this.get_$483()){this.set_$4o(_nbs.NonBootStrings.l_SpeechThinkingState_Text);this.set_$vA(_nbs.NonBootStrings.l_SpeechPleaseWait_Text);this.$X6.$5px("Thinking")}},$9c8:function(n){this.set_$6hd(n)},$3US:function(){_js.Trace.logInfo(_a.$0.$SK,"SpeechInputViewModel.StopListening");this.$X6.$3US()},$9J:function(){_js.Trace.logInfo(_a.$0.$SK,"SpeechInputViewModel.Cancel");this.set_$Dl(!1);if(this.$X6){_js.Trace.logInfo(_a.$0.$SK,"SpeechInputViewModel.Cancel: speechAction != null calling SpeechAction.Cancel()");this.$X6.$9J()}},$8Dr:function(){_js.Trace.logInfo(_a.$0.$SK,"SpeechInputViewModel.HelpPressed");this.$322=!0;this.$X6.$9J()},$3Iu:function(n){_js.Trace.logInfo(_a.$0.$SK,"SpeechInputViewModel.OnActionCompleted");var t=this.$X6.$1d;this.$X6.$ZN.get_$C()>0&&(this.$4UK=!0);this.set_$6ha(null);this.set_$200(!1);if(!$5(t)){_js.Trace.logInfo(_a.$0.$SK,"SpeechInputViewModel.OnActionCompleted: Error:{0}",t.message);if(!_a.$4h.$Ue(t)||this.$322){this.set_$200(!0);$76b(this,t);this.set_$47M(_a.$4h.$47M(t))}}this.set_$Dl(this.get_$200())}};_d.$Ov=function(n){_d.$Ov.initializeBase(this);this.$Ou=n};function $76n(n){var t=!1;switch(n.$7Q){case 1:n.$2E=n.$WQ.$2b(10);t=n.$WQ.get_$8Lo();n.set_$41L(!t);n.$Ou==="Mouse"?n.set_$48P(n.$WQ.$2b(3)):n.$Ou==="TouchWide"&&n.set_$4Zu(t?_a.$7.$3x2(n.$WQ.$2w(1).get_$3T(),1):null);break;case 2:n.$2E=_a.$7.$3x2(n.$WQ.get_$3T(),1);t=n.$WQ.get_$3T()===11;n.set_$41L(!t);n.$Ou==="Mouse"?n.set_$48P(n.$WQ.$2b(2)):n.$Ou==="TouchWide"&&n.set_$4Zu(t?n.$WQ.$IC(1).$2b(13,1):null);break;case 3:var i=_a.$7.$Mb(n.$WQ);var r=i.$2w(6);n.$2E=_a.$7.$881(i,r);n.set_$41L(!0);n.set_$4Zu(null);n.$Ou==="Mouse"&&n.set_$48P(_a.$7.$2OZ(i,r));break;default:throw Error.argumentOutOfRange("mode",n.$7Q,"GenerateTextValue() should not be called before the TimeStripMode has been set.");}if(n.$Ou==="Mouse"){var u=n.$2E.replace(" ","");if(n.$2E!==u){n.$2E=u;if(!_d.$Ov.$4AT){_js.Trace.logWarning(_a.$0.$1c,"Removing space character from localized time strip item. This is only expected for for pesudo-localized builds.");_d.$Ov.$4AT=!0}}}}_d.$Ov.prototype={$2E:null,$1ml:null,$48O:null,$32X:!0,$7Q:0,$WQ:null,$Ou:0,get_$48P:function(){return this.$48O},set_$48P:function(n){this.$48O=n;$3(this,"ItemAriaLabel");return n},get_$5n:function(){return this.$WQ},set_$5n:function(n){this.$WQ=n;$76n(this);return n},get_$41L:function(){return this.$32X},set_$41L:function(n){if(n!==this.$32X){this.$32X=n;$3(this,"HideSeparator")}return n},get_$4Zu:function(){return this.$1ml},set_$4Zu:function(n){if(n!==this.$1ml){this.$1ml=n;$3(this,"SeparatorText")}return n}};_d.$129=function(n){this.$2C=n};_d.$129.prototype={$2C:null,$1P9:null,$1s:function(n,t,i){this.$1P9=_js.$J.get_$I().$1s(i,this.$2C,n,t)},$3lb:function(){this.$1P9&&(this.$1P9=_js.$J.get_$I().$5A(this.$1P9))}};_d.$Wy=function(n,t,i,r,u,f,e){this.$$d_$8RP=Function.createDelegate(this,this.$8RP);this.$B=n;this.$b=t;this.$J=i;this.$Aw=r;this.$2D=u;this.$7B=f;this.$MX=e};function $712(n){var i="archiverecoverableitemsdeletions";var t=new _h.$kJ("GetFolderAction_DumpsterPopOutViewModelFactory_"+i,!1);t.$1cQ=new _h.$XC;t.$fq=[new _g.$7N(i)];t.add_$2t(n.$$d_$8RP);OwaApplication.$1W.$11(t)}_d.$Wy.prototype={$Aw:null,$2D:null,$7B:null,$B:null,$b:null,$J:null,$1bb:null,$MX:null,$br:function(n,t){var i=n.IsArchive.toString()==="true";var r=new _y.$Ef(this.$B,this.$b,null,null);var u=new _d.$DQ(this.$B,this.$b,this.$J,this.$Aw,this.$2D,this.$7B,this.$MX);this.$1bb=new _d.$wi(u,r);if(i&&!_g.$h.$1i.nameToId("archiverecoverableitemsdeletions"))$712(this);else{var f=i?_g.$2Z.$BJ("archiverecoverableitemsdeletions"):_g.$2Z.$BJ("recoverableitemsdeletions");this.$1bb.$fh.set_$2r(f);this.$1bb.$fh.$T7(0)}return this.$1bb},$wx:function(n,t){throw Error.notImplemented("Creating from context is not supported");},$6E:function(n){var t={};t.IsArchive=n;this.$B.$6E(_d.$Wy,null,t,_y.$48.get_$xM())},$8RP:function(n){var t=n;t.remove_$2t(this.$$d_$8RP);if(t.$1d){this.$1bb.$fh.set_$O0(11);return}this.$1bb.$fh.set_$2r(t.$1cQ.get_$3o(0));this.$1bb.$fh.$T7(0)}};_d.$Wy.$4Tb=function(n){this.$fm=n;var t=this;this.$fm.$J.$Hd(_y.$tr,function(n){t.$fm.$6E(n.$2Q.get_$BI()==="archivedeleteditems")})};_d.$Wy.$4Tb.prototype={$fm:null};_d.$pc=function(n,t,i){this.$1i=n;this.$Oa=t;this.$1H=i||null};_d.$pc.prototype={$1i:null,$Oa:null,$1H:null,$5Lu:function(n,t){return new _d.$Bn(n,this.$1i,t,this.$Oa)},$5Kn:function(n){return new _d.$16E(this.$Oa,n,this.$1H)}};_d.$16E=function(n,t,i){this.$Oa=n;this.$1Od=t;this.$1H=i||null};_d.$16E.prototype={$Oa:null,$1H:null,$1Od:0,$7w4:function(n,t){_a.$6.stPT(_a.$0.$5l,"AppActivationInComposeForm",5);for(var a=_a.$6.$1X(_a.$0.$5l,"AppActivationInComposeForm",!0),v=_a.$7.get_$2F(),u=new(_0365f.$n.$$(_d.$GJ)),r=0;r<n.length;r++){var f=n[r];var i;var e,o;if(o=_d.$GJ.$6ln(f,new _d.$wo(this.$Oa,this.$1Od),e={val:i}),i=e.val,o){var s=null;var y=_a.$7.get_$2F();var h,c;var l=i.$1Y6?(c=i.$1Y6.$2xo(null,i.$mz,h={val:s}),s=h.val,c):!1;var p=_a.$7.get_$2F();l&&u.$D(i);this.$Oa.$6lG(f.Id,p.$5u(y),l)}}this.$Oa.$6lM(_a.$7.get_$2F().$5u(v));t(u);this.$AG();this.$Oa.$5UP();_a.$6.$19(a,"AppActivationInComposeForm");_a.$6.endPT("AppActivationInComposeForm")},$9yo:function(){return!!this.$1H&&this.$1H.$3N("ComposeApps")},$AG:function(){}};_d.$Bn=function(n,t,i,r){this.$P=n;this.$5hl=i;this.$Oa=r;this.$1i=t};function $71K(n,t){if(!_d.$Bn.$2Zz){_d.$Bn.$2Zz={};for(var i=0;i<_d.$Bn.$4Mx.length;i++){var u=_d.$Bn.$4Mx[i];var r=n.$1i.nameToId(u);r&&(_d.$Bn.$2Zz[r.Id]=!0)}}return!(t in _d.$Bn.$2Zz)}function $4qo(n,t){if(n.$1wC){_a.$6.stPT(_a.$0.$5l,"AppActivationInReadingPane",5);var h=_a.$6.$1X(_a.$0.$5l,"AppActivationInReadingPane",!0);var u=new(_0365f.$n.$$(_d.$GJ));n.$Oa.$6lI(n.$P.get_$3N5(),n.$P.get_$142());for(var c=_a.$7.get_$2F(),f=null,r=0;r<n.$1wC.get_$C();r++){var i=n.$1wC.get_$3o(r);var l=_a.$7.get_$2F();var e,o;var s=(o=$71L(n,i,e={val:f}),f=e.val,o);var a=_a.$7.get_$2F();if(s){u.$D(i);i.$9w3(n.$P.get_$142())}n.$Oa.$6lG(i.$6m.Id,a.$5u(l),s)}n.$Oa.$6lM(_a.$7.get_$2F().$5u(c));t(u);n.$AG();n.$Oa.$5UP();_a.$6.$19(h,"AppActivationInReadingPane","");_a.$6.endPT("AppActivationInReadingPane")}}function $71L(n,t,i){if($5(t)||$5(t.$1Y6))return!1;var r=!1;t.$mz.$2dH={};r=!!(r|t.$1Y6.$2xo(n.$P,t.$mz,i));return r}function $71J(n,t){var i=new _c.$xI(n.$P);var r=this;i.add_$29(function(i){$4qo(n,t)});OwaApplication.$1W.$11(i)}_d.$Bn.prototype={$5hl:!1,$P:null,$Oa:null,$1wC:null,$1i:null,$7w4:function(n,t){var u=!0;this.$1wC=new(_0365f.$n.$$(_d.$GJ));for(var r=0;r<n.length;r++){var s=n[r];var f=new _d.$wo(this.$Oa,1);f.$na=this.$5hl;var i;var e,o;if(o=_d.$GJ.$6ln(s,f,e={val:i}),i=e.val,o){this.$1wC.$D(i);i.$1Y6&&(i.$1Y6.$5jN(this.$P,i.$mz)||(u=!1))}}u?$4qo(this,t):$71J(this,t)},$9yo:function(){if(this.$P.get_$5r()||this.$P.get_$DI())return!1;if(this.$P.get_$7n()){var n=this.$P.get_$7n().toLowerCase();if(n.startsWith("report")||-1!==n.indexOf(".smime"))return!1}return this.$P.get_$28()&&!$71K(this,this.$P.get_$28().Id)?!1:!0},$AG:function(){this.$1wC=null}};_d.$un=function(n,t,i,r){this.$$d_$AEF=Function.createDelegate(this,this.$AEF);this.$$d_$7c3=Function.createDelegate(this,this.$7c3);_d.$un.initializeBase(this,[i,r]);this.$Cz=n;this.$1M1=t};_d.$un.$83h=function(n){switch(n){case 0:return 9007;case 3:return 9e3;case 1:default:return 9007}};_d.$un.prototype={$Cz:null,$1M1:null,$1Lw:null,$7wW:function(){var n;if(!this.$AAL()){$q3(this);return}var t,i,r;if(r=this.$A9m(t={val:n},i={val:this.$1Lw}),n=t.val,this.$1Lw=i.val,r){this.$1Lw.add_$83(this.$$d_$7c3);this.$1Lw.add_$1Tk(this.$$d_$AEF)}else{$q2(this,n,null);return}},$AEF:function(n){this.$1Lw.remove_$1Tk(this.$$d_$AEF);if(n.get_$6OQ()){var t=_d.$un.$83h(n.get_$2Hw());$q2(this,t,null);return}var i=this.$1M1.$D(this.$1Lw);$hv(this,i,null)},$7c3:function(n,t){if(t==="IsDeleted"&&this.$1Lw.get_$15M()){this.$1Lw.remove_$83(this.$$d_$7c3);$q2(this,9006,null)}}};_d.$12j=function(n,t,i,r){_d.$12j.initializeBase(this,[n,t,i,r])};_d.$12j.prototype={get_$Wl:function(){return"AddItemAttachment"},get_$6Qa:function(){return 3},$AAL:function(){var n=this.$z.itemId;var t=this.$z.name;if(_js.$8.$a(n)||_js.$8.$a(t)){_js.Trace.logError(_a.$0.$5l,"AddItemAttachment got null or empty itemId or name");return!1}else if(n.length>200||t.length>255){_js.Trace.logError(_a.$0.$5l,"AddItemAttachment got too long itemId or name");return!1}else return!0},$A9m:function(n,t){var r=this.$z.itemId;var u=this.$z.name;var i=new _g.$8z;i.set_$i(new _g.$1t(r));i.set_$1N(u);i.set_$6K(!1);i.set_$50(0);t.val=this.$Cz.$5A3(i,n);return!!t.val}};_d.$12h=function(n,t,i,r){_d.$12h.initializeBase(this,[n,t,i,r])};_d.$12h.prototype={get_$Wl:function(){return"AddFileAttachment"},get_$6Qa:function(){return 3},$AAL:function(){var n=this.$z.uri;var t=this.$z.name;if(_js.$8.$a(n)||_js.$8.$a(t)){_js.Trace.logError(_a.$0.$5l,"AddFileAttachment got null or empty uri or name");return!1}else if(n.length>2048||t.length>255){_js.Trace.logError(_a.$0.$5l,"AddFileAttachment got too long uri or name");return!1}else return!0},$A9m:function(n,t){var i=this.$z.uri;var r=this.$z.name;t.val=this.$Cz.$59u(i,r,n);return!!t.val}};_d.$uo=function(n,t,i,r){_d.$uo.initializeBase(this,[t,i]);this.$Cz=n;this.$3mg=r};_d.$uo.prototype={$Cz:null,$3mg:!1,get_$Wl:function(){return this.$3mg?"SetRecipients":"AddRecipients"},get_$6Qa:function(){return 3},$A9q:function(n,t){t.val=new(_0365f.$n.$$(_g.$1q));if($5(n)||!n.length)return!0;for(var o=n.length,u=0;u<o;u++){var e=n[u];var f=e.address;var r=e.name;if(!r&&!f){_js.Trace.logError(_a.$0.$5l,"Add/SetRecipientsAsync null for both displayName and address");$q3(this);return!1}if(r&&r.length>255){_js.Trace.logError(_a.$0.$5l,"Add/SetRecipientsAsync got displayName lengths over the limit");$q3(this);return!1}if(_a.$3q.$WP(f)){var i=new _g.$1q;i.EmailAddress=f;i.Name=r;i.MailboxType="OneOff";i.RoutingType="SMTP";t.val.$D(i)}}if(t.val.get_$C()>0)return!0;else{$q2(this,9013,null);return!1}},$7wW:function(){var t=this.$z.recipientField;var i=this.$z.recipientArray;var n;if(i.length>100){_js.Trace.logError(_a.$0.$5l,"Add/SetRecipientsAsync got more recipients in the list than the limit.");$q3(this);return}var r,u;if(u=this.$A9q(i,r={val:n}),n=r.val,u){if(this.$3mg)this.$Cz.$9xA(t,n);else if(!this.$Cz.$A9h(t,n)){$q2(this,9012,null);return}$hv(this,null,null)}}};_d.$3s=function(n,t){this.$z=n;this.$2AE=t};function $hv(n,t,i){n.$2AE(_d.$2f.$7oE(t));_a.$6.$19(n.$GH,n.get_$Wl(),"",i);_a.$6.endPT(n.get_$Wl())}function $q2(n,t,i){n.$2AE(_d.$2f.$7lV(t));_a.$6.$19(n.$GH,n.get_$Wl(),_d.$RI.$8TS(t),i);_a.$6.endPT(n.get_$Wl())}function $2kb(n,t,i){n.$2AE(t);_a.$6.$19(n.$GH,n.get_$Wl(),"",i);_a.$6.endPT(n.get_$Wl())}function $6y5(n,t,i,r){n.$2AE(t);_a.$6.$19(n.$GH,n.get_$Wl(),i,r);_a.$6.endPT(n.get_$Wl())}function $q3(n){n.$2AE(null);_a.$6.$19(n.$GH,n.get_$Wl(),"NonAPI",null);_a.$6.endPT(n.get_$Wl())}function $6y4(n,t){return t===2?!0:n.get_$6Qa()===2?!1:t>=n.get_$6Qa()}_d.$3s.prototype={$z:null,$2AE:null,$GH:null,$s:function(n){if(!$6y4(this,n)){_js.Trace.logError(_a.$0.$5l,String.format("API call failing due to insufficient permission {0}",this.get_$Wl()));$q3(this);return}_a.$6.stPT(_a.$0.$5l,this.get_$Wl(),5);this.$GH=_a.$6.$1X(_a.$0.$5l,this.get_$Wl(),!0);this.$7wW()}};_d.$13h=function(n,t,i,r){_d.$13h.initializeBase(this,[n,t,i,r])};_d.$13h.prototype={get_$Wl:function(){return"BodySetSelectedData"},get_$6Qa:function(){return 3},$33k:function(n){this.$Cz.$8HK(n);$hv(this,null,null)}};_d.$13g=function(n,t,i,r){_d.$13g.initializeBase(this,[n,t,i,r])};_d.$13g.prototype={get_$Wl:function(){return"BodyPrepend"},get_$6Qa:function(){return 3},$33k:function(n){this.$Cz.$9ig(n);$hv(this,null,null)}};_d.$k1=function(){};_d.$X6=function(){};_d.$16D=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y){this.$$d_$9wY=Function.createDelegate(this,this.$9wY);this.$$d_$856=Function.createDelegate(this,this.$856);this.$$d_$9xg=Function.createDelegate(this,this.$9xg);this.$$d_$88i=Function.createDelegate(this,this.$88i);_d.$16D.initializeBase(this,[n,t,i,r,u,f,e,o,s,h,c,l,a,v,y]);this.$fl=n};_d.$16D.prototype={$fl:null,$7ZC:function(n,t){n.itemType=5;var i=this;_d.$1MC.prototype.$7ZC.call(this,n,function(){t()})},$3gr:function(n){n.$6S([_d.$5E.$E("GetTimeAsync",this.$$d_$88i),_d.$5E.$E("SetTimeAsync",this.$$d_$9xg),_d.$5E.$E("GetLocationAsync",this.$$d_$856),_d.$5E.$E("SetLocationAsync",this.$$d_$9wY)]);_d.$1MC.prototype.$3gr.call(this,n)},$88i:function(n,t){new _d.$17y(this.$fl,n,t).$s(this.$By.$6m.RequestedCapabilities)},$9xg:function(n,t){new _d.$1Ej(this.$fl,n,t).$s(this.$By.$6m.RequestedCapabilities)},$9wY:function(n,t){new _d.$1EV(this.$fl,n,t).$s(this.$By.$6m.RequestedCapabilities)},$856:function(n,t){new _d.$17L(this.$fl,n,t).$s(this.$By.$6m.RequestedCapabilities)}};_d.$pd=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w){_d.$pd.initializeBase(this,[n,t,i,r,u,!1,f,e,o,s,h,c,l,a,v,y,p,w])};function $71E(n,t,i){if(!n.get_$1Po()){_d.$6N.$1rP(i,"to",t.get_$7G(),t.get_$FX());_d.$6N.$1rP(i,"cc",t.get_$8D(),null);_d.$6N.$1rP(i,"resources",t.get_$9F(),null);t.get_$FX()&&_d.$6N.$3hC(i,"organizer",t.get_$FX())}t.get_$4g()&&(i.location=t.get_$4g().get_$1o());t.get_$y()&&(i.start=t.get_$y().$xs().getTime());t.get_$20()&&(i.end=t.get_$20().$xs().getTime())}_d.$pd.prototype={$7ZC:function(n,t){var i=this.$P.get_$7n()?this.$P.get_$7n().toLowerCase():"";if(_d.$Mb.$5h2(i)){n.itemType=2;var r=this.$P;$71E(this,r,n)}var u=this;_d.$6N.prototype.$7ZC.call(this,n,function(){t()})}};_d.$1MC=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y){this.$$d_$81w=Function.createDelegate(this,this.$81w);this.$$d_$5Sd=Function.createDelegate(this,this.$5Sd);this.$$d_$5Sb=Function.createDelegate(this,this.$5Sb);this.$$d_$9ih=Function.createDelegate(this,this.$9ih);this.$$d_$9xQ=Function.createDelegate(this,this.$9xQ);this.$$d_$9xY=Function.createDelegate(this,this.$9xY);this.$$d_$88J=Function.createDelegate(this,this.$88J);this.$$d_$9xB=Function.createDelegate(this,this.$9xB);this.$$d_$7Yk=Function.createDelegate(this,this.$7Yk);this.$$d_$86x=Function.createDelegate(this,this.$86x);this.$$d_$18c=Function.createDelegate(this,this.$18c);this.$$d_$59u=Function.createDelegate(this,this.$59u);this.$$d_$5A3=Function.createDelegate(this,this.$5A3);_d.$1MC.initializeBase(this,[t,i,r,u,f,e,o,s,h,c,l,a,v,y]);this.$Cz=n};_d.$1MC.prototype={$Cz:null,$1M1:null,get_$3jD:function(){this.$1M1||(this.$1M1=new(_d.$cS.$$(_y.$du))(this.$By.$6m.Id));return this.$1M1},$5A3:function(n,t){new _d.$12j(this.$Cz,this.get_$3jD(),n,t).$s(this.$By.$6m.RequestedCapabilities)},$59u:function(n,t){new _d.$12h(this.$Cz,this.get_$3jD(),n,t).$s(this.$By.$6m.RequestedCapabilities)},$18c:function(n,t){new _d.$1DQ(this.get_$3jD(),n,t).$s(this.$By.$6m.RequestedCapabilities)},$86x:function(n,t){new _d.$q5(this.$Cz,n,t).$s(this.$By.$6m.RequestedCapabilities)},$9xB:function(n,t){new _d.$uo(this.$Cz,n,t,!0).$s(this.$By.$6m.RequestedCapabilities)},$7Yk:function(n,t){new _d.$uo(this.$Cz,n,t,!1).$s(this.$By.$6m.RequestedCapabilities)},$88J:function(n,t){new _d.$17u(this.$Cz,n,t).$s(this.$By.$6m.RequestedCapabilities)},$9xY:function(n,t){new _d.$1Eg(this.$Cz,n,t).$s(this.$By.$6m.RequestedCapabilities)},$9xQ:function(n,t){new _d.$13h(this.$Cz,n,t,this.$k).$s(this.$By.$6m.RequestedCapabilities)},$9ih:function(n,t){new _d.$13g(this.$Cz,n,t,this.$k).$s(this.$By.$6m.RequestedCapabilities)},$81w:function(n,t){new _d.$16r(this.$Cz,n,t).$s(this.$By.$6m.RequestedCapabilities)},$7ZC:function(n,t){t()},$3gr:function(n){_d.$2f.prototype.$3gr.call(this,n);n.$6S([_d.$5E.$E("AddItemAttachmentAsync",this.$$d_$5A3),_d.$5E.$E("AddFileAttachmentAsync",this.$$d_$59u),_d.$5E.$E("RemoveAttachmentAsync",this.$$d_$18c),_d.$5E.$E("GetRecipientsAsync",this.$$d_$86x),_d.$5E.$E("AddRecipientsAsync",this.$$d_$7Yk),_d.$5E.$E("SetRecipientsAsync",this.$$d_$9xB),_d.$5E.$E("GetSubjectAsync",this.$$d_$88J),_d.$5E.$E("SetSubjectAsync",this.$$d_$9xY),_d.$5E.$E("BodySetSelectedDataAsync",this.$$d_$9xQ),_d.$5E.$E("BodyPrependAsync",this.$$d_$9ih),_d.$5E.$E("LoadCustomProperties",this.$$d_$5Sb),_d.$5E.$E("SaveCustomProperties",this.$$d_$5Sd),_d.$5E.$E("GetBodyTypeAsync",this.$$d_$81w)])},$5Sd:function(n,t){new _d.$VP(this.$Cz,n,this.$By.$6m.Id,t).$s(this.$By.$6m.RequestedCapabilities)},$5Sb:function(n,t){new _d.$1Ab(this.$Cz,n,this.$By.$6m.Id,this.$k,t).$s(this.$By.$6m.RequestedCapabilities)}};_d.$2f=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v){this.$$d_$8QV=Function.createDelegate(this,this.$8QV);this.$$d_$7wb=Function.createDelegate(this,this.$7wb);this.$$d_$7wa=Function.createDelegate(this,this.$7wa);this.$$d_$7wc=Function.createDelegate(this,this.$7wc);this.$$d_$7wk=Function.createDelegate(this,this.$7wk);this.$$d_$A94=Function.createDelegate(this,this.$A94);this.$$d_$9lq=Function.createDelegate(this,this.$9lq);this.$$d_$9lo=Function.createDelegate(this,this.$9lo);this.$$d_$7ws=Function.createDelegate(this,this.$7ws);this.$$d_$7wh=Function.createDelegate(this,this.$7wh);this.$$d_$84Y=Function.createDelegate(this,this.$84Y);this.$$d_$9Rv=Function.createDelegate(this,this.$9Rv);_a.$3.$m(a,"nativeBridge");this.$B=n;this.$11h=t;this.$1XK=i;this.$Zm=r;this.$VZ=u;this.$Ev=f;this.$LG=e;this.$IX=o;this.$7A=s;this.$Nf=h;this.$yu=c;this.$c=a;this.$k=v;this.$4q=_a.$74.$E()};_d.$2f.$5Yo=function(n){switch(n){case"Mouse":return"ThreeColumns";case"TouchNarrow":return"OneColumn";case"TouchWide":return"TwoColumns"}return null};_d.$2f.$7oE=function(n){return{error:0,data:n}};_d.$2f.$7lV=function(n){return{error:1,errorCode:n}};function $121(n,t,i,r){if(t>i){_js.Trace.logWarning(_a.$0.$5l,"{0} in ext host: Extension '{1}' exceeded limit of {2}, actual is {3}.",r,n.$By.$6m.DisplayName,i,t);return!0}return!1}function $1q6(n,t,i){if(n.$4RL<3){var r=t.val;var u=this;t.val=function(t){$71F(n);r(t)};n.$4RL++;return!0}t.val(i);return!1}function $71F(n){n.$4RL--}function $4qj(n,t,i){var r="";_c.$DJ.get_$I().$3nc(t)&&(r=_c.$DJ.get_$I().$893(t).TokenValue);i({wasSuccessful:!0,token:r})}function $4qg(n,t,i,r){for(var e=new(_0365f.$n.$$(String)),u=0;u<n.$Xt.Extensions.length;u++){var o=n.$Xt.Extensions[u];(t==="CallerIdentity"&&o.RequestedCapabilities>=1||t==="ExtensionCallback"&&o.RequestedCapabilities===2)&&e.$D(n.$Xt.Extensions[u].Id)}var f=new _c.$xF(e.$6W(),t);f.add_$29(i);f.add_$21(r);n.$k.$11(f)}function $4qi(n,t,i,r){var e=i;var o=e.body;var f="";if(_c.$DJ.get_$I().$3na(t.Id)){f=_c.$DJ.get_$I().$83i(t.Id).TokenValue;var u=new _c.$wq(o,f,t.Id);var s=this;u.add_$29(function(t){r({wasProxySuccessful:u.get_$hJ().WasProxySuccessful,errorMessage:u.get_$hJ().ErrorMessage,statusCode:u.get_$hJ().StatusCode,statusDescription:u.get_$hJ().StatusDescription,body:u.get_$hJ().Body});n.$LP(n.$1by,"ExecuteEwsRequest","",u)});var h=this;u.add_$21(function(t){r({wasProxySuccessful:!1,errorMessage:u.$1d.message,statusCode:500,statusDescription:u.$1d.message,body:null});n.$LP(n.$1by,"ExecuteEwsRequest",u.$1d.message,u)});n.$k.$11(u)}else r({wasProxySuccessful:!0,errorMessage:null,statusCode:200,statusDescription:"",body:""})}function $71G(n,t){var i=new _d.$Wc;if("requiredAttendees"in t){i.set_$7G(new _js.$c);var r=t.requiredAttendees;if($121(n,r.length,100,"ExecuteDisplayNewAppointmentForm.requiredAttendees"))return null;for(var u=0;u<r.length;u++)i.get_$7G().$D(_g.$3i.$5Vf(r[u]))}if("optionalAttendees"in t){i.set_$8D(new _js.$c);var f=t.optionalAttendees;if($121(n,f.length,100,"ExecuteDisplayNewAppointmentForm.optionalAttendees"))return null;for(var e=0;e<f.length;e++)i.get_$8D().$D(_g.$3i.$5Vf(f[e]))}if("start"in t&&!$5(t.start)){var a=t.start;var v=new Date(a);i.set_$y(_a.$7.$5Vc(v))}else{var y=_a.$2F.$3oa(_a.$7.get_$2F());i.set_$y(y)}if("end"in t){var p=t.end;var w=new Date(p);i.set_$DE(_a.$7.$5Vc(w).$5u(i.get_$y()))}else i.set_$DE(_d.$k1.$3r7);if("subject"in t){var s=t.subject;if($121(n,s.length,255,"ExecuteDisplayNewAppointmentForm.subject"))return null;i.set_$2i(s)}if("body"in t){var o=t.body;if($121(n,o.length,32768,"ExecuteDisplayNewAppointmentForm.Body"))return null;var h;h=n.$B.get_$L()==="Mouse"?new _g.$6b("HTML",_a.$1d.$3o0(o)):new _g.$6b("Text",o);var b=new _g.$6j(h);i.set_$3M(b)}var c=_g.$3V.$qp();if("location"in t){var l=t.location;if($121(n,l.length,255,"ExecuteDisplayNewAppointmentForm.location"))return null;c.set_$1o(l)}i.set_$4g(c);return i}function $71H(n,t,i){var u=_h.$1L.get_$I();var r=u.$3f(t);if($5(r)||$5(r.get_$3M()))if(!$5(r)&&r.get_$DI())$4qh(n,t,r.get_$gt(),i);else{var e=this;var f=function(r){r.get_$DI()?$4qh(n,t,r.get_$gt(),i):i(r)};$4ql(n,t,_h.$v.get_$48f(),"ItemNormalizedBody",f)}else i(r)}function $4qh(n,t,i,r){var u;u=n.$B.get_$L()==="Mouse"&&i!==1?_h.$v.get_$1gC():_h.$v.get_$2Uv();$4ql(n,t,u,"MailCompose",r)}function $4ql(n,t,i,r,u){var e=new _g.$1t(t);var f=new _h.$py(100,[e],i,r,0,!1);var o=this;f.add_$29(function(n){var i=_h.$1L.get_$I().$3f(t);u(i)});n.$k.$11(f)}function $4qk(n,t){n.$B.$7C(t)}_d.$2f.prototype={$B:null,$11h:null,$1XK:null,$Zm:null,$VZ:null,$Xt:null,$mz:null,$By:null,$4RL:0,$3RH:null,$7A:null,$k:null,$Ev:null,$LG:null,$IX:null,$Nf:null,$yu:null,$3Qv:null,$2yB:!1,$1by:null,$1w6:null,$1w8:null,$1R1:null,$31q:!1,$c:null,$4q:null,get_$1Po:function(){return!this.$By.$6m.RequestedCapabilities},$41:function(n,t,i){this.$By=n;this.$Xt=t;this.$mz=i},$84Y:function(n,t){var u=_a.$6.acsa(_a.$0.$5l,"GetInitialData",!0);var i={};i.permissionLevel=this.$By.$6m.RequestedCapabilities;i.timeZoneOffsets=this.$88l();i.hostVersion=this.$B.get_$2EY();i.owaView=_d.$2f.$5Yo(this.$B.get_$L());i.overrideWindowOpen=this.$c.$5i(this.$c.get_$Hl())&&this.$c.get_$Hl().get_$1Nv().get_$2UB();if(!this.get_$1Po()){i.userDisplayName=this.$Zm;i.userEmailAddress=this.$VZ;i.userTimeZone=this.$1XK;i.ewsUrl=this.$Xt.EwsUrl}var r=this;this.$7ZC(i,function(){_a.$6.acea(u);t(i);r.$2yB=!0;r.$3ty()})},$9mT:function(){if(!this.$31q){if(!this.$1R1){this.$1R1=new(_0365f.$n.$$(_d.$5E));this.$3gr(this.$1R1)}for(var n=0;n<this.$1R1.get_$C();n++){var t=this.$1R1.get_$3o(n);this.$3RH.registerMethod(t.$Ri,t.$dS,0,t.$5E9)}this.$c.$5i(this.$c.get_$Hl())&&this.$c.get_$Hl().get_$1Nv().get_$2UB()&&this.$3RH.unregisterMethod("ContextActivationManager_openWindowInHost");this.$31q=!0}},$AAr:function(){if(this.$31q&&this.$1R1){for(var n=0;n<this.$1R1.get_$C();n++){var t=this.$1R1.get_$3o(n);this.$3RH.unregisterMethod(t.$Ri)}this.$31q=!1}},$7wh:function(n,t){_a.$6.stPT(_a.$0.$5l,"ExecuteEwsRequest",5);this.$1by=_a.$6.$1X(_a.$0.$5l,"ExecuteEwsRequest",!0);var i=this.$By.$6m;if(i.RequestedCapabilities!==2){_js.Trace.logInfo(_a.$0.$5l,"Ext host: Extension '{0}' has insufficient permission for ExecuteEwsRequest",i.DisplayName);t(_d.$2f.$1xB);this.$LP(this.$1by,"ExecuteEwsRequest","Failed",null);return}var s=n;var r=s.body;var u=_c.$DJ.get_$I();if($5(r)||$121(this,r.length,_d.$X6.$3AG,"ExecuteEwsRequest")){t(_d.$2f.$1xB);this.$LP(this.$1by,"ExecuteEwsRequest","Failed",null);return}var f,e;if(!(e=$1q6(this,f={val:t},_d.$2f.$5Cn),t=f.val,e)){this.$LP(this.$1by,"ExecuteEwsRequest",_d.$2f.$12P,null);return}if(!u.$3na(i.Id)||u.$8Ik()){var h=this,o=this;$4qg(this,"ExtensionCallback",function(r){$4qi(h,i,n,t)},function(n){t({wasProxySuccessful:!1});o.$LP(o.$1by,"ExecuteEwsRequest","Failed",n)})}else $4qi(this,i,n,t)},$7ws:function(n,t){_a.$6.stPT(_a.$0.$5l,"ExecuteSaveSettingsRequest",5);this.$1w8=_a.$6.$1X(_a.$0.$5l,"ExecuteSaveSettingsRequest",!0);var u=this.$By;var c=n;var f=c[0];var e=JsonParser.serialize(f);if($121(this,e.length,32768,"ExecuteSaveSettingsRequest")){t({error:1});this.$LP(this.$1w8,"ExecuteSaveSettingsRequest","Failed",null);return}var o,s;if(!(s=$1q6(this,o={val:t},_d.$2f.$5Co),t=o.val,s)){this.$LP(this.$1w8,"ExecuteSaveSettingsRequest",_d.$2f.$12P,null);return}var i=new _c.$114(u.$6m.Id,u.$6m.Version,e);var r=this;i.add_$29(function(n){if(i.get_$hJ().WasSuccessful){u.set_$6di(f);t({error:0});r.$LP(r.$1w8,"ExecuteSaveSettingsRequest","",n)}else{t({errorMessage:i.get_$hJ().ErrorMessage,error:1});r.$LP(r.$1w8,"ExecuteSaveSettingsRequest",i.get_$hJ().ErrorMessage,n)}});var h=this;i.add_$21(function(n){t({errorMessage:i.$1d.message,error:1});h.$LP(h.$1w8,"ExecuteSaveSettingsRequest",i.$1d.message,n)});this.$k.$11(i)},$7wk:function(n,t){_a.$6.stPT(_a.$0.$5l,"ExecuteGetUserIdentityTokenRequest",5);this.$1w6=_a.$6.$1X(_a.$0.$5l,"ExecuteGetUserIdentityTokenRequest",!0);if(this.get_$1Po()){_js.Trace.logInfo(_a.$0.$5l,"Ext host: Extension '{0}' has insufficient permission for ExecuteGetUserIdentityToken",this.$By.$6m.DisplayName);t(_d.$2f.$1xB);this.$LP(this.$1w6,"ExecuteGetUserIdentityTokenRequest","InsufficientPermission",null);return}var u=_c.$DJ.get_$I();var i=this.$By.$6m.Id;if(!u.$3nc(i)||u.$8Io()){var f,e;if(!(e=$1q6(this,f={val:t},_d.$2f.$2Hs),t=f.val,e)){this.$LP(this.$1w6,"ExecuteGetUserIdentityTokenRequest",_d.$2f.$12P,null);return}var r=this,o=this;$4qg(this,"CallerIdentity",function(n){$4qj(r,i,t);r.$LP(r.$1w6,"ExecuteGetUserIdentityTokenRequest","",n)},function(n){t({wasSuccessful:!1});o.$LP(o.$1w6,"ExecuteGetUserIdentityTokenRequest","Failed",n)})}else{$4qj(this,i,t);this.$LP(this.$1w6,"ExecuteGetUserIdentityTokenRequest","",null)}},$7wc:function(n,t){var r=n;var i=$71G(this,r);if(!i){t(null);return}if(this.$B.get_$L()==="Mouse"){var u=this.$Ev.$2zO(i);this.$B.$N3(Object.getType(this.$Ev),null,null,_y.$48.get_$iy(),u,!1)}else{var f=this.$Ev.$br(i.$3E,null);$4qk(this,f)}t(null)},$7wa:function(n,t){var u=n;var r=u.itemId;if(_js.$8.$a(r)){t(null);return}var i=new _y.$9S;i.$ZT(new _g.$1t(r));if(this.$B.get_$L()==="Mouse")this.$B.$N3(Object.getType(this.$LG),null,i.$3E,_y.$48.get_$iy(),null,!1);else{var f=this.$LG.$br(i.$3E,null);$4qk(this,f)}t(null)},$7wb:function(n,t){var i=n;$71H(this,i.itemId,this.$$d_$9Rv);t(null)},$8QV:function(n,t){if(this.$c.$5i(this.$c.get_$Hl())){var i=n.launchUrl;i&&this.$c.get_$Hl().$22F(i)}t(null)},$9lo:function(n,t){var r=n;if(this.$By.$6m.Origin===3){var i=new _d.$16H(this.$By.$6m.DisplayName.replace(_d.$2f.$1pS,""));i.$4Te(r);i.$11()}t(null)},$9lq:function(n,t){var i=n;if(this.$By.$6m.Origin!==3){t(null);return}var r=_a.$0.$5l;var u="[{0}] {1}";var f=this.$By.$6m.DisplayName.replace(_d.$2f.$1pS,"");switch(i.TraceLevel){case"Warning":_js.Trace.logWarning(r,u,f,i.Message);break;case"Error":_js.Trace.logError(r,u,f,i.Message);break;default:break}t(null)},$A94:function(n,t){var i=n;if(this.$By.$6m.Origin!==3){t(null);return}var r=this.$By.$6m.DisplayName.replace(_d.$2f.$1pS,"")+"."+i.Name.replace(_d.$2f.$1pS,"");var u=i.Event;switch(u){case"Start":_a.$6.$1X(_a.$0.$5l,r);break;case"End":_a.$6.$19(null,r);break;default:break}t(null)},$9xS:function(n){this.$3RH=n},$88l:function(){return this.$11h.$2Ou(this.$1XK)},$A3r:function(){this.$2yB=!1;_a.$6.stPT(_a.$0.$5l,"AppSelection",5);this.$3Qv=_a.$6.$1X(_a.$0.$5l,"AppSelection",!0)},$3ty:function(){if(this.$3Qv){var i;var n=this.$4q.$3f("ExtAppVistedUrls");var r=this.$By.$2xh.toLowerCase();i=n?-1!==n.indexOf(r)?1:2:0;if(i!==1&&this.$2yB){!n||n.length>5e3?n=r:n+=r;this.$4q.$DQ("ExtAppVistedUrls",n)}var t=new _a.$6I;t.$5I("S",i);t.$6w("Id",this.$By.$6m.Id);t.$6w("Name",this.$By.$6m.DisplayName);var u=t.toString();var f=this.$2yB?"":"Failed";_a.$6.$19(this.$3Qv,"AppSelection",f,null,u);_a.$6.endPT("AppSelection");this.$3Qv=null}},$LP:function(n,t,i,r){i||(i="");var u=null;r&&(_c.$wq.isInstanceOfType(r)&&r.$5w?u=r.$5w.correlationId:_c.$114.isInstanceOfType(r)&&r.$5w?u=r.$5w.correlationId:_c.$rW.isInstanceOfType(r)&&r.$5w?u=r.$5w.correlationId:_c.$113.isInstanceOfType(r)&&r.$5w?u=r.$5w.correlationId:_c.$xF.isInstanceOfType(r)&&r.$5w?u=r.$5w.correlationId:_c.$q6.isInstanceOfType(r)&&r.$5w&&(u=r.$5w.correlationId));n?_a.$6.$19(n,t,i,u):_a.$6.$19(null,t,i,u);_a.$6.endPT(t)},$3gr:function(n){n.$6S([_d.$5E.$7kO("GetInitialData",this.$$d_$84Y),_d.$5E.$E("EwsRequest",this.$$d_$7wh),_d.$5E.$E("saveSettingsAsync",this.$$d_$7ws),_d.$5E.$E("RecordDataPoint",this.$$d_$9lo),_d.$5E.$E("RecordTrace",this.$$d_$9lq),_d.$5E.$E("TrackCtq",this.$$d_$A94),_d.$5E.$E("GetUserIdentityToken",this.$$d_$7wk),_d.$5E.$E("DisplayNewAppointmentForm",this.$$d_$7wc),_d.$5E.$E("DisplayExistingAppointmentForm",this.$$d_$7wa),_d.$5E.$E("DisplayExistingMessageForm",this.$$d_$7wb),_d.$5E.$E("LaunchPalUrl",this.$$d_$8QV)])},$9Rv:function(n){if(n.get_$DI()){var t=this.$7A.$Fx(!0,!1);t.$42T(n);var r=this;this.$B.$N3(IMailComposeViewModelFactory,function(){return r.$IX},null,_y.$48.get_$iy(),t,!1)}else{var i=this.$Nf.$E(!1);i.set_$3o(n);var u=this;this.$B.$N3(_y.$Gw,function(){return u.$yu},null,_y.$48.get_$iy(),i,!1)}}};_d.$pe=function(n,t,i,r,u,f,e,o,s,h,c,l,a){this.$11h=n;this.$Zm=t;this.$VZ=i;this.$1XK=r;this.$B=u;this.$Nf=f;this.$yu=e;this.$7A=o;this.$1FL=s;this.$1A=h;this.$c=c;this.$k=l;this.$1H=a};_d.$pe.prototype={$11h:null,$Zm:null,$VZ:null,$1XK:null,$B:null,$7A:null,$1FL:null,$Nf:null,$yu:null,$1H:null,$LG:null,$IX:null,$Ev:null,$1A:null,$c:null,$k:null,$3p0:function(n,t){return new _d.$Tl(this.$B,this.$11h,this.$1XK,this.$Zm,this.$VZ,t,this.$Ev,this.$LG,this.$IX,this.$7A,this.$1FL,this.$Nf,this.$yu,n,this.$1A,this.$c,this.$k,this.$1H)},$5Kj:function(n){return new _d.$pd(this.$B,this.$11h,this.$1XK,this.$Zm,this.$VZ,this.$Ev,this.$LG,this.$IX,this.$7A,this.$1FL,this.$Nf,this.$yu,n,this.$1A,this.$c,this.$k,this.$1H)},$5Lc:function(n){return new _d.$16G(n,this.$B,this.$11h,this.$1XK,this.$Zm,this.$VZ,this.$Ev,this.$LG,this.$IX,this.$7A,this.$Nf,this.$yu,this.$1A,this.$c,this.$k)},$5Kh:function(n){return new _d.$16D(n,this.$B,this.$11h,this.$1XK,this.$Zm,this.$VZ,this.$Ev,this.$LG,this.$IX,this.$7A,this.$Nf,this.$yu,this.$1A,this.$c,this.$k)}};_d.$16G=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y){_d.$16G.initializeBase(this,[n,t,i,r,u,f,e,o,s,h,c,l,a,v,y]);this.$5Sz=n};_d.$16G.prototype={$5Sz:null,$7ZC:function(n,t){n.itemType=4;n.conversationId=this.$5Sz.$3xO();var i=this;_d.$1MC.prototype.$7ZC.call(this,n,function(){t()})}};_d.$Tl=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b){_d.$Tl.initializeBase(this,[n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b])};function $4qn(n,t){var i=n.$P;if(!n.get_$1Po()){_d.$6N.$3hC(t,"from",i.get_$3U());_d.$6N.$3hC(t,"sender",i.get_$8m());_d.$6N.$5A2(t,"to",i.get_$4Z());_d.$6N.$5A2(t,"cc",i.get_$4l())}t.conversationId=i.get_$3S()?i.get_$3S().Id:null;t.internetMessageId=i.get_$9z()}function $71I(n,t){var i=n.$P;if(!n.get_$1Po()){_d.$6N.$1rP(t,"to",i.get_$Kh().get_$7G(),i.get_$Kh().get_$FX());_d.$6N.$1rP(t,"cc",i.get_$Kh().get_$8D(),null);_d.$6N.$1rP(t,"resources",i.get_$Kh().get_$9F(),null)}i.get_$Kh().get_$4g()&&(t.location=i.get_$Kh().get_$4g().get_$1o());i.get_$Kh().get_$y()&&(t.start=i.get_$Kh().get_$y().$xs().getTime());i.get_$Kh().get_$20()&&(t.end=i.get_$Kh().get_$20().$xs().getTime())}_d.$Tl.prototype={$7ZC:function(n,t){var i=this.$P.get_$7n()?this.$P.get_$7n().toLowerCase():"";if(_g.$CY.isInstanceOfType(this.$P)&&_d.$Mb.$46I(i)){n.itemType=3;var r=this.$P;$4qn(this,n);$71I(this,n)}else if(_d.$Mb.$46I(i)){n.itemType=1;$4qn(this,n)}var u=this;_d.$6N.prototype.$7ZC.call(this,n,function(){t()})}};_d.$cS=function(n){this.$2aI={};this.$5Dn=n};_d.$cS.$$=function(n){var t="$cS"+"$1"+"$"+n.getName().replace(/\./g,"_");if(!_d[t]){var r=_d[t]=function(){(this.$$gta=this.$$gta||{})["_d.$cS"]={T:n};for(var i=[],t=0;t<arguments.length;++t)i[t]=arguments[t];_d.$cS.apply(this,i)};r.registerClass("_d."+t);var u=_d.$cS.prototype;for(var f in u){var i={key:f,value:u[f]};"constructor"!==i.key&&(r.prototype[i.key]=i.value)}}return _d[t]};_d.$cS.prototype={$yA:0,$5Dn:null,$D:function(n){var t=this.$5Dn+(new Date).getTime().toString()+this.$yA.toString();this.$2aI[t]=n;this.$yA++;return t},$AI8:function(n,t){this.$2aI[n]=t;return n},$AI9:function(n,t){var i=this.$2aI[n];t&&delete this.$2aI[n];return i}};_d.$6N=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b){this.$$d_$7wd=Function.createDelegate(this,this.$7wd);this.$$d_$7we=Function.createDelegate(this,this.$7we);this.$$d_$5Sd=Function.createDelegate(this,this.$5Sd);this.$$d_$5Sb=Function.createDelegate(this,this.$5Sb);this.$$d_$7wj=Function.createDelegate(this,this.$7wj);_d.$6N.initializeBase(this,[n,t,i,r,u,e,o,s,h,l,a,y,p,w]);this.$na=f;this.$P=v;this.$1H=b;this.$1FL=c};_d.$6N.$3hC=function(n,t,i){$5(i)||(n[t]=_d.$6N.$5Lw(i.Mailbox))};_d.$6N.$5A2=function(n,t,i){if(!$5(i)&&i.get_$C()>0){for(var u=[],r=0;r<i.get_$C()&&r<100;r++){var f=i.get_$3o(r);$5(f)||(u[r]=_d.$6N.$5Lw(f))}n[t]=u}};_d.$6N.$1rP=function(n,t,i,r){var u=null;var e=0;var s=!1;if(r&&r.Mailbox){s=!0;u=new Array(0);u[e++]=_d.$6N.$5Ke(r.Mailbox,"Organizer")}if(!$5(i)&&i.get_$C()>0){u||(u=new Array(0));for(var o=0;o<i.get_$C()&&e<100;o++){var f=i.get_$3o(o);if(f&&f.get_$6u()){if(s&&r.Mailbox.EmailAddress&&f.get_$6u().EmailAddress&&f.get_$6u().EmailAddress.toLowerCase()===r.Mailbox.EmailAddress.toLowerCase())continue;u[e++]=_d.$6N.$5Ke(f.get_$6u(),f.get_$Th())}}}n[t]=u};_d.$6N.$5Lw=function(n){var t={};t.name=n.Name;t.address=n.EmailAddress;t.recipientType=_d.$6N.$4B6(n.MailboxType);return t};_d.$6N.$4B6=function(n){switch(n){case"PublicDL":case"PrivateDL":case"PublicFolder":return 1;case"Mailbox":case"Contact":return 2;case"OneOff":return 3;default:return 0}};_d.$6N.$7YD=function(n,t){if(!$5(t)&&t.get_$C()>0){for(var f=[],u=0;u<t.get_$C();u++){var i=t.get_$3o(u);var r={};if(i){r.id=i.get_$3l().Id;r.name=i.get_$1N();r.contentType=i.get_$Bw();r.size=i.get_$50();r.attachmentType=_g.$5d.isInstanceOfType(i)?0:1;r.isInline=i.get_$6K();f[u]=r}}n.attachments=f}};_d.$6N.$5Ke=function(n,t){var r={};r.name=n.Name;r.address=n.EmailAddress;r.recipientType=_d.$6N.$4B6(n.MailboxType);var i=0;switch(t){case"Organizer":i=1;break;case"Tentative":i=2;break;case"Accept":i=3;break;case"Decline":i=4;break;case"NoResponseReceived":i=5;break}r.appointmentResponse=i;return r};function $71N(n){if(n.$P.get_$142())return!1;var t=n.$P.get_$3N5();return t?t.ExtractedAddresses||t.ExtractedContacts||t.ExtractedEmails||t.ExtractedMeetings||t.ExtractedPhones||t.ExtractedTasks||t.ExtractedUrls:!1}function $71Q(n,t,i){var r=new _c.$xI(n.$P);var u=this;r.add_$29(function(r){n.$3h0(t);i()});var f=this;r.add_$21(function(u){_js.Trace.logWarning(_a.$0.$5l,"GetItem to fetch entities failed "+r.$1d);n.$3h0(t);i()});OwaApplication.$1W.$11(r)}function $71M(n,t){var i={};i.Addresses=_d.$5v.$1Oo(t.Addresses,3,n.$na);i.Urls=_d.$5v.$1Oo(t.Urls,4,n.$na);i.PhoneNumbers=_d.$5v.$1Oo(t.PhoneNumbers,5,n.$na);if(!n.get_$1Po()){i.Contacts=_d.$5v.$1Oo(t.Contacts,7,n.$na);i.EmailAddresses=_d.$5v.$1Oo(t.EmailAddresses,6,n.$na);i.MeetingSuggestions=_d.$5v.$1Oo(t.MeetingSuggestions,1,n.$na);i.TaskSuggestions=_d.$5v.$1Oo(t.TaskSuggestions,2,n.$na)}return i}function $4qp(n,t,i){var r=n.$7A.$Fx(!0,!1);r.set_$3w(t);r.$yB(n.$P);var e=r.$1NF(!0);var u;if(t===1)u=new _g.$mU;else if(t===2)u=new _g.$mT;else return;u.$2j5(e.get_$5y());u.set_$1TE(new _g.$6j(new _g.$6b("HTML",i)));u.set_$2dD(n.$P.get_$i());r.$5eu(u);var f=n.$1FL.$3pS(r,u,n.$1H);f.$GB=0;var o=this;f.add_$29(function(n){_js.Trace.logInfo(_a.$0.$5l,"Create response action succeeded");var t=n;if(t.$5H===r.get_$7t()){r.$AG();r.set_$66(0);r.set_$3w(4);r.set_$9x(t.$5S);var i=new _y.$CW;i.$TO(r)}});OwaApplication.$1W.$11(f)}function $71O(n){return n.$P?_g.$2o.isInstanceOfType(n.$P)?n.$P.get_$iP():!0:!1}function $71P(n){return n.$P?_g.$2o.isInstanceOfType(n.$P)?n.$P.get_$fJ():!0:!1}function $71R(n,t,i){var r="";i&&_c.$q6.isInstanceOfType(i)&&i.$VW&&(r=i.$VW.TokenValue);t({wasSuccessful:!0,token:r})}_d.$6N.prototype={$na:!1,$1H:null,$1FL:null,$P:null,$7ZC:function(n,t){if($71N(this))$71Q(this,n,t);else{this.$3h0(n);t()}},$3gr:function(n){_d.$2f.prototype.$3gr.call(this,n);n.$6S([_d.$5E.$E("GetCallbackToken",this.$$d_$7wj),_d.$5E.$E("LoadCustomProperties",this.$$d_$5Sb),_d.$5E.$E("SaveCustomProperties",this.$$d_$5Sd),_d.$5E.$E("DisplayReplyForm",this.$$d_$7we),_d.$5E.$E("DisplayReplyAllForm",this.$$d_$7wd)])},$7wj:function(n,t){_a.$6.stPT(_a.$0.$5l,"ExecuteGetCallbackTokenRequest",5);var i=_a.$6.$1X(_a.$0.$5l,"ExecuteGetCallbackTokenRequest",!0);if(this.get_$1Po()){_js.Trace.logInfo(_a.$0.$5l,"Ext host: Extension '{0}' has insufficient permission for ExecuteGetCallbackToken",this.$By.$6m.DisplayName);t(_d.$2f.$1xB);this.$LP(i,"ExecuteGetCallbackTokenRequest","InsufficientPermission",null);return}var u,f;if(!(f=$1q6(this,u={val:t},_d.$2f.$2Hs),t=u.val,f)){this.$LP(i,"ExecuteGetCallbackTokenRequest",_d.$2f.$12P,null);return}var r=new _c.$q6(this.$By.$6m.Id,String.format("ParentItemId:{0}",this.$P.get_$i().Id));var e=this;r.add_$29(function(n){$71R(e,t,n);e.$LP(i,"ExecuteGetCallbackTokenRequest","",n)});var o=this;r.add_$21(function(n){t({wasSuccessful:!1});o.$LP(i,"ExecuteGetCallbackTokenRequest","Failed",n)});OwaApplication.$1W.$11(r)},$5Sb:function(n,t){_a.$6.stPT(_a.$0.$5l,"ExecuteLoadCustomPropRequest",5);var r=_a.$6.$1X(_a.$0.$5l,"ExecuteLoadCustomPropRequest",!0);var s=n;var i=new _c.$rW(this.$By.$6m.Id,this.$P.get_$i().Id);var u,f;if(!(f=$1q6(this,u={val:t},_d.$2f.$2Hs),t=u.val,f)){this.$LP(r,"ExecuteLoadCustomPropRequest","InsufficientPermission",null);return}var e=this;i.add_$29(function(n){t({errorMessage:i.get_$hJ().ErrorMessage,wasSuccessful:i.get_$hJ().WasSuccessful,customProperties:i.get_$hJ().CustomProperties});e.$LP(r,"ExecuteLoadCustomPropRequest","",n)});var o=this;i.add_$21(function(n){t({errorMessage:i.$1d.message,wasSuccessful:!1,customProperties:null});o.$LP(r,"ExecuteLoadCustomPropRequest",i.$1d.message,n)});OwaApplication.$1W.$11(i)},$5Sd:function(n,t){_a.$6.stPT(_a.$0.$5l,"ExecuteSaveCustomPropRequest",5);var r=_a.$6.$1X(_a.$0.$5l,"ExecuteSaveCustomPropRequest",!0);var o=n;var s=o.customProperties;var u=JsonParser.serialize(s);if($121(this,u.length,2500,"ExecuteSaveCustomPropertiesRequest")){t(_d.$2f.$1xB);this.$LP(r,"ExecuteSaveCustomPropRequest","Failed",null);return}var f,e;if(!(e=$1q6(this,f={val:t},_d.$2f.$2Hs),t=f.val,e)){this.$LP(r,"ExecuteSaveCustomPropRequest",_d.$2f.$12P,null);return}var i=new _c.$113(this.$By.$6m.Id,this.$P.get_$i().Id,u);var h=this;i.add_$29(function(n){t({errorMessage:i.get_$hJ().ErrorMessage,wasSuccessful:i.get_$hJ().WasSuccessful});h.$LP(r,"ExecuteSaveCustomPropRequest","",n)});var c=this;i.add_$21(function(n){t({errorMessage:i.$1d.message,wasSuccessful:!1});c.$LP(r,"ExecuteSaveCustomPropRequest",i.$1d.message,n)});OwaApplication.$1W.$11(i)},$7we:function(n,t){if(!$71P(this)){t(null);return}var i="";var r=n;if(r&&"htmlBody"in r){i=r.htmlBody;if($121(this,i.length,32768,"ExecuteDisplayReplyForm.htmlBody")){t(null);return}}$4qp(this,1,i);t(null)},$7wd:function(n,t){if(!$71O(this)){t(null);return}var i="";var r=n;if(r&&"htmlBody"in r){i=r.htmlBody;if($121(this,i.length,32768,"ExecuteDisplayReplyAllForm.htmlBody")){t(null);return}}$4qp(this,2,i);t(null)},$3h0:function(n){n.id=this.$P.get_$i().Id;n.itemClass=this.$P.get_$7n();this.$P.get_$13P()&&(n.dateTimeCreated=this.$P.get_$13P().$xs().getTime());this.$P.get_$Bh()&&(n.dateTimeModified=this.$P.get_$Bh().$xs().getTime());this.$P.get_$qv()&&(n.dateTimeSent=this.$P.get_$qv().$xs().getTime());$5(this.$P.get_$142())||(n.entities=$71M(this,this.$P.get_$142()));var t=this.$mz.$xW.$838();t&&(n.filteredEntities=t);if(!_d.$2f.prototype.get_$1Po.call(this)){n.subject=this.$P.get_$2i();n.normalizedSubject=this.$P.get_$oc();var i=this.$mz.$2dH;$5(i)||(n.regExMatches=i);_d.$6N.$7YD(n,this.$P.get_$8j())}}};_d.$16r=function(n,t,i){_d.$16r.initializeBase(this,[t,i]);this.$Cz=n};_d.$16r.prototype={$Cz:null,get_$Wl:function(){return"GetBodyType"},get_$6Qa:function(){return 1},$7wW:function(){var t=this.$Cz.$2zf();var n=null;t==="Text"?n="text":t==="HTML"&&(n="html");$hv(this,n,null)}};_d.$17L=function(n,t,i){_d.$17L.initializeBase(this,[t,i]);this.$fl=n};_d.$17L.prototype={$fl:null,get_$Wl:function(){return"GetLocation"},get_$6Qa:function(){return 1},$7wW:function(){var n=this.$fl.$2OX();$hv(this,n,null)}};_d.$q5=function(n,t,i){_d.$q5.initializeBase(this,[t,i]);this.$Cz=n};_d.$q5.$7zu=function(n){var r=[];if(!n)return r;for(var f=n.get_$C()>100?100:n.get_$C(),t=0;t<f;t++){var u=n.get_$3o(t).$CB;var i={};i.recipientType=_d.$6N.$4B6(u.get_$1l().MailboxType);i.address=u.get_$1l().EmailAddress||null;i.name=u.get_$1o();r[t]=i}return r};_d.$q5.prototype={$Cz:null,get_$Wl:function(){return"GetRecipients"},get_$6Qa:function(){return 1},$7wW:function(){var n=this.$z.recipientField;var t=this.$Cz.$86v(n);var i=_d.$q5.$7zu(t);$hv(this,i,null)}};_d.$17u=function(n,t,i){_d.$17u.initializeBase(this,[t,i]);this.$Cz=n};_d.$17u.prototype={$Cz:null,get_$Wl:function(){return"GetSubject"},get_$6Qa:function(){return 1},$7wW:function(){var n=this.$Cz.$14l();$hv(this,n||"",null)}};_d.$17y=function(n,t,i){_d.$17y.initializeBase(this,[t,i]);this.$fl=n};_d.$17y.prototype={$fl:null,get_$Wl:function(){return"GetTime"},get_$6Qa:function(){return 1},$7wW:function(){var n=null;var t=this.$z.TimeProperty;t===1?n=this.$fl.$30n():t===2&&(n=this.$fl.$2zu());$hv(this,n.$xs().getTime(),null)}};_d.$1Ab=function(n,t,i,r,u){this.$$d_$39G=Function.createDelegate(this,this.$39G);this.$$d_$39M=Function.createDelegate(this,this.$39M);_d.$1Ab.initializeBase(this,[t,u]);this.$ix=i;this.$Cz=n;this.$k=r};_d.$1Ab.prototype={$ix:null,$Cz:null,$k:null,get_$Wl:function(){return"ExecuteLoadCustomPropRequestCompose"},get_$6Qa:function(){return 0},$7wW:function(){var n=this.$Cz.$3xd();if(n)for(var t=n.get_$C()-1;t>=0;t--)if(_h.$86.$5hp(n.get_$3o(t),this.$ix)){$2kb(this,{wasSuccessful:!0,customProperties:n.get_$3o(t).get_$1n()},null);return}var r=this.$Cz.$2OW();if(!r){$2kb(this,{wasSuccessful:!0,customProperties:"{}"},null);return}var u=this.$z;var i=new _c.$rW(this.$ix,this.$Cz.$2OW());i.add_$29(this.$$d_$39M);i.add_$21(this.$$d_$39G);this.$k.$11(i)},$39M:function(n){var t=n;var i={wasSuccessful:t.get_$hJ().WasSuccessful,customProperties:t.get_$hJ().CustomProperties};if(!_js.$8.$a(t.get_$hJ().CustomPropertyNames)){var r=this.$Cz.$3xd();_h.$86.$5AP(r,t.get_$hJ().CustomPropertyNames)}$2kb(this,i,n.$5H)},$39G:function(n){_js.Trace.logError(_a.$0.$5l,"custom properties load failed with "+n.$1d);var t={errorMessage:n.$1d.message,wasSuccessful:!1,customProperties:null};$6y5(this,t,n.$1d.message,n.$5H)}};_d.$1DQ=function(n,t,i){this.$$d_$5Oc=Function.createDelegate(this,this.$5Oc);_d.$1DQ.initializeBase(this,[t,i]);this.$1M1=n};_d.$1DQ.prototype={$1M1:null,$1Yn:null,$2Hy:null,get_$Wl:function(){return"RemoveAttachment"},get_$6Qa:function(){return 3},$7wW:function(){this.$2Hy=this.$z.attachmentIndex;if(this.$2Hy.length>200){_js.Trace.logError(_a.$0.$5l,"RemoveFileAttachment got too long attachmentId");$q3(this);return}if(!this.$2Hy){_js.Trace.logError(_a.$0.$5l,"RemoveAttachment got null or empty attachmentIndex");$q3(this);return}this.$1Yn=this.$1M1.$AI9(this.$2Hy,!0);if(!this.$1Yn){$q2(this,9008,null);return}if(this.$1Yn.get_$15M()){$hv(this,null,null);return}this.$1Yn.add_$1Td(this.$$d_$5Oc);this.$1Yn.get_$1Nj().$s()},$5Oc:function(n){this.$1Yn.remove_$1Td(this.$$d_$5Oc);if(n.get_$6OQ()){this.$1M1.$AI8(this.$2Hy,this.$1Yn);$q2(this,9009,null);return}$hv(this,null,null)}};_d.$VP=function(n,t,i,r){_d.$VP.initializeBase(this,[t,r]);this.$ix=i;this.$Cz=n};function $763(n,t,i){t.$D(i);_h.$86.$5AP(t,i.get_$Dj().get_$EN())}_d.$VP.prototype={$ix:null,$Cz:null,get_$Wl:function(){return"ExecuteSaveCustomPropRequestCompose"},get_$6Qa:function(){return 0},$7wW:function(){var f=this.$z;var e=f.customProperties;var i=JsonParser.serialize(e);if(i.length>2500){$q3(this);return}for(var r=_h.$86.$7la(this.$ix,i),n=this.$Cz.$3xd(),u=!1,t=0;t<n.get_$C();t++)if(_h.$86.$5hp(n.get_$3o(t),this.$ix)){n.set_$3o(t,r);u=!0;break}u||$763(this,n,r);this.$Cz.$8TX();$2kb(this,_d.$VP.$5NL,null)}};_d.$mr=function(n,t,i,r){this.$$d_$9rf=Function.createDelegate(this,this.$9rf);this.$$d_$9rg=Function.createDelegate(this,this.$9rg);_d.$mr.initializeBase(this,[t,i]);this.$Cz=n;this.$k=r};function $76Z(n,t){t.val=t.val.trim();t.val.substr(0,5).toLowerCase()==="<div>"&&t.val.substr(t.val.length-6,6).toLowerCase()==="</div>"&&(t.val=t.val.substring(5,t.val.length-6))}function $76a(n,t,i){var r=n.$Cz.$2zf();i.val=t;if(!$5(t)){if(r==="Text"&&i.val===3){$q2(n,2006,null);return!1}return!0}$q3(n);return!1}_d.$mr.prototype={$Cz:null,$k:null,$7wW:function(){var r=this.$z;var n=r.data;if(n.length>1e6){$q3(this);return}var t;var u,f;if(f=$76a(this,r.coercionType,u={val:t}),t=u.val,f)if(t===3)if(_js.$8.$a(n))this.$33k("");else{var i=new _c.$1Dj(n);i.add_$29(this.$$d_$9rg);i.add_$21(this.$$d_$9rf);this.$Cz.$A4a();this.$k.$11(i)}else this.$Cz.$2zf()==="HTML"?this.$33k(_a.$3I.$Ew(n)):this.$33k(n)},$9rf:function(n){_js.Trace.logError(_a.$0.$5l,"Sanitize html failed with "+n.$1d);$q2(this,9011,null)},$9rg:function(n){_js.Trace.logInfo(_a.$0.$5l,"Sanitize html succeeded.");if(this.$Cz.$2zf()==="HTML"){var u=n;var t=u.get_$hJ();var i;$76Z(this,i={val:t});t=i.val;var r=this;this.$Cz.$7gB(function(n){n?$q2(r,9014,null):r.$33k(t)})}else $q2(this,2006,null)}};_d.$1EV=function(n,t,i){_d.$1EV.initializeBase(this,[t,i]);this.$fl=n};_d.$1EV.prototype={$fl:null,get_$Wl:function(){return"SetLocation"},get_$6Qa:function(){return 3},$7wW:function(){var n=this.$z.location;if(n.length>255)$q3(this);else{this.$fl.$9wX(n);$hv(this,null,null)}}};_d.$1Eg=function(n,t,i){_d.$1Eg.initializeBase(this,[t,i]);this.$Cz=n};_d.$1Eg.prototype={$Cz:null,get_$Wl:function(){return"SetSubject"},get_$6Qa:function(){return 3},$7wW:function(){var n=this.$z.subject;if(n.length>255){$q3(this);return}this.$Cz.$9xX(n);$hv(this,null,null)}};_d.$1Ej=function(n,t,i){_d.$1Ej.initializeBase(this,[t,i]);this.$fl=n};_d.$1Ej.prototype={$fl:null,get_$Wl:function(){return"SetTime"},get_$6Qa:function(){return 3},$7wW:function(){var n=this.$z.TimeProperty;var r=this.$z.time;var t=_a.$7.$14U(new Date(r));var i=!0;n===1?this.$fl.$9xV(t):n===2&&(i=this.$fl.$AAC(t));i?$hv(this,null,null):$q2(this,9010,null)}};_d.$5E=function(n,t,i){this.$Ri=n;this.$dS=t;this.$5E9=i};_d.$5E.$E=function(n,t){return new _d.$5E(n,t,!1)};_d.$5E.$7kO=function(n,t){return new _d.$5E(n,t,!0)};_d.$5E.prototype={$Ri:null,$5E9:!1,$dS:null};_d.$12O=function(n,t){this.$2EK=n;this.$1k=t};_d.$12O.prototype={$2EK:null,$1k:null,get_$AEN:function(){return this.$2EK},get_$1N:function(){return this.$1k},get_$50:function(){return 0},get_$3r:function(){return""}};_d.$2q=function(n,t,i,r,u,f,e,o,s,h,c,l,a){this.$$d_$7gO=Function.createDelegate(this,this.$7gO);this.$$d_$9Rr=Function.createDelegate(this,this.$9Rr);this.$$d_$9Qd=Function.createDelegate(this,this.$9Qd);this.$$d_$2OI=Function.createDelegate(this,this.$2OI);this.$$d_$8BF=Function.createDelegate(this,this.$8BF);this.$$d_$9eL=Function.createDelegate(this,this.$9eL);this.$$d_$3KA=Function.createDelegate(this,this.$3KA);_d.$2q.initializeBase(this);this.$FB=n;this.$1c5=u;this.$c=t;this.$1A=i;this.$B=r;this.$Zu=new _js.$c;this.$cG=new _y.$iW;this.$6Os=_d.$2q.$85z(o);this.$1JB=new _d.$wv(this.$$d_$3KA,null);this.$6OF=new _C(this.$$d_$9eL,_a.$0.$5l);this.$4XV=f;this.$1Pu=e;this.$3uM=s;this.$Oa=h;this.$P=c;this.$1r9=l;this.$1Dp=a};_d.$2q.add_$3Jc=function(n){_d.$2q.$1On||(_d.$2q.$1On=new Sys.EventHandlerList);_d.$2q.$1On.addHandler(_d.$2q.$3Jd,n)};_d.$2q.remove_$3Jc=function(n){_d.$2q.$1On&&_d.$2q.$1On.removeHandler(_d.$2q.$3Jd,n)};_d.$2q.$85z=function(n){return n?n.replace("osfruntime_strings.js",""):""};function $71W(n,t){n.$1Dp.$41(t,n.$Xt,t.$mz);n.$1Dp.$9mT()}function $3av(n,t){$4qr(n,t)&&n.$3uM.$9lH(_a.$KO,new _a.$KO(!0,"Extensibility"))}function $3aw(n,t){$4qr(n,t)&&n.$3uM.$9lH(_a.$KO,new _a.$KO(!1,"Extensibility"))}function $4qq(n,t){var i=new OSF.ContextActivationManager({appName:64,appVersion:t,clientMode:1,appUILocale:n.$FB,dataLocale:"",hostControl:n.$1Dp,localizedScriptsUrl:n.$6Os,docUrl:""});var r={frameBorder:"0"};n.$1A.get_$Hp()&&n.$1A.get_$6n()&&(r.sandbox="allow-scripts allow-forms allow-same-origin");i.setIframeAttributeBag(r);return i}function $4qr(n,t){return!n.$1A.get_$35n()&&!n.$1A.get_$45e()?!1:!t||n.$Fg&&!n.$Fg.get_$1wB().Type?!0:!1}function $71X(n){$3(n,"ActiveExtensions")}function $3at(n){n.$1Dp.$AAr()}function $3au(n){if((!_d.$2q.$35S||n.$3S9)&&!n.$1Pu){_a.$6.stPT(_a.$0.$5l,"GetListOfApps",5);n.$1xR=_a.$6.$1X(_a.$0.$5l,"GetListOfApps",!0);_d.$2q.$35S=!0;n.$2OI();if(n.$4XV){n.$1lw=new _d.$1De(3,3e4,n.$$d_$2OI,_a.$0.$5l,"GetExtensibilityContext");n.$1lw.$y()}}}function $71V(n){n.$2JP&&n.$2JP.$3lb()}function $71Z(n){if(!n.$2JP){n.$2JP=new _d.$129("CheckNewApp");$4qs(n)}}function $4qs(n){n.$2JP.$1s(n.$$d_$7gO,5e3,_a.$0.$5l)}function $71Y(n,t){if(_d.$2q.$1On){var i=_d.$2q.$1On.getHandler(_d.$2q.$3Jd);$5(i)||i(t)}}_d.$2q.prototype={$B:null,$1A:null,$1JB:null,$1c5:null,$Oa:null,$FB:null,$6OF:null,$cG:null,$c:null,$6Os:null,$1r9:null,$1Dp:null,$2JP:null,$1lw:null,$Xt:null,$3S9:!1,$17o:null,$2Jx:null,$3ne:null,$3nf:null,$Zu:null,$Fg:null,$P:null,$32I:!0,$3IJ:!0,$233:null,$4XV:!1,$1Pu:!1,$3uM:null,$1xR:null,get_$7hF:function(){switch(this.$B.get_$L()){case"Mouse":return 3;case"TouchNarrow":return 1;case"TouchWide":return 2}return 3},get_$8LP:function(){return this.$Xt?this.$Xt.IsInOrgMarketplaceRole:!1},get_$9f4:function(){return this.$17o},set_$9f4:function(n){this.$17o!==n&&(this.$17o=n);$3(this,"OverflowMenuViewModel");return n},get_$6Or:function(){return this.$2Jx},set_$6Or:function(n){if(this.$2Jx!==n){this.$2Jx=n;$3(this,"OsfContextActivationManager")}return n},get_$1mR:function(){return this.$Fg},set_$1mR:function(n){if(this.$Fg!==n){$5(n)||this.$Oa.$A97(n.get_$1wB().Id);this.$Fg=n;$3(this,"SelectedExtension")}return n},get_$418:function(){return this.$32I},set_$418:function(n){if(this.$32I!==n){this.$32I=n;$3(this,_d.$2q.$5d4)}return n},get_$1j8:function(){return this.$3IJ},set_$1j8:function(n){if(this.$3IJ!==n){this.$3IJ=n;$3(this,_d.$2q.$2a0)}return n},get_$8Ti:function(){return this.$233},set_$8Ti:function(n){this.$233=n;$3(this,_d.$2q.$2VC);return n},$3KA:function(n){n&&this.$Fg===n||this.$1Dp.$3ty();n&&this.$1Dp.$A3r();if(n){var i=!(!n.get_$1wB().Type&&_d.$6N.isInstanceOfType(this.$1Dp));var r=_a.$6.acsa(_a.$0.$5l,"ContextActivationManager",!0);$3av(this,!1);var t;if(i){this.$3nf||(this.$3nf=$4qq(this,"15.01"));t=this.$3nf}else{this.$3ne||(this.$3ne=$4qq(this,"15"));t=this.$3ne}this.$2Jx!==t&&$3at(this);this.set_$6Or(t);$3aw(this,!1);_a.$6.acea(r)}n?$71W(this,n):$3at(this);this.set_$418(this.$7rw(n));this.set_$1mR(n)},$78:function(){_d.$2q.remove_$3Jc(this.$$d_$8BF);this.$1Dp.$3ty();$3at(this);this.set_$1mR(null);this.$17o&&this.$17o.$aD();this.$17o=null;this.set_$418(!0);this.$Zu.$1t();this.set_$1j8(!0);this.$1r9.$AG();$71V(this)},$5m:function(){if(this.$1A.get_$9KX()){this.$Zu.$1t();if(this.$1r9.$9yo())if(_a.$Cs.$5l8()){_a.$Cs.$6XF();_d.$2q.$35S=!1;_d.$2q.add_$3Jc(this.$$d_$8BF);$3au(this)}else if($5(this.$Xt)&&$5(_c.$8n.$n0)){_d.$2q.add_$3Jc(this.$$d_$8BF);$3au(this)}else{$5(this.$Xt)&&!$5(_c.$8n.$n0)&&(this.$Xt=_c.$8n.$n0);this.$59T()}}},$9Qd:function(n){if(this.$4XV&&this.$1lw){this.$1lw.$20();this.$1lw=null}$71Y(this,n);if(this.$1xR){var t=null;_c.$8n.isInstanceOfType(n)&&n.$5w&&(t=n.$5w.correlationId);_a.$6.$19(this.$1xR,"GetListOfApps","",t);_a.$6.endPT("GetListOfApps");this.$1xR=null}},$59T:function(){if(this.$1r9){this.$B.get_$L()==="Mouse"&&this.$Xt.MarketplaceUrl&&this.set_$8Ti(this.$Xt.MarketplaceUrl);if(!$5(this.$Xt.Extensions)&&this.$Xt.Extensions.length){var n=this;this.$1r9.$7w4(this.$Xt.Extensions,function(t){if(n.$1r9){if(t.get_$C()>0){n.$Zu.$6S(t.$6W());$71X(n);n.set_$9f4(new _d.$IJ(n.$Zu,n.$1JB));n.$17o.$aD();n.set_$1j8(!1);$3(n,_d.$2q.$5T2)}else n.set_$1j8(!0);$3(n,_d.$2q.$59Y)}})}}},$9eL:function(){if(this.$233){_a.$6.stPT(_a.$0.$5l,"GetMoreApps",3);var n=_a.$6.$1X(_a.$0.$5l,"GetMoreApps",!0);this.$cG.$TS(this.$233);$71Z(this);_a.$6.$19(n,"GetMoreApps","");_a.$6.endPT("GetMoreApps")}},$2OI:function(){var n=new _c.$8n;n.add_$29(this.$$d_$9Qd);n.add_$21(this.$$d_$9Rr);n.$s(this.get_$7hF(),this.$FB)},$9Rr:function(n){if(this.$1lw&&this.$1lw.$40O&&this.$1xR){var t=null;_c.$8n.isInstanceOfType(n)&&n.$5w&&(t=n.$5w.correlationId);_a.$6.$19(this.$1xR,"GetListOfApps","Failed",t);_a.$6.endPT("GetListOfApps")}},$7gO:function(){if(_a.$Cs.$5l8()){_a.$Cs.$6XF();this.$3S9=!0;$3au(this)}$4qs(this)},$8BF:function(n){_d.$2q.remove_$3Jc(this.$$d_$8BF);if(this.$Xt){if(this.$3S9){this.$3S9=!1;_c.$8n.$38i=n.$3nh}}else{_c.$8n.$38i=n.$3nh;this.$Xt=_c.$8n.$n0;this.$59T()}}};_d.$HQ=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p){this.$$d_$9Qe=Function.createDelegate(this,this.$9Qe);this.$$d_$6MK=Function.createDelegate(this,this.$6MK);this.$$d_$5Ty=Function.createDelegate(this,this.$5Ty);this.$$d_$6Lw=Function.createDelegate(this,this.$6Lw);this.$$d_$9MJ=Function.createDelegate(this,this.$9MJ);this.$$d_$9Sy=Function.createDelegate(this,this.$9Sy);this.$$d_$9zq=Function.createDelegate(this,this.$9zq);_d.$HQ.initializeBase(this,[r,u,f,e,o,s,h,c,l,a,v,y,p]);this.$EV=t;this.set_$3iU(_nbs.NonBootStrings.l_ComposeAppsForOutlook_Text);this.set_$419(!1);this.set_$2Hh(!0);this.$3iT=i;this.$1nA=new _C(this.$$d_$9zq,n);this.$1nA.set_$69(!1);this.$5cv=new _C(this.$$d_$9Sy,n);this.$5Dk=new _C(this.$$d_$9MJ,n)};function $70X(n){n.$Y(_d.$2q.$2a0,n.$$d_$9Qe);n.$Y(_d.$2q.$2VC,n.$$d_$9Qe);n.$Y("ForceHideAppsButton",n.$$d_$9Qe);n.$3ib=!0}function $70Y(n){if(n.$3ib){n.$q(_d.$2q.$2a0,n.$$d_$9Qe);n.$q(_d.$2q.$2VC,n.$$d_$9Qe);n.$q("ForceHideAppsButton",n.$$d_$9Qe);n.$3ib=!1}}function $4qS(n,t){n.$3iT&&n.$3iT(t)}function $4qR(n){return!n.$2z6&&(!n.$3IJ||!!n.$233)}_d.$HQ.prototype={$1R2:null,$2pf:null,$32K:!1,$3iT:null,$2Bz:!1,$2z6:!1,$1YX:!1,$2pe:0,$1nA:null,$5cv:null,$5Dk:null,$3ib:!1,$EV:null,$e3:null,add_$27L:function(n){this.$2G("OnAppsPaneOpened",n)},remove_$27L:function(n){this.$2H("OnAppsPaneOpened",n)},add_$3J1:function(n){this.$2G("OnAppsPaneClosed",n)},remove_$3J1:function(n){this.$2H("OnAppsPaneClosed",n)},add_$27U:function(n){this.$2G("OnExtensionOpened",n)},remove_$27U:function(n){this.$2H("OnExtensionOpened",n)},add_$3J5:function(n){this.$2G("BackToList",n)},remove_$3J5:function(n){this.$2H("BackToList",n)},get_$5V0:function(){return this.$2z6},set_$5V0:function(n){if(this.$2z6!==n){this.$2z6=n;$3(this,"ForceHideAppsButton")}return n},get_$6eq:function(){return this.$2Bz},set_$6eq:function(n){if(this.$2Bz!==n){this.$2Bz=n;$3(this,"ShowAppsButton")}return n},get_$5CF:function(){return this.$2pe},set_$5CF:function(n){if(this.$2pe!==n){this.$2pe=n;$3(this,"AppPaneSize")}return n},get_$2Hh:function(){return this.$1YX},set_$2Hh:function(n){if(this.$1YX!==n){this.$1YX=n;$3(this,"AppPaneIsHidden")}return n},get_$ne:function(){return this.$EV.$PM===1},get_$8Oh:function(){return this.$B.get_$L()==="TouchNarrow"},get_$5oy:function(){return this.$1R2},set_$5oy:function(n){this.$1R2=n;if(n.$Sr===3){var t=this.$1R2.$3uR.get_$1r().extensionViewModel;this.$3KA(t)}return n},get_$3iU:function(){return this.$2pf},set_$3iU:function(n){if(this.$2pf!==n){this.$2pf=n;$3(this,"AppPaneTitle")}return n},get_$419:function(){return this.$32K},set_$419:function(n){if(this.$32K!==n){this.$32K=n;$3(this,"HideExtensionsList")}return n},get_$21a:function(){return this.$B.get_$L()!=="Mouse"},$5m:function(){this.set_$6eq($4qR(this));this.$1nA.set_$69(this.$2Bz);this.set_$2Hh(!0);$70X(this);this.$EV&&this.$EV.$Y("Orientation",this.$$d_$6Lw);_d.$2q.prototype.$5m.call(this)},$78:function(){$70Y(this);this.$EV&&this.$EV.$q("Orientation",this.$$d_$6Lw);_d.$2q.prototype.$78.call(this)},$3KA:function(n){if(n){this.set_$419(!0);this.set_$418(!1);this.set_$3iU(n.get_$1wB().DisplayName);if(this.$c.$5i(this.$c.get_$Hl())){var t=this;this.$c.get_$Hl().$5Rz(n.get_$5S2(),n.get_$1wB().DisplayName,function(){t.$6Xx(n)},this.$$d_$5Ty)}else this.$6Xx(n)}else this.$c.$5i(this.$c.get_$Hl())?this.$c.get_$Hl().$5Sk():this.$5Ty()},$9zq:function(){_a.$6.stPT(_a.$0.$5l,"ShowAppPane",3);var n=_a.$6.$1X(_a.$0.$5l,"ShowAppPane",!0);if(_y.$x.$w.get_$L()==="Mouse"){if(this.$1YX){this.set_$5CF(342);this.set_$2Hh(!1);$4qS(this,1)}}else if(_y.$x.$w.get_$L()!=="TouchNarrow"&&this.$EV.$PM)this.set_$2Hh(!1);else{this.$e3=this.$1c5.$7ko(this,_y.$x.$w.get_$L());this.$e3.set_$6IJ(this.$$d_$6MK);_y.$x.$w.$7C(this.$e3)}$6J(this,"OnAppsPaneOpened");_a.$6.$19(n,"ShowAppPane","");_a.$6.endPT("ShowAppPane")},$6Lw:function(n,t){this.get_$ne()?this.$e3&&this.$e3.$4O():this.$1yP(!1);$6J(this,"OnAppsPaneClosed")},$9Sy:function(){this.$B.get_$L()!=="TouchWide"||this.get_$ne()?this.$1yP(!0):this.$e3&&this.$e3.$4O()},$1yP:function(n){if(!this.$1YX){var t=null;if(n){_a.$6.stPT(_a.$0.$5l,"HideAppPane",3);t=_a.$6.$1X(_a.$0.$5l,"HideAppPane",!0)}this.$3jz(!1);this.set_$5CF(0);this.set_$2Hh(!0);$6J(this,"OnAppsPaneClosed");$4qS(this,2);if(n){_a.$6.$19(t,"HideAppPane","");_a.$6.endPT("HideAppPane")}}},$9MJ:function(){this.$3jz(!0)},$3jz:function(n){var t=null;if(n){_a.$6.stPT(_a.$0.$5l,"CloseComposeApp",3);t=_a.$6.$1X(_a.$0.$5l,"CloseComposeApp",!0)}this.$3KA(null);if(n){_a.$6.$19(t,"CloseComposeApp","");_a.$6.endPT("CloseComposeApp")}},$7rw:function(n){return!n},$6Xx:function(n){$6J(this,"OnExtensionOpened");_d.$2q.prototype.$3KA.call(this,n);$3av(this,!0)},$5Ty:function(){$3aw(this,!0);this.set_$3iU(_nbs.NonBootStrings.l_ComposeAppsForOutlook_Text);this.set_$419(!1);$6J(this,"BackToList");_d.$2q.prototype.$3KA.call(this,null)},$9Qe:function(n,t){if(t===_d.$2q.$2a0||t===_d.$2q.$2VC||t==="ForceHideAppsButton"){this.set_$6eq($4qR(this));this.$1nA.set_$69(this.$2Bz)}},$6MK:function(n){this.$3KA(null);n()}};_d.$w4=function(n,t){this.$$d_$2yZ=Function.createDelegate(this,this.$2yZ);this.$$d_$5bV=Function.createDelegate(this,this.$5bV);_d.$w4.initializeBase(this);this.$6l=n;this.$Ou=t;if(this.$Ou==="TouchNarrow"){this.set_$6k(_y.$22.$Aj(this));var i=this;var r=new _C(function(){i.$4O()},_a.$0.$5l);this.$3y.set_$I3([new _y.$2Q(_y.$d.get_$9J(),_y.$d.get_$LH(),_nbs.NonBootStrings.l_Close_LowerCase_Text,r)])}};_d.$w4.prototype={$Ou:0,$DC:null,$6l:null,$1e8:!1,$1tr:null,$17b:null,get_$6IJ:function(){return this.$17b},set_$6IJ:function(n){this.$17b=n;return n},get_$1kp:function(){return 2},get_$2PH:function(){return this.$$d_$5bV},get_$7c:function(){return this.$DC},set_$7c:function(n){this.$DC=n;return n},get_$7sU:function(){return!0},get_$KN:function(){return this.$Ou==="TouchNarrow"?1:0},$5bV:function(n,t){if(this.$1e8)return!1;if(this.$17b){this.$1tr=n;this.$17b(this.$$d_$2yZ);return!0}this.$2yZ();return!1},$4O:function(){if(!this.$1e8&&this.get_$7c()){this.get_$7c()();this.$6l.$3jz(!1)}},$2yZ:function(){this.$1e8=!0;this.$1tr&&this.$1tr()}};_d.$RI=function(){};_d.$RI.$8TS=function(n){var i=n.toString();var t=_d.$RI.$EH[i];if(!t){t=_js.$1i.$9S(_d.$RI.$1OD,n);_d.$RI.$EH[i]=t}return t};_d.$RI.$1OD=function(){};_d.$RI.$1OD.prototype={};_d.$RI.$1OD.registerEnum("_d.$RI.$1OD",!1);_d.$16F=function(){_d.$16F.initializeBase(this,[1,"VM.Extensibility.Stats"])};_d.$16F.prototype={get_$7iz:function(){return this.$W("ContextRetrievalTime")},set_$7iz:function(n){$1I(this,"ContextRetrievalTime",n);return n},get_$7iw:function(){return this.$W("ContextExtensionsCount")},set_$7iw:function(n){$1I(this,"ContextExtensionsCount",n);return n},get_$8Tt:function(){return this.$W("MaxCountOfActiveExtensions")},set_$8Tt:function(n){$1I(this,"MaxCountOfActiveExtensions",n);return n},get_$7XV:function(){return this.$W("ActivationTime")},set_$7XV:function(n){$1I(this,"ActivationTime",n);return n},get_$A8a:function(){return this.$W("TotalActivationStatistics")},set_$A8a:function(n){$1I(this,"TotalActivationStatistics",n);return n},get_$9mK:function(){return this.$W("RegExStatistics")},set_$9mK:function(n){$1I(this,"RegExStatistics",n);return n},get_$9gS:function(){return this.$W("PerExtensionStatistics")},set_$9gS:function(n){$1I(this,"PerExtensionStatistics",n);return n},get_$an:function(){return this.$W("Interval")},set_$an:function(n){$1I(this,"Interval",n);return n},get_$80E:function(){return this.$W("FromHtmlStatistics")},set_$80E:function(n){$1I(this,"FromHtmlStatistics",n);return n},get_$8HE:function(){return this.$W("InnerTextStatistics")},set_$8HE:function(n){$1I(this,"InnerTextStatistics",n);return n},get_$8F0:function(){return this.$W("HtmlBodyLengthStatistics")},set_$8F0:function(n){$1I(this,"HtmlBodyLengthStatistics",n);return n},get_$7jM:function(){return this.$W("ConvertedBodyLengthStatistics")},set_$7jM:function(n){$1I(this,"ConvertedBodyLengthStatistics",n);return n},get_$7vm:function(){return this.$W("EntityStatistics")},set_$7vm:function(n){$1I(this,"EntityStatistics",n);return n}};_d.$J5=function(){this.$$d_$5X9=Function.createDelegate(this,this.$5X9);this.$3qh=6e5;this.$496=_a.$7.$Yu;this.$1LP=[];this.$1c7={};this.$1c8={}};function $71S(n,t){for(var i=new Sys.StringBuilder,r=0;r<_c.$8n.$n0.Extensions.length;r++){var u=_c.$8n.$n0.Extensions[r];var f=$5(n.$1c7[u.Id])?0:n.$1c7[u.Id];var e=$5(n.$1c8[u.Id])?0:n.$1c8[u.Id];i.append("[");i.append(t[r]?t[r].$1JG():"");i.append(",");i.append(f.toString());i.append(",");i.append(e.toString());i.append("]")}return i.toString()}function $2FJ(n){return n.$1LP.length>=n.$8Tr||!_js.Trace.$2v}_d.$J5.prototype={$8Tr:100,$1Ai:null,$qQ:null,$iw:null,$1vz:null,$6lL:function(n,t){if(!$2FJ(this)){this.$iw||(this.$iw=new _d.$J5.$5T1);if(!this.$iw.$3O3){this.$iw.$3O3=[];this.$iw.$2dI=[]}Array.add(this.$iw.$3O3,n);Array.add(this.$iw.$2dI,t)}},$A97:function(n){this.$1c8[n]=$5(this.$1c8[n])?1:this.$1c8[n]+1},$6lG:function(n,t,i){i&&(this.$1c7[n]=$5(this.$1c7[n])?1:this.$1c7[n]+1);if(!$2FJ(this)){this.$iw||(this.$iw=new _d.$J5.$5T1);this.$iw.$6hX=t;this.$iw.$59W=i;this.$1Ai||(this.$1Ai=new _d.$J5.$59X);Array.add(this.$1Ai.$33M,this.$iw);this.$iw=null}},$6lI:function(n,t){if(!$2FJ(this)){this.$1vz||(this.$1vz=new _d.$J5.$7xQ);this.$1vz.$6lI(n,t)}},$6lM:function(n){if(!$2FJ(this)){this.$1Ai||(this.$1Ai=new _d.$J5.$59X);this.$1Ai.$6kz=n;Array.add(this.$1LP,this.$1Ai);this.$1Ai=null}},$A93:function(n,t,i,r){if(!$2FJ(this)){this.$qQ||(this.$qQ=new _d.$J5.$7d8);this.$qQ.$41i.$6Q(n,null);this.$qQ.$42o.$6Q(r,null);this.$qQ.$3wf.$6Q(i,null);this.$qQ.$3nw.$6Q(t,null)}},$5UP:function(){var n=_a.$7.get_$2F();if(n.$5u(this.$496)>=this.$3qh){_a.$g.$8n.$7Xb(this.$$d_$5X9);this.$9pS();this.$496=n}},$9pS:function(){this.$1LP=[];this.$1c7={};this.$1c8={};this.$1Ai=null;this.$iw=null;this.$qQ=null;this.$1vz=null},$fs:function(n){var t=new Sys.StringBuilder;if($5(_c.$8n.$n0))t.append("Extensions are not initialized yet.");else{n&&t.append('<TABLE class="errorReportingTable">');t.appendLine(this.$5X9().$9S(n));n&&t.append("</TABLE>")}return new _a.$MB("Pending Extensibility Statistics",t.toString())},$5X9:function(){var s=_c.$8n.$n0.Extensions.length;var n=new _d.$16F;n.set_$7iz(_c.$8n.$38i);n.set_$7iw(s);if(this.$1LP.length>0){for(var r=0,h=new _d.$Vg,i=new Array(s),c=new _d.$Vg,u=0;u<this.$1LP.length;u++){var f=this.$1LP[u];h.$6Q(f.$6kz,null);for(var e=0,t=0;t<f.$33M.length;t++){var o=f.$33M[t];o.$59W&&e++;$5(i[t])&&(i[t]=new _d.$Vg);var l=_c.$8n.$n0.Extensions[t];var a=$5(l)?null:l.DisplayName;i[t].$6Q(o.$6hX,a);o.$ADO(c)}e>r&&(r=e)}n.set_$8Tt(r);n.set_$7XV(this.$1LP.length);n.set_$A8a(h.$1JG());n.set_$9gS($71S(this,i));n.set_$9mK(c.$1JG());n.set_$an(this.$3qh/1e3);if(this.$qQ){n.set_$80E(this.$qQ.$3wf.$1JG());n.set_$8HE(this.$qQ.$42o.$1JG());n.set_$8F0(this.$qQ.$41i.$1JG());n.set_$7jM(this.$qQ.$3nw.$1JG())}this.$1vz&&n.set_$7vm(this.$1vz.$1JG())}return n}};_d.$J5.$59X=function(){this.$33M=[]};_d.$J5.$59X.prototype={$6kz:0};_d.$J5.$7d8=function(){this.$3wf=new _d.$Vg;this.$42o=new _d.$Vg;this.$41i=new _d.$Vg;this.$3nw=new _d.$Vg};_d.$J5.$5T1=function(){};_d.$J5.$5T1.prototype={$3O3:null,$2dI:null,$6hX:0,$59W:!1,$ADO:function(n){if(this.$2dI)for(var t=0;t<this.$2dI.length;t++)n.$6Q(this.$2dI[t],this.$3O3[t])}};_d.$J5.$7xQ=function(){};_d.$J5.$7xQ.prototype={$6EL:0,$6EM:0,$6EN:0,$6EO:0,$6EP:0,$6EQ:0,$6ER:0,$1iY:null,$6lI:function(n,t){this.$1iY=null;var i=!t;if(n){var r=new(_0365f.$n.$$(_g.$l1));if(n.ExtractedAddresses&&(i||!t.Addresses)){this.$1YE(3);this.$6EL++}if(n.ExtractedContacts&&(i||!t.Contacts)){this.$1YE(7);this.$6EM++}if(n.ExtractedEmails&&(i||!t.EmailAddresses)){this.$1YE(6);this.$6EN++}if(n.ExtractedMeetings&&(i||!t.MeetingSuggestions)){this.$1YE(1);this.$6EO++}if(n.ExtractedPhones&&(i||!t.PhoneNumbers)){this.$1YE(5);this.$6EP++}if(n.ExtractedTasks&&(i||!t.TaskSuggestions)){this.$1YE(2);this.$6EQ++}if(n.ExtractedUrls&&(i||!t.Urls)){this.$1YE(4);this.$6ER++}}},$1JG:function(){var n=new Sys.StringBuilder;n.append(String.format("MissingEntitiesCount:{0},{1},{2},{3},{4},{5},{6}.",this.$6EL,this.$6EM,this.$6EN,this.$6EO,this.$6EP,this.$6EQ,this.$6ER));if(this.$1iY){n.append("MissingOnLastMessage:");for(var t=0;t<this.$1iY.get_$C();t++){n.append(_g.$l1.toString(this.$1iY.get_$3o(t)));n.append(",")}}return n.toString()},$1YE:function(n){this.$1iY||(this.$1iY=new(_0365f.$n.$$(_g.$l1)));this.$1iY.$D(n)}};_d.$IJ=function(n,t){this.$$d_$9t0=Function.createDelegate(this,this.$9t0);this.$$d_$9i8=Function.createDelegate(this,this.$9i8);_d.$IJ.initializeBase(this);this.$Zu=n;this.$1JB=t;this.$3MV=new _C(this.$$d_$9i8,_a.$0.$5l);this.$2N1=new _0365m.$2c(new Array(0));this.$1OI=new _js.$c};function $4qm(n){var r=n.$Zu.get_$C();if(r>n.$1FV){var t=0;n.$2N1.$14.$1t();while(t<r){var i=n.$Zu.get_$3o(t);if(n.$1OI.$79(i)<0){var u=new _0365m.$o(i.$6m.DisplayName,null,new _d.$wv(n.$$d_$9t0,i),!0);n.$2N1.$14.$D(u)}t++}n.set_$5d5(!1)}else{n.$2N1.$14.$1t();n.set_$5d5(!0)}}_d.$IJ.prototype={$1FV:0,$Zu:null,$1OI:null,$2N1:null,$1JB:null,$32J:!0,$1nz:null,$1R2:null,$3MV:null,get_$5d5:function(){return this.$32J},set_$5d5:function(n){if(this.$32J!==n){this.$32J=n;$3(this,_d.$IJ.$5d6)}return n},get_$3V7:function(){return this.$1nz},set_$3V7:function(n){if(this.$1nz!==n){this.$1nz=n;$5(n)||$3(this,_d.$IJ.$4fF)}return n},get_$5oy:function(){return this.$1R2},set_$5oy:function(n){this.$1R2=n;if(n.$Sr===3){var t=this.$1R2.$3uR.get_$1r().extensionViewModel;if($5(t)||this.$1nz===t){this.$1JB.$By=null;this.$1JB.$s();this.$aD()}else{this.$1JB.$By=t;this.$1JB.$s();this.set_$3V7(t)}}return n},$aD:function(){this.$1nz=null;$3(this,_d.$IJ.$4fF)},$9i8:function(){if(!(this.$1FV<1)){var n=0;var i=this.$Zu.get_$C();var u=!1;var t=this.$1nz;var r=this.$1FV;this.$1OI.$1t();while(n<r&&n<i){var o=this.$Zu.get_$3o(n);var f=n+1===r||n+1===i;($5(t)||o.$6m.Id===t.$6m.Id)&&(u=!0);var e=f&&!u?t:this.$Zu.get_$3o(n);this.$1OI.$D(e);e.set_$5jT(f&&i<=r);n++}this.set_$3V7(t);$4qm(this)}},$9t0:function(n){n.set_$5jT(!1);this.$1OI.$6C(this.$1OI.get_$C()-1);this.$1OI.$D(n);this.$1JB.$By=n;this.$1JB.$s();this.set_$3V7(n);$4qm(this)}};_d.$wu=function(n,t,i){this.$$d_$5U0=Function.createDelegate(this,this.$5U0);this.$$d_$2yZ=Function.createDelegate(this,this.$2yZ);this.$$d_$5bV=Function.createDelegate(this,this.$5bV);_d.$wu.initializeBase(this);this.$6l=n;this.$Ou=i;if(i!=="Mouse"){this.set_$6k(_y.$22.$Aj(this));var e=this;var o=new _C(function(){e.$4O()},_a.$0.$5l);this.$3y.set_$I3([new _y.$2Q(_y.$d.get_$9J(),_y.$d.get_$LH(),_nbs.NonBootStrings.l_Close_LowerCase_Text,o)])}if(i==="TouchWide"&&t.get_$1fJ())if(_g.$2o.isInstanceOfType(this.$6l.$P))this.set_$48U(this.$6l.$P.get_$3M().get_$1n());else if(this.$6l.$P.get_$JN()&&this.$6l.$P.get_$JN().get_$1n())this.set_$48U(this.$6l.$P.get_$JN().get_$1n());else{var r=_0365f.$2d.$3g(_h.$v.get_$48f());r.MaximumBodySize=0;r.MaximumRecipientsToReturn=0;var u=new _h.$J8(100,[this.$6l.$P.get_$i()],r,"ItemNormalizedBody",0,!1);var f=this;u.add_$29(function(n){f.set_$48U(f.$6l.$P.get_$JN().get_$1n())});OwaApplication.$1W.$11(u)}};_d.$wu.prototype={$DC:null,$6l:null,$17b:null,$48T:null,$1e8:!1,$1tr:null,$Ou:0,get_$48U:function(){return this.$48T},set_$48U:function(n){this.$48T=n;$3(this,"ItemBodyValue");return n},get_$1kp:function(){return 4},get_$2PH:function(){return this.$$d_$5bV},get_$7c:function(){return this.$DC},set_$7c:function(n){this.$DC=n;return n},get_$7sU:function(){return!0},get_$KN:function(){return this.$Ou!=="Mouse"?1:0},get_$6IJ:function(){return this.$17b},set_$6IJ:function(n){this.$17b=n;return n},$5bV:function(n,t){if(this.$1e8)return!1;if(this.$17b){this.$1tr=n;this.$17b(this.$$d_$2yZ);return!0}this.$2yZ();return!1},$4O:function(){this.$1e8||(this.$Ou==="TouchNarrow"?this.$17b?this.$17b(this.$$d_$5U0):this.$5U0():this.get_$7c()&&this.get_$7c()())},$5U0:function(){this.$1e8=!0;this.get_$7c()&&this.get_$7c()()},$2yZ:function(){this.$1e8=!0;this.$1tr&&this.$1tr()}};_d.$pf=function(){};_d.$pf.prototype={$7lc:function(n,t,i){return new _d.$wu(n,t,i)},$7ko:function(n,t){return new _d.$w4(n,t)}};_d.$Tm=function(n,t,i,r,u,f,e,o,s,h,c,l,a){this.$$d_$6MK=Function.createDelegate(this,this.$6MK);this.$$d_$5Tz=Function.createDelegate(this,this.$5Tz);this.$$d_$6QD=Function.createDelegate(this,this.$6QD);_d.$Tm.initializeBase(this,[n,t,i,r,u,f,e,o,s,h,c,l,a])};function $71U(n){"Mouse"!==n.$B.get_$L()&&n.$Fg&&(n.$c.$5i(n.$c.get_$Hl())?n.$c.get_$Hl().$5Rz(n.$Fg.get_$5S2(),n.$Fg.get_$1wB().DisplayName,n.$$d_$6QD,n.$$d_$5Tz):n.$6QD())}function $71T(n){n.$e3=n.$1c5.$7lc(n,n.$1A,n.$B.get_$L());n.$e3.set_$6IJ(n.$$d_$6MK);n.$B.$7C(n.$e3)}_d.$Tm.prototype={$e3:null,$3vb:null,$3KA:function(n){_d.$2q.prototype.$3KA.call(this,n);$71U(this)},$78:function(){_d.$2q.prototype.$78.call(this);this.$e3&&this.$e3.$4O()},$7rw:function(n){return"Mouse"!==this.$B.get_$L()||!n},$6QD:function(){$3av(this,!0);$71T(this)},$6MK:function(n){this.$17o&&this.$17o.$aD();this.$3vb=n;$3aw(this,!0);this.$c.$5i(this.$c.get_$Hl())?this.$c.get_$Hl().$5Sk():this.$5Tz()},$5Tz:function(){this.$3vb&&this.$3vb()}};_d.$16H=function(n){_d.$16H.initializeBase(this,[1,"VM.Extensibility."+n])};_d.$16H.prototype={$11:function(){_a.$g.$8n.$AP(this)},$4Te:function(n){var t=n;for(var i in t){var r={key:i,value:t[i]};$1I(this,r.key,r.value)}}};_d.$wv=function(n,t){this.$$d_$7wx=Function.createDelegate(this,this.$7wx);_d.$wv.initializeBase(this);this.set_$69(!0);this.set_$MT(this.$$d_$7wx);this.$5fz=n;this.$By=t;this.$1z=_a.$0.$5l};_d.$wv.prototype={$5fz:null,$By:null,$7wx:function(){this.$5fz(this.$By)}};_d.$RJ=function(n,t,i,r,u,f,e,o,s,h,c){this.$EV=n;this.$1c5=t;this.$FB=i;this.$286=r;this.$c=u;this.$1A=f;this.$B=e;this.$J=o;this.$2My=s;this.$2N0=h;this.$Oa=c};function $4qt(n,t,i,r){return new _d.$Tm(n.$FB,n.$c,n.$1A,n.$B,n.$1c5,!0,_a.$Cu.$yQ(),n.$286,n.$J,n.$Oa,t,i,r)}_d.$RJ.prototype={$FB:null,$286:null,$c:null,$1A:null,$B:null,$1c5:null,$J:null,$2My:null,$2N0:null,$Oa:null,$EV:null,$3p0:function(n,t){return $4qt(this,n,this.$2My.$5Lu(n,t),this.$2N0.$3p0(n,t))},$5Kj:function(n){return $4qt(this,n,this.$2My.$5Lu(n,!1),this.$2N0.$5Kj(n))},$5Lc:function(n,t){return new _d.$HQ(_a.$0.$l,this.$EV,t,this.$FB,this.$c,this.$1A,this.$B,this.$1c5,!0,_a.$Cu.$yQ(),this.$286,this.$J,this.$Oa,null,this.$2My.$5Kn(2),this.$2N0.$5Lc(n))},$5Kh:function(n,t){return new _d.$HQ(_a.$0.$1c,this.$EV,t,this.$FB,this.$c,this.$1A,this.$B,this.$1c5,!0,_a.$Cu.$yQ(),this.$286,this.$J,this.$Oa,null,this.$2My.$5Kn(3),this.$2N0.$5Kh(n))}};_d.$GJ=function(n,t){this.$$d_$5Am=Function.createDelegate(this,this.$5Am);this.$2Pz=[];_d.$GJ.initializeBase(this);this.$6m=n;this.$mz=t;this.$1Y6=_d.$Ck.$E(n.Rule,this.$mz)};_d.$GJ.$6ln=function(n,t,i){i.val=null;var r=new _d.$GJ(n,t);var u=null;var f=0;var e,o,s;if(s=_d.$GJ.$A9t(n,t.$1Od,e={val:u},o={val:f}),u=e.val,f=o.val,s){r.$2xh=u;r.$5OB=f;i.val=r;return!0}return!1};_d.$GJ.$A9t=function(n,t,i,r){i.val=null;r.val=0;var u;if(t===1)u=0;else if(t===2||t===3)u=1;else return!1;if(!n.FormSettingsList)return!1;for(var o=n.FormSettingsList,s=o.length,f=0;f<s;++f){var e=o[f];if(e.SettingsType===u){i.val=e.SourceLocation;if(!n.Type){i.val=i.val.replace("{","%7b");i.val=i.val.replace("}","%7d")}r.val=e.RequestedHeight;return!0}}return!1};_d.$GJ.prototype={$2xh:null,$5OB:0,$6m:null,$1Y6:null,$mz:null,$45n:!1,$2QB:null,get_$1wB:function(){return this.$6m},get_$LA:function(){return this.$6m.AppStatus},get_$2xX:function(){return this.$6m.EndNodeUrl},get_$1o:function(){return this.$6m.DisplayName},get_$8Qs:function(){return this.$6m.LicenseType},get_$9kn:function(){return this.$6m.ProviderName},get_$6di:function(){return _js.$8.$15(this.$6m.Settings)?{}:JsonParser.deserialize(this.$6m.Settings)},set_$6di:function(n){this.$6m.Settings=n?JsonParser.serialize(n):"";return n},get_$8F5:function(){if(!_js.$8.$15(this.$2QB))return this.$2QB;this.$2QB=_d.$GJ.$33B?_js.$8.$15(this.$6m.HighResolutionIconUrl)?this.$6m.IconUrl:this.$6m.HighResolutionIconUrl:_js.$8.$15(this.$6m.IconUrl)?this.$6m.HighResolutionIconUrl:this.$6m.IconUrl;return this.$2QB},get_$5S2:function(){return this.$2xh},get_$5jT:function(){return this.$45n},set_$5jT:function(n){if(n!==this.$45n){this.$45n=n;$3(this,"IsLastExtension")}return n},get_$32c:function(){return this.$2Pz},set_$32c:function(n){this.$2Pz=n;return n},$9w3:function(n){var u=this.$mz.$4BM;var s=this.$mz.$2dH;Array.clear(this.$2Pz);if(!this.$6m.DisableEntityHighlighting){var t={};var f=s;for(var e in f)for(var h={key:e,value:f[e]},o=h.value,i=0;i<o.length;i++)this.$5Am(o[i],null,t);for(var r=0;r<u.length;r++){var c=u[r];switch(c){case 3:_d.$5v.$1DE(n.Addresses,"Address",t,this.$$d_$5Am);break;case 6:_d.$5v.$1DE(n.EmailAddresses,"EmailAddress",t,this.$$d_$5Am);break;case 4:_d.$5v.$1DE(n.Urls,"Url",t,this.$$d_$5Am);break;case 1:_d.$5v.$1DE(n.MeetingSuggestions,"MeetingString",t,this.$$d_$5Am);break;case 2:_d.$5v.$1DE(n.TaskSuggestions,"TaskString",t,this.$$d_$5Am);break;case 5:_d.$5v.$1DE(n.PhoneNumbers,"OriginalPhoneString",t,this.$$d_$5Am);break;case 7:_d.$5v.$1DE(n.Contacts,"ContactString",t,this.$$d_$5Am);break}}this.$mz.$xW.$7zO(t,this.$$d_$5Am)}},$5Am:function(n,t,i){var r=i;if(!(n in r)){Array.add(this.$2Pz,n);r[n]=!0}}};_d.$Ck=function(){};_d.$Ck.$E=function(n,t){var i=_d.$Ck.$5Ll(n,t);if(!$5(i)){t.$5NK>7&&$1q2(i,"Number of custom pattern rules exceeds the limit of "+7+".");t.$6Z2>15&&$1q2(i,"Number of rules exceeds the limit of "+15+".");if(i.$Ne)return i}return null};_d.$Ck.$473=function(n){return n.$1Od===1};_d.$Ck.$5Ll=function(n,t){return $5(n)?null:++t.$6Z2>15?null:n.Type==="Collection"?new _d.$14K(n,t):n.Type==="ItemIs"?new _d.$Mb(n):n.Type==="ItemHasKnownEntity"?new _d.$5v(n):n.Type==="ItemHasRegularExpressionMatch"?new _d.$IQ(n,t,_a.UserAgent.getInstance()):n.Type==="ItemHasAttachment"?new _d.$1AD:null};function $1q2(n,t){_js.Trace.logError(_a.$0.$5l,t);n.$Ne=!1}_d.$Ck.prototype={$Ne:!0,$5jN:function(n,t){return!0}};_d.$14K=function(n,t){_d.$14K.initializeBase(this);if($5(n.Mode)){$1q2(this,"Collection rule with no required 'mode' attribute found.");return}if($5(n.Rules)||!n.Rules.length){$1q2(this,"Collection rule with no required 'rule' attribute found.");return}this.$43g="And"===n.Mode;this.$1tP=new _js.$c;for(var i=0;i<n.Rules.length;i++){var r=_d.$Ck.$5Ll(n.Rules[i],t);$5(r)||this.$1tP.$D(r)}};_d.$14K.prototype={$43g:!1,$1tP:null,$2xo:function(n,t,i){for(var r=this.$43g,u=0;u<this.$1tP.get_$C();u++){var f=this.$1tP.get_$3o(u);r=this.$43g?!!(r&f.$2xo(n,t,i)):!!(r|f.$2xo(n,t,i))}return r},$5jN:function(n,t){for(var i=0;i<this.$1tP.get_$C();i++){var r=this.$1tP.get_$3o(i);if(!r.$5jN(n,t))return!1}return!0}};_d.$wo=function(n,t){this.$4BM=[];this.$xW=new _d.$7h;this.$Oa=n;this.$1Od=t};_d.$wo.prototype={$5NK:0,$6Z2:0,$2dH:null,$na:!1,$Oa:null,$1Od:0};_d.$7h=function(){};_d.$7h.$1cV=function(n,t,i,r){if(n){var u=n;for(var f in u){var e={key:f,value:u[f]};_d.$5v.$1DE(e.value,t,i,r)}}};_d.$7h.$1YH=function(n,t,i){i&&(n[t]=i)};_d.$7h.$1YG=function(n,t,i){n.val||(n.val={});n.val[t]=i};_d.$7h.prototype={$8i:null,$1Bo:null,$RO:null,$1gR:null,$186:null,$1o6:null,$19z:null,$838:function(){var n={};_d.$7h.$1YH(n,"Addresses",this.$8i);_d.$7h.$1YH(n,"Contacts",this.$1Bo);_d.$7h.$1YH(n,"EmailAddresses",this.$RO);_d.$7h.$1YH(n,"MeetingSuggestions",this.$1gR);_d.$7h.$1YH(n,"PhoneNumbers",this.$186);_d.$7h.$1YH(n,"TaskSuggestions",this.$1o6);_d.$7h.$1YH(n,"Urls",this.$19z);return n},$59q:function(n,t,i){switch(n){case 3:var r;_d.$7h.$1YG(r={val:this.$8i},t,i);this.$8i=r.val;break;case 7:var u;_d.$7h.$1YG(u={val:this.$1Bo},t,i);this.$1Bo=u.val;break;case 6:var f;_d.$7h.$1YG(f={val:this.$RO},t,i);this.$RO=f.val;break;case 1:var e;_d.$7h.$1YG(e={val:this.$1gR},t,i);this.$1gR=e.val;break;case 5:var o;_d.$7h.$1YG(o={val:this.$186},t,i);this.$186=o.val;break;case 2:var s;_d.$7h.$1YG(s={val:this.$1o6},t,i);this.$1o6=s.val;break;case 4:var h;_d.$7h.$1YG(h={val:this.$19z},t,i);this.$19z=h.val;break;default:break}},$7zO:function(n,t){_d.$7h.$1cV(this.$8i,"Address",n,t);_d.$7h.$1cV(this.$1Bo,"ContactString",n,t);_d.$7h.$1cV(this.$RO,"EmailAddress",n,t);_d.$7h.$1cV(this.$1gR,"MeetingString",n,t);_d.$7h.$1cV(this.$186,"OriginalPhoneString",n,t);_d.$7h.$1cV(this.$1o6,"TaskString",n,t);_d.$7h.$1cV(this.$19z,"Url",n,t)}};_d.$1AD=function(){_d.$1AD.initializeBase(this)};_d.$1AD.prototype={$2xo:function(n,t,i){return _d.$Ck.$473(t)?n.get_$G5()!==undefined&&n.get_$G5():!1}};_d.$5v=function(n){this.$$d_$7wA=Function.createDelegate(this,this.$7wA);_d.$5v.initializeBase(this);$5(n.EntityType)?$1q2(this,"ItemHasKnownEntity rule contains null entity type."):this.$Fd=n};_d.$5v.$1DE=function(n,t,i,r){if(n&&n.length>0)for(var u=0;u<n.length;u++){var f;f=t?n[u][t]:n[u];f&&r(f,n[u],i)}};_d.$5v.$1Oo=function(n,t,i){if($5(n)||!n.length)return null;for(var f=[],r=0,u=0;u<n.length;u++){var e=n[u].Position;if(_d.$5v.$8KJ(i,e,t)){f[r]=_d.$5v.$83l(n[u],t);r++}}if(r>0)_js.Trace.logInfo(_a.$0.$5l,"GetExtractedEntitiesFilteredByView: {2} entities returned for type {0} isConversationView {1}",t,i,r);else{f=null;_js.Trace.logInfo(_a.$0.$5l,"GetExtractedEntitiesFilteredByView: No entities returned for type {0} isConversationView {1}",t,i)}return f};_d.$5v.$8KJ=function(n,t,i){var r=!1;n?(t==="LatestReply"||t==="Signature"||t==="Subject")&&(r=!0):_d.$5v.$5ko(i)?(t==="LatestReply"||t==="Signature"||t==="Subject")&&(r=!0):r=!0;return r};_d.$5v.$5ko=function(n){return n===7||n===1||n===2};_d.$5v.$83l=function(n,t){switch(t){case 3:return n.Address;case 6:return n.EmailAddress;case 4:return n.Url;case 1:var i=n;String.isInstanceOfType(i.StartTime)&&(i.StartTime=_a.$7.$3x(i.StartTime,!0).$5X());String.isInstanceOfType(i.EndTime)&&(i.EndTime=_a.$7.$3x(i.EndTime,!0).$5X());return i;default:return n}};function $1Xc(n,t,i,r){var u=null;!$5(i)&&i.length>0&&(u=_d.$5v.$1Oo(i,n.$Fd.EntityType,t.$na));if(u){if(!n.$29l){Array.add(t.$4BM,n.$Fd.EntityType);return!0}var f=_a.$7.get_$2F();_d.$5v.$1DE(u,r,null,n.$$d_$7wA);t.$Oa.$6lL(n.$Fd.FilterName,_a.$7.get_$2F().$5u(f));if(n.$xW){t.$xW.$59q(n.$Fd.EntityType,n.$Fd.FilterName,n.$xW);return!0}}n.$29l&&t.$xW.$59q(n.$Fd.EntityType,n.$Fd.FilterName,null);return!1}function $72J(n,t){return t?n.$Fd.EntityType===3&&t.ExtractedAddresses||n.$Fd.EntityType===7&&t.ExtractedContacts||n.$Fd.EntityType===6&&t.ExtractedEmails||n.$Fd.EntityType===1&&t.ExtractedMeetings||n.$Fd.EntityType===5&&t.ExtractedPhones||n.$Fd.EntityType===2&&t.ExtractedTasks||n.$Fd.EntityType===4&&t.ExtractedUrls:!1}_d.$5v.prototype={$Fd:null,$29l:null,$xW:null,$5jN:function(n,t){return n.get_$142()?!0:$72J(this,n.get_$3N5())?this.$29l?!1:t.$na?!1:!_d.$5v.$5ko(this.$Fd.EntityType):!0},$2xo:function(n,t,i){if(!_d.$Ck.$473(t))return!1;this.$xW=null;var r=n.get_$142();if($5(r))return!1;if(this.$Fd.RegExFilter){var f,e;if(!(e=_d.$IQ.$6lo(this.$Fd.RegExFilter,this.$Fd.IgnoreCase,f={val:this.$29l}),this.$29l=f.val,e))return!1}var u=!1;switch(this.$Fd.EntityType){case 3:u=$1Xc(this,t,r.Addresses,null);break;case 7:u=$1Xc(this,t,r.Contacts,"ContactString");break;case 6:u=$1Xc(this,t,r.EmailAddresses,null);break;case 1:u=$1Xc(this,t,r.MeetingSuggestions,"MeetingString");break;case 5:u=$1Xc(this,t,r.PhoneNumbers,"OriginalPhoneString");break;case 2:u=$1Xc(this,t,r.TaskSuggestions,"TaskString");break;case 4:u=$1Xc(this,t,r.Urls,null);break}return u},$7wA:function(n,t,i){var r=n.match(this.$29l);if(r&&r.length>0){this.$xW||(this.$xW=[]);Array.add(this.$xW,t)}}};_d.$IQ=function(n,t,i){this.$5gf=16e3;this.$43U=64e3;this.$5Vo=5e5;_d.$IQ.initializeBase(this);if(n.RegExName&&n.RegExValue&&n.PropertyName){this.$Fd=n;t.$5NK++}else $1q2(this,"Invalid ItemHasRegularExpressionMatchRule rule.");this.$1A=i};_d.$IQ.$6lo=function(n,t,i){i.val=null;try{i.val=new RegExp(n,t?"ig":"g");return!0}catch(r){_js.Trace.logError(_a.$0.$5l,"Failed to create RegularExpression for pattern: {0}",n);return!1}};_d.$IQ.$9nO=function(n){for(var t=n.length-1;t>=0;t--){var i=!1;if(t>=50||n[t].length>3072)i=!0;else for(var r=t-1;r>=0;r--)if(n[t]===n[r]){i=!0;break}i&&Array.removeAt(n,t)}return n};_d.$IQ.$84M=function(n,t){if(t){if(n.get_$ME())return n.get_$ME().get_$1n()}else if(n.get_$JN())return n.get_$JN().get_$1n();else if(n.get_$3M())return n.get_$3M().get_$1n();_js.Trace.logWarning(_a.$0.$5l,"Skipping regex eval: no body for item with Id: {0}.",n.get_$i()?n.get_$i().Id:"'null id'");return null};function $72K(n,t,i,r){if(n.$Fd.PropertyName===1)return t.get_$2i();else if(n.$Fd.PropertyName===4){var u=null;if(_g.$81.isInstanceOfType(t))t.get_$8m()&&(u=t.get_$8m().Mailbox);else if(_g.$2o.isInstanceOfType(t)){var o=t.get_$FX();o&&(u=o.Mailbox)}if(u&&u.EmailAddress)return u.EmailAddress}else if(n.$Fd.PropertyName===3){var s=null;t.get_$gt()===3&&(s=$4r5(n,t,i.$na));return s}else if(n.$Fd.PropertyName===2){if(r.val)return r.val;var f=$4r5(n,t,i.$na);var c=_a.$7.get_$2F();var e=$(f);var h=_a.$7.get_$2F();e[0]&&(r.val=e[0].innerText);$5(r.val)&&(r.val=e.text());var l=_a.$7.get_$2F();i.$Oa.$A93(f?f.length:0,r.val?r.val.length:0,h.$5u(c),l.$5u(h));return r.val}return null}function $4r5(n,t,i){var r=_d.$IQ.$84M(t,i);if(r){if(r.length>n.$5Vo){_js.Trace.logInfo(_a.$0.$5l,"Body size exceeds general activation size limit");r=null}if(n.$1A.get_$35n()||n.$1A.get_$45e())if(n.$Fd.PropertyName===2){if(r.length>n.$5gf){_js.Trace.logInfo(_a.$0.$5l,"Body size exceeds IPhone/IPad activation size limit");r=null}}else if(n.$Fd.PropertyName===3&&r.length>n.$43U){_js.Trace.logInfo(_a.$0.$5l,"Body size exceeds IPhone/IPad evaluation size. Truncating to evaluation size");r=r.substr(0,n.$43U)}}return r}_d.$IQ.prototype={$Fd:null,$1A:null,$2xo:function(n,t,i){if(!_d.$Ck.$473(t))return!1;var r=null;var f=$72K(this,n,t,i);if(f){var u;var e,o;if(!(o=_d.$IQ.$6lo(this.$Fd.RegExValue,this.$Fd.IgnoreCase,e={val:u}),u=e.val,o))return!1;var s=_a.$7.get_$2F();r=f.match(u);t.$Oa.$6lL(this.$Fd.RegExName,_a.$7.get_$2F().$5u(s));if(r&&r.length>0){r=_d.$IQ.$9nO(r);if(r.length>0){t.$2dH[this.$Fd.RegExName]=r;return!0}}}t.$2dH[this.$Fd.RegExName]=new Array(0);return!1}};_d.$Mb=function(n){_d.$Mb.initializeBase(this);this.$5ec=n.IncludeSubClasses;this.$yv=n.ItemType;this.$2Tb=n.FormType;$5(n.ItemClass)||(this.$387=n.ItemClass.toLowerCase())};_d.$Mb.$46I=function(n){return n.startsWith("ipm.note")||n.startsWith("ipm.schedule")||n.startsWith("ipm.sharing")};_d.$Mb.$5h2=function(n){return n.startsWith("ipm.appointment")||n==="ipm.ole.class.{00061055-0000-0000-c000-000000000046}"};_d.$Mb.prototype={$387:null,$5ec:!1,$yv:0,$2Tb:0,$2xo:function(n,t,i){if(t.$1Od===1&&(this.$2Tb===2||this.$2Tb===3)){if(!$5(n.get_$7n())){var r=n.get_$7n().toLowerCase();if(this.$yv===1&&_g.$81.isInstanceOfType(n)&&_d.$Mb.$46I(r)||this.$yv===2&&_g.$2o.isInstanceOfType(n)&&_d.$Mb.$5h2(r)){if(!this.$387)return!0;if(this.$5ec){if(r.startsWith(this.$387))return!0}else if(r===this.$387)return!0}}}else if(t.$1Od===2&&this.$yv===1||t.$1Od===3&&this.$yv===2)return this.$2Tb===1||this.$2Tb===3;return!1}};_d.$Tr=function(){_d.$Tr.initializeBase(this);this.$Rz=_pc.$15.$1U5;this.$3M6=_d.$Tr.$5OK;this.$1IE=2};_d.$Tr.prototype={$2Q:null,$Rz:null,$1An:null,$3M6:null,$3y5:function(n){return _pc.$15.$1NC(this.$3F,this.$2Q,n,this.$Rz,null,this.$1An,this.$3M6,1)}};_d.$x3=function(n){_d.$x3.initializeBase(this);this.$2cm=n;switch(this.$2cm){case 2:case 6:this.$1IE=1;break;case 1:this.$1IE=3;break;default:throw Error.argumentOutOfRange("querySources",n,"Unsupported source for places action provider");}};_d.$x3.prototype={$3y5:function(n){var t=new _g.$Tt;t.Query=this.$3F;t.Sources=this.$2cm;t.MaxResults=12;t.Culture=_g.$V.get_$I().get_$2z().get_$7l();if(this.$29O.$Hj.$T1()){t.Latitude=this.$29O.$Hj.$Os;t.Longitude=this.$29O.$Hj.$Ow}return new _c.$pl(t,n)}};_d.$ce=function(n,t,i,r){this.$$d_$1Tj=Function.createDelegate(this,this.$1Tj);this.$$d_$5oR=Function.createDelegate(this,this.$5oR);this.$$d_$6oi=Function.createDelegate(this,this.$6oi);_d.$ce.initializeBase(this,[n,t,!1,null,!1,null,r,null,null]);this.$28q=t;this.$6M=i;this.set_$7y5("");this.$6oj=new _C(this.$$d_$6oi,_a.$0.$4g);this.$5oX=new _C(this.$$d_$5oR,_a.$0.$4g);this.$1El=!0;this.$Y("QueryString",this.$$d_$1Tj)};function $4qv(n,t,i){var u=t.$3y7();i.val=-1;for(var r=0;r<n.$28q.$1w.get_$C();r++){var f=n.$28q.$1w.get_$3o(r);if(f.$3y7()===u){i.val=r;return!0}}return!1}_d.$ce.prototype={$28q:null,$6M:null,$1eU:!1,$5oX:null,$6oj:null,$2jM:null,$4cV:!0,$1El:!1,get_$AEQ:function(){return!1},get_$8Qb:function(){return"http://go.microsoft.com/fwlink/?LinkId=260597"},get_$A15:function(){return!this.$28q.$1w.get_$C()},get_$8Lp:function(){return this.$1eU},set_$8Lp:function(n){if(this.$1eU!==n){this.$1eU=n;this.$1eU&&this.$hT(_nbs.NonBootStrings.l_LearnMore_Aria_Text);$N(this,"IsLearnMoreButtonHighlighted")}return n},get_$8Qa:function(){return this.$5oX},get_$A2D:function(){return this.$4cV},set_$A2D:function(n){if(this.$4cV!==n){this.$4cV=n;$N(this,"ShowUseThisLocationButton")}return n},get_$AEu:function(){return this.$2jM},set_$AEu:function(n){if(this.$2jM!==n){this.$2jM=n;this.$1El&&this.$hT(this.$2jM);$N(this,"UseThisLocationString")}return n},get_$AEt:function(){return this.$6oj},get_$8P3:function(){return this.$1El},set_$8P3:function(n){if(this.$1El!==n){this.$1El=n;this.$1El&&this.$hT(this.$2jM);$N(this,"IsUseThisLocationButtonHighlighted")}return n},$6lm:function(n){n&&!this.$8NH(n)&&this.$28q.$1w.$D(n)},$6XG:function(){this.set_$8Lp(!1);this.set_$jU(!1);this.set_$ie(-1);this.set_$JU(-1);this.set_$8P3(!0)},$7rJ:function(n){var t;var i,r;if(n&&(r=$4qv(this,n,i={val:t}),t=i.val,r)){this.$28q.$1w.$6C(t);var u=new _g.$c2;u.Id=n.$3y7();var f=new _c.$15T(u);this.$1W.$11(f)}},$8NH:function(n){var t;var i,r;return r=$4qv(this,n,i={val:t}),t=i.val,r},$2u8:function(n){var t=new _d.$97(n,_y.$17.$1fk,!1);t.$eL(1,_cc.$EQ.$39R,"");if($5(n.get_$31()))return t;t.$9i7();return t},$9at:function(){this.set_$ZO(!1);this.set_$JU(-1);this.set_$ie(-1)},$9zd:function(){return!1},$5G8:function(){if(this.$1El)return!0;else if(!this.$AY.get_$C()&&this.$rt){this.set_$jU(!1);this.set_$8P3(!0);return!0}else if(this.$GL){if(this.$1eU){this.set_$8Lp(!1);this.set_$jU(!0);return!0}}else{this.set_$ie(-1);this.set_$JU(-1);this.set_$8P3(!0);return!0}return _d.$2C.prototype.$5G8.call(this)},$5G7:function(){if(this.$1El){this.set_$8P3(!1);if(this.$AY.get_$C()){this.set_$ie(0);this.set_$JU(0);return!0}else{this.set_$jU(!0);return!0}}else if(this.$rt&&this.get_$A15()){this.set_$jU(!1);this.set_$8Lp(!0);return!0}else if(this.$1eU)return!0;return _d.$2C.prototype.$5G7.call(this)},get_$6Zo:function(){return _nbs.NonBootStrings.l_LocationWellSearchForMoreLocations_Text},$4Yq:function(){this.$1El?this.$6oi():this.$1eU?this.$5oR():_d.$2C.prototype.$4Yq.call(this)},$5oR:function(){this.$6M.$TS(this.get_$8Qb())},$6oi:function(){this.set_$ZO(!1)},$1Tj:function(n,t){this.set_$AEu(_js.$8.$4B(_nbs.NonBootStrings.l_UseThisLocation_Text,this.$3F))}};_d.$67=function(n,t,i,r){this.$$d_$9zy=Function.createDelegate(this,this.$9zy);this.$$d_$9zm=Function.createDelegate(this,this.$9zm);this.$$d_$9zw=Function.createDelegate(this,this.$9zw);this.$$d_$A1l=Function.createDelegate(this,this.$A1l);this.$$d_$iq=Function.createDelegate(this,this.$iq);this.$$d_$59F=Function.createDelegate(this,this.$59F);this.$$d_$A8P=Function.createDelegate(this,this.$A8P);this.$$d_$A8N=Function.createDelegate(this,this.$A8N);this.$$d_$1xn=Function.createDelegate(this,this.$1xn);this.$AJ=-1;this.$1dX=-1;this.$1RH=new _a.$AB;this.$1RJ=new _a.$AB;this.$1gG=new _a.$AB;this.$z5=_a.$7x.$1az;this.$1gI=10;this.$4C=new Sys.EventHandlerList;_d.$67.initializeBase(this);_a.$3.$m(i,"locationManager");this.$z6=n;this.$PT=t;this.$nr=i;this.$6M=r;if(this.$PT){var u=n.get_$3o(0);if($5(u))throw Error.argument("mapPoints","mapPoints should contain at least one IMappable object.");if(n.get_$C()===1){var f=u.get_$22w().get_$T8()==="PhonebookServices"?u.get_$22w().get_$164():"";this.$wM=new _a.$P7(_g.$V.get_$I().get_$Pl().get_$5Pb(),_a.$7x.$1az,_g.$V.get_$I().get_$2z().get_$7l(),u.get_$2VA(),u.get_$22w().get_$1R5(),u.get_$3A1(),f)}}else n.get_$C()||(this.$1gI=1);this.set_$3s9(new _C(this.$$d_$1xn,_d.$67.$A));this.set_$3q1(new _C(this.$$d_$A8N,_d.$67.$A));this.set_$4h4(new _C(this.$$d_$A8P,_d.$67.$A));_y.$x.$w.get_$L()!=="Mouse"&&$1AO(this)};function $72Y(n){n.$6XR();n.$PT&&n.$z6.get_$C()===1&&n.set_$39z(!1);n.get_$2RE()&&$1AO(n)}function $72Z(n,t){if(!t){n.set_$2gD(t);return}var i=this,r=this;n.$nr.$5X7(function(i){n.set_$8T4(i);n.set_$2gD(t)},function(n){if(_y.$x.$w.get_$L()==="Mouse")switch(n.$5IF){case 2:case 3:_a.$4Y.$2u(_nbs.NonBootStrings.l_CurrentLocationError_Text,1);break;case 1:break}})}function $72X(n){if(!n.$A5T){var t=n.$wM.get_$7zz();_a.UserAgent.getInstance().get_$6n()&&(_a.UserAgent.getInstance().$aq?t=n.$wM.get_$7aE():_a.UserAgent.getInstance().get_$Hp()&&(t=n.$wM.get_$7aT()));n.$6M.$TS(t)}}function $1AO(n){n.$PT?n.$z6.get_$C()===1?n.set_$6k($72W(n)):n.set_$6k(_y.$22.$E(n)):n.set_$6k($72V(n))}function $72W(n){var t=[new _y.$2Q(_y.$d.get_$7s6(),_y.$d.get_$7sB(),_nbs.NonBootStrings.l_GetDirectionsMobile_Text,n.$13a)];return _y.$22.$E(n,t,$3b3(n))}function $72V(n){if(_y.$x.$w.get_$L()==="TouchNarrow"){var t=null;if(!n.$5cr){var u=this;t=new _y.$2Q(_y.$d.get_$wa(),_y.$d.get_$1Zl(),_nbs.NonBootStrings.l_AcceptItemMobile_Text,new _C(n.$$d_$59F,_d.$67.$A,n,"SelectedIndex",function(){return n.$AJ!==-1}))}var i=new _y.$2Q(_y.$d.get_$9J(),_y.$d.get_$LH(),_nbs.NonBootStrings.l_CancelItemMobile_Text,new _C(n.$$d_$iq,_d.$67.$A));var r=n.$5cr?[i]:[t,i];return _y.$22.$Aj(n,r,$3b3(n))}else return _y.$22.$E(n,null,$3b3(n))}function $3b3(n){var i=new _y.$32(n.$1Vr?_nbs.NonBootStrings.l_HideCurrentLocation_Text:_nbs.NonBootStrings.l_ShowCurrentLocation_Text,n.$1CF);var r=new _y.$32(n.$1W5?_nbs.NonBootStrings.l_HideTraffic_Text:_nbs.NonBootStrings.l_ShowTraffic_Text,n.$1KD);var t=[i,r];if(n.$z5!=="r"){var u=new _C(n.$$d_$A1l,_d.$67.$A);var f=new _y.$32(_nbs.NonBootStrings.l_RoadView_Text,u);Array.add(t,f)}if(n.$z5!=="auto"){var e=new _C(n.$$d_$9zw,_d.$67.$A);var o=new _y.$32(_nbs.NonBootStrings.l_AutomaticView_Text,e);Array.add(t,o)}if(n.$z5!=="a"){var s=new _C(n.$$d_$9zm,_d.$67.$A);var h=new _y.$32(_nbs.NonBootStrings.l_AerialView_Text,s);Array.add(t,h)}if(n.$z5!=="be"){var c=new _C(n.$$d_$9zy,_d.$67.$A);var l=new _y.$32(_nbs.NonBootStrings.l_BirdsEyeView_Text,c);Array.add(t,l)}return t}_d.$67.prototype={$PT:!1,$z6:null,$nr:null,$wX:!0,$39y:!1,$wM:null,$A5T:!1,$2hl:!1,$1Vr:!1,$1W5:!1,$5cr:!1,$13a:null,$1CF:null,$1KD:null,$6M:null,get_$KN:function(){return _y.$x.$w.get_$L()!=="Mouse"?_y.$1Mq.prototype.get_$KN.call(this):0},add_$8TI:function(n){this.$4C.addHandler("MapPointAccepted",n)},remove_$8TI:function(n){this.$4C.removeHandler("MapPointAccepted",n)},add_$4Yy:function(n){this.$Y("SelectedIndex",n)},remove_$4Yy:function(n){this.$q("SelectedIndex",n)},add_$41b:function(n){this.$Y("HoveredIndex",n)},remove_$41b:function(n){this.$q("HoveredIndex",n)},add_$5qv:function(n){this.$Y("MapCenter",n)},remove_$5qv:function(n){this.$q("MapCenter",n)},get_$1kp:function(){return 1},get_$2PH:function(){return null},get_$Qo:function(){return this.$AJ},set_$Qo:function(n){if(this.$AJ!==n){(n>this.$z6.get_$C()-1||n<-1)&&(n=-1);this.$AJ=n;$3(this,"SelectedIndex")}return n},get_$41a:function(){return this.$1dX},set_$41a:function(n){if(this.$1dX!==n){(n>this.$z6.get_$C()-1||n<-1)&&(n=-1);this.$1dX=n;$3(this,"HoveredIndex")}return n},get_$5qu:function(){return this.$1RH},set_$5qu:function(n){if(!$5(n)&&!this.$1RH.$Hj.$1dD(n.$Hj)){this.$1RH=n;$3(this,"MapCenter")}return n},get_$4B8:function(){return this.$1RJ},set_$4B8:function(n){if(!$5(n)&&!this.$1RJ.$Hj.$1dD(n.$Hj)){this.$1RJ=n;$3(this,"MapViewCenter")}return n},get_$8T4:function(){return this.$1gG},set_$8T4:function(n){if(!$5(n)&&!this.$1gG.$Hj.$1dD(n.$Hj)){this.$1gG=n;$3(this,"MapCurrentLocation")}return n},get_$1gH:function(){return this.$z5},set_$1gH:function(n){if(n!==this.$z5){this.$z5=n;$5(this.$wM)||this.$wM.set_$2VB(this.$z5);this.$2hl||$3(this,"MapDisplayType")}return n},get_$5r0:function(){return this.$1gI},set_$5r0:function(n){if(n!==this.$1gI){this.$1gI=n;$3(this,"MapZoomLevel")}return n},get_$39z:function(){return this.$39y},set_$39z:function(n){this.$39y=n;$3(this,"MapBestViewSet");return n},get_$2gD:function(){return this.$1Vr},set_$2gD:function(n){if(n!==this.$1Vr){this.$1Vr=n;$5(this.$wM)||this.$wM.set_$A47(this.$1Vr?this.$1gG:null);this.get_$2RE()&&$1AO(this);this.$2hl||$3(this,"ShowCurrentLocationOnMap")}return n},get_$6ga:function(){return this.$1W5},set_$6ga:function(n){if(n!==this.$1W5){this.$1W5=n;$5(this.$wM)||this.$wM.set_$2gd(this.$1W5);this.get_$2RE()&&$1AO(this);this.$2hl||$3(this,"ShowTrafficOnMap")}return n},get_$3s9:function(){return this.$13a},set_$3s9:function(n){this.$13a=n;$3(this,"DirectionsCommand");return n},get_$3q1:function(){return this.$1CF},set_$3q1:function(n){this.$1CF=n;$3(this,"CurrentLocationCommand");return n},get_$4h4:function(){return this.$1KD},set_$4h4:function(n){this.$1KD=n;$3(this,"TrafficCommand");return n},$1xn:function(){if($5(this.$wM)){_a.$4Y.$2u(_nbs.NonBootStrings.l_GiveDirectionsError_Text,1);return}$72X(this)},$6XR:function(){this.$2hl=!0;this.set_$2gD(!1);this.set_$6ga(!1);this.set_$1gH(_a.$7x.$1az);this.$2hl=!1},$FZ:function(){_y.$1Mq.prototype.$FZ.call(this);this.get_$2RE()&&$1AO(this)},$TZ:function(){_y.$1Mq.prototype.$TZ.call(this);$72Y(this)},$iq:function(){this.get_$4h().$BP()},$59F:function(){if(this.$AJ!==-1){var n=this.$4C.getHandler("MapPointAccepted");$5(n)||n()}},$A8N:function(){$72Z(this,!this.$1Vr)},$A8P:function(){this.set_$6ga(!this.$1W5)},$9zm:function(){this.set_$1gH("a");$1AO(this)},$9zw:function(){this.set_$1gH("auto");$1AO(this)},$9zy:function(){this.set_$1gH("be");$1AO(this)},$A1l:function(){this.set_$1gH("r");$1AO(this)}};_d.$l7=function(n,t){this.$6M=t;this.$nr=n};_d.$l7.prototype={$nr:null,$6M:null,$3ol:function(n,t){var i=new _js.$c;i.$D(n);return this.$E(i,t)},$E:function(n,t){return new _d.$67(n,t,this.$nr,this.$6M)}};_d.$Rj=function(n,t,i,r,u){this.$$d_$8Bt=Function.createDelegate(this,this.$8Bt);this.$$d_$1xn=Function.createDelegate(this,this.$1xn);_d.$Rj.initializeBase(this);_a.$3.$K(r,"locationManager");this.$3m=n;this.$4E=t;this.$nr=r;this.$6M=u;this.$z6=new _js.$c;this.get_$T1()&&this.$z6.$D(t);if(i!=="Mouse"){var f=this;this.$6Nd=new _C(this.$$d_$8Bt,_a.$0.$4g,this,"IsResolved",function(){return f.get_$T1()})}};_d.$Rj.prototype={$3m:null,$4E:null,$1FC:null,$6Nd:null,$z6:null,$nr:null,$6M:null,get_$1o:function(){return this.$4E.get_$1o()},get_$iD:function(){return this.$4E.get_$iD()},get_$1wx:function(){return this.$4E.get_$31().get_$Vg()},get_$T1:function(){return this.$4E?this.$4E.$T1():!1},get_$22b:function(){this.$1FC||(this.$1FC=new _d.$67(this.$z6,!0,this.$nr,this.$6M));return this.$1FC},$1xn:function(){this.get_$22b().$1xn()},$8Bt:function(){this.$3m.$BQ(this.get_$22b())}};_d.$l8=function(n,t){this.$nr=n;this.$6M=t};_d.$l8.prototype={$nr:null,$6M:null,$E:function(n,t,i){return new _d.$Rj(n,t,i,this.$nr,this.$6M)}};_d.$z6=function(n){this.$B=n};_d.$z6.prototype={$B:null,$5q:null,$E:function(n,t,i){return new _cc.$EQ(n,t,this.$5q,this.$B,i)}};_d.$9X=function(n,t,i,r,u,f,e){this.$$d_$1Tj=Function.createDelegate(this,this.$1Tj);this.$$d_$4QD=Function.createDelegate(this,this.$4QD);this.$$d_$6NU=Function.createDelegate(this,this.$6NU);this.$$d_$9Y8=Function.createDelegate(this,this.$9Y8);this.$$d_$9eR=Function.createDelegate(this,this.$9eR);this.$$d_$7r9=Function.createDelegate(this,this.$7r9);this.$$d_$8S1=Function.createDelegate(this,this.$8S1);_d.$9X.initializeBase(this);this.$2vf=new _C(this.$$d_$7r9,_d.$9X.$A);this.$49V=new _C(this.$$d_$9eR,_d.$9X.$A);this.$3YO=[new _0365m.$o(_nbs.NonBootStrings.l_RemoveLocation_LowerCase_Text,null,this.$2vf)];this.$2c6=i;this.$6RV=t;this.$B=r;this.$3m=u;this.$5q=f;this.$6M=e;this.$7lh();$72d(this);$72b(this,n)};function $72a(n){n.$ZC=n.$2c6.$E(9,n.$6RV);n.$ZC.add_$4Yz(n.$$d_$9Y8);if(n.$B.get_$L()==="Mouse"&&!n.$B.get_$9l()){var t=this;n.$ZC.add_$2nv(function(){n.$ZC.$3ug(n.$ZC.$bt,n.$ZC.$1J3)})}$3(n,"PlacePickerViewModel")}function $72d(n){n.$Dk.set_$1K0(n.$2vf);n.$Dk.add_$37c(n.$$d_$6NU);n.$Dk.add_$hO(n.$$d_$4QD);n.$Dk.$Y("QueryString",n.$$d_$1Tj);if(n.get_$2c7()){n.$Dk.set_$2KQ(n.$49V);n.$Dk.set_$59M(n.$49V)}else n.$Dk.set_$2KQ(null)}function $4rA(n,t){n.$Dk.set_$7D(t);n.$1eW=!1}function $72b(n,t){n.$4E=t?t.$3g():_g.$3V.$qp();n.$4E.set_$1o(n.$4E.get_$1o()||"");$3b4(n,_pc.$l.$2Nw(n.$4E))}function $3b4(n,t){if(n.$4E.get_$31().get_$T8()==="Resource"){var r=n.$4E.get_$1o();if(!_js.$8.$a(n.$4E.get_$iD())){var i=new(_a.$3f.$$(String));i.$D(n.$4E.get_$1o());i.$D(n.$4E.get_$iD());r=_d.$z.$3y6(i)}$4rC(n,r)}else n.$4E.$2PT()?$72c(n,t):$4rC(n,n.$4E.get_$5QB())}function $4rC(n,t){$4rA(n,t);n.set_$28j(null);n.$Dk.set_$QJ(n.get_$2c7())}function $72c(n,t){n.$Dk.set_$M0(_nbs.NonBootStrings.l_LocationWellAnnotationWatermark_Text);n.$Dk.set_$QJ(!1);$4rA(n,n.$4E.get_$iD()||"");n.$1eW=!1;n.set_$28j(_cc.$EQ.$3ox(t,n.$5q,n.$B,1,n.$3YO,!0))}function $4rB(n){n.$Dk.set_$QJ(n.get_$2c7());n.set_$4g(_g.$3V.$139(n.$Dk.$3F))}_d.$9X.prototype={$6M:null,$73:null,$4E:null,$Dk:null,$2vf:null,$49V:null,$3YO:null,$6RV:null,$ZC:null,$2c6:null,$5q:null,$3m:null,$B:null,$1eW:!1,get_$1kj:function(){this.$ZC||$72a(this);return this.$ZC},get_$28j:function(){return this.$73},set_$28j:function(n){if(this.$73!==n){this.$73=n;$3(this,"PersonaViewModel")}return n},get_$4g:function(){return this.$4E},set_$4g:function(n){if(this.$4E!==n&&!this.$4E.$4i(n)){this.$4E=n;$3(this,"Location")}return n},get_$5jh:function(){return this.$1eW},set_$5jh:function(n){if(this.$1eW!==n){this.$1eW=n;$3(this,"IsLocationDirty")}return n},get_$2c7:function(){return _g.$V.get_$I().get_$Nq().PlacesEnabled},get_$4h:function(){return this.$3m},set_$4h:function(n){this.$3m=n;return n},$9eR:function(){if(!this.get_$2c7())throw Error.invalidOperation("Places must be enabled to use the place picker");if($5(this.$73)&&!_js.$8.$15(this.$Dk.$3F)){this.$Dk.set_$ZO(!1);this.$Dk.set_$Hr(!1);this.get_$1kj().$3ug(this.$Dk.$3F);this.$3m.$BQ(this.get_$1kj())}},$59y:function(n){this.set_$4g(n.$3Vw());$3b4(this,n)},$4iK:function(){if(this.$1eW){if($5(this.$73)){if(!$5(this.$4E)&&this.$4E.get_$31().get_$T8()==="Resource"&&this.$4E.get_$1o()===this.$Dk.$3F)return;$4rB(this)}else if(!$5(this.$4E)&&!this.$Dk.$gI){this.$4E.set_$iD(this.$Dk.$3F);$3(this,"Location")}this.set_$5jh(!1)}},$8S1:function(n,t){var i=n.get_$4g();if(!this.$4E.$4i(i)){var r=i||_g.$3V.$qp();this.$4E=r.$3g();$3b4(this,_pc.$l.$2Nw(this.$4E));this.$Dk.set_$2Pj(!1);$3(this,"Location")}},$7Z8:function(n){!$5(n)&&n.$2PT()&&n.get_$31().get_$T8()!=="Resource"&&this.$Dk.$6lm(_pc.$l.$2Nw(n))},$7lh:function(){this.$Dk=new _d.$ce(_c.$LB.$5L5,_c.$LB.$86a(),this.$6M,this.$5q);this.$Dk.set_$1ls("PlaceDetailedView");if(this.get_$2c7()){this.$Dk.$12a();this.$Dk.set_$QJ(!0)}else this.$Dk.set_$QJ(!1);this.$Dk.set_$r(!1);this.$Dk.set_$pP(!1);this.$Dk.set_$1iX(0);this.$Dk.set_$19t(100)},$1Tj:function(n,t){this.set_$5jh(!0)},$7r9:function(){this.$Dk.set_$M0("");this.set_$28j(null);$4rB(this);this.$Dk.set_$2Pj(!1)},$6NU:function(n,t){this.$Dk.$nl||this.$4iK()},$4QD:function(n,t){$5(this.$Dk.get_$X1())||this.$59y(this.$Dk.get_$X1().get_$1u())},$9Y8:function(n){$5(n)||this.$59y(n)}};_d.$l9=function(n,t,i){this.$2c6=n;this.$B=t;this.$6M=i};_d.$l9.prototype={$2c6:null,$B:null,$6M:null,$5q:null,$E:function(n,t,i){return new _d.$9X(n,t,this.$2c6,this.$B,i,this.$5q,this.$6M)}};_d.$8Z=function(n,t){_d.$8Z.initializeBase(this,[n]);if(t){this.set_$2Ao(t.$bt);this.set_$6Zw(t.$1J3.$Hj.$Os);this.set_$6Zx(t.$1J3.$Hj.$Ow);this.set_$SA(t.$CR);t.$M4&&this.set_$1VV(t.$M4.get_$1u().$3Vw())}};_d.$8Z.prototype={get_$2Ao:function(){return this.$W(_d.$8Z.$4Yh)},set_$2Ao:function(n){this.$M(_d.$8Z.$4Yh,n);return n},get_$6Zw:function(){return this.$W(_d.$8Z.$4YY)},set_$6Zw:function(n){this.$M(_d.$8Z.$4YY,n);return n},get_$6Zx:function(){return this.$W(_d.$8Z.$4YZ)},set_$6Zx:function(n){this.$M(_d.$8Z.$4YZ,n);return n},get_$SA:function(){return this.$W(_d.$8Z.$4Z3)},set_$SA:function(n){this.$M(_d.$8Z.$4Z3,n);return n},get_$1VV:function(){return this.$W(_d.$8Z.$4Z0)},set_$1VV:function(n){this.$M(_d.$8Z.$4Z0,n);return n},$5KM:function(n){n.set_$2Ao(this.get_$2Ao());var t=_a.$AB.$80H(this.get_$6Zw(),this.get_$6Zx());n.$1J3=t;n.set_$SA(this.get_$SA());this.get_$1VV()&&n.set_$1VV(n.$5M6(_pc.$l.$2Nw(this.get_$1VV())))}};_d.$Z2=function(n,t){this.$$d_$9Xk=Function.createDelegate(this,this.$9Xk);this.$$d_$9Xj=Function.createDelegate(this,this.$9Xj);this.$$d_$9tf=Function.createDelegate(this,this.$9tf);this.$$d_$9tk=Function.createDelegate(this,this.$9tk);this.$3Y7=_y.$17.$Km;_d.$Z2.initializeBase(this);this.$134=n;this.$B=t||_y.$x.$w;this.$WN=this.$B.get_$L()!=="Mouse";this.$6bA=new _C(this.$$d_$9tk,_a.$0.$4g);this.$6b4=new _C(this.$$d_$9tf,_a.$0.$4g);this.set_$13F("");this.set_$2UT("");this.set_$cp(_nbs.NonBootStrings.l_ErrorRetrievingData_Text)};function $4sh(n,t){if(t&&n.$4Sg){var i=t.$OP.get_$CQ();i.$2cs=n.get_$8Rz();if(!i.$7f){var r=null;var u=this;r=function(){if(i.$7f){i.$7f.$7E.set_$C8(0);i.remove_$1IL(r)}};i.add_$1IL(r);i.$1JZ(t.get_$1u())}}}_d.$Z2.prototype={$WN:!1,$134:null,$B:null,$1tp:!1,$4Sg:!1,$6bA:null,$6b4:null,get_$7yR:function(){var n=this.get_$3O().get_$C()>0?this.get_$3O().get_$3o(0):null;$4sh(this,n);return n},get_$8Rz:function(){switch(this.$B.get_$L()){case"Mouse":case"TouchWide":return 0;case"TouchNarrow":return 2;default:throw Error.invalidOperation("Unexpected value for OwaShell.CurrentLayout: "+this.$B.get_$L());}},$ACy:function(){var n=this.get_$AJY();if(n&&!_js.$8.$15(n.$3F)){var t=_nbs.NonBootStrings.l_NoSearchResultsString_Text;switch(n.$1IE){case 1:t=_nbs.NonBootStrings.l_NoSearchResultsFromBingString_Text;break;case 2:t=_nbs.NonBootStrings.l_NoSearchResultsFromPeopleString_Text;break;case 3:t=_nbs.NonBootStrings.l_NoSearchResultsFromHistoryString_Text;break}this.set_$275(String.format(t,n.$3F))}},$5MJ:function(n){var t=new _d.$97(n,this.$3Y7,!1,null,this.$WN?5:3,this.$134,this.$B);t.$eL(1,_cc.$EQ.$39R,"");t.set_$9hJ((this.get_$AJX().$79(n)+1).toString());t.set_$1Co(!1);t.set_$41d(!1);t.set_$fS(this.$1tp);t.set_$3Qu(this.$1tp);if(!this.$WN){t.set_$41d(!0);t.$Y("IsHovered",this.$$d_$9Xj)}t.$Y("IsSelected",this.$$d_$9Xk);t.get_$5Iy().set_$Z8(_d.$Ic.get_$9hT());return t},$9tk:function(){var n=this.$AJa();n<=0||n>=this.get_$3O().get_$C()||this.set_$1p(this.get_$3O().get_$3o(n-1))},$9tf:function(){var n=this.$AJa();!this.get_$3O().get_$C()||n>=this.get_$3O().get_$C()-1||(n===-1?this.set_$1p(this.get_$3O().get_$3o(0)):this.set_$1p(this.get_$3O().get_$3o(n+1)))},$9Xj:function(n,t){var i=n;i.$2S7?this.set_$32i(this.get_$AJX().$79(i.get_$1u())):this.set_$32i(-1)},$9Xk:function(n,t){var i=n;i.$38&&$4sh(this,i)}};_d.$m4=function(n,t,i,r,u){this.$$d_$9Y5=Function.createDelegate(this,this.$9Y5);this.$$d_$9VN=Function.createDelegate(this,this.$9VN);this.$$d_$9VQ=Function.createDelegate(this,this.$9VQ);this.$$d_$9Y6=Function.createDelegate(this,this.$9Y6);this.$$d_$9VP=Function.createDelegate(this,this.$9VP);this.$$d_$9VL=Function.createDelegate(this,this.$9VL);this.$4C=new Sys.EventHandlerList;_d.$m4.initializeBase(this,[n,i,r]);this.$C9.$3Y7=24;this.$C9.$4Sg=!1;this.$Rf=new _d.$10O(this.$C9.get_$3O(),!1,t,u);this.$Rf.add_$5qv(this.$$d_$9VL);this.$Rf.add_$4Yy(this.$$d_$9VP);this.$C9.add_$6ac(this.$$d_$9Y6);if(_y.$x.$w.get_$L()!=="Mouse")this.$6LJ=new _C(this.$$d_$9VQ,_a.$0.$4g);else{this.$Rf.add_$41b(this.$$d_$9VN);this.$C9.add_$AJV(this.$$d_$9Y5)}};_d.$m4.prototype={$6LJ:null,$Rf:null,add_$5qv:function(n){this.$4C.addHandler("MapCenterChanged",n)},remove_$5qv:function(n){this.$4C.removeHandler("MapCenterChanged",n)},get_$4h:function(){return _d.$1Cg.prototype.get_$4h.call(this)},set_$4h:function(n){_d.$1Cg.prototype.set_$4h.call(this,n);$5(this.$Rf)||this.$Rf.set_$4h(n);return n},$9pi:function(){this.$Rf.set_$39z(!1)},$6XO:function(){_d.$1Cg.prototype.$6XO.call(this);this.$Rf.$6XR()},$9VQ:function(){this.get_$4h().$BQ(this.$Rf)},$9VP:function(n,t){this.$C9.remove_$6ac(this.$$d_$9Y6);this.$Rf.$AJ>-1&&this.$Rf.$AJ<this.$C9.get_$3O().get_$C()&&this.$C9.set_$1p(this.$C9.get_$3O().get_$3o(this.$Rf.$AJ));this.$C9.add_$6ac(this.$$d_$9Y6)},$9Y6:function(n,t){this.$Rf.remove_$4Yy(this.$$d_$9VP);this.$Rf.set_$Qo(this.$C9.$AJa());this.$Rf.add_$4Yy(this.$$d_$9VP)},$9VN:function(n,t){this.$C9.remove_$AJV(this.$$d_$9Y5);this.$C9.get_$32i()>-1&&this.$C9.get_$32i()<this.$C9.get_$3O().get_$C()&&this.$C9.get_$3O().get_$3o(this.$C9.get_$32i()).set_$FR(!1);this.$C9.set_$32i(this.$Rf.$1dX);this.$C9.get_$32i()>-1&&this.$C9.get_$32i()<this.$C9.get_$3O().get_$C()&&this.$C9.get_$3O().get_$3o(this.$C9.get_$32i()).set_$FR(!0);this.$C9.add_$AJV(this.$$d_$9Y5)},$9Y5:function(n,t){this.$Rf.remove_$41b(this.$$d_$9VN);this.$Rf.set_$41a(this.$C9.get_$32i());this.$Rf.add_$41b(this.$$d_$9VN)},$9VL:function(n,t){if(!this.$461){var i=n;var r=this.$4C.getHandler("MapCenterChanged");$5(r)||r(i.$1RH);this.$2iz(this.$bt,i.$1RH)}}};_d.$10O=function(n,t,i,r){_d.$10O.initializeBase(this,[n,t,i,r])};_d.$10O.prototype={get_$KN:function(){return 1}};_d.$Z3=function(n,t,i){_d.$Z3.initializeBase(this,[n,t,i]);_y.$x.$w.get_$L()==="TouchNarrow"?this.$C9.$1tp=!0:this.$C9.$4Sg=!0};_d.$1Cg=function(n,t,i){this.$$d_$9Y7=Function.createDelegate(this,this.$9Y7);this.$$d_$6Mx=Function.createDelegate(this,this.$6Mx);this.$4C_4=new Sys.EventHandlerList;_d.$1Cg.initializeBase(this);if(!n)throw Error.argumentNull("provider");this.$4bJ=!i||i.get_$L()!=="Mouse";this.$C9=new _d.$Z2(t,i);this.$C9.$3Y7=_y.$17.$1fk;this.$C9.add_$6ac(this.$$d_$6Mx);this.$C9.add_$AJT(this.$$d_$9Y7);this.$1r0=n;this.$C9.$AJZ(n)};_d.$1Cg.prototype={$3m:null,$bt:null,$C9:null,$1r0:null,$461:!1,$20S:!0,$4bJ:!1,add_$4Z5:function(n){this.$4C_4.addHandler("SelectedPlaceChanged",n)},remove_$4Z5:function(n){this.$4C_4.removeHandler("SelectedPlaceChanged",n)},add_$4Ti:function(n){this.$4C_4.addHandler("PopulatedItemCountChanged",n)},remove_$4Ti:function(n){this.$4C_4.removeHandler("PopulatedItemCountChanged",n)},get_$8NJ:function(){return!!this.$C9.get_$3O().get_$C()},get_$8Lv:function(){return this.$20S},set_$8Lv:function(n){if(this.$20S!==n){this.$20S=n;$3(this,"IsLoadingFirstTime")}return n},get_$4h:function(){return this.$3m},set_$4h:function(n){this.$3m=n;return n},get_$2Ao:function(){return this.$bt},set_$2Ao:function(n){this.$bt=n;$3(this,"SearchTerm");return n},get_$5jc:function(){return this.$461},set_$5jc:function(n){this.$461=n;$3(this,"IsLoadingSuggestionsFromWS");return n},$9pi:function(){},$6XO:function(){this.$20S=!0},$2iz:function(n,t){this.set_$2Ao(n);this.$1r0.set_$7D(n);$5(t)||this.$1r0.set_$9l3(t);this.$C9.$ACy();if(!_js.$8.$15(n)||_js.$8.$15(n)&&this.$1r0.$2cm===1){this.set_$5jc(!0);this.$C9.get_$4M()?this.$C9.$hG():this.$C9.$5m()}else this.$C9.$AG();$3(this,"IsPopulated")},$6Mx:function(n,t){if(this.$C9.get_$1p()){var i=this.$4C_4.getHandler("SelectedPlaceChanged");$5(i)||i(this.$C9.get_$1p())}},$9Y7:function(){this.set_$5jc(!1);this.set_$8Lv(!1);$3(this,"IsPopulated");var n=this.$4C_4.getHandler("PopulatedItemCountChanged");$5(n)||n(this.$C9.get_$3O().get_$C())}};_d.$6Q=function(n,t,i,r,u,f,e){this.$$d_$9Mc=Function.createDelegate(this,this.$9Mc);this.$$d_$9Mb=Function.createDelegate(this,this.$9Mb);this.$$d_$9Z5=Function.createDelegate(this,this.$9Z5);this.$$d_$9XS=Function.createDelegate(this,this.$9XS);this.$$d_$6Mx=Function.createDelegate(this,this.$6Mx);this.$$d_$8C4=Function.createDelegate(this,this.$8C4);this.$$d_$8B2=Function.createDelegate(this,this.$8B2);this.$$d_$4Wt=Function.createDelegate(this,this.$4Wt);this.$$d_$iq=Function.createDelegate(this,this.$iq);this.$$d_$59F=Function.createDelegate(this,this.$59F);this.$$d_$ADb=Function.createDelegate(this,this.$ADb);this.$$d_$4AA=Function.createDelegate(this,this.$4AA);this.$2bg=-1;this.$2cz=-1;this.$2IN=-1;this.$bt="";this.$1VK="";this.$1J3=new _a.$AB;this.$4C=new Sys.EventHandlerList;_d.$6Q.initializeBase(this);this.$6RP=n;this.$nr=i;this.$134=r;this.$5q=u;this.$B=f;this.$6M=e;this.$2g2=this.$B.get_$L()!=="TouchNarrow";this.$1n5=this.$B.get_$L()==="Mouse";var s=this;this.$1wS=new _C(this.$$d_$4AA,_a.$0.$4g,this,"SearchDisplayText",function(){return!_js.$8.$15(s.$1VK)});this.$6nm=new _C(this.$$d_$ADb,_a.$0.$4g);var h=this;this.$2nh=new _C(this.$$d_$59F,_a.$0.$4g,this,"SelectedLocation",function(){return!$5(h.$M4)});this.$2wJ=new _C(this.$$d_$iq,_a.$0.$4g);this.$4WF=new _C(this.$$d_$4Wt,_a.$0.$4g);this.$3YO=[new _0365m.$o(_nbs.NonBootStrings.l_RemoveLocation_LowerCase_Text,null,this.$4WF)];var o=[];$1AP(this,1)&&Array.add(o,new _a.$5V(_nbs.NonBootStrings.l_BingPivotLabel_Text,$75B(this)));$1AP(this,4)&&Array.add(o,new _a.$5V(_nbs.NonBootStrings.l_PeoplePivotLabel_Text,$75C(this)));$1AP(this,8)&&Array.add(o,new _a.$5V(_nbs.NonBootStrings.l_RecentPivotLabel_Text,$75D(this)));this.set_$Lx(o);this.set_$8OJ(this.$Hz.length<=1);this.$Hz.length||this.set_$SA(-1);var c=!!t&&f.get_$L()==="Mouse"&&f.get_$9l();var y=this;this.$bi=new _d.$QK(t||function(){},c);if(!this.$1n5){var l=new _y.$2Q(_y.$d.get_$wa(),_y.$d.get_$1Zl(),_nbs.NonBootStrings.l_AcceptItemMobile_Text,this.$2nh);var a=new _y.$2Q(_y.$d.get_$9J(),_y.$d.get_$LH(),_nbs.NonBootStrings.l_CancelItemMobile_Text,this.$2wJ);var v=[l,a];this.set_$6k(_y.$22.$Aj(this,v,null))}};function $3bW(n){n.set_$6D(!0);$75F(n);_js.$8.$15(n.$bt)&&$1AP(n,8)&&n.set_$SA(n.$Hz.length-1);var t=this;$1qB(n,function(t){t.$2iz(n.$bt,n.$1J3)})}function $75F(n){n.$2IN=_js.$8.$15(n.$bt)||!($1AP(n,1)||$1AP(n,2))?0:-1;n.$2bg=_js.$8.$15(n.$bt)||!$1AP(n,4)?0:-1;n.$2cz=$1AP(n,8)?-1:0;$3(n,"TotalResults");n.$4Wt(n.get_$3Xr())}function $75E(n){var t=this;$1qB(n,function(t){t.$C9.get_$1p()&&t.$C9.get_$1p()!==n.$1mW&&t.$C9.set_$1p(null)})}function $4si(n){n.$CR=0;n.set_$4Z4(null);n.set_$1VV(null);var t=this;$1qB(n,function(n){n.$6XO()});$5(n.get_$7c())?n.get_$4h().$1I1(_d.$6Q.isInstanceOfType(n.get_$4h().get_$7T())?1:2):n.get_$7c()()}function $1qB(n,t){for(var r=n.$Hz,u=r.length,i=0;i<u;++i){var f=r[i];var e=f.$z;t(e)}}function $1AP(n,t){return(n.$6RP&t)===t}function $75C(n){var t=new _d.$Tr;t.$Rz=_pc.$15.$wy(0,12);t.$1An=_pc.$15.$1xe();t.$3M6=new _g.$SG("Default");t.$3M6.AdditionalProperties=[new _g.$1V("PersonaOfficeLocations"),new _g.$1V("PersonaBusinessAddresses"),new _g.$1V("PersonaHomeAddresses"),new _g.$1V("PersonaOtherAddresses")];var i=new _d.$Z3(t,n.$134,n.$B);i.add_$4Z5(n.$$d_$6Mx);i.add_$4Ti(n.$$d_$9XS);return i}function $75D(n){var t=new _d.$Z3(new _d.$x3(1),n.$134,n.$B);t.add_$4Z5(n.$$d_$6Mx);t.add_$4Ti(n.$$d_$9Z5);return t}function $75B(n){var i;i=$1AP(n,2)?2:6;var t=new _d.$m4(new _d.$x3(i),n.$nr,n.$134,n.$B,n.$6M);t.add_$4Z5(n.$$d_$6Mx);t.add_$4Ti(n.$$d_$9Mb);t.add_$5qv(n.$$d_$9Mc);n.get_$3Xr()||t.$Rf.add_$8TI(n.$$d_$59F);return t}_d.$6Q.prototype={$2nh:null,$2wJ:null,$4WF:null,$1wS:null,$6nm:null,$3YO:null,$bi:null,$6RP:0,$Hz:null,$CR:0,$2T5:!1,$1mW:null,$M4:null,$8X:!1,$nr:null,$134:null,$5q:null,$B:null,$JA:null,$6M:null,$2g2:!1,$1n5:!1,add_$4Yz:function(n){this.$4C.addHandler("SelectedLocationChanged",n)},remove_$4Yz:function(n){this.$4C.removeHandler("SelectedLocationChanged",n)},add_$2nv:function(n){this.$4C.addHandler("Activated",n)},remove_$2nv:function(n){this.$4C.removeHandler("Activated",n)},add_$3mn:function(n){this.$4C.addHandler("Closed",n)},remove_$3mn:function(n){this.$4C.removeHandler("Closed",n)},get_$4Z4:function(){return this.$1mW},set_$4Z4:function(n){this.$1mW&&this.$1mW.set_$2L(!1);this.$1mW=n;$75E(this);this.$1mW&&this.$1mW.set_$2L(!0);$3(this,"SelectedPlace");return n},get_$1VV:function(){return this.$M4},set_$1VV:function(n){this.$M4=n;$3(this,"SelectedLocation");return n},get_$Lx:function(){return this.$Hz},set_$Lx:function(n){this.$Hz=n;$3(this,"Options");return n},get_$SA:function(){return this.$CR},set_$SA:function(n){this.$CR=n;this.get_$3Xr()||this.$4Wt();this.set_$2eX(this.$bt);$3(this,"SelectedOptionIndex");return n},get_$8OJ:function(){return this.$2T5},set_$8OJ:function(n){if(this.$2T5!==n){this.$2T5=n;$3(this,"IsSingleOption")}return n},get_$4h:function(){return _y.$1Mq.prototype.get_$4h.call(this)},set_$4h:function(n){_y.$1Mq.prototype.set_$4h.call(this,n);var t=this;$1qB(this,function(t){t.set_$4h(n)});return n},get_$1kp:function(){return 1},get_$2PH:function(){return null},get_$7c:function(){return this.$JA},set_$7c:function(n){this.$JA=n;return n},get_$7sU:function(){return!1},get_$KN:function(){return this.$1n5?0:1},get_$A21:function(){return this.$1n5},set_$A21:function(n){if(this.$1n5===n)return n;this.$1n5=n;$3(this,"ShowToolbar");return n},get_$A1Y:function(){return this.$2g2},set_$A1Y:function(n){if(this.$2g2===n)return n;this.$2g2=n;$3(this,"ShowPreviewPanel");return n},get_$3Xr:function(){return!this.$2T5&&this.$B.get_$L()!=="TouchNarrow"},get_$eS:function(){return this.$bi.get_$eS()},get_$1I2:function(){return this.$bi.get_$1I2()},get_$2eX:function(){return this.$1VK},set_$2eX:function(n){if(this.$1VK!==n){this.$1VK=n;$3(this,"SearchDisplayText")}return n},get_$2Ao:function(){return this.$bt},set_$2Ao:function(n){if(this.$bt!==n){var t=this;$1qB(this,function(n){n.$9pi()})}this.$bt=n;this.set_$2eX(this.$bt);return n},get_$A8r:function(){if(this.$2IN>=0&&this.$2bg>=0&&this.$2cz>=0){this.set_$6D(!1);var n=this.$2IN+this.$2bg+this.$2cz;var t=n===1?_nbs.NonBootStrings.l_TotalResults_OnlyOne_Uppercase_Text:_nbs.NonBootStrings.l_TotalResults_ZeroOrMoreThanOne_Uppercase_Text;return String.format(t,n)}return _nbs.NonBootStrings.l_Searching_Text},get_$6D:function(){return this.$8X},set_$6D:function(n){if(this.$8X!==n){this.$8X=n;$3(this,"IsBusy")}return n},$9xT:function(n){var t=this;$1qB(this,function(t){t.$4bJ=n})},$FZ:function(){_y.$1Mq.prototype.$FZ.call(this);var n=this.$4C.getHandler("Activated");$5(n)||n()},$59F:function(){if(this.$M4){var n=this.$4C.getHandler("SelectedLocationChanged");$5(n)||n(this.$M4.get_$1u());$4si(this)}},$iq:function(){$4si(this)},$5M6:function(n){return _cc.$EQ.$3ox(n,this.$5q,this.$B,0,this.$3YO,!1)},$3ug:function(n,t){this.set_$6D(!0);if(!_js.$8.$15(n)&&$5(t))if(_y.$x.$w.get_$L()==="Mouse")this.$4AA(n);else{this.set_$2Ao(n);this.$nr.$5X7(this.$$d_$8B2,this.$$d_$8C4)}else this.$4AA(n,t)},$4AA:function(n,t){this.set_$2Ao(n||this.$1VK);t&&(this.$1J3=t);$3bW(this)},$ADb:function(){_js.$8.$15(this.$1VK)&&this.set_$2eX(this.$bt)},$4Wt:function(n){this.set_$4Z4(null);n||this.set_$1VV(null)},$TZ:function(){var n=this.$4C.getHandler("Closed");$5(n)||n()},$6Mx:function(n){this.set_$4Z4(n);this.set_$1VV(this.$5M6(n.get_$1u()))},$9Mb:function(n){this.$2IN=n;$3(this,"TotalResults")},$9XS:function(n){this.$2bg=n;$3(this,"TotalResults")},$9Z5:function(n){this.$2cz=n;$3(this,"TotalResults")},$8B2:function(n){this.$1J3=n;$3bW(this)},$8C4:function(n){$3bW(this)},$9Mc:function(n){this.$1J3=n;this.set_$2eX(this.$bt);this.set_$6D(!0)}};_d.$fi=function(n,t,i){this.$nr=n;this.$B=t;this.$6M=i};_d.$fi.prototype={$nr:null,$134:null,$5q:null,$B:null,$6M:null,$E:function(n,t){return new _d.$6Q(n,t,this.$nr,this.$134,this.$5q,this.$B,this.$6M)}};_d.$1M7=function(){this.$3F="";this.$29O=new _a.$AB;this.$2cm=0;this.$1IE=0};_d.$1M7.prototype={get_$7D:function(){return this.$3F},set_$7D:function(n){this.$3F=n||"";return n},get_$9l3:function(){return this.$29O},set_$9l3:function(n){this.$29O=n||new _a.$AB;return n}};_d.$rc=function(n,t){this.$5Qd=n;this.$5qL=t};_d.$rc.prototype={$5Qd:null,$5qL:null};_d.$yP=function(n){this.$5DJ=n};_d.$yP.prototype={$5DJ:null};_d.$r6=function(n,t){this.$z=n;this.$6Wb=t};_d.$r6.prototype={$z:null,$6Wb:!1};_d.$sw=function(n){this.$z=n};_d.$sw.prototype={$z:null};_d.$An=function(n,t,i,r,u){this.$$d_$5fb=Function.createDelegate(this,this.$5fb);this.$$d_$4Y9=Function.createDelegate(this,this.$4Y9);this.$$d_$9rz=Function.createDelegate(this,this.$9rz);this.$$d_$9QG=Function.createDelegate(this,this.$9QG);this.$$d_$tx=Function.createDelegate(this,this.$tx);this.$$d_$17Z=Function.createDelegate(this,this.$17Z);this.$$d_$1Ym=Function.createDelegate(this,this.$1Ym);_d.$An.initializeBase(this,[5,n]);this.$4U=i;this.$Ka=u;this.$E7=t;this.$iF=new _C(this.$$d_$1Ym,this.get_$1a());this.$1H=r};function $72h(n){if(!n.get_$Hu()){var t=[];var i=new _0365m.$o(_nbs.NonBootStrings.l_AttachmentSubmenuItem_LowerCase_Text,null,n.$iF,!1,null,_nbs.NonBootStrings.l_InsertAttachment_AT_MenuItem_Text);Array.add(t,i);if(n.$1H.get_$Bk()){n.$1PU=new _C(n.$$d_$5fb,n.get_$1a());n.$3MH=new _0365m.$o(_nbs.NonBootStrings.l_PictureSubmenuItem_LowerCase_Text,null,n.$1PU,!1,null,_nbs.NonBootStrings.l_InsertPicture_AT_MenuItem_Text);Array.add(t,n.$3MH);n.$4cD(n.$1C.$g.$d.get_$3s()==="HTML")}n.set_$Hu(new _0365m.$2c(t))}}function $4rD(n,t){t.get_$8j()||t.set_$8j(new _js.$c)}function $4rF(n){var i=n.$1C.$g;var t=i.$d;if($5(t)||!t.get_$Eb()){_js.Trace.logInfo(_a.$0.$l,"Show not allowed to add attachment due to context="+(t?"non-null":"null")+"; Upgraded="+t.get_$Eb());i.$1v.$2u(0,_nbs.NonBootStrings.l_AddingAttachmentNotAllowed_Text,null);return!1}return!0}function $72i(n,t){if(n.$Ka){var i=this;n.$Ka.$E(function(i){n.$rJ=i;n.$rJ&&n.$rJ.$VM(n.get_$60(),t,!1)})}}function $4rE(n){return n.$4U.$3N("AttachmentsFilePicker")}_d.$An.prototype={$4U:null,$1H:null,$Ka:null,$E7:null,$iF:null,$1PU:null,$3MH:null,$1tx:null,$1fI:!1,$rJ:null,get_$Hu:function(){return this.$W(_d.$An.$1FZ)},set_$Hu:function(n){this.$M(_d.$An.$1FZ,n);return n},add_$4O7:function(n){this.$2G("AttachmentWellInitialized",n)},remove_$4O7:function(n){this.$2H("AttachmentWellInitialized",n)},get_$60:function(){return this.$W(_d.$An.$3jH)},set_$60:function(n){this.$M(_d.$An.$3jH,n);return n},get_$Bz:function(){return this.get_$60()?this.get_$60().get_$Bz():!1},get_$G5:function(){return this.get_$60()&&this.get_$60().get_$1P()?this.get_$60().get_$1P().get_$C()>0:!1},get_$5KK:function(){return this.$1tx},set_$5KK:function(n){this.$1tx=n;$N(this,"CopyPasteViewModel");return n},$41:function(){var n=this.$1C.$g.$d;$72h(this);var i=!n.get_$Eb()||n.get_$2Pr();var r=n.get_$8j();var u=!((n.get_$3w()===4||n.get_$3w()===13)&&!this.$1H.get_$Bk());if(this.get_$60()){this.get_$60().$3OC(n.get_$9x(),r,i,n.get_$7t(),n.get_$1Ys());this.$5IV(n,i)}else{var t=this;this.$E7.$E(function(f){_y.$x.$w.get_$L()==="TouchNarrow"?t.set_$60(f.$1aa(n.get_$9x(),r,i,u,n.get_$1Ys(),!0,t.$1C.$g.$x,n.get_$7t())):t.set_$60(f.$1aZ(n.get_$9x(),r,i,_y.$x.$w.get_$L()==="Mouse"?3:0,u,n.get_$1Ys(),!0,t.$1C.$g.$x,n.get_$7t()));t.get_$60().add_$17Z(t.$$d_$17Z);t.get_$60().add_$tx(t.$$d_$tx);t.get_$60().apcl("EditorCallContext",t.$$d_$9QG);var e=t.$1C.$3c(14);e&&t.get_$60().add_$4jK(e.$$d_$bq);$KL(t,"AttachmentWellInitialized",t);t.$5IV(n,i)})}},$9QG:function(n,t){if(t==="EditorCallContext"){var i=this.$1C.$3c(27);i.set_$Jn(this.get_$60().get_$Jn())}},$4cD:function(n){this.$3MH&&this.$3MH.set_$r(!n)},$tx:function(n){if(_a.$61.$2v){var t=this;_js.$J.get_$I().$40(_a.$0.$In,"TriggerPolicyTipsIfNeeded",function(){var n=t.$1C.$3c(25);n.$1KF(8)})}},$17Z:function(){var t=this.$1C.$g;var n=t.$d;if(n.get_$9x()){$4rD(this,n);this.get_$60()&&this.get_$60().$18V(n.get_$9x(),n.get_$8j(),n.get_$1Ys())}else{var i=this.$1C.$3c(8);i.$1dx("Attach",this.$$d_$9rz,this.$$d_$4Y9,!1)}},$6o1:function(){if(!this.$1fI&&this.get_$60()){var n=this.$1C.$g.$d;this.get_$60().$18V(n.get_$9x(),n.get_$8j(),n.get_$1Ys());if(n.$WE)if(n.get_$8j()){var t=new _js.$c;t.$6S(n.get_$8j().$6W());n.$WE.set_$8j(t);n.get_$J1()&&n.get_$J1().set_$8j(t)}else{n.$WE.set_$8j(null);n.get_$J1()&&n.get_$J1().set_$8j(null)}this.get_$60().set_$QH(n.get_$QH());if(this.get_$G5()&&this.get_$60().get_$QH()){var u=this;var r=function(){_js.Trace.logInfo(_a.$0.$3i,"MoveAttachmentsFromServerToClient will be started when MailComposeAttachmentComponent is upgraded.");var n=u.get_$60();_js.$J.get_$I().$1s(_a.$0.$b8,"MailComposeAttachmentComponent.Upgrade",n.$$d_$3HR||(n.$$d_$3HR=Function.createDelegate(n,n.$3HR)),800)};if(n.$d8&&n.$2Ro)r();else{var i=null;var f=this;i=function(t,u){if(n.$d8&&n.$2Ro){n.remove_$83(i);r()}};n.add_$83(i)}}this.$1fI=!0}},$AG:function(){var n=this.get_$60();if(n){n.remove_$17Z(this.$$d_$17Z);n.remove_$tx(this.$$d_$tx);n.rpcl("EditorCallContext",this.$$d_$9QG);_d.$4x.$F8(this.$1C)}this.$1fI=!1;_d.$9q.prototype.$AG.call(this)},$81Q:function(){var n=null;if(_a.UserAgent.getInstance().get_$2Hx()&&!_a.UserAgent.getInstance().get_$6n()){n=[];Array.add(n,new _y.$32(_nbs.NonBootStrings.l_AttachmentSubmenuItem_LowerCase_Text,this.$iF));this.$1H.get_$Bk()&&this.$1C.$g.$d.get_$3s()==="HTML"&&Array.add(n,new _y.$32(_nbs.NonBootStrings.l_PictureSubmenuItem_LowerCase_Text,this.$1PU))}return n},$8HO:function(){if(this.get_$G5()&&$4rE(this)){for(var n=new(_a.$3f.$$(_y.$du)),t=0;t<this.get_$60().get_$1P().get_$C();t++){var i=this.get_$60().get_$1P().get_$3o(t);_g.$9w.isInstanceOfType(i.get_$93())&&n.$D(i)}if(n.get_$C()>0){var r=new _d.$yP(n);var u=this.$1C.$3c(27);u.set_$Jn(r)}}},$1Ym:function(){var n=this.$1C.$g;var t=n.$d;_js.Trace.logInfo(_a.$0.$l,"Insert attachment start");if($4rF(this)&&this.get_$60())if(t.get_$QH()){_js.Trace.logInfo(_a.$0.$3i,"Opening S/MIME's file picker to attach file.");this.get_$60().$6ON(!1)}else if(this.$4U&&$4rE(this)&&_y.$x.$w.get_$L()!=="TouchNarrow"){var i=_a.$6.$1X(_a.$0.$1P,"AttachmentsFilePickerPanelOpen",!0);_js.Trace.logInfo(_a.$0.$l,"Opening OWA's file picker");$72i(this,i)}else{_js.Trace.logInfo(_a.$0.$l,"Opening OS's file picker");this.get_$60().$u9(!1,null,null)}_js.Trace.logInfo(_a.$0.$l,"Insert attachment end")},$5fb:function(){var n=this.$1C.$g;var t=n.$d;_js.Trace.logInfo(_a.$0.$l,"Insert picture start");if($4rF(this)&&this.get_$60())if(t.get_$QH()){_js.Trace.logInfo(_a.$0.$3i,"Opening S/MIME's file picker to insert picture.");this.get_$60().$6ON(!0)}else this.get_$60().$u9(!0,null,null);_js.Trace.logInfo(_a.$0.$l,"Insert picture end")},$5IV:function(n,t){this.get_$60().set_$44M(!n.get_$Eb());_js.Trace.logInfo(_a.$0.$l,"Attachment component initialized, ReadOnly={0}",t);this.set_$5KK(_d.$bB.$5LO(_y.$x.$w,this.$E7,this.get_$60(),this.get_$1a()));n.get_$Eb()&&this.$6o1();_d.$9q.prototype.$41.call(this)},$9rz:function(n){var i=this.$1C.$g;var t=i.$d;if(n.$5H===t.get_$7t()){$4rD(this,t);this.get_$60()&&this.get_$60().$18V(t.get_$9x(),t.get_$8j(),t.get_$1Ys())}},$4Y9:function(n){var t=this.$1C.$g;var i=t.$d;if(this.get_$60()&&n.$5H===i.get_$7t()){this.get_$60().$6Vv();t.$1v.$2u(0,_nbs.NonBootStrings.l_WarningFileCanNotBeAttachedDisconnected_Text,null)}}};_d.$1Ap=function(n,t,i){this.$$d_$7cP=Function.createDelegate(this,this.$7cP);this.$$d_$7cQ=Function.createDelegate(this,this.$7cQ);this.$$d_$9Ll=Function.createDelegate(this,this.$9Ll);this.$$d_$7cO=Function.createDelegate(this,this.$7cO);_d.$1Ap.initializeBase(this,[n,t,i]);this.$1oL=new _d.$1Ax(this.$$d_$7cO,6e4)};_d.$1Ap.prototype={$1oL:null,$41:function(){var n=this.$1C.$g;var t=n.$d;if(!t.$2g5){this.$y();_js.Trace.logInfo(_a.$0.$l,"Auto save timer started")}_d.$9q.prototype.$41.call(this);n.$J.$Hd(_a.$P1,this.$$d_$9Ll)},$7cO:function(){var t=this.$1C;var i=t.$g;var n=i.$d;if(!n.$2g5){if(!n.get_$47Q()){_js.Trace.logInfo(_a.$0.$l,"Auto Save not supported for the current operation {0}",n.get_$3w());return}var f=t.$3c(5);_js.Trace.logInfo(_a.$0.$l,"Checking dirty before auto save");var r=i.$FQ();var u=f.get_$Bz();if(r&&!u){_js.Trace.logInfo(_a.$0.$l,"AutoSave:Context:"+n.toString());this.$1oL.$1t();this.$1dx("AutoSave",this.$$d_$7cQ,this.$$d_$7cP,!1)}else{this.$1oL.$y();_js.Trace.logInfo(_a.$0.$l,"Skip auto save since IsDirty={0}, AttachmentInProgress={1}",r,u)}}},$y:function(){var n=this.$1C.$g.$d;!n.$2g5&&n.get_$47Q()&&this.$1oL.$y()},$AG:function(){this.$1oL.$1t();var n=this.$1C.$g;n.$J.$11q(_a.$P1,this.$$d_$9Ll);_d.$6l.prototype.$AG.call(this)},$49:function(){var n=this.$1C.$g;n.$J.$11q(_a.$P1,this.$$d_$9Ll)},$9Ll:function(n){_js.$J.get_$I().$40(_a.$0.$l,"Autosave triggered for PAL OnPause event",this.$$d_$7cO)},$7cQ:function(n){var t=this.$1C;var i=t.$g;var r=i.$d;r.$2g5||this.$1oL.$y()},$7cP:function(n){_js.Trace.logInfo(_a.$0.$l,"AutoSaveActionFailed: Error: {0}",n.$1d.message);this.$1C.$g.$d.$2g5||this.$1oL.$y()}};_d.$DY=function(n){this.$$d_$9wi=Function.createDelegate(this,this.$9wi);this.$$d_$A13=Function.createDelegate(this,this.$A13);this.$$d_$9Ri=Function.createDelegate(this,this.$9Ri);this.$$d_$4iL=Function.createDelegate(this,this.$4iL);_d.$DY.initializeBase(this,[3,n])};_d.$DY.$5KZ=function(n,t){return new _y.$32(n,t)};_d.$DY.$2u1=function(n,t){return new _0365m.$o(n,null,t,!0)};function $72s(n){if("Mouse"===_y.$x.$w.get_$L()){var r=n.$AJQ(_0365m.$o,_d.$DY.$2u1);r&&(n.$DU=new _0365m.$2c(r))}else if(!n.$1eR){if(!n.$cL){var u=n.$AJQ(_y.$32,_d.$DY.$5KZ);u&&(n.$cL=new _y.$32(_nbs.NonBootStrings.l_SetPermissions_LowerCase_Text,null,u))}if(n.$cL){var f=n.$1C.$g.$3y;var i=f.$14;if(i)for(var t=0;t<i.length;t++)if(_nbs.NonBootStrings.l_ImportanceMenuItem_LowerCase_Text===i[t].$2E){f.$2oJ(n.$cL,t+1);n.$1eR=!0}}}}function $4rH(n,t){var i=this;return function(){_a.$6.stPT(_a.$0.$l,"MailComposeSetIRM",3);var h=_a.$6.$1X(_a.$0.$l,"MailComposeSetIRM",!0);var e=n.$1C.$g;var i=e.$d;i.set_$Ps(t);if(i.get_$LW()){e.$x.$5Z(3800);_d.$4x.$F8(n.$1C);i.set_$LW(!1);i.set_$R9(null);i.set_$Pq(null);i.set_$UE(null)}for(var s=e.$aF.RmsTemplates,o=0;o<s.length;o++){var u=s[o];if(t.toLowerCase()===u.Id.toLowerCase()){$5(i.get_$5r())&&i.set_$5r(new _g.$gS);var r=i.get_$5r();r.set_$4Xe(t);r.set_$1N3(_g.$V.get_$I().get_$2z().get_$AM());r.set_$9X(!0);r.set_$HX(0);r.set_$1oA(u.Name);r.set_$1o8(u.Description);r.set_$3s(i.get_$3s());if("Mouse"===_y.$x.$w.get_$L()){var f=e.$wz();f.$5Z(4499);f.$5Z(4500);f.$2j.apply(f,[4499].concat([u.Name,u.Description]));f.$2j.apply(f,[4500].concat([r.get_$1N3()]))}n.set_$2SE(!0);_js.Trace.logInfo(_a.$0.$l,"Set IRM "+u.Name);break}}_a.$6.$19(h);_a.$6.endPT("MailComposeSetIRM")}}function $4rG(n,t){var i=this;return function(){var u=n.$1C.$g;var i=u.$d;i.set_$Ps(t);if(!$5(i.get_$5r())&&"Mouse"===_y.$x.$w.get_$L()){var o=u.$wz();o.$5Z(4499);o.$5Z(4500);i.set_$5r(null);n.set_$2SE(!1)}for(var s=u.$aF.MessageClassifications,f=0;f<s.length;f++){var r=s[f];if(t.toLowerCase()===r.Id.toLowerCase()){i.set_$LW(!0);i.set_$R9(r.Name);i.set_$Pq(r.Description);i.set_$UE(r.Id);var e=u.$wz();e.$5Z(3800);e.$2j.apply(e,[3800].concat([r.Name,r.Description]));_js.Trace.logInfo(_a.$0.$l,"Set class "+r.Name);break}}}}function $72t(n,t,i,r){if($5(n.$9w)){n.set_$ip(new _y.$M8);n.$9w.$7W.$D(new _a.$2E(n.$9w.$4f,_nbs.NonBootStrings.l_Close1_Text))}n.$9w.set_$4o(t);$5(n.$2R9)&&(n.$2R9=new _d.$yj);n.$2R9.set_$in(i);n.$2R9.set_$7jA(String.format(_nbs.NonBootStrings.l_IrmConversationOwner_Text,r));n.$9w.set_$DT(n.$2R9);n.$9w.set_$1O(!0)}_d.$DY.prototype={$DU:null,$cL:null,$1Q2:!1,$2gI:null,$9w:null,$2R9:null,$1eR:!1,get_$2SE:function(){return this.$1Q2},set_$2SE:function(n){if(this.$1Q2!==n){this.$1Q2=n;$N(this,"IsIrmProtected")}return n},get_$A14:function(){return this.$2gI},set_$A14:function(n){if(this.$2gI!==n){this.$2gI=n;$N(this,"ShowIrmInformationCommand")}return n},get_$ip:function(){return this.$9w},set_$ip:function(n){if(this.$9w!==n){this.$9w=n;$N(this,"DialogViewModel")}return n},$41:function(){var n=this.$1C.$g;var i=n.$d;var e=n.$3y;var r=n.$aF;if(this.$3ls())if(_g.$1Y.$N2){_js.Trace.logInfo(_a.$0.$l,"Checking main window for compliance configuration");this.$cL=_d.$DY.$4AG;_g.$1Y.$N2.$85F(this.$$d_$4iL)}else if(r.WasLoadedFromServer)this.$4iL(r);else{_js.Trace.logInfo(_a.$0.$l,"Adding the loading permissions menu item");this.$cL=_d.$DY.$4AG;if(!r.IsLoadingFromServer){_js.Trace.logInfo(_a.$0.$l,"Submitting GetComplianceConfigurationAction");var o=n.$J;o.$Hd(_a.$XP,this.$$d_$9Ri);var s=new _h.$XO(r,n.$J);s.$s()}}else if(this.$cL&&this.$1eR&&e.$14){n.$3y.$3OU(this.$cL);this.$1eR=!1}var t=i.get_$5r();this.set_$2SE(!!t&&!t.get_$HX());if(this.$1Q2&&"Mouse"===_y.$x.$w.get_$L()){var u=n.$wz();u.$2j.apply(u,[4499].concat([t.get_$1oA(),t.get_$1o8()]));u.$2j.apply(u,[4500].concat([t.get_$1N3()]))}else if(i.get_$LW()){var f=n.$wz();f.$2j.apply(f,[3800].concat([i.get_$R9(),i.get_$Pq()]))}"Mouse"===_y.$x.$w.get_$L()||this.$2gI||this.set_$A14(new _C(this.$$d_$A13,this.get_$1a()));_d.$9q.prototype.$41.call(this)},$AG:function(){this.set_$2SE(!1);_d.$9q.prototype.$AG.call(this)},$3ls:function(){var t=_g.$V.get_$I();if(!$5(t.get_$5z())&&!t.get_$5z().get_$2R8()){_js.Trace.logInfo(_a.$0.$l,"IRM segmentation flag has been turned off, user cannot set compliance.");return!1}var n=this.$1C.$g.$d.get_$5r();var i=!n||!!n.get_$HX()||n.get_$9X()||n.get_$2y7();_js.Trace.logInfo(_a.$0.$l,"CanSetCompliance="+i);return i},$AJQ:function(n,t){var i=this.$1C.$g.$aF;var o=i.RmsTemplates?i.RmsTemplates.length:0;var s=i.MessageClassifications?i.MessageClassifications.length:0;if(0===o&&0===s){_js.Trace.logInfo(_a.$0.$l,"There are neither RmsTemplates nor message classifications available, skip setup of the compliance sub context menu.");return null}var r=new Array(1+o+s);var u=0;r[u++]=t(_nbs.NonBootStrings.l_NoRestriction_Text,new _C(this.$$d_$9wi,this.get_$1a()));for(var f=0,e=0;f<o||e<s;)if(f===o){var l=i.MessageClassifications[e++];r[u++]=t(l.Name,new _C($4rG(this,l.Id),this.get_$1a()))}else if(e===s){var a=i.RmsTemplates[f++];r[u++]=t(a.Name,new _C($4rH(this,a.Id),this.get_$1a()))}else{var h=i.MessageClassifications[e];var c=i.RmsTemplates[f];if(0<c.Name.localeCompare(h.Name)){r[u++]=t(h.Name,new _C($4rG(this,h.Id),this.get_$1a()));e++}else{r[u++]=t(c.Name,new _C($4rH(this,c.Id),this.get_$1a()));f++}}return r},$9Ri:function(n){var t=this.$1C.$g;this.$4iL(t.$aF);t.$J.$11q(_a.$XP,this.$$d_$9Ri)},$4iL:function(n){var i=this.$1C.$g;i.$aF=n;_js.Trace.logInfo(_a.$0.$l,"Updating menu with complete compliance configuration.");if("Mouse"!==_y.$x.$w.get_$L()){this.$cL&&i.$3y.$3OU(this.$cL);this.$cL=null;this.$1eR=!1}n.WasLoadedFromServer&&$72s(this);if("Mouse"===_y.$x.$w.get_$L()){var t=this.$1C.$3c(18);if(t.get_$Hu()){var r=t.$1xU(_nbs.NonBootStrings.l_LoadingPermissions_LowerCase_Text);r>=0&&t.get_$Hu().$14.$6C(r);n.WasLoadedFromServer&&t.$7Yw()}}},$9wi:function(){var i=this.$1C.$g;var n=i.$d;_js.Trace.logInfo(_a.$0.$l,"Set no restriction");n.set_$Ps("0");var t=i.$wz();if($5(n.get_$5r())){if(n.get_$LW()){t.$5Z(3800);n.set_$LW(!1);n.set_$R9(null);n.set_$Pq(null);n.set_$UE(null)}}else{if("Mouse"===_y.$x.$w.get_$L()){t.$5Z(4499);t.$5Z(4500)}n.set_$5r(null);this.set_$2SE(!1)}},$A13:function(){var t=this.$1C.$g.$d;if(t.get_$5r()){var n=t.get_$5r();$72t(this,n.get_$1oA(),n.get_$1o8(),n.get_$1N3())}else _js.Trace.logError(_a.$0.$l,"ShowIrmInformation was triggered without pre-existing license data or compliance entry selected.")}};_d.$9q=function(n,t){_d.$9q.initializeBase(this);this.$7iG=n;this.$1C=t;if(t&&t.$g){this.$g=t.$g;this.$d_2=this.$g.$d;this.$d5=this.$g.$x}};function $1q8(n){n.$d5.$9oB();n.$d5.$Db(_d.$6l.$TX);n.$d5.$Db(_d.$7F.$TX);n.$d5.$Db(_d.$Bv.$TX);n.$g.$1TZ.$9nM(n.$d5);_d.$4x.$F8(n.$1C)}function $3b5(n){if(!n.$d_2.$WE)return!0;_js.Trace.logInfo(_a.$0.$l,"Comparing initial baseline to baseline. Context:"+n.$d_2.toString());if(!n.$d_2.$WE.$4i(n.$d_2.get_$J1()))return!0;_js.Trace.logInfo(_a.$0.$l,"Checking dirty before showing discard confirmation.");return n.$g.$FQ()?!0:n.$d_2.get_$rd()?!0:!1}function $72u(n,t,i){try{var u=_a.$j.$18D(!0,!0,!1,!1,!1);if(u)if(_a.$2N.$15n(u))n.$1rS(u);else throw u;_js.Trace.logInfo(_a.$0.$3i,"S/MIME choosing a cert...");var s=_a.$j.$rV();var f;var e=_g.$V.get_$I();f=e.get_$Tr().AllowUserChoiceOfSigningCertificate&&e.get_$13().get_$39x()?e.get_$13().get_$2gl():null;_js.Trace.logInfo(_a.$0.$3i,"Choosing a cert. KeyUsage={0}, KeyIdentifier={1}",t,f);var o=JsonParser.deserialize(s.GetSigningCertificate(f));if(o.ErrorCode)throw _a.$2N.$E(_u.Strings.l_Smime_CannotGetSubjectCertFromStore_Text,o.ErrorCode);else return o.Data}catch(r){_js.Trace.logWarning(_a.$0.$3i,r.message);if(_a.$2N.$yj(r)){_a.$2N.$X3(r,i);n.$1rS(r);return null}else{_js.Trace.logException(_a.$0.$3i,r,"An error occurred when choosing cert.");throw r;}}}function $4rI(n){var a=$72v(n,n.$d_2.get_$I8(),n.$d_2.get_$Fk());a=a||"SMIMEComposeUndefinedCtq";var et=_a.$6.$1X(_a.$0.$3i,a,!0);var ot=n.$d_2.get_$3w();var st=n.$d_2.get_$66();var p=!1;var w=!1;var b=!1;var k=!1;var d=!1;var g=!1;var f=0;try{var nt=_a.$j.$18D(!0,!0,!1,!1,!1);if(nt&&!_a.$2N.$15n(nt)){$72w(n,nt);throw nt;}_js.Trace.logInfo(_a.$0.$3i,"Building S/MIME data package...");var e=_g.$V.get_$I().get_$Tr();p=e.AlwaysSign;w=e.AlwaysEncrypt;b=_g.$V.get_$I().get_$13().get_$2gu();k=_g.$V.get_$I().get_$13().get_$2gq();d=e.ClearSign;g=e.TripleWrapSignedEncryptedMail;_js.Trace.logInfo(_a.$0.$3i,"Admin.AlwaysEncrypt="+w);_js.Trace.logInfo(_a.$0.$3i,"Admin.AlwaysSign="+p);_js.Trace.logInfo(_a.$0.$3i,"Admin.IsClearSign="+d);_js.Trace.logInfo(_a.$0.$3i,"Admin.TripleWrap="+g);_js.Trace.logInfo(_a.$0.$3i,"User.AlwaysEncrypt="+k);_js.Trace.logInfo(_a.$0.$3i,"User.AlwaysSign="+b);_js.Trace.logInfo(_a.$0.$3i,"User.SigningCert="+_g.$V.get_$I().get_$13().get_$3Tc());_js.Trace.logInfo(_a.$0.$3i,"User.SigningCertId="+_g.$V.get_$I().get_$13().get_$2gl());_js.Trace.logInfo(_a.$0.$3i,"Context.Encrypt="+n.$d_2.get_$Fk());_js.Trace.logInfo(_a.$0.$3i,"Context.Sign="+n.$d_2.get_$I8());var o;if(_d.$7F.isInstanceOfType(n)&&n.$d_2.get_$Fk()){var u=n.$g.get_$Kx();var ht=u.$Lb?u.$B1.$4X.$8i:u.$B1.$Wu.$8i;var ct=u.$Lb?u.$B5.$4X.$8i:u.$B5.$Wu.$8i;var lt=u.$Lb?u.$Bs.$4X.$8i:u.$Bs.$Wu.$8i;var kt=ht?ht.get_$C():0;var dt=ct?ct.get_$C():0;var gt=lt?lt.get_$C():0;var ut=kt+dt;o=n.$d_2.$c3?n.$d_2.$c3===1?n.$d_2.$30l(0,ut):n.$d_2.$c3===2?n.$d_2.$30l(ut+n.$d_2.$1NJ,1):n.$d_2.$c3===3?n.$d_2.$30l(ut,gt):null:n.$d_2.get_$6h9()}else o=null;var s=_a.$j.$rV();var v=null;var h=n.$g.get_$a0().get_$60().get_$1P();var c=n.$d_2.$5Kf();if(c.get_$3s()==="HTML"){c.set_$1n(_a.$3T.$4WH(c.get_$1n(),!0));if(h&&h.get_$C()>0){var at=new(_0365f.$n.$$(_y.$du));var ui=this;h.$Bd(function(n){var i=n;var t=i.get_$93();if(t.get_$6K()&&c.get_$1n().indexOf(t.get_$H7())<0){_js.Trace.logInfo(_a.$0.$3i,"Removing unreferenced inline attachment: {0}",t.get_$H7());at.$D(i)}});for(var vt=at.get_$3O(),ni=vt.length,ft=0;ft<ni;++ft){var ti=vt[ft];n.$g.get_$a0().get_$60().$18c(ti,!1)}}}var yt=null;if(h&&h.get_$C()>0){var tt=new(_0365f.$n.$$(String));var fi=this;h.$Bd(function(n){var r=n;var t=r.get_$93();if(!t.get_$yi())if(_g.$5d.isInstanceOfType(t)){var i=t;i.set_$Bw(i.get_$Bw()||"application/octet-stream");var u=i.get_$6K()?i.get_$H7():"";var f=i.get_$CZ();tt.$D(u+">"+i.get_$1N()+">"+i.get_$Bw()+">"+f)}else if(_g.$8z.isInstanceOfType(t)){var e=t;tt.$D(">>>"+e.get_$JM())}else if(_g.$8L.isInstanceOfType(t)){var o=t;var s=o.get_$JM();tt.$D(">>>"+s)}});yt=tt.get_$3O().join("|")}var t=new MimeHeader;var pt,wt,bt;n.$g.get_$Kx().$86w(pt={val:t.From},wt={val:t.To},bt={val:t.Cc});t.From=pt.val;t.To=wt.val;t.Cc=bt.val;t.Subject=n.$d_2.get_$2i();switch(n.$d_2.get_$6Y()){case"Normal":t.Importance="Normal";t.Priority=3;break;case"High":t.Importance="High";t.Priority=1;break;case"Low":t.Importance="Low";t.Priority=5;break;default:t.Importance=n.$d_2.get_$6Y();t.Priority=3;break}switch(n.$d_2.get_$8F()){case"Normal":t.Sensitivity="Normal";break;case"Confidential":t.Sensitivity="Confidential";break;case"Personal":t.Sensitivity="Personal";break;case"Private":t.Sensitivity="Private";break;default:t.Sensitivity=n.$d_2.get_$8F();break}t.Date=_a.$7.$5Vw(_a.$7.get_$2F());t.IsReadReceiptRequested=n.$d_2.get_$G8();t.IsDeliveryReceiptRequested=n.$d_2.get_$Gi();if(n.$d_2.get_$LW()){t.IsClassified=n.$d_2.get_$LW();t.ClassificationKeep=n.$d_2.get_$1Md();t.ClassificationGuid=n.$d_2.get_$UE();t.Classification=n.$d_2.get_$R9();t.ClassificationDescription=n.$d_2.get_$Pq()}var i=new SmimeInfo;i.Header=t;i.BodyType=c.get_$3s()==="HTML"?2:1;i.Body=c.get_$1n();i.Attachments=yt;if(n.$d_2.get_$I8()&&!n.$d_2.get_$Fk()){_js.Trace.logInfo(_a.$0.$3i,"Signing only...");var ii=e.ClearSign?s.ClearSign(JsonParser.serialize(i),n.$d_2.get_$1Je()):s.OpaqueSign(JsonParser.serialize(i),n.$d_2.get_$1Je());var it=JsonParser.deserialize(ii);if(it.ErrorCode){f=it.ErrorCode;throw _a.$2N.$X3(_a.$2N.$E(_u.Strings.l_Smime_CannotSign_Text,it.ErrorCode),13);}else v=it.Data}else if(!n.$d_2.get_$I8()&&n.$d_2.get_$Fk()){_js.Trace.logInfo(_a.$0.$3i,"Encrypting only...");var ri=s.Encrypt(JsonParser.serialize(i),o?o.join("|"):null);var rt=JsonParser.deserialize(ri);if(rt.ErrorCode){f=rt.ErrorCode;throw _a.$2N.$X3(_a.$2N.$E(_u.Strings.l_Smime_CannotEncrypt_Text,rt.ErrorCode),14);}else v=rt.Data}else if(n.$d_2.get_$I8()&&n.$d_2.get_$Fk()){_js.Trace.logInfo(_a.$0.$3i,"Signing... 1st round");var y=s.OpaqueSign(JsonParser.serialize(i),n.$d_2.get_$1Je());var r=JsonParser.deserialize(y);if(r.ErrorCode){f=r.ErrorCode;throw _a.$2N.$X3(_a.$2N.$E(_u.Strings.l_Smime_CannotSign_Text,r.ErrorCode),13);}else{i.Body=r.Data;i.BodyType=3;i.Attachments=null;_js.Trace.logInfo(_a.$0.$3i,"Encrypting... 2nd round");y=s.Encrypt(JsonParser.serialize(i),o?o.join("|"):null);r=JsonParser.deserialize(y);if(r.ErrorCode){f=r.ErrorCode;throw _a.$2N.$X3(_a.$2N.$E(_u.Strings.l_Smime_CannotEncrypt_Text,r.ErrorCode),14);}else if(e.TripleWrapSignedEncryptedMail){i.Body=r.Data;i.BodyType=3;i.Attachments=null;_js.Trace.logInfo(_a.$0.$3i,"Signing... 3rd round");y=s.OpaqueSign(JsonParser.serialize(i),n.$d_2.get_$1Je());r=JsonParser.deserialize(y);if(r.ErrorCode){f=r.ErrorCode;throw _a.$2N.$X3(_a.$2N.$E(_u.Strings.l_Smime_CannotSign_Text,r.ErrorCode),13);}else v=r.Data}else v=r.Data}}_a.$6.$19(et,a,"",null,$4rJ(n,ot,st,p,w,b,k,d,g));_js.Trace.logInfo(_a.$0.$3i,"S/MIME data package built successfully.");n.$d_2.set_$6h8(v);return!0}catch(l){_js.Trace.logWarning(_a.$0.$3i,l.message);_a.$6.$19(et,a,f+"_"+l.message,null,$4rJ(n,ot,st,p,w,b,k,d,g));if(_a.$2N.$yj(l)){n.$1rS(l);return!1}else{_js.Trace.logException(_a.$0.$3i,l,"Unknown exception occurred when building S/MIME content.");n.$1rS(_a.$2N.$E(l.message,11));return!1}}}function $4rJ(n,t,i,r,u,f,e,o,s){var h=new _a.$6I;h.$6w("O",_y.$Hk.toString(t));h.$6w("M",_y.$lB.toString(i));h.$w9("AS",r);h.$w9("AE",u);h.$w9("UAS",f);h.$w9("UAE",e);h.$w9("CS",o);h.$w9("TW",s);return h.toString()}function $72v(n,t,i){var r=null;t&&!i?_d.$7F.isInstanceOfType(n)?r="SMIMESendSign":_d.$6l.isInstanceOfType(n)&&(r="SMIMESaveSign"):!t&&i?_d.$7F.isInstanceOfType(n)?r="SMIMESendEncrypt":_d.$6l.isInstanceOfType(n)&&(r="SMIMESaveEncrypt"):t&&i&&(_d.$7F.isInstanceOfType(n)?r="SMIMESendSignAndEncrypt":_d.$6l.isInstanceOfType(n)&&(r="SMIMESaveSignAndEncrypt"));return r}function $72w(n,t){_d.$7F.isInstanceOfType(n)?_a.$2N.$X3(t,2):_d.$6l.isInstanceOfType(n)&&_a.$2N.$X3(t,3)}_d.$9q.prototype={$7iG:0,$1C:null,$g:null,$d_2:null,$d5:null,$7j:!1,get_$D2:function(){return this.$7j},set_$D2:function(n){this.$7j=n;return n},get_$1a:function(){return _a.$0.$l},$41:function(){this.$7j=!0},$AG:function(){this.$7j=!1},$59r:function(n){var t=this.$83Z(n);this.$d5.$2j(t,null);(t===55||t===50)&&this.$g.$1TZ.$59p(this.$d5);_d.$4x.$F8(this.$1C)},$1rS:function(n){this.$d5.$12F(n);_d.$4x.$F8(this.$1C)},$3hA:function(n,t){for(var r=[],i=2;i<arguments.length;++i)r[i-2]=arguments[i];var u;(u=this.$d5).$OF.apply(u,[t,n].concat(r));_d.$4x.$F8(this.$1C)},$83Z:function(n){throw Error.notImplemented(String.format("GetErrorInfoBarMessageId is not implemented for type {0}",Object.getType(this)));}};_d.$Pw=function(n,t,i,r,u,f,e){this.$$d_$9pO=Function.createDelegate(this,this.$9pO);this.$$d_$5eo=Function.createDelegate(this,this.$5eo);this.$1aE=[];this.$5Io=new _d.$1Aq(this,t,i,r,u,f,e);this.$g=n};function $4rK(n,t,i){if($5(i)||!i)for(var r=0;r<n.$1aE.length;r++)$4rL(n,t,r);else for(var u=n.$1aE.length-1;u>=0;u--)$4rL(n,t,u)}function $4rL(n,t,i){var r=n.$1aE[i];$5(r)||t(r,i)}_d.$Pw.prototype={$1aE:null,$g:null,$5Io:null,$3c:function(n){var t=n;$5(this.$1aE[t])&&(this.$1aE[t]=this.$5Io.$7km(n,this.$g.$B.get_$L()));return this.$1aE[t]},$41:function(){$4rK(this,this.$$d_$5eo)},$AG:function(){_js.Trace.logInfo(_a.$0.$l,"Component Map Reset start.");$4rK(this,this.$$d_$9pO,!0);_js.Trace.logInfo(_a.$0.$l,"Component Map Reset end.")},$5eo:function(n,t){_d.$8a.isInstanceOfType(n)||n.get_$D2()||n.$41()},$9pO:function(n,t){var i=Object.getType(n).getName();if(n.get_$D2()){_js.Trace.logInfo(_a.$0.$l,"Reset "+i+" at index "+t);n.$AG()}else _js.Trace.logInfo(_a.$0.$l,"Skip uninitialized "+i+" at index "+t)}};_d.$Px=function(n){this.$$d_$A8V=Function.createDelegate(this,this.$A8V);this.$$d_$A8S=Function.createDelegate(this,this.$A8S);this.$$d_$A8U=Function.createDelegate(this,this.$A8U);_d.$Px.initializeBase(this,[17,n])};function $4rM(n){var t=null;var i,r;if(r=_a.$1d.$1aT(_a.UserAgent.getInstance(),n.$1C.$g.$d.get_$DF(),i={val:t}),t=i.val,r){n.$1C.$g.$d.set_$Nu(t);n.set_$4eV(t);n.set_$4eV(null);n.$1C.$g.get_$1Bq().$6gY();var u=n.$1C.$3c(5);u.$4cD(!1);u.get_$60().$A10();n.$1C.$g.$d.set_$3s("Text");_js.Trace.logInfo(n.get_$1a(),"MailComposeContentConversionComponent.ToPlainText succeeded.")}else _js.Trace.logWarning(n.get_$1a(),"MailComposeContentConversionComponent.ToPlainText failed because of ConvertFromHtmlToText error.")}function $4rN(n,t){_js.Trace.logInfo(n.get_$1a(),"Checking if the email has been upgraded which is a pre-requisite of content conversion.");if(!n.$1C.$g.$d.get_$Eb()){n.$1C.$g.$1v.$2u(0,t,null);_js.Trace.logInfo(n.get_$1a(),"Conversion is not available because the email has not yet been upgraded.");return!1}return!0}_d.$Px.prototype={$4gW:null,$4gc:null,$4eU:null,$4eS:null,get_$4eV:function(){return this.$4eU},set_$4eV:function(n){this.$4eU=n;$N(this,"SwitchToPlainTextContent");return n},get_$4eT:function(){return this.$4eS},set_$4eT:function(n){this.$4eS=n;$N(this,"SwitchToHtmlContent");return n},$41:function(){this.$4gc||(this.$4gc=new _C(this.$$d_$A8U,this.get_$1a()));this.$4gW||(this.$4gW=new _C(this.$$d_$A8S,this.get_$1a()));_d.$9q.prototype.$41.call(this)},$A8V:function(n,t){n&&$4rM(this)},$A8U:function(){_js.Trace.logInfo(this.get_$1a(),"User chose to convert to plain text");if($4rN(this,_nbs.NonBootStrings.l_CannotConvertToPlainTextUntilMessageIsLoaded_Text)){this.$1C.$g.$d.$J8.$s();var t=this.$1C.$g.$d.get_$DF();var n;var i,r;var u=(r=_a.$1d.$3nz(t,i={val:n}),n=i.val,r);if(!u){n=t;_js.Trace.logInfo(this.get_$1a(),"Using html due to failed conversion")}if(n.length>0){var f=this.$1C.$g.$1v;f.$2u(1,_nbs.NonBootStrings.l_ConvertToPlainTextWarning_Text,this.$$d_$A8V)}else $4rM(this)}},$A8S:function(){_js.Trace.logInfo(this.get_$1a(),"User chose to convert to html");if($4rN(this,_nbs.NonBootStrings.l_CannotConvertToHtmlUntilMessageIsLoaded_Text)){var i=this.$1C;var n=i.$g;var t=n.$d;t.$30s.$s();var u=n.$d.get_$19f();t.set_$3s("HTML");var r=_a.$1d.$1Bw(u);t.set_$Nu(r);this.set_$4eT(r);this.set_$4eT(null);n.get_$1Bq().$6gZ();var f=i.$3c(5);f.$4cD(!0);_js.Trace.logInfo(this.get_$1a(),"MailComposeContentConversionComponent.ToHtml succeeded.")}}};_d.$Rk=function(n){_d.$Rk.initializeBase(this,[18,n]);this.$59=_g.$V.get_$I().get_$13();this.$d=this.$1C.$g.$d};_d.$Rk.prototype={$3Vz:null,$3Vt:null,$59:null,$d:null,get_$Hu:function(){return this.$W(_d.$Rk.$1FZ)},set_$Hu:function(n){this.$M(_d.$Rk.$1FZ,n);return n},$6gY:function(){this.$3Vt.set_$r(!1);this.$3Vz.set_$r(!0)},$6gZ:function(){this.$3Vt.set_$r(!0);this.$3Vz.set_$r(!1)},$41:function(){if("Mouse"===_y.$x.$w.get_$L()){var t=[];var n;if(this.$d.get_$3w()!==8&&!this.$d.get_$jh()&&!_y.$x.$w.get_$W5()){var e=this.$1C.$3c(8);n=new _0365m.$o(_nbs.NonBootStrings.l_SaveMenuItem_LowerCase_Text,null,e.$DO);Array.add(t,n)}var i=this.$1C.$3c(1);if(!this.$d.get_$jh()){n=new _0365m.$o(_nbs.NonBootStrings.l_ShowBccMenuItemText_LowerCase_Text,null,i.$3ST);_g.$V.get_$I().get_$13().get_$1Lg()&&n.set_$r(!0);Array.add(t,n);n=new _0365m.$o(_nbs.NonBootStrings.l_HideBccMenuItemText_LowerCase_Text,null,i.$413);_g.$V.get_$I().get_$13().get_$1Lg()||n.set_$r(!0);Array.add(t,n)}if(this.$d.get_$2T0()||this.$d.get_$QH()){var l=this.$1C.$3c(1);n=new _0365m.$o(_nbs.NonBootStrings.l_ShowFromMenuItemText_LowerCase_Text,null,i.$2gG);(_g.$V.get_$I().get_$13().get_$iA()||this.$d.get_$Uf())&&n.set_$r(!0);Array.add(t,n);i.$2gG.set_$69(!this.$d.get_$QH());n=new _0365m.$o(_nbs.NonBootStrings.l_HideFromMenuItemText_LowerCase_Text,null,i.$41A);_g.$V.get_$I().get_$13().get_$iA()||this.$d.get_$Uf()||n.set_$r(!0);Array.add(t,n)}if(!this.$d.get_$jh()&&!_y.$x.$w.get_$W5()){n=new _0365m.$o(_nbs.NonBootStrings.l_CheckNamesMenuItem_LowerCase_Text,null,i.$18f);Array.add(t,n)}var u=this.$1C.$3c(6);if(!$5(u.$DU)){n=new _0365m.$HH(_nbs.NonBootStrings.l_ImportanceMenuItem_LowerCase_Text,null,u.$DU);Array.add(t,n)}var r=this.$1C.$3c(3);if(r.$DU){n=new _0365m.$HH(_nbs.NonBootStrings.l_SetPermissions_LowerCase_Text,null,r.$DU);Array.add(t,n)}else if(r.$3ls()&&this.$1C.$g.$aF.IsLoadingFromServer){n=new _0365m.$o(_nbs.NonBootStrings.l_LoadingPermissions_LowerCase_Text,null,null);Array.add(t,n)}if(!_y.$x.$w.get_$W5()){var o=this.$1C.$3c(12);var s=this.$1C.$3c(5);n=new _0365m.$o(_nbs.NonBootStrings.l_SignatureMenuItem_LowerCase_Text,null,o.$3hU);s.get_$Hu().$14.$D(n)}var f=this.$1C.$3c(17);this.$3Vz=new _0365m.$o(_nbs.NonBootStrings.l_ConvertToPlainText_LowerCase_Text,null,f.$4gc);Array.add(t,this.$3Vz);this.$3Vt=new _0365m.$o(_nbs.NonBootStrings.l_ConvertToHtml_Text,null,f.$4gW,!0);Array.add(t,this.$3Vt);this.$d.get_$3s()==="HTML"?this.$6gZ():this.$6gY();if(!this.$d.get_$jh()){var h=this.$1C.$3c(10);n=new _0365m.$o(_nbs.NonBootStrings.l_ShowMessageOptions_Text,null,h.$2CA);Array.add(t,n)}var c=this.$1C.$3c(18);c.set_$Hu(new _0365m.$2c(t))}_d.$9q.prototype.$41.call(this)},$ADp:function(){var n=this.get_$Hu().$14.get_$3o(this.$1xU(_nbs.NonBootStrings.l_ShowBccMenuItemText_LowerCase_Text));var t=this.get_$Hu().$14.get_$3o(this.$1xU(_nbs.NonBootStrings.l_HideBccMenuItemText_LowerCase_Text));n.set_$r(this.$d.get_$nW());t.set_$r(!this.$d.get_$nW())},$6np:function(){var n=this.get_$Hu().$14.get_$3o(this.$1xU(_nbs.NonBootStrings.l_ShowFromMenuItemText_LowerCase_Text));var t=this.get_$Hu().$14.get_$3o(this.$1xU(_nbs.NonBootStrings.l_HideFromMenuItemText_LowerCase_Text));n.set_$r(this.$d.get_$Uf());t.set_$r(!this.$d.get_$Uf())},$1xU:function(n){var i=this.get_$Hu().$14;if(i)for(var t=0;t<i.get_$C();t++)if(n===i.get_$3o(t).$2E)return t;return-1},$7Yw:function(){var n=this.$1C.$3c(3);if(!$5(n.$DU)){var t=this.$1xU(_nbs.NonBootStrings.l_ImportanceMenuItem_LowerCase_Text);if(t>=0){var i=new _0365m.$HH(_nbs.NonBootStrings.l_SetPermissions_LowerCase_Text,null,n.$DU);this.get_$Hu().$14.$6r(t+1,i)}}}};_d.$UZ=function(n){this.$$d_$32F=Function.createDelegate(this,this.$32F);this.$$d_$3sJ=Function.createDelegate(this,this.$3sJ);this.$$d_$A0V=Function.createDelegate(this,this.$A0V);_d.$UZ.initializeBase(this,[21,n]);this.$EW=new _C(this.$$d_$A0V,this.get_$1a());this.$HA=n.$g.$HA};function $4rX(n,t,i){n.$32F();var r=n.$1C.$g;var u=r.$d.get_$1EQ()||r.$d.get_$rd();n.$HA.$3sM(t,i,r.$k,u)}function $734(n){if($5(n.$13g)){_js.Trace.logInfo(_a.$0.$l,"Creating discard confirm dialog.");var t=new _js.$c;t.$D(new _a.$2E(new _C(n.$$d_$3sJ,n.get_$1a()),_u.Strings.l_ConfirmDialog_Discard_Text,_u.Strings.l_DeleteConfirmDialogButtonDescription_Text));t.$D(new _a.$2E(new _C(n.$$d_$32F,n.get_$1a()),_u.Strings.l_ConfirmDialog_DontDiscard_Text,_u.Strings.l_ReturnToMessageForEditing_Text));n.set_$5Pr(t)}}_d.$UZ.prototype={$EW:null,$HA:null,$13g:null,$1EE:!1,get_$5Pr:function(){return this.$13g},set_$5Pr:function(n){if(n!==this.$13g){this.$13g=n;$N(this,"DiscardConfirmDialogButtonData")}return n},get_$1zq:function(){return this.$1EE},set_$1zq:function(n){if(n!==this.$1EE){this.$1EE=n;$N(this,"IsDiscardConfirmDialogShown")}return n},$3sJ:function(){var i=this.$1C;var t=i.$g;var n=t.$d;_js.Trace.logInfo(_a.$0.$l,"Discard and close");t.set_$yW(!0);if(n.get_$3w()||!n.get_$3w()&&(n.get_$9x()||t.get_$ui().$Cd)){_js.Trace.logInfo(_a.$0.$l,"Discard");$4rX(this,n.get_$7t(),n.get_$9x())}n.set_$J1(null);var r=i.$3c(2);r.get_$4h().$2Zi(t,!1);_js.Trace.logInfo(_a.$0.$l,"Navigated away from compose")},$3PP:function(n,t){if(this.$HA.$jI(n)){_js.Trace.logInfo(_a.$0.$l,"Resuming discard of "+_h.$E0.$xr(t));$4rX(this,n,t)}else _js.Trace.logInfo(_a.$0.$l,"User had already discarded.")},$A0V:function(){var t=this.$1C.$g;var n=t.$d;_js.Trace.logInfo(_a.$0.$l,"User chose to discard");if($3b5(this)){$734(this);_js.Trace.logInfo(_a.$0.$l,"Toggle IsDiscardConfirmDialogShown flag to show the dialog. Context:"+n.toString());this.set_$1zq(!0)}else{_js.Trace.logInfo(_a.$0.$l,"User hit discard, we determined there's no need to show confirmation dialog, calling discard and navigating away. Context:"+n.toString());this.$3sJ()}},$32F:function(){_js.Trace.logInfo(_a.$0.$l,"Toggle IsDiscardConfirmDialogShown flag to hide the dialog. Context:"+this.$1C.$g.$d.toString());this.set_$1zq(!1)}};_d.$1As=function(n){_d.$1As.initializeBase(this,[27,n])};_d.$1As.prototype={$aO:null,get_$Jn:function(){return this.$aO},set_$Jn:function(n){this.$aO=n;$N(this,"EditorCallContext");return n}};_d.$KD=function(n){this.$$d_$9wZ=Function.createDelegate(this,this.$9wZ);this.$$d_$9wj=Function.createDelegate(this,this.$9wj);this.$$d_$9w1=Function.createDelegate(this,this.$9w1);_d.$KD.initializeBase(this,[6,n])};_d.$KD.$5KZ=function(n,t){return new _y.$32(n,t)};_d.$KD.$2u1=function(n,t){return new _0365m.$o(n,null,t,!0)};function $2l4(n,t){n.$1C.$g.$d.set_$6Y(t);n.set_$8Kw("High"===t);n.set_$8Me("Normal"===t);n.set_$8M5("Low"===t)}_d.$KD.prototype={$DU:null,$cL:null,$45M:!1,$36M:!1,$464:!1,get_$8Kw:function(){return this.$45M},set_$8Kw:function(n){if(n!==this.$45M){this.$45M=n;$N(this,"IsHighImportance")}return n},get_$8Me:function(){return this.$36M},set_$8Me:function(n){if(n!==this.$36M){this.$36M=n;$N(this,"IsNormalImportance")}return n},get_$8M5:function(){return this.$464},set_$8M5:function(n){if(n!==this.$464){this.$464=n;$N(this,"IsLowImportance")}return n},$41:function(){var n=this.$1C.$g.$d.get_$6Y();$2l4(this,n);_js.Trace.logInfo(_a.$0.$l,"Importance component initialized and importance set to {0}",n);if("Mouse"===_y.$x.$w.get_$L()){if(!this.$DU){var t=this.$AJQ(_0365m.$o,_d.$KD.$2u1);t&&(this.$DU=new _0365m.$2c(t))}}else if(!this.$cL){var i=this.$AJQ(_y.$32,_d.$KD.$5KZ);i&&(this.$cL=new _y.$32(_nbs.NonBootStrings.l_ImportanceMenuItem_LowerCase_Text,null,i))}_d.$9q.prototype.$41.call(this)},$9w1:function(){var n=_a.$6.$1X(_a.$0.$l,"MailComposeSetImp",!0);_js.Trace.logInfo(_a.$0.$l,"User sets high importance");$2l4(this,"High");_a.$6.$19(n)},$9wj:function(){_js.Trace.logInfo(_a.$0.$l,"User sets normal importance");$2l4(this,"Normal")},$9wZ:function(){var n=_a.$6.$1X(_a.$0.$l,"MailComposeSetImp",!0);_js.Trace.logInfo(_a.$0.$l,"User sets low importance");$2l4(this,"Low");_a.$6.$19(n)},$AJQ:function(n,t){return[t(_nbs.NonBootStrings.l_HighImportanceButtonText_Text,new _C(this.$$d_$9w1,this.get_$1a())),t(_nbs.NonBootStrings.l_NormalImportanceButtonText_Text,new _C(this.$$d_$9wj,this.get_$1a())),t(_nbs.NonBootStrings.l_LowImportanceButtonText_Text,new _C(this.$$d_$9wZ,this.get_$1a()))]}};_d.$rb=function(n,t){this.$$d_$2wC=Function.createDelegate(this,this.$2wC);this.$$d_$4aR=Function.createDelegate(this,this.$4aR);this.$$d_$4cY=Function.createDelegate(this,this.$4cY);_d.$rb.initializeBase(this,[26,n]);this.$LY=_h.$4G.$3xy(t)};function $737(n){if(_h.$4G.$2RA){_js.Trace.logInfo(_a.$0.$4d,"Link preview feature is disabled.  Skipping GetLinkPreview action for {0}",n.$Y1.Url);n.$2wC();return}if(n.$Y1){var i=1;var r=_a.$6.$1X(_a.$0.$4d,"GetComposeLinkPreview",!0);var t=[];Array.add(t,n.$Y1);_js.Trace.logInfo(_a.$0.$4d,"Preparing GetLinkPreview action for {0}",n.$Y1.Url);n.$Y1.Autoplay=!0;var u=new _h.$4G(n.$Y1);_js.Trace.logInfo(_a.$0.$4d,"Submitting GetLinkPreview action for {0}",n.$Y1.Url);var f=this,e=this;n.$1C.$g.$k.$pZ(u,function(u){_h.$4G.$6d6(u,n.$$d_$4aR,n.$$d_$2wC,i,r,"GetComposeLinkPreview",t)},function(n){_h.$4G.$5SR(n,i,r,"GetComposeLinkPreview",t)},null)}}_d.$rb.prototype={$Y1:null,$1F7:null,$LY:!1,$v4:!1,$vm:null,$OA:null,get_$1Q4:function(){return this.$LY},set_$1Q4:function(n){if(n!==this.$LY){this.$LY=n;$N(this,"IsLinkPreviewEnabled")}return n},get_$3y3:function(){return this.$Y1},set_$3y3:function(n){if(n!==this.$Y1){this.$Y1=n;$737(this)}return n},get_$22M:function(){return this.$1F7},set_$22M:function(n){this.$1F7=n;$N(this,"LinkPreviewResponse");return n},get_$1AC:function(){return this.$OA},set_$1AC:function(n){if(n!==this.$OA){this.$OA=n;this.$OA&&_h.$4G.$40B(this.$OA,null,this.$$d_$4cY,null)}return n},get_$2CJ:function(){return this.$v4},set_$2CJ:function(n){if(this.$v4!==n){this.$v4=n;$N(this,"ShowYouTubePlayer")}return n},get_$4kF:function(){return this.$vm},set_$4kF:function(n){this.$vm=n;$N(this,"YouTubePlayerUrl");return n},$4aR:function(n){this.set_$22M(n)},$2wC:function(){this.set_$1Q4(!1)},$4cY:function(n){this.set_$4kF(n);this.set_$2CJ(!!this.$vm)}};_d.$DX=function(n){_d.$DX.initializeBase(this,[16,n])};function $72r(n){n.$x.$Db(_d.$DX.$6SF);$72j(n)}function $72n(n){var t=n.$1C.$g.$d;var i=t.get_$Ch()||t.get_$Sn();return i&&t.get_$WK()?i:null}function $72q(n){if(_g.$2o.isInstanceOfType(n.$wP))return n.$wP.get_$Jd();else if(_g.$Ro.isInstanceOfType(n.$wP)){var t=n.$wP;return t.get_$Kh().get_$Jd()==="RecurringMaster"?t.get_$JF()?"RecurringMaster":"Occurrence":t.get_$Kh().get_$Jd()}else throw Error.argument("this.Item","Unsupported calendaring type:"+Object.getType(n.$wP).getName());}function $72j(n){if(n.$wP){$72l(n);if(!_g.$Q4.isInstanceOfType(n.$wP)){n.$x.$2j(6800);switch($72q(n)){case"Occurrence":case"Exception":$72m(n);break;case"RecurringMaster":$72k(n);break}}}}function $72o(n,t){var i;switch(t){case 8:i=3200;break;case 3:i=3205;break;case 5:i=3210;break;case 6:i=3215;break;case 7:i=3220;break;default:throw Error.argument("operation","Unsupported mail compose operation on an occurrence: "+t);}return i}function $72p(n,t){var i;switch(t){case 8:i=3100;break;case 3:i=3105;break;case 5:i=3110;break;case 6:i=3115;break;case 7:i=3120;break;default:throw Error.argument("operation","Unsupported mail compose operation on a series: "+t);}return i}function $72k(n){var t=$72p(n,n.$2t5);n.$x.$2j(t)}function $72m(n){var t=new _cc.$az;var i=t.$2x(n.$wP,null);var r=$72o(n,n.$2t5);n.$x.$2j(r,i)}function $72l(n){if(_g.$CY.isInstanceOfType(n.$wP)){var i=n.$wP;var r=i.get_$34o()&&!!i.get_$1Ug();if(r){var t=-1;switch(n.$2t5){case 5:t=3250;break;case 7:t=3260;break;case 6:t=3255;break}t!==-1&&n.$x.$2j(t,i.get_$1Ug().Mailbox.Name)}}}_d.$DX.prototype={$x:null,$2t5:0,$wP:null,$41:function(){_d.$9q.prototype.$41.call(this);this.$wP=$72n(this);var n=this.$1C.$g;this.$x=n.$wz();this.$2t5=n.$d.get_$3w();_d.$90.$5m4(n.$d)&&!n.$d.get_$47P()&&$72r(this)}};_d.$8a=function(n,t){this.$$d_$87T=Function.createDelegate(this,this.$87T);this.$$d_$9Rl=Function.createDelegate(this,this.$9Rl);this.$$d_$7x6=Function.createDelegate(this,this.$7x6);this.$$d_$7yD=Function.createDelegate(this,this.$7yD);this.$$d_$9S5=Function.createDelegate(this,this.$9S5);this.$$d_$6HJ=Function.createDelegate(this,this.$6HJ);this.$$d_$9S4=Function.createDelegate(this,this.$9S4);this.$$d_$3Iu=Function.createDelegate(this,this.$3Iu);this.$$d_$9Rk=Function.createDelegate(this,this.$9Rk);this.$$d_$9Oa=Function.createDelegate(this,this.$9Oa);_d.$8a.initializeBase(this,[0,n]);this.$HA=n.$g.$HA;this.$1H=t;this.set_$3li(!0)};function $4ra(n,t){if(n.$d_2.get_$1Ed()&&n.$d_2.get_$pz()){_js.Trace.logInfo(_a.$0.$l,"Capture initial baseline for a loaded draft.");n.$d_2.$WE=_d.$1m.$1tF(n.$d_2)}_js.Trace.logInfo(_a.$0.$l,"Finish 1st init for a loaded draft.");$2FM(n);var i=this;_js.$J.get_$I().$40(_a.$0.$l,"TriggerPolicyTipsIfNeeded",function(){var t=n.$1C.$3c(25);t.$1KF(32)})}function $2FM(n){var t=n.$1C;var r=t.$g;var i=r.$d;var u=i.get_$3w();t.$3c(7).$41();t.$3c(8).$41();t.$3c(1).$41();i.get_$WK()&&t.$3c(16).$41();var f=_y.$x.$w.get_$L();u&&u!==11||!n.$1H.get_$Bk()||i.get_$Nu()||i.set_$Nu("");i.get_$NA()&&t.$3c(12).$41();f!=="Mouse"?t.$3c(11).$41():t.$3c(24).$41();if(r.$T0){_js.Trace.logInfo(_a.$0.$l,"Begin 2nd init in finish 1st because we are already in view.");n.$5Dx()}n.set_$D2(!0);_a.$6.aces(n.$5qI)}function $3b9(n,t){var r=n.$1C.$g;var i=r.$d;var e=r.$k;if(i.get_$1Ed()){if(i.get_$pz()){_js.Trace.logInfo(_a.$0.$l,"Capture initial baseline since message was a clean new message before popout, context: "+i.toString());i.$WE=_d.$1m.$1tF(i)}i.get_$nj()&&!i.get_$Eb()&&$3b7(n,!0)}else i.set_$1EQ(!0);r.$x.$5Z(3400);r.$x.$2j(3400,null);i.get_$2SX()&&r.$x.$2j(3480);var u=n.$1H.get_$Bk()&&i.get_$3s()==="HTML"?_h.$v.get_$1gC():_h.$v.get_$2Uv();var o="MailCompose";var f=r.$Ve.$3op(t,u,o);f.$5H=i.get_$7t();e.$pZ(f,n.$$d_$9Rl,n.$$d_$9Rk,n.$$d_$3Iu);_js.Trace.logInfo(_a.$0.$l,"Loading draft with ID="+_h.$E0.$xr(t)+"; Shape="+u.BodyType+"; Layout="+_y.$x.$w.get_$L()+"; ContextBodyType="+i.get_$3s())}function $3b7(n,t){if(t!==n.$4iY){var i=n.$1C.$g.$x;i.$5Z(3440);t&&i.$2j(3440,null);_d.$4x.$F8(n.$1C);n.$4iY=t}}function $3b8(n){var r=n.$1C;var i=r.$g.$d;var t=i.get_$3w();var u=1===t||2===t||3===t||12===t;if(u&&!i.get_$9x()&&!i.get_$Eb()){var f=r.$3c(13);f.$7cn()}}function $4rb(n){var t=n.$1C.$g.$d.get_$7t();_js.Trace.logInfo(_a.$0.$l,"Calling main window to process save result "+t);_g.$1Y.$N2.$87S(t,_a.$42.$1Kh,n.$$d_$87T)}_d.$8a.prototype={$HA:null,$37G:!1,$2rp:!1,$4iY:!1,$5qI:null,$1H:null,get_$D2:function(){return _d.$9q.prototype.get_$D2.call(this)},set_$D2:function(n){if(n!==_d.$9q.prototype.get_$D2.call(this)){_d.$9q.prototype.set_$D2.call(this,n);$N(this,"IsInitialized")}this.$1C.$g.$d.$5mi=n;return n},get_$5le:function(){return this.$37G},set_$5le:function(n){if(n!==this.$37G){this.$37G=n;$N(this,"IsSecondInitializationComplete")}return n},get_$3li:function(){return this.$2rp},set_$3li:function(n){if(this.$2rp!==n){this.$2rp=n;$N(this,"CanLoadPopoutSuccessfully")}return n},$41:function(){this.$5qI=_a.$6.acss(_a.$0.$l,"VM.MailCompose.FirstInit");var i=this.$1C.$g;var n=i.$d;if(!n.$WE&&!n.get_$9x()){_js.Trace.logInfo(_a.$0.$l,"Capture initial baseline for a non draft without existing initial baseline, context: "+n.toString());n.$WE=_d.$1m.$1tF(n);n.get_$1Ed()||n.set_$pz(!0)}if(n.get_$as()){_js.Trace.logInfo(_a.$0.$l,"Finish 1st init for complete context");$2FM(this);_js.Trace.logInfo(_a.$0.$l,"Check begin upgrade for complete context");$3b8(this)}else{var u=i.$k;var r=n.get_$9x();var t=n.get_$dv();var f=n.get_$6iV();if(!r&&f){var o;var e=_g.$V.get_$I().get_$2z();o=_js.$8.$a(e.get_$eQ())?e.get_$AM()||"":e.get_$b6()||"";var c=new _g.$Sz("StoreId",f,o);var l=new _c.$wF([c],"EwsId");u.$pZ(l,this.$$d_$9Oa,this.$$d_$9Rk,this.$$d_$3Iu);_js.Trace.logInfo(_a.$0.$l,"Calling server to convert id, storeId="+f)}else if(r)if(n.get_$2El()&&n.get_$1Ed()){_js.Trace.logInfo(_a.$0.$l,"The message was saving prior to popout, check for save result from main window");$4rb(this)}else{_js.Trace.logInfo(_a.$0.$l,"Load draft "+_h.$E0.$xr(r));$3b9(this,r)}else if((4===n.get_$3w()||13===n.get_$3w())&&n.get_$1Ed()){_js.Trace.logInfo(_a.$0.$l,"Loading draft without id for the popout from inline case, check id from main window");$4rb(this)}else if(t){i.$x.$5Z(3400);i.$x.$2j(3400,null);if(n.get_$15W()){var a=_cc.$Gu.$Fx(t,n.get_$s8());var s=new _cc.$Gu(200,a);s.$5H=n.get_$7t();u.$pZ(s,this.$$d_$9S4,this.$$d_$6HJ,this.$$d_$3Iu);_js.Trace.logInfo(_a.$0.$l,"Loading original calendar item with ID={0}, ChangeKey={1}",t.Id,t.ChangeKey)}else{var h=i.$Ve.$3op(t);h.$5H=n.get_$7t();u.$pZ(h,this.$$d_$9S5,this.$$d_$6HJ,this.$$d_$3Iu);_js.Trace.logInfo(_a.$0.$l,"Loading original message item with ID={0}, ChangeKey={1}",t.Id,t.ChangeKey)}}else if(0===n.get_$3w()||11===n.get_$3w()){n.set_$Eb(!0);n.set_$as(!0);_js.Trace.logInfo(_a.$0.$l,"Finish 1st init for new mail");$2FM(this)}else{_y.$2V.$19(n.get_$Qd(),null,"ErrorNoDraftOrOriginalItemId");n.set_$Qd(null);throw Error.invalidOperation(String.format("Cannot perform operation {0} without either draft ID or original item ID",_js.$1i.$9S(_y.$Hk,n.get_$3w())));}}_js.$8.$a(_g.$V.get_$I().get_$2z().get_$eQ())||i.$x.$2j(95,null)},$AG:function(){this.set_$D2(!1);this.set_$5le(!1);this.set_$3li(!0);this.$4iY=!1},$5Dx:function(){var i=this.$1C;var r=i.$g;var t=r.$d;var u=t.get_$3w();var n=null;switch(u){case 0:n="MailComposeNew";break;case 1:n="MailComposeReply";break;case 2:n="MailComposeReplyAll";break;case 3:n="MailComposeForward";break;case 4:n="MailComposeEditDraft";break;case 12:n="MailComposePostReply";break}n&&_a.$6.endPT(n);if(t.get_$Qd()){_y.$2V.$19(t.get_$Qd());t.set_$Qd(null)}_js.Trace.logInfo(_a.$0.$l,"Queue 2nd init task, context:"+t.toString());_js.$J.get_$I().$40(_a.$0.$l,"Delayed MailCompose Secondary Init",this.$$d_$7yD);if(r.get_$2RE()&&!r.$3y.$14){var f=i.$3c(11);_js.Trace.logInfo(_a.$0.$l,"Queue appbar setup task");_js.$J.get_$I().$40(_a.$0.$l,"SetupApplicationBarMenu",f.$$d_$9xt)}var e=i.$3c(19);_js.Trace.logInfo(_a.$0.$l,"Queue GetMailTips if needed task");_js.$J.get_$I().$40(_a.$0.$l,"TriggerMailTipsIfNeeded",e.$$d_$A9b)},$9Rl:function(n){var u=this.$1C.$g.$d;var c=this.$g.get_$5Pq();var i=n;var r=n.$5H;_js.Trace.logInfo(_a.$0.$l,"Got draft, checking pending discards for "+r);if(this.$HA.$jI(r))c.$3PP(r,i.get_$i());else if(r===this.$d_2.get_$7t()){var t=i.$Ge;if(_g.$Vb.isInstanceOfType(t)){this.$d_2.$5eu(t);$3b7(this,!0);$4ra(this,i)}else{var s=this;var e=function(){u.$ADs(t.get_$1ta());u.$42T(t);$3b7(s,!1);$4ra(s,i)};if(_a.$j.$2v&&t.get_$G9()){_js.Trace.logInfo(_a.$0.$3i,"The draft is a S/MIME message.");var l=this;var h=function(n){_js.Trace.logWarning(_a.$0.$l,n.message);if(_a.$2N.$yj(n)){l.$1rS(n);_y.$2V.$19(u.get_$Qd(),null,n.message,i.$AJc());u.set_$Qd(null)}e()};var f=_a.$j.$18D(!0,!0,!1,!1,!1);f&&(_a.$2N.$15n(f)?f=null:h(f));var o=new _h.$GG(200,t);var v=this,y=this;this.$g.$k.$pZ(o,function(){t.set_$8m(null);t.set_$3U(null);t.set_$5in(!0);e()},function(){_a.$2N.$X3(o.$1d,4);h(o.$1d)},null)}else e()}if(_a.$61.$2v){var a=this;_js.$J.get_$I().$40(_a.$0.$l,"TriggerPolicyTipsIfNeeded",function(){var n=a.$1C.$3c(25);n.$1KF(32)})}}else _js.Trace.logInfo(_a.$0.$l,"Skipping get draft processing since action context "+r+" doesn't match current context "+this.$d_2.toString())},$9S4:function(n){var r=this.$1C;var u=r.$g;var t=u.$d;var i=n.$5H;if(i===t.get_$7t()&&!this.$HA.$jI(i)){var f=n;t.$yB(f.$v);t.set_$s8(!1);_js.Trace.logInfo(_a.$0.$l,"Got original cal item, finish 1st init with context:"+t.toString());$2FM(this);_js.Trace.logInfo(_a.$0.$l,"Check begin upgrade on original cal item");$3b8(this)}},$9S5:function(n){var r=this.$1C;var u=r.$g;var t=u.$d;var i=n.$5H;if(i===t.get_$7t()&&!this.$HA.$jI(i)){var f=n;t.$yB(f.$Ge);_js.Trace.logInfo(_a.$0.$l,"Got original message, finish 1st init with context: "+t.toString());$2FM(this);_js.Trace.logInfo(_a.$0.$l,"Check begin upgrade on original message item");$3b8(this)}},$9Rk:function(n){var u=this.$1C;var i=u.$g;var t=i.$d;var r=n.$5H;r!==t.get_$7t()||this.$HA.$jI(r)||i.$k.$194(n,_nbs.NonBootStrings.l_OpenDraftFailureMessage_Text,_nbs.NonBootStrings.l_OpenDraftFailureMessageDisconnected_Text,_nbs.NonBootStrings.l_OpenDraftFailureMessage_Text,_u.Strings.l_ErrorRequestTimeout_Text,this.$$d_$7x6);var f=_d.$B6.$1xS(n.$1d)||"GetDraftFailure_UnknownError";var e=_d.$B6.$1co(n.$1d);_y.$2V.$19(t.get_$Qd(),null,f,n.$AJc(),e);t.set_$Qd(null);_a.$6.endPT("MailComposeEditDraft")},$6HJ:function(n){var u=this.$1C;var i=u.$g;var t=i.$d;var r=n.$5H;r!==t.get_$7t()||this.$HA.$jI(r)||i.$k.$6ej(n,this.$$d_$7x6);var f=_d.$B6.$1xS(n.$1d)||"GetItemFailure_UnknownError";var e=_d.$B6.$1co(n.$1d);_y.$2V.$19(t.get_$Qd(),null,f,n.$AJc(),e);t.set_$Qd(null)},$7x6:function(n,t){var i=this.$1C.$3c(2);i.get_$4h().$2Zi(this.$1C.$g,!1);_js.Trace.logInfo(_a.$0.$l,"Navigate away on action failure")},$3Iu:function(n){var t=this.$1C.$g;var i=t.$d;if(n.$5H===i.get_$7t()){t.$x.$5Z(3400);_d.$4x.$F8(this.$1C)}},$7yD:function(){var i=_a.$6.acss(_a.$0.$l,"VM.MailCompose.SecondInit");var t=this.$1C;var r=t.$g;var n=r.$d;n.get_$3w()||n.get_$Nu()||n.set_$Nu("");t.$3c(2);t.$41();n.get_$J1()||n.$5SD();this.set_$5le(!0);_a.$6.aces(i);_a.$6.endPT(null);_js.Trace.logInfo(_a.$0.$l,"Finish 2nd init, context:"+n.toString())},$9Oa:function(n){var i=n;var t=new _g.$1t(i.get_$5K2().Id);this.$1C.$g.$d.set_$9x(t);$3b9(this,t)},$87T:function(n){var t=this.$1C.$g.$d;if(n){var i=JsonParser.deserialize(n);_js.Trace.logInfo(_a.$0.$l,"Resume loading draft after main window successfully saved item: "+i.Id);t.get_$nj()&&!t.get_$Eb()&&t.set_$Eb(!0);$3b9(this,i)}else{_js.Trace.logInfo(_a.$0.$l,"Save failed on the main window for this popout, show failure message.");this.set_$3li(!1);_y.$2V.$19(t.get_$Qd(),null,"ErrorSaveFailedOnMainWindow");t.set_$Qd(null)}}};_d.$Bv=function(n,t){this.$$d_$5TC=Function.createDelegate(this,this.$5TC);this.$$d_$9ry=Function.createDelegate(this,this.$9ry);this.$$d_$9hl=Function.createDelegate(this,this.$9hl);this.$$d_$4Y9=Function.createDelegate(this,this.$4Y9);this.$$d_$6ZP=Function.createDelegate(this,this.$6ZP);this.$$d_$9Ip=Function.createDelegate(this,this.$9Ip);this.$$d_$9eA=Function.createDelegate(this,this.$9eA);_d.$Bv.initializeBase(this,[9,n]);this.$6O3=new _C(this.$$d_$9eA,this.get_$1a());this.$HA=n.$g.$HA;this.$1H=t};function $4rc(n,t){var i=n.$1C.$g;i.set_$6kn(_nbs.NonBootStrings.l_Saving_Text);i.set_$6ed(t);i.set_$9ym(t)}function $4rd(n){var t=n.$1C.$g;var i=n.$1C.$3c(5);if(i.get_$Bz()){if(!t.$1v.$30){_js.Trace.logInfo(_a.$0.$l,"Show attachment in progress error dialog");t.$1v.$2u(0,_u.Strings.l_MailComposeCannotOperateWhileAttachmentInProgress_Text,null)}return!0}return!1}function $4re(n){var r=n.$1C.$g;var t=r.$d;var i=new _d.$S;n.$1H&&i.set_$Bk(n.$1H.get_$Bk());i.set_$66(0);i.set_$NA(!1);if(t.get_$3w()===11||t.get_$3w()===12){i.set_$3w(13);i.set_$op(t.get_$op());i.set_$1kL(t.get_$1kL())}else i.set_$3w(4);i.set_$9x(t.get_$9x());i.set_$3s(t.get_$3s());var u=n.$7my();i.set_$1Ed(!0);i.set_$Eb(t.get_$Eb());i.set_$1KQ(t.get_$1KQ());i.set_$nj(t.get_$nj());i.set_$1EQ(t.get_$1EQ());i.set_$rd(t.get_$rd());i.set_$pz(t.get_$pz());i.set_$2El(t.get_$2El());i.set_$7t(t.get_$7t());i.set_$2i(t.get_$2i());i.set_$Qd(t.get_$Qd());t.get_$Eb()||t.get_$3w()!==3||t.$47G()||!t.get_$Ch().get_$1P()||i.set_$8j(t.get_$Ch().get_$1P().get_$AIt());u.$TO(i);if(!t.get_$2El()){r.set_$yW(!0);$3bA(n);n.set_$2Sm(!1)}}function $3bA(n){var t=n.$1C;var i=t.$3c(2);i.get_$4h().$2Zi(t.$g,!1);_js.Trace.logInfo(_a.$0.$l,"Navigated away from inline compose")}_d.$Bv.prototype={$HA:null,$1H:null,$6O3:null,$2Sl:!1,$37B:!1,$21F:!1,$2jY:!1,$40b:!1,$1dr:null,get_$9eB:function(){return this.$6O3},get_$2Sm:function(){return this.$2Sl},set_$2Sm:function(n){this.$2Sl!==n&&(this.$2Sl=n);return n},get_$2Sy:function(){return this.$37B},set_$2Sy:function(n){if(this.$37B!==n){this.$37B=n;$4rc(this,n)}return n},get_$37A:function(){return this.$21F},set_$37A:function(n){if(this.$21F!==n){this.$21F=n;$4rc(this,n)}return n},$5G6:function(){var n=!0;var r=this.$1C;var i=r.$g;var t=i.$d;var u=i.get_$1JF();var f=i.get_$ui();var e=t.get_$7t();var s=t.get_$3w();if(this.$HA.$jI(e))_js.Trace.logInfo(_a.$0.$l,"User had chose to discard, simply navigate away.");else if(t.get_$nj()&&this.$HA.$5Pw(r,!1))_js.Trace.logInfo(_a.$0.$l,"User had navigated away on an unused response, the unused response was discarded.");else if($4rd(this))n=!1;else if(u.$Lc){_js.Trace.logInfo(_a.$0.$l,"We're sending the message, can't exit yet.");n=!1}else if(u.$374){_js.Trace.logInfo(_a.$0.$l,"We're resolving the recipients, can't exit yet.");u.$5Sl();n=!1}else if(t.get_$jh()){var o=r.$3c(21);o.$EW.$s();n=!1}else{_js.Trace.logInfo(_a.$0.$l,"Checking dirty before inline navigating away from compose. Context:"+t.toString());if(i.$FQ()){this.$40b=!1;_js.$J.get_$I().$1s(_a.$0.$l,"NavigatingAwaySaveTimeout",this.$$d_$9Ip,1e4);$1q8(this);if(f.$1dx("InlineExit",this.$$d_$6ZP,this.$$d_$4Y9,!1)){this.set_$37A(!0);_js.Trace.logInfo(_a.$0.$l,"Save is in progress or failed, can't exit yet.");n=!1}}}return n},$7my:function(){return new _y.$CW},$9eA:function(){var i=this.$1C;var t=i.$g;var n=t.$d;var r=n.get_$7t();var l=i.$3c(7);_js.$J.get_$I().$19I(_a.$0.$l,"MailComposePopOut");if(this.$2Sl){_js.Trace.logInfo(_a.$0.$l,"Skipped pop out because another pop out is in progress.");return}if(l.$Lc){_js.Trace.logInfo(_a.$0.$l,"Skipped pop out because send is in progress.");return}if($4rd(this)||this.$HA.$jI(r)){_js.Trace.logInfo(_a.$0.$l,"Skipped pop out because attachment is currently uploading or user had discarded");return}n.set_$Qd(this.$1dr=_y.$2V.$1X(_a.$0.$l,"MailComposeInlinePopOut",!0));this.set_$2Sm(!0);var e=!1;try{var a=this.$1C.$g.$x;a.$Db(_d.$Bv.$TX);_d.$4x.$F8(i);var u=i.$3c(8);_js.Trace.logInfo(_a.$0.$l,"Checking dirty before popping out from inline. Context:"+n.toString());var o=t.$FQ();var s=t.$d.$34r;var v=i.$3c(12);if(!n.get_$9x()||o||v.$4b7||s){this.set_$2Sy(!0);(n.get_$9x()&&!s||o||u.$yO)&&n.set_$pz(!1);_js.Trace.logInfo(_a.$0.$l,"Set WasCleanNewMessageBeforePopout = "+n.get_$pz());this.$2jY=!1;_js.$J.get_$I().$1s(_a.$0.$l,"PopoutSaveTimeout",this.$$d_$9hl,1e4);n.set_$2El(!0);$1q8(this);t.$hD.get_saveForPopoutMap()[r]=new _y.$1CE;$4re(this);u.$1dx("Popout",this.$$d_$9ry,this.$$d_$5TC,!1)}else{if(n.get_$1EQ())n.set_$pz(!1);else if(n.get_$rd())n.set_$pz(!1);else if(u.$yO)n.set_$pz(!1);else if(n.$WE){_js.Trace.logInfo(_a.$0.$l,"Comparing initial baseline with baseline. Context:"+n.toString());n.$WE.$4i(n.get_$J1())||n.set_$pz(!1)}else n.set_$pz(!1);n.set_$2El(!1);_a.$3.$m(t.$hD,"PopoutManager");_a.$3.$m(t.$hD.get_saveForPopoutMap(),"PopoutManager.SaveForPopoutMap");delete t.$hD.get_saveForPopoutMap()[r];$4re(this)}var h=t.get_$26r();if(h){var c=h.get_$4h();if(c){_js.Trace.logInfo(_a.$0.$l,"MailComposeInlineComponent::OpenComposeWindow - setting composeConductor.HasNavigatedFromInlineToPopoutCompose = true");c.set_$8D8(!0)}}e=!0}catch(f){_y.$2V.$19(this.$1dr,null,f.toString(),null,f.message);n.set_$Qd(this.$1dr=null);throw f;}finally{if(!e){this.set_$2Sm(!1);this.set_$2Sy(!1)}}},$9ry:function(n){this.set_$2Sy(!1);if(this.$2jY){_js.Trace.logInfo(_a.$0.$l,"Popout was cancelled by timer, skipping save succeeded processing for popout.");_y.$2V.$19(this.$1dr,null,_d.$Bv.$O4.toString(3));this.$1dr=null}else{var i=n.$5H;var t=this.$1C.$g;if(i in t.$hD.get_saveForPopoutMap()){var u=_d.$6l.$5TA(n);var r=t.$hD.get_saveForPopoutMap()[i];if(r.$1tO.length){var f=JsonParser.serialize(u);t.$hD.pushSaveResultToPopout(f,r.$1tO);delete t.$hD.get_saveForPopoutMap()[i]}else r.$i=u}if(t.$d.get_$7t()===i){_js.Trace.logInfo(_a.$0.$l,"Save succeeded for popout, navigating away from the main window.");t.set_$yW(!0);$3bA(this);this.set_$2Sm(!1)}else _js.Trace.logInfo(_a.$0.$l,"Skipped navigating away since contextId="+i+"; viewModelId="+t.$d.get_$7t())}},$6ZP:function(n){this.$21F&&this.set_$37A(!1);if(this.$40b){_js.Trace.logInfo(_a.$0.$l,"Navigation away was cancelled by timer, skipping navigating from compose.");return}this.$1C.$g.set_$yW(!0);$3bA(this)},$4Y9:function(n){if(this.$21F){_js.Trace.logInfo(_a.$0.$l,"Save failed, reset IsSavingForNavigatingAway flag to false");this.set_$37A(!1)}},$5TC:function(n){if(this.$2Sl){this.set_$2Sm(!1);this.set_$2Sy(!1);var u=this.$1C;var t=u.$g;var i;i=n?n.$5H:t.$d.get_$7t();if(i in t.$hD.get_saveForPopoutMap()){var r=t.$hD.get_saveForPopoutMap()[i];r.$1tO.length>0&&t.$hD.pushSaveResultToPopout(null,r.$1tO);delete t.$hD.get_saveForPopoutMap()[i]}}var f=this.$2jY?2:1;_y.$2V.$19(this.$1dr,null,_d.$Bv.$O4.toString(f));this.$1dr=null},$9hl:function(){_js.Trace.logInfo(_a.$0.$l,"Attempt to popout expired since save did not come back in time");if(this.$37B){this.$2jY=!0;this.$5TC(null);var n=this.$1C;var t=n.$g.$x;$1q8(this);t.$2j(84);_d.$4x.$F8(n)}},$9Ip:function(){_js.Trace.logInfo(_a.$0.$l,"Attempt to navigate away expired since save did not come back in time");if(this.$21F){this.$40b=!0;this.$4Y9(null);var n=this.$1C;var t=n.$g.$x;$1q8(this);t.$2j(86);_d.$4x.$F8(n)}}};_d.$Bv.$O4=function(){};_d.$Bv.$O4.prototype={popoutSaveFailed:1,popoutSaveExpired:2,popoutSaveSucceededExpired:3};_d.$Bv.$O4.registerEnum("_d.$Bv.$O4",!1);_d.$90=function(n){_d.$90.initializeBase(this,[4,n])};_d.$90.$5m4=function(n){switch(n.get_$3w()){case 4:return n.get_$47P();case 8:case 3:case 5:case 7:case 6:return!0;default:return!1}};_d.$90.prototype={get_$2zF:function(){return this.$W(_d.$90.$3wc)},set_$2zF:function(n){this.$M(_d.$90.$3wc,n);return n},get_$1mh:function(){return this.$W(_d.$90.$4Zd)},set_$1mh:function(n){this.$M(_d.$90.$4Zd,n);return n},get_$39U:function(){return this.$W(_d.$90.$4AQ)},set_$39U:function(n){this.$M(_d.$90.$4AQ,n);return n},get_$46B:function(){return this.$W(_d.$90.$46C)},set_$46B:function(n){this.$M(_d.$90.$46C,n);return n},$41:function(){var n=this.$1C.$g.$d;var o=this.$1C.$g.$B;var t=this.$1C.$g.$5q;n.get_$1yC()?this.set_$39U(new _cc.$EQ(n.get_$4g(),null,this.$1C.$g.$5q,this.$1C.$g.$B)):this.set_$39U(null);if(n.get_$WK()&&n.get_$1ET()){var i=1;var r=_pc.$l.$5LB(n.get_$3U());var u=t.$Vu(r,_y.$17.$XR,!0,i);this.set_$2zF(u);this.set_$46B(!!n.get_$8m()&&!!n.get_$8m().Mailbox&&!!n.get_$3U()&&!!n.get_$3U().Mailbox&&!_g.$2R.$4i(n.get_$3U().Mailbox,n.get_$8m().Mailbox));if(this.get_$46B()){var f=_pc.$l.$5LB(n.get_$8m());var e=t.$Vu(f,_y.$17.$XR,!0,i);this.set_$1mh(e)}else this.get_$1mh()&&this.set_$1mh(null)}else{this.get_$2zF()&&this.set_$2zF(null);this.get_$1mh()&&this.set_$1mh(null)}_js.Trace.logInfo(_a.$0.$l,"Meeting component initialized, IsMeeting={0}, IsMeetingForward={1}",n.get_$WK(),n.get_$1ET());_d.$9q.prototype.$41.call(this)}};_d.$Gy=function(n){this.$$d_$3HR=Function.createDelegate(this,this.$3HR);this.$$d_$3HQ=Function.createDelegate(this,this.$3HQ);this.$$d_$7XX=Function.createDelegate(this,this.$7XX);this.$$d_$12y=Function.createDelegate(this,this.$12y);this.$$d_$2cE=Function.createDelegate(this,this.$2cE);this.$$d_$A18=Function.createDelegate(this,this.$A18);_d.$Gy.initializeBase(this,[10,n])};function $4rg(n,t,i){return!t&&!i?!0:i==="IsInProgress"&&!t.get_$Bz()}function $3bB(n){_js.Trace.logInfo(_a.$0.$l,"User hit OK on message options dialog, setting Sensitivity="+n.$d_2.get_$8F()+"; DeliveryReceipt="+n.$d_2.get_$Gi()+"; ReadReceipt="+n.$d_2.get_$G8()+"; SmimeEncryptMessage="+n.$d_2.get_$Fk()+"; SmimeSignMessage="+n.$d_2.get_$I8());n.$12y()}function $738(n){var i=n.$1C.$g;var t=i.$wz();switch(i.$d.get_$8F()){case"Personal":t.$5Z(8900);break;case"Confidential":t.$5Z(8901);break;case"Private":t.$5Z(8902);break}_d.$4x.$F8(n.$1C)}function $4rf(n){var i=n.$1C.$g;var t=i.$wz();switch(i.$d.get_$8F()){case"Personal":t.$2j(8900,null);break;case"Confidential":t.$2j(8901,null);break;case"Private":t.$2j(8902,null);break}_d.$4x.$F8(n.$1C)}_d.$Gy.prototype={$2CA:null,$9w:null,$Un:null,$7W:null,get_$A19:function(){return this.$2CA},set_$A19:function(n){if(this.$2CA!==n){this.$2CA=n;$N(this,"ShowMessageOptionsCommand")}return n},get_$ip:function(){return this.$9w},set_$ip:function(n){if(this.$9w!==n){this.$9w=n;$N(this,"DialogViewModel")}return n},$41:function(){this.$2CA||this.set_$A19(new _C(this.$$d_$A18,this.get_$1a()));$4rf(this);_d.$9q.prototype.$41.call(this)},$A18:function(){_js.Trace.logInfo(_a.$0.$l,"User chose to show message options");$5(this.$Un)&&(this.$Un=new _d.$lS);this.$Un.$158(this.$d_2);if($5(this.$9w)){this.set_$ip(new _y.$M8);this.$9w.set_$4o(_nbs.NonBootStrings.l_MessageOptions_Text);this.$7W=[new _a.$2E(new _C(this.$$d_$2cE,this.get_$1a()),_nbs.NonBootStrings.l_Ok_LowerCase_Text,null),new _a.$2E(new _C(this.$$d_$12y,this.get_$1a()),_u.Strings.l_CancelButtonLabel_LowerCase_Text,null)];this.$9w.$7W.$6S(this.$7W)}this.$9w.set_$DT(this.$Un);if("TouchNarrow"===_y.$x.$w.get_$L()){var n=this.$1C.$g.get_$4h();this.$Un.set_$4h(n);n.get_$8o().add_$1Y(this.$$d_$7XX)}this.$9w.set_$1O(!0)},$2cE:function(){if(this.$9w.$8X){_js.Trace.logInfo(_a.$0.$l,"User tried to click OK button more than once.");return}var u=this.$1C.$g;var n=u.$d;var t=this.$g.get_$a0();var i=t.get_$60();if(n.get_$8F()!==this.$Un.$1mj){"Normal"!==n.get_$8F()&&$738(this);n.set_$8F(this.$Un.$1mj);"Normal"!==n.get_$8F()&&$4rf(this)}n.set_$Gi(this.$Un.$1zn);n.set_$G8(this.$Un.$214);if(n.get_$Fk()!==this.$Un.$11P){n.set_$Fk(this.$Un.$11P);$N(this,"SmimeEncryptMessage");_js.Trace.logInfo(_a.$0.$3i,"SmimeEncryptMessage option is changed to {0} by user.",this.$Un.$11P)}if(n.get_$I8()!==this.$Un.$11Q){n.set_$I8(this.$Un.$11Q);$N(this,"SmimeSignMessage");_js.Trace.logInfo(_a.$0.$3i,"SmimeSignMessage option is changed to {0} by user.",this.$Un.$11Q)}var r=this.$Un.$11P||this.$Un.$11Q;r&&u.$6gP();i&&i.set_$QH(n.get_$QH());if(this.$Un.$4jg&&!r&&t.get_$G5())if(t.get_$Bz()){_js.Trace.logInfo(_a.$0.$3i,"Waiting to move attachments because the attachment well is currently in progress.");this.$9w.set_$6D(!0);i.add_$83(this.$$d_$3HQ)}else this.$3HQ(null,null);else if(!this.$Un.$4jg&&r&&t.get_$G5())if(t.get_$Bz()){_js.Trace.logInfo(_a.$0.$3i,"Waiting to move attachments because the attachment well is currently in progress.");this.$9w.set_$6D(!0);i.add_$83(this.$$d_$3HR)}else this.$3HR(null,null);else $3bB(this)},$3HQ:function(n,t){if($4rg(this,n,t)){_js.Trace.logInfo(_a.$0.$3i,"Started MoveAttachmentsFromClientToServer due to user turned off S/MIME for current message.");if(n){n.remove_$83(this.$$d_$3HQ);this.$9w.set_$6D(!1)}var i=this.$g.get_$a0().get_$60();if(this.$g.$d.get_$9x())i.$3HQ();else{var r=this.$g.get_$ui();var u=this;r.$1dx("Attach",function(){i.$3HQ()},null,!1)}$3bB(this)}},$3HR:function(n,t){if($4rg(this,n,t)){_js.Trace.logInfo(_a.$0.$3i,"Started MoveAttachmentsFromServerToClient due to user turned on S/MIME for current message.");if(n){n.remove_$83(this.$$d_$3HR);this.$9w.set_$6D(!1)}this.$g.get_$a0().get_$60().$3HR();$3bB(this)}},$12y:function(){if(this.$9w.$8X){_js.Trace.logInfo(_a.$0.$l,"User tried to close dialog when busy.");return}var n=this.$1C.$g.$d;var i=this.$g.$wz();if(n.get_$QH()&&n.get_$Uf()){_a.$4Y.$2u(_u.Strings.l_Smime_NotSupportedWithFromRecipientWell_Text,1);i.$2j(750)}else i.$5Z(750);this.$g.get_$Kx().$2gG.set_$69(!n.get_$QH());var t=this.$g.get_$a0();if(t.get_$60()){t.get_$60().remove_$83(this.$$d_$3HQ);t.get_$60().remove_$83(this.$$d_$3HR)}"TouchNarrow"===_y.$x.$w.get_$L()&&this.$Un.$3m.get_$8o().remove_$1Y(this.$$d_$7XX);_js.Trace.logInfo(_a.$0.$l,"Close message options dialog");this.$9w.$4f.$s()},$7XX:function(n,t){_d.$Ao.isInstanceOfType(this.$1C.$g.get_$4h().get_$7T())?this.$9w.set_$1O(!0):this.$9w.set_$1O(!1)}};_d.$1Au=function(n){this.$$d_$6XL=Function.createDelegate(this,this.$6XL);this.$$d_$3KQ=Function.createDelegate(this,this.$3KQ);this.$$d_$3nR=Function.createDelegate(this,this.$3nR);_d.$1Au.initializeBase(this,[2,n]);this.$HA=n.$g.$HA};_d.$1Au.prototype={$HA:null,$3m:null,$192:!1,get_$4h:function(){$5(this.$3m)&&(this.$3m=new _y.$CW);return this.$3m},set_$4h:function(n){this.$3m=n;return n},$41:function(){var n=_y.$x.$w;n.remove_$UA(this.$$d_$3nR);n.add_$UA(this.$$d_$3nR);_js.Trace.logInfo(_a.$0.$l,"Before unload handler has been hooked up");"Mouse"!==n.get_$L()||n.get_$9l()||n.add_$19w(this.$$d_$3KQ);_d.$9q.prototype.$41.call(this)},$3nR:function(n){this.$1C.$g.$jf&&(this.$192=!0);if(!this.$192){_js.Trace.logInfo(_a.$0.$l,"Checking dirty before prompting user for before unload confirmation. Context: "+this.$1C.$g.$d.toString());this.$1C.$g.$FQ()&&n.$1Lk(_nbs.NonBootStrings.l_MailComposeBeforeUnloadConfirmation_Text)}this.$192=!0;_js.$J.get_$I().$1s(_a.$0.$l,"ResetSkipBeforeUnloadConfirmationFlag",this.$$d_$6XL,100)},$AG:function(){_y.$x.$w.remove_$UA(this.$$d_$3nR);_d.$9q.prototype.$AG.call(this)},$6XL:function(){this.$192=!1},$3KQ:function(){_y.$x.$w.remove_$19w(this.$$d_$3KQ);this.$HA.$5Pw(this.$1C,!0)}};_d.$1Av=function(n,t){this.$$d_$u9=Function.createDelegate(this,this.$u9);_d.$1Av.initializeBase(this,[15,n]);this.$4Qd=new _C(this.$$d_$u9,this.get_$1a());this.$4Qd.set_$69(t.get_$B9().get_$bW().get_$3Hm())};_d.$1Av.prototype={$4Qd:null,$u9:function(){_js.Trace.logInfo(_a.$0.$l,"OpenFilePicker on PAL.");var n=this.$1C.$3c(5);if(!n){_js.Trace.logError(_a.$0.$l,"Unable to open file picker, attachment component is null.");return}if(!n.get_$60()){_js.Trace.logError(_a.$0.$l,"Unable to open file picker, attachment well ViewModel is null.");return}if(!_d.$Py.$35u(this.$1C.$g)){_js.Trace.logError(_a.$0.$l,"Unable to open file picker, ViewModel is not upgraded.");return}n.get_$60().$9eM();_js.Trace.logInfo(_a.$0.$l,"OpenFilePicker on PAL end.")}};_d.$Py=function(n,t){this.$$d_$5Cw=Function.createDelegate(this,this.$5Cw);this.$$d_$3iw=Function.createDelegate(this,this.$3iw);_d.$Py.initializeBase(this,[15,n]);var i;i=t.$5i(t.get_$B9())?t.get_$B9().get_$bW():this;var r=this;this.$1Lu=new _C(this.$$d_$3iw,this.get_$1a(),i,"CameraAvailable",function(){return t.$5i(t.get_$B9())&&t.get_$B9().get_$bW().get_$2Iv()});var u=this;this.$1Lv=new _C(this.$$d_$5Cw,this.get_$1a(),i,"GalleryAvailable",function(){return t.$5i(t.get_$B9())&&t.get_$B9().get_$bW().get_$2zN()})};_d.$Py.$35u=function(n){var t=n.$d;if($5(t)||!t.get_$Eb()){_js.Trace.logInfo(_a.$0.$l,"Show attachment not allowed dialog, Upgraded="+t.get_$Eb());n.$1v.$2u(0,_nbs.NonBootStrings.l_AddingAttachmentNotAllowed_Text,null);return!1}return!0};_d.$Py.prototype={$1Lu:null,$1Lv:null,$3iw:function(){_js.Trace.logInfo(_a.$0.$l,"User chose to attach from camera");var n=this.$1C.$3c(5);if(!n){_js.Trace.logError(_a.$0.$l,"Unable to open camera, attachment component is null.");return}if(!n.get_$60()){_js.Trace.logError(_a.$0.$l,"Unable to open camera, attachment well ViewModel is null.");return}if(!_d.$Py.$35u(this.$1C.$g)){_js.Trace.logError(_a.$0.$l,"Unable to open camera, ViewModel is not upgraded.");return}n.get_$60().$4QZ();_js.Trace.logInfo(_a.$0.$l,"Attach from camera end")},$5Cw:function(){_js.Trace.logInfo(_a.$0.$l,"User chose to attach from gallery");var n=this.$1C.$3c(5);if(!n){_js.Trace.logError(_a.$0.$l,"Unable to open gallery, attachment component is null.");return}if(!n.get_$60()){_js.Trace.logError(_a.$0.$l,"Unable to open gallery, attachment well ViewModel is null.");return}if(!_d.$Py.$35u(this.$1C.$g)){_js.Trace.logError(_a.$0.$l,"Unable to open gallery, ViewModel is not upgraded.");return}n.get_$60().$6OB();_js.Trace.logInfo(_a.$0.$l,"Attach from gallery end")}};_d.$41=function(n){this.$$d_$7ud=Function.createDelegate(this,this.$7ud);this.$$d_$9ZD=Function.createDelegate(this,this.$9ZD);this.$$d_$2z8=Function.createDelegate(this,this.$2z8);this.$$d_$5V2=Function.createDelegate(this,this.$5V2);this.$$d_$2ao=Function.createDelegate(this,this.$2ao);this.$$d_$17h=Function.createDelegate(this,this.$17h);this.$$d_$5V3=Function.createDelegate(this,this.$5V3);this.$$d_$9XU=Function.createDelegate(this,this.$9XU);this.$$d_$4QD=Function.createDelegate(this,this.$4QD);this.$$d_$7Yg=Function.createDelegate(this,this.$7Yg);this.$$d_$9Zl=Function.createDelegate(this,this.$9Zl);this.$$d_$9tV=Function.createDelegate(this,this.$9tV);this.$$d_$7qz=Function.createDelegate(this,this.$7qz);this.$$d_$8EB=Function.createDelegate(this,this.$8EB);this.$$d_$A0i=Function.createDelegate(this,this.$A0i);this.$$d_$8Dz=Function.createDelegate(this,this.$8Dz);this.$$d_$9zx=Function.createDelegate(this,this.$9zx);_d.$41.initializeBase(this,[1,n]);this.$B1=this.$3pO();this.$B5=this.$3pO();this.$Bs=this.$3pO();this.$3ST=new _C(this.$$d_$9zx,this.get_$1a());this.$413=new _C(this.$$d_$8Dz,this.get_$1a());this.$2gG=new _C(this.$$d_$A0i,this.get_$1a());this.$41A=new _C(this.$$d_$8EB,this.get_$1a());this.$5Ok=new _C(this.$$d_$7qz,this.get_$1a());this.$5He=new _C(this.$$d_$9tV,this.get_$1a());this.$18f=new _C(this.$$d_$9Zl,this.get_$1a());this.$1IS=new(_0365f.$n.$$(_y.$2W));this.$2gs=new _y.$11Z(this.$1C.$g.$7F);$73A(this)};_d.$41.$9iA=function(n,t){n.set_$4Z(t)};_d.$41.$9hx=function(n,t){n.set_$4l(t)};_d.$41.$9hu=function(n,t){n.set_$6I(t)};_d.$41.$9i9=function(n,t){n.set_$cA(t)};_d.$41.$9hw=function(n,t){n.set_$a8(t)};_d.$41.$9ht=function(n,t){n.set_$Vj(t)};function $73D(n){n.$B1.$Lb?n.$B1.$1wt():n.$5V3(!0)}function $3bE(n,t){t.$4X?n.$1IS.$D(t.$4X):t.$Wu&&n.$1IS.$D(t.$Wu)}function $73A(n){n.$B1.$Y("ReadWriteRecipientWellViewModel",n.$$d_$9ZD);n.$B5.$Y("ReadWriteRecipientWellViewModel",n.$$d_$9ZD);n.$Bs.$Y("ReadWriteRecipientWellViewModel",n.$$d_$9ZD);n.$B1.$Y("ReadOnlyRecipientWellViewModel",n.$$d_$9ZD);n.$B5.$Y("ReadOnlyRecipientWellViewModel",n.$$d_$9ZD);n.$Bs.$Y("ReadOnlyRecipientWellViewModel",n.$$d_$9ZD)}function $73E(n){n.$B1.$q("ReadWriteRecipientWellViewModel",n.$$d_$9ZD);n.$B5.$q("ReadWriteRecipientWellViewModel",n.$$d_$9ZD);n.$Bs.$q("ReadWriteRecipientWellViewModel",n.$$d_$9ZD);n.$B1.$q("ReadOnlyRecipientWellViewModel",n.$$d_$9ZD);n.$B5.$q("ReadOnlyRecipientWellViewModel",n.$$d_$9ZD);n.$Bs.$q("ReadOnlyRecipientWellViewModel",n.$$d_$9ZD)}function $73B(n){n.$B1.$4X&&n.$B1.$4X.$2Iy();n.$B5.$4X&&n.$B5.$4X.$2Iy();n.$Bs.$4X&&n.$Bs.$4X.$2Iy()}function $4rm(n){if(n.$B1.$4X){n.$B1.$4X.remove_$ki(n.$$d_$5V3);n.$B1.$4X.remove_$17h(n.$$d_$17h);n.$B1.$4X.$1U.remove_$1Y(n.$$d_$2ao)}if(n.$B5.$4X){n.$B5.$4X.remove_$ki(n.$$d_$5V2);n.$B5.$4X.remove_$17h(n.$$d_$17h);n.$B5.$4X.$1U.remove_$1Y(n.$$d_$2ao)}if(n.$Bs.$4X){n.$Bs.$4X.remove_$ki(n.$$d_$2z8);n.$Bs.$4X.remove_$17h(n.$$d_$17h);n.$Bs.$4X.$1U.remove_$1Y(n.$$d_$2ao)}}function $4rp(n){if(_y.$x.$w.get_$L()==="Mouse"){var i=n.$1C.$3c(18);i.$ADp()}else{var t=n.$1C.$g.$d;var r=t.get_$nW()?n.get_$412():n.get_$4bm();var u=t.get_$nW()?n.get_$4bm():n.get_$412();var f=n.$1C.$g.$3y;f.$4WN(u,r)}}function $4ro(n,t){if("Mouse"!==_y.$x.$w.get_$L()){var e=n.$1C;var f=e.$g;var r=f.$3y;if(r){var u=r.$14;if(u)if(t.get_$2T0()){if(!n.$1f6)for(var i=0;i<u.length;i++)if(_nbs.NonBootStrings.l_ShowBccMenuItemText_LowerCase_Text===u[i].$2E){r.$2oJ(n.get_$2C4(),i+1);n.$1f6=!0}}else if(n.$1f6){f.$3y.$3OU(n.get_$2C4());n.$1f6=!1}}}}function $2l5(n){var r=n.$1C.$g.$d;var t=null;if(r.get_$Uf()){var i=null;n.$Xx?i=n.$Xx.get_$1u().get_$1l():n.$rQ&&!_js.$8.$a(n.$rQ.$3F)&&(i=$3bC(n,n.$rQ.$3F));t=new _g.$Bc;t.Mailbox=i;r.set_$3U(t);n.get_$35O()||n.$1C.$g.$x.$5Z(66)}return t}function $3bC(n,t){var i=new _g.$1q;i.MailboxType="Mailbox";i.RoutingType="SMTP";i.EmailAddress=t;return i}function $73C(n){var i=_d.$KE.$29W;var t=[];(i&4)==4&&Array.add(t,new _0365m.$o(_u.Strings.l_EditRecipient_LowerCase_Text,null,new _C(n.$$d_$7ud,_a.$0.$l)));(i&2)==2&&Array.add(t,new _0365m.$o(_u.Strings.l_RemoveRecipient_LowerCase_Text,null,new _C(n.$$d_$7qz,_a.$0.$l)));$5(n.$Xx.$fT)||(i&1)!=1||Array.addRange(t,n.$Xx.$fT);n.$Xx.set_$1aO(t)}function $4rk(n){var t=n.$1C.$g.$d;var r=null;var i=_g.$V.get_$I().get_$2z();r=_js.$8.$a(i.get_$eQ())||_js.$8.$a(i.get_$b6())?null!==t.get_$3U()&&t.get_$3U().Mailbox?t.get_$3U().Mailbox.EmailAddress:_h.$3L.$2zq(null)||i.get_$AM():i.get_$b6();n.$2fV(r,!1);t.set_$Uf(!0);var f=$2l5(n);t.get_$J1()&&t.get_$J1().set_$3U(f);var u=n.$1C.$3c(20);$5(u.get_$Hu())&&u.$41()}function $739(n){var t=n.get_$14S().get_$X1();if($5(t)||$5(t.get_$1u())||$5(t.get_$1u().get_$1l()))_js.Trace.logWarning(_a.$0.$l,"User selected from but the SelectedResultItem persona is invalid");else{var i=t.get_$1u().get_$1l().EmailAddress;_js.Trace.logInfo(_a.$0.$l,"User selected from="+i);n.$2fV(i,!0)}}function $73F(n){if(_y.$x.$w.get_$L()==="Mouse"){var i=n.$1C.$3c(18);i.$6np()}else{var t=n.$1C.$g.$d;var r=t.get_$Uf()?n.get_$32M():n.get_$2C4();var u=t.get_$Uf()?n.get_$2C4():n.get_$32M();var f=n.$1C.$g.$3y;f.$4WN(u,r)}}function $3bD(n,t,i,r,u){var f=n.$Lb?i.$4X:i.$Wu;if(!$5(f)){r(t,f.$8i);if(_rw.$36.isInstanceOfType(f)){var e=f;e.get_$6A()&&u(t,e.get_$6A().get_$7D())}}}function $4rn(n,t){var e=n.$1C.$g.$d;var i=!1;var f=e.$303();if(f){var r=n.$B5.$4X.$8i;if(r)for(var u=0;u<r.get_$C();u++){var o=r.get_$3o(u);if(f.EmailAddress.toLowerCase()===o.EmailAddress.toLowerCase()){i=!0;break}}}if(t&&i){n.$1C.$g.$x.$5Z(4450);n.$1C.$g.$x.$2j(4450)}else t||i||n.$1C.$g.$x.$5Z(4450)}function $4rl(n,t){var i=new(_0365f.$n.$$(String));var r=this;t.$Bd(function(n){var t=n;if(_js.$8.$a(t.Name)||_js.$8.$a(t.EmailAddress))if(_js.$8.$a(t.EmailAddress))return;else i.$D(t.EmailAddress);else i.$D('"'+t.Name+'" <'+t.EmailAddress+">")});return i.get_$C()?i.get_$3O().join("; "):null}function $4ri(n,t){if(!t||!t.length)return"";for(var r=new Array(t.length),i=0;i<t.length;i++)r[i]=$4rj(n,t[i]);return r.join("; ")}function $4rj(n,t){if(t){var i=t.Name||t.OriginalDisplayName||"_";var r=(t.EmailAddress||"_")+"|"+(t.MailboxType||"_")+"|"+(t.RoutingType||"_");return i+" <"+r+">"}else return"_"}_d.$41.prototype={$B1:null,$B5:null,$Bs:null,$3ST:null,$413:null,$2gG:null,$41A:null,$5Ok:null,$5He:null,$18f:null,$4bz:null,$41B:null,$4bl:null,$411:null,$Xx:null,$rQ:null,$3S8:!1,$Lb:!1,$458:!1,$5CY:!1,$Qm:null,$2Ki:null,$41P:null,$1f6:!1,$46k:!1,$6ea:!1,$1IS:null,$2gs:null,add_$6Me:function(n){this.$2G("ResolveOperationSucceeded",n)},remove_$6Me:function(n){this.$2H("ResolveOperationSucceeded",n)},add_$6Md:function(n){this.$2G("ResolveOperationCanceled",n)},remove_$6Md:function(n){this.$2H("ResolveOperationCanceled",n)},get_$2zH:function(){return this.$Xx},set_$2zH:function(n){if(this.$Xx!==n){this.$Xx=n;$N(this,"FromPersonaViewModel")}return n},get_$14S:function(){if(!this.$rQ){var n=new _d.$2C(_pc.$15.$xo,_pc.$15.$jD(),!0);_d.$DR.$1aH(n);n.set_$1ls("PersonaDetailedView");n.$12a();n.set_$pP(!0);n.set_$4fh(new _C(this.$$d_$7Yg,_a.$0.$l));_y.$x.$w.get_$L()!=="Mouse"&&n.set_$J5(new _C(this.$$d_$7Yg,_a.$0.$l));n.add_$hO(this.$$d_$4QD);this.$rQ=n}return this.$rQ},get_$6eO:function(){return this.$3S8},set_$6eO:function(n){if(this.$3S8!==n){this.$3S8=n;$N(this,"ShouldHighlightFromAsInvalid")}return n},get_$1zS:function(){var n=this.$1C.$g.$d.get_$Uf()&&(!!this.$Xx&&this.$Xx.get_$1zS()||!!this.$rQ&&this.$rQ.get_$1zS());return n||this.$B1.get_$1zS()||this.$B5.get_$1zS()||this.$Bs.get_$1zS()},get_$8Nf:function(){return this.$Lb},set_$8Nf:function(n){this.$Lb=n;$N(this,"IsReadWrite");return n},get_$5kZ:function(){return this.$46k},set_$5kZ:function(n){this.$46k=n;$N(this,"IsPeoplePickerShown");return n},get_$35O:function(){var n=this.$1C.$g.$d;return!!n.get_$3U()&&!!n.get_$3U().Mailbox&&!_a.$3q.$WP(n.get_$3U().Mailbox.EmailAddress)},get_$2C4:function(){this.$4bz||(this.$4bz=new _y.$32(_nbs.NonBootStrings.l_ShowFromMenuItemText_LowerCase_Text,this.$2gG));return this.$4bz},get_$32M:function(){this.$41B||(this.$41B=new _y.$32(_nbs.NonBootStrings.l_HideFromMenuItemText_LowerCase_Text,this.$41A));return this.$41B},get_$4bm:function(){this.$4bl||(this.$4bl=new _y.$32(_nbs.NonBootStrings.l_ShowBccMenuItemText_LowerCase_Text,this.$3ST));return this.$4bl},get_$412:function(){this.$411||(this.$411=new _y.$32(_nbs.NonBootStrings.l_HideBccMenuItemText_LowerCase_Text,this.$413));return this.$411},get_$8JI:function(){return!this.$1C.$g.$d.get_$jh()},get_$8Of:function(){return!this.$1C.$g.$d.get_$jh()},get_$8NK:function(){return this.$1C.$g.$d.get_$jh()},$2EE:function(){this.$B1.$2EE();this.$B5.$2EE();this.$Bs.$2EE()},$9w4:function(n){this.$41P=n},$7dN:function(n,t,i){if(this.$Qm){this.$Qm.remove_$1m4(this.$2Ki);this.$Qm.add_$1m4(i);this.$2Ki=i;this.$Qm.set_$6V0(t);this.$Qm.$6ni(n)}else{this.$Qm=this.$1C.$g.$1V3.$5M1(n,t);this.$Qm.add_$1m4(i);this.$Qm.add_$6RD(this.$$d_$9XU);this.$2Ki=i}this.set_$5kZ(!0);this.$1C.$g.$B.$7C(this.$Qm)},$7Ym:function(){if(this.$B1.$4X){this.$B1.$4X.remove_$ki(this.$$d_$5V3);this.$B1.$4X.remove_$17h(this.$$d_$17h);this.$B1.$4X.$1U.remove_$1Y(this.$$d_$2ao);this.$B1.$4X.add_$ki(this.$$d_$5V3);this.$B1.$4X.add_$17h(this.$$d_$17h);this.$B1.$4X.$1U.add_$1Y(this.$$d_$2ao)}if(this.$B5.$4X){this.$B5.$4X.remove_$ki(this.$$d_$5V2);this.$B5.$4X.remove_$17h(this.$$d_$17h);this.$B5.$4X.$1U.remove_$1Y(this.$$d_$2ao);this.$B5.$4X.add_$ki(this.$$d_$5V2);this.$B5.$4X.add_$17h(this.$$d_$17h);this.$B5.$4X.$1U.add_$1Y(this.$$d_$2ao)}},get_$ZI:function(){return this.$1IS},$41:function(){var n=this.$1C.$g.$d;var t=n.get_$5r();this.set_$8Nf(!t||!!t.get_$HX()||t.get_$4Lp()||t.get_$9X());if(n.get_$2h8()&&n.get_$2h8().get_$C()>0){this.$B1.$8Gb(n.get_$2h8(),this.$Lb,_u.Strings.l_ToRecipientsLabel_Text);n.set_$2h8(null)}else this.$B1.$41(n.get_$4Z(),n.get_$cA(),this.$Lb,_u.Strings.l_ToRecipientsLabel_Text);this.$B5.$41(n.get_$4l(),n.get_$a8(),this.$Lb,_u.Strings.l_CcRecipientsLabel_Text);_y.$x.$w.get_$W5()&&$4rn(this,!0);this.$7Ym();var i=_g.$V.get_$I().get_$2z();if(!_js.$8.$a(i.get_$eQ())&&!_js.$8.$a(i.get_$b6())){var r=new _g.$Bc;r.Mailbox=$3bC(this,i.get_$b6());n.set_$3U(r)}("Mouse"===_y.$x.$w.get_$L()||n.get_$3U()||_g.$V.get_$I().get_$13().get_$iA()||!$5(n.get_$6I())&&n.get_$6I().get_$C()>0||_g.$V.get_$I().get_$13().get_$1Lg())&&this.$141();$4ro(this,n);_g.$V.get_$I().get_$13().get_$iA()&&n.get_$QH()&&this.$1C.$g.$x.$2j(750);_d.$9q.prototype.$41.call(this)},$AG:function(){if(this.$Xx){this.$Xx.$1R();this.$Xx=null}if(this.$Qm){this.$Qm.remove_$1m4(this.$2Ki);this.$Qm.remove_$6RD(this.$$d_$9XU);this.$Qm.$1R();this.$Qm=null;this.$2Ki=null}$4rm(this);if(this.$rQ){this.$rQ.remove_$hO(this.$$d_$4QD);this.$rQ.$1R();this.$rQ=null}$4rm(this);$73E(this);this.$1IS.$1t();this.$B1.$1R();this.$B5.$1R();this.$Bs.$1R();_d.$9q.prototype.$AG.call(this)},$2j0:function(){this.$141();var n=this.$1C.$g.$d;$2l5(this);$3bD(this,n,this.$B1,_d.$41.$9iA,_d.$41.$9i9);$3bD(this,n,this.$B5,_d.$41.$9hx,_d.$41.$9hw);$3bD(this,n,this.$Bs,_d.$41.$9hu,_d.$41.$9ht)},$2fV:function(n,t){var u=_a.$3q.$WP(n);if(u){this.get_$14S().set_$7D("");var f=$3bC(this,n);var e=_pc.$l.$Dh(f);var o=this.$1C.$g.$7F.$13R;var i=o.$ib(e,4,!0,1);i.set_$Ag(this.$5He);i.set_$E5(!0);i.$1JC=!0;this.set_$2zH(i);$73C(this)}else{this.get_$14S().set_$7D(n);this.set_$2zH(null)}if(t){var r=this.$1C.$g.get_$4Az();r.get_$D2()||r.$41();r.$2hZ()}this.set_$6eO(!u);this.$2j0()},$1DU:function(){this.$141();return this.$B1.$1DU()+this.$B5.$1DU()+this.$Bs.$1DU()},$88p:function(){this.$141();return this.$B1.$1DU()},$88o:function(){this.$141();return this.$B5.$1DU()},$88n:function(){this.$141();return this.$Bs.$1DU()},$3PB:function(n){this.$141();$2l5(this);$73B(this);this.$6ea=n;$73D(this)},$81G:function(){var n=new(_0365f.$n.$$(String));n.$6S(this.$B1.$4X.$2za());n.$6S(this.$B5.$4X.$2za());n.$6S(this.$Bs.$4X.$2za());return n.$6W()},$5V3:function(n){n?this.$B5.$Lb?this.$B5.$1wt():this.$5V2(!0):this.$2z8(!1)},$5V2:function(n){n?this.$Bs.$Lb?this.$Bs.$1wt():this.$2z8(!0):this.$2z8(!1)},$2z8:function(n){if(this.$6ea)if(n){_js.Trace.logInfo(_a.$0.$l,"Force resolve completed");$ex(this,"ResolveOperationSucceeded")}else{_js.Trace.logInfo(_a.$0.$l,"Force resolve cancelled");$ex(this,"ResolveOperationCanceled")}},$1DF:function(){this.$141();$2l5(this);this.$B1.$1DF();this.$B5.$1DF();this.$Bs.$1DF()},$141:function(){if(!this.$5CY){this.$5CY=!0;var n=this.$1C.$g.$d;this.$Bs.$41(n.get_$6I(),n.get_$Vj(),this.$Lb,_u.Strings.l_BccRecipientsLabel_Text);if(!$5(n.get_$6I())&&0<n.get_$6I().get_$C()||!_js.$8.$a(n.get_$Vj())||_g.$V.get_$I().get_$13().get_$1Lg()){n.set_$nW(!0);_js.Trace.logInfo(_a.$0.$l,"Showing BCC field due to: BccCount={0}, HasBccQueryString={1}, AlwaysShowBcc={2}",$5(n.get_$6I())?0:n.get_$6I().get_$C(),!_js.$8.$a(n.get_$Vj()),_g.$V.get_$I().get_$13().get_$1Lg())}if(this.$Bs.$4X){this.$Bs.$4X.remove_$ki(this.$$d_$2z8);this.$Bs.$4X.remove_$17h(this.$$d_$17h);this.$Bs.$4X.$1U.remove_$1Y(this.$$d_$2ao);this.$Bs.$4X.add_$ki(this.$$d_$2z8);this.$Bs.$4X.add_$17h(this.$$d_$17h);this.$Bs.$4X.$1U.add_$1Y(this.$$d_$2ao)}_js.Trace.logInfo(_a.$0.$l,"Recipient component initialized, ShouldValidate={0}, From={1}, ToCount={2}, CcCount={3}, BccCount={4}",!0,!n.get_$3U()||!n.get_$3U().Mailbox?"<not set>":n.get_$3U().Mailbox.EmailAddress,$5(n.get_$4Z())?0:n.get_$4Z().get_$C(),$5(n.get_$4l())?0:n.get_$4l().get_$C(),$5(n.get_$6I())?0:n.get_$6I().get_$C());$4ro(this,n);if(n.get_$2T0()&&(n.get_$3U()||_g.$V.get_$I().get_$13().get_$iA())){$4rk(this);_js.Trace.logInfo(_a.$0.$l,"Showing From field due to: From={0}, AlwaysShowFrom={1}",!n.get_$3U()||!n.get_$3U().Mailbox?"<not set>":n.get_$3U().Mailbox.EmailAddress,_g.$V.get_$I().get_$13().get_$iA())}else if(_g.$V.get_$I().get_$13().get_$iA()&&!$5(n.get_$5r())&&!n.get_$5r().get_$9X()){var t=this.$1C.$g.$x;t.$5Z(4525);t.$2j(4525);_d.$4x.$F8(this.$1C)}}},$39b:function(){this.$B1.$39b();this.$B5.$39b();this.$Bs.$39b()},$86w:function(n,t,i){var r=this.$d_2.$303();if(!r){var u=_g.$V.get_$I().get_$2z();r=new _g.$1q;r.Name=u.get_$Fn();r.EmailAddress=u.get_$AM()||u.get_$b6()}n.val='"'+r.Name+'" <'+r.EmailAddress+">";var f=this.$Lb?this.$B1.$4X.$8i:this.$B1.$Wu.$8i;t.val=f.get_$C()>0?$4rl(this,f):null;var e=this.$Lb?this.$B5.$4X.$8i:this.$B5.$Wu.$8i;i.val=e.get_$C()>0?$4rl(this,e):null},$6Xz:function(n,t){var s=this.$1C.$g;var e=s.$d;var r=new(_0365f.$n.$$(_g.$1q));var h=this.$Lb?this.$B1.$4X.$8i:this.$B1.$Wu.$8i;var c=this.$Lb?this.$B5.$4X.$8i:this.$B5.$Wu.$8i;var l=this.$Lb?this.$Bs.$4X.$8i:this.$Bs.$Wu.$8i;h&&r.$6S(h.$6W());c&&r.$6S(c.$6W());l&&r.$6S(l.$6W());var u=e.$303();if(!u){var o=_g.$V.get_$I().get_$2z();u=new _g.$1q;u.Name=o.get_$Fn();u.EmailAddress=o.get_$AM()||o.get_$b6();u.MailboxType="Mailbox";u.RoutingType="SMTP"}r.$D(u);_js.Trace.logInfo(_a.$0.$3i,"Retrieving certs of recipients: "+$4ri(this,r.get_$3O()));var i=new _h.$17E(200,r.get_$3O());var f=this,a=this,v=this;s.$k.$pZ(i,function(){e.set_$3Tt(i.get_$AFB());var o=e.get_$6h9();if(o&&o.length)if(i.get_$1zM()&&i.get_$1zM().length){_js.Trace.logWarning(_a.$0.$3i,i.get_$1zM().length+" recipients have no cert. Details:");for(var u=0;u<i.get_$1zM().length;u++){var s=i.get_$1zM()[u];s&&_js.Trace.logWarning(_a.$0.$3i,$4rj(f,r.get_$3o(u))+": "+$4ri(f,s))}var h=function(){f.$2gs.set_$1O(!1);f.$6Xz(n,t)};f.$2gs.$41(i.$1U,i.get_$1zM(),h,n,t);f.$2gs.set_$1O(!0)}else{_js.Trace.logInfo(_a.$0.$3i,"Retrieving certs completed. Count = "+o.length);n()}else{_js.Trace.logWarning(_a.$0.$3i,"All recipients have no cert.");f.$3hA(_u.Strings.l_Smime_CannotEncrypt_Text,741);t()}},function(){_js.Trace.logWarning(_a.$0.$3i,"Retrieving certs failed. "+i.$1d.message);if(_a.$2N.$yj(i.$1d)){_a.$2N.$X3(i.$1d,14);a.$1rS(i.$1d)}else{_js.Trace.logException(_a.$0.$3i,i.$1d,"GetCerts action failed.");a.$3hA(_u.Strings.l_Smime_CannotEncrypt_Text,729)}t()},function(){if(i.get_$2Mq()&&i.get_$2Mq().length>0){_js.Trace.logWarning(_a.$0.$3i,i.get_$2Mq().length+" errors occurred in GetCerts OWS call:");for(var n=0;n<i.get_$2Mq().length;n++)_js.Trace.logError(_a.$0.$3i,"#"+n+": "+i.get_$2Mq()[n])}})},$9tV:function(){if(this.$Xx){_js.Trace.logInfo(_a.$0.$l,"User selected from persona");this.$Xx.set_$2L(!0);this.$41P&&this.$41P()}else _js.Trace.logInfo(_a.$0.$l,"User tries to select from persona, but it is null")},$9Zl:function(){this.$3PB(!1)},$7qz:function(){_js.Trace.logInfo(_a.$0.$l,"User chose to delete from persona");this.set_$2zH(null);this.get_$14S().set_$Hr(!0)},$7Yg:function(){this.$2fV(this.get_$14S().$3F,!0)},$4QD:function(n,t){$739(this)},$3pO:function(){return new _d.$KE(this.$1C.$g.$7F,this)},$9ZD:function(n,t){this.$1IS.$1t();$3bE(this,this.$B1);$3bE(this,this.$B5);$3bE(this,this.$Bs)},$2ao:function(n,t){this.$B1.get_$nI()||this.$B5.get_$nI()||this.$Bs.get_$nI()||this.$1C.$g.$x.$5Z(65);this.$B1.get_$Cb()&&this.$B5.get_$Cb()&&this.$Bs.get_$Cb()||this.$1C.$g.$x.$5Z(70);_y.$x.$w.get_$W5()&&$4rn(this,!1);if(t&&t.$2Z===2){var i=this.$1C.$g.get_$4Az();i.get_$D2()||i.$41();i.$6W8();if(_a.$61.$2v){var r=this;_js.$J.get_$I().$40(_a.$0.$In,"TriggerPolicyTipsIfNeeded",function(){if(r.$1C&&r.$1C.$g){var n=r.$1C.$g.get_$6Rp();n.$1KF(1)}})}}},$9XU:function(){this.set_$5kZ(!1)},$17h:function(){_d.$4x.$F8(this.$1C)},$9zx:function(){_a.$6.stPT(_a.$0.$l,"MailComposeShowBcc",3);var t=_a.$6.$1X(_a.$0.$l,"MailComposeShowBcc",!0);_js.Trace.logInfo(_a.$0.$l,"User chose to show bcc");this.$141();var n=this.$1C.$g.$d;if(!n.get_$nW()){n.set_$nW(!0);_d.$4x.$F8(this.$1C);$4rp(this)}_a.$6.$19(t);_a.$6.endPT("MailComposeShowBcc")},$8Dz:function(){_a.$6.stPT(_a.$0.$l,"MailComposeHideBcc",3);var t=_a.$6.$1X(_a.$0.$l,"MailComposeHideBcc",!0);_js.Trace.logInfo(_a.$0.$l,"User chose to hide bcc");this.$141();var n=this.$1C.$g.$d;if(n.get_$nW()){n.set_$nW(!1);_d.$4x.$F8(this.$1C);$4rp(this)}_a.$6.$19(t);_a.$6.endPT("MailComposeHideBcc")},$7ud:function(){var n=this.$Xx.get_$1u().get_$1l().EmailAddress;this.set_$2zH(null);this.get_$14S().set_$7D(n);this.get_$14S().set_$Hr(!0)},$A0i:function(){_a.$6.stPT(_a.$0.$l,"MailComposeShowFrom",3);var t=_a.$6.$1X(_a.$0.$l,"MailComposeShowFrom",!0);var n=this.$1C.$g.$d;if(n.get_$Uf())_js.Trace.logInfo(_a.$0.$l,"Skip show from since it is already shown");else{_js.Trace.logInfo(_a.$0.$l,"User chose to show from");this.$458=!0;$4rk(this);_d.$4x.$F8(this.$1C);$73F(this)}n.get_$QH()&&this.$1C.$g.$x.$2j(750);_a.$6.$19(t);_a.$6.endPT("MailComposeShowFrom")},$8EB:function(){_a.$6.stPT(_a.$0.$l,"MailComposeHideFrom",3);var t=_a.$6.$1X(_a.$0.$l,"MailComposeHideFrom",!0);var n=this.$1C.$g.$d;if(n.get_$Uf()){n.set_$Uf(!1);this.$458=!1;_d.$4x.$F8(this.$1C);if(_y.$x.$w.get_$L()==="Mouse"){var i=this.$1C.$3c(18);i.$6np()}else{var r=this.$1C.$g.$3y;r.$4WN(this.get_$32M(),this.get_$2C4())}}else _js.Trace.logInfo(_a.$0.$l,"Skip hide from since it is already hidden");this.$1C.$g.$x.$5Z(750);_a.$6.$19(t);_a.$6.endPT("MailComposeHideFrom")}};_d.$KE=function(n,t){this.$$d_$4Pt=Function.createDelegate(this,this.$4Pt);this.$$d_$4P2=Function.createDelegate(this,this.$4P2);this.$$d_$5oS=Function.createDelegate(this,this.$5oS);_d.$KE.initializeBase(this);this.$7F=n;this.$5qK=t};_d.$KE.prototype={$7F:null,$4XY:null,$4X:null,$Wu:null,$Lb:!1,$5qK:null,$18Q:null,$2h9:null,$3F:null,get_$bn:function(){return this.$4X},set_$bn:function(n){if(this.$4X!==n){this.$4X=n;$N(this,"ReadWriteRecipientWellViewModel")}return n},get_$9qk:function(){this.$4XY||(this.$4XY=new _C(this.$$d_$5oS,_a.$0.$dz));return this.$4XY},get_$9la:function(){return this.$Wu},set_$9la:function(n){if(n!==this.$Wu){this.$Wu=n;$N(this,"ReadOnlyRecipientWellViewModel")}return n},get_$Cb:function(){var o=this.$Lb&&_y.$2W.$Cb(this.$4X);if(this.$Lb){var i;var n;var s="";var t="";var r="";var u="";if(this.$4X){for(var f=0;f<this.$4X.$1U.get_$C();f++){i=this.$4X.$1U.get_$3o(f);if(i){s=i.$5B.$Gx;r=r+" "+s}}for(var e=0;e<this.$4X.$8i.get_$C();e++){n=this.$4X.$8i.get_$3o(e);if(n){t="";_js.$8.$15(n.EmailAddress)?_js.$8.$15(n.Name)||(t=n.Name):t=n.EmailAddress;u=u+" "+t}}}_js.Trace.logInfo(_a.$0.$e9,"{0} Well Is empty? {1} \n Recipients are: {2} \n Addresses are: {3} \n",this.$18Q,o,r,u)}return o},get_$nI:function(){return this.$Lb&&!$5(this.$4X)&&this.$4X.$1Ph},$1KG:function(){this.$Lb&&this.$4X&&this.$4X.$AAF()},$8Gb:function(n,t,i){this.$2h9=n;this.$Lb=t;this.$4X?this.$4X.$3OC(null):this.set_$bn(this.$5Lv(null));var r=this.$4X.get_$6A();if(r){r.set_$7D("");r.$5bd(this.$2h9)}else this.$4X.$Y("FindRecipientViewModel",this.$$d_$4P2);this.$18Q=i},$41:function(n,t,i,r){this.$Lb=i;this.$3F=t;if(i){this.$4X?this.$4X.$3OC(n):this.set_$bn(this.$5Lv(n));var u=this.$4X.get_$6A();if(u){!_js.$8.$a(u.get_$7D())&&_js.$8.$a(t)&&u.set_$7D(t);_js.$8.$a(t)||u.set_$7D(t)}else this.$4X.$Y("FindRecipientViewModel",this.$$d_$4P2);this.$18Q=r}else this.$Wu?this.$Wu.$3OC(n):this.set_$9la(this.$7nc(n))},$1wt:function(){$5(this.$4X)||this.$4X.$1wt()},$1DF:function(){this.$4X&&this.$4X.$1DF()},$2EE:function(){if(!$5(this.$4X)){this.$4X.set_$2EE(!0);this.$4X.set_$2EE(!1)}},$1DU:function(){var n;n=this.$Lb?$5(this.$4X)?0:!this.$4X.get_$6A()||_js.$8.$a(this.$4X.get_$6A().get_$7D())?this.$4X.$8i.get_$C():this.$4X.$8i.get_$C()+1:$5(this.$Wu)?0:this.$Wu.$8i.get_$C();return n},$39b:function(){if(this.$4X){for(var u="",f="",i="",r,n,t=0,e=this.$4X.$1U.get_$C();t<e;t++){r=this.$4X.$1U.get_$3o(t);if(r&&!r.$Ne){n=this.$4X.$8i.get_$3o(t);if(n){f=_js.$8.$15(n.Name)?"":n.Name;u=_js.$8.$15(n.EmailAddress)?"":n.EmailAddress;var o=String.format("( {0} , {1} ),",f,u);i+=o}}}i!==""&&_js.Trace.logInfo(_a.$0.$l,"{0} Well Invalid Recipients are: {1} \n",this.$18Q,i)}},$49:function(){if(!$5(this.$4X)){this.$4X.set_$4bV(!1);this.$4X.$1R();this.$4X=null}},$5Lv:function(n){return this.$7F.$2uB(_d.$KE.$29W,_y.$17.$XR,n)},$7nc:function(n){return this.$7F.$mj(_d.$KE.$6Uu,_y.$17.$XR,n,1)},$4P2:function(n,t){var r=n;var i=r.get_$6A();if(this.$2h9&&this.$2h9.get_$C()>0){i.set_$7D("");i.$5bd(this.$2h9)}_js.$8.$15(this.$3F)||i.set_$7D(this.$3F);r.$q("FindRecipientViewModel",this.$$d_$4P2)},$5oS:function(){if(this.$Lb&&!OwaApplication.$jA){_js.Trace.logInfo(_a.$0.$l,"User chose to launch rich people picker");this.$4X.$1DF();_a.$g.$8n.$D("VM.PeoplePicker.Launched",_a.$7.get_$2F());_a.$6.stPT(_a.$0.$dz,"PeoplePicker",3);_a.$6.$1X(_a.$0.$dz,"PeoplePicker");this.$5qK.$7dN(this.$4X.$1U,this.$18Q,this.$$d_$4Pt)}},$4Pt:function(n){_y.$x.$w.get_$L()!=="TouchNarrow"&&this.$4X.$1U.$1t();var t=this;n.$Bd(function(n){var i=n;i.$Ne?t.$4X.$1rU(i.$CB):t.$4X.$2Gt(i.$CB)})}};_d.$4x=function(n){this.$$d_$4P9=Function.createDelegate(this,this.$4P9);this.$$d_$bq=Function.createDelegate(this,this.$bq);_d.$4x.initializeBase(this,[14,n])};_d.$4x.$F8=function(n){var t=n.$3c(14);t&&t.$bq();var i=n.$3c(1);i&&i.$2EE()};_d.$4x.prototype={$4jc:!1,get_$1lk:function(){return this.$W(_d.$4x.$4X1)},set_$1lk:function(n){this.$M(_d.$4x.$4X1,n);return n},$41:function(){var n=this.$1C.$g;var t=n.$d;if(!this.$4jc){_y.$x.$w.add_$p8(this.$$d_$bq);this.$4jc=!0;_g.$V.get_$I().get_$5U().add_$1cS(this.$$d_$4P9)}this.$bq();_js.Trace.logInfo(_a.$0.$l,"Resize editor component initialized and resize editor called");_d.$9q.prototype.$41.call(this)},$bq:function(){this.$8Hy()},$AG:function(){_y.$x.$w.remove_$p8(this.$$d_$bq);this.$4jc=!1;_g.$V.get_$I().get_$5U().remove_$1cS(this.$$d_$4P9);_js.Trace.logInfo(_a.$0.$l,"Editor resize component reset");_d.$9q.prototype.$AG.call(this)},$8Hy:function(){!$5(this.get_$1lk())&&this.get_$1lk().$2T&&this.get_$1lk().$s()},$4P9:function(n,t){this.$bq()}};_d.$6l=function(n,t,i){this.$$d_$7sc=Function.createDelegate(this,this.$7sc);this.$$d_$7sd=Function.createDelegate(this,this.$7sd);this.$$d_$BS=Function.createDelegate(this,this.$BS);this.$Ip={};_d.$6l.initializeBase(this,[8,n]);this.$2D=t;this.$DO=new _C(this.$$d_$BS,this.get_$1a());this.$HA=n.$g.$HA;this.$1H=i};_d.$6l.$5TA=function(n){var t=null;_h.$4R.isInstanceOfType(n)?t=n.$5S:_h.$4z.isInstanceOfType(n)&&(t=n.$5S);return t};function $4rt(n,t){var f=n.$1C;var o=f.$g;var e=o.$d;var i=t.$5H;var r=!1;if(n.$HA.$jI(i)){e.get_$7t()===i&&(n.$Ip={});$2FN(n,t);var s=_d.$6l.$5TA(t);if(s){_js.Trace.logInfo(_a.$0.$l,"Resume discard for context "+i);f.$3c(21).$3PP(i,s)}r=!0}else if(i===e.get_$7t()){if(n.$1n2){n.$1n2=!1;_js.Trace.logInfo(_a.$0.$l,"User issued send while save was in progress, now the save had come back, resume the send and cancel any pending saves. ContextId="+i);n.$Ip={};$2FN(n,t);var u=null;_h.$4R.isInstanceOfType(t)?u=t.$5S:_h.$4z.isInstanceOfType(t)&&(u=t.$5S);u&&e.set_$9x(u);var h=f.$3c(7);h.$2f9();r=!0}else if(n.$31c){_js.Trace.logInfo(_a.$0.$l,"Saving new content per user's request. ContextId="+i);n.$3PR();r=!0}}else _js.Trace.logInfo(_a.$0.$l,"Skipping default save processing due to ContextId="+i+"; viewModelId="+o.$d.get_$7t());return r}function $4rs(n){var t="";var i=n.$Ip;for(var r in i){var u={key:r,value:i[r]};t+=u.key+":"}_js.Trace.logInfo(_a.$0.$l,"ProcessorKeys:"+t)}function $73G(n,t){var i=n.$1C;var u=i.$g;var r=u.$d;var f=t.$5H;var o=n.$yO;if(f===r.get_$7t()){$73H(n,t);r.$34r=!1}$ex(n,"MailSaveSucceeded");if(f===r.get_$7t()&&o){var s=_a.$7.get_$2F();var e=u.$x;e.$Db(_d.$6l.$TX);e.$2j(1001,s.$2b(0));_d.$4x.$F8(i)}if(_a.$61.$2v){var h=i.$3c(25);h.$1KF(n.$yO?4:2)}$2FN(n,t)}function $4rq(n,t){_js.Trace.logInfo(_a.$0.$l,"SaveActionFailed: Error: {0}",t.$1d.message);t.$5H===n.$1C.$g.$d.get_$7t()&&n.$59r(t);var i=n.$1C.$g;i.$jf&&i.set_$yW(!1);$2FN(n,t)}function $2FN(n,t){var i=n.$1C;var r=i.$g.$d;if(t.$5H===r.get_$7t()){n.set_$Aq(!1);n.$yO=!1}_a.$6.endPT("MailComposeSave")}function $4rr(n,t){var i=null;_h.$4R.isInstanceOfType(t)&&t.$5w?i=t.$5w.correlationId:_h.$4z.isInstanceOfType(t)&&t.$5w&&(i=t.$5w.correlationId);return i}function $3bF(n,t,i){var r=new _a.$6I;r.$6w("Ctx",t||"");r.$6w("Err",i||"");return r.toString()}function $73H(n,t){var i=n.$1C.$g.$d;i.set_$J1(n.$3Tx);if(n.$yO){i.set_$rd(!0);n.$yO=!1;_js.Trace.logInfo(_a.$0.$l,"Explicit save recorded. ContextId="+i.get_$7t())}if(_h.$3L.isInstanceOfType(t)){var r=t;var u=r.$5S;r.$P.set_$i(u);i.set_$9x(u);i.set_$Sn(r.$P);_js.Trace.logInfo(_a.$0.$l,"Updated context from create action. Context:"+i.toString());n.$2D.$7tp(u)}else if(_h.$4z.isInstanceOfType(t)){var f=t;var e=f.$5S;f.$A1.set_$i(e);i.set_$9x(e);i.set_$Sn(f.$A1);_js.Trace.logInfo(_a.$0.$l,"Updated context from update action. Context:"+i.toString())}else if(_h.$Cr.isInstanceOfType(t)){var l=t;var a=l.$5S;i.set_$9x(a);_js.Trace.logInfo(_a.$0.$l,"Updated context from create response action. Context:"+i.toString())}else if(_cc.$RC.isInstanceOfType(t)){var o=t;var v=o.meetingResponseMessageId;i.set_$9x(v);i.set_$Sn(o.$Ge);_js.Trace.logInfo(_a.$0.$l,"Updated context from create meeting response message. Context:"+i.toString())}else if(_c.$bW.isInstanceOfType(t)){var y=t;var p=y.$5S;i.set_$9x(p);_js.Trace.logInfo(_a.$0.$l,"Updated context from create approval response action. Context:"+i.toString())}if(_h.$4R.isInstanceOfType(t)&&i.get_$Sn()){var w=t;var s=w.$2q9;var h=i.get_$Sn().get_$8j();if(s&&h){var c=0;var b=this;h.$Bd(function(n){var t=n;t.set_$3l(s[c]);c++});_js.Trace.logInfo(_a.$0.$l,"Attachment IDs have been updated.")}}}_d.$6l.prototype={$HA:null,$DO:null,$1H:null,$Cd:!1,$yO:!1,$31c:!1,$3Tx:null,$1n2:!1,$lJ:null,$3Q1:null,$2D:null,get_$Aq:function(){return this.$Cd},set_$Aq:function(n){if(n!==this.$Cd){this.$Cd=n;$N(this,"IsSaving")}return n},$BS:function(){this.$4im(null)},$4im:function(n){var t=this.$1C;var r=t.$3c(5);var u=t.$g.$1v;var i=t.$g.$d;_js.Trace.logInfo(_a.$0.$l,"SaveStart:Context:"+i.toString());$1q8(this);if(!i.get_$47Q()){_js.Trace.logInfo(_a.$0.$l,"Save not supported for the current operation {0}",i.get_$3w());return}if(r.get_$Bz()){_js.Trace.logInfo(_a.$0.$l,"Skip save and show attachment in progress dialog");u.$2u(0,_u.Strings.l_MailComposeCannotOperateWhileAttachmentInProgress_Text,null);return}this.$yO=!0;this.$1dx("Save",n,null,!1)},$1dx:function(n,t,i,r){var e=this.$1C;var f=e.$g;var u=f.$d;var a=f.$x;var o=u.get_$7t();var p=this.$1C.$g.get_$a0();var v=e.$3c(7);if(v.$Lc&&!r){_js.Trace.logInfo(_a.$0.$l,"Send is in progress, this "+n+" save is ignored. ContextId="+o);return!0}if(this.$HA.$jI(o)){_js.Trace.logInfo(_a.$0.$l,"User already discarded, clearing all save processors to ignore save effects. ContextId="+o);this.$Ip={};return!1}var h=e.$3c(1);h.$1DF();if(_g.$V.get_$I().get_$4Ba()<h.$1DU()){a.$2j(800,null);_d.$4x.$F8(e);return!0}h.$2j0();u.$J8.$s();this.$Ip[n]=new _d.$1CF(t,i);if(!this.$Cd||r){this.$3Tx=_d.$1m.$1tF(u);this.set_$Aq(!0)}else{this.$31c=!this.$3Tx.$5S3(u);return!0}if(!u.get_$Eb()&&!u.get_$9x()&&!u.get_$1KQ()){_js.Trace.logInfo(_a.$0.$l,"Save was attempted during upgrade, remembering this save attempt and waiting for upgrade completion to resume this save. ContextId="+o);return!0}_a.$6.stPT(_a.$0.$l,"MailComposeSave",5);this.$lJ=_y.$2V.$1X(_a.$0.$l,"MailComposeSave",!0);this.$3Q1=n;_js.$J.get_$I().$19I(_a.$0.$l,"MailComposeSave");_js.Trace.logInfo(_a.$0.$l,"Started new task runner context before starting save.");var l=!0;try{if(u.get_$QH()){_js.Trace.logInfo(_a.$0.$3i,"Saving a S/MIME message...");if(!$4rI(this))return!0}_js.Trace.logInfo(_a.$0.$b8,"Setup save action, context:"+u.toString()+"; OriParentFolderId="+(u.get_$Ch()&&u.get_$Ch().get_$28()&&_g.$h.$1i?_g.$h.$1i.idToName(u.get_$Ch().get_$28()):"null"));var s=f.$Ve.$3oT(f,0,this.$1H);if((_h.$3L.isInstanceOfType(s)||_h.$4z.isInstanceOfType(s))&&("Attach"===n||"Popout"===n)&&u.get_$jh()){var y=s;y.$pD=new _g.$CI(new _g.$7N("internalsubmission"))}f.$k.$pZ(s,this.$$d_$7sd,this.$$d_$7sc,null);l=!1;_js.Trace.logInfo(_a.$0.$l,"Save action submitted");return!0}catch(c){_y.$2V.$19(this.$lJ,null,c.toString(),null,$3bF(this,this.$3Q1,c.message));this.$lJ=null;throw c;}finally{if(l){this.set_$Aq(!1);this.$yO=!1;_a.$6.endPT("MailComposeSave");_js.Trace.logWarning(_a.$0.$l,"Save failed due to an unhandled exception before action was submitted")}}},$AG:function(){this.$Cd=!1;this.$31c=!1;this.$yO=!1;this.$1n2=!1;this.$Ip={};this.$3Tx=null;_d.$9q.prototype.$AG.call(this)},$3PR:function(){this.$Cd=!1;this.$31c=!1;_js.Trace.logInfo(_a.$0.$l,"ResumeSave:Context:"+this.$1C.$g.$d.toString());var n=this.$Ip;for(var t in n){var i={key:t,value:n[t]};var r=i.value;this.$1dx(i.key,r.$2D0,r.$2yF,!0);break}},$83Z:function(n){return _y.$5u.$3kl(n.$1d,40,50,60,700,88,89,43,57)},$59r:function(n){if("InlineExit"in this.$Ip||"Popout"in this.$Ip){var i=this.$1C.$g;var t=i.$x;var r=this.$83Z(n);var f=new _y.$r2;var u=f.$2x(r,null);t.$Db(_d.$Bv.$TX);"InlineExit"in this.$Ip?t.$2j(87,u):t.$2j(85,u);r===50&&i.$1TZ.$59p(t);_d.$4x.$F8(this.$1C)}else"Save"in this.$Ip&&_d.$9q.prototype.$59r.call(this,n)},$7sd:function(n){var i=this.$1C;var e=i.$g;var r=e.$d;var o=i.$3c(21);var u=n.$5H;_js.Trace.logInfo(_a.$0.$l,"Save action returned success, ContextId="+u+"; Context:"+r.toString());if(!$4rt(this,n)&&u===r.get_$7t()){$73G(this,n);$4rs(this);var t=null;if("Attach"in this.$Ip){if("AutoSave"in this.$Ip){t=this.$Ip.AutoSave;t&&t.$2D0(n)}t=this.$Ip.Attach}else if("Popout"in this.$Ip){t=this.$Ip.Popout;var f=i.$3c(9);if(f&&f.$2jY&&"InlineExit"in this.$Ip){t&&t.$2D0(n);t=this.$Ip.InlineExit}}else"InlineExit"in this.$Ip?t=this.$Ip.InlineExit:"AutoSave"in this.$Ip?t=this.$Ip.AutoSave:"Save"in this.$Ip&&(t=this.$Ip.Save);t&&t.$2D0&&t.$2D0(n);this.$Ip={}}_y.$2V.$19(this.$lJ,null,"",$4rr(this,n),$3bF(this,this.$3Q1,""));this.$lJ=null},$7sc:function(n){var r=this.$1C.$g.$d;var u=n.$5H;_js.Trace.logInfo(_a.$0.$l,"Save action returned a failure, ContextId="+u+"; Context:"+r.toString());if(!$4rt(this,n)&&u===r.get_$7t()){$4rs(this);var t=!1;var f=this.$Ip;for(var e in f){var i={key:e,value:f[e]};var o=i.value;if(o.$2yF){o.$2yF(n);if((i.key==="InlineExit"||i.key==="Popout")&&!t){$4rq(this,n);t=!0}}else if(!t){$4rq(this,n);t=!0}}t||$2FN(this,n);this.$Ip={}}var s=_d.$B6.$1xS(n.$1d)||"SaveFailure_UnknownError";var h=_d.$B6.$1co(n.$1d);_y.$2V.$19(this.$lJ,null,s,$4rr(this,n),$3bF(this,this.$3Q1,h));this.$lJ=null}};_d.$Ez=function(n){this.$$d_$7rB=Function.createDelegate(this,this.$7rB);_d.$Ez.initializeBase(this,[20,n])};_d.$Ez.$2u1=function(n,t){return new _0365m.$o(n,null,t,!0)};function $2l6(n,t){var i=this;return function(){_js.Trace.logInfo(_a.$0.$l,"User chose from="+t);n.$1C.$g.get_$Kx().$2fV(t,!0)}}_d.$Ez.prototype={get_$Hu:function(){return this.$W(_d.$Ez.$1FZ)},set_$Hu:function(n){this.$M(_d.$Ez.$1FZ,n);return n},$41:function(){if($5(this.get_$Hu())){var n=this.$AJQ(_0365m.$o,_d.$Ez.$2u1);if(n){this.set_$Hu(new _0365m.$2c(n));this.get_$Hu().set_$7ix(new _C(this.$$d_$7rB,this.get_$1a()))}}_d.$9q.prototype.$41.call(this)},$AG:function(){this.get_$Hu()&&this.set_$Hu(null);_d.$9q.prototype.$AG.call(this)},$2oJ:function(n,t){if(this.get_$Hu()){for(var u=_d.$Ez.$2u1(n,new _C($2l6(this,n),this.get_$1a())),i=this.get_$Hu().$14,r=i.get_$C()-1;r>0;r--)if(_0365m.$8w.isInstanceOfType(i.get_$3o(r))){i.$6r(r+1,u);var f=i.get_$C()-r-1;f>t&&i.$6C(i.get_$C()-1);return}i.$D(new _0365m.$8w);i.$D(u)}},$7rB:function(){if(this.get_$Hu()&&this.get_$Hu().$12){var u=this.get_$Hu().$12;var i=_g.$V.get_$I().get_$13().get_$2f7();var e=i.$34(u.$2E);if(e){for(var n=this.get_$Hu().$14,t=n.get_$C()-1;t>0;t--)if(n.get_$3o(t).$2E===u.$2E){n.$6C(t);var f=n.get_$C();_0365m.$8w.isInstanceOfType(n.get_$3o(f-1))&&n.$6C(f-1);break}var r=new(_a.$Z.$$(String));i.get_$C()>0?r.$3o8(i):r.$D("");_g.$V.get_$I().get_$13().set_$2f7(r);_h.$2D.$CL(_g.$V.get_$I().get_$13().$DB,OwaApplication.$1W)}}},$AJQ:function(n,t){var o=_g.$V.get_$I().get_$2z().get_$3nV();var c=$5(o)?0:o.get_$C();var u=_g.$V.get_$I().get_$13().get_$2f7();var r=$5(u)?0:u.get_$C();if(r===1&&u.get_$3o(0)===""){u.$6C(0);r=0}var l=r>0?1:0;var f=new Array(1+c+r+l);var e=0;var i=_g.$V.get_$I().get_$2z().get_$AM();f[e++]=t(i,new _C($2l6(this,i),this.get_$1a()));for(var s=0;s<c;s++){i=o.get_$3o(s).EmailAddress;f[e++]=t(i,new _C($2l6(this,i),this.get_$1a()))}if(r>0){f[e++]=new _0365m.$8w;for(var h=0;h<r;h++){i=u.get_$3o(h);f[e++]=t(i,new _C($2l6(this,i),this.get_$1a()))}}return f}};_d.$7F=function(n,t){this.$$d_$9tz=Function.createDelegate(this,this.$9tz);this.$$d_$9u7=Function.createDelegate(this,this.$9u7);this.$$d_$9uP=Function.createDelegate(this,this.$9uP);this.$$d_$2rj=Function.createDelegate(this,this.$2rj);this.$$d_$9ZB=Function.createDelegate(this,this.$9ZB);this.$$d_$9uF=Function.createDelegate(this,this.$9uF);this.$$d_$9uN=Function.createDelegate(this,this.$9uN);_d.$7F.initializeBase(this,[7,n]);this.$E4=new _C(this.$$d_$9uN,this.get_$1a());this.$1Aq=new _C(this.$$d_$9uF,this.get_$1a());this.$HA=n.$g.$HA;this.$1H=t};function $73L(n,t,i){var f=t.MessageXml;if(f)for(var e=Sys.Net.XMLDOM(f),u=0;u<e.firstChild.childNodes.length;u++){var r=e.firstChild.childNodes[u];if(r.nodeType===1&&_a.$3Q.$W7(r)==="Value"&&_a.$3Q.$5WY(r,"Name")==="HResult"&&-2147168383===Number.parseInvariant(_a.$3Q.$Ke(r))){i.val=48;return!0}}i.val=-1;return!1}function $4rw(n){_js.Trace.logInfo(_a.$0.$l,"User chose to send, start force resolve recipients");n.$374=!0;var t=n.$1C.$3c(1);t.$3PB(!0)}function $3bG(n){if(n.$d_2.get_$Fk()&&!n.$37U){var t=this,i=this;n.$g.get_$Kx().$6Xz(function(){n.set_$47f(!0);$4ru(n)},function(){n.set_$47f(!1);n.$2rj()})}else $4ru(n)}function $4ru(n){$4rI(n)?n.$2f9():n.$2rj()}function $73J(n){var i=!0;var e=n.$1C;var u=e.$g;var t=e.$3c(1);var f=e.$3c(5);var o=u.$x;var s=e.$3c(25);var r="InvalidToSend";if(n.$HA.$jI(u.$d.get_$7t())){_js.Trace.logInfo(_a.$0.$l,"User had already discarded, skipping send.");i=!1;_y.$2V.$19(n.$I7,null,r,null,"User has already discarded, skipping send");n.$I7=null}else if(t.get_$35O()){_js.Trace.logInfo(_a.$0.$l,"Not valid to send since sender's address is invalid");o.$2j(66,null);_d.$4x.$F8(n.$1C);i=!1;_y.$2V.$19(n.$I7,null,r,null,"Sender's address is invalid, not valid to send");n.$I7=null}else if(!u.$d.get_$jh()&&t.$B1.get_$Cb()&&t.$B5.get_$Cb()&&t.$Bs.get_$Cb()){_js.Trace.logInfo(_a.$0.$l,"Not valid to send since no recipients were specified");o.$2j(70,null);_d.$4x.$F8(n.$1C);i=!1;_y.$2V.$19(n.$I7,null,r,null,"No recipients were specified, not valid to send");n.$I7=null}else if(t.$B1.get_$nI()||t.$B5.get_$nI()||t.$Bs.get_$nI()){_js.Trace.logInfo(_a.$0.$l,"Not valid to send since invalid recipients are present, IsFromRecipientInvalid={0}, InvalidTo={1}, InvalidCc={2}, InvalidBcc={3}",t.get_$35O(),t.$B1.get_$nI(),t.$B5.get_$nI(),t.$Bs.get_$nI());t.$39b();o.$2j(65,null);_d.$4x.$F8(n.$1C);i=!1;_y.$2V.$19(n.$I7,null,r,null,"Invalid recipients are present, not valid to send");n.$I7=null}else if(f.get_$Bz()){_js.Trace.logInfo(_a.$0.$l,"Not valid to send since attachment is in progress");var h=u.$1v;h.$2u(0,_u.Strings.l_MailComposeCannotOperateWhileAttachmentInProgress_Text,null);i=!1;_y.$2V.$19(n.$I7,null,r,null,"Attachment is in progress, not valid to send");n.$I7=null}else if(_g.$V.get_$I().get_$4Ba()<t.$1DU()){o.$2j(800,null);_d.$4x.$F8(n.$1C);i=!1;_y.$2V.$19(n.$I7,null,r,null,"Max recipients exceeded, not valid to send");n.$I7=null}else if(_a.$61.$2v&&s.$8O9()){_js.Trace.logInfo(_a.$0.$l,"Not valid to send since policy violation detected");var c=u.$1v;c.$2u(0,s.$87o(),null);i=!1;_y.$2V.$19(n.$I7,null,r,null,"PolicyTip violation detected, not valid to send");n.$I7=null}else if(n.$d_2.get_$Uf()&&n.$d_2.get_$QH()){_a.$4Y.$2u(_u.Strings.l_Smime_NotSupportedWithFromRecipientWell_Text,1);i=!1;_y.$2V.$19(n.$I7,null,r,null,"User attempted to send an S/MIME message using the SendAs (From) feature");n.$I7=null}else if(f&&f.get_$60())try{if(n.$rN.$40R(u.$d,f.get_$60().get_$1P())){i=!1;_y.$2V.$19(n.$I7,null,r,null,"Forgotten attachment detected, not valid to send");n.$I7=null}}catch(l){_js.Trace.logException(_a.$0.$l,l,"An exception has been caught for FAD check; keep sending",n.$rN,u.$d,f.get_$60().get_$1P())}i&&s.$9wf();return i}function $4rx(n,t){if(!n.$d_2.get_$QH()||_g.$V.get_$I().get_$Tr().BccEncryptedEmailForking&&_g.$V.get_$I().get_$Tr().BccEncryptedEmailForking!==1)return!1;n.$d_2.set_$9x(null);n.$d_2.set_$Sn(null);if(t){if(!n.$2fC)return!1;if(n.$d_2.$1NJ>-1){var r=n.$d_2.get_$6I().get_$3o(n.$d_2.$1NJ);n.$d_2.$cQ.length>0&&(n.$d_2.$cQ=n.$d_2.$cQ+"; ");n.$d_2.$cQ=n.$d_2.$cQ+(r.Name||r.OriginalDisplayName||r.EmailAddress)}else for(var i=0;i<n.$d_2.get_$6I().get_$C();i++){var u=n.$d_2.get_$6I().get_$3o(i);i>0&&(n.$d_2.$cQ=n.$d_2.$cQ+"; ");n.$d_2.$cQ=n.$d_2.$cQ+(u.Name||u.OriginalDisplayName||u.EmailAddress)}}if(n.$d_2.get_$Fk()&&_g.$V.get_$I().get_$Tr().BccEncryptedEmailForking!==2)if(_g.$V.get_$I().get_$Tr().BccEncryptedEmailForking===1){if(n.$2fC<1&&n.$d_2.get_$6I().get_$C()>0){n.$d_2.$c3=3;$3bG(n);n.$2fC++;return!0}}else if(n.$d_2.$1NJ<n.$d_2.get_$6I().get_$C()-1&&n.$d_2.get_$6I().get_$C()>0){n.$d_2.$c3=2;n.$d_2.$1NJ++;$3bG(n);n.$2fC++;return!0}return!1}function $4rv(n,t){var i=null;_h.$4R.isInstanceOfType(t)&&t.$5w?i=t.$5w.correlationId:_h.$4z.isInstanceOfType(t)&&t.$5w&&(i=t.$5w.correlationId);return i}function $73K(n){var t=n.$g.get_$Kx();var i=n.$g.get_$a0();_js.Trace.logInfo(_a.$0.$l,"Check to see if we have attachments to set permissions for");i.get_$60().$6cM(t.$81G())}function $73I(n,t){if(!t)return null;var u=t.get_$3s()==="HTML"?"html":"text";var r;r=t.get_$3w()===1||t.get_$3w()===2||t.get_$3w()===3?t.get_$Eb()?"yes":"no":"na";var f=t.$4C6;var i=new _a.$6I;i.$6w("BT",u);i.$6w("U",r);i.$5I("S",f);return i.toString()}_d.$7F.prototype={$HA:null,$1Aq:null,$1H:null,$E4:null,$Lc:!1,$37U:!1,$374:!1,$rN:null,$I7:null,$2fC:0,get_$jl:function(){return this.$Lc},set_$jl:function(n){if(n!==this.$Lc){this.$Lc=n;$N(this,"IsSending");var t=this.$1C.$g;t.set_$6kn(_nbs.NonBootStrings.l_Sending_Text);t.set_$6ed(n)}return n},get_$47f:function(){return this.$37U},set_$47f:function(n){if(n!==this.$37U){this.$37U=n;$N(this,"IsSmimeEncryptionCertsRetrieved")}return n},$41:function(){if(!this.$rN){var t=this.$1C.$g;this.$rN=t.$1wv.$5L2(t.$1v,this.$E4)}var n=this.$1C.$3c(1);if(n){n.remove_$6Me(this.$$d_$9ZB);n.remove_$6Md(this.$$d_$2rj);n.add_$6Me(this.$$d_$9ZB);n.add_$6Md(this.$$d_$2rj)}_d.$9q.prototype.$41.call(this)},$AG:function(){this.set_$jl(!1);_d.$9q.prototype.$AG.call(this)},$2f9:function(){var i=this.$1C;var t=i.$g;var n=t.$d;var r=i.$3c(8);if(r.$Cd){r.$1n2=!0;_js.Trace.logInfo(_a.$0.$l,"Send deferred due to in progress save.")}if(n.get_$Eb()||n.get_$9x()||n.get_$1KQ()){if(!r.$1n2){var f=i.$3c(5);f.$8HO();var e=this.$1C.$3c(1);e.$2j0();_js.Trace.logInfo(_a.$0.$l,"Send without pending saves, context:"+n.toString()+"; OriParentFolderId="+(n.get_$Ch()&&n.get_$Ch().get_$28()&&_g.$h.$1i?_g.$h.$1i.idToName(n.get_$Ch().get_$28()):"null"));var o=t.$Ve.$3oT(t,1,this.$1H);_js.Trace.logInfo(_a.$0.$l,"Submitting send action");t.$k.$pZ(o,this.$$d_$9uP,this.$$d_$9u7,this.$$d_$9tz);_js.Trace.logInfo(_a.$0.$l,"Send action submitted")}}else{var u=n.get_$7t();_js.Trace.logInfo(_a.$0.$l,"Send was attempted during upgrade for context "+u+", keeping the IsSending state and waiting for upgrade to finish. Upgrade component will resume send.")}},$5Sl:function(){var n=this;_js.$J.get_$I().$1s(_a.$0.$l,"ExitResolvingRecipientsMode",function(){n.$374=!1},2e3)},$7Yv:function(n){if(n&&n.Mailbox){var r=n.Mailbox.EmailAddress;if(r!==_g.$V.get_$I().get_$2z().get_$AM()&&!_h.$3L.$2zl(n)){var t=_g.$V.get_$I().get_$13().get_$2f7();if(!$5(t)){if(t.$76(r))return;t.get_$C()===1&&t.get_$3o(0)===""&&t.$6C(0)}var i=new(_a.$Z.$$(String));i.$D(r);i.$3o8(t);i.get_$C()>_d.$7F.$4Bb&&i.$6C(i.get_$C()-1);_g.$V.get_$I().get_$13().set_$2f7(i);_h.$2D.$CL(_g.$V.get_$I().get_$13().$DB,OwaApplication.$1W);var u=this.$1C.$3c(20);u.$2oJ(r,_d.$7F.$4Bb)}}},$83Z:function(n){var t;var i=_a.$3.$30d(n.$1d);if(i==="ErrorSendAsDenied")t=80;else{var r,u;i==="ErrorRightsManagementPermanentException"&&(u=$73L(this,n.$1d,r={val:t}),t=r.val,u)||(t=i==="ErrorSubmissionQuotaExceeded"?47:_y.$5u.$3kl(n.$1d,45,55,62,700,88,89,46,58))}return t},$9uN:function(){_a.$6.stPT(_a.$0.$l,"VM.MailCompose.Send",5);this.$I7=_y.$2V.$1X(_a.$0.$l,"MailComposeSend",!0);_js.Trace.logInfo(_a.$0.$l,"SendStart:Context:"+this.$d_2.toString());$1q8(this);if(this.$d_2.get_$I8()){var t=this;var n=function(n){_y.$2V.$19(t.$I7,null,_js.$1i.$9S(_y.InfoBarMessageId,n));t.$I7=null;_a.$6.endPT("VM.MailCompose.Send");t.$d_2.set_$1Je(null);t.$2rj();n!==-1&&t.$3hA(_u.Strings.l_Smime_CannotSend_Text,n)};var r=!1;this.$d_2.get_$1Je()||this.$d_2.set_$1Je($72u(this,2,13));if(this.$d_2.get_$1Je()){var i=new _h.$kF(200,this.$d_2.get_$1Je(),!0);var u=this,f=this;this.$1C.$g.$k.$pZ(i,function(){_js.Trace.logInfo(_a.$0.$3i,"Retrieving certs info completed.");r=i.get_$hJ().IsValid;if(r)$4rw(u);else{_js.Trace.logWarning(_a.$0.$3i,"Retrieving certs info determined the certificate is INVALID.");switch(i.get_$hJ().ChainValidityStatus){case 2148204809:case 2148204813:case 2148204810:case 1:n(746);break;case 2148081680:case 2148204812:n(745);break;case 2148081682:case 2148204814:case 2148081683:case 2148098052:n(743);break;default:n(744);break}}},function(){r=!1;_js.Trace.logWarning(_a.$0.$3i,"Retrieving certs info failed. "+i.$1d.message);n(743)},null)}else{n(-1);_js.Trace.logWarning(_a.$0.$3i,"The send is canceled due to unavailable cert.")}}else $4rw(this)},$2rj:function(){var i=this.$1C.$g.$x;var t=this.$1C.$g.get_$Kx();var n=null;this.set_$jl(!1);this.set_$47f(!1);if(t.$B1.get_$nI()||t.$B5.get_$nI()||t.$Bs.get_$nI()){i.$2j(65,null);n=_js.$1i.$9S(_y.InfoBarMessageId,65);OwaApplication.get_$Xr().$9lH(_a.$GX,new _a.$GX(_u.Strings.l_MailComposeInvalidRecipientsError_Text))}if(t.get_$35O()){i.$2j(66,null);n=_js.$1i.$9S(_y.InfoBarMessageId,66)}_d.$4x.$F8(this.$1C);this.$5Sl();if(this.$I7){n=n||"CancelSend_UnknownError";_y.$2V.$19(this.$I7,null,n);this.$I7=null}},$9ZB:function(){var n=this.$g.get_$Kx();if(this.$Lc){_js.Trace.logInfo(_a.$0.$l,"Skip send since another send is in progress");return}this.set_$jl(!0);this.$374=!0;_js.$J.get_$I().$19I(_a.$0.$l,"MailComposeSend");_js.Trace.logInfo(_a.$0.$l,"Started new task runner context before starting send.");var i=!0;try{if($73J(this))if(this.$d_2.get_$QH()){this.$2fC=0;this.$d_2.$1NJ=-1;this.$d_2.$cQ="";if(this.$d_2.get_$Fk())switch(_g.$V.get_$I().get_$Tr().BccEncryptedEmailForking){case 0:case 1:if(n.$88p()>0||n.$88o()>0)this.$d_2.$c3=1;else if(n.$88n()>0)if(_g.$V.get_$I().get_$Tr().BccEncryptedEmailForking)this.$d_2.$c3=3;else{this.$d_2.$c3=2;this.$d_2.$1NJ=0}break;case 2:this.$d_2.$c3=0;break;default:this.$d_2.$c3=0;break}else this.$d_2.$c3=0;_js.Trace.logInfo(_a.$0.$3i,"SmimeBccMode is set to "+this.$d_2.$c3);$3bG(this)}else this.$2f9();else this.set_$jl(!1);i=!1}catch(t){_y.$2V.$19(this.$I7,null,t.toString(),null,t.message);this.$I7=null;throw t;}finally{if(i){this.set_$jl(!1);_js.Trace.logWarning(_a.$0.$l,"Send failed due to an unhandled exception thrown before the action was submitted")}}},$9uP:function(n){var e=this.$1C;var i=e.$g;var t=i.$d;var u=n.$5H;_js.Trace.logInfo(_a.$0.$l,"Send action succeeded, ContextId="+u+"; Context:"+t.toString());$73K(this);if(!$4rx(this,!1)){t.get_$2T0()&&this.$7Yv(t.get_$3U());if(t.$cQ&&t.$cQ.length>0){var o=this.$1C.$g.$x;o.$2j(742,t.$cQ);_js.Trace.logInfo(_a.$0.$l,"Showing infobar message for Bcc forking failed");this.set_$jl(!1);i.$k.$4Uw(n);_y.$2V.$19(this.$I7,null,_js.$1i.$9S(_y.InfoBarMessageId,742));this.$I7=null}else{if(u===t.get_$7t()){t.set_$J1(null);_js.Trace.logInfo(_a.$0.$l,"Context match, navigating away from compose at the end of send success. ContextId="+u);var s=e.$3c(2);i.set_$yW(!0);s.get_$4h().$2Zi(i,!0)}else _js.Trace.logInfo(_a.$0.$l,"Context does not match, skipping navigating away from compose.");$ex(this,"MailSendSucceeded");var f=!i.get_$a0()||!i.get_$a0().get_$60()?null:i.get_$a0().get_$60().$81g();var r=$73I(this,t);r?f&&(r=r+"|"+f):r=f;_y.$2V.$19(this.$I7,null,"",$4rv(this,n),r);this.$I7=null}OwaApplication.get_$Xr().$9lH(_a.$GX,new _a.$GX(_nbs.NonBootStrings.l_MailComposeSendComponent_AT_LiveRegion_Text))}},$9u7:function(n){var r=this.$1C.$g;var t=r.$d;var u=n.$5H;_js.Trace.logInfo(_a.$0.$l,"Send action failed, ContextId="+u+"; Context:"+t.toString());if(!$4rx(this,!0)){var i=_d.$B6.$1xS(n.$1d)||"SendFailure_UnknownError";var f=_d.$B6.$1co(n.$1d);if(u===t.get_$7t()){if(t.$cQ&&t.$cQ.length>0){var e=this.$1C.$g.$x;e.$2j(65,t.$cQ)}this.set_$jl(!1);_js.Trace.logInfo(_a.$0.$l,"Context match. Showing infobar message for ResponseCode="+i);this.$59r(n)}else _js.Trace.logInfo(_a.$0.$l,"Context does not match. Skip showing infobar message for ResponseCode="+i);_y.$2V.$19(this.$I7,null,i,$4rv(this,n),f);this.$I7=null;r.$k.$4Uw(n)}},$9tz:function(n){_a.$6.endPT("VM.MailCompose.Send")},$9uF:function(){this.$1C.$g.get_$5QJ()&&this.$E4.$2T&&this.$E4.$s()}};_d.$1Aw=function(n,t){_d.$1Aw.initializeBase(this,[23,n]);this.$c=t};_d.$1Aw.prototype={$c:null,$41:function(){if(!this.get_$D2()&&this.$c.get_$4a().get_$92().get_$2hI()===2&&this.$c.get_$uw().get_$9yV().get_$8DM()){var n=this.$1C.$3c(5);_d.$Py.$35u(this.$1C.$g)&&!$5(n)&&($5(n.get_$60())||n.get_$60().$7Yx())}_d.$9q.prototype.$41.call(this)}};_d.$ET=function(n,t){this.$$d_$5Af=Function.createDelegate(this,this.$5Af);_d.$ET.initializeBase(this,[12,n]);this.$3hU=new _C(this.$$d_$5Af,this.get_$1a());this.$1H=t;this.$1A=_a.UserAgent.getInstance();this.$4q=_a.$74.$E()};_d.$ET.$3yq=function(n,t){return t?n.get_$3TZ():n.get_$11O()};function $73M(n){var t=_g.$V.get_$I().get_$13();return"Mouse"===_y.$x.$w.get_$L()?t.get_$wK():n.$1A.get_$6n()?n.$4q.$3f("MOWA.IsSignatureChanged")==="true"?n.$4q.$3f("MOWA.AutoAddSignature")==="true":!0:t.get_$2qN()}function $4ry(n,t,i){if("Mouse"===_y.$x.$w.get_$L())return _d.$ET.$3yq(t,i);if(n.$1A.get_$6n()){if(n.$4q.$3f("MOWA.IsSignatureChanged")==="true")if(n.$4q.$3f("MOWA.UseDesktopSignature")==="true")return _d.$ET.$3yq(t,i);else{var r=n.$4q.$3f("MOWA.SignatureText")||"";return i?_a.$1d.$1Bw(r):r}return i?_a.$1d.$1Bw(_c.$K2.$30I(n.$1A)):_c.$K2.$30I(n.$1A)}if(t.get_$pt())return _d.$ET.$3yq(t,i);else{var u=t.get_$3Tb()||"";return i?_a.$1d.$1Bw(u):u}}_d.$ET.prototype={$3hU:null,$1H:null,$2gi:null,$4b7:!1,$yD:null,$1A:null,$4q:null,get_$3TX:function(){return this.$2gi},set_$3TX:function(n){if(this.$2gi!==n){this.$2gi=n;$N(this,"Signature")}return n},get_$NA:function(){return this.$4b7},set_$NA:function(n){this.$4b7=n;$N(this,"ShouldAutoAddSignature");return n},$41:function(){if(this.$1C.$g.$d.get_$NA()&&$73M(this)){_a.$6.stPT(_a.$0.$l,"MailComposeAutoSig",5);var n=_a.$6.$1X(_a.$0.$l,"MailComposeAutoSig",!0);this.set_$NA(!0);this.$5Af(!0);_a.$6.$19(n);_a.$6.endPT("MailComposeAutoSig");_js.Trace.logInfo(_a.$0.$l,"Signature has been automatically added due to: contextAutoFlag=true, userOptionAutoFlag=true")}_d.$9q.prototype.$41.call(this)},$81q:function(){var t;var n=_a.UserAgent.getInstance();t=n.$9W?this.$yD?_js.$8.$4B("{0}{0}","<P></P>"):"":n.$1E7||n.$Mi?"<P><BR></P>":_js.$8.$4B("{0}{0}","<P><BR></P>");return t},$5Af:function(n){var u=null;var f=this.$1C.$g.$d;var e=_g.$V.get_$I().get_$13();if(n)f.$34r=!0;else{_a.$6.stPT(_a.$0.$l,"MailComposeInsertSig",3);u=_a.$6.$1X(_a.$0.$l,"MailComposeInsertSig",!0)}var t=f.get_$3s()==="HTML"&&this.$1H.get_$Bk();if(t){var i=$4ry(this,e,t);if(_js.$8.$a(i))_js.Trace.logInfo(_a.$0.$l,"Skipping inserting blank signature in HTML format.");else{var l=n?this.$81q():_d.$ET.$6gm;var o=l+i.replace(_d.$ET.$6VM," ");_js.Trace.logInfo(_a.$0.$l,"Insert signature for mouse html OriSig="+i+"; FormattedSig="+o);this.set_$3TX(o)}}else{var r=$4ry(this,e,t);if(_js.$8.$a(r))_js.Trace.logInfo(_a.$0.$l,"Skipping inserting blank signature in text format.");else{var s="\n\n"+r;_js.Trace.logInfo(_a.$0.$l,"Insert signature for touch text OriSig="+r+"; FormattedSig="+s);this.set_$3TX(s)}}var h=!_js.$8.$a(this.$2gi);var c=!!this.$yD;h&&c?this.$yD.$s():_js.Trace.logInfo(_a.$0.$l,"Skip insert signature due to HasSignature="+h+"; HasCommand="+c);if(!n){_a.$6.$19(u);_a.$6.endPT("MailComposeInsertSig")}}};_d.$Gz=function(n,t){this.$$d_$2PH=Function.createDelegate(this,this.$2PH);this.$$d_$6ZP=Function.createDelegate(this,this.$6ZP);this.$$d_$414=Function.createDelegate(this,this.$414);this.$$d_$3rK=Function.createDelegate(this,this.$3rK);this.$$d_$3Pz=Function.createDelegate(this,this.$3Pz);this.$$d_$6ez=Function.createDelegate(this,this.$6ez);this.$$d_$9xt=Function.createDelegate(this,this.$9xt);_d.$Gz.initializeBase(this,[11,n]);this.$4f=new _C(this.$$d_$6ez,this.get_$1a());this.$4U=t||null};_d.$Gz.$7kE=function(n){return new _y.$2Q(_y.$d.get_$2ph(),_y.$d.get_$5CM(),_nbs.NonBootStrings.l_AppsTouch_Text,n.$6l.$1nA)};function $4rz(n){var t=n.$1C.$3c(7);return t.$Lc}function $73N(n){var i=n.$1C;var f=i.$g;var e=f.$d;var c=i.$3c(7);var l=i.$3c(24);var o=!!n.$4U&&n.$4U.$3N("ComposeApps");var t;var a=new _y.$2Q(_y.$d.get_$1JE(),_y.$d.get_$2fA(),_nbs.NonBootStrings.l_SendItemMobile_Text,c.$E4);var r=new _y.$2Q(_y.$d.get_$9J(),_y.$d.get_$LH(),_nbs.NonBootStrings.l_Close1_Text,n.$4f);var s=_d.$Gz.$7kE(l);var u=$73O(n,e,i);if(u&&o){t=new Array(4);t[1]=s;t[2]=r;t[3]=u}else if(u){t=new Array(3);t[1]=r;t[2]=u}else if(o){t=new Array(3);t[1]=s;t[2]=r}else{t=new Array(2);t[1]=r}t[0]=a;_js.Trace.logInfo(_a.$0.$l,"Creating appbar. ContextId="+e.get_$7t());var h=_y.$22.$Aj(f,t,null);h.set_$1Pw("TouchNarrow"===_y.$x.$w.get_$L());f.$9up(h)}function $73P(n){if($5(n.$wc)){_js.Trace.logInfo(_a.$0.$l,"Create close confirm dialog.");var t=new _js.$c;t.$D(new _a.$2E(new _C(n.$$d_$3Pz,n.get_$1a()),_nbs.NonBootStrings.l_ConfirmDialog_Save_Text,_nbs.NonBootStrings.l_SaveConfirmDialogButtonDescription_Text));t.$D(new _a.$2E(new _C(n.$$d_$3rK,n.get_$1a()),_u.Strings.l_ConfirmDialog_Discard_Text,_u.Strings.l_DeleteConfirmDialogButtonDescription_Text));t.$D(new _a.$2E(new _C(n.$$d_$414,n.get_$1a()),_u.Strings.l_ConfirmDialog_Cancel_Text,_u.Strings.l_ReturnToMessageForEditing_Text));n.set_$5Hy(t)}}function $4s0(n){var t=n.$1C;t.$g.set_$yW(!0);var i=t.$3c(2);i.get_$4h().$2Zi(t.$g,!1)}function $73O(n,t,i){if(t.get_$2Pr())return null;var r=new(_0365f.$n.$$(_y.$32));var u=i.$3c(15);var o=i.$3c(22);if(u){u.$1Lu.$2T&&r.$D(new _y.$32(_nbs.NonBootStrings.l_NewPhotoSubmenuItemText_Text,u.$1Lu));u.$1Lv.$2T&&r.$D(new _y.$32(_nbs.NonBootStrings.l_PhotoFromGallerySubmenuItemText_Text,u.$1Lv))}else if(o)r.$D(new _y.$32(_nbs.NonBootStrings.l_AttachmentSubmenuItem_LowerCase_Text,o.$4Qd));else{var h=i.$3c(5);var f=h.$81Q();if(f&&f.length>0)for(var s=f,c=s.length,e=0;e<c;++e){var l=s[e];r.$D(l)}}var a=i.$3c(12);r.$D(new _y.$32(_nbs.NonBootStrings.l_SignatureMenuItem_LowerCase_Text,a.$3hU));return new _y.$2Q(_y.$d.get_$1Ym(),_y.$d.get_$5DL(),_nbs.NonBootStrings.l_IncludeMenuButtonText_Text,null,r.get_$3O())}_d.$Gz.prototype={$4f:null,$wc:null,$15K:!1,$4U:null,$43m:!1,get_$5Hy:function(){return this.$wc},set_$5Hy:function(n){if(n!==this.$wc){this.$wc=n;$N(this,"CloseConfirmDialogButtonData")}return n},get_$1e7:function(){return this.$15K},set_$1e7:function(n){if(n!==this.$15K){this.$15K=n;$N(this,"IsCloseConfirmDialogShown")}return n},get_$8Iq:function(){return this.$43m},set_$8Iq:function(n){if(n!==this.$43m){this.$43m=n;$N(this,"IsAppBarSetup")}return n},$9xt:function(){var i=this.$1C;var u=i.$g.$d;_js.Trace.logInfo(_a.$0.$l,"Setup appbar menu. Context: "+u.toString());var n=new(_0365f.$n.$$(_y.$32));var t=i.$3c(1);_g.$V.get_$I().get_$13().get_$1Lg()?n.$D(t.get_$412()):n.$D(t.get_$4bm());if(u.get_$2T0())if(_g.$V.get_$I().get_$13().get_$iA()){n.$D(t.get_$32M());t.$1f6=!1}else{n.$D(t.get_$2C4());t.$1f6=!0}else t.$1f6=!1;n.$D(new _y.$32(_nbs.NonBootStrings.l_CheckNamesMenuItem_LowerCase_Text,t.$18f));var f=i.$3c(6);n.$D(f.$cL);var r=i.$3c(3);if(r.$cL&&r.$3ls()){n.$D(r.$cL);r.$1eR=!0}else r.$1eR=!1;var e=i.$3c(10);n.$D(new _y.$32(_nbs.NonBootStrings.l_ShowMessageOptions_Text,e.$2CA));i.$g.$3y.set_$bB(n.get_$3O());this.set_$8Iq(!0)},$41:function(){var n=this.$1C;var t=n.$g;var i=t.$d;_js.Trace.logInfo(_a.$0.$l,"InitTouchComponent:Context:"+i.toString());if(!t.$3y){var r=n.$3c(24);$73N(this)}n.$3c(23);_d.$9q.prototype.$41.call(this)},$2PH:function(n,t){if(this.$1C.$g.$jf)return!1;else if($3b5(this)){this.$15K||this.$6ez();return!0}else if(this.$1C.$g.$d.get_$nj()&&!$4rz(this)){_js.Trace.logInfo(_a.$0.$l,"Removing unedited reply forward draft if user clicks outside the form.");this.$3rK();return!0}else{this.$1C.$g.set_$yW(!0);var r=this.$1C;var i=r.$3c(2);i&&i.get_$4h()&&i.get_$4h().set_$36H(!0);return!1}},$6ez:function(){var t=this.$1C;var i=t.$g;var n=i.$d;_js.Trace.logInfo(_a.$0.$l,"User hit close, decide whether to show the confirm dialog. Context:"+n.toString());if($4rz(this)){_js.Trace.logInfo(_a.$0.$l,"Skipping close since send is in progress. This is considered a corner case since going to local store should be quick. If this occurs frequently, an UX solution is needed.");return}if($3b5(this)){$73P(this);_js.Trace.logInfo(_a.$0.$l,"Toggle IsCloseConfirmDialogShown flag to show the dialog.");this.set_$1e7(!0)}else if(n.get_$nj()){_js.Trace.logInfo(_a.$0.$l,"Removing unedited reply forward draft on close.");this.$3rK()}else{_js.Trace.logInfo(_a.$0.$l,"Navigate away due to unmodified message.");$4s0(this)}},$414:function(){_js.Trace.logInfo(_a.$0.$l,"Hide close confirm dialog");this.set_$1e7(!1)},$3Pz:function(){_js.Trace.logInfo(_a.$0.$l,"User select save and close");var n=this.$1C;n.$g.set_$yW(!0);this.$414();var t=n.$3c(8);t.$4im(this.$$d_$6ZP)},$6ZP:function(n){$4s0(this)},$3rK:function(){_js.Trace.logInfo(_a.$0.$l,"User select discard and close");var n=this.$1C;n.$g.set_$yW(!0);this.$414();var t=n.$3c(21);t.$3sJ()}};_d.$Pz=function(n,t){this.$$d_$9dh=Function.createDelegate(this,this.$9dh);this.$$d_$7gW=Function.createDelegate(this,this.$7gW);this.$$d_$5Ik=Function.createDelegate(this,this.$5Ik);_d.$Pz.initializeBase(this,[13,n]);this.$HA=this.$1C.$g.$HA;this.$1H=t};function $73Q(n,t){t.$47G()&&n.$1C.$g.$x.$2j(3050)}function $3bH(n,t){t.$5Z(3440);t.$2j(3440,null);_d.$4x.$F8(n.$1C)}_d.$Pz.prototype={$HA:null,$1H:null,$5o2:null,$hk:null,$7cn:function(){_a.$6.stPT(_a.$0.$l,"MailComposeUpgrade",3);this.$hk=_y.$2V.$1X(_a.$0.$l,"MailComposeUpgrade",!0);var t=this.$1C.$g;var n=t.$d;var r=n.get_$7t();this.$5o2=r;if(!n.get_$Eb()){var u=this;_js.$J.get_$I().$1s(_a.$0.$l,"ShowUpgradeMessage",function(){n.get_$Eb()||n.get_$1KQ()||r!==u.$5o2||$3bH(u,t.$x)},5e3);var f;f=this.$1H.get_$Bk()||n.get_$3s()!=="HTML"?n.get_$3s()==="Text"?_h.$v.get_$2Uv():_h.$v.get_$1gC():_h.$v.get_$5qJ();var i=t.$Ve.$5Ly(n,f,this.$1H);n.get_$3w()===12&&(i.$pD=new _g.$CI(new _g.$7N("internalsubmission")));i.add_$4XM(this.$$d_$5Ik);_js.Trace.logInfo(_a.$0.$b8,"Begin upgrade, context:"+n.toString()+"; OriParentFolderId="+(n.get_$Ch()&&n.get_$Ch().get_$28()&&_g.$h.$1i?_g.$h.$1i.idToName(n.get_$Ch().get_$28()):"null"));i.$Eq="MailComposeUpgrade";t.$k.$pZ(i,this.$$d_$7gW,this.$$d_$9dh,null)}},$7gW:function(n){var s=this.$1C;var e=s.$g;var i=e.$d;var t=n;var c=s.$3c(21);var u=t.$5S;var r=n.$5H;var o=t.$5w?t.$5w.correlationId:null;var l=!!t.$Dz;if(this.$HA.$jI(r)){_js.Trace.logInfo(_a.$0.$b8,"Check upgrade callback, resume discard for context "+r);c.$3PP(r,u)}else if(r===i.get_$7t()){i.set_$9x(u);_js.Trace.logInfo(_a.$0.$b8,"Context match, updated the draft id. Context:"+i.toString()+"; ResponseMessageBodyType="+(l&&t.$Dz.get_$3M()?t.$Dz.get_$3M().get_$3s():"null"));var f=e.get_$ui();var h=e.get_$1JF();if(!f.$Cd&&h.$Lc){_js.Trace.logInfo(_a.$0.$b8,"Skipping upgrade for contextId "+r+" since send was triggered during upgrade");_y.$2V.$19(this.$hk,null,"SkipUpgrade",o,"Skip upgrade since send is in progress");this.$hk=null;_a.$6.endPT("MailComposeUpgrade");h.$2f9();return}if(f.$Cd&&f.$1n2){_js.Trace.logInfo(_a.$0.$b8,"Skipping upgrade for contextId "+r+" since save and then send was triggered during upgrade");_y.$2V.$19(this.$hk,null,"SkipUpgrade",o,"SkipUpgrade since saving is in progress");this.$hk=null;_a.$6.endPT("MailComposeUpgrade");f.$3PR();return}}if(t.$Dz){_js.Trace.logInfo(_a.$0.$b8,"Check upgrade, action has response message, call complete upgrade. context: "+i.toString()+"; ActionItemId="+_h.$E0.$xr(u));this.$5Ik(n)}else if(n.$5H===i.get_$7t()){_js.Trace.logInfo(_a.$0.$b8,"Check upgrade: action has id only, updated draft id. context: "+i.toString()+"; ActionItemId="+_h.$E0.$xr(u));_y.$2V.$19(this.$hk,null,"",o);this.$hk=null}},$5Ik:function(n){var h=this.$1C;var r=h.$g;var t=r.$d;var i=n;var c=i.$5w?i.$5w.correlationId:null;var u=n.$5H;i.remove_$4XM(this.$$d_$5Ik);if(u===t.get_$7t()){var f=!1;if(this.$1H.get_$Bk()){if(t.get_$J1()){t.$J8.$s();t.get_$DF()===t.get_$J1().get_$DF()&&(f=!0)}else t.$4Md=!0;t.$34r=!0}if(this.$1H.get_$Bk()||t.get_$3s()!=="HTML"){var e=i.$Dz.get_$3M().get_$1n();t.set_$1IG(!this.$1H.get_$Bk()&&t.get_$3s()==="Text"?_a.$1d.$7jb(e):e)}else t.set_$1IG(i.$Dz.get_$JN().get_$1n());if(f){t.$J8.$s();t.get_$J1().set_$DF(t.get_$DF());var l=t.$WE;l&&t.$WE.set_$DF(t.get_$DF())}t.set_$Sn(i.$Dz);t.$ACI(i.$Dz.get_$6Y());i.$Dz.get_$1P()&&t.set_$8j(i.$Dz.get_$1P().get_$AIt());var a=r.get_$a0();a.$6o1();t.set_$Eb(!0);r.$x.$5Z(3440);$73Q(this,t);_d.$4x.$F8(this.$1C);_js.Trace.logInfo(_a.$0.$b8,"Complete upgrade context:"+t.toString());var o=r.get_$ui();if(o.$Cd)o.$3PR();else if(_a.$61.$2v){var s=this.$1C.$3c(25);var v=this;_js.$J.get_$I().$40(_a.$0.$l,"TriggerPolicyTipsIfNeeded",function(){s&&s.$1KF(32)})}r.$J.$9lH(_d.$rc,new _d.$rc(t.get_$Sn().get_$i().Id,r))}else _js.Trace.logInfo(_a.$0.$b8,"MailComposeUpgrade failed since user switched view model context. ContextId="+u+"; Context="+t.toString());_y.$2V.$19(this.$hk,null,"",c);this.$hk=null;_a.$6.endPT("MailComposeUpgrade")},$9dh:function(n){var o=this.$1C;var i=o.$g;var r=i.$d;var c=o.$3c(21);var u=n;var f=u.$5w?u.$5w.correlationId:null;var t=n.$5H;if(this.$HA.$jI(t)){_js.Trace.logInfo(_a.$0.$b8,"Resume discard for context "+t);c.$3PP(t,u.$5S)}else if(t===r.get_$7t()){r.set_$1KQ(!0);var e=i.get_$ui();var s=i.get_$1JF();if(e.$Cd){if(e.$1n2){_js.Trace.logInfo(_a.$0.$b8,"Skipping upgrade for context "+t+" since save and then send was triggered during upgrade");_y.$2V.$19(this.$hk,null,"SkipUpgrade",f,"Skip upgrade since saving is in progress");this.$hk=null;_a.$6.endPT("MailComposeUpgrade");e.$3PR();return}$3bH(this,i.$x)}else if(s.$Lc){_js.Trace.logInfo(_a.$0.$b8,"Skipping upgrade for context "+t+" since send was triggered during upgrade");_y.$2V.$19(this.$hk,null,"SkipUpgrade",f,"Skip upgrade since send is in progress");this.$hk=null;_a.$6.endPT("MailComposeUpgrade");s.$2f9();return}else $3bH(this,i.$x)}var l=_d.$B6.$1xS(n.$1d)||"UpgradeFailure_UnknownError";var h=_d.$B6.$1co(n.$1d);_js.Trace.logWarning(_a.$0.$b8,String.format("Upgrade failed. ContextId={0}, Context={1}, Server Error: {2}",t,r.toString(),h));_y.$2V.$19(this.$hk,null,l,f,h);this.$hk=null;_a.$6.endPT("MailComposeUpgrade")}};_d.$1At=function(n,t,i,r,u){this.$$d_$9VH=Function.createDelegate(this,this.$9VH);this.$$d_$A9b=Function.createDelegate(this,this.$A9b);_d.$1At.initializeBase(this,[19,n]);this.$x=r;this.$2V3=new _d.$46(t,i,n.$g.$x,u);this.$2V3.set_$4PU(this.$$d_$9VH)};_d.$1At.prototype={$x:null,$2V3:null,$9VH:function(){_d.$4x.$F8(this.$1C)},$41:function(){this.$2V3.$41();_d.$9q.prototype.$41.call(this)},$2hZ:function(){_js.Trace.logInfo(_a.$0.$l,"Prepares to submit mailtips action");this.$2V3.$2hZ()},$A9b:function(){var t=this.$1C;var i=t.$g;var n=i.$d;if(n.get_$2Ss()){this.$x.$5Z(4400);this.$x.$2j(4400);_d.$4x.$F8(this.$1C)}if(n.get_$3w()&&n.get_$3w()!==3&&n.get_$3w()!==11){this.get_$D2()||this.$41();this.$2hZ()}},$6W8:function(){this.$2V3.$6W8()}};_d.$ec=function(n,t,i){this.$$d_$6MI=Function.createDelegate(this,this.$6MI);this.$$d_$6MH=Function.createDelegate(this,this.$6MH);this.$$d_$6MF=Function.createDelegate(this,this.$6MF);this.$$d_$9YF=Function.createDelegate(this,this.$9YF);_d.$ec.initializeBase(this,[25,n]);if(_a.$61.$2v){this.$x=i;this.$Wq=new _d.$3Y(t,this.$1C.$3c(1),this.$1C.$3c(5),n.$g.$x,this.$1C.$g.$B);this.$Wq.set_$4Pv(this.$$d_$9YF);this.$Wq.set_$3Jy(this.$$d_$6MF);this.$Wq.set_$3Jx(this.$$d_$6MH);this.$Wq.set_$6MJ(this.$$d_$6MI)}};function $4rh(n){n.get_$D2()||n.$41();return n.$Wq?n.$Wq.$2zZ():0}_d.$ec.prototype={$1fQ:null,$x:null,$Wq:null,$41:function(){if(!_a.$61.$2v){_d.$9q.prototype.$41.call(this);return}this.$Wq.$41();_d.$9q.prototype.$41.call(this)},$49:function(){this.$1fQ&&(this.$1fQ=_js.$J.get_$I().$5A(this.$1fQ));_js.$9.prototype.$49.call(this)},$8O9:function(){if(!_a.$61.$2v)return!1;switch($4rh(this)){case 1:return!1;case 2:case 3:return $5(this.$1C.$g.$d.get_$Vw())&&$5(this.$1C.$g.$d.get_$UN());case 4:case 5:return $5(this.$1C.$g.$d.get_$UN());default:return!1}},$87o:function(){if(!_a.$61.$2v)return"";switch($4rh(this)){case 2:case 3:return _nbs.NonBootStrings.l_PolicyTipsBlockOverrideSend_Text;case 4:case 5:return _nbs.NonBootStrings.l_PolicyTipsBlockSend_Text;default:return""}},$9wf:function(){if(_a.$61.$2v){this.$Wq.$5sY=!0;if(!$5(this.$1C.$g.$d.get_$Vw())){var n=_a.$6.$1X(_a.$0.$In,"DlpPolicyTipOverridden",!0);_a.$6.$19(n,"DlpPolicyTipOverridden","",null)}}},$1KF:function(n){if(_a.$61.$2v){var r=this.$1C;var u=r.$g;var i=u.$d;this.get_$D2()||this.$41();this.$1fQ&&(this.$1fQ=_js.$J.get_$I().$5A(this.$1fQ));var t=i.get_$9x();if(t){_bc.$Bi.$1zd(t)&&(t=_g.$1Y.$w.$rW(t));if(_bc.$Bi.$1zd(t)){var f=this;this.$1fQ=_js.$J.get_$I().$1s(_a.$0.$In,"TriggerPolicyTipsIfNeeded",function(){f.$1KF(n)},5e3)}else this.$2ha(i,n)}}},$2ha:function(n,t){_js.Trace.logInfo(_a.$0.$l,"Prepares to submit policyTips action");var r;var u;if(n.get_$J1()){r=_a.$3T.$1xG(n.get_$J1().get_$2i());u=_a.$3T.$1xG(n.get_$J1().get_$DF())}else{r=_a.$3T.$1xG(n.get_$2i());u=_a.$3T.$1xG(n.get_$DF())}var i=n.get_$9x();_bc.$Bi.$1zd(i)&&(i=_g.$1Y.$w.$rW(i));this.$Wq.$2ha(i,n.get_$8j(),r,u,t)},$9YF:function(){_d.$4x.$F8(this.$1C)},$6MF:function(n){var t=this.$1C;var i=t.$g;var r=i.$d;r.set_$Vw(n)},$6MH:function(n){var t=this.$1C;var i=t.$g;var r=i.$d;r.set_$UN(n)},$6MI:function(){this.$1KF(64)}};_d.$ES=function(n,t){this.$$d_$6HX=Function.createDelegate(this,this.$6HX);this.$$d_$6HZ=Function.createDelegate(this,this.$6HZ);this.$$d_$7iC=Function.createDelegate(this,this.$7iC);this.$$d_$7z6=Function.createDelegate(this,this.$7z6);this.$$d_$5CG=Function.createDelegate(this,this.$5CG);_d.$ES.initializeBase(this,[24,n]);this.$1xq=!1;this.$6l=t.$5Lc(this,this.$$d_$5CG)};function $2l3(n,t){var i=n.$1C.$3c(27);i.set_$Jn(t)}function $4rZ(n,t,i,r){var u=$4rY(n,t);r&&u.$AG();var e=i.get_$C();if(e+u.$1U.get_$C()>100)return!1;t===2&&n.$1C.$g.get_$Kx().$3ST.$s();for(var f=0;f<e;f++){var o=i.get_$3o(f);u.$3hO(o)}return!0}function $735(n){var t=n.$1C.$3c(14);t&&t.$bq()}function $4rY(n,t){var i=n.$1C.$g.get_$Kx();return t?t===1?i.$B5.$4X:t===2?i.$Bs.$4X:null:i.$B1.$4X}function $736(n){var t=n.$1C.$3c(3);n.$6l.set_$5V0(t.$1Q2);t.$1Q2&&n.$6l.$1yP(!1)}_d.$ES.prototype={$1xq:!1,$6l:null,$41:function(){if(!this.get_$D2()){var n=this.$1C.$3c(3);this.$6l.set_$5V0(n.$1Q2);var t=this.$1C.$g.$J;t.$Hd(_a.$XD,this.$$d_$7z6);this.$6l.$5m();n.$Y("IsIrmProtected",this.$$d_$7iC);this.$6l.add_$27L(this.$$d_$6HZ);this.$6l.add_$3J1(this.$$d_$6HX)}_d.$9q.prototype.$41.call(this)},$AG:function(){if(this.get_$D2()){var n=this.$1C.$3c(3);n.$q("IsIrmProtected",this.$$d_$7iC);this.$6l.remove_$27L(this.$$d_$6HZ);this.$6l.remove_$3J1(this.$$d_$6HX);this.$6l.$78();var t=this.$1C.$g.$J;t.$11q(_a.$XD,this.$$d_$7z6)}_d.$9q.prototype.$AG.call(this)},$2zf:function(){return _y.$x.$w.get_$L()==="Mouse"?this.$1C.$g.$d.get_$3s():this.$1C.$g.$d.get_$Bk()?"HTML":"Text"},$14l:function(){return this.$1C.$g.$d.get_$2i()},$9xX:function(n){this.$1C.$g.$d.set_$2i(n)},$86v:function(n){var t=$4rY(this,n);return t.$1U},$A9h:function(n,t){return $4rZ(this,n,t,!1)},$9xA:function(n,t){$4rZ(this,n,t,!0)},$5A3:function(n,t){t.val=0;if(!this.$1C.$g.$d.get_$Eb()){_js.Trace.logInfo(_a.$0.$5l,"Attachment not added - well not upgraded.");t.val=9005;return null}var r=this.$1C.$3c(5);var u=_y.$AT.$3oj(n);if(r.get_$60()){var i=new(_0365f.$n.$$(_y.$du));r.get_$60().$1rO(u,i);if(!i.get_$C()){_js.Trace.logInfo(_a.$0.$5l,"Attachment not added - max number exceeded.");t.val=9001;return null}return i.get_$3o(0)}else{_js.Trace.logInfo(_a.$0.$5l,"Attachment not added - max number exceeded.");t.val=9001;return null}},$59u:function(n,t,i){i.val=0;if(!this.$1C.$g.$d.get_$Eb()){_js.Trace.logInfo(_a.$0.$5l,"Attachment not added - well not upgraded.");i.val=9005;return null}var u=this.$1C.$3c(5);var r=u.get_$60();if(r){var f=new _d.$12O(n,t);return r.$59v(f)}_js.Trace.logError(_a.$0.$5l,"ComposeFormNotReadyForAttachments in mail module");i.val=9015;return null},$3xO:function(){return this.$1C.$g.$d.get_$3S()?this.$1C.$g.$d.get_$3S().Id:null},$8HK:function(n){var t=new _d.$r6(n,!0);$2l3(this,t)},$9ig:function(n){var t=new _d.$sw(n);$2l3(this,t)},$6HZ:function(){if(_y.$x.$w.get_$L()==="TouchWide"&&this.$6l.get_$ne()){var n=this.$1C.$g;n.set_$1kp(6)}},$6HX:function(){var n=this.$1C.$g;n.set_$1kp(4)},$2OW:function(){return this.$1C.$g.$d.get_$9x()?this.$1C.$g.$d.get_$9x().Id:null},$3xd:function(){this.$1C.$g.$d.get_$UP()||this.$1C.$g.$d.set_$UP(new _js.$c);return this.$1C.$g.$d.get_$UP()},$8TX:function(){},$A4a:function(){var n=new _y.$b6(null);$2l3(this,n)},$7gB:function(n){var t=new _y.$b6(n);$2l3(this,t)},$7z6:function(n){if(this.$1xq){this.$1xq=!1;this.$6l.$1yP(!1)}},$5CG:function(n){if(n===1){var t=window.document.body.clientWidth;if(t<1367){var i=this.$1C.$g.$J;i.$9lH(_a.$eX,new _a.$eX(!0));this.$1xq=!0}}else if(n===2&&this.$1xq){var r=this.$1C.$g.$J;r.$9lH(_a.$eX,new _a.$eX(!1));this.$1xq=!1}$735(this)},$7iC:function(n,t){t==="IsIrmProtected"&&$736(this)}};_d.$HD=function(n,t,i,r,u,f,e,o,s,h){this.$$d_$8ET=Function.createDelegate(this,this.$8ET);this.$$d_$4Pp=Function.createDelegate(this,this.$4Pp);this.$$d_$9dO=Function.createDelegate(this,this.$9dO);this.$$d_$9XA=Function.createDelegate(this,this.$9XA);this.$$d_$9PZ=Function.createDelegate(this,this.$9PZ);this.$$d_$9W0=Function.createDelegate(this,this.$9W0);this.$$d_$9Qj=Function.createDelegate(this,this.$9Qj);this.$$d_$6Kl=Function.createDelegate(this,this.$6Kl);this.$$d_$6ID=Function.createDelegate(this,this.$6ID);this.$$d_$2ao=Function.createDelegate(this,this.$2ao);this.$2ql=_nbs.NonBootStrings.l_PolicyTipsBlock_Text;this.$3IZ=_u.Strings.l_PolicyTipsNotify_Text;this.$3LA=_nbs.NonBootStrings.l_PolicyTipsOverride_Text;_d.$HD.initializeBase(this,[n,o,5]);this.$f0=t;this.$B=h;this.$1U=i;this.$1U.add_$1Y(this.$$d_$2ao);this.$qc=r;this.$qc.add_$1Y(this.$$d_$6ID);this.$6WJ=u;this.$28D=f;this.$2A4=e;this.$S1=new _d.$m9(this.$B,this.$$d_$6Kl,this.$$d_$9Qj,r);this.$1bD=new _d.$m9(this.$B,this.$$d_$6Kl,this.$$d_$9Qj,r);this.$6Eo=new _C(this.$$d_$9W0,_a.$0.$In);this.$5P3=new _C(this.$$d_$9PZ,_a.$0.$In);this.$2bJ=new _C(this.$$d_$9XA,_a.$0.$In);this.$6mH=s;this.$6mJ=new _C(this.$$d_$9dO,_a.$0.$In);this.$15N=!1;this.set_$1Qa(!0);this.$6nV();this.$B.get_$L()==="TouchNarrow"?$3bc(this):this.$4TV=new _d.$m8(this.$$d_$4Pp,this.$$d_$9Qj)};function $75Z(n){for(var i="",t=0;t<n.$1U.get_$C();t++){i+=n.$1U.get_$3o(t).get_$1o()||n.$1U.get_$3o(t).get_$Vg();t<n.$1U.get_$C()-1&&(i+=_nbs.NonBootStrings.l_MessageNameSeparator_Text)}return i}function $75Y(n){return n.$1U.get_$C()===1?_nbs.NonBootStrings.l_PolicyTipsRecipientInfo_Text:_nbs.NonBootStrings.l_PolicyTipsRecipientsInfo_Text}function $3bc(n){_js.Trace.logInfo(_a.$0.$In,"Create policy tips more info dialog.");var t=new _js.$c;n.$1Mt&&t.$D(new _a.$2E(new _C(n.$$d_$6Kl,_a.$0.$In),_nbs.NonBootStrings.l_PolicyTipsDialogLearnMoreButtonCaption_Text,_nbs.NonBootStrings.l_PolicyTipsDialogLearnMoreButtonDescription_Text));n.$gG||t.$D(new _a.$2E(new _C(n.$$d_$9Qj,_a.$0.$In),_nbs.NonBootStrings.l_PolicyTipsDialogReportButtonCaption_Text,_nbs.NonBootStrings.l_PolicyTipsDialogReportButtonDescription_Text));t.$D(new _a.$2E(new _C(n.$$d_$8ET,_a.$0.$In),_u.Strings.l_ConfirmDialog_Cancel_Text,_nbs.NonBootStrings.l_PolicyTipsDialogCancelButtonDescription_Text));n.set_$9I4(t)}_d.$HD.prototype={$6Eo:null,$5P3:null,$2bJ:null,$6mJ:null,$B:null,$1U:null,$6mH:null,$36C:!1,$3HN:null,$S1:null,$1bD:null,$1Uh:null,$6WJ:null,$1EZ:!1,$gG:!1,$28D:null,$2A4:null,$36D:!1,$36Z:!1,$f0:0,$6P2:null,$4TV:null,$1Mt:null,$qc:null,$fN:null,get_$7d5:function(){return this.$2ql},set_$7d5:function(n){this.$2ql=n;this.$6nV();return n},get_$9K5:function(){return this.$3IZ},set_$9K5:function(n){this.$3IZ=n;this.$6nV();return n},get_$9f5:function(){return this.$3LA},set_$9f5:function(n){this.$3LA=n;this.$6nV();return n},get_$7XS:function(){return this.$f0},set_$7XS:function(n){if(this.$f0!==n){this.$f0=n;this.$6nV()}return n},get_$36Y:function(){return this.$1EZ},set_$36Y:function(n){if(this.$1EZ!==n){this.$1EZ=n;this.$28D&&this.$28D(this.$1EZ?this.$6P2:null)}return n},get_$2St:function(){return this.$gG},set_$2St:function(n){if(this.$gG!==n){this.$gG=n;this.$S1.set_$2St(n);this.$1bD.set_$2St(n);this.$B.get_$L()==="TouchNarrow"&&$3bc(this);this.$2A4&&this.$2A4(this.$gG?"":null);$3(this,"IsReportedFalsePositive")}return n},get_$8MN:function(){return this.$36D},set_$8MN:function(n){if(this.$36D!==n){this.$36D=n;$3(this,"IsMoreInfoLinkHidden")}return n},get_$8JM:function(){return this.$B.get_$L()!=="TouchNarrow"},get_$8My:function(){return this.$36Z},set_$8My:function(n){if(this.$36Z!==n){this.$36Z=n;$3(this,"IsOverrideLinkHidden")}return n},get_$Pq:function(){return this.$fN},set_$Pq:function(n){if(this.$fN!==n){this.$fN=n;$3(this,"ClassificationDescription")}return n},$6ID:function(n,t){for(var r="",i=0;i<this.$qc.get_$C();i++){var u=this.$qc.get_$3o(i);r+=String.format("{0}<br>",u)}this.set_$Pq(r)},get_$1f7:function(){return _d.$15Z.prototype.get_$1f7.call(this)},set_$1f7:function(n){_d.$15Z.prototype.set_$1f7.call(this,this.$1EZ||this.$gG||n);return n},$9vA:function(n){this.$1Mt=n;this.$S1.set_$5Im(n);this.$1bD.set_$5Im(n);this.$6nV();$3bc(this)},$49:function(){this.$1U&&this.$1U.remove_$1Y(this.$$d_$2ao);this.$qc&&this.$qc.remove_$1Y(this.$$d_$6ID);_a.$1.prototype.$49.call(this)},$8Js:function(){return(!!this.$1U&&this.$1U.get_$C()>0&&this.$f0!==1||this.$f0===2||this.$f0===3||this.$B.get_$L()==="TouchNarrow")&&!this.$1EZ&&!this.$gG},$6nV:function(){_d.$15Z.prototype.$6nV.call(this);this.set_$8MN(!this.get_$1f7()||this.$B.get_$L()==="TouchNarrow"&&this.$gG&&!this.$1Mt);this.set_$8My(this.get_$1f7()||this.$f0===1||this.$f0===4||this.$f0===5);if(this.$1Uh&&this.$f0===1){this.$Pb.$34(this.$1Uh);this.$1Uh=null}$6J(this,"MessageUpdated")},$80W:function(){},$80f:function(){if(this.$1EZ||this.$gG)this.$gG?this.set_$sd(_nbs.NonBootStrings.l_PolicyTipsFalsePositive_Text):this.$1EZ&&this.set_$sd(this.$3LA);else switch(this.$f0){case 1:this.set_$sd(this.$3IZ);break;case 2:case 3:case 4:case 5:this.set_$sd(this.$2ql);break}},$9W0:function(){this.$B.get_$L()==="TouchNarrow"?this.set_$2SV(!0):this.$S1.set_$1O(!this.$S1.$30)},$9PZ:function(){this.$B.get_$L()==="TouchNarrow"?this.set_$2SV(!0):this.$1bD.set_$1O(!this.$1bD.$30)},$9XA:function(){this.$f0===2||this.$B.get_$L()==="TouchNarrow"?this.$4Pp(""):this.$4TV.set_$1O(!0)},$4Pp:function(n){this.$6P2=n;this.set_$36Y(!0);this.set_$7w(!0);this.$6nV()},$9dO:function(){this.set_$2St(!1);this.$6nV();this.$6mH()},$9Qj:function(){this.$S1.set_$1O(!1);this.$1bD.set_$1O(!1);this.set_$2SV(!1);this.set_$2St(!0);this.set_$7w(!0);this.$6nV()},$2ao:function(n,t){if(this.$1Uh){this.$Pb.$34(this.$1Uh);this.$1Uh=null}if(this.$1U.get_$C()>0&&this.$f0!==1){this.$1Uh=new _d.$sr($75Z(this),"",$75Y(this),"",this.$6WJ,this.$1U.get_$C()>1,!1);this.$Pb.$D(this.$1Uh)}this.$6nV();$6J(this,"MessageUpdated")},get_$2SV:function(){return this.$36C},set_$2SV:function(n){if(this.$36C!==n){this.$36C=n;$3(this,"IsMoreInfoDialogShown")}return n},get_$9I4:function(){return this.$3HN},set_$9I4:function(n){if(n!==this.$3HN){this.$3HN=n;$3(this,"MoreInfoDialogButtonData")}return n},$8ET:function(){_js.Trace.logInfo(_a.$0.$In,"Hide more info dialog");this.set_$2SV(!1)},$6Kl:function(){this.$1Mt&&window.open(this.$1Mt,"_blank","width=800,height=700,toolbar=no,directories=no,status=no,menubar=no,scrollbars=yes,resizable=yes")}};_d.$m8=function(n,t){this.$$d_$1Tc=Function.createDelegate(this,this.$1Tc);this.$$d_$4Pp=Function.createDelegate(this,this.$4Pp);_d.$m8.initializeBase(this);this.$28D=n;this.$2A4=t;this.$2bJ=new _C(this.$$d_$4Pp,_a.$0.$In);this.$7I=new _C(this.$$d_$1Tc,_a.$0.$In);this.set_$DT(this);var i=new _js.$c;i.$D(new _a.$2E(this.$2bJ,_nbs.NonBootStrings.l_PolicyTipsOverrideButtonCaption_Text));i.$D(new _a.$2E(this.$7I,_u.Strings.l_CancelButtonLabel_LowerCase_Text));this.set_$St(i);this.set_$6P3(1);this.set_$2Tl("")};_d.$m8.prototype={$2bJ:null,$7I:null,$28D:null,$2A4:null,$2Tk:null,$28E:0,get_$6P3:function(){return this.$28E},set_$6P3:function(n){if(this.$28E!==n){this.$28E=n;$3(this,"OverrideType")}return n},get_$2Tl:function(){return this.$2Tk},set_$2Tl:function(n){this.$2Tk=n;$3(this,"Justification");return n},$4Pp:function(){if(this.$28E===1&&this.$28D&&!_js.$8.$a(this.$2Tk)){this.$28D(this.$2Tk);this.set_$2Tl("");this.$4f.$s()}if(this.$28E===2&&this.$2A4){this.$2A4();this.set_$2Tl("");this.$4f.$s()}},$1Tc:function(){this.set_$2Tl("");this.$4f.$s()}};_d.$m9=function(n,t,i,r){this.$$d_$6ID=Function.createDelegate(this,this.$6ID);_d.$m9.initializeBase(this);this.$B=n;this.$22J=new _C(t,_a.$0.$In);this.$6Wl=new _C(i,_a.$0.$In);this.$qc=r;this.$qc.add_$1Y(this.$$d_$6ID)};_d.$m9.prototype={$B:null,$22J:null,$6Wl:null,$qc:null,$30:!1,$fN:null,$1Mt:null,$gG:!1,get_$1O:function(){return this.$30},set_$1O:function(n){if(this.$30===n)return n;this.$30=n;$3(this,"IsShown");return n},get_$Pq:function(){return this.$fN},set_$Pq:function(n){if(this.$fN===n)return n;this.$fN=n;$3(this,"ClassificationDescription");return n},get_$5rb:function(){return 420},get_$zu:function(){return 320},get_$5hr:function(){return this.$B.get_$L()!=="TouchNarrow"},get_$5Im:function(){return this.$1Mt},set_$5Im:function(n){this.$1Mt=n;$3(this,"ComplianceUrl");return n},get_$2St:function(){return this.$gG},set_$2St:function(n){this.$gG=n;$3(this,"IsReportedFalsePositive");return n},$49:function(){this.$qc&&this.$qc.remove_$1Y(this.$$d_$6ID);_a.$1.prototype.$49.call(this)},$6ID:function(n,t){for(var i="<ul>",r=0;r<this.$qc.get_$C();r++){var u=this.$qc.get_$3o(r);i+=String.format("<li>{0}</li>",u)}i+="</ul>";this.set_$Pq(i)}};_d.$sr=function(n,t,i,r,u,f,e){_d.$sr.initializeBase(this,[n,t,i,r,e]);u&&(this.$6WK=new _C(u,_a.$0.$In));this.$5k6=f};_d.$sr.prototype={$6WK:null,$5k6:!1,get_$9ny:function(){return this.$5k6?_nbs.NonBootStrings.l_MessageRemoveAll_Text:_nbs.NonBootStrings.l_MessageRemoveRecipient_Text}};_d.$Mg=function(){};function $72e(n,t,i,r){var u=null;if(i.get_$jh()){u=new _h.$4z(i.$3pK(!1));u.$pD=_g.$28.$Zh(i.get_$1kL());u.$GB=0}else{u=new _h.$4z(i.$1NF(!1));u.$GB=t}u.$5mY=!r.get_$Bk();i.get_$Ps()&&(u.$qi=i.get_$Ps());u.$2IQ=i.$3z0(100);u.$2tC="AlwaysOverwrite";u.$22q=_y.$Hk.toString(i.get_$3w());return u}function $72g(n,t){switch(t){case 1:return new _g.$Hy;case 2:return new _g.$Gd;case 3:return new _g.$Ha;case 12:return new _g.$Z6;default:throw Error.invalidOperation("Unable to get SmartResponseType from MailComposeOperation "+_y.$Hk.toString(t));}}function $72f(n,t,i,r){var f=t.get_$Ch();var u=new _c.$bW(f,t.$1NF(!1),t.get_$3w()===9,i);u.$1Mk=!r.get_$Bk();return u}_d.$Mg.prototype={$3oT:function(n,t,i){var r=n.$d;var u=r.get_$3w();var h=3===u||2===u||1===u;var c=i.get_$Bk()&&r.get_$Eb();var e=null;if(h&&!c){_js.Trace.logInfo(_a.$0.$l,"Creating CreateResponseAction for context:"+r.toString()+"; layout="+_y.$x.$w.get_$L()+"; disposition="+t);var l=r.$1NF(!1);var o=this.$3pS(r,l,i);o.$GB=t;r.get_$9x()&&t===1&&(o.$2jD=n.$2jC);o.$2IQ=r.$3z0(100);o.$22q=_y.$Hk.toString(r.get_$3w());e=o}else if(r.get_$47P()){_js.Trace.logInfo(_a.$0.$l,"Creating UpdateMessageForComposeAction for context:"+r.toString()+"; disposition="+t);var s=$72e(this,t,r,i);t===1&&(s.$2jD=n.$2jC);e=s}else if(8===r.get_$3w()){_js.Trace.logInfo(_a.$0.$l,"Creating CancelCalendarItemAction for context:"+r.toString()+"; disposition="+t);e=this.$80g(r,t)}else if(u===5||u===6||u===7){_js.Trace.logInfo(_a.$0.$l,"Creating MeetingResponseAction for context:"+r.toString()+"; disposition="+t);e=this.$3wr(r,t)}else if(u===9||u===10){_js.Trace.logInfo(_a.$0.$l,"CreateComposeAction: ApprovalRequestAction");e=$72f(this,r,t,i)}else{_js.Trace.logInfo(_a.$0.$l,"Creating CreateMessageForComposeAction for context:"+r.toString()+"; disposition="+t);var f=null;if(u===11||u===12){f=new _h.$3L(r.$3pK(!1),r.get_$1kL());f.$GB=0}else{f=new _h.$3L(r.$1NF(!1),null);f.$GB=t}f.$1Mk=!i.get_$Bk();$5(r.get_$Ps())||(f.$qi=r.get_$Ps());f.$2IQ=r.$3z0(100);f.$22q=_y.$Hk.toString(r.get_$3w());e=f}e.$5H=r.get_$7t();return e},$3op:function(n,t,i){var r=new _c.$17Q(200,n);r.$Oq=t||_h.$v.get_$1gC();r.$SF=$5(i)?"MailCompose":i;return r},$7lF:function(n,t){var i=t?"HardDelete":"MoveToDeletedItems";return new _h.$15R([n],i,2)},$5Ly:function(n,t,i){var u=null;u=n.get_$jh()?n.$3pK(!0):n.$1NF(!0);var r=this.$3pS(n,u,i);r.$Oq=t;r.$SF=!i.get_$Bk()&&n.get_$3s()==="HTML"?"MailComposeNormalizedBody":"MailCompose";r.$1Wo=_g.$V.get_$I().get_$13().get_$NH();return r},$80g:function(n,t){var i=new _c.$jG(n.get_$dv(),1,n.get_$149());i.$Ge=n.$1NF(!1);n.get_$Ps()&&(i.$qi=n.get_$Ps());return i},$3pS:function(n,t,i){var u=n.get_$s8()?new _h.$7b(n.get_$dv()):n.get_$dv();var r=null;r=new _h.$Cr($72g(this,n.get_$3w()),u,i);r.set_$4y(t);r.$29f=n.get_$3Kz();r.$1Mk=!i.get_$Bk();n.get_$Ps()&&(r.$qi=n.get_$Ps());r.$Cv_7=n.get_$3S();r.$Wk=n.get_$28O();r.$5H=n.get_$7t();n.get_$Ch()&&_g.$81.isInstanceOfType(n.get_$Ch())&&n.get_$Ch().get_$G8()&&(r.$36u=!0);switch(n.get_$3w()){case 1:case 2:r.$3UV=_u.Strings.l_ReplyPrefix_Text;break;case 3:r.$3UV=_nbs.NonBootStrings.l_ForwardPrefix_Text;break}return r},$3wr:function(n,t){return _cmm.$1w.$3wr(n.get_$Ch(),_cmm.$1w.$1cx(n.get_$3w()),n.$1NF(!1),t,n.get_$3NC())}};_d.$1Aq=function(n,t,i,r,u,f,e){_a.$3.$m(e,"nativeBridge");this.$1C=n;this.$4U=i;this.$1H=r;this.$Ka=u;this.$E7=t;this.$2D=f;this.$c=e};_d.$1Aq.prototype={$1C:null,$4U:null,$1H:null,$Ka:null,$E7:null,$2D:null,$c:null,$7km:function(n,t){switch(n){case 0:return new _d.$8a(this.$1C,this.$1H);case 1:return new _d.$41(this.$1C);case 2:return new _d.$1Au(this.$1C);case 3:return new _d.$DY(this.$1C);case 4:return new _d.$90(this.$1C);case 5:return new _d.$An(this.$1C,this.$E7,this.$4U,this.$1H,this.$Ka);case 6:return new _d.$KD(this.$1C);case 7:return new _d.$7F(this.$1C,this.$1H);case 8:return new _d.$1Ap(this.$1C,this.$2D,this.$1H);case 9:if(1===this.$1C.$g.$d.get_$66())return new _d.$Bv(this.$1C,this.$1H);break;case 10:return new _d.$Gy(this.$1C);case 11:if("Mouse"!==t)return new _d.$Gz(this.$1C,this.$4U);break;case 12:return new _d.$ET(this.$1C,this.$1H);case 13:return new _d.$Pz(this.$1C,this.$1H);case 14:if(t==="Mouse")return new _d.$4x(this.$1C);break;case 15:if(this.$c.$5i(this.$c.get_$B9())&&this.$c.get_$B9().get_$bW().get_$2qA())return new _d.$Py(this.$1C,this.$c);break;case 22:if(this.$c.$5i(this.$c.get_$B9())&&this.$c.get_$B9().get_$bW().get_$3Hm())return new _d.$1Av(this.$1C,this.$c);break;case 16:return new _d.$DX(this.$1C);case 17:if("Mouse"===t)return new _d.$Px(this.$1C);break;case 18:if("Mouse"===t)return new _d.$Rk(this.$1C);break;case 20:return new _d.$Ez(this.$1C);case 19:return new _d.$1At(this.$1C,OwaApplication.$1W,this.$1C.$3c(1),this.$1C.$g.$x,this.$1H);case 25:return new _d.$ec(this.$1C,OwaApplication.$1W,this.$1C.$g.$x);case 21:return new _d.$UZ(this.$1C);case 23:if(this.$c.$5i(this.$c.get_$uw()))return new _d.$1Aw(this.$1C,this.$c);break;case 24:return new _d.$ES(this.$1C,this.$1C.$g.$RQ);case 26:if(this.$1H.get_$Bk())return new _d.$rb(this.$1C,this.$4U);break;case 27:return new _d.$1As(this.$1C)}return null}};_d.$1Ar=function(n,t){this.$4Ap=n.$5X5();this.$1H=t};_d.$1Ar.prototype={$1H:null,$4Ap:0,$Fx:function(n,t){var i=new _d.$S;this.$1H&&i.set_$Bk(this.$1H.get_$Bk());i.set_$66(n?0:this.$4Ap);return i},$3oX:function(n,t,i,r){var u=this.$Fx(!1,!1);u.set_$66(this.$4Ap);u.set_$3w(4);u.set_$NA(!1);u.set_$9x(n);u.set_$2SX(t);r&&!r.get_$HX()?u.set_$3s(r.get_$3s()):u.set_$3s(i===1?"Text":"HTML");return u}};_d.$YX=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d){_a.$3.$m(k,"nativeBridge");this.$RQ=n;this.$7F=t;this.$1wv=i;this.$1V3=r;this.$7A=u;this.$Ve=f;this.$5q=e;this.$B=o;this.$1TZ=s;this.$HA=h;this.$hD=c;this.$J=l;this.$4U=v;this.$1H=y;this.$Ka=p;this.$E7=a;this.$2D=w;this.$aF=b;this.$c=k;this.$2jC=d};function $73R(n,t,i){var r=n.$7A.$Fx(!1,!1);r.$42U(t);return n.$5fs(r,i)}_d.$YX.prototype={$RQ:null,$7F:null,$1wv:null,$1V3:null,$7A:null,$Ve:null,$J:null,$5q:null,$B:null,$1TZ:null,$HA:null,$hD:null,$4U:null,$1H:null,$Ka:null,$E7:null,$aF:null,$2D:null,$c:null,$2jC:null,$br:function(n,t){return $73R(this,n,null)},$wx:function(n,t){return this.$5fs(n,null)},$5fs:function(n,t){var i=new _d.$Ao(n,t,this.$RQ,this.$7F,this.$1wv,this.$1V3,this.$5q,this.$B,this.$1TZ,this.$HA,this.$hD,this.$J,this.$E7,this.$4U,this.$1H,this.$Ka,this.$2D,this.$aF,this.$c,this.$2jC,this.$Ve);i.$41();return i}};_d.$yj=function(){_d.$yj.initializeBase(this)};_d.$yj.prototype={$OV:null,$2ta:null,get_$in:function(){return this.$OV},set_$in:function(n){if(this.$OV!==n){this.$OV=n;$3(this,"Description")}return n},get_$7jA:function(){return this.$2ta},set_$7jA:function(n){if(this.$2ta!==n){this.$2ta=n;$3(this,"ConversationOwner")}return n}};_d.$13S=function(n,t,i,r,u,f){_d.$13S.initializeBase(this,[n,t,i,r,u,f]);this.$15N=!1;this.set_$1Qa(!0);this.$2dm();this.$6nV();this.$1H=f};_d.$13S.prototype={$1H:null,$5W3:function(n,t){for(var i=n;i<n+t;i++){var r=this.$1U.get_$3o(i);var u=new _d.$Q1(this.$14i(i),"",r.$3jU,"",r,this.get_$3OY(),!1,this.$1H);this.$Pb.$D(u)}},$80f:function(){this.set_$sd(this.$20c()?String.format(_nbs.NonBootStrings.l_InfoMailtipAutomaticReplyMultiple_Text,this.$1U.get_$C()):String.format(_u.Strings.l_InfoMailtipAutomaticReply_Text,this.$14i(0),this.$1U.get_$3o(0).$3jU))}};_d.$15B=function(n,t,i,r,u,f){_d.$15B.initializeBase(this,[n,t,i,r,u,f]);this.$1H=f;this.$15N=!1;this.set_$365(!0);this.set_$1Qa(!0);this.set_$7w(!1);this.$2dm();this.$6nV()};_d.$15B.prototype={$1H:null,$5W3:function(n,t){for(var i=n;i<n+t;i++){var r=this.$1U.get_$3o(i);var u=new _d.$Q1(this.$14i(i),"",r.$5NJ,"",r,null,!1,this.$1H);this.$Pb.$D(u)}},$20c:function(){return!0}};_d.$16I=function(n,t,i,r,u,f){_d.$16I.initializeBase(this,[n,t,i,r,u,f]);this.$1H=f;this.$15N=!0;this.set_$1Qa(!0);this.$2dm();this.$6nV()};_d.$16I.prototype={$1H:null,$2yC:0,get_$3v3:function(){return this.$2yC},set_$3v3:function(n){this.$2yC=n;this.$6nV();return n},$5W3:function(n,t){for(var i=n;i<n+t;i++){var r=this.$1U.get_$3o(i);if(r.$10b>1){var u=new _d.$Q1(this.$14i(i),"",String.format(_nbs.NonBootStrings.l_ApproximateNumberCount_Text,r.$2yD),_nbs.NonBootStrings.l_SubmessageEndSeparator_Text,r,this.get_$3OY(),!0,this.$1H);this.$Pb.$D(u)}}},$20c:function(){return this.$2yC>1||this.$2yC===1&&!!this.$1U.get_$3o(0)&&this.$1U.get_$3o(0).$10b>1},$80f:function(){this.set_$sd(this.$20c()?_nbs.NonBootStrings.l_InfoMailTipExternalRecipientsMultiple_Text:String.format(_u.Strings.l_InfoMailTipExternalRecipients_Text,this.$14i(0)))},$80W:function(){for(var n="",t=0;t<this.$1U.get_$C();t++){var r=this.$1U.get_$3o(t);if(r.$10b<=1){var i=this.$14i(t);_js.$8.$a(n)?n=i:n+=_nbs.NonBootStrings.l_MessageNameSeparator_Text+i}}this.set_$2vo(n)}};_d.$1AO=function(n,t,i,r,u,f){_d.$1AO.initializeBase(this,[n,t,i,r,u,f]);this.$1H=f;this.$15N=!0;this.set_$1Qa(!0);this.$5mm=!0;this.set_$5lE(!0);this.$2dm();this.$6nV()};_d.$1AO.prototype={$1H:null,$33L:0,$2iO:0,$37g:!1,get_$42I:function(){return this.$33L},set_$42I:function(n){this.$33L=n;this.$80W();return n},get_$4gl:function(){return this.$2iO},set_$4gl:function(n){this.$2iO=n;this.$80f();return n},$5W3:function(n,t){for(var r=n;r<n+t;r++){var i=this.$1U.get_$3o(r);if(i.$10b>1){var u;if(i.$10b>100){this.$37g=!0;u=String.format(_nbs.NonBootStrings.l_ApproximateNumberCount_Text,i.$10b)}else u=i.$10b.toString();var f=new _d.$Q1(this.$14i(r),"",u,_nbs.NonBootStrings.l_SubmessageEndSeparator_Text,i,this.get_$3OY(),!0,this.$1H);this.$Pb.$D(f)}}},$6WR:function(n){_d.$Mi.prototype.$6WR.call(this,n);if(!$5(this.$1U)&&this.$1U.get_$C()){for(var t=!1,i=0;i<this.$1U.get_$C();i++){var r=this.$1U.get_$3o(i);if(r.$10b>100){t=!0;break}}t!==this.$37g&&(this.$37g=t)}},$20c:function(){return!0},$80f:function(){if(this.$2iO<1e3){var n=this.$37g?String.format(_nbs.NonBootStrings.l_ApproximateNumberCount_Text,this.$2iO):this.$2iO.toString();this.set_$sd(String.format(_u.Strings.l_InfoMailTipLargeAudience_Text,n))}else this.set_$sd(String.format(_nbs.NonBootStrings.l_InfoMailTipExtraLargeAudience_Text,1e3))},$80W:function(){if(this.$33L>0){this.set_$2vo(String.format(_nbs.NonBootStrings.l_InfoMailTipLargeAudienceIndividual_Text,this.$33L));!this.$EZ&&this.$44c&&this.set_$44d(!1)}else{this.set_$2vo("");this.set_$44d(!0)}}};_d.$Mi=function(n,t,i,r,u,f){this.$$d_$Wi=Function.createDelegate(this,this.$Wi);this.$$d_$9n7=Function.createDelegate(this,this.$9n7);_d.$Mi.initializeBase(this,[n,r,u]);this.$6Vt=new _C(this.$$d_$9n7,_a.$0.$l);this.$6WI=i;this.$1U=t;this.$1H_6=f;this.$1U.add_$1Y(this.$$d_$Wi)};_d.$Mi.$6O2=function(n,t){var r=n.get_$p2().get_$Mc();n.get_$p2().$AE();if(r){var i=new _d.$S;t&&i.set_$Bk(t.get_$Bk());i.set_$66(0);i.set_$3w(0);i.set_$3s("Html"===_g.$V.get_$I().get_$13().get_$133()?"HTML":"Text");if(_y.$3X.$3Wh(r,i,t.get_$Bk())){var u=new _y.$CW;u.$TO(i)}else _js.Trace.logInfo(_a.$0.$sc,"Cannot parse the mailto link in the mailtip message. The original link address is [{0}]",r)}};_d.$Mi.prototype={$1H_6:null,$1U:null,$6WI:null,$219:!1,$6Vt:null,$37J:!1,$4W9:null,get_$9nj:function(){return this.$4W9},set_$9nj:function(n){this.$4W9=n;$3(this,"RemoveLinkText");return n},get_$3OY:function(){return this.$6WI},$Md:null,get_$5lE:function(){return this.$219},set_$5lE:function(n){this.$219=n;this.set_$47Y(this.$219||this.get_$1f7()||this.get_$365());$3(this,"IsRemoveLinkHidden");return n},get_$47Y:function(){return this.$37J},set_$47Y:function(n){this.$37J=n;$3(this,"IsSeparatorHidden");return n},$14i:function(n){var t=this.$1U.get_$3o(n);return $5(t.get_$1o())||_js.$8.$15(t.get_$1o())?t.get_$Vg():t.get_$1o()},$20c:function(){return this.$1U.get_$C()>1},get_$ai:function(){return this.$Md},set_$ai:function(n){if(n!==this.$Md){this.$Md=n;_d.$Mi.$6O2(this.$Md,this.$1H_6)}return n},get_$1f7:function(){return _d.$15Z.prototype.get_$1f7.call(this)},set_$1f7:function(n){this.set_$47Y(n||this.$219||this.get_$365());_d.$15Z.prototype.set_$1f7.call(this,n);return n},get_$365:function(){return _d.$15Z.prototype.get_$365.call(this)},set_$365:function(n){this.set_$5lE(this.$219||n);this.set_$47Y(this.$37J||n);_d.$15Z.prototype.set_$365.call(this,n);return n},get_$m4:function(){return _d.$Mi.$1Lh},$6WR:function(n){for(var i=0;i<n.length;i++)for(var r=n[i],t=0;t<this.$Pb.get_$C();t++){var u=this.$Pb.get_$3o(t);u.$4VG===r&&this.$Pb.$6C(t)}},$Wi:function(n,t){if(this.$47o)switch(t.$2Z){case 0:this.$5W3(t.$4b,t.$2q.length);break;case 2:this.$6WR(t.$3B);break;case 4:this.$2dm();break;default:break}(this.$1U.get_$C()>0||this.$5mm)&&this.$6nV();this.$8Js()||this.$EZ||this.set_$7w(!0);$6J(this,"MessageUpdated")},$8Js:function(){return this.$20c()},$2dm:function(){this.$Pb.$1t();this.$5W3(0,this.$1U.get_$C())},$5W3:function(n,t){},$6nV:function(){_d.$15Z.prototype.$6nV.call(this);this.get_$365()||this.set_$9nj(this.$20c()?_nbs.NonBootStrings.l_MessageRemoveAll_Text:_nbs.NonBootStrings.l_MessageRemoveRecipient_Text)},$9n7:function(){while(this.$1U.get_$C()>0){var n=this.$1U.get_$3o(0).get_$Vg();this.get_$3OY()(n)}},$80W:function(){for(var t="",n=0;n<this.$1U.get_$C();n++){var i=$5(this.$1U.get_$3o(n).get_$1o())?this.$1U.get_$3o(n).get_$Vg():this.$1U.get_$3o(n).get_$1o();n?t+=_nbs.NonBootStrings.l_MessageNameSeparator_Text+i:t=i}this.set_$2vo(t)},$80f:function(){}};_d.$Q1=function(n,t,i,r,u,f,e,o){_d.$Q1.initializeBase(this,[n,t,i,r,e]);this.$4VG=u;this.$1H=o;if($5(f))this.$5lD=!0;else{var s=this;this.$1Uq=new _C(function(){f(s.$4VG.get_$Vg())},_a.$0.$l)}};_d.$Q1.prototype={$5lD:!1,$1H:null,$1Uq:null,$4VG:null,$Md:null,get_$m4:function(){return _d.$Q1.$1Lh},get_$ai:function(){return this.$Md},set_$ai:function(n){if(n!==this.$Md){this.$Md=n;_d.$Mi.$6O2(this.$Md,this.$1H)}return n},get_$9nw:function(){return _d.$4.get_$1tY()}};_d.$1BJ=function(n,t,i,r,u,f){_d.$1BJ.initializeBase(this,[n,t,i,r,u,f]);this.$15N=!0;this.set_$1Qa(!1);this.$6nV()};_d.$1BJ.prototype={$80f:function(){this.set_$sd(this.$20c()?String.format(_nbs.NonBootStrings.l_WarningMailTipModeratedMessageMultiple_Text,this.$1U.get_$C()):String.format(_u.Strings.l_WarningMailTipModeratedMessage_Text,this.$14i(0)))}};_d.$Oa=function(n){_d.$Oa.initializeBase(this);this.$2d2=n};_d.$Oa.prototype={$2d2:null,$3jU:null,$5NJ:null,$10b:0,$2yD:0,get_$1o:function(){var t=_rw.$36.$2Oi(this.$2d2);var n=t.match(_d.$Oa.$5VB);n&&n.length>1&&n[1].trim().length>0&&(t=n[1].trim());n=t.match(_d.$Oa.$2xI);n&&n.length>1&&n[1].trim().length>0&&(t=n[1].trim());return t},get_$Vg:function(){return this.$2d2.$CB.get_$1l().EmailAddress}};_d.$1DD=function(n,t,i,r,u,f){_d.$1DD.initializeBase(this,[n,t,i,r,u,f]);this.$15N=!0;this.set_$1Qa(!1);this.$6nV()};_d.$1DD.prototype={$80f:function(){this.set_$sd(this.$20c()?String.format(_nbs.NonBootStrings.l_WarningMailTipMailBoxFullMultiple_Text,this.$1U.get_$C()):this.set_$sd(String.format(_u.Strings.l_WarningMailTipMailBoxFull_Text,this.$14i(0))))}};_d.$1Dd=function(n,t,i,r,u,f){_d.$1Dd.initializeBase(this,[n,t,i,r,u,f]);this.$15N=!0;this.set_$1Qa(!1);this.$6nV()};_d.$1Dd.prototype={$80f:function(){this.set_$sd(this.$20c()?String.format(_nbs.NonBootStrings.l_WarningMailTipNoPermissionToSendMultiple_Text,this.$1U.get_$C()):String.format(_u.Strings.l_WarningMailTipNoPermissionToSend_Text,this.$14i(0)))}};_d.$15Z=function(n,t,i){_d.$15Z.initializeBase(this,[n]);this.$49X=t;this.$3St=this.$EZ?_nbs.NonBootStrings.l_MessageShowDetails_Text:_u.Strings.l_MessageHideDetails_Text;this.$Ad=i};_d.$15Z.prototype={$Pb:null,$Ad:0,$EZ:!0,$49X:null,$5ll:!1,$3St:null,$44c:!0,$5mm:!1,$5jn:!1,$47o:!1,$15N:!1,$2V6:null,$2vn:null,get_$sd:function(){return this.$2V6},set_$sd:function(n){this.$2V6=n;$3(this,"MainEntryText");return n},get_$2vo:function(){return this.$2vn},set_$2vo:function(n){this.$2vn=n;$3(this,"DetailEntryText");return n},get_$A0n:function(){return this.$3St},set_$A0n:function(n){this.$3St=n;$3(this,"ShowHideText");return n},get_$7w:function(){return this.$EZ},set_$7w:function(n){this.$EZ=n;this.set_$44d(!this.$15N||this.$EZ||_js.$8.$a(this.$2vn));this.set_$A0n(this.$EZ?_nbs.NonBootStrings.l_MessageShowDetails_Text:_u.Strings.l_MessageHideDetails_Text);$3(this,"IsCollapsed");return n},get_$1Qa:function(){return this.$47o},set_$1Qa:function(n){this.$47o=n;this.$Pb=new _js.$c;return n},get_$1f7:function(){return this.$5ll},set_$1f7:function(n){this.$5ll=n;$3(this,"IsShowHideLinkHidden");return n},get_$365:function(){return this.$5jn},set_$365:function(n){this.set_$1f7(this.get_$1f7()||n);this.$5jn=n;$3(this,"IsMainEntryHidden");return n},get_$44d:function(){return this.$44c},set_$44d:function(n){this.$44c=n;$3(this,"IsDetailEntryHidden");return n},add_$27g:function(n){this.$2G("MessageUpdated",n)},remove_$27g:function(n){this.$2H("MessageUpdated",n)},$1IV:function(){this.$49X&&this.$49X()},$6nV:function(){if(!this.get_$365()){this.$80f();this.set_$1f7(!this.$8Js())}this.$15N&&this.$80W()}};_d.$B6=function(n){this.$$d_$6HJ=Function.createDelegate(this,this.$6HJ);_d.$B6.initializeBase(this);this.$k=OwaApplication.$1W;this.$1v=n};_d.$B6.$1xS=function(n){var t=null;if(n){t=_a.$3.$30d(n);if(!t){var i=n.__type;if(i&&i===_g.$CV._dataContractName){var r=n.ErrorCode;var u=_js.$1i.$9S(_0365f.$Nx,r);t="HTTP_"+(u===""?r:u)}}}return t};_d.$B6.$1co=function(n){var t=null;if(n){t=n.message;if(!t){var i=n.__type;i&&i===_g.$CV._dataContractName&&(t=n.FaultMessage)}}return t};_d.$B6.prototype={$k:null,$1v:null,$pZ:function(n,t,i,r){$5(t)||n.add_$29(t);n.add_$21(i||this.$$d_$6HJ);$5(r)||n.add_$2t(r);this.$k.$11(n)},$A4s:function(n,t,i,r,u,f){var e=n[t++];var s=this;var o=function(){t<n.length?s.$A4s(n,t,i,r,u,f):r(e)};var h=this,c=this;this.$pZ(e,function(){o()},function(){u(e);i&&o()},f)},$6ej:function(n,t){var i=_nbs.NonBootStrings.l_MailComposeActionFailed_Text;this.$194(n,i,null,i,null,t)},$1xQ:function(n,t,i,r,u,f){var e=t;var o=n.$1d;if(o){if(_g.$CV.$5iP(o)){var h=o;if(h.get_$5li()){_js.Trace.logInfo(_a.$0.$l,"GetErrorMessage returning service unavailable "+_u.Strings.l_ErrorServiceUnavailable_Text+" since the specified exception was a service unavailable json fault body");e=_u.Strings.l_ErrorServiceUnavailable_Text}else if(h.get_$5lJ()&&u){_js.Trace.logInfo(_a.$0.$l,"GetErrorMessage returning request timeout "+u+" since the specified exception was a request timeout json fault body");e=u}else if(h.get_$5i3()&&i){_js.Trace.logInfo(_a.$0.$l,"GetErrorMessage returning disconnected "+i+" since the specified exception was a disconnected json fault body");e=i}}if(e===t){var s=_a.$3.$30d(o);s?r&&s==="ErrorItemNotFound"?e=r:s==="ErrorAccessDenied"?e=_u.Strings.l_WarningNoPermissionToPerformAction_Text:f&&s==="ErrorQuotaExceeded"?e=f:_js.Trace.logInfo(_a.$0.$g6,"CalculateInfoBarMessageId returning default id "+t+" since the specified exception was not one of the specific jsonFaultBody or response code exceptions we are currently looking for"):_js.Trace.logWarning(_a.$0.$g6,"CalculateInfoBarMessageId returning default id "+t+" since the specified exception was not a JsonFaultBody exception or an exception with response code. The exception.Message was "+o.message)}}else _js.Trace.logInfo(_a.$0.$l,"GetErrorMessage returning default message "+t+" since the exception was null");_js.Trace.logInfo(_a.$0.$l,"MailComposeActionSubmitter.GetErrorMessage: showing error {0}",e);return e},$194:function(n,t,i,r,u,f){var e=this.$1xQ(n,t,i,r,u,null);this.$1v.$2u(0,e,f)},$6HJ:function(n){this.$6ej(n,null);this.$4Uw(n)},$4Uw:function(n){$KL(this,"MailComposeActionFailed",n)}};_d.$S=function(){this.$$d_$7yO=Function.createDelegate(this,this.$7yO);_d.$S.initializeBase(this);this.set_$3s("Html"===_g.$V.get_$I().get_$13().get_$133()?"HTML":"Text");this.$Y(_d.$S.$2b9.$1k,this.$$d_$7yO);this.$Y(_d.$S.$368.$1k,this.$$d_$7yO);if(_a.$j.$2v&&_a.$j.get_$yb()){this.set_$Fk(_g.$V.get_$I().get_$13().get_$2gq());this.set_$I8(_g.$V.get_$I().get_$13().get_$2gu())}};_d.$S.$$cctor=function(){_d.$S.$1Wy.set_$HL(new _a.$EP(_g.$1q));_d.$S.$1MU.set_$HL(new _a.$EP(_g.$1q));_d.$S.$1M6.set_$HL(new _a.$EP(_g.$1q));_d.$S.$3U8.set_$HL(new _a.$EP(_pc.$l));_d.$S.$1Yo.set_$HL(new _a.$EP(_g.Attachment));_d.$S.$1c4.set_$HL(new _a.$EP(_g.$L7))};_d.$S.$AJR=function(n,t,i,r){if(!(i in t))return r;var u=t[i];return _js.$8.$a(u)?r:_js.$1i.$Qb(n,u)};_d.$S.$6Pm=function(n,t,i){if(!(t in n))return i;var r=n[t];return _js.$8.$a(r)?i:Boolean.parse(r)};_d.$S.$5AS=function(n,t,i,r){if(n)for(var f=0;f<n.get_$C();f++){var u=n.get_$3o(f);if(_g.$2R.$4i(u,i)){_js.Trace.logInfo(_a.$0.$l,"Excluding original from {0}",i);continue}if(_d.$S.$1QU(u.EmailAddress)){_js.Trace.logInfo(_a.$0.$l,"Excluding self address {0}",_d.$S.$11D||"null");continue}if(r&&r.get_$C()!==r.$Dn(function(n){return _g.$2R.$4i(u,n)})){_js.Trace.logInfo(_a.$0.$l,"Excluding address {0} already in to",u);continue}t.$D(u)}};_d.$S.$1QU=function(n){return!_js.$8.$15(_d.$S.$11D)&&!_js.$8.$15(n)&&(_d.$S.$11D===n||_d.$S.$11D.toLowerCase()===n.toLowerCase())};_d.$S.$4AZ=function(n,t,i,r){r.val+=" "+n+"(";if(t)for(var u=0;u<t.get_$C();u++){r.val+=_g.$2R.$xr(t.get_$3o(u));u!==t.get_$C()-1&&(r.val+="|")}r.val+=" QS="+i+")"};function $4rT(n,t,i){i.val=$5(i.val)?!1:i.val;t.set_$2i(n.get_$2i());t.set_$6Y(n.get_$6Y());t.set_$i(n.get_$9x());t.set_$1P(new(_a.$1r.$$(_g.Attachment,_g.$Dq)));if(n.get_$QH()){var o=_g.$V.get_$I().get_$Tr().ClearSign;t.set_$7n(n.get_$Fk()?"IPM.Note.SMIME":o?"IPM.Note.SMIME.MultipartSigned":"IPM.Note.SMIME");t.get_$7n()==="IPM.Note.SMIME.MultipartSigned"?t.set_$3M($4rP(n,i.val)):t.set_$3M(new _g.$6j(new _g.$6b(n.get_$3s(),"")));t.set_$JM(new _g.$Yf(_a.$9R.$Ew(n.get_$6h8())))}else{t.set_$3M($4rP(n,i.val));(n.get_$Sn()&&n.get_$Sn().get_$G9()||n.get_$Ch()&&n.get_$Ch().get_$G9())&&t.set_$7n("IPM.Note");n.get_$8j()&&t.get_$1P().$6S(n.get_$8j().$6W())}t.set_$5r(n.get_$5r());t.set_$8F(n.get_$8F());t.set_$LW(n.get_$LW());t.set_$R9(n.get_$R9());t.set_$Pq(n.get_$Pq());t.set_$UE(n.get_$UE());t.set_$Vw(n.get_$Vw());t.set_$UN(n.get_$UN());if(n.get_$UP()){t.set_$HD(new(_a.$1r.$$(_g.$L7,_g.$Cv)));t.get_$HD().$6S(n.get_$UP().$6W())}if(_g.$81.isInstanceOfType(t)){var r=t;r.set_$3U(n.get_$3U());if(n.get_$QH()&&n.$c3){if(n.$c3===1){r.set_$4Z(new(_a.$Z.$$(_g.$1q)));n.get_$4Z()&&r.get_$4Z().$6S(n.get_$4Z().$6W());r.set_$4l(new(_a.$Z.$$(_g.$1q)));n.get_$4l()&&r.get_$4l().$6S(n.get_$4l().$6W())}else if(n.$c3===2){r.set_$6I(new(_a.$Z.$$(_g.$1q)));n.get_$6I()&&r.get_$6I().$D(n.get_$6I().get_$3o(n.$1NJ))}else if(n.$c3===3){r.set_$6I(new(_a.$Z.$$(_g.$1q)));n.get_$6I()&&r.get_$6I().$6S(n.get_$6I().$6W())}}else{r.set_$4Z(new(_a.$Z.$$(_g.$1q)));n.get_$4Z()&&r.get_$4Z().$6S(n.get_$4Z().$6W());r.set_$4l(new(_a.$Z.$$(_g.$1q)));n.get_$4l()&&r.get_$4l().$6S(n.get_$4l().$6W());r.set_$6I(new(_a.$Z.$$(_g.$1q)));n.get_$6I()&&r.get_$6I().$6S(n.get_$6I().$6W())}r.set_$Gi(n.get_$Gi());r.set_$G8(n.get_$G8());r.set_$Fk(n.get_$Fk());r.set_$I8(n.get_$I8())}else{var u=t;u.set_$28(n.get_$1kL());var f=_g.$V.get_$I().get_$2z();var e=null;e=_js.$8.$a(f.get_$b6())?null!==n.get_$3U()&&n.get_$3U().Mailbox?n.get_$3U().Mailbox.EmailAddress:_h.$3L.$2zq(null)||f.get_$AM():f.get_$b6();if(e){u.set_$3U(new _g.$Bc);u.get_$3U().Mailbox=new _g.$1q;u.get_$3U().Mailbox.EmailAddress=e}}}function $731(n,t){var i=$732(n,t);switch(n.get_$3w()){case 0:case 4:n.set_$9x(i);break;case 1:case 2:case 3:n.set_$dv(i);break}}function $4rR(n,t){if(t.get_$HD()){n.set_$UP(new _js.$c);n.get_$UP().$6S(t.get_$HD().$6W())}}function $732(n,t){var i=null;if(!$5(t)&&"Id"in t){i=new _g.$1t(t.Id);"ChangeKey"in t&&(i.ChangeKey=t.ChangeKey)}return i}function $4rW(n,t,i){0===t.get_$gt()&&t.set_$gt(i&&i.get_$3s()==="Text"?1:3)}function $730(n,t){var u=_h.$3L.$2zq(t);if(u){n.set_$3U(new _g.$Bc);n.get_$3U().Mailbox=new _g.$1q;n.get_$3U().Mailbox.EmailAddress=u}n.set_$15W(!1);n.get_$5r()&&!n.get_$5r().get_$HX()?n.set_$3s(t.get_$5r().get_$3s()):t.get_$VO()?n.set_$3s(t.get_$VO().get_$3s()):t.get_$3M()&&n.set_$3s(t.get_$3M().get_$3s());switch(n.get_$3w()){case 1:case 2:case 12:$2l1(n,t);if(_g.$81.isInstanceOfType(t)){var i=t;i.get_$Iy()?n.$1JK(i.get_$3U()||i.get_$8m(),null,null,null):n.$1JK(i.get_$3U()||i.get_$8m(),i.get_$4Z()?i.get_$4Z().get_$AIt():null,i.get_$4l()?i.get_$4l().get_$AIt():null,i.get_$3Oj()?i.get_$3Oj().get_$AIt():null);n.set_$2Ss(n.get_$3w()===2&&t.get_$3Ad());n.set_$3Kz(t.get_$1vQ())}else if(_g.$Mw.isInstanceOfType(t)){var f=t;n.$1JK(f.get_$3U()||f.get_$8m(),null,null,null)}$3b6(n,t);break;case 5:case 6:case 7:if(_g.$81.isInstanceOfType(t)){var r=t;n.$1JK(r.get_$3U()||r.get_$8m(),r.get_$4Z()?r.get_$4Z().get_$AIt():null,r.get_$4l()?r.get_$4l().get_$AIt():null,r.get_$3Oj()?r.get_$3Oj().get_$AIt():null)}break;case 3:_g.$Ro.isInstanceOfType(t)||$2l1(n,t);n.set_$3Kz(t.get_$1vQ());$4rO(n);$3b6(n,t);break;case 9:case 10:_g.$81.isInstanceOfType(t)?n.$1JK(t.get_$8m(),null,null,null):_g.$Mw.isInstanceOfType(t)&&n.$1JK(t.get_$8m(),null,null,null);$3b6(n,t);break;default:$4rU(n);break}_js.Trace.logInfo(_a.$0.$l,"Initialized context with original email message, context:"+n.toString())}function $72y(n,t){n.set_$dv(t.get_$i());var i=n.$47G();n.set_$5r(i?null:t.get_$5r());$733(n,t.get_$oc());n.set_$8F(t.get_$8F());n.set_$Nu(n.get_$Nu()||"");n.get_$5r()&&!n.get_$5r().get_$HX()?n.set_$3s(n.get_$5r().get_$3s()):t.get_$VO()?n.set_$3s(t.get_$VO().get_$3s()):n.set_$3s(t.get_$gt()===1?"Text":"HTML");if(!n.get_$Eb()){n.set_$Eb(!(n.get_$3w()===1||n.get_$3w()===2||n.get_$3w()===3||n.get_$3w()===12));n.get_$3w()!==3||_a.$j.$2v&&t.get_$G9()||i||n.get_$5r()&&n.get_$5r().get_$HX()||n.set_$8j(t.get_$1P()?t.get_$1P().get_$AIt():null)}if(_g.ICalendaring.isInstanceOfType(t)){var r=t;r.$3RZ();$72z(n,r)}else if(_g.$81.isInstanceOfType(t)||_g.$Mw.isInstanceOfType(t)){if(3===n.get_$3w()&&!n.get_$Eb()){n.set_$6Y(t.get_$6Y());_js.Trace.logInfo(_a.$0.$l,"Setting importance to "+n.get_$6Y()+" since we are forwarding item "+_h.$E0.$xr(t.get_$i())+" with that importance")}$730(n,t)}else throw Error.invalidOperation(String.format("Original item of type {0} is not supported.",Object.getType(t).getName()));$4rV(n);_g.$81.isInstanceOfType(t)&&t.$2Ph?n.set_$as(!1):n.set_$as(!0)}function $72x(n,t){var i=null;_g.$Q4.isInstanceOfType(t)||_g.$Mj.isInstanceOfType(t)?i=t.get_$3U():t.get_$FX()?i=t.get_$FX():_js.Trace.logError(_a.$0.$l,"ICalendaring doesnt have an organizer");return i}function $4rV(n){var t=new(_0365f.$n.$$(String));n.get_$1ET()&&t.$6S(_g.$CY.$5Xh(n.get_$8j()));if(n.$5Y&&_a.$j.$2v&&n.$5Y.get_$G9()&&n.$5Y.get_$1PD()){var i=n.$5Y.get_$1P().get_$3o(0).get_$3l().Id;t.$D(i)}n.set_$1Ys(t.$6W())}function $72z(n,t){n.set_$15W(!0);t.get_$3M()&&n.set_$3s(t.get_$3M().get_$3s());var u=$72x(n,t);var i;var r;if(_g.$Q4.isInstanceOfType(t)||_g.$Mj.isInstanceOfType(t)){i=t.get_$4Z()?_g.$2R.$2Nt(t.get_$4Z().get_$AIt()):null;r=t.get_$4l()?_g.$2R.$2Nt(t.get_$4l().get_$AIt()):null}else{i=t.get_$7G()?_g.$2R.$2Nt(_g.$3i.$4gM(t.get_$7G().get_$AIt())):null;r=t.get_$8D()?_g.$2R.$2Nt(_g.$3i.$4gM(t.get_$8D().get_$AIt())):null}switch(n.get_$3w()){case 1:case 2:n.$1JK(u,i,r,null);break;case 5:case 6:case 7:n.$1JK(u,i,r,null);$2l2(n,t);n.set_$2Pr(!0);break;case 8:var f=t.get_$7G().$3g();f.$6S(t.get_$9F().$6W());i=_g.$2R.$2Nt(_g.$3i.$4gM(f.get_$AIt()));n.$1JK(u,i,r,null);$2l2(n,t);n.set_$2Pr(!0);break;case 3:if(_g.$CY.isInstanceOfType(t)||_g.$2o.isInstanceOfType(t)){n.set_$1ET(!0);n.set_$3U(u);$2l2(n,t)}break;default:$4rU(n);break}n.set_$WK(!0);_js.Trace.logInfo(_a.$0.$l,"Initialized context from original calendar item, context:"+n.toString())}function $2l2(n,t){n.set_$16G(_cc.$9C.$80F(t));n.set_$4g(t.get_$4g());n.set_$1yC(!!n.get_$4g()&&!_js.$8.$a(n.get_$4g().get_$1o()))}function $733(n,t){var i="";switch(n.get_$3w()){case 1:case 2:case 12:i=_u.Strings.l_ReplyPrefix_Text;break;case 3:i=_nbs.NonBootStrings.l_ForwardPrefix_Text;break;case 5:i=_nbs.NonBootStrings.l_AcceptPrefix_Text;break;case 6:i=_nbs.NonBootStrings.l_TentativelyAcceptPrefix_Text;break;case 7:i=_nbs.NonBootStrings.l_DeclinePrefix_Text;break;case 8:i=_nbs.NonBootStrings.l_CanceledMeetingMessagePrefix_Text;break;case 9:i=_nbs.NonBootStrings.l_ApprovePrefix_Text;break;case 10:i=_nbs.NonBootStrings.l_RejectPrefix_Text;break}n.get_$2Pa()&&(i=_nbs.NonBootStrings.l_NewTimeProposedPrefix_Text);var r=String.format(_nbs.NonBootStrings.l_SubjectFormat_Text,i,t);_js.Trace.logInfo(_a.$0.$l,"Formatted subject with Prefix="+i+"; Operation="+n.get_$3w());if(255<r.length){n.set_$2i(r.substr(0,255));_js.Trace.logInfo(_a.$0.$l,"Truncated subject from "+r+" to "+n.get_$2i()+" to meet the "+255+" characters rule.")}else n.set_$2i(r)}function $3b6(n,t){n.set_$3S(t.get_$3S());_g.$81.isInstanceOfType(t)?n.set_$28O(t.get_$9z()):_g.$Mw.isInstanceOfType(t)&&n.set_$28O(t.get_$9z())}function $4rU(n){var t=_js.$1i.$9S(_y.$Hk,n.get_$3w());throw Error.invalidOperation(String.format("Cannot perform operation {0} with original item.",t));}function $2l1(n,t){n.set_$LW(t.get_$LW());n.set_$UE(t.get_$UE());n.set_$R9(t.get_$R9());n.set_$Pq(t.get_$Pq());n.set_$1Md(t.get_$1Md())}function $4rP(n,t){return t?$4rQ(n):n.$5Kf()}function $4rQ(n){var t=new _g.$6j(new _g.$6b("HTML",""));t.set_$1n("");if(4!==n.get_$3w()&&13!==n.get_$3w()||n.get_$Bk()){_js.Trace.logInfo(_a.$0.$l,"Create new body for action email message, setting body type to context body type: "+n.get_$3s());t.set_$3s(n.get_$3s())}else{_js.Trace.logInfo(_a.$0.$l,"Create new body for action email message, setting body type to text due to lack of support for RichTextEditor.");t.set_$3s("Text")}return t}function $4rO(n){if(_y.$x.$w.get_$W5()){var t=n.$303();if(t){var r=!1;if(n.get_$4l())for(var i=0;i<n.get_$4l().get_$C();i++){var u=n.get_$4l().get_$3o(i);if(t.EmailAddress.toLowerCase()===u.EmailAddress.toLowerCase()){r=!0;break}}if(!r){n.get_$4l()||n.set_$4l(new _js.$c);n.get_$4l().$D(t);_js.Trace.logInfo(_a.$0.$l,"Adding self to CC")}}else _js.Trace.logError(_a.$0.$l,"Could not add self to CC as the address was missing")}}function $4rS(n,t){if(_js.$8.$a(t.get_$7n())||t.get_$7n()==="IPM.Note"||t.get_$G9())return!0;else{var i=n.get_$3w()===1||n.get_$3w()===2;var r=i||n.get_$3w()===3;return i&&t.get_$7n().startsWith("IPM.Schedule.Meeting")?!0:r&&t.get_$7n().startsWith("REPORT.IPM.Note")?!0:r&&t.get_$7n()==="IPM.Post"?!0:!1}}_d.$S.prototype={$J8:null,$5Y:null,$IO:null,$30s:null,$d8:!1,$2Ro:!1,$5mi:!1,$WE:null,$4Md:!1,$2g5:!1,$34r:!1,$8J9:!1,$c3:0,$1NJ:0,$cQ:null,$4C6:0,$4cm:null,get_$2Pa:function(){return!!this.get_$3NC()},get_$3NC:function(){return this.$W(_d.$S.$4Ud)},set_$3NC:function(n){this.$M(_d.$S.$4Ud,_cc.$BD.$80G(n));return n},get_$AFv:function(){return this.get_$2Pa()?_nbs.NonBootStrings.l_CurrentMeetingTime_Short_Text:_ucmm.MeetingMsgStrings.l_WhenLabel_Text},get_$7t:function(){return this.$W(_d.$S.$4jF)},set_$7t:function(n){this.$M(_d.$S.$4jF,n);return n},get_$3w:function(){return this.$W(_d.$S.$2b9)},set_$3w:function(n){this.$M(_d.$S.$2b9,n);return n},get_$66:function(){return this.$W(_d.$S.$17F)},set_$66:function(n){this.$M(_d.$S.$17F,n);return n},get_$dv:function(){return this.$W(_d.$S.$4R3)},set_$dv:function(n){this.$M(_d.$S.$4R3,n);return n},get_$3Kz:function(){return this.$W(_d.$S.$4R2)},set_$3Kz:function(n){this.$M(_d.$S.$4R2,n);return n},get_$Ch:function(){this.$5Y||(this.$5Y=this.$W(_d.$S.$4R4));return this.$5Y},set_$Ch:function(n){this.$5Y=n;this.$M(_d.$S.$4R4,this.$5Y);return n},get_$9x:function(){return this.$W(_d.$S.$3t4)},set_$9x:function(n){if($5(this.get_$9x())||!n)this.$M(_d.$S.$3t4,n);else{this.get_$9x().Id=n.Id;this.get_$9x().ChangeKey=n.ChangeKey}return n},get_$47P:function(){return!!this.get_$9x()},get_$6iV:function(){return this.$W(_d.$S.$4di)},set_$6iV:function(n){this.$M(_d.$S.$4di,n);return n},get_$2i:function(){return this.$W(_d.$S.$Zd)},set_$2i:function(n){this.$M(_d.$S.$Zd,n);return n},get_$DF:function(){return this.$W(_d.$S.$1vj)},set_$DF:function(n){this.$M(_d.$S.$1vj,n);return n},get_$1xO:function(){return this.$J8},set_$1xO:function(n){this.$J8=n;return n},get_$Nu:function(){return this.$W(_d.$S.$4V2)},set_$Nu:function(n){this.$M(_d.$S.$4V2,n);return n},get_$19f:function(){return this.$W(_d.$S.$4fi)},set_$19f:function(n){this.$M(_d.$S.$4fi,n);return n},get_$3s:function(){return this.$W(_d.$S.$3kD)},set_$3s:function(n){this.$M(_d.$S.$3kD,n);return n},get_$4Z:function(){return this.$W(_d.$S.$1Wy)},set_$4Z:function(n){this.$M(_d.$S.$1Wy,n);return n},get_$2h8:function(){return this.$W(_d.$S.$3U8)},set_$2h8:function(n){this.$M(_d.$S.$3U8,n);return n},get_$cA:function(){return this.$W(_d.$S.$2Dp)},set_$cA:function(n){this.$M(_d.$S.$2Dp,n);return n},get_$4l:function(){return this.$W(_d.$S.$1MU)},set_$4l:function(n){this.$M(_d.$S.$1MU,n);return n},get_$a8:function(){return this.$W(_d.$S.$1tJ)},set_$a8:function(n){this.$M(_d.$S.$1tJ,n);return n},get_$6I:function(){return this.$W(_d.$S.$1M6)},set_$6I:function(n){this.$M(_d.$S.$1M6,n);return n},get_$Vj:function(){return this.$W(_d.$S.$1sQ)},set_$Vj:function(n){this.$M(_d.$S.$1sQ,n);return n},get_$NA:function(){return this.$W(_d.$S.$3Ru)},set_$NA:function(n){this.$M(_d.$S.$3Ru,n);return n},get_$6Y:function(){return this.$W(_d.$S.$1yp)},set_$6Y:function(n){this.$M(_d.$S.$1yp,n);return n},get_$1IG:function(){return this.$W(_d.$S.$4Uu)},set_$1IG:function(n){this.$M(_d.$S.$4Uu,n);return n},get_$6h8:function(){return this.$W(_d.$S.$4cl)},set_$6h8:function(n){this.$M(_d.$S.$4cl,n);return n},get_$3Tr:function(){return this.$W(_d.$S.$4cn)},set_$3Tr:function(n){this.$M(_d.$S.$4cn,n);return n},get_$3Tt:function(){return this.$W(_d.$S.$4co)},set_$3Tt:function(n){this.$M(_d.$S.$4co,n);return n},get_$as:function(){return this.$W(_d.$S.$44L)},set_$as:function(n){this.$M(_d.$S.$44L,n);return n},get_$WK:function(){return this.$W(_d.$S.$368)},set_$WK:function(n){this.$M(_d.$S.$368,n);return n},get_$1ET:function(){return this.$W(_d.$S.$46D)},set_$1ET:function(n){this.$M(_d.$S.$46D,n);return n},get_$2Ss:function(){return this.$W(_d.$S.$47F)},set_$2Ss:function(n){this.$M(_d.$S.$47F,n);return n},get_$4g:function(){return this.$W(_d.$S.$22d)},set_$4g:function(n){this.$M(_d.$S.$22d,n);return n},get_$1yC:function(){return this.$W(_d.$S.$40T)},set_$1yC:function(n){this.$M(_d.$S.$40T,n);return n},get_$16G:function(){return this.$W(_d.$S.$4Bn)},set_$16G:function(n){this.$M(_d.$S.$4Bn,n);return n},get_$3U:function(){return this.$W(_d.$S.$1x4)},set_$3U:function(n){this.$M(_d.$S.$1x4,n);return n},get_$8m:function(){return this.$W(_d.$S.$4Zf)},set_$8m:function(n){this.$M(_d.$S.$4Zf,n);return n},get_$Eb:function(){return this.$W(_d.$S.$48F)},set_$Eb:function(n){this.$M(_d.$S.$48F,n);return n},get_$Uf:function(){return this.$W(_d.$S.$459)},set_$Uf:function(n){this.$M(_d.$S.$459,n);return n},get_$nW:function(){return this.$W(_d.$S.$43y)},set_$nW:function(n){this.$M(_d.$S.$43y,n);return n},get_$op:function(){return this.$W(_d.$S.$28P)},set_$op:function(n){this.$M(_d.$S.$28P,n);return n},get_$1kL:function(){return this.$W(_d.$S.$4Rn)},set_$1kL:function(n){this.$M(_d.$S.$4Rn,n);return n},get_$15W:function(){return this.$W(_d.$S.$46g)},set_$15W:function(n){this.$M(_d.$S.$46g,n);return n},get_$s8:function(){return this.$W(_d.$S.$46c)},set_$s8:function(n){this.$M(_d.$S.$46c,n);return n},get_$149:function(){return this.$W(_d.$S.$3uy)},set_$149:function(n){this.$M(_d.$S.$3uy,n);return n},get_$5ea:function(){return this.$W(_d.$S.$42B)},set_$5ea:function(n){this.$M(_d.$S.$42B,n);return n},get_$rd:function(){return this.$W(_d.$S.$40G)},set_$rd:function(n){this.$M(_d.$S.$40G,n);return n},get_$nj:function(){return this.$W(_d.$S.$47H)},set_$nj:function(n){this.$M(_d.$S.$47H,n);return n},get_$Sn:function(){return this.$W(_d.$S.$3t6)},set_$Sn:function(n){this.$M(_d.$S.$3t6,n);return n},get_$1Ys:function(){return this.$W(_d.$S.$3jB)},set_$1Ys:function(n){this.$M(_d.$S.$3jB,n);return n},get_$8j:function(){return this.$W(_d.$S.$1Yo)},set_$8j:function(n){var t=null;if(n){t=new _js.$c;for(var i=0;i<n.get_$C();i++)t.$D(n.get_$3o(i))}this.$M(_d.$S.$1Yo,t);$4rV(this);return n},get_$1KQ:function(){return this.$W(_d.$S.$4iX)},set_$1KQ:function(n){this.$M(_d.$S.$4iX,n);return n},get_$J1:function(){return this.$W(_d.$S.$3k0)},set_$J1:function(n){this.$M(_d.$S.$3k0,n);return n},get_$5r:function(){return this.$W(_d.$S.$4Xc)},set_$5r:function(n){if(n!==this.get_$5r()){this.$M(_d.$S.$4Xc,n);$3u(this,"IsCopyRestricted","IsPrintRestricted")}return n},get_$Ps:function(){return this.$W(_d.$S.$1tg)},set_$Ps:function(n){this.$M(_d.$S.$1tg,n);return n},get_$1zx:function(){return this.$d8},set_$1zx:function(n){this.$d8=n;n&&!this.get_$J1()&&this.$5SD();$3(this,"IsEditorInitialized");return n},get_$8K6:function(){return this.$2Ro},set_$8K6:function(n){this.$2Ro=n;$3(this,"IsEditorReady");return n},get_$4Bd:function(){return 255},get_$1EQ:function(){return this.$W(_d.$S.$45w)},set_$1EQ:function(n){this.$M(_d.$S.$45w,n);return n},get_$pz:function(){return this.$W(_d.$S.$4jb)},set_$pz:function(n){this.$M(_d.$S.$4jb,n);return n},get_$2Pr:function(){return this.$W(_d.$S.$41C)},set_$2Pr:function(n){this.$M(_d.$S.$41C,n);return n},get_$2SX:function(){return this.$W(_d.$S.$46S)},set_$2SX:function(n){this.$M(_d.$S.$46S,n);return n},get_$2El:function(){return this.$W(_d.$S.$4jf)},set_$2El:function(n){this.$M(_d.$S.$4jf,n);return n},get_$8NO:function(){return!!this.get_$5r()&&!this.get_$5r().get_$HX()&&!this.get_$5r().get_$2cW()&&!this.get_$5r().get_$9X()},get_$6fY:function(){return this.get_$WK()&&_d.$90.$5m4(this)},get_$15L:function(){return!!this.get_$5r()&&0===this.get_$5r().get_$HX()&&!this.get_$5r().get_$2N4()&&!this.get_$5r().get_$9X()},get_$26V:function(){return null},get_$4Td:function(){return null},get_$LW:function(){return this.$W(_d.$S.$44E)},set_$LW:function(n){this.$M(_d.$S.$44E,n);return n},get_$UE:function(){return this.$W(_d.$S.$3mR)},set_$UE:function(n){this.$M(_d.$S.$3mR,n);return n},get_$Vw:function(){return this.$W(_d.$S.$3si)},set_$Vw:function(n){this.$M(_d.$S.$3si,n);return n},get_$UN:function(){return this.$W(_d.$S.$3sh)},set_$UN:function(n){this.$M(_d.$S.$3sh,n);return n},get_$R9:function(){return this.$W(_d.$S.$3mT)},set_$R9:function(n){this.$M(_d.$S.$3mT,n);return n},get_$Pq:function(){return this.$W(_d.$S.$3mQ)},set_$Pq:function(n){this.$M(_d.$S.$3mQ,n);return n},get_$1Md:function(){return this.$W(_d.$S.$3mS)},set_$1Md:function(n){this.$M(_d.$S.$3mS,n);return n},get_$8F:function(){return this.$W(_d.$S.$2BH)},set_$8F:function(n){this.$M(_d.$S.$2BH,n);return n},get_$Gi:function(){return this.$W(_d.$S.$1zo)},set_$Gi:function(n){this.$M(_d.$S.$1zo,n);return n},get_$G8:function(){return this.$W(_d.$S.$215)},set_$G8:function(n){this.$M(_d.$S.$215,n);return n},get_$1Je:function(){return this.$W(_d.$S.$4ck)},set_$1Je:function(n){this.$M(_d.$S.$4ck,n);return n},get_$QH:function(){return _a.$j.$2v&&(this.get_$Fk()||this.get_$I8())},get_$Fk:function(){if(!_a.$j.$2v||!_a.$j.get_$1zX()||!this.$47h()||_g.$V.get_$I().get_$13().get_$iA())return!1;var n=_g.$V.get_$I().get_$Tr();return!!n&&n.AlwaysEncrypt||this.$W(_d.$S.$2CV)},set_$Fk:function(n){this.$M(_d.$S.$2CV,n);_js.Trace.logInfo(_a.$0.$3i,"Context.SmimeEncryptMessage is set to "+n);return n},get_$I8:function(){if(!_a.$j.$2v||!_a.$j.get_$1zX()||!this.$47h()||_g.$V.get_$I().get_$13().get_$iA())return!1;var n=_g.$V.get_$I().get_$Tr();return!!n&&n.AlwaysSign||this.$W(_d.$S.$2CW)},set_$I8:function(n){this.$M(_d.$S.$2CW,n);_js.Trace.logInfo(_a.$0.$3i,"Context.SmimeSignMessage is set to "+n);return n},get_$6hA:function(){return _g.$V.get_$I().get_$Tr()&&(_g.$V.get_$I().get_$Tr().AlwaysEncrypt||_g.$V.get_$I().get_$13().get_$iA())||this.get_$Uf()?!1:!0},get_$6hB:function(){return _g.$V.get_$I().get_$Tr()&&(_g.$V.get_$I().get_$Tr().AlwaysSign||_g.$V.get_$I().get_$13().get_$iA())||this.get_$Uf()?!1:!0},get_$3S:function(){return this.$W(_d.$S.$1ts)},set_$3S:function(n){this.$M(_d.$S.$1ts,n);return n},get_$28O:function(){return this.$W(_d.$S.$4Rk)},set_$28O:function(n){this.$M(_d.$S.$4Rk,n);return n},get_$2T0:function(){if(this.get_$WK()||_y.$x.$w.get_$W5()||this.get_$QH())return!1;var n=this.get_$5r();return!n||!!n.get_$HX()||n.get_$9X()},get_$47Q:function(){return OwaApplication.$jA?!1:this.get_$3w()!==8&&!this.get_$jh()},get_$1Ed:function(){return this.$W(_d.$S.$46r)},set_$1Ed:function(n){this.$M(_d.$S.$46r,n);return n},get_$jh:function(){return this.get_$3w()===11||this.get_$3w()===12||this.get_$3w()===13},get_$Qd:function(){return this.$W(_d.$S.$4SR)},set_$Qd:function(n){this.$M(_d.$S.$4SR,n);return n},get_$Bk:function(){return this.$W(_d.$S.$4XZ)},set_$Bk:function(n){this.$M(_d.$S.$4XZ,n);return n},get_$UP:function(){return this.$W(_d.$S.$1c4)},set_$UP:function(n){this.$M(_d.$S.$1c4,n);return n},get_$6h9:function(){this.$4cm||(this.$4cm=this.$30l());return this.$4cm},$42U:function(n){this.set_$66(_d.$S.$AJR(_y.$lB,n,_d.$S.$17F.$1k,0));this.set_$3w(_d.$S.$AJR(_y.$Hk,n,_d.$S.$2b9.$1k,0));this.set_$NA(_d.$S.$6Pm(n,_d.$S.$3Ru.$1k,!0));this.set_$15W(_d.$S.$6Pm(n,"IsCalendarItem",!1));if(n&&"StoreId"in n){this.set_$as(!1);this.set_$6iV(n.StoreId)}$731(this,n);this.set_$Eb(0===this.get_$3w()||4===this.get_$3w())},$5eu:function(n){_g.$mU.isInstanceOfType(n)?this.set_$3w(1):_g.$mT.isInstanceOfType(n)?this.set_$3w(2):_g.$pq.isInstanceOfType(n)&&this.set_$3w(3);$4rW(this,n,n.get_$1TE());this.set_$dv(n.get_$2dD());this.set_$3Kz(n.get_$3O0());this.set_$9x(n.get_$i());this.set_$2i(n.get_$2i());this.set_$Nu(n.get_$1TE().get_$1n());this.set_$3U(n.get_$3U());this.set_$4Z(n.get_$4Z()?n.get_$4Z().get_$AIt():null);this.set_$4l(n.get_$4l()?n.get_$4l().get_$AIt():null);this.set_$6I(n.get_$6I()?n.get_$6I().get_$AIt():null);this.set_$NA(!1);this.set_$6Y(n.get_$6Y());$2l1(this,n);this.set_$5r(n.get_$5r());this.set_$8F(n.get_$8F());this.set_$Gi(n.get_$Gi());this.set_$G8(n.get_$G8());this.get_$5r()&&!this.get_$5r().get_$HX()?this.set_$3s(this.get_$5r().get_$3s()):$5(n.get_$1TE())||(n.get_$VO()?this.set_$3s(n.get_$VO().get_$3s()):this.set_$3s(n.get_$gt()===1?"Text":"HTML"));$4rR(this,n);this.set_$Eb(!1);this.set_$as(!0);_js.Trace.logInfo(_a.$0.$l,"Initialized context with smart response, context:"+this.toString())},$42T:function(n){if($5(n))throw Error.argumentNull("message");$4rW(this,n,n.get_$3M());this.set_$Sn(n);this.set_$9x(n.get_$i());this.set_$2i(n.get_$2i());this.set_$Nu(n.get_$VO()?n.get_$VO().get_$1n():n.get_$3M().get_$1n());this.set_$3S(n.get_$3S());if(_g.$81.isInstanceOfType(n)){var t=n;this.set_$3U(t.get_$3U());this.set_$4Z(t.get_$4Z()?t.get_$4Z().$AIu():null);this.set_$4l(t.get_$4l()?t.get_$4l().$AIu():null);this.set_$6I(t.get_$6I()?t.get_$6I().$AIu():null);this.set_$Gi(t.get_$Gi());this.set_$G8(t.get_$G8())}else if(_g.$Mw.isInstanceOfType(n)){var u=n;this.set_$3U(u.get_$3U())}this.set_$NA(!1);this.set_$6Y(n.get_$6Y());$2l1(this,n);this.set_$5r(n.get_$5r());this.set_$8F(n.get_$8F());n.get_$5r()&&!n.get_$5r().get_$HX()?this.set_$3s(n.get_$5r().get_$3s()):n.get_$VO()?this.set_$3s(n.get_$VO().get_$3s()):this.set_$3s(n.get_$gt()===1?"Text":"HTML");this.set_$WK(_g.$Ro.isInstanceOfType(n));if(this.get_$WK()){var i=n;$2l2(this,i.get_$Kh());this.set_$1ET(_g.$CY.isInstanceOfType(i));i.get_$3U()&&this.set_$3U(i.get_$3U());i.get_$8m()&&this.set_$8m(i.get_$8m())}n.get_$hX()&&n.get_$hX().get_$C()?this.set_$8j(n.get_$hX()?n.get_$hX().get_$AIt():null):(!this.get_$1Ed()||this.get_$Eb())&&this.set_$8j(n.get_$1P()?n.get_$1P().get_$AIt():null);if(this.get_$8j()&&n.get_$3M().get_$3s()==="Text")for(var r=0;r<this.get_$8j().get_$C();r++)this.get_$8j().get_$3o(r)&&this.get_$8j().get_$3o(r).get_$6K()&&this.get_$8j().get_$3o(r).set_$6K(!1);$4rR(this,n);this.set_$Eb(!0);this.set_$as(!0);_js.Trace.logInfo(_a.$0.$l,"Initialized context with draft, context:"+this.toString())},$yB:function(n){this.set_$Ch(n);$72y(this,n)},$1NF:function(n){var t=new _g.$81;var i;$4rT(this,t,i={val:n});n=i.val;return t},$3pK:function(n){var t=new _g.$Mw;var i;$4rT(this,t,i={val:n});n=i.val;return t},$5Kf:function(){var t=$4rQ(this);_a.$3.$m(this.$IO,"GetRawEditorContentCommand");this.$IO.$s();var n=this.get_$Nu();t.set_$1n(n);this.$4C6=_js.$8.$a(n)?0:n.length;_js.Trace.logInfo(_a.$0.$l,"MailComposeContext.CreateBodyFromEditor, RawContentLength: "+this.$4C6.toString());return t},$ACI:function(n){var t=this.get_$J1();if(!t||this.get_$6Y()===t.get_$6Y()){this.set_$6Y(n);t&&t.set_$6Y(n)}},$5SD:function(){if(this.$d8&&this.$5mi){this.$J8.$s();if($5(this.get_$J1())){this.set_$J1(_d.$1m.$1tF(this));_js.Trace.logInfo(_a.$0.$l,"Captured baseline for the first time, context:"+this.toString());if(this.$4Md&&this.$WE){this.$WE.set_$DF(this.get_$J1().get_$DF());this.$4Md=!1}if(!this.get_$9x()||this.get_$1Ed()&&this.get_$pz()){this.$WE=_d.$1m.$1tF(this);_js.Trace.logInfo(_a.$0.$l,"Captured initial baseline for context:"+this.toString())}}else{_d.$1m.$6Q(this.get_$J1(),this);_js.Trace.logInfo(_a.$0.$l,"Updated baseline, context:"+this.toString())}}},$FQ:function(){if($5(this.get_$J1()))return!1;this.$J8.$s();return!this.get_$J1().$5S3(this)},$3z0:function(n){this.$30s.$s();var t=this.get_$19f();t=t?t.length>n?this.get_$19f().substr(0,n)+"...":t:"";return t},$1JK:function(n,t,i,r){this.set_$4Z(new _js.$c);var u=n?n.Mailbox:null;if(!_d.$S.$11D){var f=_g.$V.get_$I().get_$2z();_d.$S.$11D=_js.$8.$a(f.get_$eQ())?f.get_$AM()||"":f.get_$b6()||""}if(this.get_$5ea()||this.get_$3w()!==8&&(!r||!r.get_$C())&&u&&(2!==this.get_$3w()||!_d.$S.$1QU(u.EmailAddress))){this.get_$4Z().$D(u);_js.Trace.logInfo(_a.$0.$l,"Adding original From to To, Operation="+this.get_$3w()+"; From="+_g.$2R.$xr(n)+"; Self="+_d.$S.$11D)}if(this.get_$3w()===2||this.get_$3w()===8){_js.Trace.logInfo(_a.$0.$l,"Adding "+(t?t.get_$C():0)+" To recipients to To.");_d.$S.$5AS(t,this.get_$4Z(),u,null);_js.Trace.logInfo(_a.$0.$l,"Adding "+(i?i.get_$C():0)+" Cc recipients to Cc");this.set_$4l(new _js.$c);_d.$S.$5AS(i,this.get_$4l(),u,this.get_$4Z())}$4rO(this);if(r&&r.get_$C()>0)if(this.get_$3w()===1){this.get_$4Z().$1t();for(var e=0;e<r.get_$C();e++){var c=r.get_$3o(e);this.get_$4Z().$D(c)}}else if(this.get_$3w()===2)for(var o=0;o<r.get_$C();o++){var s=r.get_$3o(o);var l=this;if(this.get_$4Z().get_$C()===this.get_$4Z().$Dn(function(n){return _g.$2R.$4i(s,n)})){var a=this;var h=this.get_$4l().$Dn(function(n){return _g.$2R.$4i(s,n)});h!==this.get_$4l().get_$C()&&this.get_$4l().$6C(h);this.get_$4Z().$D(s)}}if(this.get_$3w()!==8&&u&&0===this.get_$4Z().get_$C()&&(!this.get_$4l()||0===this.get_$4l().get_$C())){this.get_$4Z().$D(u);_js.Trace.logInfo(_a.$0.$l,"Adding original From since there are no recipients left, From="+_g.$2R.$xr(n))}},toString:function(){var n="Id="+this.get_$7t()+"; Op="+this.get_$3w()+"; Mode="+this.get_$66()+"; Oid=";n+=this.get_$dv()?this.get_$dv().Id+":"+this.get_$dv().ChangeKey+";":this.$5Y&&this.$5Y.get_$i()?this.$5Y.get_$i().Id+":"+this.$5Y.get_$i().ChangeKey+";":"null;";n+=" Did=";n+=this.get_$9x()?this.get_$9x().Id+":"+this.get_$9x().ChangeKey+";":this.get_$Sn()&&this.get_$Sn().get_$i()?this.get_$Sn().get_$i().Id+":"+this.get_$Sn().get_$i().ChangeKey+";":"null;";n+=" Subject="+this.get_$2i()+"; RawContentLength="+(_js.$8.$a(this.get_$Nu())?"0":this.get_$Nu().length.toString())+"; ContentLength="+(_js.$8.$a(this.get_$DF())?"0":this.get_$DF().length.toString())+"; TextEditorContentLength="+(_js.$8.$a(this.get_$19f())?"0":this.get_$19f().length.toString())+"; BodyType="+this.get_$3s()+";";var t;_d.$S.$4AZ("To",this.get_$4Z(),this.get_$cA(),t={val:n});n=t.val;var i;_d.$S.$4AZ("Cc",this.get_$4l(),this.get_$a8(),i={val:n});n=i.val;var r;_d.$S.$4AZ("Bcc",this.get_$6I(),this.get_$Vj(),r={val:n});n=r.val;n+=" AutoSig="+this.get_$NA()+"; Imp="+this.get_$6Y()+"; QuotedBodyLength="+(_js.$8.$a(this.get_$1IG())?"0":this.get_$1IG().length.toString())+"; IsComplete="+this.get_$as()+"; IsMeeting="+this.get_$WK()+"; IsMeetingForward="+this.get_$1ET()+"; IsReplyBcc="+this.get_$2Ss()+"; HasLocation="+this.get_$1yC()+"; MeetingTime="+(this.get_$16G()?this.get_$16G().get_$JF()+":"+(this.get_$16G().get_$y()?this.get_$16G().get_$y().$9L():"null")+":"+(this.get_$16G().get_$20()?this.get_$16G().get_$20().$9L():"null"):"null")+"; From="+_g.$2R.$xr(this.get_$3U())+"; Sender="+_g.$2R.$xr(this.get_$8m())+"; IsFromShown="+this.get_$Uf()+"; IsBccShown="+this.get_$nW()+"; AttachmentCount="+(this.get_$8j()?this.get_$8j().get_$C().toString():"0")+"; UpgradeFailed="+this.get_$1KQ()+"; HasBaseline="+(!!this.get_$J1()).toString()+"; HasInitBaseline="+(!!this.$WE).toString()+"; UserSaved="+this.get_$rd()+"; IsReplyForward="+this.get_$nj()+"; HasDraft="+(!!this.get_$Sn()).toString()+"; HasRMLD="+(!!this.get_$5r()).toString()+"; Classified="+this.get_$LW()+"; Class="+this.get_$R9()+"; Sensitivity="+this.get_$8F()+"; DeliveryReceipt="+this.get_$Gi()+"; ReadReceipt="+this.get_$G8()+"; SmimeEncryptMessage="+this.get_$Fk()+"; SmimeSignMessage="+this.get_$I8()+"; ConversationId="+(this.get_$3S()?this.get_$3S().Id+":"+this.get_$3S().ChangeKey:"null")+" ParentConversationNodeId="+this.get_$28O()+"; IsOriCalId="+this.get_$15W()+"; OccurrenceRefMaster="+this.get_$s8()+"; IsLoadedDraft="+this.get_$1EQ()+"; IsMovedToDraftFromOutbox="+this.get_$2SX()+"; IsUpgraded="+this.get_$Eb()+"; IsCached="+this.$8J9+";";return n},$AG:function(){_js.Trace.logInfo(_a.$0.$l,"Context reset start.");this.set_$7t(null);this.get_$3w()&&this.set_$3w(0);this.get_$66()&&this.set_$66(0);this.get_$dv()&&this.set_$dv(null);this.get_$Ch()&&this.set_$Ch(null);this.get_$9x()&&this.set_$9x(null);_js.$8.$a(this.get_$2i())||this.set_$2i(null);_js.$8.$a(this.get_$Nu())||this.set_$Nu("");_js.$8.$a(this.get_$DF())||this.set_$DF("");_js.$8.$a(this.get_$19f())||this.set_$19f("");this.get_$4Z()&&this.set_$4Z(null);_js.$8.$a(this.get_$cA())||this.set_$cA(null);this.get_$4l()&&this.set_$4l(null);_js.$8.$a(this.get_$a8())||this.set_$a8(null);this.get_$6I()&&this.set_$6I(null);_js.$8.$a(this.get_$Vj())||this.set_$Vj(null);this.get_$NA()||this.set_$NA(!0);this.get_$6Y()!=="Normal"&&this.set_$6Y("Normal");_js.$8.$a(this.get_$1IG())||this.set_$1IG(null);this.get_$as()&&this.set_$as(!1);this.get_$WK()&&this.set_$WK(!1);this.get_$1ET()&&this.set_$1ET(!1);this.get_$2Ss()&&this.set_$2Ss(!1);this.get_$4g()&&this.set_$4g(null);this.get_$1yC()&&this.set_$1yC(!1);this.get_$16G()&&this.set_$16G(null);this.get_$3U()&&this.set_$3U(null);this.get_$8m()&&this.set_$8m(null);this.get_$Eb()&&this.set_$Eb(!1);this.get_$Uf()&&this.set_$Uf(!1);this.get_$nW()&&this.set_$nW(!1);this.get_$8j()&&this.set_$8j(null);this.get_$1KQ()&&this.set_$1KQ(!1);this.get_$J1()&&this.set_$J1(null);this.get_$rd()&&this.set_$rd(!1);this.get_$nj()&&this.set_$nj(!1);this.get_$Sn()&&this.set_$Sn(null);this.get_$5r()&&this.set_$5r(null);_js.$8.$a(this.get_$Ps())||this.set_$Ps(null);this.get_$LW()&&this.set_$LW(!1);_js.$8.$a(this.get_$UE())||this.set_$UE(null);_js.$8.$a(this.get_$R9())||this.set_$R9(null);_js.$8.$a(this.get_$Pq())||this.set_$Pq(null);this.get_$1Md()&&this.set_$1Md(!1);this.get_$8F()!=="Normal"&&this.set_$8F("Normal");this.get_$Gi()&&this.set_$Gi(!1);this.get_$G8()&&this.set_$G8(!1);this.get_$Fk()&&this.set_$Fk(!1);this.get_$I8()&&this.set_$I8(!1);this.get_$3Tt()&&this.set_$3Tt(null);this.get_$3S()&&this.set_$3S(null);_js.$8.$a(this.get_$28O())||this.set_$28O(null);this.get_$15W()&&this.set_$15W(!1);this.get_$s8()&&this.set_$s8(!1);this.get_$1EQ()&&this.set_$1EQ(!1);this.get_$2SX()&&this.set_$2SX(!1);this.get_$UP()&&this.set_$UP(null);_js.Trace.logInfo(_a.$0.$l,"Context reset end.")},$47G:function(){return!!this.get_$Ch().get_$5r()&&0===this.get_$Ch().get_$5r().get_$HX()&&!this.get_$Ch().get_$5r().get_$3tJ()&&!this.get_$Ch().get_$5r().get_$2y7()},$303:function(){var n=null;if(this.get_$3U()&&this.get_$3U().Mailbox&&!_js.$8.$a(this.get_$3U().Mailbox.EmailAddress))n=this.get_$3U().Mailbox;else if(this.get_$8m()&&this.get_$8m().Mailbox&&!_js.$8.$a(this.get_$8m().Mailbox.EmailAddress))n=this.get_$8m().Mailbox;else if(!_js.$8.$a(_d.$S.$11D)){n=new _g.$1q;n.EmailAddress=_d.$S.$11D;n.MailboxType="Mailbox";n.RoutingType="SMTP"}return n},$47h:function(){if(!_a.$j.$2v)return!1;switch(this.get_$3w()){case 0:case 1:case 2:case 3:case 4:break;default:return!1}return this.get_$Sn()&&!$4rS(this,this.get_$Sn())?!1:this.get_$Ch()&&!$4rS(this,this.get_$Ch())?!1:!0},$ADs:function(n){_js.Trace.logInfo(_a.$0.$3i,"Updating S/MIME options...");if(_a.$j.$2v)switch(n){case 6:this.set_$Fk(!0);this.set_$I8(!1);break;case 10:case 11:this.set_$Fk(!1);this.set_$I8(!0);break;case 12:case 13:case 14:this.set_$Fk(!0);this.set_$I8(!0);break;case-1:case 0:default:this.set_$Fk(!1);this.set_$I8(!1);break}},$AEC:function(n){_js.Trace.logInfo(_a.$0.$3i,"Upgrading S/MIME options...");if(_a.$j.$2v)switch(n){case 6:this.set_$Fk(!0);break;case 10:case 11:this.set_$I8(!0);break;case 12:case 13:case 14:this.set_$Fk(!0);this.set_$I8(!0);break;case-1:case 0:default:break}},$30l:function(n,t){var i=this.get_$3Tt();if(!i||!i.length)return null;$5(n)&&(n=0);$5(t)&&(t=i.length);for(var r=new(_0365f.$n.$$(String)),u=n;u<n+t;u++){var f=i[u];if(f&&f.length)for(var l=f,v=l.length,e=0;e<v;++e){var o=l[e];_js.$8.$a(o)||r.$76(o)||r.$D(o)}}if(n+t<i.length){var s=i[i.length-1];if(s&&s.length>0)for(var a=s,y=a.length,h=0;h<y;++h){var c=a[h];_js.$8.$a(c)||r.$76(c)||r.$D(c)}}return r.get_$C()>0?r.get_$3O():null},$7yO:function(n,t){$3(this,"ShowMeetingReadonlyFields")}};_d.$ra=function(n){this.$19K={};this.$Ve=n};_d.$ra.prototype={$Ve:null,$jI:function(n){return n in this.$19K},$6dG:function(n,t){if(n in this.$19K){var i=this.$19K[n];!i.$4bH&&t&&(this.$19K[n]=new _d.$sd(t))}else this.$19K[n]=new _d.$sd(t)},$5Pw:function(n,t){var u=n.$g;var i=u.$d;var r=i.get_$7t();var o=i.get_$9x();var f=!1;if(i.get_$1EQ())_js.Trace.logInfo(_a.$0.$l,"Not discarding a loaded draft for context "+r);else if(i.get_$rd())_js.Trace.logInfo(_a.$0.$l,"Not discarding an explicitly saved draft for context "+r);else if(u.get_$ui().$yO)_js.Trace.logInfo(_a.$0.$l,"Not discarding a draft currently being explicitly saved for context "+r);else if(u.get_$1JF().$Lc)_js.Trace.logInfo(_a.$0.$l,"Not discarding a draft currently being sent for context "+r);else{var e=!1;if(t)_js.Trace.logInfo(_a.$0.$l,"Skipping dirty check for context "+r);else{_js.Trace.logInfo(_a.$0.$l,"Checking dirty for determining whether to discard unused message on navigate away. Context:"+i.toString());e=u.$FQ()}if(e)_js.Trace.logInfo(_a.$0.$l,"Not discarding a dirty draft for context "+r);else if(i.$WE)if(i.$WE.$4i(i.get_$J1())){if(_g.$1Y.$N2&&i.get_$nj()&&!i.get_$9x()){_js.Trace.logInfo(_a.$0.$l,"Calling main window to remember the pending discard for context "+r);_g.$1Y.$N2.$6dG(r,!i.get_$rd());f=!0}else if(!i.get_$jh()){_js.Trace.logInfo(_a.$0.$l,"Discarding unused draft for context "+r);this.$3sM(r,o,u.$k,i.get_$rd());f=!0}}else _js.Trace.logInfo(_a.$0.$l,"Not discarding a draft different from the initial baseline for context "+r);else _js.Trace.logInfo(_a.$0.$l,"Not discarding without an initial baseline for context "+r)}return f},$3sM:function(n,t,i,r){i||(i=new _d.$B6(new _y.$4p));var u;if(this.$19K[n]){var f=this.$19K[n];u=f.$4bH}else u=!r;if(t){var e=this.$Ve.$7lF(t,u);i.$pZ(e,null,null,null);delete this.$19K[n];_js.Trace.logInfo(_a.$0.$l,"Delete action submitted, ID={0}, Changekey={1}, isHardDelete={2}",t.Id,t.ChangeKey,u)}else{this.$19K[n]=new _d.$sd(u);_js.Trace.logInfo(_a.$0.$l,"Discard pending because we do not have the draft ID yet. ContextId="+n+"; Hard="+u)}},$7sQ:function(n,t){this.$3sM(n,t,new _d.$B6(new _y.$4p),!1)}};_d.$1m=function(){_d.$1m.initializeBase(this)};_d.$1m.$$cctor=function(){_d.$1m.$1Wy.set_$HL(_d.$1m.$2xG);_d.$1m.$1MU.set_$HL(_d.$1m.$2xG);_d.$1m.$1M6.set_$HL(_d.$1m.$2xG)};_d.$1m.$1tF=function(n){var t=new _d.$1m;_d.$1m.$6Q(t,n);return t};_d.$1m.$6Q=function(n,t){n.set_$2i(t.get_$2i());n.set_$DF(t.get_$DF());if(t.get_$4Z()){n.set_$4Z(new _js.$c);n.get_$4Z().$6S(t.get_$4Z().$6W())}else n.set_$4Z(null);n.set_$cA(t.get_$cA());if(t.get_$4l()){n.set_$4l(new _js.$c);n.get_$4l().$6S(t.get_$4l().$6W())}else n.set_$4l(null);n.set_$a8(t.get_$a8());if(t.get_$6I()){n.set_$6I(new _js.$c);n.get_$6I().$6S(t.get_$6I().$6W())}else n.set_$6I(null);if(t.get_$8j()){n.set_$8j(new _js.$c);n.get_$8j().$6S(t.get_$8j().$6W())}else n.set_$8j(null);if(t.get_$UP()){n.set_$UP(new _js.$c);n.get_$UP().$6S(t.get_$UP().$6W())}else n.set_$UP(null);n.set_$Vj(t.get_$Vj());n.set_$6Y(t.get_$6Y());n.set_$3U(t.get_$3U());n.set_$Ps(t.get_$Ps());n.set_$8F(t.get_$8F());n.set_$Gi(t.get_$Gi());n.set_$G8(t.get_$G8());n.set_$Fk(t.get_$Fk());n.set_$I8(t.get_$I8())};_d.$1m.$1rs=function(n,t,i,r){if(i!==r&&!(_js.$8.$a(i)&&_js.$8.$a(r))||!_d.$1m.$5QG(n,t))return!1;if($5(n)||$5(t))return!0;for(var u=0;u<n.get_$C();u++){var f=n.get_$3o(u);var e=t.get_$3o(u);if(!_d.$1m.$3ia(f,e))return!1}return!0};_d.$1m.$3ia=function(n,t){return $5(n)&&!$5(t)||$5(t)&&!$5(n)?!1:$5(n)&&$5(t)?!0:_g.$2R.$4i(n,t)};_d.$1m.$5QG=function(n,t){var i=_d.$1m.$5Wr(n);var r=_d.$1m.$5Wr(t);return i===r};_d.$1m.$5Wr=function(n){return $5(n)?0:n.get_$C()};_d.$1m.$5CO=function(n,t){if(!_d.$1m.$5QG(n,t))return!1;if(!n||!t)return!0;for(var i=0;i<n.get_$C();i++){var r=n.get_$3o(i);var u=t.get_$3o(i);if(!_d.$1m.$7b9(r,u))return!1}return!0};_d.$1m.$7b7=function(n,t){return _h.$X5.$5CQ(n,t)};_d.$1m.$7b9=function(n,t){return!n&&t||!t&&n?!1:!n&&!t?!0:!n.get_$3l()&&t.get_$3l()||!t.get_$3l()&&n.get_$3l()?!1:n.get_$3l()&&n.get_$3l().Id!==t.get_$3l().Id?!1:n.get_$1N()!==t.get_$1N()?!1:n.get_$Bw()!==t.get_$Bw()?!1:n.get_$H7()!==t.get_$H7()?!1:n.get_$2tI()!==t.get_$2tI()?!1:n.get_$50()!==t.get_$50()?!1:!n.get_$Bh()&&t.get_$Bh()||!t.get_$Bh()&&n.get_$Bh()?!1:n.get_$Bh()&&!n.get_$Bh().$4i(t.get_$Bh())?!1:n.get_$6K()!==t.get_$6K()?!1:!0};_d.$1m.prototype={get_$2i:function(){return this.$W(_d.$1m.$Zd)},set_$2i:function(n){this.$M(_d.$1m.$Zd,n);return n},get_$DF:function(){return this.$W(_d.$1m.$1vj)},set_$DF:function(n){this.$M(_d.$1m.$1vj,n);return n},get_$4Z:function(){return this.$W(_d.$1m.$1Wy)},set_$4Z:function(n){this.$M(_d.$1m.$1Wy,n);return n},get_$cA:function(){return this.$W(_d.$1m.$2Dp)},set_$cA:function(n){this.$M(_d.$1m.$2Dp,n);return n},get_$4l:function(){return this.$W(_d.$1m.$1MU)},set_$4l:function(n){this.$M(_d.$1m.$1MU,n);return n},get_$a8:function(){return this.$W(_d.$1m.$1tJ)},set_$a8:function(n){this.$M(_d.$1m.$1tJ,n);return n},get_$6I:function(){return this.$W(_d.$1m.$1M6)},set_$6I:function(n){this.$M(_d.$1m.$1M6,n);return n},get_$Vj:function(){return this.$W(_d.$1m.$1sQ)},set_$Vj:function(n){this.$M(_d.$1m.$1sQ,n);return n},get_$6Y:function(){return this.$W(_d.$1m.$1yp)},set_$6Y:function(n){this.$M(_d.$1m.$1yp,n);return n},get_$3U:function(){return this.$W(_d.$1m.$1x4)},set_$3U:function(n){this.$M(_d.$1m.$1x4,n);return n},get_$Ps:function(){return this.$W(_d.$1m.$1tg)},set_$Ps:function(n){this.$M(_d.$1m.$1tg,n);return n},get_$8F:function(){return this.$W(_d.$1m.$2BH)},set_$8F:function(n){this.$M(_d.$1m.$2BH,n);return n},get_$Gi:function(){return this.$W(_d.$1m.$1zo)},set_$Gi:function(n){this.$M(_d.$1m.$1zo,n);return n},get_$G8:function(){return this.$W(_d.$1m.$215)},set_$G8:function(n){this.$M(_d.$1m.$215,n);return n},get_$Fk:function(){return this.$W(_d.$1m.$2CV)},set_$Fk:function(n){this.$M(_d.$1m.$2CV,n);return n},get_$I8:function(){return this.$W(_d.$1m.$2CW)},set_$I8:function(n){this.$M(_d.$1m.$2CW,n);return n},get_$8j:function(){return this.$W(_d.$1m.$1Yo)},set_$8j:function(n){this.$M(_d.$1m.$1Yo,n);return n},get_$UP:function(){return this.$W(_d.$1m.$1c4)},set_$UP:function(n){this.$M(_d.$1m.$1c4,n);return n},$5S3:function(n){if(this.get_$6Y()!==n.get_$6Y()){_js.Trace.logInfo(_a.$0.$l,"Dirty due to importance: snapshotImportance={0}, contextImportance={1}",this.get_$6Y(),n.get_$6Y());return!1}if(this.get_$2i()!==n.get_$2i()){_js.Trace.logInfo(_a.$0.$l,"Dirty due to subject: snapshotSubjectLength={0}, contextSubjectLength={1}",$5(this.get_$2i())?0:this.get_$2i().length,$5(n.get_$2i())?0:n.get_$2i().length);return!1}if(this.get_$Ps()!==n.get_$Ps()){_js.Trace.logInfo(_a.$0.$l,"Dirty due to compliance ID: snapshotId={0}, contextId={1}",this.get_$Ps(),n.get_$Ps());return!1}if(this.get_$8F()!==n.get_$8F()){_js.Trace.logInfo(_a.$0.$l,"Dirty due to sensitivity: snapshot={0}, context={1}",this.get_$8F(),n.get_$8F());return!1}if(this.get_$Gi()!==n.get_$Gi()){_js.Trace.logInfo(_a.$0.$l,"Dirty due to IsDeliveryReceiptRequested: snapshot={0}, context={1}",this.get_$Gi(),n.get_$Gi());return!1}if(this.get_$G8()!==n.get_$G8()){_js.Trace.logInfo(_a.$0.$l,"Dirty due to IsReadReceiptRequested: snapshot={0}, context={1}",this.get_$G8(),n.get_$G8());return!1}if(this.get_$Fk()!==n.get_$Fk()){_js.Trace.logInfo(_a.$0.$l,"Dirty due to SmimeEncryptMessage: snapshot={0}, context={1}",this.get_$Fk(),n.get_$Fk());return!1}if(this.get_$I8()!==n.get_$I8()){_js.Trace.logInfo(_a.$0.$l,"Dirty due to SmimeSignMessage: snapshot={0}, context={1}",this.get_$I8(),n.get_$I8());return!1}var t=this.get_$3U()?this.get_$3U().Mailbox:null;var i=n.get_$3U()?n.get_$3U().Mailbox:null;if(!_d.$1m.$3ia(t,i)){_js.Trace.logInfo(_a.$0.$l,"Dirty due to From: snapshotFrom={0}, contextFrom={1}",t?t.EmailAddress:"null",i?i.EmailAddress:"null");return!1}if(!_d.$1m.$1rs(this.get_$4Z(),n.get_$4Z(),this.get_$cA(),n.get_$cA())){_js.Trace.logInfo(_a.$0.$l,"Dirty due to To: snapshotToCout={0}, contextToCout={1}, snapshotQueryStringLength={2}, contextQueryStringLength={3}",$5(this.get_$4Z())?0:this.get_$4Z().get_$C(),$5(n.get_$4Z())?0:n.get_$4Z().get_$C(),$5(this.get_$cA())?0:this.get_$cA().length,$5(n.get_$cA())?0:n.get_$cA().length);return!1}if(!_d.$1m.$1rs(this.get_$4l(),n.get_$4l(),this.get_$a8(),n.get_$a8())){_js.Trace.logInfo(_a.$0.$l,"Dirty due to To: snapshotCcCout={0}, contextCcCout={1}, snapshotQueryStringLength={2}, contextQueryStringLength={3}",$5(this.get_$4l())?0:this.get_$4l().get_$C(),$5(n.get_$4l())?0:n.get_$4l().get_$C(),$5(this.get_$a8())?0:this.get_$a8().length,$5(n.get_$a8())?0:n.get_$a8().length);return!1}if(!_d.$1m.$1rs(this.get_$6I(),n.get_$6I(),this.get_$Vj(),n.get_$Vj())){_js.Trace.logInfo(_a.$0.$l,"Dirty due to To: snapshotBccCout={0}, contextBccCout={1}, snapshotQueryStringLength={2}, contextQueryStringLength={3}",$5(this.get_$6I())?0:this.get_$6I().get_$C(),$5(n.get_$6I())?0:n.get_$6I().get_$C(),$5(this.get_$Vj())?0:this.get_$Vj().length,$5(n.get_$Vj())?0:n.get_$Vj().length);return!1}if(!_d.$1m.$5CO(this.get_$8j(),n.get_$8j())){_js.Trace.logInfo(_a.$0.$l,"snapshotAttachmentCount="+(this.get_$8j()?this.get_$8j().get_$C():0)+", contextAttachmentCount="+(n.get_$8j()?n.get_$8j().get_$C():0));return!1}if(!_d.$1m.$7b7(this.get_$UP(),n.get_$UP())){_js.Trace.logInfo(_a.$0.$l,"snapshotExtendedPropertyCount="+(this.get_$UP()?this.get_$UP().get_$C():0)+", contextExtendedPropertyCount="+(n.get_$UP()?n.get_$UP().get_$C():0));return!1}if(this.get_$DF()!==n.get_$DF()){_js.Trace.logInfo(_a.$0.$l,"Dirty due to editor content: snapshotContentLength={0}, contextContentLength={1}",$5(this.get_$DF())?0:this.get_$DF().length,$5(n.get_$DF())?0:n.get_$DF().length);return!1}_js.Trace.logInfo(_a.$0.$l,"Context is clean");return!0},$4i:function(n){if(!n){_js.Trace.logInfo(_a.$0.$l,"Comparing with a null snapshot, this case is always considered equal.");return!0}if(this.get_$6Y()!==n.get_$6Y()){_js.Trace.logInfo(_a.$0.$l,"sourceImportance={0}, targetImportance={1}",this.get_$6Y(),n.get_$6Y());return!1}if(this.get_$2i()!==n.get_$2i()){_js.Trace.logInfo(_a.$0.$l,"sourceSubject={0}, targetSubject={1}",this.get_$2i(),n.get_$2i());return!1}if(this.get_$Ps()!==n.get_$Ps()){_js.Trace.logInfo(_a.$0.$l,"sourceComplianceId={0}, targetComplianceId={1}",this.get_$Ps(),n.get_$Ps());return!1}if(this.get_$8F()!==n.get_$8F()){_js.Trace.logInfo(_a.$0.$l,"sourceSensitivity={0}, targetSensitivity={1}",this.get_$8F(),n.get_$8F());return!1}if(this.get_$Gi()!==n.get_$Gi()){_js.Trace.logInfo(_a.$0.$l,"sourceIsDeliveryReceiptRequested={0}, targetIsDeliveryReceiptRequested={1}",this.get_$Gi(),n.get_$Gi());return!1}if(this.get_$G8()!==n.get_$G8()){_js.Trace.logInfo(_a.$0.$l,"sourceIsReadReceiptRequested={0}, targetIsReadReceiptRequested={1}",this.get_$G8(),n.get_$G8());return!1}var t=this.get_$3U()?this.get_$3U().Mailbox:null;var i=n.get_$3U()?n.get_$3U().Mailbox:null;if(!_d.$1m.$3ia(t,i)){_js.Trace.logInfo(_a.$0.$l,"sourceFrom={0}, targetFrom={1}",t?t.EmailAddress:"null",i?i.EmailAddress:"null");return!1}if(!_d.$1m.$1rs(this.get_$4Z(),n.get_$4Z(),this.get_$cA(),n.get_$cA())){_js.Trace.logInfo(_a.$0.$l,"sourceToCout={0}, targetToCout={1}, sourceQueryString={2}, targetQueryString={3}",this.get_$4Z()?this.get_$4Z().get_$C():0,n.get_$4Z()?n.get_$4Z().get_$C():0,this.get_$cA(),n.get_$cA());return!1}if(!_d.$1m.$1rs(this.get_$4l(),n.get_$4l(),this.get_$a8(),n.get_$a8())){_js.Trace.logInfo(_a.$0.$l,"sourceCcCout={0}, targetCcCout={1}, sourceQueryString={2}, targetQueryString={3}",this.get_$4l()?this.get_$4l().get_$C():0,n.get_$4l()?n.get_$4l().get_$C():0,this.get_$a8(),n.get_$a8());return!1}if(!_d.$1m.$1rs(this.get_$6I(),n.get_$6I(),this.get_$Vj(),n.get_$Vj())){_js.Trace.logInfo(_a.$0.$l,"sourceBccCout={0}, targetBccCout={1}, sourceQueryString={2}, targetQueryString={3}",this.get_$6I()?this.get_$6I().get_$C():0,n.get_$6I()?n.get_$6I().get_$C():0,this.get_$Vj(),n.get_$Vj());return!1}if(!_d.$1m.$5CO(this.get_$8j(),n.get_$8j())){_js.Trace.logInfo(_a.$0.$l,"sourceAttachmentCount="+(this.get_$8j()?this.get_$8j().get_$C():0)+", targetAttachmentCount="+(n.get_$8j()?n.get_$8j().get_$C():0));return!1}if(this.get_$DF()!==n.get_$DF()){_js.Trace.logInfo(_a.$0.$l,"Dirty due to editor content: snapshotContentLength={0}, snapshotContentLength={1}",this.get_$DF()?this.get_$DF().length:0,n.get_$DF()?n.get_$DF().length:0);return!1}_js.Trace.logInfo(_a.$0.$l,"snapshot is clean");return!0}};_d.$1Ax=function(n,t){this.$$d_$7wY=Function.createDelegate(this,this.$7wY);if($5(n))throw Error.argumentNull("callback");if(t<=3e3)throw Error.argumentOutOfRange("timeoutPeriod");this.$2iA=t;this.$AR=n};_d.$1Ax.prototype={$2iA:0,$AR:null,$19g:null,$8Oc:!0,$y:function(){!this.$19g&&this.$8Oc&&(this.$19g=_js.$J.get_$I().$1s(_a.$0.$l,"MailComposeTimer",this.$$d_$7wY,this.$2iA))},$1t:function(){if(this.$19g){_js.Trace.logInfo(_a.$0.$l,"Clearing timer.");this.$19g=_js.$J.get_$I().$5A(this.$19g)}},$7wY:function(){_js.Trace.logInfo(_a.$0.$l,"Executing timer callback.");this.$1t();this.$AR()}};_d.$Ao=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g){_d.$Ao.resolveInheritance();this.apcl=this.$Y;this.rpcl=this.$q;_d.$Ao.initializeBase(this);_a.$3.$m(k,"nativeBridge");this.$1UM=4;this.$d=n;this.$1v=t||new _y.$4p;this.$x=this.$wz();this.$RQ=i;this.$7F=r;this.$1wv=u;this.$k=new _d.$B6(this.$1v);this.$1V3=f;this.$1TZ=s;this.$5q=e;this.$B=o;this.$HA=h;this.$hD=c;this.$J=l;this.$4U=v;this.$Ka=p;this.$E7=a;this.$2D=w;this.$aF=b;this.$1H=y;this.$c=k;this.$2jC=d;this.$Ve=g;_js.Trace.logInfo(_a.$0.$l,"ViewModel created")};_d.$Ao.$80b=function(){return(new Date).getTime()+":"+Math.random()};_d.$Ao.prototype={$RQ:null,$d:null,$7F:null,$1wv:null,$1V3:null,$5q:null,$1TZ:null,$1v:null,$B:null,$4U:null,$Ka:null,$HA:null,$J:null,$hD:null,$1H:null,$c:null,$2D:null,$2jC:null,$Ve:null,$aF:null,$1C:null,$k:null,$JA:null,$x:null,$2T1:!1,$T0:!1,$3SL:!1,$3Vy:null,$3Rw:!1,$jf:!1,$E7:null,$1UM:0,get_$g7:function(){return this.$x},set_$g7:function(n){if(this.$x!==n){this.$x=n;$3(this,"InfoBarViewModel")}return n},get_$1PR:function(){return this.$1C.$3c(0)},get_$3WD:function(){return this.$1C.$3c(11)},get_$26r:function(){return this.$1C.$3c(2)},get_$7ul:function(){return this.$1C.$3c(14)},get_$a0:function(){return this.$1C.$3c(5)},get_$A2R:function(){return this.$1C.$3c(12)},get_$7it:function(){return this.$1C.$3c(17)},get_$8U5:function(){return this.$1C.$3c(4)},get_$Kx:function(){return this.$1C.$3c(1)},get_$8Fd:function(){return this.$1C.$3c(6)},get_$1JF:function(){return this.$1C.$3c(7)},get_$ui:function(){return this.$1C.$3c(8)},get_$1z9:function(){return this.$1C.$3c(9)},get_$23S:function(){return this.$1C.$3c(10)},get_$1Bq:function(){return this.$1C.$3c(18)},get_$9ts:function(){return this.$1C.$3c(20)},get_$7iB:function(){return this.$1C.$3c(3)},get_$4Az:function(){return this.$1C.$3c(19)},get_$6Rp:function(){return this.$1C.$3c(25)},get_$5Pq:function(){return this.$1C.$3c(21)},get_$2Mz:function(){return this.$1C.$3c(24)},get_$8Qz:function(){return this.$1C.$3c(26)},get_$7uj:function(){return this.$1C.$3c(27)},get_$46q:function(){return!this.$B.get_$9l()},get_$8EY:function(){return this.get_$46q()||this.$B.get_$W5()},get_$1kp:function(){return this.$1UM},set_$1kp:function(n){if(this.$1UM!==n){this.$1UM=n;$3(this,"PopupPanelSize")}return n},get_$2PH:function(){return this.get_$3WD()?this.get_$3WD().$$d_$2PH:null},get_$7c:function(){return this.$JA},set_$7c:function(n){_js.Trace.logInfo(_a.$0.$l,"Shell setting ClosePopupCommand from "+(this.$JA?"non-null":"null")+" to "+(n?"non-null":"null"));this.$JA=n;return n},get_$7sU:function(){return!0},get_$44D:function(){return _a.UserAgent.getInstance().$1E7},get_$yf:function(){return _a.UserAgent.getInstance().$jW},get_$au:function(){return _a.UserAgent.getInstance().$Mi},get_$Nc:function(){return _a.UserAgent.getInstance().$9W},get_$KN:function(){return this.$B.get_$L()==="Mouse"?0:1},get_$47X:function(){return this.$2T1},set_$47X:function(n){this.$2T1=n;return n},get_$5jK:function(){return this.$T0},set_$5jK:function(n){if(this.$T0!==n){this.$T0=n;$3(this,"IsInView")}return n},get_$6ed:function(){return this.$3SL},set_$6ed:function(n){var t=this.get_$6eG();if(this.$3SL!==t){this.$3SL=t;$3(this,"ShouldShowToolbarMessage")}return n},get_$6kn:function(){return this.$3Vy},set_$6kn:function(n){if(this.$3Vy!==n){this.$3Vy=n;$3(this,"ToolbarMessage")}return n},get_$9ym:function(){return this.$3Rw},set_$9ym:function(n){var t=this.get_$6eG();if(t!==this.$3Rw){this.$3Rw=t;$3(this,"ShouldBlockView")}return n},get_$yW:function(){return this.$jf},set_$yW:function(n){if(this.$jf!==n){this.$jf=n;$3(this,"IsNavigatingAway")}return n},get_$6eG:function(){return this.get_$1z9()&&(this.get_$1z9().get_$2Sy()||this.get_$1z9().get_$37A())?!0:this.get_$1JF()&&this.get_$1JF().$Lc?!0:!1},get_$5QJ:function(){return!_a.$11.get_$7l()||_a.$11.get_$7l().toLowerCase()!=="pl-pl"},$41:function(){this.$d.get_$7t()&&this.$d.get_$1Ed()||this.$d.set_$7t(_d.$Ao.$80b());_js.Trace.logInfo(_a.$0.$l,"Init:Context:"+this.$d.toString());this.$1C||(this.$1C=new _d.$Pw(this,this.$E7,this.$4U,this.$1H,this.$Ka,this.$2D,this.$c));if(this.$x){this.$x.$AG();this.$d.get_$3Tr()!==0&&this.$x.$12F(new _a.$2N(this.$d.get_$3Tr()));this.$d.get_$QH()&&this.$6gP()}this.set_$yW(!1);this.$1C.$3c(0).$41()},$9up:function(n){this.set_$6k(n);_js.Trace.logInfo(_a.$0.$l,"Set screen view model appbar. ContextId="+this.$d.get_$7t())},$FZ:function(){_y.$1Mq.prototype.$FZ.call(this);var n=this.get_$1PR();if(n.get_$D2()){_js.Trace.logInfo(_a.$0.$l,"PostTransitionIn view model, begin 2nd init since view model is already initialized");n.$5Dx()}else _js.Trace.logInfo(_a.$0.$l,"PostTransitionIn view model, not initialized yet");this.set_$5jK(!0);_a.$6.acea(null,"VM.MailCompose.Navigate")},$TZ:function(){_js.Trace.logInfo(_a.$0.$l,"Post transition out, context:"+this.$d.toString());if(this.$1C){var t=this.get_$26r();if(t){var n=t.get_$4h();if(n&&n.get_$36H()){this.$1C.$AG();this.$d&&this.$d.$AG();this.$x&&this.$x.$9y.$1t();this.get_$2Mz()&&this.get_$2Mz().$6l.$1yP(!1);n.set_$36H(!1)}else _js.Trace.logInfo(_a.$0.$l,"Conductor is either null or not navigating away from compose, skipping post transition out processing")}else _js.Trace.logInfo(_a.$0.$l,"Navigation component was null, skipping post transition out processing")}else _js.Trace.logInfo(_a.$0.$l,"Skipping post transition out processing since this instance is already reset and the component map is empty");this.$2T1=!1;this.set_$5jK(!1);_y.$1Mq.prototype.$TZ.call(this)},$FQ:function(){var n=this.$1C.$3c(5);if(n.get_$Bz()){_js.Trace.logInfo(_a.$0.$l,"Dirty due to attachment in progress");return!0}var t=this.$1C.$3c(1);t.$2j0();return this.$d.$FQ()},$wz:function(){$5(this.$x)&&this.set_$g7(new _y.$5u);return this.$x},$9gB:function(){_h.$4a.$9g9()},$9qQ:function(){_h.$4a.$6Xv()},$6gP:function(){var n=_a.$j.$18D(!0,!0,this.$d.get_$3w()===1||this.$d.get_$3w()===2||this.$d.get_$3w()===3,this.$d.get_$3w()===3,!!this.$d.get_$Ch()&&(this.$d.get_$Ch().get_$15g()||this.$d.get_$Ch().get_$37T()));n&&this.$x.$12F(n)},$49:function(){_js.Trace.logInfo(_a.$0.$l,"Disposing view model, context: "+(this.$d?this.$d.toString():"null"));if(this.$1C){this.$1C.$AG();this.$1C=null}_a.$1.prototype.$49.call(this)}};_d.$AU=function(n,t,i,r,u){this.$$d_$85N=Function.createDelegate(this,this.$85N);this.$$d_$3pU=Function.createDelegate(this,this.$3pU);this.$$d_$7nk=Function.createDelegate(this,this.$7nk);_d.$AU.initializeBase(this);this.$5IT=u;this.$5Y=u.$5Y;this.$2D=n;this.$b=t;this.$39=u.$39;this.$7A=i;this.$Ve=r};function $2l7(n,t,i){n.$du=t;var f=t===1||t===2||t===3;var e=_a.$j.$2v&&n.$5Y.get_$G9()&&!n.$5Y.get_$IU()&&f;if(e){_js.Trace.logInfo(_a.$0.$3i,"Decoding S/MIME item before response...");var r=_a.$j.$18D(n.$5Y.get_$1PD(),!0,!0,t===3,n.$5Y.get_$15g()||n.$5Y.get_$37T());if(!r||_a.$2N.$15n(r)){var u=new _h.$GG(200,n.$5Y);var o=this;u.add_$21(function(){r=u.$1d});var s=this;u.add_$2t(function(){$3bJ(n,i,r)});OwaApplication.$1W.$11(u)}else $3bJ(n,i,r)}else $3bJ(n,i,null)}function $3bJ(n,t,i){var e=_g.$2o.isInstanceOfType(n.$5Y);t||(t=!_y.$x.$w.get_$9l());var r=n.$7A.$Fx(t,!1);t&&r.set_$66(0);if(i){_js.Trace.logInfo(_a.$0.$3i,"An error occurred when decoding the S/MIME item before response: "+i.message);r.set_$3Tr(i.SmimeException.$co)}var u=null;switch(n.$du){case 1:u=!r.get_$66()||e?"MailComposeReplyPopOut":"MailComposeReply";break;case 2:u=!r.get_$66()||e?"MailComposeReplyAllPopOut":"MailComposeReplyAll";break;case 3:u=!r.get_$66()||e?"MailComposeForwardPopOut":"MailComposeForward";break;case 12:u="MailComposePostReply";break;default:break}u&&r.set_$Qd(_y.$2V.$1X(_a.$0.$IY,u,!0));r.set_$1kL(n.$5Y.get_$28());n.$39&&r.set_$op(n.$39.get_$op());r.set_$3w(n.$du);r.set_$NA(!0);r.set_$nj(!0);var f=new _g.$Bc;f.Mailbox=new _g.$1q;f.Mailbox.EmailAddress=n.$b.get_$2z().get_$AM();f.Mailbox.Name=n.$b.get_$2z().get_$Fn();f.Mailbox.MailboxType="Mailbox";f.Mailbox.RoutingType="SMTP";r.set_$8m(f);if(e){var o=n.$5Y;if(o.get_$yR())r.$yB(o);else{r.set_$15W(!0);r.set_$dv(n.$5Y.get_$i());r.set_$s8(_g.$2o.$s8(o))}}else r.$yB(n.$5Y);if(_g.$81.isInstanceOfType(n.$5Y)){var s=_a.$j.get_$yb();s&&r.$AEC(n.$5Y.get_$1ta());n.$5Y.get_$IU()||r.get_$QH()&&s?$73Y(n,r):n.get_$4h().$TO(r)}else n.get_$4h().$TO(r)}function $73Y(n,t){_js.Trace.logInfo(_a.$0.$3i,"S/MIME context upgrading started.");if(n.$5Y.get_$IU()||n.$5Y.get_$JN())$4s5(n,t);else{_js.Trace.logInfo(_a.$0.$3i,"The original item's NormalizedBody is not available, fetch it now.");var i=new _h.$J8(200,[n.$5Y.get_$i()],_h.$v.get_$1Eq(),"ItemNormalizedBody",2,!1);var r=this;i.add_$21(function(){_js.Trace.logWarning(_a.$0.$3i,"The original item's NormalizedBody cannot be retrieved.");t.set_$3Tr(30)});var u=this;i.add_$2t(function(){$4s5(n,t)});OwaApplication.$1W.$11(i)}}function $4s5(n,t){var i=t.get_$3s()==="HTML";var r;if(n.$5Y.get_$VO())r=n.$5Y.get_$VO().get_$1n();else{var u=n.$5Y.get_$JN()||n.$5Y.get_$ME();if(u)r=i?u.get_$1n():$73a(n,u);else{_js.Trace.logError(_a.$0.$3i,"The body of original message is not available.");r=""}}i&&(r=_a.$3T.$9nm(r));var f=new _d.$Cc(i,n.$5Y,n.$du);t.set_$Nu($73Z(n,i,r,f.toString()));t.set_$NA(!1);_a.$j.$2v&&n.$5Y.get_$G9()?t.set_$8j($4s4(n,i,n.$5Y.get_$hX())):t.set_$8j($4s4(n,i,n.$5Y.get_$1P()));t.set_$Eb(!0);_js.Trace.logInfo(_a.$0.$3i,"S/MIME context upgrading completed.");n.get_$4h().$TO(t)}function $73a(n,t){var i=t.get_$1n();if(t.get_$3s()==="Text")return i;else{i=i.replace(new RegExp("\\r|\\n","g"),"");i=i.replace(new RegExp("<br[\\s\\S]*?>|</?\\s*p[\\s\\S]*?>","gim"),"\r\n");i=i.replace(new RegExp("<img[\\s\\S]*?>|<image[\\s\\S]*?>","gim"),"[X]");i=i.replace(new RegExp("<[\\s\\S]*?>","gm"),"");return i}}function $73Z(n,t,i,r){var e=n.$b.get_$13();var f=e.get_$wK()?(t?e.get_$3TZ():e.get_$11O())||"":"";if(t){r=_js.$8.$a(f)?"<p></p><p></p>"+r:"<p></p><p></p>"+f+"<p></p>"+r;var u=i.indexOf("<body");if(u<0)return r+i;else{while(u<i.length&&i.charAt(u++)!==">");i=i.substring(0,u)+r+i.substring(u,i.length);return i}}else{r=_js.$8.$a(f)?"\r\n"+r:"\r\n\r\n"+f.trim()+"\r\n"+r;return r+i}}function $4s4(n,t,i){if(!i||!i.get_$C())return null;if(n.$du===3){var r=new _js.$c;var f=this;i.$Bd(function(n){var t=n;t=t.$3g();r.$D(t)});return r.get_$C()>0?r:null}else if(n.$du===1||n.$du===2){var u=new _js.$c;var e=this;i.$Bd(function(n){if(_g.$5d.isInstanceOfType(n)&&n.get_$6K()&&t){var i=n;i=i.$3g();u.$D(i)}});return u.get_$C()>0?u:null}else return null}_d.$AU.prototype={$b:null,$2D:null,$5Y:null,$39:null,$5IT:null,$7A:null,$Ve:null,$3m:null,$du:0,get_$4h:function(){$5(this.$3m)&&(this.$3m=new _y.$CW);return this.$3m},set_$4h:function(n){this.$3m=n;return n},$1js:function(n){_a.$6.stPT(_a.$0.$IY,"MailComposeReply",3);this.$2D.$4h2("Inference.Reply",this.$5Y.get_$i(),this.$5Y.get_$3S(),this.$39?this.$39.get_$Dc():null);$2l7(this,1,n)},$1HW:function(n){_a.$6.stPT(_a.$0.$IY,"MailComposeReplyAll",3);this.$2D.$4h2("Inference.ReplyAll",this.$5Y.get_$i(),this.$5Y.get_$3S(),this.$39?this.$39.get_$Dc():null);$2l7(this,2,n)},$4Pw:function(n){_a.$6.stPT(_a.$0.$IY,"MailComposePostReply",3);this.$2D.$Tx("Inference.PostReply",this.$5Y.get_$i());$2l7(this,12,n)},$1jc:function(n){_a.$6.stPT(_a.$0.$IY,"MailComposeForward",3);this.$2D.$4h2("Inference.Forward",this.$5Y.get_$i(),this.$5Y.get_$3S(),this.$39?this.$39.get_$Dc():null);$2l7(this,3,n)},$6N2:function(){if(!this.$5IT.get_$2s2())throw Error.invalidOperation("OnSendAgain is invoked on an item that can't be sent again. ");var t=_g.$h.$1i.nameToId("drafts");var n=new _c.$154(this.$5Y.get_$i().Id,t.Id);n.add_$29(this.$$d_$7nk);n.add_$21(this.$$d_$3pU);OwaApplication.$1W.$11(n)},$7nk:function(n){var i=n.$1j1;if(i.length>0){var t=this.$Ve.$3op(_g.$1t.$2KF(i));t.add_$29(this.$$d_$85N);t.add_$21(this.$$d_$3pU);OwaApplication.$1W.$11(t)}else this.$3pU(n)},$3pU:function(n){this.$39.get_$g7().$5Z(9500);this.$39.get_$g7().$2j(9500)},$85N:function(n){var t=n;if(t.$Ge){this.$39.get_$g7().$5Z(9500);var i=this.$7A.$3oX(t.get_$i(),!1,t.$Ge.get_$gt(),t.$Ge.get_$5r());_y.$x.$w.get_$9l()||i.set_$66(0);this.get_$4h().$TO(i)}else this.$3pU(n)}};_d.$re=function(n,t,i,r){this.$2D=n;this.$b=t;this.$7A=i;this.$Ve=r};_d.$re.prototype={$2D:null,$b:null,$7A:null,$Ve:null,$8V:function(n){return new _d.$AU(this.$2D,this.$b,this.$7A,this.$Ve,n)}};_d.$lS=function(){_d.$lS.initializeBase(this)};_d.$lS.prototype={$1mk:null,$1mj:"Normal",$1zn:!1,$214:!1,$11P:!1,$11Q:!1,$3Tq:!1,$3Tu:!1,$3m:null,$3TM:!1,$4jg:!1,$4ja:!1,get_$9uR:function(){if($5(this.$1mk)){this.$1mk=new _js.$c;this.$1mk.$D("Normal");this.$1mk.$D("Personal");this.$1mk.$D("Private");this.$1mk.$D("Confidential")}return this.$1mk},get_$8F:function(){return this.$1mj},set_$8F:function(n){if(this.$1mj!==n){this.$1mj=n;$3(this,"Sensitivity")}return n},get_$Gi:function(){return this.$1zn},set_$Gi:function(n){if(this.$1zn!==n){this.$1zn=n;$3(this,"IsDeliveryReceiptRequested")}return n},get_$A0P:function(){return!OwaApplication.$jA},get_$G8:function(){return this.$214},set_$G8:function(n){if(this.$214!==n){this.$214=n;$3(this,"IsReadReceiptRequested")}return n},get_$A1f:function(){return!OwaApplication.$jA},get_$A1y:function(){return this.$3TM},set_$A1y:function(n){if(this.$3TM!==n){this.$3TM=n;$3(this,"ShowSmimeOptions")}return n},get_$Fk:function(){return this.$11P},set_$Fk:function(n){if(this.$11P!==n){this.$11P=n;$3(this,"SmimeEncryptMessage")}return n},get_$I8:function(){return this.$11Q},set_$I8:function(n){if(this.$11Q!==n){this.$11Q=n;$3(this,"SmimeSignMessage")}return n},get_$6hA:function(){return this.$3Tq},set_$6hA:function(n){if(this.$3Tq!==n){this.$3Tq=n;$3(this,"SmimeEncryptMessageIsEnabled")}return n},get_$6hB:function(){return this.$3Tu},set_$6hB:function(n){if(this.$3Tu!==n){this.$3Tu=n;$3(this,"SmimeSignMessageIsEnabled")}return n},get_$AFg:function(){return this.$4ja},set_$AFg:function(n){if(this.$4ja!==n){this.$4ja=n;$3(this,"WaitingForPreviousAction")}return n},get_$4h:function(){return this.$3m},set_$4h:function(n){if(this.$3m!==n){this.$3m=n;$3(this,"Conductor")}return n},$158:function(n){this.$4jg=n.get_$QH();this.set_$A1y(_a.$j.$2v&&_a.$j.get_$1zX()&&n.$47h());this.set_$AFg(!1);this.set_$8F(n.get_$8F());this.set_$Gi(n.get_$Gi());this.set_$G8(n.get_$G8());this.set_$Fk(n.get_$Fk());this.set_$I8(n.get_$I8());this.set_$6hA(n.get_$6hA());this.set_$6hB(n.get_$6hB())}};_d.$Cc=function(n,t,i){this.$45R=n;this.$h4=t;this.$du=i};function $4sv(n,t){if(!t||!t.get_$C())return null;var i=new(_0365f.$n.$$(String));var r=this;t.$Bd(function(t){i.$D($3be(n,t))});return i.$6W()}function $3be(n,t){return t?t.Name||t.OriginalDisplayName||t.EmailAddress||"":""}function $1Xg(n,t,i){return n.$45R?"<b>"+t+"</b> "+i:t+" "+i}_d.$Cc.prototype={$du:0,$h4:null,$45R:!1,toString:function(){_js.Trace.logInfo(_a.$0.$l,"Building message headers for reply/fwd. locally.");var r=this.$h4.get_$3U()?$3be(this,this.$h4.get_$3U().Mailbox):null;var u=this.$h4.get_$8m()?$3be(this,this.$h4.get_$8m().Mailbox):null;var o=this.$h4.get_$qv()||this.$h4.get_$13P();var l=(o?o.toString():this.$h4.get_$9lS())||null;var s=$4sv(this,this.$h4.get_$4Z());var h=$4sv(this,this.$h4.get_$4l());var t=null;var f=null;var e=null;if(this.$h4.get_$2i())t=this.$h4.get_$2i();else{var n;switch(this.$du){case 1:case 2:case 12:n=_u.Strings.l_ReplyPrefix_Text;break;case 3:n=_nbs.NonBootStrings.l_ForwardPrefix_Text;break;case 5:n=_nbs.NonBootStrings.l_AcceptPrefix_Text;break;case 6:n=_nbs.NonBootStrings.l_TentativelyAcceptPrefix_Text;break;case 7:n=_nbs.NonBootStrings.l_DeclinePrefix_Text;break;case 8:n=_nbs.NonBootStrings.l_CanceledMeetingMessagePrefix_Text;break;case 9:n=_nbs.NonBootStrings.l_ApprovePrefix_Text;break;case 10:n=_nbs.NonBootStrings.l_RejectPrefix_Text;break;default:n="";break}t=String.format(_nbs.NonBootStrings.l_SubjectFormat_Text,n,this.$h4.get_$oc()||_u.Strings.l_EmptySubjectMask_Text)}if(255<t.length){t=t.substr(0,255);_js.Trace.logInfo(_a.$0.$l,"Truncated subject from "+t+" to "+t+" to meet the "+255+" characters rule.")}if(_g.$Ro.isInstanceOfType(this.$h4)){var i=this.$h4;if(i.get_$41m()){var a=new _cc.$az;f=a.$2x(i.get_$41m(),null)}i.get_$Kh()&&i.get_$Kh().get_$4g()&&(e=i.get_$Kh().get_$4g().get_$1o())}u&&u.toLowerCase()!==r.toLowerCase()&&(r=String.format(_u.Strings.l_OnBehalfOf_Text,u,r));var v=$1Xg(this,_nbs.NonBootStrings.l_FromLabel_Text,r);var y=$1Xg(this,_nbs.NonBootStrings.l_SentLabel_Text,l);var p=s?$1Xg(this,_u.Strings.l_ToRecipientsLabel_Text,s.join("; ")):null;var w=h?$1Xg(this,_u.Strings.l_CcRecipientsLabel_Text,h.join("; ")):null;var b=$1Xg(this,_nbs.NonBootStrings.l_SubjectLabel_Text,t);var k=f?$1Xg(this,_ucmm.MeetingMsgStrings.l_WhenLabel_Text,f):null;var d=e?$1Xg(this,_ucmm.MeetingMsgStrings.l_WhereLabel_Text,e):null;var c=this.$7dW(v,y,p,w,b,k,d);return this.$45R?'<p style="border-top:1pt solid #E1E1E1;padding-top:3pt;margin-bottom:13pt;font-family:Calibri,sans-serif;font-size:11pt">'+c.join("<br/>")+"</p>":String.format("________________________________________{0}{1}{0}{0}","\r\n",c.join("\r\n"))},$7dW:function(){for(var i=[],n=0;n<arguments.length;++n)i[n]=arguments[n];for(var r=new(_0365f.$n.$$(String)),u=i,e=u.length,t=0;t<e;++t){var f=u[t];_js.$8.$a(f)||r.$D(f)}return r.$6W()}};_d.$1Mt=function(n,t,i,r,u){_d.$1Mt.initializeBase(this);this.$6Fc=n;this.$5TF=i;this.$5Ro=r;this.$6bj=_js.$8.$a(t)?_nbs.NonBootStrings.l_SubmessageSeparator_Text:t;this.$5dT=u};_d.$1Mt.prototype={$6Fc:null,$5TF:null,$5Ro:null,$6bj:null,$5dT:!1};_d.$YB=function(n,t,i){this.$2D=n;this.$gP=t;this.$1WQ=new _c.$Fn;this.$3mP=new(_a.$7z.$$(_c.$BT))(5);this.$2TH=i&&i.$3N("TopNSuggestions")?!0:!1};function $4r3(n,t,i,r,u,f){n.$1WQ.set_$9sh(u);var e=new _c.$BT(t,n.$1WQ,i,r,f,n.$gP,n.$2TH);n.$3mP.$D(e);return e}_d.$YB.prototype={$2D:null,$gP:null,$1WQ:null,$3mP:null,$2TH:!1,$8GE:function(n){return new _d.$r8(n)},$3pY:function(n,t,i){return $4r3(this,n,t,this.$2D,i,null)},$7ng:function(n,t,i,r){return $4r3(this,n,t,null,i,r)},$837:function(){for(var t=new(_0365f.$n.$$(_c.$4d)),i=this.$3mP.$6W(),r=i.length,n=0;n<r;++n){var u=i[n];t.$6S(u.$835())}return t.$6W()},$5M4:function(n,t){return new _d.$yS(n,t)}};_d.$r8=function(n){_d.$r8.initializeBase(this);this.$1Of=new _d.$VS;this.$1Of.$Y("SelectedRefiner",n);this.$1Wz=new _d.$VS;this.$1Wz.$Y("SelectedRefiner",n);this.$1OW=new _d.$VS;this.$1OW.$Y("SelectedRefiner",n);this.$1M0=new _d.$VS;this.$1M0.$Y("SelectedRefiner",n);this.$1Na=new _d.$VS;this.$1Na.$Y("SelectedRefiner",n)};_d.$r8.$7l7=function(){var n=new _js.$c;n.$D(_d.$r8.$Xn.$4Nu);n.$D(_d.$r8.$Xn.$4Nt);n.$D(_d.$r8.$Xn.$4Nv);return n};_d.$r8.prototype={$1Of:null,$1Wz:null,$1OW:null,$1M0:null,$1Na:null,$D0:null,$6Z:!1,get_$80K:function(){return this.$1Of},get_$9ll:function(){return this.$1Wz},get_$7zC:function(){return this.$1OW},get_$7bz:function(){return this.$1M0},get_$7pT:function(){return this.$1Na},get_$r:function(){return this.$6Z},set_$r:function(n){this.$6Z=n;$N(this,"IsHidden");return n},get_$7ow:function(){return this.$D0},set_$7ow:function(n){this.$D0=n;return n},$9wJ:function(n){for(var r=n,u=r.length,i=0;i<u;++i){var t=r[i];_js.Trace.logInfo(_a.$0.$Mf,"PropertyPath: {0} ",t.RefinerCategory,t.RefinerDataEntryTypes.length);switch(t.RefinerCategory){case 4:this.$1M0.$2fc(_d.$r8.$18U.$81d(t.RefinerDataEntryTypes));break;case 5:this.$1OW.$2fc(_d.$r8.$18U.$83y(this.$D0,t.RefinerDataEntryTypes));break;case 3:this.$1Of.$2fc(_d.$r8.$18U.$5Z9(t.RefinerDataEntryTypes));break;case 2:this.$1Wz.$2fc(_d.$r8.$18U.$5Z9(t.RefinerDataEntryTypes));break}}this.$1Na.$2fc(_d.$r8.$7l7());this.set_$r(!1)},$873:function(){var t=[];var n=null;if(this.$1M0.$eI){n=this.$1M0.$eI.$2dE;Array.add(t,n)}if(this.$1OW.$eI){n=this.$1OW.$eI.$2dE;Array.add(t,n)}if(this.$1Of.$eI){n=this.$1Of.$eI.$2dE;Array.add(t,n)}if(this.$1Wz.$eI){n=this.$1Wz.$eI.$2dE;Array.add(t,n)}if(t.length){var i=new _g.$g9;i.RefinerQueries=t;return i}else return null},$82r:function(){if(!this.$1Na.$eI)return null;var i=this.$1Na.$eI;var n=_a.$7.get_$2F();if(i===_d.$r8.$Xn.$4Nu)n=n.$2w(-7);else if(i===_d.$r8.$Xn.$4Nt)n=n.$IC(-1);else if(i===_d.$r8.$Xn.$4Nv)n=n.$i6(-1);else return null;var t=new _g.$YJ;t.Item=new _g.$1V("DateTimeReceived");t.FieldURIOrConstant=new _g.$J6;var r=new _g.$J0;r.Value=n.$9L();t.FieldURIOrConstant.Item=r;return new _g.$JS(t)},$6XE:function(){this.set_$r(!0);this.$1Of&&this.$1Of.$2dl();this.$1Wz&&this.$1Wz.$2dl();this.$1M0&&this.$1M0.$2dl();this.$1Na&&this.$1Na.$2dl();this.$1OW&&this.$1OW.$2dl()}};_d.$r8.$Xn=function(){};_d.$r8.$18U=function(){};_d.$r8.$18U.$83y=function(n,t){var i=new _js.$c;if(t.length<=1)return i;for(var e=0,o=t,s=o.length,r=0;r<s;++r){var u=o[r];if(e>=5)break;var f=null;n&&(f=n.$Q8(u.FolderId));if(f){i.$D(new _d.$ZC(f.get_$1o(),u.HitCount,u.RefinementQuery));e++}}return i};_d.$r8.$18U.$81d=function(n){var t=new _js.$c;if(n.length<=1)return t;for(var u=n,f=u.length,i=0;i<f;++i){var r=u[i];r.WithAttachments&&t.$D(new _d.$ZC(_nbs.NonBootStrings.l_AttachmentRefiner_Text,r.HitCount,r.RefinementQuery))}return t};_d.$r8.$18U.$5Z9=function(n){var i=new _js.$c;if(n.length<=1)return i;for(var f=0,u=n,e=u.length,r=0;r<e;++r){var t=u[r];if(f++>=5)break;var o=_d.$r8.$18U.$Vu(t.DisplayName,t.SmtpAddress);var s=new _d.$10B(o,t.HitCount,t.RefinementQuery);i.$D(s)}return i};_d.$r8.$18U.$Vu=function(n,t){var r=new _g.$1q;r.EmailAddress=t;var u=_h.$2G.$Dh(r);u.set_$1J(1);var i=new _y.$17(u,10,!1,1,null,null,_y.$x.$w);i.$KF(0,n,0);i.$KF(1,t,0);return i};_d.$yS=function(n,t){_d.$yS.initializeBase(this);this.$1nh=t;if(this.$1nh.$1nj.toLocaleUpperCase().startsWith(n.toLocaleUpperCase())){this.$4Ya=n;this.$4Yf=this.$1nh.$1nj.substr(n.length)}else{this.$4Ya="";this.$4Yf=this.$1nh.$1nj}};_d.$yS.prototype={$1nh:null,$4Ya:null,$4Yf:null,get_$2ea:function(){return this.$1nh.$1nj},get_$7D:function(){return this.$1nh.$1nj},get_$8Kx:function(){return this.$1nh.$CG===3}};_d.$10B=function(n,t,i){_d.$10B.initializeBase(this,[n.$18.get_$1o(),t,i]);this.$73=n};_d.$10B.prototype={$73:null};_d.$ZC=function(n,t,i){_d.$ZC.resolveInheritance();this.apcl=this.$Y;this.rpcl=this.$q;_d.$ZC.initializeBase(this);this.$13j=n;this.$6Gn=t;this.$2dE=i};_d.$ZC.prototype={$13j:null,$6Gn:0,$2dE:null};_d.$VS=function(){this.$$d_$A1F=Function.createDelegate(this,this.$A1F);this.$29g=new _js.$c;this.$2wZ=new _js.$c;_d.$VS.resolveInheritance();this.apcl=this.$Y;this.rpcl=this.$q;_d.$VS.initializeBase(this);this.$A1G=new _C(this.$$d_$A1F,_a.$0.$Ab)};_d.$VS.prototype={$eI:null,$A1G:null,$6fV:!1,get_$6fW:function(){return this.$6fV},set_$6fW:function(n){this.$6fV=n;$N(this,"ShowLoadMoreButton");return n},get_$9JZ:function(){return!this.$29g||!this.$29g.get_$C()},get_$6VH:function(){return this.$29g},set_$6VH:function(n){this.$29g=n;this.set_$3sR(n);$N(this,"NoRefinersAvailable");return n},get_$3sR:function(){return this.$2wZ},set_$3sR:function(n){this.$2wZ=n;this.$eI=null;$N(this,"DisplayedRefinerValues");return n},get_$9tN:function(){return this.$eI},set_$9tN:function(n){this.$eI=n;$N(this,"SelectedRefiner");return n},$2dl:function(){this.$eI=null;this.set_$6fW(!1);this.set_$3sR(new _js.$c);this.set_$6VH(new _js.$c)},$2fc:function(n){this.$eI||this.set_$6VH(n)},$A1F:function(){this.set_$3sR(this.$29g);this.set_$6fW(!1)}};_d.$Do=function(n,t,i,r,u,f,e,o){this.$$d_$9UT=Function.createDelegate(this,this.$9UT);this.$$d_$7hS=Function.createDelegate(this,this.$7hS);this.$$d_$9QC=Function.createDelegate(this,this.$9QC);this.$$d_$9QB=Function.createDelegate(this,this.$9QB);this.$$d_$9ZH=Function.createDelegate(this,this.$9ZH);this.$$d_$9Lo=Function.createDelegate(this,this.$9Lo);_d.$Do.initializeBase(this);_a.$3.$K(n,"message");this.$m8=n;this.$53=t;this.$5It=f;this.$1W=i;this.$B=r;this.$EP=u;this.$7A=e;this.$1A=o;this.$3iX=new _C(this.$$d_$9Lo,_a.$0.$1YZ);this.$4Vi=new _C(this.$$d_$9ZH,_a.$0.$1YZ);this.$5Qt=new _C(this.$$d_$9QB,_a.$0.$1YZ);this.$5Qu=new _C(this.$$d_$9QC,_a.$0.$1YZ);this.$wd=new _C(this.$$d_$7hS,_a.$0.$1YZ);this.$1A=_a.UserAgent.getInstance();this.$3iW=$4p9(this,!0);this.$4Vg=$4p9(this,!1);this.$3iW||(this.$5CJ=this.$3iX);this.$4Vg||(this.$6VZ=this.$4Vi);$4pC(this);this.$m8.$Y("LastVerbExecuted",this.$$d_$9UT);this.$m8.get_$Iy().$Y("IsUndecidedApprovalRequest",this.$$d_$9UT)};function $4pC(n){n.set_$9zr(!!n.$m8.get_$Iy()&&n.$m8.get_$Iy().get_$48C()&&n.$m8.get_$nn()!==1&&n.$m8.get_$nn()!==2)}function $4p9(n,t){var i=t?0:1;if(n.$m8.get_$KK()&&n.$m8.get_$KK().UserOptions&&n.$m8.get_$KK().UserOptions.length>=i&&n.$m8.get_$KK().UserOptions[i].SendPrompt==="Send")return null;var r=[new _0365m.$o(_ucmm.MeetingMsgStrings.l_EditResponseBeforeSending_LowerCase_Text,null,t?n.$5Qt:n.$5Qu),new _0365m.$o(_ucmm.MeetingMsgStrings.l_SendResponseNow_LowerCase_Text,null,t?n.$3iX:n.$4Vi)];n.$B.get_$L()==="TouchNarrow"&&Array.add(r,new _0365m.$o(_nbs.NonBootStrings.l_TNarrowCloseMenuItemLabel_Text,null,n.$wd));return new _0365m.$2c(r)}function $4pB(n,t){if(!n.$53){var i=new _c.$bW(n.$m8,null,t,1);n.$1W.$11(i);$6y3(n)}}function $4pA(n,t){if(!n.$53){var i=n.$7A.$Fx(!1,!1);i.set_$3w(t?9:10);i.set_$NA(!0);i.set_$66(n.$B.get_$L()==="Mouse"?1:2);i.$yB(n.$m8);n.$5It().$TO(i)}}function $6y3(n){switch(n.$B.get_$L()){case"TouchNarrow":n.$EP.$BP();break;case"TouchWide":break;case"Mouse":if(!n.$B.get_$9l()){var t=window.self;_js.$J.get_$I().$40(_a.$0.$6E,"ApprovalRequestHeaderViewModel.PopOutClose",t.$$d_close||(t.$$d_close=Function.createDelegate(t,t.close)))}break}}_d.$Do.prototype={$m8:null,$B:null,$7A:null,$5It:null,$1W:null,$3iX:null,$4Vi:null,$5Qt:null,$5Qu:null,$5CJ:null,$6VZ:null,$wd:null,$EP:null,$53:!1,$1A:null,$3iW:null,$4Vg:null,$3SQ:!1,get_$9zr:function(){return this.$3SQ},set_$9zr:function(n){if(n!==this.$3SQ){this.$3SQ=n;$3(this,"ShowApproveRejectButtons")}return n},get_$jp:function(){return this.$1A.get_$Vk().get_$jp()},$9UT:function(n,t){$4pC(this)},$9Lo:function(){$4pB(this,!0)},$9ZH:function(){$4pB(this,!1)},$9QB:function(){$4pA(this,!0)},$9QC:function(){$4pA(this,!1)},$7hS:function(){}};_d.$o7=function(n,t,i,r,u){this.$B=n;this.$EP=t;this.$k=i;this.$7A=r;this.$1A=u};_d.$o7.prototype={$B:null,$EP:null,$k:null,$7A:null,$1A:null,$E:function(n,t,i){t||(t=_y.$CW.$5O7);return new _d.$Do(n,i,this.$k,this.$B,this.$EP,t,this.$7A,this.$1A)}};_d.$wi=function(n,t){this.$$d_$oh=Function.createDelegate(this,this.$oh);this.$$d_$9cF=Function.createDelegate(this,this.$9cF);_d.$wi.initializeBase(this);this.$fh=n;var r=this;this.$6V4=new _C(function(){$4qf(r.$fh)},_a.$0.$xM);var u=this;this.$6UJ=new _C(function(){$4qe(u.$fh)},_a.$0.$xM);var i=this;this.$fh.$Y("SelectedItemsCount",function(n,t){i.set_$7b6(i.$fh.get_$7q()>0)});this.set_$4Yi(new _y.$5Z("Mouse"));this.$1m.set_$r(!1);this.$1m.set_$QJ(!0);this.$1m.set_$1iX(1);this.$1m.set_$pP(!0);this.$1m.$1OB=!1;this.$1m.set_$eF(t);this.$1m.set_$J5(new _C(this.$$d_$9cF,_a.$0.$xM));this.$1m.set_$UC(new _C(this.$$d_$oh,_a.$0.$xM))};_d.$wi.prototype={$6V4:null,$6UJ:null,$fh:null,$1m:null,$2pm:!1,get_$7b6:function(){return this.$2pm},set_$7b6:function(n){if(this.$2pm===n)return n;this.$2pm=n;$3(this,"AreActionCommandsEnabled");return n},get_$4Yi:function(){return this.$1m},set_$4Yi:function(n){if(this.$1m!==n){this.$1m=n;$3(this,"SearchVM")}return n},$9cF:function(){if(!_js.$8.$a(this.$1m.$3F)&&this.$1m.$3F.trim().length>0){this.$1m.set_$15e(!0);this.$fh.$Ab(this.$1m,!0)}},$oh:function(){_a.$g.$4h0("VM.FindMail.Search");this.$1m.$UD();if(this.$fh.$7k){this.$fh.set_$at(!0);var n=this;_js.$J.get_$I().$40(_a.$0.$xM,"LoadItemsOnCancelSearch",function(){n.$fh.$T7(0)})}}};_d.$DQ=function(n,t,i,r,u,f,e){this.$$d_$7wp=Function.createDelegate(this,this.$7wp);this.$$d_$7wq=Function.createDelegate(this,this.$7wq);_d.$DQ.initializeBase(this,[n,t,i,u,r,f,null,null,e]);this.$5ev();this.set_$c4(new _h.$CF("DateTimeReceived","Descending"))};function $4qf(n){if(n.get_$7q()){var t=new _a.$4V([_nbs.NonBootStrings.l_RecoverItemsPontDescription_Text,_nbs.NonBootStrings.l_RecoverItemsPointMailItems_Text,_nbs.NonBootStrings.l_RecoverItemsPointCalendarItems_Text,_nbs.NonBootStrings.l_RecoverItemsPointContacts_Text,_nbs.NonBootStrings.l_RecoverItemsPointTasks_Text],1,n.$$d_$7wq,1,!1,_nbs.NonBootStrings.l_Ok_LowerCase_Text,_u.Strings.l_CancelButtonLabel_LowerCase_Text,_nbs.NonBootStrings.l_RecoverItemsPontHeader_Text);n.$J.$9lH(_a.$4V,t)}}function $4qe(n){if(n.get_$7q()){var t=new _a.$4V([_nbs.NonBootStrings.l_ConfirmPurgeDescription_Text],1,n.$$d_$7wp,1,!1,_nbs.NonBootStrings.l_Ok_LowerCase_Text,_u.Strings.l_CancelButtonLabel_LowerCase_Text,_nbs.NonBootStrings.l_ConfirmPurgePontHeader_Text);n.$J.$9lH(_a.$4V,t)}}function $4qd(n,t,i){if(t&&!(n.get_$7q()<=0)){var r=n.$xq($1L7(n));i();n.$eO(null);n.$eO(r);n.$rc()}}function $2ko(n,t,i){if(!(t.length<=0)){var r=new _h.$KJ(t,i.get_$o(),0);OwaApplication.$1W.$11(r)}}_d.$DQ.prototype={$7wp:function(n,t){var i=this;$4qd(this,n,function(){i.$IJ("HardDelete");_a.$g.$9H("VM.MailUsage.PurgeFromDumpster")})},$7wq:function(n,t){var i=this;$4qd(this,n,function(){for(var r=i.$2o,u=[],f=[],e=[],o=[],t=0;t<r.get_$C();t++){var n=r.get_$3o(t);switch(n.get_$7x()){case 2:Array.add(u,n);break;case 3:Array.add(o,n);break;case 4:Array.add(e,n);break;case 1:case 0:default:Array.add(f,n);break}}$2ko(i,f,_g.$2Z.$BJ("inbox"));$2ko(i,u,_g.$2Z.$BJ("calendar"));$2ko(i,e,_g.$2Z.$BJ("tasks"));$2ko(i,o,_g.$2Z.$BJ("contacts"));_a.$g.$9H("VM.MailUsage.RecoverFromDumpster")})},$27m:function(n,t){$3(this,"SelectedItems")},$5ev:function(){var n=[];var t=this;Array.add(n,new _0365m.$o(_nbs.NonBootStrings.l_RecoverItemMenuOption_Text,null,new _C(function(){$4qf(t)},_a.$0.$xM)));var i=this;Array.add(n,new _0365m.$o(_nbs.NonBootStrings.l_PurgeItemMenuOption_Text,null,new _C(function(){$4qe(i)},_a.$0.$xM)));this.set_$1fO(new _0365m.$2c(n))}};_d.$16a=function(n){this.$2k=n};_d.$16a.prototype={$2k:null};_d.$1A7=function(n,t,i,r){this.$B=n;this.$gL=t;this.$vH=r;this.$LG=i};_d.$1A7.prototype={$gL:null,$vH:null,$B:null,$LG:null,$br:function(n,t){var i=n.AttachmentItemID;return new _d.$CU(this.$B,this.$gL,this.$LG,this.$vH,i,t)},$wx:function(n,t){throw Error.notImplemented("Creating from context is not supported");}};_d.$CU=function(n,t,i,r,u,f){this.$$d_$5Xt=Function.createDelegate(this,this.$5Xt);this.$$d_$84l=Function.createDelegate(this,this.$84l);_d.$CU.initializeBase(this);this.$1v=new _y.$4p;this.$B=n;this.$Mz=f;this.$B.get_$L()==="TouchNarrow"&&this.set_$6k(_y.$22.$E(this));this.$gL=t;this.$vH=r;this.$LG=i;this.$8p=_g.$1t.$2KF(u);if(u.startsWith("smime-"))$72I(this,u);else{var e=new _at.$cq(u);e.add_$29(this.$$d_$84l);e.add_$21(this.$$d_$5Xt);OwaApplication.$1W.$11(e)}};function $4r4(n,t){n.set_$38G(n.$gL.$8V(t,!1,!0,!1,null,null,!1,n.$Mz,"All"));n.set_$45g(!0)}function $3b1(n){var t=this;n.$1v.$2u(0,_nbs.NonBootStrings.l_ItemAttachmentOpenFailure_Text,function(n,t){window.close()})}function $72H(n,t){var i=this;n.$vH.$E(function(i){n.$pf||n.set_$A6s(i.$E());t&&t(n.$pf)})}function $72I(n,t){var u=window.opener.getSmimeCachedContent(t);if(!u){_js.Trace.logError(_d.$CU.$A,"Cannot get attachment content of {0} from window.opener.",t);$3b1(n);return}var h=u[0];var o=u[1];var c=_a.$j.$rV();_js.Trace.logInfo(_a.$0.$3i,"Start to parse MIME content of a ItemAttachment into ItemType.");var l=c.ConvertMimeToItem(o);var f=JsonParser.deserialize(l);if(f.ErrorCode){_js.Trace.logException(_a.$0.$6E,_a.$2N.$E(_u.Strings.l_Smime_CannotParseMimeContent_Text,f.ErrorCode),"An error occurred when parsing MIME content.");$3b1(n)}else{var e=JsonParser.deserialize(f.Data);_js.Trace.logInfo(_a.$0.$3i,"MIME content of the ItemAttachment has been parsed into ItemType.");var s=e;s.DateTimeReceived=h;var a=e;a.ItemCategory=1;var r=new _g.$81(s);r.$5sQ(e);if(r.get_$15g()){var i=new _g.$MF;i.AttachmentId=new _g.$Ag(_a.$j.$Wf());i.Name="smime.p7m";i.ContentType="application/x-pkcs7-mime";i.Content=_a.$9R.$Ew(o);r.get_$2h().Attachments=[i]}n.set_$5n1(1);$4r4(n,r)}}_d.$CU.prototype={$45f:!1,$LG:null,$B:null,$gL:null,$vH:null,$1v:null,$C2:null,$pf:null,$385:0,$8p:null,$108:null,$Mz:null,get_$KN:function(){return this.$B.get_$L()==="TouchNarrow"?_y.$1Mq.prototype.get_$KN.call(this):0},get_$38G:function(){return this.$C2},set_$38G:function(n){this.$C2=n;$3(this,"ItemReadingPaneViewModel");return n},get_$A6s:function(){return this.$pf},set_$A6s:function(n){this.$pf=n;$3(this,"TaskReadingPaneViewModel");return n},get_$8Dw:function(){return this.$B.get_$L()==="Mouse"},get_$45g:function(){return this.$45f},set_$45g:function(n){this.$45f=n;$3(this,"IsItemAttachmentLoaded");return n},get_$5n1:function(){return this.$385},set_$5n1:function(n){this.$385=n;$3(this,"ItemAttachmentCategory");return n},get_$4OT:function(){return this.$108},set_$4OT:function(n){this.$108=n;return n},$2qc:function(){},$84l:function(n){var t=n.$2uc;this.set_$5n1(t.get_$7x());_js.Trace.logInfo(_d.$CU.$A,"GetItemAttachment succeeded for {0}",this.$385);switch(t.get_$7x()){case 4:var r=this;$72H(this,function(n){n.set_$2Ko(t);n.set_$8Lb(!0);r.set_$45g(!0)});break;case 2:t.set_$i(this.$8p);var i=t;i.set_$1MR(!0);i.set_$4M(2);var u=this;var f=function(){u.set_$45g(!0)};var e=this.$LG.$3om(i,f);this.$B.$fj(e,1,!0);break;default:t.set_$i(this.$8p);$4r4(this,t);break}},$5Xt:function(n){_js.Trace.logWarning(_d.$CU.$A,"Open ItemAttachment failed with Error: {0}",n.$1d?n.$1d.message:"No further details");$3b1(this)}};_d.$IR=function(n,t,i,r,u,f,e,o){this.$$d_$5Xt=Function.createDelegate(this,this.$5Xt);this.$$d_$5Y5=Function.createDelegate(this,this.$5Y5);_d.$IR.initializeBase(this);this.$gL=n;this.$B=t;this.$5S=i;this.$A0=r;this.$5jM=u;this.$5b=f;this.$6b=e;this.$Mz=o;this.$1v=new _y.$4p;this.$B.get_$L()==="TouchNarrow"&&this.set_$6k(_y.$22.$E(this));var h=_h.$1L.get_$I().$3f(i);if(h)$4r6(this,h);else{var s=new _h.$J8(200,[new _g.$1t(i)],_h.$v.get_$1Eq(),"ItemNormalizedBody",2,r);s.add_$29(this.$$d_$5Y5);s.add_$21(this.$$d_$5Xt);OwaApplication.$1W.$11(s)}};function $4r6(n,t){var i=n.$gL.$8V(t,n.$A0,!1,n.$5jM,null,n.$6b,!1,n.$Mz,n.$5b);_y.$ya.isInstanceOfType(i)&&i.set_$4OT(n.$108);n.set_$38G(i);n.set_$8Ld(!0)}_d.$IR.prototype={$45l:!1,$5S:null,$A0:!1,$5jM:!1,$5b:"All",$6b:null,$gL:null,$1v:null,$C2:null,$B:null,$Mz:null,$108:null,get_$38G:function(){return this.$C2},set_$38G:function(n){this.$C2=n;$3(this,"ItemReadingPaneViewModel");return n},get_$8Ld:function(){return this.$45l},set_$8Ld:function(n){this.$45l=n;$3(this,"IsItemLoaded");return n},get_$KN:function(){return this.$B.get_$L()==="TouchNarrow"?_y.$1Mq.prototype.get_$KN.call(this):0},get_$4OT:function(){return this.$108},set_$4OT:function(n){this.$108=n;return n},$2qc:function(){_y.$ya.isInstanceOfType(this.$C2)&&this.$C2.$2qc()},$5Y5:function(n){var t=_h.$1L.get_$I().$3f(this.$5S);$4r6(this,t)},$5Xt:function(n){var t=_nbs.NonBootStrings.l_ItemAttachmentOpenFailure_Text;if(n.$1d){var i=n.$1d.responseCode;if(i==="ErrorItemNotFound"){t=_u.Strings.l_ErrorItemNotFound_Text;_js.Trace.logWarning(_d.$IR.$A,"Open Item failed with Error: {0}",t)}else _js.Trace.logError(_d.$IR.$A,"Open Item failed with Error: {0}",n.$1d.message)}else _js.Trace.logError(_d.$IR.$A,"Open Item failed with Error: {0}","No further details");var r=this;this.$1v.$2u(0,t,function(n,t){window.close()})}};_d.$yt=function(n,t,i,r,u,f,e,o){this.$5ry=n;this.$5Fa=t;this.$5CI=i;this.$183=u;this.$k=r;this.$6Eb=f;this.$1H=e;this.$c=o};_d.$yt.prototype={$5ry:null,$5Fa:null,$5CI:null,$183:null,$k:null,$6Eb:null,$1H:null,$c:null,$5LQ:function(n,t,i,r,u,f){if(_g.$Ro.isInstanceOfType(n))return this.$5ry.$E(n,t,i,r,f);else if(_g.$81.isInstanceOfType(n)&&n.get_$Iy()&&n.get_$Iy().get_$48C()&&!u)return this.$5CI.$E(n,t,r);return null},$5Ls:function(n,t,i){return _g.$hu.isInstanceOfType(n)?new _d.$CK(n,this.$c):this.$1H&&this.$1H.$3N("ModernGroups")&&_g.$y.$8MI(n)?new _d.$Ru(n,this.$k,this.$183.$E(new _d.$Ic,1),this.$6Eb):_g.$y.$8JF(n)?this.$5Fa.$E(n):null}};_d.$yu=function(){};_d.$yu.prototype={$E:function(n){return new _y.$4k(n)}};_d.$1AF=function(n,t,i,r){this.$gL=n;this.$Jg=t;this.$B=i;this.$b=r};_d.$1AF.prototype={$gL:null,$Jg:null,$B:null,$b:null,$br:function(n,t){var i=!1;var r=!1;var u="All";"IsPrintView"in n&&this.$B.set_$QG(n.IsPrintView===1);"IsDiscoveryView"in n&&(i=n.IsDiscoveryView==="1");"ViewFilter"in n&&(u=n.ViewFilter);"IsArchive"in n&&(r=n.IsArchive==="1");var f=n.ItemID;var e=this.$b?this.$b.get_$Ht():null;return new _d.$IR(this.$gL,this.$B,f,i,r,u,e,t)},$wx:function(n,t){var i=n;var u=i.get_$3o();this.$B.set_$QG(i.get_$QG());var r=this.$gL.$8V(u,i.get_$1zr(),!1,i.get_$34C(),null,i.get_$Ht(),i.get_$15S(),t,i.get_$Bn());r.get_$yw()&&r.get_$yw().set_$op(i.get_$op());r.set_$9h(i.get_$9h());if(_g.$1Y.$N2&&this.$B.get_$L()==="Mouse"){var f=this;this.$Jg.$E(function(n){_g.$1Y.$N2.$42Q(n.$E())})}return r}};_d.$Rm=function(n){this.$J=n};function $73S(n,t){switch(t){case"ErrorAccessDenied":case"ErrorMoveCopyFailed":case"ErrorCannotDeleteObject":case"ErrorFolderSavePropertyError":case"ErrorApplyConversationActionFailed":$73T(n);return;case"ErrorFolderExists":$73U(n);return}}function $73U(n){var t=new _a.$4V([_u.Strings.l_SameNameFolderExists_Text],0,null);n.$J.$9lH(_a.$4V,t)}function $73T(n){var t=new _a.$4V([_u.Strings.l_SharedFolderNoPermissionMessage_Sentencecase_Text],0,null,0,!1,null,null,_u.Strings.l_SharedFolderRequestFailedTitle_Lowercase_Text);n.$J.$9lH(_a.$4V,t)}_d.$Rm.prototype={$J:null,$rb:function(n){if(n){if(_h.$TY.isInstanceOfType(n)){var i=n;var t=_h.$i.$Jo(i.$VU);if(!t||!t.$9Y)return}_h.$yi.isInstanceOfType(n)&&$73S(this,n.get_$2ds())}}};_d.$lD=function(n,t){this.$$d_$12y=Function.createDelegate(this,this.$12y);this.$$d_$5As=Function.createDelegate(this,this.$5As);_d.$lD.initializeBase(this);this.$Q4=new _d.$X9(n);this.$5At=t};function $73V(n){var t=new _y.$M8;t.set_$4o(_nbs.NonBootStrings.l_FolderPermissionsAddUser_Lowercase_Text);t.set_$DT(n);var e=this;var r=new _C(n.$$d_$5As,_a.$0.$7i,n.$Q4,"Persona",function(){return!!n.$Q4.$18});var i=new _C(n.$$d_$12y,_a.$0.$7i);t.set_$Fw(i);var u=new _a.$2E(r,_nbs.NonBootStrings.l_FolderPermissionsAddButton_Lowercase_Text);var f=new _a.$2E(i,_u.Strings.l_CancelButtonLabel_LowerCase_Text);t.$7W.$D(u);t.$7W.$D(f);n.set_$ip(t)}_d.$lD.prototype={$9w:null,$5At:null,$Q4:null,get_$ip:function(){this.$9w||$73V(this);return this.$9w},set_$ip:function(n){if(this.$9w!==n){this.$9w=n;$3(this,"DialogViewModel")}return n},$5As:function(){if(this.$Q4.$18){var n=new _g.$Zy;n.DisplayName=this.$Q4.$18.get_$1u().get_$1o();n.PrimarySmtpAddress=this.$Q4.$18.get_$1u().get_$1l().EmailAddress;n.DistinguishedUser="None";this.$12y();this.$5At(n)}},$12y:function(){this.get_$ip().set_$1O(!1);this.$Q4.$1t()}};_d.$5M=function(n,t){this.$$d_$9dc=Function.createDelegate(this,this.$9dc);this.$$d_$9dd=Function.createDelegate(this,this.$9dd);this.$$d_$5As=Function.createDelegate(this,this.$5As);this.$$d_$9ZV=Function.createDelegate(this,this.$9ZV);this.$$d_$9LB=Function.createDelegate(this,this.$9LB);this.$$d_$4Pl=Function.createDelegate(this,this.$4Pl);_d.$5M.initializeBase(this);this.set_$DT(this);this.set_$1EU(!0);this.$k=t;this.$Z4=new _C(this.$$d_$4Pl,_d.$5M.$ML);this.$5AL=new _C(this.$$d_$9LB,_d.$5M.$ML);this.$6WE=new _C(this.$$d_$9ZV,_d.$5M.$ML);this.$UT=new _js.$c;this.$x=new _y.$5u;this.$4As=new _d.$lD(n,this.$$d_$5As);var i=new _a.$2E(this.$Z4,_nbs.NonBootStrings.l_MailFolderPermissionsDialogButtonOK_Text);var r=new _a.$2E(this.$4f,_nbs.NonBootStrings.l_MailFolderPermissionsDialogButtonCancel_Text);this.set_$St(new _js.$c);this.$7W.$D(i);this.$7W.$D(r);this.set_$4o(_nbs.NonBootStrings.l_MailFolderPermissionsDialogTitle_Text)};_d.$5M.$$cctor=function(){_d.$5M.$2tS=["PermissionLevel","ReadAccess","DeleteAccess","CanCreateItems","CanCreateSubfolders","EditOwn","EditAll","IsFolderOwner","IsFolderContact","IsFolderVisible"]};function $vp(n){var t=n.$12.$7iR();if(t!==n.$12.get_$GI()){n.$12.set_$GI(t);$3(n,"PermissionLevel")}}function $73X(n){var t=new _h.$1Gw;t.$VC=new _g.$ee;t.$VC.set_$4SZ(new(_a.$1r.$$(_g.$44,_g.$SF)));for(var i=0;i<n.$UT.get_$C();i++){var r=n.$UT.get_$3o(i);var u=r.$3g();u.set_$1KT($73W(n,r.get_$1KT()));t.$VC.get_$4SZ().$D(u)}t.$2Q=n.$2Q;t.add_$2t(n.$$d_$9dd);t.add_$21(n.$$d_$9dc);n.$k.$11(t)}function $73W(n,t){var i=new _g.$Zy;i.DistinguishedUser=t.DistinguishedUser;i.ExternalUserIdentity=t.ExternalUserIdentity;i.PrimarySmtpAddress=t.PrimarySmtpAddress;i.SID=t.SID;return i}function $4s3(n){if(n.$12){for(var t=0;t<_d.$5M.$2tS.length;t++)$3(n,_d.$5M.$2tS[t]);$3bI(n)}}function $3bI(n){if(n.$12){n.set_$7um(n.$12.get_$LO()!=="All");n.set_$8Ki(!$4s2(n,n.$12.get_$1KT()))}}function $4s2(n,t){return t.DistinguishedUser==="Anonymous"||t.DistinguishedUser==="Default"}function $4s1(n){n.$UT.$1t();n.set_$FQ(!1);n.$4f.$s()}_d.$5M.prototype={$k:null,$Z4:null,$5AL:null,$6WE:null,$4As:null,$1v:null,$UT:null,$uJ:null,$12:null,$x:null,$2Q:null,$Kl:!1,$2TM:!1,$2xD:!1,$35J:!1,get_$D3:function(){this.$1v||(this.$1v=new _y.$4p);return this.$1v},get_$9gZ:function(){if($5(this.$uJ)){this.$uJ=new _js.$c;this.$uJ.$D("Owner");this.$uJ.$D("PublishingEditor");this.$uJ.$D("Editor");this.$uJ.$D("PublishingAuthor");this.$uJ.$D("Author");this.$uJ.$D("NoneditingAuthor");this.$uJ.$D("Reviewer");this.$uJ.$D("Contributor");this.$uJ.$D("None")}return this.$uJ},get_$1p:function(){return this.$12},set_$1p:function(n){if(this.$12===n)return n;this.$12=n;$3(this,"SelectedItem");$4s3(this);return n},get_$GI:function(){return this.$12.get_$GI()},set_$GI:function(n){if(this.$12.get_$GI()!==n){this.$12.set_$GI(n);this.set_$FQ(!0);this.$12.$7al();$3(this,"PermissionLevel");$4s3(this)}return n},get_$6Um:function(){return this.$12.get_$bm()},set_$6Um:function(n){if(this.$12.get_$bm()!==n){this.$12.set_$bm(n);this.set_$FQ(!0);$vp(this);$3(this,"ReadAccess")}return n},get_$5OT:function(){return this.$12.get_$IJ()},set_$5OT:function(n){if(this.$12.get_$IJ()!==n){this.$12.set_$IJ(n);this.set_$FQ(!0);$vp(this);$3(this,"DeleteAccess")}return n},get_$Vo:function(){return this.$12.get_$Vo()},set_$Vo:function(n){if(this.$12.get_$Vo()!==n){this.$12.set_$Vo(n);this.set_$FQ(!0);$vp(this);$3(this,"CanCreateItems")}return n},get_$5Fy:function(){return this.$12.get_$a6()},set_$5Fy:function(n){if(this.$12.get_$a6()!==n){this.$12.set_$a6(n);this.set_$FQ(!0);$vp(this);$3(this,"CanCreateSubfolders")}return n},get_$5R6:function(){return this.$12.get_$LO()==="Owned"||this.$12.get_$LO()==="All"},set_$5R6:function(n){if(n){if(this.$12.get_$LO()==="None"){this.$12.set_$LO("Owned");this.set_$FQ(!0);$vp(this);$3u(this,"EditOwn","EditAll")}}else if(this.$12.get_$LO()==="None"){this.set_$FQ(!0);$vp(this);$3u(this,"EditOwn","EditAll")}else this.$12.get_$LO()==="All"&&$3(this,"EditOwn");$3bI(this);return n},get_$7um:function(){return this.$2xD},set_$7um:function(n){if(this.$2xD!==n){this.$2xD=n;$3(this,"EditOwnEnabled")}return n},get_$5Qs:function(){return this.$12.get_$LO()==="All"},set_$5Qs:function(n){if(n){(this.$12.get_$LO()==="None"||this.$12.get_$LO()==="Owned")&&this.$12.set_$LO("All");this.set_$FQ(!0);$vp(this);$3u(this,"EditOwn","EditAll")}else if(this.$12.get_$LO()==="All"){this.set_$FQ(!0);this.$12.set_$LO("None");$vp(this);$3u(this,"EditOwn","EditAll")}$3bI(this);return n},get_$WI:function(){return this.$12.get_$WI()},set_$WI:function(n){if(this.$12.get_$WI()!==n){this.$12.set_$WI(n);this.set_$FQ(!0);$vp(this);$3(this,"IsFolderOwner")}return n},get_$RZ:function(){return this.$12.get_$RZ()},set_$RZ:function(n){if(this.$12.get_$RZ()!==n){this.$12.set_$RZ(n);this.set_$FQ(!0);$vp(this);$3(this,"IsFolderContact")}return n},get_$8Ki:function(){return this.$35J},set_$8Ki:function(n){if(this.$35J!==n){this.$35J=n;$3(this,"IsFolderContactEnabled")}return n},get_$Sz:function(){return this.$12.get_$Sz()},set_$Sz:function(n){if(this.$12.get_$Sz()!==n){this.$12.set_$Sz(n);this.set_$FQ(!0);$vp(this);$3(this,"IsFolderVisible")}return n},get_$7zA:function(){return this.$UT},set_$7zA:function(n){if(this.$UT!==n){this.$UT=n;$3(this,"FolderPermissionList")}return n},get_$ip:function(){return this},get_$FQ:function(){return this.$Kl},set_$FQ:function(n){if(this.$Kl!==n){this.$Kl=n;$3(this,"IsDIrty")}return n},$VM:function(n,t){this.$2Q=n;this.set_$4o(String.format(_nbs.NonBootStrings.l_MailFolderPermissionsDialogTitle_Text,n.get_$1o()));this.$UT.$1t();this.$UT.$6S(t.get_$4SZ().$6W());this.set_$1p(this.$UT.get_$3o(0));this.set_$FQ(!1);this.$2TM=!1;this.set_$1O(!0)},$5As:function(n){var r=this;var i=this.$UT.$Dn(function(t){return t.$7vo(n)});if(i!==this.$UT.get_$C()){this.get_$D3().$2u(0,String.format(_nbs.NonBootStrings.l_CannotAddDuplicateUser_Text,n.DisplayName),null);return}var t=_g.$44.$QV.$3g();t.set_$1KT(n);this.$UT.$D(t);this.set_$FQ(!0);this.set_$1p(this.$UT.get_$3o(this.$UT.get_$C()-1))},$9oF:function(){var n=this.$UT.$79(this.$12);if(n!==-1){if($4s2(this,this.$12.get_$1KT())){this.get_$D3().$2u(0,_nbs.NonBootStrings.l_CannotDeleteAnonymousOrDefaultUser_Text,null);return}var t=n===this.$UT.get_$C()-1?n-1:n;this.$UT.$34(this.$12);this.set_$FQ(!0);var i=this.$UT.get_$3o(t);this.set_$1p(i)}},$4Pl:function(){if(!this.$2TM)if(this.$Kl){$73X(this);this.$2TM=!0}else $4s1(this)},$9LB:function(){this.$4As.get_$ip().set_$1O(!0)},$9ZV:function(){this.$9oF()},$9dd:function(n){this.$2TM=!1;n.$1d||$4s1(this)},$9dc:function(n){this.$2TM=!1;var t=n.$2Q.get_$1o();this.get_$D3().$2u(0,String.format(_nbs.NonBootStrings.l_CannotUpdatePermissionsForFolder_Text,t),null)}};_d.$Ru=function(n,t,i,r){this.$$d_$9k4=Function.createDelegate(this,this.$9k4);this.$$d_$9Pa=Function.createDelegate(this,this.$9Pa);this.$$d_$9Pb=Function.createDelegate(this,this.$9Pb);this.$$d_$9Pc=Function.createDelegate(this,this.$9Pc);_d.$Ru.initializeBase(this);_a.$3.$K(n,"message");_a.$3.$K(i,"personaCardFacade");this.$k=t;this.$Ge=n;this.$K2=i;this.$2Pw=!0;this.$CN=!1;if(r){var u=this;r.$E(function(n){u.$6Ea=n;$73q(u)})}};function $73q(n){if(!n.$2cZ){var t=n.$6Ea.$7ms(n.$Ge.get_$i());t.add_$29(n.$$d_$9Pc);t.add_$21(n.$$d_$9Pb);t.add_$2t(n.$$d_$9Pa);n.set_$ax(!0);n.$k.$11(t);n.set_$9k5(new _C(n.$$d_$9k4,_d.$Ru.$A))}}_d.$Ru.prototype={$K2:null,$Ge:null,$k:null,$14o:null,$2Pw:!1,$CN:!1,$2cZ:null,$6Ea:null,$98:null,get_$9k5:function(){return this.$2cZ},set_$9k5:function(n){if(this.$2cZ!==n){this.$2cZ=n;$3(this,"ProcessMembershipCommand")}return n},get_$5D9:function(){return new Array(0)},$jr:function(){},get_$5dM:function(){return this.$2Pw},set_$5dM:function(n){if(this.$2Pw!==n){this.$2Pw=n;$3(this,"HideProcessMembershipButton")}return n},get_$cp:function(){return this.$98},set_$cp:function(n){if(this.$98!==n){this.$98=n;$3(this,"ErrorMessage")}return n},get_$ax:function(){return this.$CN},set_$ax:function(n){if(this.$CN!==n){this.$CN=n;$3(this,"IsLoading")}return n},$9Pa:function(n){this.set_$ax(!1)},$9Pb:function(n){this.set_$5dM(!0);this.set_$cp(_nbs.NonBootStrings.l_ModernGroupRequest_ProcessRequestInfoFail_Text)},$9Pc:function(n){var t=n;this.$14o=_pc.$l.$1C2(t.get_$1Ii().GroupPersona,2);this.set_$cp("");this.set_$5dM(!t.get_$1Ii().IsOwner||this.$Ge.get_$3U().Mailbox.EmailAddress===_g.$V.get_$I().get_$2z().get_$AM())},$9k4:function(){var t=_pc.$l.$Dh(this.$Ge.get_$3U().Mailbox);var n=new _d.$R7;n.get_$rF().$2VT=[t];n.get_$rF().$27e=!0;this.$K2.$1vl(this.$14o,n)}};_d.$VW=function(n,t){this.$$d_$7Yz=Function.createDelegate(this,this.$7Yz);this.$$d_$7Z0=Function.createDelegate(this,this.$7Z0);this.$$d_$9o8=Function.createDelegate(this,this.$9o8);this.$$d_$6WP=Function.createDelegate(this,this.$6WP);this.$$d_$87y=Function.createDelegate(this,this.$87y);this.$$d_$12y=Function.createDelegate(this,this.$12y);this.$$d_$D=Function.createDelegate(this,this.$D);_d.$VW.initializeBase(this);this.$Q4=new _d.$X9(n);this.$k=t};function $4tF(n){n.get_$D3().$2u(0,_u.Strings.l_SharedFolderRequestFailedTitle_Lowercase_Text,null,!1,null,null,_nbs.NonBootStrings.l_SharedFolderFailedMessage_Sentencecase_Text)}_d.$VW.prototype={$9w:null,$1v:null,$k:null,$Q4:null,$30j:null,$2oS:null,$3Ob:null,get_$ip:function(){if(!this.$9w){this.$9w=new _y.$M8;this.$9w.set_$4o(_nbs.NonBootStrings.l_AddSharedFolder_Lowercase_Text);this.$9w.set_$DT(this);var t=this;var i=new _C(this.$$d_$D,_a.$0.$7i,this.$Q4,"Persona",function(){return!!t.$Q4.$18});var n=new _C(this.$$d_$12y,_a.$0.$7i);this.$9w.set_$Fw(n);var r=new _a.$2E(i,_nbs.NonBootStrings.l_AddSharedFolderButton_Lowercase_Text);var u=new _a.$2E(n,_u.Strings.l_CancelButtonLabel_LowerCase_Text);this.$9w.$7W.$D(r);this.$9w.$7W.$D(u)}return this.$9w},get_$D3:function(){this.$1v||(this.$1v=new _y.$4p);return this.$1v},get_$87z:function(){return this.$30j},set_$87z:function(n){this.$30j=n;return n},get_$7Z1:function(){return this.$2oS},set_$7Z1:function(n){this.$2oS=n;return n},get_$9o9:function(){return this.$3Ob},set_$9o9:function(n){this.$3Ob=n;return n},$14g:function(){var n=new _c.$17b;n.add_$29(this.$$d_$87y);this.$k.$11(n)},$34:function(n){if(n){var t=new _c.$1DV(n);t.add_$29(this.$$d_$6WP);t.add_$21(this.$$d_$9o8);this.$k.$11(t)}},$D:function(){if(this.$Q4.$18){var t=this.$Q4.$18.get_$1u().get_$1o();var i=this.$Q4.$18.get_$1u().get_$1l().EmailAddress;var n=new _c.$12t(t,i);n.add_$29(this.$$d_$7Z0);n.add_$21(this.$$d_$7Yz);this.$k.$11(n);this.$12y()}},$12y:function(){this.get_$ip().set_$1O(!1);this.$Q4.$1t()},$87y:function(n){this.$30j&&this.$30j(n.$6PB)},$7Yz:function(n){$4tF(this)},$7Z0:function(n){if(this.$2oS){var t=n;this.$2oS(t.$7K,t.$1IA)}},$9o8:function(n){$4tF(this)},$6WP:function(n){if(this.$3Ob){var t=n;this.$3Ob(t.$1IA)}}};_d.$Ix=function(n){this.$$d_$5e8=Function.createDelegate(this,this.$5e8);this.$$d_$3gV=Function.createDelegate(this,this.$3gV);this.$$d_$5Gs=Function.createDelegate(this,this.$5Gs);_d.$Ix.initializeBase(this);var t=this;n.$E(function(n){t.$7u=n.$E();t.$7u.get_$43P().add_$1Y(t.$$d_$5Gs)});this.$Bf=new _js.$c;this.$1kq=6e4};function $6zm(n,t){_js.Trace.logInfo(_a.$0.$4c,"Notification provider: adding invitation.");var i=new _d.$WZ(t,n.$$d_$3gV,n.$$d_$5e8);if(!n.$Pa){n.$Pa=!0;$3(n,"ShowNotificationInTray")}n.$Bf.$D(i);$3(n,"NotificationCount");$1Ky(n)}function $3ac(n,t){_js.Trace.logInfo(_a.$0.$4c,"Notification provider: removing invitation.");n.$Bf.$34(t);$3(n,"NotificationCount");if(!n.$Bf.get_$C()){n.$Pa=!1;$3(n,"ShowNotificationInTray")}}_d.$Ix.prototype={$Bf:null,$7u:null,$Pa:!1,get_$41n:function(){return _d.$4.get_$7g3()},get_$8Ex:function(){return _d.$4.get_$4c()},get_$5dq:function(){return _nbs.NonBootStrings.l_Chat_Notification_Title_Text},get_$1JX:function(){return this.$Pa},get_$4TM:function(){return!0},get_$6SA:function(){return"ChatInvitationNotificationView"},get_$1jC:function(){return this.$Bf.get_$C()},get_$A1K:function(){return!0},get_$3IV:function(){return"im_notify.mp3"},get_$9iC:function(){return!0},get_$Z:function(){return this},$3gV:function(n){if(this.$7u){this.$7u.$3gS(n.$7a);$3ac(this,n)}},$5e8:function(n){if(this.$7u){this.$7u.$41t(n.$7a);$3ac(this,n)}},$5Gs:function(n,t){if(t.$2Z){if(t.$2Z===2)for(var f=t.$3B[0],e=this.$Bf.get_$C(),i=0;i<e;i++){var r=this.$Bf.get_$3o(i);if(r.$7a===f){$3ac(this,r);break}}}else{var u=t.$2q[0];$6zm(this,u)}}};_d.$WZ=function(n,t,i){this.$$d_$1PL=Function.createDelegate(this,this.$1PL);this.$$d_$1Y0=Function.createDelegate(this,this.$1Y0);_d.$WZ.initializeBase(this);this.$7a=n;this.$1qu=t;this.$330=i;this.$1qv=new _0365f.$Ti(this.$$d_$1Y0,_a.$0.$4c);this.$331=new _C(this.$$d_$1PL,_a.$0.$4c);this.$Tn=new _d.$96(this.$7a.$3Ve,_y.$17.$4U4,!1);this.$Cm=new _d.$96(this.$7a.$3Ve,4,!1)};_d.$WZ.prototype={$7a:null,$Tn:null,$Cm:null,$1qv:null,$331:null,$1qu:null,$330:null,get_$4y:function(){return this.$7a.$4gJ},$1Y0:function(n){_js.Trace.logInfo(_a.$0.$4c,"ChatInvitationViewModel: Accepting session {0}.",this.$7a.get_$Rd());if(n){this.$7a.$3YZ=n.get_$TU();this.$7a.$3Ye=n.get_$h8()}this.$1qu(this)},$1PL:function(){_js.Trace.logInfo(_a.$0.$4c,"ChatInvitationViewModel: Ignoring session {0}.",this.$7a.get_$Rd());this.$330(this)}};_d.$NR=function(n){this.$$d_$7py=Function.createDelegate(this,this.$7py);this.$$d_$3gV=Function.createDelegate(this,this.$3gV);this.$$d_$9L2=Function.createDelegate(this,this.$9L2);_d.$NR.initializeBase(this);_a.$3.$m(n,"chatManagerFactory");var t=this;n.$E(function(n){t.$7u=n.$E();t.$7u.get_$5EY().add_$1Y(t.$$d_$9L2)});this.$Bf=new _js.$c;this.$1kq=0};function $6yG(n,t){_a.$3.$m(t,"persona");_js.Trace.logInfo(_a.$0.$4c,"Notification provider: adding buddy request invitation.");var i=new _d.$oW(t,n.$$d_$3gV,n.$$d_$7py);if(!n.$Pa){n.$Pa=!0;$3(n,"ShowNotificationInTray")}n.$Bf.$D(i);$3(n,"NotificationCount");$5(n.$3Qm)&&n.set_$4Z7(n.$Bf.get_$3o(0));$1Ky(n)}function $6yH(n,t){_js.Trace.logInfo(_a.$0.$4c,"Notification provider: removing buddy request invitation.");n.$Bf.$34(t);$3(n,"NotificationCount");if(n.$Bf.get_$C())n.set_$4Z7(n.$Bf.get_$3o(0));else{n.$Pa=!1;$3(n,"ShowNotificationInTray")}}_d.$NR.prototype={$Bf:null,$7u:null,$Pa:!1,$3Qm:null,get_$41n:function(){return _d.$4.get_$5AI()},get_$8Ex:function(){return _d.$4.get_$5AI()},get_$5dq:function(){return _nbs.NonBootStrings.l_BuddyRequest_Notification_Title_Text},get_$1JX:function(){return this.$Pa},get_$4TM:function(){return!0},get_$6SA:function(){return"BuddyRequestNotificationView"},get_$Z:function(){return this},get_$1jC:function(){return this.$Bf.get_$C()},get_$A1K:function(){return!0},get_$9iC:function(){return!1},get_$4Z7:function(){return this.$3Qm},set_$4Z7:function(n){this.$3Qm=n;$3(this,"SelectedRequest");return n},$3gV:function(n){_a.$3.$m(n,"invitationViewModel");this.$7u&&this.$7u.$7X8(n.$1Ve.get_$1u())},$7py:function(n){_a.$3.$m(n,"invitationViewModel");this.$7u&&this.$7u.$7px(n.$1Ve.get_$1u())},$9L2:function(n,t){if(t.$2Z){if(t.$2Z===2)for(var f=t.$3B[0],e=this.$Bf.get_$C(),i=0;i<e;i++){var r=this.$Bf.get_$3o(i);if(!r.$1Ve.get_$1u().get_$Al().localeCompare(f.get_$Al())){$6yH(this,r);break}}}else{var u=t.$2q[0];$6yG(this,u)}}};_d.$Dl=function(){this.$6EK=new _js.$c;this.$1LR=new _js.$c;_d.$Dl.initializeBase(this);this.$1kq=0};function $4tJ(n,t){n.$1LR.$D(t);$3(n,"NotificationCount");if(n.$1LR.get_$C()===1){$3(n,"ShowNotificationInTray");$1Ky(n)}}function $4tI(n,t){n.$1LR.$34(t);$3(n,"NotificationCount");n.$1LR.get_$C()||$3(n,"ShowNotificationInTray")}function $4tH(n,t){n.$6EK.$D(t)}_d.$Dl.prototype={get_$41n:function(){return _d.$4.get_$9f0()},get_$8Ex:function(){return _d.$4.get_$9ez()},get_$5dq:function(){return _nbs.NonBootStrings.l_System_Notification_Title_Text},get_$1JX:function(){return this.$1LR.get_$C()>0},get_$6SA:function(){return"SystemNotificationsView"},get_$1jC:function(){return this.$1LR.get_$C()},get_$A1K:function(){return!0},get_$9iC:function(){return!0},get_$4TM:function(){return!1}};_d.$C0=function(n,t,i){this.$$d_$8BP=Function.createDelegate(this,this.$8BP);this.$$d_$8Ar=Function.createDelegate(this,this.$8Ar);this.$$d_$8BB=Function.createDelegate(this,this.$8BB);this.$$d_$6FY=Function.createDelegate(this,this.$6FY);this.$$d_$8Bj=Function.createDelegate(this,this.$8Bj);_d.$C0.initializeBase(this);this.$J=n;this.$b=t;if($5(i)||!i){var r=new _g.$Ac;r.NotificationType="NewMailNotification";r.InferenceEnabled=$4sJ(this);var u=new _h.$B8(r);u.$Hd(_a.$0.$5o,"NewMailNotification",this.$$d_$8Bj,0)}this.$3Hr=new _C(this.$$d_$6FY,_a.$0.$5o);$73t(this)};function $2lA(n){n.$Pa=!1;$3(n,"ShowNotificationInTray");n.set_$5ol("");n.set_$5om("");n.set_$6T3("");n.$1j1=null}function $73t(n){n.$J.$Hd(_d.$16a,n.$$d_$8BB);n.$J.$Hd(_y.$bG,n.$$d_$8Ar);n.$J.$Hd(_y.$eG,n.$$d_$8BP)}function $73s(n,t){return $4sJ(n)&&t.IsClutter}function $4sJ(n){return n.$b.get_$5z().get_$Ta()&&n.$b.get_$13().get_$Gz()}_d.$C0.prototype={$Pa:!1,$390:null,$392:null,$3Mr:null,$1j1:null,$6Fq:null,$3Hr:null,$J:null,$b:null,get_$41n:function(){return _d.$4.get_$8Sm()},get_$8Ex:function(){return _d.$4.get_$8Sk()},get_$5dq:function(){return _nbs.NonBootStrings.l_NewMail_Notification_Title_Text},get_$1JX:function(){return this.$Pa},get_$4TM:function(){return!!(this.$b.get_$13().get_$4Mk()&1)},get_$6SA:function(){return"NewMailNotificationView"},get_$1jC:function(){return 0},get_$A1K:function(){return!1},get_$3IV:function(){return"email_notify.mp3"},get_$9iC:function(){return!0},get_$5ol:function(){return this.$390},set_$5ol:function(n){if(this.$390!==n){this.$390=n;$3(this,"Line1")}return n},get_$5om:function(){return this.$392},set_$5om:function(n){if(this.$392!==n){this.$392=n;$3(this,"Line2")}return n},get_$6T3:function(){return this.$3Mr},set_$6T3:function(n){if(this.$3Mr!==n){this.$3Mr=n;$3(this,"PreviewText")}return n},$8Bj:function(n){var t=n;if(n.EventType!=="Reload"&&!$73s(this,t)){this.$J.$9lH(_c.$zY,new _c.$zY);this.set_$5ol(t.Sender);this.set_$5om(t.Subject);this.set_$6T3(t.PreviewText);this.$1j1=t.ItemId;this.$6Fq=t.ConversationId;this.$Pa=!0;$3(this,"ShowNotificationInTray");$1Ky(this)}},$6FY:function(){if(!$5(this.$1j1)){var n=new _g.$1t(this.$1j1);this.$J.$9lH(_y.$ry,new _y.$ry(n));$2lA(this)}},$8BB:function(n){this.$Pa&&_g.$h.$1i.doesIdEqualName(n.$2k,"inbox")&&$2lA(this)},$8Ar:function(n){this.$Pa&&n.$Cv.Id===this.$6Fq&&$2lA(this)},$8BP:function(n){this.$Pa&&n.$5S.Id===this.$1j1&&$2lA(this)}};_d.$QA=function(n){this.$$d_$41J=Function.createDelegate(this,this.$41J);this.$$d_$A8I=Function.createDelegate(this,this.$A8I);this.$$d_$4QG=Function.createDelegate(this,this.$4QG);this.$$d_$8Bn=Function.createDelegate(this,this.$8Bn);this.$$d_$5bb=Function.createDelegate(this,this.$5bb);_d.$QA.initializeBase(this);this.$10X=n;this.$10X.add_$6GS(this.$$d_$5bb);this.$10X.add_$9Jm(this.$$d_$8Bn);this.$10X.$Y("ShowNotificationInTray",this.$$d_$4QG)};function $73v(n){n.$10X.$1kq&&(n.$jJ=_js.$J.get_$I().$1s(_a.$0.$5o,"PopOutHide",n.$$d_$41J,n.$10X.$1kq))}function $73u(n){n.$jJ&&(n.$jJ=_js.$J.get_$I().$5A(n.$jJ))}_d.$QA.prototype={$10X:null,$WM:!1,$jJ:null,$4b8:!1,add_$6GS:function(n){this.$2G("NotificationRaised",n)},remove_$6GS:function(n){this.$2H("NotificationRaised",n)},get_$A8J:function(){return new _C(this.$$d_$A8I,_a.$0.$5o)},get_$2Sn:function(){return this.$WM},set_$2Sn:function(n){if(this.$WM!==n){this.$WM=n;$3(this,"IsPopupShown");this.$WM||$73u(this)}return n},get_$9JG:function(){return _a.UserAgent.getInstance().$jW?_nbs.NonBootStrings.l_NewNotificationButtonSafari_Text:_nbs.NonBootStrings.l_NewNotificationButton_Text},$2jR:function(){this.$10X.$8DW()},$41J:function(){this.set_$2Sn(!1)},$A8I:function(){this.$WM||(this.$4b8=!0);this.set_$2Sn(!this.$WM)},$5bb:function(n){n.get_$9iC()&&this.set_$2Sn(!0);$73v(this);$BF(this,"NotificationRaised",this,this)},$8Bn:function(n){this.$WM&&this.$41J()},$4QG:function(n,t){this.$10X.get_$1JX()||this.$41J()}};_d.$4O=function(){_d.$4O.initializeBase(this)};function $1Ky(n){$BF(n,"NotificationRaised",n,n)}function $73w(n){$BF(n,"NotificationDismissed",n,n)}_d.$4O.prototype={$1kq:2e3,add_$6GS:function(n){this.$2G("NotificationRaised",n)},remove_$6GS:function(n){this.$2H("NotificationRaised",n)},add_$9Jm:function(n){this.$2G("NotificationDismissed",n)},remove_$9Jm:function(n){this.$2H("NotificationDismissed",n)},get_$3IV:function(){return"calendar_notify.mp3"},$8DW:function(){}};_d.$LN=function(n){this.$$d_$4QG=Function.createDelegate(this,this.$4QG);this.$$d_$5bb=Function.createDelegate(this,this.$5bb);this.$$d_$7a1=Function.createDelegate(this,this.$7a1);_d.$LN.initializeBase(this);this.$gv=new _js.$c;this.$3mI=$5(n)?this.$$d_$7a1:n};function $4sK(n,t){var i=t.get_$1JX();if(!i){var r=this;n.$gv.$Bd(function(n){i=i||n.$10X.get_$1JX()})}n.$30!==i&&n.set_$1O(i)}function $73x(n,t){n.set_$3IV(new _d.$oI(null,_y.$x.$w.$88A(t)+"?UA=0",null));n.set_$4bQ(!0)}_d.$LN.prototype={$gv:null,$49N:null,$30:!1,$3IU:null,$4bP:!1,$3mI:null,get_$6GL:function(){return this.$gv},set_$6GL:function(n){if(this.$gv!==n){this.$gv=n;$3(this,"NotificationEntries")}return n},get_$3IV:function(){return this.$3IU},set_$3IV:function(n){if(this.$3IU!==n){this.$3IU=n;$3(this,"NotificationSoundSource")}return n},get_$4bQ:function(){return this.$4bP},set_$4bQ:function(n){if(this.$4bP!==n){this.$4bP=n;$3(this,"ShouldPlayNotificationSound")}return n},get_$1O:function(){return this.$30},set_$1O:function(n){if(this.$30!==n){this.$30=n;$3(this,"IsShown")}return n},$12D:function(n){var t=new _d.$QA(n);t.add_$6GS(this.$$d_$5bb);n.$Y("ShowNotificationInTray",this.$$d_$4QG);$4sK(this,n);this.$gv.$D(t)},$4QG:function(n,t){var i=n;$4sK(this,i)},$5bb:function(n){var t=n.$10X;this.$3mI()&&t.get_$1JX()&&t.get_$4TM()&&($5(t.get_$3IV())||$73x(this,t.get_$3IV()))},$7a1:function(){if($5(this.$49N)||_a.$7.get_$2F().$5u(this.$49N)>5e3){this.$49N=_a.$7.get_$2F();return!0}else return!1}};_d.$zk=function(){this.$6Gj=new _js.$c};_d.$zk.prototype={get_$6GL:function(){return this.$6Gj},set_$6GL:function(n){return n},get_$4bQ:function(){return!1},set_$4bQ:function(n){return n},get_$1O:function(){return!1},set_$1O:function(n){return n}};_d.$sc=function(n,t){this.$$d_$8AO=Function.createDelegate(this,this.$8AO);this.$$d_$8GP=Function.createDelegate(this,this.$8GP);this.$$d_$9m1=Function.createDelegate(this,this.$9m1);this.$$d_$2wQ=Function.createDelegate(this,this.$2wQ);this.$2L8=-1;_d.$sc.resolveInheritance();this.apcl=this.$Y;this.rpcl=this.$q;_d.$sc.initializeBase(this);this.$J=n;this.$1T0=t;this.$2wR=new _C(this.$$d_$2wQ,_a.$0.$5o);this.$6VC=new _C(this.$$d_$9m1,_a.$0.$5o);$4tH(this.$1T0,this);_js.$J.get_$I().$40(_a.$0.$5o,"PasswordExpirationNotificationProvider::ctor",this.$$d_$8GP)};_d.$sc.prototype={$2wR:null,$6VC:null,$J:null,$1T0:null,get_$40p:function(){return _nbs.NonBootStrings.l_PasswordExpiresHeader_Text},get_$A7x:function(){return this.$2L8?_js.$8.$4B(_nbs.NonBootStrings.l_PasswordExpiresInNDaysTitle_Text,this.$2L8):_nbs.NonBootStrings.l_PasswordExpiresTodayTitle_Text},get_$A5E:function(){return _nbs.NonBootStrings.l_PasswordExpiresSubTitle_Text},get_$7dm:function(){return _u.Strings.l_Yes_Text},get_$7dl:function(){return this.$6VC},get_$7do:function(){return _u.Strings.l_No_Text},get_$7dn:function(){return this.$2wR},$8GP:function(){var n=new _c.$17A;n.add_$29(this.$$d_$8AO);OwaApplication.$1W.$11(n)},$8AO:function(n){var t=n;this.$2L8=t.$3qu;this.$2L8>=0&&$4tJ(this.$1T0,this)},$2wQ:function(){$4tI(this.$1T0,this)},$9m1:function(){this.$2wQ();var n=new _y.$N3("PersonalSettings/Password.aspx");this.$J.$9lH(_y.$N3,n)}};_d.$SQ=function(n,t,i){this.$$d_$9QQ=Function.createDelegate(this,this.$9QQ);this.$$d_$1Ti=Function.createDelegate(this,this.$1Ti);this.$$d_$17X=Function.createDelegate(this,this.$17X);this.$$d_$6MW=Function.createDelegate(this,this.$6MW);_d.$SQ.initializeBase(this);this.$Nv=n;this.$29p=new _d.$7c(this.$Nv);this.$29p.add_$6Vm(this.$$d_$6MW);this.$Nv.add_$59Z(this.$$d_$17X);this.$b=t;this.$J=i;this.$J.$Hd(_a.$D5,this.$$d_$1Ti);this.$1kq=0};_d.$SQ.prototype={$b:null,$J:null,$Nv:null,$29p:null,$6ff:!1,$40Z:!1,$5GH:!1,$Oo:!1,get_$41n:function(){return _d.$4.get_$7wJ()},get_$8Ex:function(){return _d.$4.get_$7wI()},get_$5dq:function(){return String.format(_nbs.NonBootStrings.l_Reminder_Notification_Title_Text,this.get_$1jC())},get_$1JX:function(){return this.$6ff&&this.$b.get_$13().get_$1O9()},get_$4TM:function(){return this.$b.get_$13().get_$3tu()},get_$6SA:function(){return"RemindersNotificationView"},get_$1jC:function(){return this.$Nv.$FD.get_$C()},get_$A1K:function(){return!0},get_$9iC:function(){return!0},get_$YK:function(){return this.$Oo},set_$YK:function(n){if(n===this.$Oo)return n;this.$Oo=n;var t=this.$b.get_$13();n?t.$Y("EnableReminders",this.$$d_$9QQ):t.$q("EnableReminders",this.$$d_$9QQ);return n},$8DW:function(){this.$5GH=!0;if(this.$40Z){this.$40Z=!1;$1Ky(this)}},$6MW:function(n){$73w(this)},$17X:function(n,t){this.$6ff=this.$Nv.$FD.get_$C()>0;$L8(this,"ShowNotificationInTray","NotificationCount","IconTitleText");(!t.$2Z||t.$2Z===4)&&this.get_$1JX()&&(this.$5GH?$1Ky(this):this.$40Z=!0)},$9QQ:function(n,t){$L8(this,"ShowNotificationInTray","NotificationCount","IconTitleText");this.get_$1JX()&&$1Ky(this)},$49:function(){this.$J.$11q(_a.$D5,this.$$d_$1Ti);this.set_$YK(!1);_a.$1.prototype.$49.call(this)},$1Ti:function(n){this.set_$YK(n.$9k)}};_d.$ub=function(n){this.$$d_$9wo=Function.createDelegate(this,this.$9wo);this.$$d_$87u=Function.createDelegate(this,this.$87u);this.$$d_$85s=Function.createDelegate(this,this.$85s);this.$$d_$7sO=Function.createDelegate(this,this.$7sO);this.$$d_$2wQ=Function.createDelegate(this,this.$2wQ);_d.$ub.resolveInheritance();this.apcl=this.$Y;this.rpcl=this.$q;_d.$ub.initializeBase(this);this.$1T0=n;this.$DS=new _c.$12R;this.$2wR=new _C(this.$$d_$2wQ,_a.$0.$5o);this.$5Pm=new _C(this.$$d_$7sO,_a.$0.$5o);$4tH(this.$1T0,this);_js.$J.get_$I().$40(_a.$0.$5o,"UserOofNotificationProvider::ctor",this.$$d_$85s)};_d.$ub.prototype={$DS:null,$2wR:null,$5Pm:null,$1T0:null,get_$40p:function(){return _nbs.NonBootStrings.l_OofNotificationHeader_Text},get_$A7x:function(){return this.$DS.$21G&&this.$DS.$8Q?String.format(_nbs.NonBootStrings.l_OofScheduledUntilXNotificationTitle_Text,this.$DS.$8Q):_nbs.NonBootStrings.l_UnscheduledOofNotificationTitle_Text},get_$A5E:function(){return _nbs.NonBootStrings.l_UnscheduledOofNotificationSubTitle_Text},get_$7dm:function(){return _u.Strings.l_Yes_Text},get_$7dl:function(){return this.$5Pm},get_$7do:function(){return _u.Strings.l_No_Text},get_$7dn:function(){return this.$2wR},$85s:function(){var n=new _c.$xU(this.$DS);n.add_$29(this.$$d_$87u);OwaApplication.$1W.$11(n)},$87u:function(n){this.$DS.$s9&&$4tJ(this.$1T0,this)},$2wQ:function(){$4tI(this.$1T0,this)},$7sO:function(){this.$2wQ();this.$DS.set_$20i(!1);var n=new _c.$11R(this.$DS);n.add_$21(this.$$d_$9wo);OwaApplication.$1W.$11(n)},$9wo:function(n){_a.$4Y.$2u(_nbs.NonBootStrings.l_SetUserOOFSettingsError_Text,0)}};_d.$OO=function(n,t,i,r,u){this.$$d_$A0c=Function.createDelegate(this,this.$A0c);_d.$OO.initializeBase(this,[n,t,i]);this.set_$ax(!1);this.set_$1eV(!0);this.set_$20Q(!1);this.set_$9fD(r);this.$6M=u;this.$LI=new _C(this.$$d_$A0c,_d.$OO.$A)};_d.$OO.$E=function(n,t,i,r,u){_a.$3.$m(n,"owaShell");return new _d.$OO(n,t,i,r,u)};_d.$OO.prototype={$17p:null,$6P8:null,$6M:null,$LI:null,$7m3:function(){return null},$7o2:function(){return null},$5Ku:function(){return{}},get_$9fD:function(){return this.$17p},set_$9fD:function(n){this.$17p=n;this.$6P8=this.$17p.$3xg();return n},$1aU:function(){var n=[new _y.$2Q(_y.$d.get_$12L(),_y.$d.get_$1B0(),_nbs.NonBootStrings.l_ButtonBack_Text,new _C(this.$$d_$9J,_d.$OO.$A))];return _y.$22.$Aj(this,n,null)},$A0c:function(){this.$6M.$TS(this.$6P8)}};_d.$KL=function(n,t,i,r,u,f){this.$$d_$A1z=Function.createDelegate(this,this.$A1z);this.$$d_$A16=Function.createDelegate(this,this.$A16);this.$$d_$A1b=Function.createDelegate(this,this.$A1b);this.$$d_$A1a=Function.createDelegate(this,this.$A1a);_d.$KL.initializeBase(this,[n,t,i]);this.set_$ax(!1);this.set_$1eV(!0);this.set_$20Q(!1);this.$1A=f;this.$6M=u;this.$5Hg=new _C(this.$$d_$A1a,_a.$0.$GG);this.$5Hh=new _C(this.$$d_$A1b,_a.$0.$GG);this.$5Hf=new _C(this.$$d_$A16,_a.$0.$GG);this.$5Hi=new _C(this.$$d_$A1z,_a.$0.$GG);this.get_$WH()&&r&&(this.$3L=r.$3L)};_d.$KL.$E=function(n,t,i,r,u,f){_a.$3.$m(n,"owaShell");return new _d.$KL(n,t,i,r,u,f)};_d.$KL.prototype={$3L:null,$6M:null,$1A:null,$5Hf:null,$5Hh:null,$5Hi:null,$5Hg:null,get_$WH:function(){return _g.$V.get_$I().get_$2z().get_$WH()},get_$6TJ:function(){return this.$1A.get_$6n()?null:this.$3L?this.$3L.get_$18H().get_$6p():"http://go.microsoft.com/fwlink/p/?LinkId=260597"},get_$6jx:function(){return this.$1A.get_$Hp()&&this.$1A.get_$6n()?"http://go.microsoft.com/fwlink/?LinkId=299663":this.$1A.get_$2TT()&&this.$1A.get_$6n()?"http://go.microsoft.com/fwlink/?LinkId=301830":null},get_$18H:function(){return this.$1A.get_$Hp()&&this.$1A.get_$6n()?"http://go.microsoft.com/fwlink/?LinkId=299665":this.$1A.get_$2TT()&&this.$1A.get_$6n()?"http://go.microsoft.com/fwlink/?LinkId=301831":null},get_$6k5:function(){return this.$1A.get_$Hp()&&this.$1A.get_$6n()?"http://go.microsoft.com/fwlink/?LinkId=299664":null},$9pd:function(n){n.set_$1fB(!1);n.set_$1fC(!0)},$1aU:function(){var n=[new _y.$2Q(_y.$d.get_$12L(),_y.$d.get_$1B0(),_nbs.NonBootStrings.l_ButtonBack_Text,new _C(this.$$d_$9J,_d.$KL.$A))];return _y.$22.$Aj(this,n,null)},$7m3:function(){return null},$7o2:function(){return null},$5Ku:function(){return{}},$A1a:function(){this.$6M.$TS(this.get_$6TJ())},$A1b:function(){this.$6M.$TS(this.get_$18H())},$A16:function(){this.$6M.$TS(this.get_$6jx())},$A1z:function(){this.$6M.$TS(this.get_$6k5())}};_d.$LR=function(n,t,i){this.$$d_$5Fr=Function.createDelegate(this,this.$5Fr);this.$$d_$5J6=Function.createDelegate(this,this.$5J6);_d.$LR.initializeBase(this,[n,t,i]);this.$DS=new _c.$12R;this.set_$K1(this.$DS);var r=new _js.$c;r.$D(new _a.$2E(new _C(this.$$d_$5J6,_d.$LR.$A),_nbs.NonBootStrings.l_ConfirmDialog_Save_Text,null));r.$D(new _a.$2E(new _C(this.$$d_$5Fr,_d.$LR.$A),_u.Strings.l_ConfirmDialog_Cancel_Text,null));this.set_$6P6(r)};_d.$LR.$E=function(n,t,i){_a.$3.$m(n,"owaShell");return new _d.$LR(n,t,i)};_d.$LR.prototype={$s9:!1,$2Md:!1,$2dd:0,$2MW:null,$2MV:null,$DS:null,$20R:!1,$1Tp:null,$1QF:!1,get_$5jZ:function(){return this.$20R},set_$5jZ:function(n){if(this.$20R!==n){this.$20R=n;$3(this,"IsLoadingFinished")}return n},get_$20i:function(){return this.$s9},set_$20i:function(n){if(this.$s9===n)return n;this.$s9=n;$3(this,"IsOofOn");return n},get_$2xT:function(){return this.$2Md},set_$2xT:function(n){if(this.$2Md===n)return n;this.$2Md=n;$3(this,"EnableExternalReply");return n},get_$3Ok:function(){return this.$2dd},set_$3Ok:function(n){if(this.$2dd===n)return n;this.$2dd=n;$3(this,"ReplyToExternalPeopleType");return n},get_$3tQ:function(){return this.$2MW},set_$3tQ:function(n){if(this.$2MW===n)return n;this.$2MW=n;$3(this,"EditorInternalReplyMessage");return n},get_$3tP:function(){return this.$2MV},set_$3tP:function(n){if(this.$2MV===n)return n;this.$2MV=n;$3(this,"EditorExternalReplyMessage");return n},get_$6P6:function(){return this.$1Tp},set_$6P6:function(n){if(n!==this.$1Tp){this.$1Tp=n;$3(this,"OverwriteScheduleConfirmDialogButtonData")}return n},get_$1ek:function(){return this.$1QF},set_$1ek:function(n){if(n!==this.$1QF){this.$1QF=n;$3(this,"IsOverwriteScheduleConfirmDialogShown")}return n},get_$7hL:function(){return this.$DS.$21G&&!this.get_$1Qf()?_nbs.NonBootStrings.l_OverwriteOofScheduleSettingConfirmMessageWhenCloseOptionWithoutSave_Text:_d.$F1.prototype.get_$7hL.call(this)},get_$6j2:function(){return"Oof"},$2as:function(){this.set_$20i(!1);this.set_$3tQ("");this.set_$3tP("");this.$3P4();_d.$F1.prototype.$2as.call(this)},$BS:function(n){this.$DS.$21G?n&&!this.get_$1Qf()?this.$3st():this.set_$1ek(!0):this.$3st()},$7m3:function(){return new _c.$xU(this.$DS)},$7o2:function(){return new _c.$11R(this.$DS)},$5Ku:function(){var n={};n.IsOofOn=!0;n.EnableExternalReply=!0;n.ReplyToExternalPeopleType=!0;n.EditorInternalReplyMessage=!0;n.EditorExternalReplyMessage=!0;return n},$1HS:function(n){switch(this.$DS.$2N2){case 2:this.set_$2xT(!0);this.set_$3Ok(2);break;case 1:this.set_$2xT(!0);this.set_$3Ok(1);break;default:this.set_$2xT(!1);this.set_$3Ok(2);break}this.set_$20i(this.$DS.$s9);this.set_$3tQ(this.$DS.$2Qw);this.set_$3tP(this.$DS.$2N3);this.set_$5jZ(!0);_d.$F1.prototype.$1HS.call(this,n)},$1jv:function(n){this.set_$1WR(this.$s9);_d.$F1.prototype.$1jv.call(this,n)},$7ja:function(n){return n?_nbs.NonBootStrings.l_OofOn_Text:_nbs.NonBootStrings.l_OofOff_Text},$5J6:function(){this.set_$1ek(!1);this.$3st()},$5Fr:function(){this.set_$1ek(!1)},$3st:function(){this.$DS.set_$20i(this.$s9);this.$2Md?this.$DS.set_$3v1(this.$2dd):this.$DS.set_$3v1(0);this.$DS.set_$5gD(this.$2MW);this.$DS.set_$5T7(this.$2MV);_d.$F1.prototype.$BS.call(this,!1);this.$DS.set_$5lW(!1)}};_d.$Mq=function(n,t,i,r){this.$$d_$1HS=Function.createDelegate(this,this.$1HS);this.$$d_$5Fr=Function.createDelegate(this,this.$5Fr);this.$$d_$5J6=Function.createDelegate(this,this.$5J6);_d.$Mq.initializeBase(this,[n,t,r]);this.$wp=new _c.$14b;this.set_$K1(this.$wp);var u=new _js.$c;u.$D(new _a.$2E(new _C(this.$$d_$5J6,_d.$Mq.$A),_nbs.NonBootStrings.l_ConfirmDialog_Save_Text,null));u.$D(new _a.$2E(new _C(this.$$d_$5Fr,_d.$Mq.$A),_u.Strings.l_ConfirmDialog_Cancel_Text,null));this.$1YF=i;var f=this.$7m3();f.add_$29(this.$$d_$1HS);f.add_$21(this.$$d_$9RY);OwaApplication.$1W.$11(f);this.set_$6P6(u)};_d.$Mq.$E=function(n,t,i,r){_a.$3.$m(n,"owaShell");return new _d.$Mq(n,t,i.get_$w4(),r)};_d.$Mq.prototype={$jo:!1,$wp:null,$20R:!1,$1Tp:null,$1QF:!1,$1YF:null,get_$37b:function(){return this.$jo},set_$37b:function(n){if(this.$jo===n)return n;this.$jo=n;$3(this,"IsSyncContactsToDeviceEnabled");return n},get_$5jZ:function(){return this.$20R},set_$5jZ:function(n){if(this.$20R!==n){this.$20R=n;$3(this,"IsLoadingFinished")}return n},get_$6P6:function(){return this.$1Tp},set_$6P6:function(n){if(n!==this.$1Tp){this.$1Tp=n;$3(this,"OverwriteScheduleConfirmDialogButtonData")}return n},get_$1ek:function(){return this.$1QF},set_$1ek:function(n){if(n!==this.$1QF){this.$1QF=n;$3(this,"IsOverwriteScheduleConfirmDialogShown")}return n},get_$6j2:function(){return null},get_$9ui:function(){return _nbs.NonBootStrings.l_OptionContactSyncFail_Text},$2as:function(){this.$jo=!1;this.$3P4();_d.$F1.prototype.$2as.call(this)},$BS:function(n){this.$wp.set_$37b(this.$jo);_d.$F1.prototype.$BS.call(this,n)},$7m3:function(){return new _c.$177(this.$wp,this.$1YF)},$7o2:function(){return new _c.$1ER(this.$wp,this.$1YF)},$5Ku:function(){var n={};n.IsSyncContactsToDeviceEnabled=!0;return n},$1HS:function(n){this.set_$37b(this.$wp.$jo);this.set_$1WR(this.$jo);this.set_$5jZ(!0);_d.$F1.prototype.$1HS.call(this,n)},$1jv:function(n){this.set_$1WR(this.$wp.$jo);_d.$F1.prototype.$1jv.call(this,n)},$7ja:function(n){return n?_nbs.NonBootStrings.l_OofOn_Text:_nbs.NonBootStrings.l_OofOff_Text},$9pd:function(n){this.set_$1WR(this.$jo);n.set_$1fB(!1);n.set_$1fC(!0)},$5J6:function(){this.set_$1ek(!1);this.$BS(!1)},$5Fr:function(){this.set_$1ek(!1)}};_d.$s8=function(n,t,i){_d.$s8.initializeBase(this);_a.$3.$m(n,"saveAndNavigateAwayCommand");_a.$3.$m(t,"dontSaveAndNavigateAwayCommand");_a.$3.$m(i,"cancelCommand");this.$6ZE=n;this.$5QO=t;this.$7I=i};function $744(n){if($5(n.$wc)){var t=new _js.$c;t.$D(new _a.$2E(n.$6ZE,_nbs.NonBootStrings.l_ConfirmDialog_Save_Text,null));t.$D(new _a.$2E(n.$5QO,_u.Strings.l_ConfirmDialog_Discard_Text,null));t.$D(new _a.$2E(n.$7I,_u.Strings.l_ConfirmDialog_Cancel_Text,null));n.set_$5Hy(t)}}_d.$s8.prototype={$6ZE:null,$5QO:null,$7I:null,$wc:null,$15K:!1,get_$5Hy:function(){return this.$wc},set_$5Hy:function(n){if(n!==this.$wc){this.$wc=n;$N(this,"CloseConfirmDialogButtonData")}return n},get_$1e7:function(){return this.$15K},set_$1e7:function(n){if(n!==this.$15K){this.$15K=n;$N(this,"IsCloseConfirmDialogShown")}return n},$VM:function(){$744(this);this.set_$1e7(!0)},$d1:function(){this.set_$1e7(!1)}};_d.$F1=function(n,t,i){this.$$d_$6Hv=Function.createDelegate(this,this.$6Hv);this.$$d_$1HS=Function.createDelegate(this,this.$1HS);this.$$d_$9RX=Function.createDelegate(this,this.$9RX);this.$$d_$9bN=Function.createDelegate(this,this.$9bN);this.$$d_$1jv=Function.createDelegate(this,this.$1jv);this.$$d_$4Y4=Function.createDelegate(this,this.$4Y4);this.$$d_$1iv=Function.createDelegate(this,this.$1iv);this.$$d_$9Wx=Function.createDelegate(this,this.$9Wx);this.$$d_$7ex=Function.createDelegate(this,this.$7ex);this.$$d_$2wn=Function.createDelegate(this,this.$2wn);this.$$d_$3Pz=Function.createDelegate(this,this.$3Pz);this.$$d_$9RY=Function.createDelegate(this,this.$9RY);this.$$d_$9J=Function.createDelegate(this,this.$9J);_d.$F1.initializeBase(this);_a.$3.$m(n,"owaShell");this.$B=n;this.$7K=t;this.$J_5=i;this.$1a1=new _d.$s8(new _C(this.$$d_$3Pz,_d.$F1.$A),new _C(this.$$d_$2wn,_d.$F1.$A),new _C(this.$$d_$7ex,_d.$F1.$A));this.$e3=new _y.$Fj;this.$1v=new _y.$4p;this.add_$83(this.$$d_$9Wx);if(this.$B.get_$L()==="TouchNarrow"){this.set_$6k(this.$1aU());this.add_$4aA(this.$$d_$1iv)}this.$DO=new _C(this.$$d_$4Y4,_d.$F1.$A)};_d.$F1.$7sD=function(n,t){if(!$5(n.$QM))for(var e=n.$QM,c=e.length,i=0;i<c;++i){var l=e[i];l.get_$PX().set_$69(!t)}if(!$5(n.$R6))for(var o=n.$R6,a=o.length,r=0;r<a;++r){var v=o[r];v.get_$PX().set_$69(!t)}if(!$5(n.$PW))for(var s=n.$PW,y=s.length,u=0;u<y;++u){var p=s[u];p.get_$PX().set_$69(!t)}$5(n.$102)||n.$102.get_$PX().set_$69(!t);if(!$5(n.$14))for(var h=n.$14,w=h.length,f=0;f<w;++f){var b=h[f];b.get_$PX().set_$69(!t)}};function $745(n){if(!$5(n.$Ma_5)){n.$Ma_5.remove_$2t(n.$$d_$9RX);n.$Ma_5.remove_$29(n.$$d_$1HS);n.$Ma_5.remove_$21(n.$$d_$9RY)}n.get_$1Qf()&&n.remove_$27M(n.$$d_$6Hv);n.set_$1eV(!1);n.set_$20Q(!1);n.set_$ax(!1)}function $746(n){n.set_$Aq(!1);$6J(n,"ValidationOnSaveFailed")}_d.$F1.prototype={$B:null,$1a1:null,$7K:null,$4f:null,$2Lr:null,$6j3:null,$19O:null,$Ma_5:null,$1mm:null,$2I:null,$CN:!1,$463:!1,$360:!1,$Cd:!1,$43l:!1,$e3:null,$DO:null,$1v:null,$J_5:null,$3lS:null,add_$4O9:function(n){this.$2G("OnBack",n)},remove_$4O9:function(n){this.$2H("OnBack",n)},add_$27M:function(n){this.$2G("OnBusy",n)},remove_$27M:function(n){this.$2H("OnBusy",n)},add_$4aA:function(n){this.$2G("SetActionSuccess",n)},remove_$4aA:function(n){this.$2H("SetActionSuccess",n)},add_$6cH:function(n){this.$2G("SetActionFailure",n)},remove_$6cH:function(n){this.$2H("SetActionFailure",n)},add_$6oy:function(n){this.$2G("ValidationOnSaveFailed",n)},remove_$6oy:function(n){this.$2H("ValidationOnSaveFailed",n)},get_$7hL:function(){return _nbs.NonBootStrings.l_ConfirmMessageWhenCloseOptionWithoutSave_Text},get_$9ui:function(){return _u.Strings.l_SaveOptionFailureMessage_Text},get_$6j2:function(){return null},get_$1nk:function(){return this.$19O},set_$1nk:function(n){this.$19O=n;$3(this,"Summary");return n},get_$1WR:function(){return this.$6j3},set_$1WR:function(n){this.$6j3=n;this.set_$1nk(this.$7ja(n));$3(this,"SummaryRaw");return n},get_$1kp:function(){return 1},get_$2PH:function(){return null},get_$7sU:function(){return!0},get_$7c:function(){return this.$4f},set_$7c:function(n){this.$4f=n;return n},get_$5gx:function(){return this.$43l},get_$1Qf:function(){return this.$B.get_$L()==="TouchNarrow"},get_$ax:function(){return this.$CN},set_$ax:function(n){this.$CN=n;$6J(this,"OnBusy");return n},get_$1eV:function(){return this.$463},set_$1eV:function(n){this.$463=n;$3(this,"IsLoadSucceeded");return n},get_$20Q:function(){return this.$360},set_$20Q:function(n){this.$360=n;$3(this,"IsLoadFailed");return n},get_$Aq:function(){return this.$Cd},set_$Aq:function(n){this.$Cd=n;$6J(this,"OnBusy");return n},get_$Fv:function(){return this.$CN?_u.Strings.l_LoadingOption_Text:this.$Cd?_nbs.NonBootStrings.l_SavingOption_Text:""},get_$6D:function(){return this.$CN||this.$Cd},get_$ux:function(){return this.get_$1Qf()?this.get_$6D():!1},get_$KN:function(){return 1},get_$K1:function(){return this.$2I},set_$K1:function(n){this.$2I=n;return n},$9Wx:function(n,t){if(!$5(this.$2Lr)&&!$5(this.$2Lr[t])){this.$43l=!0;this.$2Lr[t]=!0}},$3P4:function(){this.$43l=!1},$7C:function(){this.$B.$7C(this)},$4Y4:function(){this.$BS(!1)},$BS:function(n){if(!this.$Cd&&!this.$360){if(!$5(this.$1mm)){this.$1mm.remove_$29(this.$$d_$1jv);this.$1mm.remove_$21(this.$$d_$9bN)}this.$1mm=this.$7o2();this.$1mm.add_$29(this.$$d_$1jv);this.$1mm.add_$21(this.$$d_$9bN);this.set_$Aq(!0);OwaApplication.$1W.$11(this.$1mm)}},$2as:function(){if(!$5(this.$Ma_5)){this.$Ma_5.remove_$2t(this.$$d_$9RX);this.$Ma_5.remove_$29(this.$$d_$1HS);this.$Ma_5.remove_$21(this.$$d_$9RY)}this.get_$1Qf()&&this.add_$27M(this.$$d_$6Hv);this.$Ma_5=this.$7m3();if(this.$Ma_5){this.$Ma_5.add_$2t(this.$$d_$9RX);this.$Ma_5.add_$29(this.$$d_$1HS);this.$Ma_5.add_$21(this.$$d_$9RY);this.set_$1eV(!1);this.set_$20Q(!1);this.set_$ax(!0);OwaApplication.$1W.$11(this.$Ma_5)}},$9pd:function(n){},$3J4:function(){this.$CN&&$745(this);$6J(this,"OnBack")},$1HS:function(n){this.$2Lr=this.$5Ku();this.set_$ax(!1);this.set_$1eV(!0);this.set_$20Q(!1);$6J(this,"GetActionSuccess")},$9RY:function(n){this.$2Lr=this.$5Ku();this.set_$ax(!1);this.set_$1eV(!1);this.set_$20Q(!0);$6J(this,"GetActionFailure")},$1jv:function(n){this.set_$Aq(!1);this.$3P4();this.$B.get_$L()==="TouchNarrow"&&this.$1iv();$6J(this,"SetActionSuccess")},$9bN:function(n){this.set_$Aq(!1);var t=this;this.$1JR(this.get_$9ui(),function(n,i){$6J(t,"SetActionFailure")})},$1JR:function(n,t){this.$1v.$2u(0,n,t,!1,null,null,_nbs.NonBootStrings.l_OptionActionErrorDialogTitle_Text)},$7ja:function(n){return n},$9RX:function(n){this.$3P4()},$1aU:function(){this.$3lS=new _y.$2Q(_y.$d.get_$9J(),_y.$d.get_$LH(),_nbs.NonBootStrings.l_CancelItemMobile_Text,new _C(this.$$d_$9J,_d.$F1.$A),null,_u.Strings.l_CancelItemMobileAria_Text);var n=[new _y.$2Q(_y.$d.get_$BS(),_y.$d.get_$1Iy(),_nbs.NonBootStrings.l_SaveItemMobile_Text,new _C(this.$$d_$4Y4,_d.$F1.$A),null,_u.Strings.l_SaveItemMobileAria_Text),this.$3lS];return _y.$22.$Aj(this,n,null)},$9J:function(){this.get_$5gx()?this.$1a1.$VM():this.$1iv()},$3Pz:function(){this.$1a1.$d1();this.$4Y4()},$2wn:function(){this.$1a1.$d1();this.$1iv()},$7ex:function(){this.$1a1.$d1()},$1iv:function(){this.get_$1Qf()&&this.remove_$27M(this.$$d_$6Hv);this.$3J4();$5(this.get_$7c())||this.get_$7c()()},$6Hv:function(){_d.$F1.$7sD(this.$3y,this.get_$ux());this.$CN&&this.$3lS.get_$PX().set_$69(!0);$3(this,"BusyText");$3(this,"ShowActivityIndicator")}};_d.$LS=function(n,t,i){this.$$d_$8Rd=Function.createDelegate(this,this.$8Rd);this.$$d_$8Re=Function.createDelegate(this,this.$8Re);this.$$d_$39I=Function.createDelegate(this,this.$39I);_d.$LS.initializeBase(this);_a.$3.$K(t,"listViewItemsFactory");this.$5p2=t;this.$J=n;this.$5mK=i};function $747(n){for(var i=n.$5p2.$7nC(n.$J),t=0;t<i.get_$C();t++)n.get_$3O().$D(i.get_$3o(t))}_d.$LS.prototype={$2I:null,$1FA:null,$J:null,$5p2:null,$5mK:!1,get_$Uk:function(){return this.$W(_d.$LS.$49Q)},set_$Uk:function(n){this.$M(_d.$LS.$49Q,n);return n},$41:function(n,t){_a.$3.$m(n,"onSelectItemChangedHandler");this.set_$2I9(t?1:0);this.add_$6ac(n);$747(this)},$8Rs:function(){if(this.get_$3O().get_$C()>0&&!this.get_$3O().get_$3o(0).$361){for(var n=0;n<this.get_$3O().get_$C();n++){this.get_$3O().get_$3o(n).set_$5jd(!0);this.get_$3O().get_$3o(n).set_$1fC(!1);this.get_$3O().get_$3o(n).set_$1fB(!1)}if(!$5(this.$1FA)){this.$1FA.remove_$2t(this.$$d_$39I);this.$1FA.remove_$29(this.$$d_$8Re);this.$1FA.remove_$21(this.$$d_$8Rd)}this.$2I=new _c.$1Bu;this.$1FA=new _c.$17Z(this.$2I);this.$1FA.add_$2t(this.$$d_$39I);this.$1FA.add_$29(this.$$d_$8Re);this.$1FA.add_$21(this.$$d_$8Rd);OwaApplication.$1W.$11(this.$1FA)}},$5MJ:function(n){return null},$39I:function(n){for(var t=0;t<this.get_$3O().get_$C();t++){var i=this.get_$3O().get_$3o(t);i.set_$5jd(!1)}},$8Re:function(n){for(var i=0;i<this.get_$3O().get_$C();i++){var t=this.get_$3O().get_$3o(i);if(!$5(t.get_$Rx().get_$6j2())){var r=this.$2I.$19O[t.get_$Rx().get_$6j2()];t.get_$Rx().set_$1WR(r)}t.set_$1fB(!1);t.set_$1fC(!0)}},$8Rd:function(n){for(var i=0;i<this.get_$3O().get_$C();i++){var t=this.get_$3O().get_$3o(i);t.set_$1fB(!0);t.set_$1fC(!1);t.get_$Rx().$9pd(t)}}};_d.$KM=function(n,t){_d.$KM.initializeBase(this);_a.$3.$K(n,"text");_a.$3.$K(t,"optionPageCreator");this.$2E=n;this.$6OW=t};_d.$KM.prototype={$2E:null,$6OW:null,$4Qp:null,$361:!1,$47s:!1,$47r:!1,get_$Rx:function(){this.$4Qp||(this.$4Qp=this.$6OW());return this.$4Qp},get_$5jd:function(){return this.$361},set_$5jd:function(n){this.$361=n;$3(this,"IsLoadingSummary");return n},get_$1fC:function(){return this.$47s},set_$1fC:function(n){this.$47s=n;$3(this,"IsSummaryLoadSucceeded");return n},get_$1fB:function(){return this.$47r},set_$1fB:function(n){this.$47r=n;$3(this,"IsSummaryLoadFailed");return n}};_d.$zu=function(n,t){this.$$d_$6Mv=Function.createDelegate(this,this.$6Mv);_d.$zu.initializeBase(this);this.$J=n;this.$Hx=new _d.$LS(this.$J,t,this.get_$9yv());this.$Hx.$41(this.$$d_$6Mv,!1)};_d.$zu.prototype={$Hx:null,$J:null,get_$KN:function(){return 1},get_$9yv:function(){return!1},$FZ:function(){_y.$1Mq.prototype.$FZ.call(this);this.$Hx.$5m();this.$Hx.$8Rs()}};_d.$9b=function(n,t,i,r,u){this.$$d_$6Hv=Function.createDelegate(this,this.$6Hv);this.$$d_$AF8=Function.createDelegate(this,this.$AF8);this.$$d_$1iv=Function.createDelegate(this,this.$1iv);this.$$d_$8C2=Function.createDelegate(this,this.$8C2);this.$$d_$9Ns=Function.createDelegate(this,this.$9Ns);_d.$9b.initializeBase(this,[n,t]);this.$1A=u;this.$c=i;this.$3Hk=r;this.$34J=!1;$748(this);this.get_$2UI().$N9(this.$Hx)};function $748(n){if(n.get_$43w()){n.set_$6k(_y.$22.$Aj(n,null,null));n.$3y.set_$4bh(!0);n.$3y.$i2(new _y.$2Q(_y.$d.get_$wa(),_y.$d.get_$wa(),_nbs.NonBootStrings.l_SaveItemMobile_Text,n.get_$5Df()),0)}}function $4sN(n,t){if(t.get_$5gx()){_js.Trace.logInfo(_d.$9b.$A,"Found the options vm dirty so saving before exit.");$749(n)}else{_js.Trace.logInfo(_d.$9b.$A,"Navigating away without saving.");n.$1iv()}}function $749(n){var t=n.$Hx.get_$Uk().get_$Rx();t.add_$4aA(n.$$d_$1iv);t.add_$6cH(n.$$d_$1iv);t.add_$6oy(n.$$d_$AF8);t.$BS(!0)}function $4sO(n,t){if(!$5(n.$Hx.get_$Uk())){t&&n.$Hx.get_$Uk().get_$Rx().$3J4();n.$Hx.get_$Uk().get_$Rx().remove_$4aA(n.$$d_$1iv);n.$Hx.get_$Uk().get_$Rx().remove_$6cH(n.$$d_$1iv);n.$Hx.get_$Uk().get_$Rx().remove_$27M(n.$$d_$6Hv);n.$Hx.get_$Uk().get_$Rx().remove_$6oy(n.$$d_$AF8)}}_d.$9b.prototype={$jw:null,$4Qq:null,$Pn:null,$3q4:0,$119:null,$DC:null,$c:null,$34J:!1,$3Hk:null,$1A:null,get_$5Df:function(){$5(this.$Pn)&&(this.$Pn=new _C(this.$$d_$9Ns,_d.$9b.$A));return this.$Pn},get_$4Qr:function(){this.$4Qq||(this.$4Qq=new _y.$FO);return this.$4Qq},get_$2UI:function(){this.$jw||(this.$jw=new _y.$FO);return this.$jw},get_$6D:function(){return $5(this.$Hx.get_$Uk())?!1:this.$Hx.get_$Uk().get_$Rx().get_$6D()},get_$Fv:function(){return $5(this.$Hx.get_$Uk())?"":this.$Hx.get_$Uk().get_$Rx().get_$Fv()},get_$43w:function(){return!this.$c.$5i(this.$c.get_$4a())||!this.$c.get_$4a().get_$92().get_$2Zf()},get_$9yv:function(){return!0},$e6:function(){_y.$1Mq.prototype.$e6.call(this);if(this.$3Hk){this.$3Hk.set_$2o0(!0);this.$3Hk.$2cg(!0,null,null,null,null)}},$FZ:function(){_d.$zu.prototype.$FZ.call(this);this.$Hx.set_$1p(this.$Hx.get_$3O().get_$3o(0))},get_$1kp:function(){return this.$1A.get_$Hp()?1:4},get_$2PH:function(){return this.$$d_$8C2},get_$7c:function(){return this.$DC},set_$7c:function(n){this.$DC=n;return n},get_$7sU:function(){return!0},$8C2:function(n,t){_js.Trace.logInfo(_d.$9b.$A,"HandlePopupPanelClosing with reason = {0}",t);if(!t){this.$5I6();return!0}return!1},get_$KN:function(){return this.get_$43w()?_d.$zu.prototype.get_$KN.call(this):0},$6Mv:function(n,t){_js.Trace.logInfo(_d.$9b.$A,"OnSelectedOptionChanged {0}",t);var i=n;if(!$5(this.$Hx.get_$1p())){this.$119=i.get_$1p();this.$3q4=0;if($5(this.$Hx.get_$Uk()))this.$1iv();else if(this.$Hx.get_$Uk()!==this.$Hx.get_$1p()){var r=this.$Hx.get_$Uk().get_$Rx();$4sN(this,r)}}},$5I6:function(){_js.Trace.logInfo(_d.$9b.$A,"CloseOptionPagePopup");this.$3q4=1;this.$119=this.$Hx.get_$1p();var n=this.$119.get_$Rx();$4sN(this,n)},$9Ns:function(){this.$34J=!0;this.$5I6()},$AF8:function(){$4sO(this,!1);this.$Hx.set_$1p(this.$Hx.get_$Uk())},$1iv:function(){_js.Trace.logInfo(_d.$9b.$A,"NavigateAway");$4sO(this,!0);this.$Hx.set_$Uk(this.$119);switch(this.$3q4){case 1:this.$Hx.set_$Uk(null);this.$Hx.set_$1p(null);$5(this.$119)&&this.$119.get_$Rx().remove_$27M(this.$$d_$6Hv);this.$119=null;this.get_$7c()();this.$c.$5i(this.$c.get_$4a())&&this.$c.get_$4a().get_$92().get_$2Zf()&&this.$34J&&this.$c.get_$4a().$A1t();this.$34J=!1;break;case 0:this.get_$4Qr().get_$7T()!==this.$119.get_$Rx()&&this.get_$4Qr().$N9(this.$119.get_$Rx());this.$119.get_$Rx().add_$27M(this.$$d_$6Hv);this.$119.get_$Rx().$2as();break;default:break}},$6Hv:function(){_js.Trace.logInfo(_d.$9b.$A,"OnBusy");$3(this,"BusyText");$3(this,"IsBusy")}};_d.$zt=function(n,t){this.$$d_$9MH=Function.createDelegate(this,this.$9MH);_d.$zt.initializeBase(this,[n,t]);this.set_$6k(_y.$22.$E(this))};_d.$zt.prototype={$9MH:function(){this.$Hx.get_$1p().get_$Rx().remove_$4O9(this.$$d_$9MH);this.$Hx.set_$1p(null)},$6Mv:function(n,t){var r=n;if(r.get_$1p()){var u=r.get_$1p();var i=u.get_$Rx();i.add_$4O9(this.$$d_$9MH);i.$7C();i.$2as()}}};_d.$Uw=function(n,t,i){this.$$d_$9ep=Function.createDelegate(this,this.$9ep);this.$2ui=-1;_d.$Uw.initializeBase(this,[n,t,i]);this.$2Dg=new _c.$1Ga;this.set_$K1(this.$2Dg);this.add_$4O9(this.$$d_$9ep)};_d.$Uw.$E=function(n,t,i){_a.$3.$m(n,"owaShell");return new _d.$Uw(n,t,i)};_d.$Uw.prototype={$pl:null,$1CI:null,$2Di:!1,$2Dg:null,get_$6j2:function(){return"TimeZone"},get_$A7t:function(){return this.$pl},set_$A7t:function(n){this.$pl=n;$3(this,"TimeZoneList");return n},get_$3qI:function(){return this.$1CI},set_$3qI:function(n){this.set_$3qJ(this.$pl.$79(n));if(this.$1CI===n)return n;this.$1CI=n;$3(this,"CurrentTimeZone");return n},get_$3qJ:function(){return this.$2ui},set_$3qJ:function(n){this.$2ui=n;$3(this,"CurrentTimeZoneIndex");return n},get_$4gG:function(){return this.$2Di},set_$4gG:function(n){this.$2Di=n;$3(this,"TimeZoneReloaded");return n},$7m3:function(){return new _c.$17z(this.$2Dg)},$7o2:function(){return new _c.$1El(this.$2Dg,this.$1CI.$3Z)},$5Ku:function(){var n={};n.CurrentTimeZone=!0;return n},$1HS:function(n){this.set_$1eV(!0);if($5(this.$pl)||!this.$pl.get_$C()){for(var r=new _js.$c,u=this.$2Dg.$pl,f=u.length,i=0;i<f;++i){var e=u[i];r.$D(new _d.$Zj(e))}this.set_$A7t(r)}for(var t=0;t<this.$pl.get_$C();t++)if(this.$pl.get_$3o(t).$3Z===this.$2Dg.$1CI){this.set_$3qI(this.$pl.get_$3o(t));this.set_$4gG(!0)}_d.$F1.prototype.$1HS.call(this,n)},$1jv:function(n){this.set_$1WR(this.$1CI.$5Vj);_d.$F1.prototype.$1jv.call(this,n);var t=new _y.$nd(1);this.$J_5.$9lH(_y.$nd,t)},$9ep:function(){this.set_$3qJ(-1);this.set_$4gG(!1)}};_d.$Zj=function(n){_d.$Zj.initializeBase(this);_a.$3.$K(n,"TimeZoneEntry");this.$5Vj=n.Name;this.$7K=n.Name;var i=new RegExp(_d.$Zj.$6om,"g");var t=i.exec(n.Name);if(t&&t.length>0){this.$2ER=t[0];this.$7K=n.Name.replace(this.$2ER,"").trim();this.$2ER.indexOf("GMT")!==-1&&(this.$2ER=this.$2ER.replace("GMT","UTC"))}this.$3Z=n.Value};_d.$Zj.prototype={$7K:null,$5Vj:null,$2ER:null,$3Z:null};_d.$OM=function(n,t,i){this.$$d_$9Rj=Function.createDelegate(this,this.$9Rj);_d.$OM.initializeBase(this,[n,t,i]);this.$iu=new _g.$15z;this.set_$K1(this.$iu)};_d.$OM.$E=function(n,t,i){_a.$3.$m(n,"owaShell");return new _d.$OM(n,t,i)};function $4sL(n,t,i){if(t){n.$Ma=new _h.$Nm;n.$Ma.add_$29(n.$$d_$9Rj);OwaApplication.$1W.$11(n.$Ma)}else n.set_$1nk(i)}_d.$OM.prototype={$1f9:!1,$2EM:!1,$1bf:null,$2MU:null,$iu:null,$3Qo:0,$Ma:null,get_$5lo:function(){return this.$1f9},set_$5lo:function(n){if(this.$1f9===n)return n;this.$1f9=n;$3(this,"IsSignatureOn");return n},get_$pt:function(){return this.$2EM},set_$pt:function(n){if(this.$2EM===n)return n;this.$2EM=n;$3(this,"UseDesktopSignature");return n},get_$5R3:function(){return this.$1bf},set_$5R3:function(n){if(this.$1bf===n)return n;this.$1bf=n;$3(this,"EditorSignatureMessage");return n},get_$7uk:function(){return this.$2MU},set_$7uk:function(n){if(this.$2MU===n)return n;this.$2MU=n;$3(this,"EditorDesktopSignatureMessage");return n},get_$6aq:function(){return this.$3Qo},set_$6aq:function(n){if(this.$3Qo===n)return n;this.$3Qo=n;this.set_$pt(n===1?!0:!1);$3(this,"SelectedSignatureType");return n},get_$6j2:function(){return"Signature"},get_$36a:function(){return _a.UserAgent.getInstance().get_$6n()},$BS:function(n){this.$iu.set_$wK(this.$1f9);this.$iu.set_$11O(this.$1bf);this.$iu.set_$pt(this.$2EM);_d.$F1.prototype.$BS.call(this,n)},$6XM:function(n){if(this.get_$36a()){var t=_a.$74.$E();var i=t.$3f("MOWA.IsSignatureChanged")==="true"?!0:!1;var r=i?Boolean.parse(t.$3f("MOWA.AutoAddSignature")):!0;var u=i?t.$3f("MOWA.SignatureText"):_c.$K2.$30I(_a.UserAgent.getInstance());var f=i?Boolean.parse(t.$3f("MOWA.UseDesktopSignature")):!1;r?$4sL(this,f,u):this.set_$1nk(_nbs.NonBootStrings.l_EmailSignatureOff_Text)}else n.AutoAddSignature?$4sL(this,n.UseDesktopSignature,n.SignatureText):this.set_$1nk(_nbs.NonBootStrings.l_EmailSignatureOff_Text);return this.$19O},$9pd:function(n){if(this.get_$36a()){this.$6XM(null);n.set_$1fB(!1);n.set_$1fC(!0)}},$7m3:function(){return this.get_$36a()?new _c.$K2(this.$iu):new _c.$17D(this.$iu)},$7o2:function(){return this.get_$36a()?new _c.$gp(this.$iu):new _c.$1ES(this.$iu)},$5Ku:function(){var n={};n.IsSignatureOn=!0;n.UseDesktopSignature=!0;n.EditorSignatureMessage=!0;n.SelectedSignatureType=!0;return n},$1HS:function(n){this.set_$5lo(this.$iu.get_$wK());this.set_$pt(this.$iu.get_$pt());this.set_$5R3(this.$iu.get_$11O());this.set_$7uk(this.$iu.get_$2vk());this.set_$6aq(this.$iu.get_$pt()?1:2);_d.$F1.prototype.$1HS.call(this,n)},$1jv:function(n){this.set_$1nk(this.$1f9?this.$2EM?this.$2MU:this.$1bf:_nbs.NonBootStrings.l_EmailSignatureOff_Text);var t=_g.$V.get_$I().get_$13();t.set_$pt(this.$2EM);t.set_$2qN(this.$1f9);t.set_$3Tb(this.$1bf);_d.$F1.prototype.$1jv.call(this,n)},$7ja:function(n){var t=n;return this.$6XM(t)},$9Rj:function(n){this.set_$1nk(this.$Ma.$b.UserOptions.SignatureText)}};_d.$Ca=function(n,t,i,r,u,f){this.$$d_$9Nl=Function.createDelegate(this,this.$9Nl);this.$$d_$8Kh=Function.createDelegate(this,this.$8Kh);this.$$d_$6ZM=Function.createDelegate(this,this.$6ZM);_d.$Ca.initializeBase(this,[n,t,i]);_a.$3.$K(n,"owaShell shouldn't be null");_a.$3.$K(i,"eventAggregator shouldn't be null");_a.$3.$K(r,"syncFoldersProcessorLazy shouldn't be null");_a.$3.$K(u,"conductor shouldn't be null");_a.$3.$K(f,"taskRunner shouldn't be null");this.$1WU=r;this.$J=i;this.$3m=u;this.$44=f;$743(this);$742(this)};function $742(n){var t=this;n.$1WU.$E(function(t){n.$ER=t;$741(n);n.$3Rl()})}function $743(n){_h.$26.$k7||_h.$26.$4Wv(n.$B.get_$L());n.$1FU=5>=_h.$26.$k7?_h.$26.$k7:5}function $741(n){_js.Trace.logInfo(_d.$Ca.$67,"Initialize folder controllers with maxSyncFolders={0}",n.$1FU);n.$MY=new Array(0);for(var r=0;r<n.$1FU;r++)Array.add(n.$MY,new _d.$Nl("","",new _d.$Bo(n.$J,n.$44,n.$B),n.$B,n.$$d_$8Kh,n.$3m));for(var u=n.$MY,f=u.length,t=0;t<f;++t){var e=u[t];e.$Y("FolderId",n.$$d_$9Nl)}for(var i=1;i<=n.$1FU;i++)$3(n,String.format("FolderController{0}",i))}function $4sM(n,t){for(;t<n.$1FU;t++){n.$MY[t].set_$Kb("");n.$MY[t].set_$o("")}}_d.$Ca.prototype={$J:null,$1WU:null,$3m:null,$44:null,$1FU:0,$ER:null,$MY:null,$4aj:!1,$2jK:!1,get_$6dg:function(){return this.$4aj},set_$6dg:function(n){if(this.$4aj!==n){this.$4aj=n;$3(this,"SettingChanged")}return n},get_$1A2:function(){return this.$2jK},set_$1A2:function(n){if(n!==this.$2jK){this.$2jK=n;$3(this,"UserSelected")}return n},get_$7zD:function(){var n;switch(this.$1FU){case 1:n=_nbs.NonBootStrings.l_One_Text;break;case 2:n=_nbs.NonBootStrings.l_Two_Text;break;case 3:n=_nbs.NonBootStrings.l_Three_Text;break;case 4:n=_nbs.NonBootStrings.l_Four_Text;break;case 5:n=_nbs.NonBootStrings.l_Five_Text;break;default:throw Error.create("MaxSyncFolders can't be bigger than 5");}return String.format(_nbs.NonBootStrings.l_OfflineFoldersComment_Text,n)},get_$7yu:function(){return this.$MY&&this.$MY.length>=1?this.$MY[0]:null},get_$7yv:function(){return this.$MY&&this.$MY.length>=2?this.$MY[1]:null},get_$7yw:function(){return this.$MY&&this.$MY.length>=3?this.$MY[2]:null},get_$7yx:function(){return this.$MY&&this.$MY.length>=4?this.$MY[3]:null},get_$7yy:function(){return this.$MY&&this.$MY.length>=5?this.$MY[4]:null},$2as:function(){this.$3Rl();_d.$F1.prototype.$2as.call(this)},$BS:function(n){_js.Trace.logInfo(_d.$Ca.$67,"Save isSavedFromDirty={0}",n);this.$6ZM();_d.$F1.prototype.$BS.call(this,n)},$3Rl:function(){if(this.$ER){this.set_$1A2(this.$ER.get_$1A2());var n=0;if(this.$ER.get_$1A2()){var u=this.$ER.get_$5qV();var t=u.get_$1OT();var i=0;if(t){i=t.length>this.$1FU?this.$1FU:t.length;for(;n<i;n++){var r=_h.$i.$Jo(new _g.$3R(t[n]));if(r){this.$MY[n].set_$Kb(_g.$2Z.$fu(r));this.$MY[n].set_$o(t[n])}else{_js.Trace.logWarning(_d.$Ca.$67,"Can't find folder based on FolderId {0}",t[n]);this.$MY[n].set_$Kb("");this.$MY[n].set_$o("")}}}$4sM(this,n)}else $4sM(this,n)}},$7m3:function(){return new _c.$11q},$7o2:function(){return new _c.$11r(this.$$d_$6ZM)},$5Ku:function(){var n={};n.SettingChanged=!0;n.UserSelected=!0;return n},$9Nl:function(n,t){this.set_$6dg(!1);this.set_$6dg(!0)},$8Kh:function(n){if(this.$ER.$5kC(n))return!0;else{var t;t=_h.$26.$8Kj(n)?_nbs.NonBootStrings.l_FolderAlreadyInDefaultSyncListError_Text:_nbs.NonBootStrings.l_FolderNotAllowedToSync_Text;var i=new _a.$4V([t],0,null,0,!1,_u.Strings.l_OK_Text,null,_nbs.NonBootStrings.l_SelectAFolderError_Text);this.$J.$9lH(_a.$4V,i);return!1}},$6ZM:function(){_js.Trace.logInfo(_d.$Ca.$67,"SaveOfflineFolders");if(this.$ER){this.$ER.set_$1A2(this.$2jK);if(this.$ER.get_$1A2()){for(var i=this.$ER.get_$5qV(),t=new Array(0),n=0;n<this.$1FU;n++)_js.$8.$a(this.$MY[n].$2k)||Array.add(t,this.$MY[n].$2k);_js.Trace.logInfo(_d.$Ca.$67,"Setting MailFolderIds={0}",t);i.set_$1OT(t)}}}};_d.$PI=function(n,t,i,r,u){this.$$d_$9S0=Function.createDelegate(this,this.$9S0);_d.$PI.initializeBase(this);this.$18=n;this.$ma=t;this.$k=r;this.$B=i;u&&this.set_$JO(n.get_$JO().get_$3o(0).get_$1n())};function $6zl(n){for(var i=n.$18.get_$JO().get_$C(),t=0;t<i;t++)n.$18.get_$JO().get_$3o(t).get_$Uh()&&_d.$6z.$8S6(_a.$0.$A7,"TruncatedNotesShown","Contact #"+t)}_d.$PI.prototype={$B:null,$k:null,$18:null,$ma:null,$1QA:!1,$nh:!1,$Wh:null,get_$36O:function(){return this.$nh},set_$36O:function(n){if(this.$nh!==n){this.$nh=n;$3(this,"IsNotesAvailable")}return n},get_$46b:function(){return this.$1QA},set_$46b:function(n){if(this.$1QA!==n){this.$1QA=n;$3(this,"IsNotesLoaded")}return n},get_$JO:function(){return this.$Wh},set_$JO:function(n){this.$Wh=n;$3(this,"Notes");this.set_$36O(!_js.$8.$a(this.$Wh));this.set_$46b(!0);return n},get_$8Tx:function(){var n;switch(this.$B.get_$L()){case"TouchNarrow":n=51200;break;case"TouchWide":case"Mouse":default:n=512e3;break}return n},$Le:function(n){if(this.$18.get_$6P()&&this.$18.get_$6P().Id&&(!this.$1QA||n)){this.set_$36O(!1);this.set_$46b(!1);var t=new _pc.$q4(this.$18.get_$6P().Id,this.get_$8Tx());t.add_$2t(this.$$d_$9S0);t.$FO=this.$ma.$AD;this.$k.$11(t)}},$9S0:function(n){var t=n;if(t.$28k&&t.$28k.get_$JO()&&t.$28k.get_$JO().get_$C()>0){this.$18.set_$JO(t.$28k.get_$JO());this.set_$JO(t.$28k.get_$JO().get_$3o(0).get_$1n());$6zl(this)}else this.$18.get_$JO()&&this.$18.get_$JO().get_$C()?this.set_$36O(!0):this.set_$36O(!1);this.set_$46b(!0)}};_d.$1Lv=function(n){this.$2e=n};_d.$1Lv.prototype={$2e:null,get_$1u:function(){return this.$2e.$18},get_$2ng:function(){return""},get_$66:function(){return this.$2e.$7Q},get_$44q:function(){return!1},set_$44q:function(n){return n},get_$5O6:function(){return null},get_$35a:function(){return!1},get_$2ji:function(){return new Array(0)},set_$2ji:function(n){return n},get_$7Xy:function(){return""},set_$7Xy:function(n){return n},get_$1Dn:function(){return!0},get_$5dA:function(){return!0},get_$1yo:function(){return!0},get_$1zR:function(){return!1},set_$1zR:function(n){return n},get_$28G:function(){return this.$2e.$B},get_$2t8:function(){return this.$2e.$8U},get_$2UA:function(){return null},$fu:function(n){return n?this.get_$1u().get_$1vL():this.get_$1u().get_$1o()},$4Qj:function(n){},$4T0:function(n){},$427:function(n){},$2t1:function(n){}};_d.$p8=function(n){_d.$p8.initializeBase(this,[n])};_d.$p8.prototype={get_$2ji:function(){return this.get_$wh().$6qB},set_$2ji:function(n){this.get_$wh().$6qB=n;return n},get_$7Xy:function(){return this.get_$wh().$3h1},set_$7Xy:function(n){this.get_$wh().$3h1=n;return n},get_$44q:function(){return this.get_$wh().$2Rs},set_$44q:function(n){this.get_$wh().set_$44q(n);return n},get_$1zR:function(){return this.get_$wh().$Hn},set_$1zR:function(n){this.get_$wh().$Hn=n;return n},get_$wh:function(){return this.$2e}};_d.$Iz=function(n,t,i,r){this.$$d_$2rg=Function.createDelegate(this,this.$2rg);this.$$d_$4TX=Function.createDelegate(this,this.$4TX);this.$$d_$BS=Function.createDelegate(this,this.$BS);_d.$Iz.initializeBase(this);this.$B=i;this.$5q=r;(n.get_$1J()===5||t!==2)&&(this.$73=$70c(this,n));this.$2s9=n.get_$1J()};function $70c(n,t){return n.$5q.$Vu(t,t.get_$1J()===5?2:_y.$17.$4U4,!1,t.get_$1J()===5?5:7,!0,null)}_d.$Iz.prototype={$B:null,$73:null,$2s9:0,$5q:null,$1UK:null,$DO:null,$7I:null,$Cd:!1,$15Y:!1,add_$6Rx:function(n){this.$2G("PopoutClicked",n)},remove_$6Rx:function(n){this.$2H("PopoutClicked",n)},add_$9rn:function(n){this.$2G("SaveClicked",n)},remove_$9rn:function(n){this.$2H("SaveClicked",n)},add_$7ew:function(n){this.$2G("CancelClicked",n)},remove_$7ew:function(n){this.$2H("CancelClicked",n)},get_$uh:function(){$5(this.$DO)&&(this.$DO=new _C(this.$$d_$BS,_d.$Iz.$A));return this.$DO},get_$4TY:function(){$5(this.$1UK)&&(this.$1UK=new _C(this.$$d_$4TX,_d.$Iz.$A));return this.$1UK},get_$UC:function(){$5(this.$7I)&&(this.$7I=new _C(this.$$d_$2rg,_d.$Iz.$A));return this.$7I},get_$2CC:function(){return!!this.$73},get_$dC:function(){return this.$B.get_$L()!=="Mouse"},get_$6fr:function(){return!1},get_$6Rv:function(){return this.$2s9===4?_nbs.NonBootStrings.l_LocationPopoutCardAction_AT_Tooltip_Text:_nbs.NonBootStrings.l_PersonaPopoutCardAction_AT_Tooltip_Text},get_$Aq:function(){return this.$Cd},set_$Aq:function(n){if(this.$Cd!==n){this.$Cd=n;$3(this,"IsSaving")}return n},get_$20w:function(){return this.$15Y},set_$20w:function(n){if(this.$15Y!==n){this.$15Y=n;$3(this,"ShowPopoutControl")}return n},$4TX:function(){$6J(this,"PopoutClicked")},$BS:function(){if(!this.$Cd){this.set_$Aq(!0);$6J(this,"SaveClicked")}},$2rg:function(){$6J(this,"CancelClicked")}};_d.$14V=function(n){_d.$14V.initializeBase(this,[n])};_d.$14V.prototype={get_$3nI:function(){return this.$2e},$fu:function(n){var r=_d.$1Lv.prototype.$fu.call(this,n);if(!_js.$8.$a(r))return r;var u=this.get_$3nI().$e0.$2NS;var h=u?u.$Hb:null;var f=this.get_$3nI().$e0.$2Z9;var c=f?f.$Hb:null;var e=this.get_$3nI().$e0.$2U0;var l=e?e.$Hb:null;var t=null;var i=null;var o,s;var a=this,v=this;_g.$70.$3kj(h,c,l,null,null,null,null,null,null,null,function(n){return""},function(n){return""},o={val:t},s={val:i});t=o.val;i=s.val;return n?i:t}};_d.$m0=function(n,t,i,r){this.$B=n;this.$6M=t;this.$5q=i;this.$2sq=r};_d.$m0.prototype={$6M:null,$B:null,$5q:null,$2sq:null,$7nO:function(n,t,i,r){return new _d.$AC(n,t,i,this.$B,this.$6M,r,this.$5q,this.$2sq)},$7nP:function(n,t){return new _d.$Iz(n,t,this.$B,this.$5q)}};_d.$AC=function(n,t,i,r,u,f,e,o){this.$$d_$4TX=Function.createDelegate(this,this.$4TX);this.$$d_$9UU=Function.createDelegate(this,this.$9UU);this.$$d_$9UB=Function.createDelegate(this,this.$9UB);this.$$d_$9LA=Function.createDelegate(this,this.$9LA);this.$$d_$cn=Function.createDelegate(this,this.$cn);_d.$AC.initializeBase(this);this.$2V=!0;this.$1Pt=!0;this.$5qM=f;this.$B=r;this.$6M=u;this.$5q=e;this.$2sq=o;this.$7Q=t;this.$8U=i;this.$18=n;this.$73=$75m(this,n);this.$2s9=n.get_$1J();this.$2Ps=!0;this.$32N=!0;this.$2Pp=!0;this.$2Po=!0;this.set_$7uY(_nbs.NonBootStrings.l_PersonaEditMgmtAction_AT_Tooltip_Text);this.set_$3tK(_nbs.NonBootStrings.l_PersonaEditMgmtAction_Text)};function $75m(n,t){if(n.get_$2SJ())return null;var i=$75l(n,t);i&&n.$8U.$1No&&i.set_$1Dn(!0);var r=_y.$17.$Km;n.$18.get_$1J()===4&&(r=_y.$17.$1fk);return n.$5q.$Vu(t,r,!1,7,!0,i)}function $75l(n,t){return n.$2sq.$7kk(t,n.$7Q,n.$5qM,n.$8U)}_d.$AC.prototype={$6M:null,$B:null,$5q:null,$2sq:null,$5qM:null,$73:null,$2s9:0,$7Q:0,$8U:null,$WJ:!1,$2V:!1,$1Pt:!1,$Es:null,$Hz:null,$Lz:0,$1UK:null,$Q2:null,$1YD:null,$b1:null,$23R:null,$yL:!1,$CN:!1,$3AW:null,$32G:!1,$40w:!1,$328:!1,$2Ps:!1,$32N:!1,$15Y:!1,$2Po:!1,$4by:!1,$18:null,$2x7:null,$1O1:null,$4c0:!1,$8Fn:null,$2Pp:!1,add_$6Rx:function(n){this.$2G("PopoutClicked",n)},remove_$6Rx:function(n){this.$2H("PopoutClicked",n)},add_$9hP:function(n){this.$2G("PivotOptionClicked",n)},remove_$9hP:function(n){this.$2H("PivotOptionClicked",n)},add_$5Qx:function(n){this.$2G("EditClicked",n)},remove_$5Qx:function(n){this.$2H("EditClicked",n)},add_$A85:function(n){this.$2G("ToggleClicked",n)},remove_$A85:function(n){this.$2H("ToggleClicked",n)},add_$5A8:function(n){this.$2G("AddMembersClicked",n)},remove_$5A8:function(n){this.$2H("AddMembersClicked",n)},add_$8Pd:function(n){this.$2G("JoinClicked",n)},remove_$8Pd:function(n){this.$2H("JoinClicked",n)},add_$8Qg:function(n){this.$2G("LeaveClicked",n)},remove_$8Qg:function(n){this.$2H("LeaveClicked",n)},get_$1u:function(){return this.$18},set_$1u:function(n){this.$18=n;this.$73&&this.$73.set_$1u(n);return n},get_$NJ:function(){return this.$Es},set_$NJ:function(n){if(this.$Es!==n){this.$Es=n;$3(this,"ActivityStatusViewModel")}return n},get_$A0b:function(){return!this.get_$dC()&&this.$4by},set_$A0b:function(n){if(this.$4by!==n){this.$4by=n;$3(this,"ShowExpandButton")}return n},get_$8EM:function(){return this.$8U.$2M1||this.$yL||this.get_$20r()||this.get_$2SJ()||this.get_$46p()},get_$32H:function(){return this.$32G},set_$32H:function(n){if(this.$32G!==n){this.$32G=n;$3(this,"HideEditButton")}return n},get_$8Dx:function(){return this.$2Pp},set_$8Dx:function(n){if(this.$2Pp!==n){this.$2Pp=n;$3(this,"HideAddMembersButton")}return n},get_$3tK:function(){return this.$1O1},set_$3tK:function(n){if(this.$1O1!==n){this.$1O1=n;$3(this,"EditButtonText")}return n},get_$7uY:function(){return this.$2x7},set_$7uY:function(n){if(this.$2x7!==n){this.$2x7=n;$3(this,"EditButtonToolTip")}return n},get_$1be:function(){this.$Q2||(this.$Q2=new _C(this.$$d_$cn,_d.$AC.$A));return this.$Q2},get_$5A9:function(){this.$1YD||(this.$1YD=new _C(this.$$d_$9LA,_d.$AC.$A));return this.$1YD},get_$21y:function(){this.$b1||(this.$b1=new _C(this.$$d_$9UB,_d.$AC.$A));return this.$b1},get_$4TY:function(){this.$1UK||(this.$1UK=new _C(this.$$d_$4TX,_d.$AC.$A));return this.$1UK},get_$2CC:function(){return this.$73?!!this.$73.$Ou:!1},get_$dC:function(){return this.$B.get_$L()!=="Mouse"},get_$6Rv:function(){return this.$2s9===4?_nbs.NonBootStrings.l_LocationPopoutCardAction_AT_Tooltip_Text:_nbs.NonBootStrings.l_PersonaPopoutCardAction_AT_Tooltip_Text},get_$8UJ:function(){return this.$23R},set_$8UJ:function(n){this.$23R=n;$3(this,"MenuAddContactsViewModelPropertyName");return n},get_$4Bz:function(){return this.$3AW},set_$4Bz:function(n){if(this.$3AW!==n){this.$3AW=n;$3(this,"MenuAffordanceViewModel")}return n},get_$6fr:function(){return!1},get_$kx:function(){return this.$Hz},set_$kx:function(n){if(this.$Hz!==n){this.$Hz=n;$3(this,"PivotOptions")}return n},get_$C8:function(){return this.$Lz},set_$C8:function(n){this.$Lz=n;$3(this,"PivotSelectedOptionIndex");$Cq(this,"PivotOptionClicked",n);return n},get_$LV:function(){return this.$yL},set_$LV:function(n){if(this.$yL!==n){this.$yL=n;this.$73&&this.$73.set_$5hs(n);$3u(this,"IsCardLoading","HideManagementActions")}return n},get_$1yO:function(){return this.$CN||this.$40w},set_$1yO:function(n){if(this.$40w!==n){this.$40w=n;$3(this,"HideAddContactsMenu")}return n},get_$329:function(){return this.$328},set_$329:function(n){if(this.$328!==n){this.$328=n;$3(this,"HideAffordanceMenu")}return n},get_$8EG:function(){return this.$2Ps},set_$8EG:function(n){if(this.$2Ps!==n){this.$2Ps=n;$3(this,"HideJoinButton")}return n},get_$8EI:function(){return this.$32N},set_$8EI:function(n){if(this.$32N!==n){this.$32N=n;$3(this,"HideLeaveButton")}return n},get_$326:function(){return this.$2Po},set_$326:function(n){if(this.$2Po!==n){this.$2Po=n;$3(this,"HideActivityStatusViewModel")}return n},get_$4K:function(){return this.$2V},set_$4K:function(n){if(this.$2V!==n){this.$2V=n;$Cq(this,"ToggleClicked",n);$3u(this,"IsExpanded","ShowPersonCardExpandToggleButton")}return n},get_$9gq:function(){return this.get_$dC()?this.get_$1Ei():this.$1Pt||this.get_$20r()},get_$20r:function(){return!this.$8U.$AD},get_$5kY:function(){return this.get_$20r()&&!this.$WJ},get_$46p:function(){return this.$8U.$AD===1},get_$5kW:function(){return this.$8U.$AD===2&&!this.$WJ},get_$2SJ:function(){return this.$8U.$AD===9},get_$ja:function(){return this.$1Pt},set_$ja:function(n){if(this.$1Pt!==n){this.$1Pt=n;$3(this,"IsExpandable")}return n},get_$1Ei:function(){return this.$WJ&&this.$B.get_$L()==="TouchWide"},get_$8MP:function(){return this.$WJ&&this.$B.get_$L()==="Mouse"},get_$35a:function(){return this.$WJ},set_$35a:function(n){this.$WJ=n;$L8(this,"IsHoverCard","IsTouchWideHover","IsMouseHover");return n},get_$ax:function(){return this.$CN},set_$ax:function(n){if(this.$CN!==n){this.$CN=n;$3(this,"IsLoading")}return n},get_$20w:function(){return this.$15Y},set_$20w:function(n){if(this.$15Y!==n){this.$15Y=n;$3(this,"ShowPopoutControl")}return n},get_$A0y:function(){return this.$4c0},set_$A0y:function(n){this.$4c0=n;$3(this,"ShowIndicator");return n},$4TX:function(){$6J(this,"PopoutClicked")},$cn:function(){$6J(this,"EditClicked")},$9UB:function(){$6J(this,"JoinClicked")},$9LA:function(){$6J(this,"AddMembersClicked")},$9UU:function(){$6J(this,"LeaveClicked")}};_d.$oW=function(n,t,i){this.$$d_$5Nk=Function.createDelegate(this,this.$5Nk);this.$$d_$1Y0=Function.createDelegate(this,this.$1Y0);_d.$oW.initializeBase(this);$5(n)&&(n=new _pc.$l);if($5(t))throw Error.argumentNull("acceptCallback");if($5(i))throw Error.argumentNull("declineCallback");this.$1qu=t;this.$5Nm=i;this.$1qv=new _C(this.$$d_$1Y0,_a.$0.$4c);this.$5Nn=new _C(this.$$d_$5Nk,_a.$0.$4c);this.$1Ve=new _d.$96(n,_y.$17.$1sN,!1);this.$1Ve.$5mA=!0};_d.$oW.prototype={$1Ve:null,$1qv:null,$5Nn:null,$1qu:null,$5Nm:null,$1Y0:function(){_js.Trace.logInfo(_a.$0.$4c,"BuddyRequest: Accepting buddy request {0}.",this.$1Ve.get_$1u().get_$1l());this.$1qu(this)},$5Nk:function(){_js.Trace.logInfo(_a.$0.$4c,"BuddyRequest: declining buddy request {0}.",this.$1Ve.get_$1u().get_$1l());this.$5Nm(this)}};_d.$Wz=function(n,t,i){this.$$d_$A8B=Function.createDelegate(this,this.$A8B);_d.$Wz.initializeBase(this);_a.$3.$m(n,"personaViewModelFactory");this.$5q=n;this.$5B=$713(this,t);this.$2x4=i;this.$Om=!1};function $713(n,t){var i=n.$5q.$Vu(t,_y.$17.$Km,!1,3);var r=[1];i.$eL(1,r,"");i.set_$fS(!0);return i}_d.$Wz.prototype={$5q:null,$2x4:null,$5B:null,$4gS:null,$Om:!1,get_$15M:function(){return this.$Om},set_$15M:function(n){if(this.$Om!==n){this.$Om=n;$3(this,"IsDeleted")}return n},get_$6kb:function(){this.$4gS||(this.$4gS=new _C(this.$$d_$A8B,_a.$0.$1u));return this.$4gS},$A8B:function(){this.set_$15M(!this.$Om);this.$2x4.$6nB(this)}};_d.$qB=function(n,t){this.$j2=n;this.$7F=t};_d.$qB.prototype={$j2:null,$7F:null,$5q:null,$5LF:function(n,t,i){return new _d.$DU(i,this.$j2,this.$7F,this.$5q,n,t)}};_d.$qG=function(n,t,i){_d.$qG.initializeBase(this,[n,0]);_a.$3.$m(t,"personaViewModelFactory");this.$5q=t;this.$2x4=i};_d.$qG.prototype={$5q:null,$2x4:null,get_$6Qk:function(){return this},$4h5:function(n){return _pc.$l.isInstanceOfType(n)?this.$7lP(n):n},$3PX:function(n){return _d.$Wz.isInstanceOfType(n)?n.$5B.$18:n},$3sd:function(n){var t=n;t&&t.$1R()},$81U:function(n){var u=n;var t=u.$5B;var i=t.$Gx;var r=t.$18n;_js.$8.$a(r)||(i+=" "+r);return i},$7lP:function(n){return new _d.$Wz(this.$5q,n,this.$2x4)}};_d.$qH=function(){};_d.$qH.prototype={$5q:null,$7mD:function(n,t){return new _d.$qG(n,this.$5q,t)}};_d.$qA=function(){};_d.$qA.prototype={$5q:null,$E:function(n){return new _d.$Pn(n,this.$5q)}};_d.$U6=function(n,t){_d.$U6.initializeBase(this);this.$2e=n;this.$1EW=!!t&&t.$3N("ModernGroups");this.$wl()};function $723(n){var t;var i,r;var u=(r=_d.$1Q.$AJv(String,n.$2e.get_$1u().get_$1Nr(),"",n.$2e,i={val:t}),t=i.val,r);t&&_js.$8.$a(t.get_$1n())&&t.set_$1n(n.$2e.get_$1u().get_$1o());$5(n.$2e.get_$1u().get_$1Nr())&&n.$2e.get_$1u().set_$1Nr(u);n.set_$5ax(new _d.$2n(n.$2e,t,"PersonaDisplayNames",n.$1EW?_nbs.NonBootStrings.l_ContactListName_Text:_nbs.NonBootStrings.l_GroupName_Text,!0))}function $724(n){var t;var i=new _g.$6j;i.set_$1n("");i.set_$3s("Text");var r,u;var f=(u=_d.$1Q.$AJv(_g.$6j,n.$2e.get_$1u().get_$JO(),i,n.$2e,r={val:t}),t=r.val,u);$5(n.$2e.get_$1u().get_$JO())&&n.$2e.get_$1u().set_$JO(f);n.set_$JO(new _d.$2n(n.$2e,t,"PersonaBodies",_nbs.NonBootStrings.l_GroupCardNotes_ProfileField_Text,!0))}function $725(n){n.$2e.get_$1u().set_$1Nr(_d.$1Q.$AJw(String,n.$2e.get_$1u().get_$1Nr(),!0));n.$2e.get_$1u().set_$JO(_d.$1Q.$AJw(_g.$6j,n.$2e.get_$1u().get_$JO(),!0))}_d.$U6.prototype={$1EW:!1,$1xz:null,$Wh:null,$2e:null,get_$5ax:function(){return this.$1xz},set_$5ax:function(n){if(this.$1xz!==n){this.$1xz=n;$3(this,"GroupNameField")}return n},get_$JO:function(){return this.$Wh},set_$JO:function(n){if(this.$Wh!==n){this.$Wh=n;$3(this,"Notes")}return n},$wl:function(){this.set_$5ax(null);this.set_$JO(null);if(this.$2e.get_$66()){this.$2e.set_$2ji(this.$2e.get_$1u().$3zJ());$723(this);$724(this)}},$1Ll:function(){var n=[];n=_d.$1Q.$1rn(this.$1xz,n);n=_d.$1Q.$1rn(this.$Wh,n);return n},$iq:function(){$725(this)}};_d.$1N8=function(n){this.$$d_$AFp=Function.createDelegate(this,this.$AFp);this.$$d_$9h6=Function.createDelegate(this,this.$9h6);_d.$1N8.initializeBase(this);this.$2e=n;this.$2Iu=this.$2e.get_$28G().get_$L()==="TouchNarrow"&&!this.$2e.get_$1Dn()};_d.$1N8.prototype={$2e:null,$2Iu:!1,$5MJ:function(n){throw Error.notImplemented();},$9h6:function(n){var t=n.$Af.get_$1n();this.$2e.$4T0(t)},$AFp:function(n){var t=n.$Af.get_$1n();if(!_js.$8.$15(t)){var i=t.trimStart().toLowerCase();i.startsWith("http://")||i.startsWith("https://")||(t="http://"+t);this.$2e.$4Qj(t)}}};_d.$FM=function(n,t,i,r,u,f,e,o,s,h,c,l){this.$$d_$9uK=Function.createDelegate(this,this.$9uK);this.$$d_$9h5=Function.createDelegate(this,this.$9h5);this.$$d_$1xn=Function.createDelegate(this,this.$1xn);this.$$d_$8Fc=Function.createDelegate(this,this.$8Fc);this.$$d_$5Iv=Function.createDelegate(this,this.$5Iv);this.$$d_$7iI=Function.createDelegate(this,this.$7iI);_d.$FM.initializeBase(this);this.$B=t;this.$AI=r;this.$sW=u;this.$k=f;this.$1Mx=e;this.$7A=o;this.$169=c;this.$6M=s;this.$7Q=h;this.$8U=l;this.$Js=this.$B.get_$L()==="Mouse";this.set_$1u(n);if(this.$B.get_$L()==="Mouse"){var a=this;i.$E(function(n){a.$4J=n.$E();$4q1(a)})}};function $4q0(n){if(!n.$7Q){if(n.$32T){n.$wj&&n.$wj.$1t();n.$wk&&n.$wk.$1t();n.$1Ds&&n.$1Ds.$1t();n.$uK&&n.$uK.$1t();n.$pL&&n.$pL.$1t();n.$xC&&n.$xC.$1t();return}n.$wj||(n.$wj=new(_d.$Aq.$$(_g.$1q))(n.$$d_$7iI));n.$wk||(n.$wk=new(_d.$Aq.$$(_g.$1q))(n.$$d_$5Iv));n.$1Ds||(n.$1Ds=new(_d.$Aq.$$(String))(n.$$d_$8Fc));if(n.$18.get_$6G()&&n.$18.get_$6G().length>0){var r=_d.$5c.$$(_g.$1q).$AHA(n.$18);n.$wj.$AJd(r);n.$wk.$AJd(r)}else{n.$wj.$1t();n.$wk.$1t()}$4q1(n);if(n.$18.get_$40V()){n.$xC||(n.$xC=new(_d.$Aq.$$(_g.$3V))(n.$$d_$1xn));if(n.$18.get_$1J()===4||n.$18.get_$1J()===3||n.$18.get_$1J()===1){var i=[new(_d.$5c.$$(_g.$3V))(n.get_$1FP().get_$3o(0),"")];i&&i.length>0&&n.$xC.$AJd(i)}else n.$xC.$1t();$3u(n,"DirectionsActionCommand","DirectionsNotAvailable")}if(n.$B.get_$L()==="TouchNarrow"){n.$uK||(n.$uK=new(_d.$Aq.$$(_g.$3G))(n.$$d_$9h5));n.$pL||(n.$pL=new(_d.$Aq.$$(_g.$3G))(n.$$d_$9uK));var t=_d.$5c.$$(_g.$3G).$AHC(n.$18);if(t&&t.length>0){n.$uK.$AJd(t);n.$18.get_$1J()!==4?n.$pL.$AJd(t):n.$pL.$1t()}else{n.$uK.$1t();n.$pL.$1t()}$He(n,["SendSmsActionCommand","PhoneCallActionCommand","SendSmsActionMenuViewModel","PhoneCallActionMenuViewModel","PhonesNotAvailable","SmsNotAvailable","IsFiveIconsOnTnarrow"])}}}function $4q1(n){var i=n.$4J&&n.$4J.get_$CK()&&!_js.$8.$15(n.$4J.get_$CK().get_$1uO())?n.$4J.get_$CK().get_$1uO().trim().toLowerCase():"";var t=_d.$5c.$$(String).$AHB(n.$18,i);if(t&&t.length>0){var r=this;n.$1Ds.$AJd(t,function(n,t,i){return new _d.$1Cx(n,t,i)})}else n.$1Ds.$1t();$He(n,["IMActionCommand","IMActionMenuViewModel","IMNotAvailable"])}function $4pz(n,t){n.$18.get_$1J()===2&&t.MailboxType==="Mailbox"&&(t.MailboxType="PublicDL");n.$18.get_$Al()&&(t.SipUri=n.$18.get_$Al())}function $3ad(n){n.get_$dC()||$6J(n,"ActionClicked")}_d.$FM.prototype={$7A:null,$k:null,$6M:null,$1Mx:null,$sW:null,$B:null,$AI:null,$7Q:0,$8U:null,$Js:!1,$4J:null,$27v:null,$1k3:null,$1Pp:!1,$169:null,$22x:null,$1FC:null,$32T:!1,$18:null,$wj:null,$wk:null,$uK:null,$pL:null,$1Ds:null,$xC:null,add_$9Kx:function(n){this.$2G("ActionClicked",n)},remove_$9Kx:function(n){this.$2H("ActionClicked",n)},get_$3Kb:function(){return this.$27v},set_$3Kb:function(n){this.$27v=n;return n},get_$4Qa:function(){return this.$1k3},set_$4Qa:function(n){this.$1k3=n;return n},get_$5hs:function(){return this.$1Pp},set_$5hs:function(n){if(this.$1Pp!==n){this.$1Pp=n;$3(this,"HidePersonaActions")}return n},get_$1Dn:function(){return this.$1Pp?!0:this.$32T},set_$1Dn:function(n){if(this.$32T!==n){this.$32T=n;$4q0(this);$3(this,"HidePersonaActions")}return n},get_$1u:function(){return this.$18},set_$1u:function(n){this.$18=n;$4q0(this);return n},get_$5Iu:function(){return this.$wj?this.$wj.get_$3O():null},get_$5Iw:function(){return this.$wk?this.$wk.get_$3O():null},get_$2t2:function(){return this.$wj?this.$wj.get_$2GY():null},get_$333:function(){return this.$1Ds?this.$1Ds.get_$2GY():null},get_$9h3:function(){return this.$uK?this.$uK.get_$2GY():null},get_$2t3:function(){return this.$wk?this.$wk.get_$2GY():null},get_$9uL:function(){return this.$pL?this.$pL.get_$2GY():null},get_$5PX:function(){return this.$xC?this.$xC.get_$2GY():null},get_$7iH:function(){return this.$wj.get_$4Yo()},get_$8FN:function(){return this.$1Ds.get_$4Yo()},get_$9h4:function(){return this.$uK.get_$4Yo()},get_$7iJ:function(){return this.$wk.get_$4Yo()},get_$9uM:function(){return this.$pL.get_$4Yo()},get_$3tj:function(){return!this.$18.get_$6G()||!this.$18.get_$6G().length||!this.get_$5Iu()||!this.get_$5Iu().length},get_$6ZR:function(){return!!this.$1k3||this.get_$3tj()||!this.$AI.get_$1c()||!this.get_$5Iw()||!this.get_$5Iw().length},get_$5Pa:function(){return!this.$xC||!this.$xC.get_$3O()||!this.$xC.get_$3O().length},get_$4T1:function(){return this.$B.get_$L()!=="TouchNarrow"||!this.$uK||!this.$uK.get_$3O()||!this.$uK.get_$3O().length},get_$6hC:function(){return _a.UserAgent.getInstance().$Cs.get_$27y().$1kk===2||this.$18.get_$1J()!==1||this.get_$4T1()||!this.$pL||!this.$pL.get_$3O()||!this.$pL.get_$3O().length},get_$1yo:function(){return this.get_$3Kb()?!1:this.get_$dC()?!0:!this.$18.get_$g4()||!this.$18.get_$g4().get_$C()?!0:!this.$4J||!this.$4J.get_$gC()||!this.$4J.get_$CK()||!this.$4J.get_$CK().get_$yh()||!this.$4J.get_$CK().$1Zb(this.$18.get_$Al())},get_$7eb:function(){return _d.$4.get_$9h1()},get_$7ec:function(){return _d.$4.get_$9h2()},get_$9s5:function(){return this.$Js?_d.$4.get_$9gv():_d.$4.get_$6R3()},get_$9s6:function(){return this.$Js?_d.$4.get_$6R2():_d.$4.get_$9gw()},get_$9s4:function(){return this.$Js?_d.$4.get_$6R2():_d.$4.get_$6R3()},get_$9tx:function(){return this.$Js?_d.$4.get_$9gz():_d.$4.get_$6R7()},get_$9ty:function(){return this.$Js?_d.$4.get_$6R6():_d.$4.get_$9h0()},get_$9tw:function(){return this.$Js?_d.$4.get_$6R6():_d.$4.get_$6R7()},get_$7s8:function(){return this.$Js?_d.$4.get_$8Rx():_d.$4.get_$5pf()},get_$7s9:function(){return this.$Js?_d.$4.get_$5pe():_d.$4.get_$8Ry()},get_$7s7:function(){return this.$Js?_d.$4.get_$5pe():_d.$4.get_$5pf()},get_$8Fa:function(){return this.$Js?_d.$4.get_$9gx():_d.$4.get_$6R5()},get_$8Fb:function(){return this.$Js?_d.$4.get_$6R4():_d.$4.get_$9gy()},get_$8FZ:function(){return this.$Js?_d.$4.get_$6R4():_d.$4.get_$6R5()},get_$1FP:function(){this.$22x||(this.$22x=this.$18.$5YL());return this.$22x},get_$22b:function(){!this.$1FC&&this.get_$1FP()&&(this.$1FC=this.$sW.$3ol(this.get_$1FP().get_$3o(0),!0));return this.$1FC},get_$8Kd:function(){return this.$B.get_$L()==="TouchNarrow"&&!this.get_$3tj()&&!this.get_$6ZR()&&!this.get_$4T1()&&!this.get_$6hC()&&!this.get_$5Pa()},$1ow:function(n){this.set_$1u(n)},$2t1:function(n){$3ad(this);if(!$5(this.get_$4Qa())){this.get_$4Qa()(n.EmailAddress);return}var t=this.$7A.$Fx(!1,!0);t.set_$66(0);t.set_$3w(0);t.set_$4Z(new _js.$c);$4pz(this,n);t.get_$4Z().$D(n);this.$169||(this.$169=new _y.$CW);this.$169.$TO(t)},$427:function(n){$3ad(this);if(!$5(this.get_$3Kb())){this.get_$3Kb()(n);return}if(this.$4J){var t=this;this.$4J.add_$gz(function(){if(t.$4J.get_$gC()){var i=t.$4J.get_$wZ().$3oq(t.$18,n);t.$k.$11(i)}})}},$4T0:function(n){var t=_js.$8.$15(n.NormalizedNumber)?n.Number:n.NormalizedNumber;this.$6M.$TS(String.format("tel:{0}",encodeURIComponent(t)))},$5lp:function(n,t){$3(this,"IMNotAvailable")},$1xn:function(n){if(this.$18.get_$1J()===4||this.$18.get_$1J()===3||this.$18.get_$1J()===1)this.get_$22b().$1xn();else{var t=this.$sW.$3ol(n,!0);t.$1xn()}_d.$6z.$gQ(5,this.$8U.$AD,this.$18.get_$1J())},get_$dC:function(){return this.$B.get_$L()!=="Mouse"},$7iI:function(n){this.$2t1(n);_d.$6z.$gQ(0,this.$8U.$AD,this.$18.get_$1J())},$9h5:function(n){this.$4T0(n);_d.$6z.$gQ(3,this.$8U.$AD,this.$18.get_$1J())},$8Fc:function(n){this.$427(n);_d.$6z.$gQ(2,this.$8U.$AD,this.$18.get_$1J())},$5Iv:function(n){$3ad(this);_a.$6.$1X(_a.$0.$1c,"CreateItemFromPersonaCard");_d.$6z.$gQ(1,this.$8U.$AD,this.$18.get_$1J());var t=new _d.$Wc;t.set_$y(_a.$2F.$3oa(_a.$7.get_$2F()));t.set_$DE(36e5);t.set_$PU(!0);t.set_$3SR("Busy");$4pz(this,n);var i=new _js.$c;var r=_g.$3i.$xh(n);i.$D(r);t.set_$7G(i);var u=this.$1Mx.$2zO(t);this.$B.$N3(Object.getType(this.$1Mx),null,null,_y.$48.get_$iy(),u,!1);_a.$6.$19(null,"CreateItemFromPersonaCard")},$9uK:function(n){var t=_js.$8.$15(n.NormalizedNumber)?n.Number:n.NormalizedNumber;this.$6M.$TS(String.format("sms:{0}",encodeURIComponent(t)));_d.$6z.$gQ(4,this.$8U.$AD,this.$18.get_$1J())}};_d.$jM=function(n,t,i,r,u,f,e,o){this.$B=n;this.$k=t;this.$Jg=i;this.$sW=r;this.$1Mx=u;this.$7A=f;this.$AI=e;this.$6M=o};_d.$jM.prototype={$6M:null,$B:null,$k:null,$Jg:null,$sW:null,$1Mx:null,$AI:null,$7A:null,$7kk:function(n,t,i,r){return new _d.$FM(n,this.$B,this.$Jg,this.$AI,this.$sW,this.$k,this.$1Mx,this.$7A,this.$6M,t,i,r)}};_d.$w7=function(n,t,i){_d.$w7.initializeBase(this,[n,t,i])};_d.$w7.prototype={$5XJ:function(n,t){if(_g.$3N.isInstanceOfType(this.get_$1n())){var i=this.get_$1n();switch(i.get_$T8()){case"PhonebookServices":case"Contact":return $2nX(this,_u.Strings.l_NameValueRoundBracketedFormat_Text,this.$18.get_$1o(),n);default:return n}}else{switch(this.$3Xx){case 11:return $2nX(this,_u.Strings.l_NameValueRoundBracketedFormat_Text,this.$18.get_$1o(),n)}return _y.$EX.prototype.$5XJ.call(this,n,t)}},$5Wc:function(n){if(_pc.$l.isInstanceOfType(this.$18)){var t=this.$18;switch(n){case 2:return t.get_$mZ();case 3:return t.get_$2bx();case 4:return t.get_$mJ()?t.get_$mJ().get_$7qP():null;case 6:return t.get_$rj()?t.get_$rj().get_$7qP():null;case 5:return t.get_$ti()?t.get_$ti().get_$7qP():null;case 7:return t.get_$31();case 8:return t.get_$2M9();case 9:return t.get_$1vL();case 10:return t.get_$1D6();case 11:return t.get_$tv()?t.get_$tv().get_$7qP():null}}return _y.$EX.prototype.$5Wc.call(this,n)}};_d.$Jt=function(n,t,i){this.$$d_$9lV=Function.createDelegate(this,this.$9lV);this.$$d_$9gl=Function.createDelegate(this,this.$9gl);this.$$d_$9gk=Function.createDelegate(this,this.$9gk);this.$$d_$6M4=Function.createDelegate(this,this.$6M4);_d.$Jt.initializeBase(this);_a.$3.$K(t,"basePersonaViewModel");this.$B=n;this.$a2=t;this.$ox=i;this.$4Sv=0;$70t(this)};function $70w(n){n.$a2.set_$jg(!0)}function $70v(n){if(n.get_$Z9().$7f){var u=n.$a2.$2Oh();var f=_pc.$l.$1ND(u);n.get_$Z9().$7f.set_$4K(!0);n.get_$Z9().$1JZ(f)}else{var t=_a.$6.acss(n.$ML,"CreatePersonaCard");var i=n.$a2.$2Oh();var r=_pc.$l.$1ND(i);n.get_$Z9().$1JZ(r);_a.$6.aces(t)}}function $70x(n){n.get_$Z8().$2V=!0;switch(n.$a2.$10K){case 5:n.get_$Z8().$AD=2;break;case 1:n.get_$Z8().$AD=4;break;case 2:n.get_$Z8().$AD=5;break;case 3:n.get_$Z8().$AD=6;break;case 6:n.get_$Z8().$AD=3;break;case 4:n.get_$Z8().$AD=7;break;case 7:n.get_$Z8().$AD=11;break;case 0:default:n.get_$Z8().$AD&&n.get_$Z8().$AD!==1&&(n.get_$Z8().$AD=8);break}}function $70t(n){switch(n.$a2.$18.get_$1J()){case 1:n.$ML=_a.$0.$A7;break;case 2:n.$ML=_a.$0.$1xw;break;case 5:n.$ML=_a.$0.$tk;break;default:n.$ML=_a.$0.$4RF;break}}function $70u(n){return _js.$8.$4B("{0}_{1}",n.get_$Z8().$AD,n.$a2.$18.get_$1J())}_d.$Jt.prototype={$B:null,$ox:null,$a2:null,$3Lz:null,$36f:!1,$ov:null,$Wn:null,$4Sv:0,$ML:null,get_$Z8:function(){if(!this.$ov){this.$ov=new _d.$Ic;this.$ov.$1No=!1;this.$ov.$1bH=!0}return this.$ov},set_$Z8:function(n){if(this.$ov!==n){this.$ov=n;this.$Wn&&(this.$Wn.$ma=n);$3(this,"PersonaCardConfig")}return n},get_$6Uo:function(){switch(this.$B.get_$L()){case"Mouse":return 0;case"TouchWide":return 1;case"TouchNarrow":return 2;default:throw Error.invalidOperation("Unexpected value given for OwaShell.CurrentLayout: "+this.$B.get_$L());}},get_$CQ:function(){return this.get_$Z9()},get_$Z9:function(){if(!this.$Wn){var n=_a.$6.acss(this.$ML,"CreatePersonaCardFacade");$70x(this);this.$Wn=this.$ox.$E(this.get_$Z8(),this.get_$6Uo());_a.$6.aces(n);if(this.get_$Z8().$AD!==1){this.$Wn.add_$2sz(this.$$d_$6M4);this.$Wn.add_$1IL(this.$$d_$9gk);this.$Wn.add_$2cr(this.$$d_$9gl)}$3u(this,"PersonaCardFacadeViewModel","PersonaCardFacade")}return this.$Wn},get_$jg:function(){return this.$36f},get_$3M5:function(){return this.$4Sv},set_$3M5:function(n){this.$4Sv=n;return n},get_$8N9:function(){return!!this.$Wn},$2uA:function(){var n=_a.$6.acss(this.$ML,"CreatePersonaCard");var t=this.$a2.$2Oh();var i=_pc.$l.$1ND(t);this.get_$Z9().$2uA(i);_a.$6.aces(n)},$A1U:function(){if(!this.$B.get_$W5()){var n=_a.$6.$1X(this.$ML,"ShowPersonaCardExpanded",!0);$70w(this);_a.$6.$19(n,"ShowPersonaCardExpanded",null,null,$70u(this));_d.$6z.$8SD(4,this.get_$Z8().$AD,this.$a2.$18.get_$1J())}},$9pc:function(){this.$3Lz=null;this.get_$8N9()&&this.get_$Z9().$1tQ()},$9wy:function(n){n&&$70v(this);if(this.$36f!==n){var t=!1;this.get_$Z9()&&(t=!0);if(this.$36f){!n&&this.get_$Z9().$7f&&this.get_$Z9().$7f.get_$4K()&&this.get_$Z9().$7f.set_$4K(!1);this.get_$Z9().$7f&&(this.$a2.$18.get_$1J()===1||this.$a2.$18.get_$1J()===2||this.$a2.$18.get_$1J()===5)&&!_pc.$l.$1rv(this.get_$Z9().$7f.$18,this.$3Lz)&&this.get_$Z9().$1tQ();this.$3Lz=null}else this.$3Lz=this.$a2.$18;this.$36f=n;return t}return!1},$49:function(){if(this.$Wn){this.$Wn.remove_$2sz(this.$$d_$6M4);this.$Wn.remove_$1IL(this.$$d_$9gk);this.$Wn.remove_$2cr(this.$$d_$9gl)}_a.$1.prototype.$49.call(this)},$9gl:function(){var n=this.get_$Z9().$7f;n&&n.remove_$6II(this.$$d_$9lV)},$9gk:function(){var n=this.get_$Z9().$7f;if(n){if(_pc.$l.$1rv(this.$a2.$18,n.$18)){var t=this.$a2.$2Oh();n.set_$5O6(t.get_$1l())}n.set_$35a(!0);n.set_$4K(!0);this.$B.get_$L()!=="Mouse"?n.set_$ja(!1):n.set_$ja(!0);n.add_$6II(this.$$d_$9lV)}},$9lV:function(){this.$a2.set_$jg(!1)},$6M4:function(){this.$Wn&&this.$B.get_$L()==="Mouse"&&this.$a2.set_$jg(!1)}};_d.$TQ=function(n,t){this.$B=n;this.$ox=t};_d.$TQ.prototype={$B:null,$ox:null,$5Ko:function(n){return new _d.$Jt(this.$B,n,this.$ox.get_$1n())}};_d.$jR=function(){_d.$jR.initializeBase(this);this.$T=new _js.$c;this.$1v=new _y.$4p};_d.$jR.prototype={$T:null,$1v:null,$oZ:null,$10I:null,$D0:null,$Jr:!1,get_$6FL:function(){return this.$oZ},set_$6FL:function(n){_a.$3.$KI(this.$oZ,null,"MyContactsTreeNode");this.$oZ=n;return n},get_$6Ov:function(){return this.$10I},set_$6Ov:function(n){_a.$3.$KI(this.$10I,null,"OtherContactsTreeNode");this.$10I=n;return n},$2ch:function(n){this.$1v.$2u(0,n,null)}};_d.$52=function(n,t,i,r,u,f,e){this.$$d_$7kt=Function.createDelegate(this,this.$7kt);this.$$d_$7ku=Function.createDelegate(this,this.$7ku);this.$$d_$9I8=Function.createDelegate(this,this.$9I8);this.$$d_$9I9=Function.createDelegate(this,this.$9I9);this.$$d_$9oL=Function.createDelegate(this,this.$9oL);this.$$d_$9oM=Function.createDelegate(this,this.$9oM);this.$$d_$7qu=Function.createDelegate(this,this.$7qu);this.$$d_$7qt=Function.createDelegate(this,this.$7qt);this.$$d_$8Gg=Function.createDelegate(this,this.$8Gg);this.$$d_$9kU=Function.createDelegate(this,this.$9kU);this.$$d_$8Gr=Function.createDelegate(this,this.$8Gr);this.$$d_$2vb=Function.createDelegate(this,this.$2vb);this.$$d_$9IH=Function.createDelegate(this,this.$9IH);this.$$d_$3oW=Function.createDelegate(this,this.$3oW);this.$$d_$9oI=Function.createDelegate(this,this.$9oI);this.$$d_$9Nm=Function.createDelegate(this,this.$9Nm);_d.$52.initializeBase(this);_a.$3.$m(i,"rootNode");this.$Ay=i;this.$B=n;this.$Ok=e;$5(r)||(this.$nJ=r);this.$IM=t;this.$T=new _js.$c;this.$T.add_$1Y(this.$$d_$9Nm);this.$44Q=!1;this.$34f=u||this.$B.get_$L()!=="Mouse";this.set_$1eA(f);if(!this.$34f){this.$6WT=new _C(this.$$d_$9oI,_d.$52.$A);this.$5Kq=new _C(this.$$d_$3oW,_d.$52.$A);this.$6F6=new _C(this.$$d_$9IH,_d.$52.$A);this.$7qi=new _C(this.$$d_$2vb,_d.$52.$A);$4qa(this)}};function $711(n,t){return new _0365m.$o($710(n,t),null,n.$6F6)}function $70z(n){n.$8d=new _0365m.$2c([]);n.$IM&&$4qZ(n,n.$8d,n.$IM.get_$1Ef());if($70y(n)){n.$8d.$14.get_$C()>0&&n.$8d.$14.$D(new _0365m.$8w);n.$8d.$14.$D(n.get_$9J5())}}function $4qZ(n,t,i){var r=t.$14;if(n.$IM){(n.$IM.$SJ===5||n.$IM.$SJ===10)&&r.$6S([n.get_$9oJ(),n.get_$7qj(),$711(n,i)]);n.$IM.get_$5k8()&&r.$D(n.get_$8Gk())}}function $70y(n){return!n.$IM||n.$IM.get_$1Q8()?!0:!1}function $710(n,t){return String.format(_nbs.NonBootStrings.l_ContactFolderMoveToGroupMenuTitle_LowerCase_Text,t?_nbs.NonBootStrings.l_OtherFiltersTitle_LowerCase_Text:_nbs.NonBootStrings.l_MyContactsFolderDisplayName_LowerCase_Text)}function $2FI(n){n.set_$CT(1)}function $4qb(n,t){n.$Ay.$oZ.set_$2L(!0);n.$8d=new _0365m.$2c([]);$4qZ(n,n.$8d,t);if(t){n.$Ay.$10I.$T.$34(n);n.$Ay.$oZ.$T.$D(n)}else{n.$Ay.$oZ.$T.$34(n);n.$Ay.$10I.$T.$D(n);n.$Ay.$10I.set_$7w(!1)}$3(n,"IsChildOfOtherContactsFolder")}function $4qa(n){_a.$3.$9t(!n.$44Q,"Context menu commands are already hooked up. Can NOT HookupContextMenu() second time!");if(!n.$34f&&n.$2RT){$70z(n);n.$44Q=!0}}_d.$52.prototype={$IM:null,$nJ:null,$B:null,$Ay:null,$34f:!1,$Ok:!1,$6WT:null,$5Kq:null,$6F6:null,$7qi:null,$28Z:null,$8d:null,$17L:null,$BZ:0,$T:null,$38:!1,$EZ:!1,$Nb:!1,$44Q:!1,$2RT:!1,$2to:null,$4Mh:null,$10k:null,$5Oe:null,$2ZU:null,$44P:!1,$4cB:!1,get_$2S5:function(){return!$5(this.$nJ)},get_$5hh:function(){return this.$44P||this.get_$5kM()&&!this.$Nb},set_$5hh:function(n){if(this.$44P!==n){this.$44P=n;$3(this,"IsContactFolderHidden")}return n},get_$1eA:function(){return this.$2RT},set_$1eA:function(n){if(this.$2RT!==n){this.$2RT=n;$3(this,"IsContactFolderReadyForUsage")}return n},get_$5kM:function(){return this===this.$Ay.$10I},get_$6QO:function(){this.$28Z||(this.$28Z=new _C(_d.$OS.$4Qg,_d.$52.$A));return this.$28Z},get_$6fo:function(){return this.$4cB&&!this.$EZ},set_$6fo:function(n){if(this.$4cB!==n){this.$4cB=n;$3(this,"ShowPeopleConnectAsLastChild")}return n},get_$7w:function(){return this.$EZ},set_$7w:function(n){if(n!==this.$EZ){this.$IM&&this.$IM.get_$1Q8()&&this.$Ay.$10I&&this.$Ay.$10I.set_$5hh(n);this.$EZ=n;$3u(this,"IsCollapsed","ShowPeopleConnectAsLastChild")}return n},get_$2L:function(){return this.$38},set_$2L:function(n){if(n!==this.$38){this.$38=n;$3(this,"IsSelected")}return n},get_$9J4:function(){return this.$17L},set_$9J4:function(n){if(n!==this.$17L){this.$17L=n;$3(this,"NewContactFolderName")}return n},get_$Og:function(){return this.$Nb},set_$Og:function(n){if(n!==this.$Nb){this.$Nb=n;$3u(this,"HasChildren","IsContactFolderHidden")}return n},get_$CT:function(){return this.$BZ},set_$CT:function(n){if(n!==this.$BZ){this.$BZ=n;$3(this,"TreeNodeMode")}return n},get_$9oJ:function(){return new _0365m.$o(_u.Strings.l_Rename_LowerCase_Text,null,new _C(this.$$d_$8Gr,_d.$52.$A))},get_$7qj:function(){return new _0365m.$o(_u.Strings.l_Delete_LowerCase_Text,null,new _C(this.$$d_$9kU,_d.$52.$A))},get_$8Gk:function(){return new _0365m.$o(_nbs.NonBootStrings.l_PeopleConnect_ManageContactFolder_Text,null,new _C(_d.$OS.$4Qg,_d.$52.$A))},get_$9J5:function(){return new _0365m.$o(_nbs.NonBootStrings.l_ContactFolderNewFolderMenuTitle_LowerCase_Text,null,new _C(this.$$d_$8Gg,_d.$52.$A))},$9Nm:function(n,t){this.set_$Og(this.$T.get_$C()>0)},$9kU:function(){var n=this;this.$Ay.$1v.$2u(2,_nbs.NonBootStrings.l_ContactFolderDeleteFolderPromptText_Text,function(t,i){t&&n.$2vb()},!1,null,null,String.format(_nbs.NonBootStrings.l_ContactFolderDeleteFolderTitle_Text,this.$IM.$7K))},$2vb:function(){if(!this.$Ay.$Jr&&_d.$Pe.isInstanceOfType(this.$IM)){var n=this.$5Oe;if(!$5(n)){n.remove_$21(this.$$d_$7qt);n.remove_$29(this.$$d_$7qu)}n=this.$5Oe=new _pc.$15O(this.$IM.$7h);this.set_$1eA(!1);n.add_$29(this.$$d_$7qu);n.add_$21(this.$$d_$7qt);this.$Ay.$Jr=!0;OwaApplication.$1W.$11(n)}},$7qt:function(n){this.$Ay.$2ch(_nbs.NonBootStrings.l_ContactFolderDeleteGenericError_Text);this.$Ay.$Jr=!1;this.set_$1eA(!0)},$7qu:function(n){this.$Ay.$Jr=!1;var t=this.$38;this.set_$2L(!1);this.$IM.get_$1Ef()?this.$Ay.$oZ.$T.$34(this):this.$Ay.$10I.$T.$34(this);t&&this.$Ay.$oZ.set_$2L(!0)},$8Gr:function(){this.set_$CT(4)},$9oI:function(){if(this.$Ay.$Jr){$2FI(this);return}if(_js.$8.$15(this.$17L)||this.$17L.trim()===this.$IM.$7K){$2FI(this);return}if(_h.$i.$5ie(this.$IM.$7h,this.$17L)){this.$Ay.$2ch(_u.Strings.l_SameNameFolderExists_Text);$2FI(this);return}var n;if(!$5(this.$10k)){n=this.$10k;n.remove_$29(this.$$d_$9oM);n.remove_$21(this.$$d_$9oL);this.$10k=null}n=this.$10k=new _h.$tL;n.$2Q=this.$IM.$7h;n.$3I9=this.$17L;n.add_$29(this.$$d_$9oM);n.add_$21(this.$$d_$9oL);this.set_$CT(2);this.set_$1eA(!1);this.$Ay.$Jr=!0;OwaApplication.$1W.$11(n)},$9oL:function(n){this.$Ay.$2ch(_nbs.NonBootStrings.l_ContactFolderRenameGenericError_Text);$2FI(this);this.$Ay.$Jr=!1;this.set_$1eA(!0)},$9oM:function(n){var t=this.$38;this.set_$2L(!1);t&&this.$Ay.$oZ.set_$2L(!0);$2FI(this);this.$Ay.$Jr=!1;this.set_$1eA(!0)},$9IH:function(){if(!this.$Ay.$Jr&&_d.$Pe.isInstanceOfType(this.$IM)){var t=this.$IM;var n=this.$2ZU;if(!$5(n)){n.remove_$29(this.$$d_$9I9);n.remove_$21(this.$$d_$9I8);this.$2ZU=null}n=this.$IM.get_$1Ef()?this.$2ZU=new _pc.$zR(t.$7h,10):this.$2ZU=new _pc.$zR(t.$7h,1);n.add_$29(this.$$d_$9I9);n.add_$21(this.$$d_$9I8);$4qb(this,!this.$IM.get_$1Ef());this.$Ay.$Jr=!0;OwaApplication.$1W.$11(n)}},$9I8:function(n){this.$Ay.$Jr=!1;$4qb(this,this.$IM.get_$1Ef());this.$Ay.$2ch(this.$2ZU.$98)},$9I9:function(n){this.$Ay.$Jr=!1},$8Gg:function(){if(!this.$Ay.$Jr){var n=!$5(this.$IM)&&this.$IM.get_$1Ef()?this.$Ay.$oZ:this.$Ay.$10I;n.set_$CT(3)}},$3oW:function(){if(this.get_$2S5()||this.$IM.get_$1Q8()){if(this.$Ay.$Jr){this.set_$CT(1);return}if(_js.$8.$15(this.$17L)){this.set_$CT(1);return}var n=this.$2to;if(!$5(n)){n.remove_$29(this.$$d_$7ku);n.remove_$21(this.$$d_$7kt);this.$2to=null}n=this.$2to=new _pc.$14q(this.$17L,this.get_$2S5()?10:1,_g.$h.$1i.nameToId("contacts"),this.$Ay.$D0);var t=new _d.$Pe(n.$1TF);var i=this.$4Mh=new _d.$52(this.$B,t,this.$Ay,null,this.$34f,!1,this.$Ok);n.add_$29(this.$4Mh.$$d_$7ku);n.add_$21(this.$$d_$7kt);this.$T.$D(i);this.$Ay.$Jr=!0;this.set_$CT(1);OwaApplication.$1W.$11(n)}},$7kt:function(n){this.$Ay.$2ch(this.$2to.$98);this.$T.$34(this.$4Mh);this.$Ay.$Jr=!1},$7ku:function(n){this.set_$1eA(!0);$4qa(this);this.$Ay.$Jr=!1;$3(this,"ContextMenuViewModel")}};_d.$cF=function(){this.$3vk=new _d.$Ww(0,new _h.$CF("PersonaDisplayNameFirstLast","Ascending"),_nbs.NonBootStrings.l_DisplayPreferences_FirstOption_LowerCase_Text);this.$49F=new _d.$Ww(1,new _h.$CF("PersonaDisplayNameLastFirst","Ascending"),_nbs.NonBootStrings.l_DisplayPreferences_SecondOption_LowerCase_Text);_d.$cF.initializeBase(this);this.set_$4o(_d.$cF.$1ul);this.set_$2I9(1);this.get_$3O().$D(this.$3vk);this.get_$3O().$D(this.$49F)};_d.$cF.prototype={$5MJ:function(n){throw Error.notImplemented("CreateViewModelFromModel");}};_d.$Ww=function(n,t,i){_d.$Ww.initializeBase(this);_a.$3.$m(n,"displayOption");_a.$3.$m(t,"sortBy");_a.$3.$m(i,"contextMenuDisplayName");this.$2wc=n;this.$H0=t;this.$1Br=i};_d.$Ww.prototype={$2wc:0,$H0:null,$1Br:null,toString:function(){return _d.$wb.toString(this.$2wc)}};_d.$La=function(){};_d.$La.$5Yt=function(n){return n===1?_d.$La.$6Qw:_d.$La.$6Qv};_d.$16J=function(){};_d.$16J.prototype={$3y5:function(n){return new _pc.$17j(n)}};_d.$8m=function(n,t,i,r,u){this.$$d_$9XP=Function.createDelegate(this,this.$9XP);this.$$d_$3MQ=Function.createDelegate(this,this.$3MQ);this.$$d_$9X7=Function.createDelegate(this,this.$9X7);this.$$d_$9WF=Function.createDelegate(this,this.$9WF);this.$$d_$9dJ=Function.createDelegate(this,this.$9dJ);this.$$d_$7xM=Function.createDelegate(this,this.$7xM);this.$$d_$6J6=Function.createDelegate(this,this.$6J6);this.$$d_$9c4=Function.createDelegate(this,this.$9c4);_d.$8m.resolveInheritance();this.apcl=this.$Y;this.rpcl=this.$q;_d.$8m.initializeBase(this);this.$B=n;this.set_$4o(_d.$8m.$1ul);this.$Ok=u;this.$1UU=new _js.$c;this.$1VP=new _js.$c;this.$BW=new _d.$Ve;this.$BW.add_$6ac(this.$$d_$9c4);this.$xI=new _d.$cF;this.$xI.add_$6ac(this.$$d_$6J6);this.$2eb=!0;this.$2BW(_nbs.NonBootStrings.l_MyContactsFolderDisplayName_Text);this.$AJZ(new _d.$16J);this.$5St=new _C(this.$$d_$7xM,_d.$8m.$A);this.$6aM=new _C(this.$$d_$9dJ,_d.$8m.$A);this.$h7=this.$B.get_$L();this.$21k=_y.$4X.$dF(this.$B);this.$h7==="TouchNarrow"&&this.set_$6k($71a(this));this.set_$sF(i);this.$5Ta=t;this.$2RU=r;var f=_g.$V.get_$I();this.$3T5=f.get_$2z().get_$WH()&&(f.get_$5z().get_$3v8()||f.get_$5z().get_$49n());if(this.$3T5){var e=_a.$6.$1X(_a.$0.$AC,"PeopleConnectLinkShown",!0);$71b(this);_a.$6.$19(e,"PeopleConnectLinkShown",null,null,_js.$8.$4B("FB={0},LI={1}",f.get_$5z().get_$3v8(),f.get_$5z().get_$49n()))}};_d.$8m.$9yf=function(n,t){return!n&&t==="TouchWide"||n===1&&t!=="TouchNarrow"};function $2kr(n,t,i,r){var u;var f=r?n.$1UU:n.$1VP;switch(i.$2Z){case 0:for(var e=0;e<i.$2q.length;e++){u=i.$2q[e].$IM;f.$D(u);n.get_$3O().$D(u)}break;case 2:for(var o=0;o<i.$3B.length;o++){u=i.$3B[o].$IM;f.$D(u);n.get_$3O().$34(u)}break;case 3:$2kr(n,t,new _js.$Ia(2,i.$4b,null,i.$3B),r);$2kr(n,t,new _js.$Ia(0,i.$4b,i.$2q,null),r);break;case 4:f.$1t();n.get_$3O().$1t();break}}function $71a(n){var t=_y.$22.$Aj(n,null,null);t.$i1(new _C(n.$$d_$3MQ,_d.$8m.$A));return t}function $71b(n){_js.Trace.logInfo(_d.$8m.$A,"Subscribing to people connect notifications.");var t=new _g.$Ac;t.NotificationType="RowNotification";t.FolderId=_g.$2Z.$BJ("peopleconnect").get_$o().Id;_js.Trace.logInfo(_a.$0.$5o,"[FilterListVM::SubscribeToNotifications] FolderId: {0}",t.FolderId);var i=new _h.$B8(t);i.$Hd(_d.$8m.$A,"FilterListVM:RowNotification",n.$$d_$9XP,2)}_d.$8m.prototype={$5Ta:0,$6aM:null,$5St:null,$1UU:null,$1VP:null,$B:null,$BW:null,$xI:null,$2RU:!1,$3T5:!1,$h7:0,$21k:!1,$Ok:!1,$28Z:null,$M3:null,$9Q:null,$13B:null,$T2:!1,$2eb:!1,$2NI:null,$2yd:null,$2h2:null,$3Hh:null,$3y:null,$3m:null,$iV:null,$4bZ:!0,$EF:!1,$1T4:null,$13b:null,$3SE:!0,add_$4P7:function(n){this.$2G("OnFolderSelected",n)},remove_$4P7:function(n){this.$2H("OnFolderSelected",n)},get_$7z4:function(){return this.$h7==="Mouse"||this.$h7==="TouchWide"?_y.$4.get_$12s():_y.$4.get_$ON()},get_$7z5:function(){return this.$h7==="Mouse"||this.$h7==="TouchWide"?_y.$4.get_$1MZ():_y.$4.get_$ON()},get_$7z7:function(){return this.$h7==="Mouse"||this.$h7==="TouchWide"?_y.$4.get_$12t():_y.$4.get_$ON()},get_$7z8:function(){return this.$h7==="Mouse"||this.$h7==="TouchWide"?_y.$4.get_$1Ma():_y.$4.get_$ON()},get_$9JU:function(){return this.$h7==="Mouse"?10:20},get_$1p:function(){return _y.$Fe.prototype.get_$1p.call(this)},set_$1p:function(n){_y.$Fe.prototype.set_$1p.call(this,n);n&&n.$7h.get_$o()?this.set_$5MV(n.$3xT(this.$BW.get_$1p().$VP,this.$iV)):this.set_$5MV(null);$3(this,"IsMailboxFilterSelected");return n},get_$20W:function(){return!this.get_$1p()||this.get_$1p().get_$364()},get_$KN:function(){return this.$B.get_$L()==="TouchNarrow"?2:0},get_$3KT:function(){return null},get_$3KV:function(){return null},get_$4h:function(){return this.$3m},set_$4h:function(n){this.$3m=n;return n},get_$6k:function(){return this.$3y},set_$6k:function(n){if(this.$3y!==n){this.$3y=n;$3(this,"ApplicationBarViewModel")}return n},get_$dD:function(){return this.$EF},set_$dD:function(n){if(n!==this.$EF){this.$EF=n;$3(this,"IsTransitionedIn")}return n},get_$7ii:function(){return this.$iV},set_$7ii:function(n){this.$iV=n;this.$13B=this.get_$1p().$3xT(this.$BW.get_$1p().$VP,this.$iV);return n},get_$5MV:function(){return this.$13B},set_$5MV:function(n){this.$13B=n;this.$3XA();$3(this,"CurrentConfiguration");return n},get_$2AM:function(){return this.$M3},set_$2AM:function(n){if(n!==this.$M3){this.$M3=n;$3(this,"RootTreeNode")}return n},get_$7yP:function(){return this.$2yd},set_$7yP:function(n){if(this.$2yd!==n){this.$2yd=n;$3(this,"FirstFilterOptionDisplayName")}return n},get_$7xl:function(){return this.$2NI},set_$7xl:function(n){if(this.$2NI!==n){this.$2NI=n;$3u(this,"FilterOptionDisplayName","AriaFilterOptionDisplayName")}return n},get_$6hN:function(){return this.$2h2},set_$6hN:function(n){if(this.$2h2!==n){this.$2h2=n;$3u(this,"SortOptionDisplayName","AriaSortOptionDisplayName")}return n},get_$7bD:function(){return String.format(_nbs.NonBootStrings.l_PeopleFilterOption_AT_Text,this.$2NI)},get_$7bI:function(){return String.format(_nbs.NonBootStrings.l_PeopleSortOption_AT_Text,this.$2h2)},get_$eJ:function(){return this.$9Q},set_$eJ:function(n){if(n!==this.$9Q){this.$9Q=n;$3(this,"SelectedTreeNode");$5(n)||this.set_$1p(n.$IM)}return n},get_$9sk:function(){return this.$2eb},set_$9sk:function(n){if(n!==this.$2eb){this.$2eb=n;$3(this,"SecondaryListIsEmpty")}return n},get_$1nO:function(){if(this.$h7==="Mouse")return this.$Ok?this.$T2?214:58:this.$T2?214:60;else if(this.$h7==="TouchWide")return this.$T2?this.$21k?244:260:60;return 0},get_$6gj:function(){return 60},get_$6gi:function(){return 274},get_$7z9:function(){return this.$T2?_nbs.NonBootStrings.l_PeopleCollapseFolder_AT_Text:_nbs.NonBootStrings.l_PeopleExpandFolder_AT_Text},get_$sF:function(){return this.$T2},set_$sF:function(n){if(n!==this.$T2){this.$T2=n;$L8(this,"IsSidePanelExpanded","FolderPanePaneButtonAriaLabel","SidePanelWidth")}return n},get_$6FK:function(){if(!this.$3Hh){this.$3Hh=_g.$2Z.$BJ("mycontacts");this.$3Hh.set_$1o(_nbs.NonBootStrings.l_MyContactsFolderDisplayName_Text)}return this.$3Hh},get_$6QO:function(){this.$28Z||(this.$28Z=new _C(_d.$OS.$4Qg,_d.$8m.$A));return this.$28Z},$2BW:function(n){this.set_$7xl(String.format(_nbs.NonBootStrings.l_PeopleFilterOptionDisplayName_Text,n,this.$BW.get_$1p().$7K));this.set_$7yP(n);this.get_$20W()?this.set_$6hN(String.format(_nbs.NonBootStrings.l_PeopleFilterOptionDisplayNameSort_Text,this.$BW.get_$1p().$7K)):this.set_$6hN(_nbs.NonBootStrings.l_PeopleDirectoryBrowseSortByDisplayName_Text)},$3XA:function(){this.$4bZ&&($5(this.get_$1p())?this.$2BW(_nbs.NonBootStrings.l_MyContactsFolderDisplayName_Text):this.$2BW(this.get_$1p().$7K))},$5X6:function(){return $5(this.$13B)?this.get_$6FK():this.$13B.$2Q},$3MQ:function(){this.get_$4h().$BP()},$e6:function(){},$FZ:function(){this.set_$dD(!0)},$l1:function(){this.set_$dD(!1)},$TZ:function(){},$5MJ:function(n){return new _d.$Pe(n,this.$Ok)},$9Vr:function(n,t){_y.$Fe.prototype.$9Vr.call(this,n,t);this.$7kd()},$7kd:function(){this.$1UU.$1t();this.$1VP.$1t();this.$1T4=null;var n=new _d.$jR;n.$D0=_h.$i.$aX("msgfolderroot");var i=null;var r=new _d.$52(this.$B,null,n,_nbs.NonBootStrings.l_OtherFiltersTitle_Text,this.$2RU,!0,this.$Ok);this.$13b=null;for(var f=new _js.$c,u=0;u<this.get_$3O().get_$C();u++){var t=this.get_$3O().get_$3o(u);if(t.get_$1Q8()){i=new _d.$52(this.$B,t,n,null,this.$2RU,!0,this.$Ok);this.$1UU.$D(t);continue}if(t.get_$364())if(t.get_$1Ef()){i.$T.$D(new _d.$52(this.$B,t,n,null,this.$2RU,!0,this.$Ok));this.$1UU.$D(t)}else{r.$T.$D(new _d.$52(this.$B,t,n,null,this.$2RU,!0,this.$Ok));this.$1VP.$D(t)}else if(t.get_$35T())this.$13b=new _d.$52(this.$B,t,n,null,!0,!0,this.$Ok);else{this.$13b||(this.$13b=new _d.$52(this.$B,null,n,_nbs.NonBootStrings.l_PeopleDirectoryContainer_Text,!0,!0,this.$Ok));var e=new _d.$52(this.$B,t,n,null,!0,!0,this.$Ok);f.$D(e);t.get_$5jz()&&(this.$1T4=e)}}if(i){n.set_$6FL(i);n.$T.$D(i);i.set_$7w(this.$Ok);this.$3SE&&i.set_$2L(!0);i.set_$6fo(this.$Ok?this.$3T5:!1);n.set_$6Ov(r);n.$oZ.$T.$D(r);i.$T.add_$1Y(this.$$d_$9WF);r.$T.add_$1Y(this.$$d_$9X7);r.set_$7w(!0)}if(this.$13b){this.$13b.$T.$6S(f.$6W());n.$T.$D(this.$13b);this.$13b.set_$7w(this.$Ok)}this.set_$2AM(n);this.$2eb=!this.$1VP.get_$C()},$9WF:function(n,t){$2kr(this,n,t,!0)},$9X7:function(n,t){$2kr(this,n,t,!1)},$7xM:function(){this.set_$sF(!this.$T2)},$9dJ:function(){$6J(this,"OnFolderSelected");this.$h7==="TouchNarrow"?this.$3MQ():this.set_$sF(!_d.$8m.$9yf(this.$5Ta,this.$h7))},$9c4:function(n,t){this.$3XA();this.get_$1p()&&(this.$13B=this.get_$1p().$3xT(this.$BW.get_$1p().$VP,this.$iV));$3(this,"SortOptionPropertyChanged")},$6J6:function(n,t){this.$BW.$ADu(n);$3(this,"DisplayOptionPropertyChanged")},$9XP:function(n){if(n.EventType==="RowAdded"){var i=n;var r=i;var t=r.Item;$5(t)||t.ItemClass!==_d.$OS.get_$9gH()&&t.ItemClass!==_d.$OS.get_$9gI()||this.$hG()}}};_d.$KN=function(n,t,i,r){_d.$KN.initializeBase(this,[n,t,i,r])};function $4sQ(n){return!(n.$1HV||n.$1Th||n.$1HU)}function $74F(n,t,i,r){if((n.$1HV||n.$1HU)&&t.$7h.$SJ===1002){n.$3i0=new _d.$52(r,t,i,null,!0,!0);return!1}if(n.$1HV&&!n.$1HU&&t.$7h.$SJ===1004){n.$3ht=new _d.$52(r,t,i,null,!0,!0);return!1}if((n.$1Th||n.$1HU)&&t.$7h.$SJ===1003){n.$3hw=new _d.$52(r,t,i,null,!0,!0);return!1}return(n.$1HV||n.$1Th||n.$1HU)?!1:!0}function $74E(n){return!n.$1jh}function $74D(n){return!n.$2ai}function $74C(n,t){n.$1jh&&t.$Nb&&n.set_$1p(t.$T.get_$3o(0).$IM)}_d.$KN.prototype={$2ai:!1,$1jh:!1,$1HV:!1,$1Th:!1,$1HU:!1,$3i0:null,$3hw:null,$3ht:null,$7kd:function(){this.$1UU.$1t();this.$1VP.$1t();var f=this.$B.get_$L()==="TouchNarrow";var n=new _d.$jR;n.$D0=_h.$i.$aX("msgfolderroot");for(var r=null,u=new _d.$52(this.$B,null,n,_nbs.NonBootStrings.l_OtherFiltersTitle_Text,f,!0),i=null,e=new _d.$52(this.$B,null,n,_nbs.NonBootStrings.l_OtherAddressListsFiltersTitle_Text,!0,!0),o=0;o<this.get_$3O().get_$C();o++){var t=this.get_$3O().get_$3o(o);if(t.get_$1Q8()){r=new _d.$52(this.$B,t,n,null,f,!0);this.$1UU.$D(t);continue}if(t.get_$364())if(t.get_$1Ef()){r.$T.$D(new _d.$52(this.$B,t,n,null,f,!0));this.$1UU.$D(t)}else{u.$T.$D(new _d.$52(this.$B,t,n,null,f,!0));this.$1VP.$D(t)}else if(t.get_$35T()){i||(i=new _d.$52(this.$B,null,n,_nbs.NonBootStrings.l_PeopleDirectoryContainer_Text,!0,!0));$4sQ(this)&&i.$T.$D(new _d.$52(this.$B,t,n,null,!0,!0))}else $74F(this,t,n,this.$B)&&e.$T.$D(new _d.$52(this.$B,t,n,null,!0,!0))}if(!$5(r)&&$74E(this)){n.set_$6FL(r);n.$T.$D(r);r.set_$7w(!1);r.set_$2L(!0);n.set_$6Ov(u);r.$T.$D(u);r.$T.add_$1Y(this.$$d_$9WF);u.$T.add_$1Y(this.$$d_$9X7);u.set_$7w(!0)}if(!$5(i)&&$74D(this)){n.$T.$D(i);if($4sQ(this)){i.$T.$D(e);e.set_$7w(!0)}else{this.$3i0&&i.$T.$D(this.$3i0);this.$3ht&&i.$T.$D(this.$3ht);this.$3hw&&i.$T.$D(this.$3hw)}$74C(this,i)}this.set_$2AM(n);this.set_$9sk(!this.$1VP.get_$C())}};_d.$1N2=function(n,t){this.$7K="";_d.$1N2.initializeBase(this);if(!n)throw Error.argumentNull("displayName");this.set_$1o(n);this.$SJ=t};_d.$1N2.prototype={$SJ:0,get_$1o:function(){return this.$7K},set_$1o:function(n){this.$7K=n;$3(this,"DisplayName");return n},get_$1Q8:function(){return _pc.$Ga.$5k7(this.$SJ)},get_$8NX:function(){return _pc.$Ga.$8NY(this.$SJ)},get_$35T:function(){return _pc.$Ga.$8Kq(this.$SJ)},get_$1Ef:function(){return _pc.$Ga.$5k7(this.$SJ)||_pc.$Ga.$9yh(this.$SJ)},get_$364:function(){return!_pc.$Ga.$9yg(this.$SJ)},get_$5k8:function(){return _pc.$Ga.$5k9(this.$SJ)},get_$5jz:function(){return _pc.$Ga.$8ML(this.$SJ)}};_d.$DR=function(n,t,i){this.$1W=n;this.$1H=t;this.$J=i};_d.$DR.$1aH=function(n){n.set_$QJ(!0);n.set_$r(!1);n.set_$19t(100);n.set_$1iX(0)};_d.$DR.prototype={$1W:null,$1H:null,$J:null,$E:function(n,t,i,r,u,f,e){var o=new _d.$2C(n,t,i,this.$1W,!$5(u)&&u,f,e,this.$1H,this.$J);o.set_$1ls(r);return o}};_d.$Pe=function(n,t){this.$$d_$6hL=Function.createDelegate(this,this.$6hL);this.$$d_$ABs=Function.createDelegate(this,this.$ABs);_d.$Pe.initializeBase(this,[_d.$Pe.$3ki(n,t),n.$SJ]);this.$7h=n;this.$7h.add_$7sn(this.$$d_$ABs);this.$7h.add_$A8g(this.$$d_$ABs);this.$7h.add_$6hL(this.$$d_$6hL);this.$Ok=t;this.$A8f=n.get_$Ix()};_d.$Pe.$3ki=function(n,t){if(!n)throw Error.argumentNull("folder");if(!n.get_$1o())throw Error.argumentNull("displayName");var i=null;i=n.$SJ===1?t?_nbs.NonBootStrings.l_MyContactsFolderDisplayName_Text:_nbs.NonBootStrings.l_MyContactsFolderDisplayName_Capitalized_Text:n.$SJ===1e3?t?_nbs.NonBootStrings.l_PeopleDirectoryContainer_Text:_nbs.NonBootStrings.l_PeopleDirectoryContainer_LowerCase_Text:n.get_$1o();return i};_d.$Pe.prototype={$A8f:0,$Ok:!1,$7h:null,$3xT:function(n,t){return new _pc.$Yx(this.$7h,n,t)},$ABs:function(n,t){this.set_$1o(_d.$Pe.$3ki(this.$7h,this.$Ok))},$6hL:function(n,t){this.$SJ=this.$7h.$SJ}};_d.$1Lz=function(){};_d.$1AL=function(){this.$$d_$9Su=Function.createDelegate(this,this.$9Su);_d.$1AL.initializeBase(this)};_d.$1AL.prototype={$y3:null,$4Yx:null,$40j:null,add_$8DZ:function(n){this.$2G("HeaderClicked",n)},remove_$8DZ:function(n){this.$2H("HeaderClicked",n)},get_$UY:function(){if(!this.$y3){var t=_a.$11.get_$DX().culture().people.headerDisplayValues;var r=_a.$11.get_$DX().culture().people.headerSeekToValues;this.$y3=new _js.$c;for(var u=Math.floor((t.length-1)/4)*4,n=0;n<t.length;n++){var i=t[n];var f=r[n];var e=!((n+1)%4);var o=n>=u;var s=new _d.$yz(i,f,e,o);this.$y3.$D(s);if(i==="*")break}}return this.$y3},get_$8Da:function(){this.$40j||(this.$40j=new _C(this.$$d_$9Su,_a.$0.$AC));return this.$40j},$9Su:function(){$Cq(this,"HeaderClicked",this.$4Yx)}};_d.$yz=function(n,t,i,r){_d.$yz.initializeBase(this);_a.$3.$1G(n,"displayValue");_a.$3.$K(t,"seekToValue");this.$5QC=n;this.$6aE=t;this.$5jS=i;this.$5jV=r};_d.$yz.prototype={$5QC:null,$6aE:null,$5jS:!1,$5jV:!1};_d.$1AM=function(n,t){_d.$1AM.initializeBase(this,[n,t])};_d.$1AM.prototype={$30:!1,get_$5rb:function(){return this.$B.get_$L()==="Mouse"?348:this.get_$40o()?420:410},get_$zu:function(){return this.$B.get_$L()==="Mouse"?this.get_$40o()?216:198:233},get_$5hr:function(){return this.get_$5GR()},get_$1O:function(){return this.$30},set_$1O:function(n){if(this.$30!==n){this.$30=n;$3(this,"IsShown")}return n},$4PO:function(n){_d.$z0.prototype.$4PO.call(this,n);this.set_$1O(!1)}};_d.$eJ=function(n,t){this.$$d_$3MQ=Function.createDelegate(this,this.$3MQ);this.$$d_$9Sb=Function.createDelegate(this,this.$9Sb);_d.$eJ.resolveInheritance();this.apcl=this.$Y;this.rpcl=this.$q;_d.$eJ.initializeBase(this,[n,t])};function $72L(n){var t=_y.$22.$Aj(n,null,null);t.$i1(new _C(n.$$d_$3MQ,_a.$0.$AC));return t}_d.$eJ.prototype={$3za:null,$3y:null,$3m:null,$EF:!1,get_$3KT:function(){return null},get_$3KV:function(){return null},get_$KN:function(){return this.$B.get_$L()==="Mouse"?0:2},get_$4h:function(){return this.$3m},set_$4h:function(n){this.$3m=n;return n},get_$6k:function(){this.$3y||(this.$3y=$72L(this));return this.$3y},get_$dD:function(){return this.$EF},set_$dD:function(n){if(n!==this.$EF){this.$EF=n;$3(this,"IsTransitionedIn")}return n},get_$89w:function(){this.$3za||(this.$3za=new _C(this.$$d_$9Sb,_a.$0.$AC));return this.$3za},$e6:function(){},$FZ:function(){this.$EF=!0},$l1:function(){this.$EF=!1},$TZ:function(){},$4PO:function(n){_d.$z0.prototype.$4PO.call(this,n);this.$3MQ()},$9Sb:function(){this.get_$5GR()&&this.$B.$7C(this)},$3MQ:function(){this.$3m.$BP()}};_d.$z0=function(n,t){this.$$d_$4PO=Function.createDelegate(this,this.$4PO);_d.$z0.initializeBase(this);_a.$3.$K(n,"owaShell");_a.$3.$K(t,"groupGenerator");this.$B=n;this.$31s=new _d.$1AL;this.$31s.add_$8DZ(this.$$d_$4PO);this.$IQ=t};_d.$z0.$7db=function(n,t){var i=new _g.$YH;i.Item=new _g.$1V(t);i.FieldURIOrConstant=new _g.$J6;var r=new _g.$J0;r.Value=n;i.FieldURIOrConstant.Item=r;return new _g.$JS(i)};_d.$z0.prototype={$31s:null,$IQ:null,$B:null,add_$6aB:function(n){this.$2G("SeekToConditionRequested",n)},remove_$6aB:function(n){this.$2H("SeekToConditionRequested",n)},get_$40o:function(){return this.$31s.get_$UY().get_$C()>28},get_$5GR:function(){return this.$IQ.$345},$4PO:function(n){var t=_d.$z0.$7db(n.$6aE,this.$IQ.$BV);$Cq(this,"SeekToConditionRequested",t)}};_d.$l3=function(n){this.$B=n};_d.$l3.prototype={$B:null,$183:null,$E:function(n,t,i,r){return new _d.$eN(this.$B,this.$183,n,t,i,r)}};_d.$l4=function(n,t){this.$B=n;this.$396=t};_d.$l4.prototype={$B:null,$396:null,$E:function(n){return new _d.$YT(this.$B,this.$396,n)}};_d.$UU=function(n){_d.$UU.initializeBase(this,[n])};function $72S(n,t,i,r){if(t&&t.get_$C()>0){var u=new _d.$2n(n.$2e,t.$7cF(0),i,"",!0);if(!_js.$8.$15(u.$Hb)){n.$2Iu&&u.add_$12w(n.$$d_$9h6);var f=new _d.$4y(n.$2e,r);f.get_$3O().$D(u);n.get_$3O().$D(f)}}}function $4r9(n,t,i,r){if(t&&t.get_$C()>0){var u=new _d.$2n(n.$2e,t.$7cF(0),i,"",!0);u.add_$12w(n.$$d_$AFp);var f=new _d.$4y(n.$2e,r);f.get_$3O().$D(u);n.get_$3O().$D(f)}}_d.$UU.prototype={$9vb:function(n){var t=this.$2Iu?_nbs.NonBootStrings.l_CallActionTitle_Text:"{0}";$72S(this,n.get_$mJ(),"PersonaBusinessPhoneNumbers",String.format(t,_nbs.NonBootStrings.l_Phone_Text));$4r9(this,n.get_$1MF(),"PersonaBusinessHomePages",_nbs.NonBootStrings.l_ViewWebPage_Text);$4r9(this,n.get_$1UA(),"PersonaPersonalHomePages",_nbs.NonBootStrings.l_ViewLocalWebPage_Text)}};_d.$3l=function(n,t,i,r,u,f,e,o){this.$$d_$9Xn=Function.createDelegate(this,this.$9Xn);this.$$d_$9QH=Function.createDelegate(this,this.$9QH);this.$$d_$9Nc=Function.createDelegate(this,this.$9Nc);this.$$d_$A2U=Function.createDelegate(this,this.$A2U);this.$$d_$A2T=Function.createDelegate(this,this.$A2T);this.$1yx=-1;_d.$3l.initializeBase(this,[[]]);_a.$3.$K(n,"sessionSettings");_a.$3.$K(t,"chatManager");_a.$3.$K(i,"personaViewModelFactory");_a.$3.$K(r,"actionSubmitter");_a.$3.$K(o,"signOutCommand");this.$7u=t;this.$8GL(n,i);this.$k=r;this.$B=u;this.$1H=f;this.$c=e;var h=this;this.$5fk=new _C(this.$$d_$A2T,_a.$0.$4c,this,_d.$3l.$2sK,function(){return h.get_$5Gv()!=="AttemptingSignIn"});var c=this;this.$5fl=new _C(this.$$d_$A2U,_a.$0.$4c,this,_d.$3l.$2sK,function(){return c.get_$5Gv()!=="AttemptingSignOut"});this.$6gs=o;this.$7u.apcl("SignInState",this.$$d_$9Nc);var s=_g.$V.get_$I();this.$1nC=$5(s)||$5(s.get_$5z())?!1:s.get_$5z().get_$2MA()&&s.get_$5z().get_$2fa();this.$5R7=this.$1nC?new _C(this.$$d_$9QH,_d.$3l.$A):null;$73o(this);this.$4Sw=new _y.$EX(this.$gV.get_$1u(),[13],this.$gV.get_$1u().get_$1o());this.$4Sw.$xH=2};function $73n(n,t){if(n.$1H.$3N("O365Header"))switch(t){case 2:return 42;case 3:return 43;case 5:return 44;case 4:return 45;case 6:return 46;case 1:return 47;case 0:default:return 48}else switch(t){case 2:return 1;case 3:return 7;case 5:return 13;case 4:return 19;case 6:return 25;case 1:return 31;case 0:default:return 37}}function $73o(n){if(n.$1nC){var t=new _0365m.$o(_nbs.NonBootStrings.l_OwaChangePhoto_Text,null,n.$5R7,!1,null,_nbs.NonBootStrings.l_OwaChangePhotoAriaLabel_Text,"MeCardView.EditPhoto");n.$14.$D(t)}n.$7u.get_$2a()&&$73l(n);$73k(n)}function $73l(n){n.$14.$D(new _0365m.$o(_nbs.NonBootStrings.l_IMSignIn_Text,null,n.$5fk,!0));n.$14.$D($2FO(n,_u.Strings.l_IMAvailablePresenceState_Text,"Online"));n.$14.$D($2FO(n,_u.Strings.l_IMBusyPresenceState_Text,"Busy"));n.$14.$D($2FO(n,_u.Strings.l_IMDnDPresenceState_Text,"DoNotDisturb"));n.$14.$D($2FO(n,_nbs.NonBootStrings.l_IMBeRightBackPresenceState_Text,"BeRightBack"));n.$14.$D($2FO(n,_nbs.NonBootStrings.l_IMAppearAwayPresenceState_Text,"Away"));var t=new _0365m.$o(_nbs.NonBootStrings.l_IMSignOut_Text,null,n.$5fl,!0);t.set_$r(!0);n.$14.$D(t);n.$14.$D(new _0365m.$8w);$4sD(n)}function $73k(n){n.$14.$D(new _0365m.$o(_nbs.NonBootStrings.l_OwaSignOut_Text,null,new _C(n.$6gs,_d.$3l.$A)))}function $2FO(n,t,i){var r=new _0365m.$o(t,_y.$SK.$3yb(n.$7u.$1xZ(i)),new _C($73m(n,i),_a.$0.$4c),!0);r.set_$r(!0);return r}function $73m(n,t){var i=this;return function(){n.$7u.$4iR("SetPresence",n.$gV.get_$1u().get_$Al(),t);n.$7u.$A4v(n.$gV.get_$1u().get_$Al(),t)}}function $4sD(n){var t=!1;var i=!1;n.set_$cp("");switch(n.$7u.get_$2gm()){case"AttemptingSignIn":$2l9(n,!0,_nbs.NonBootStrings.l_IMSigningIn_Text);break;case"SignedIn":$2l9(n,!1,null);i=!0;break;case"unknown":case"AttemptingSignOut":case"Disabled":case"SignedOut":$2l9(n,!1,null);t=!0;break;case"Error":n.set_$cp(_nbs.NonBootStrings.l_IMSigningInError_Text);$2l9(n,!1,null);t=!0;break;default:throw Error.invalidOperation("MeCardViewModel.UpdateChatMenuItemState: Unexpected SignInState: "+n.$7u.get_$2gm()+")");}$73p(n,t,i)}function $2l9(n,t,i){n.set_$7dj(i);n.set_$6D(t)}function $73p(n,t,i){var u=n.get_$8HV();var r=n.$14.get_$3o(u++);r.set_$r(!t);for(var f=0;f<_d.$3l.$6Gp-1;f++){r=n.$14.get_$3o(u++);r.set_$r(!i)}}_d.$3l.prototype={$k:null,$6gs:null,$5fk:null,$5fl:null,$5R7:null,$1nC:!1,$c:null,$4Sw:null,$B:null,$1H:null,$7u:null,$el:null,$gV:null,$8X:!1,$2qw:null,$98:null,get_$8UO:function(){return this.$gV},set_$8UO:function(n){this.$gV=n;return n},get_$293:function(){return $73n(this,this.$gV.get_$1u().$N4)},get_$5Gv:function(){return this.$7u.get_$2gm()},get_$35c:function(){return this.$7u.get_$2a()},get_$5j7:function(){return this.$7u.get_$2gm()==="SignedIn"&&!!this.$gV.get_$1u().$N4},get_$6D:function(){return this.$8X},set_$6D:function(n){this.$8X=n;$N(this,_d.$3l.$5hM);return n},get_$7dj:function(){return this.$2qw},set_$7dj:function(n){this.$2qw=n;$N(this,_d.$3l.$5Eh);return n},get_$cp:function(){return this.$98},set_$cp:function(n){this.$98=n;$N(this,_d.$3l.$3uG);return n},get_$8NM:function(){return(this.$gV.$Ou&1)==1},get_$8Up:function(){return String.format(_nbs.NonBootStrings.l_MeTileAriaLabel_Text,this.$4Sw.get_$1bP())},get_$8HV:function(){return this.$1nC?1:0},get_$ps:function(){if(!this.$el){this.$el=_d.$5a.$5L1(this.$B,this.$k,this.$c);var n=this;this.$el.add_$3XU(function(){n.$gV.$9mr()})}return this.$el},$qI:function(n){_a.$3.$K(n,"menuItem");if(this.$1yx===-1){this.$1yx=this.$14.get_$C()-1;this.$14.$6r(this.$1yx,new _0365m.$8w)}this.$14.$6r(this.$1yx,n);this.$1yx+=1},$8GL:function(n,t){var i=new _g.$1q;i.MailboxType="OneOff";i.EmailAddress=n.get_$AM();i.RoutingType="SMTP";i.Name=n.get_$Fn();i.SipUri=n.get_$1KU()||null;var r=_pc.$l.$Dh(i);r.$Y("Presence",this.$$d_$9Xn);this.$gV=t.$Vu(r,_y.$17.$Km,!1,5);var u=[1];this.$gV.$eL(1,u,"");if(this.$7u.get_$2a()){var f=this.$gV.$18;f.$2dL()}},$A2T:function(){this.$7u.$4cb(!0)},$A2U:function(){this.$7u.$6gq(!0)},$9Nc:function(n,t){$4sD(this);$N(this,_d.$3l.$2sK);$N(this,_d.$3l.$45T)},$9Xn:function(n,t){$N(this,_d.$3l.$6So);$N(this,_d.$3l.$45T);$N(this,_d.$3l.$5sa)},$9QH:function(){this.get_$ps().get_$2J5()?this.$B.$7C(this.get_$ps()):window.open(_a.$Cs.$1Om(window.location.pathname,_d.$3l.$5R8),_d.$3l.$5RA,_d.$3l.$5R9);this.set_$1O(!1)}};_d.$zF=function(n,t,i,r,u,f,e){this.$Cn=n;this.$5Gr=t;this.$5q=i;this.$k=r;this.$B=u;this.$1H=f;this.$c=e};_d.$zF.prototype={$Cn:null,$5Gr:null,$5q:null,$k:null,$c:null,$B:null,$1H:null,$3oy:function(n,t){var i=this;this.$5Gr.$E(function(r){t(new _d.$3l(i.$Cn,r.$E(),i.$5q,i.$k,i.$B,i.$1H,i.$c,n))})}};_d.$sE=function(){};_d.$sE.prototype={$2bC:null,$E:function(n,t){return new _d.$4l(n,t,this.$2bC)}};_d.$sD=function(){};_d.$sD.prototype={$5q:null,$E:function(n,t){return new _d.$Ux(n,t,this.$5q)}};_d.$OS=function(){};_d.$OS.get_$9gH=function(){return"IPM.Note.PeopleConnect.Notification.Connected"};_d.$OS.get_$9gI=function(){return"IPM.Note.PeopleConnect.Notification.Disconnected"};_d.$OS.$4Qg=function(){var n=_a.$Cs.$1Om(window.location.pathname,"Connect/PeopleConnections.aspx");var t=_a.$6.$1X(_a.$0.$AC,"PeopleConnectLinkClicked",!0);window.open(n,"_blank","width=580,height=300,toolbar=no,directories=no,status=no,menubar=no,scrollbars=no");_a.$6.$19(t)};_d.$V5=function(n,t,i,r){_d.$V5.initializeBase(this);this.$2E=n;this.$1Db=t;this.$5mt=i;this.$6eP=r};_d.$V5.prototype={$2E:null,$5mt:!1,$1Db:null,$6eP:!1,$6Z:!1,get_$8w:function(){return this.$1Db},get_$r:function(){return this.$6Z},set_$r:function(n){this.$6Z=n;return n}};_d.$Mv=function(n){this.$14t={};this.$5kq=n};_d.$Mv.$7gH=function(n){switch(n){case"PersonaDisplayNameFirstLast":case"PersonaDisplayNameLastFirst":return!0;case"PersonaCompanyName":case"PersonaHomeCity":case"PersonaWorkCity":case"PersonaCreationTime":return!1;default:throw Error.invalidOperation(String.format("Sorting by '{0}' isn't supported",n));}};function $74K(n,t){var r=$3bN(n,t);var i=r+n.$BV;if(i in n.$14t)return n.$14t[i];else{var f=n.$345&&n.$5kq;var u=new _d.$V5(r,i,!n.$345,f);n.$14t[i]=u;return u}}function $3bN(n,t){if($5(t))throw Error.invalidOperation("The persona to have a header generated should not be null");var i="";switch(n.$BV){case"PersonaDisplayNameFirstLast":i=t.get_$1vK();break;case"PersonaDisplayNameLastFirst":i=t.get_$1vM();break;case"PersonaCompanyName":i=_nbs.NonBootStrings.l_PeopleHeaderNoCompany_Text;_js.$8.$a(t.get_$mZ())||(i=t.get_$mZ().toLocaleUpperCase());break;case"PersonaHomeCity":i=_nbs.NonBootStrings.l_PeopleHeaderNoCity_Text;_js.$8.$a(t.get_$1dS())||(i=t.get_$1dS().toLocaleUpperCase());break;case"PersonaWorkCity":i=_nbs.NonBootStrings.l_PeopleHeaderNoCity_Text;_js.$8.$a(t.get_$1pT())||(i=t.get_$1pT().toLocaleUpperCase());break;case"PersonaCreationTime":i=_nbs.NonBootStrings.l_PeopleHeaderNoCreationTime_Text;if(!$5(t.get_$2uE())){var r=_y.$Xn.$AIL(_y.$ND,t.get_$2uE(),n.$3NX);i=r.$nJ.toLocaleUpperCase()}break;default:throw Error.invalidOperation(String.format("Sorting by '{0}' isn't supported",n.$BV));}return i}_d.$Mv.prototype={$14t:null,$5kq:!1,$3NX:null,$2Dk:null,$BV:"FolderId",$345:!1,get_$5Mz:function(){return this.$BV},set_$5Mz:function(n){this.$BV=n;if(this.$BV==="PersonaCreationTime"){var t,i;this.$3NX=(i=_y.$Cg.$$(_a.$9K).$88j(_a.$7.get_$2F(),t={val:this.$2Dk}),this.$2Dk=t.val,i)}this.$345=_d.$Mv.$7gH(this.$BV);return n},get_$47C:function(){return this.$BV==="PersonaCreationTime"},$C0:function(){return this.get_$47C()?this.$2Dk.$5kz():!0},$5WU:function(n,t){var i=n;var r=t;var u=$5(r)||$3bN(this,i)!==$3bN(this,r);var f=$74K(this,i);return new _0365m.$do(f,u)}};_d.$LY=function(n,t,i,r){this.$B=n;this.$1H=t;this.$Jg=i;this.$ox=r};_d.$LY.prototype={$B:null,$1H:null,$Jg:null,$ox:null,$E:function(n,t){return new _d.$7v(n,t,this.$ox,this.$1H,this.$B)},$br:function(n,t){throw Error.notImplemented();},$wx:function(n,t){var r=n;var i=this.$E(new _d.$Ic,3);i.$8RZ(r);this.$42Q();return i},$42Q:function(){if(this.$B.get_$L()==="Mouse"){var n=this;this.$Jg.$E(function(n){_g.$1Y.$N2.$42Q(n.$E())})}}};_d.$1CL=function(n,t,i){this.$$d_$6R1=Function.createDelegate(this,this.$6R1);_d.$1CL.initializeBase(this,[n]);this.$k=t;this.$dy=i};_d.$1CL.prototype={$k:null,$dy:null,add_$2bv:function(n){this.$2G("PersonaPickedCompleted",n)},remove_$2bv:function(n){this.$2H("PersonaPickedCompleted",n)},get_$5JN:function(){return _nbs.NonBootStrings.l_PeoplePickerSearchPersonaList_AT_Text},$Vu:function(n){var t=new _d.$Hs(n,_y.$17.$Km,!1,this.$e1,this.$k,this.$dy,this);$4sc(this,t);t.add_$2bv(this.$$d_$6R1);return t},$6R1:function(n){$Cq(this,"PersonaPickedCompleted",n)}};_d.$SC=function(n,t,i,r){this.$$d_$6Ik=Function.createDelegate(this,this.$6Ik);_d.$SC.initializeBase(this,[i,null,"GroupsNavigationTreeTemplates.GroupItemViewWithoutUnseenCount",r]);this.$B=n;this.$BR=t;this.$45=new _d.$8m(n,0,n.get_$L()==="Mouse",n.get_$L()==="TouchNarrow",!0);this.set_$4K(this.$45.$T2);this.$45.$3SE=!1;this.$45.$Y("CurrentConfiguration",this.$$d_$6Ik);var u=this;this.$45.$Y("IsSidePanelExpanded",function(){u.set_$4K(u.$45.$T2)})};_d.$SC.$7nH=function(n,t,i,r){return n.get_$L()==="Mouse"&&r&&i&&i.$3N("ModernGroups")?new _d.$SC(n,t,_u.Strings.l_NewString_LowerCase_Text,r):null};_d.$SC.prototype={$B:null,$45:null,$BR:null,$6JF:function(){_y.$IY.prototype.$6JF.call(this);this.$B.get_$L()==="Mouse"&&this.$45.$5m()},$6JG:function(){_y.$IY.prototype.$6JG.call(this);this.$B.get_$L()==="Mouse"&&this.$45.$5m();this.$45.set_$eJ(null)},$9OM:function(n){if(n){this.$BR.$We(_a.$93.$j8(2));this.$HG&&this.$HG.$1JL(null)}},$4QC:function(n,t){_y.$IY.prototype.$4QC.call(this,n,t);if(this.$HG.get_$pJ()){this.$BR.$We(_a.$93.$2zQ(this.$HG.get_$pJ().get_$68(),2));this.$45.set_$eJ(null)}},$27X:function(){_y.$IY.prototype.$27X.call(this);this.$45.set_$sF(this.$2V)},$6Ik:function(n,t){this.$9OM(this.$45.$9Q)}};_d.$1CM=function(n,t,i,r){this.$$d_$6R1=Function.createDelegate(this,this.$6R1);_d.$1CM.initializeBase(this,[n,t,i]);this.$dy=r};_d.$1CM.prototype={$dy:null,add_$2bv:function(n){this.$2G("PersonaPickedCompleted",n)},remove_$2bv:function(n){this.$2H("PersonaPickedCompleted",n)},get_$5JN:function(){return _nbs.NonBootStrings.l_PeoplePickerPersonaList_AT_Text},get_$9gr:function(){return 41},$Vu:function(n){var t=this.$5q.$7nL(n,this.$2bp,!1,this.$e1,this.$dy,this);$4sd(this,t);t.add_$2bv(this.$$d_$6R1);return t},$6R1:function(n){$Cq(this,"PersonaPickedCompleted",n)}};_d.$Hs=function(n,t,i,r,u,f,e){this.$$d_$6Jw=Function.createDelegate(this,this.$6Jw);this.$$d_$4Or=Function.createDelegate(this,this.$4Or);this.$$d_$9L8=Function.createDelegate(this,this.$9L8);this.$$d_$9bD=Function.createDelegate(this,this.$9bD);_d.$Hs.initializeBase(this,[n,t,i,r]);this.$k=u;this.$dy=f;this.$4St=e;if(this.$B.get_$L()!=="TouchNarrow"){this.set_$1Co(!0);this.set_$Vx(new _C(this.$$d_$9bD,_d.$Hs.$A))}};function $3bO(n){n.$9i2();var t=n.get_$1vn().$14;if(t.get_$C()<2){n.get_$1vn().set_$1O(!1);t.$1t();n.$4Or(n.get_$1u().get_$1l())}else n.get_$1vn().set_$1O(!0)}_d.$Hs.prototype={$k:null,$dy:null,$4St:null,$3te:null,$3h6:null,get_$489:function(){return this.$B.get_$L()==="TouchNarrow"},get_$7YZ:function(){return String.format(_nbs.NonBootStrings.l_PeoplePickerAddContactButton_AT_Text,this.$Gx)},get_$7Xz:function(){this.$3h6||(this.$3h6=new _C(this.$$d_$9L8,_a.$0.$dz));return this.$3h6},add_$2bv:function(n){this.$2G("PersonaPickedCompleted",n)},remove_$2bv:function(n){this.$2H("PersonaPickedCompleted",n)},get_$1vn:function(){this.$3te||(this.$3te=new _0365m.$2c([]));return this.$3te},$9i2:function(){if(this.get_$1u().get_$6G()){var i=this.get_$1u().get_$6G().length;var n=[];this.get_$1vn().$14.$1t();for(var t=0;t<i;t++)if(this.get_$1u().get_$6G()[t]){var r=new(_a.$CG.$$(_g.$1q))(this.get_$1u().get_$6G()[t],this.$$d_$4Or);Array.add(n,new _0365m.$o(this.get_$1u().get_$6G()[t].Name,null,new _C(r.$$d_$AGx,_d.$Hs.$A)));Array.add(n,new _0365m.$8w)}n.length>0&&Array.removeAt(n,n.length-1);this.get_$1vn().$14.$6S(n)}},$4Or:function(n){var t=new _pc.$l;t.$Qq(this.get_$1u().$Od());t.set_$1l($3fu(this,n));$Cq(this,"PersonaPickedCompleted",t)},$9L8:function(){if(this.$4St.get_$1p()===this.get_$1u()&&this.$dy.get_$CQ().$7f&&this.$dy.get_$CQ().$7f.$18.get_$BO()===3){this.set_$1u(this.$dy.get_$CQ().$7f.$18);this.$4St.$2Bj(this)}if(this.get_$1u().get_$1J()!==1||this.get_$1u().get_$BO()===3||_js.$8.$a(this.get_$1u().get_$rS()))$3bO(this);else{var n=null;this.get_$1u().get_$6P()?n=_pc.$K3.$5MN(this.get_$1u().get_$6P(),this.get_$1u().get_$rS()):this.get_$1u().get_$1l()&&this.get_$1u().get_$1l().EmailAddress&&_a.$3q.$WP(this.get_$1u().get_$1l().EmailAddress)&&(n=_pc.$K3.$5MM(this.get_$1u().get_$1l()));if(n){n.add_$2t(this.$$d_$6Jw);n.$FO=0;this.$k.$11(n)}else $3bO(this)}},$6Jw:function(n){var t=n;t.$1d||this.set_$1u(t.$18);$3bO(this)},$9bD:function(){this.$4Or(this.get_$1u().get_$1l())}};_d.$sk=function(){this.$2KY="";_d.$sk.initializeBase(this)};_d.$sk.prototype={$1VZ:0,get_$1mU:function(){return this.$1VZ},set_$1mU:function(n){if(this.$1VZ!==n){this.$1VZ=n;$3(this,"SelectedPeopleSearchRefiner")}return n},get_$5MZ:function(){return this.$2KY},set_$5MZ:function(n){if(this.$2KY!==n){this.$2KY=n;$3(this,"CurrentFolderRefinerDisplayName")}return n},$9vI:function(n,t){!n||n.get_$35T()||n.get_$1Q8()?this.set_$5MZ(""):this.set_$5MZ(String.format(_nbs.NonBootStrings.l_PeopleCurrentFolderContainer_Text,t.get_$1o()))}};_d.$SE=function(n,t,i){this.$$d_$9Qv=Function.createDelegate(this,this.$9Qv);this.$kv=-1;_d.$SE.resolveInheritance();this.apcl=this.$Y;this.rpcl=this.$q;_d.$SE.initializeBase(this);this.$B=n;this.$VD=new _js.$c;this.$4So=t;this.$je=i.$3N("InstantSearch")};function $4sT(n){for(var t=0;t<n.$VD.get_$C()&&n.$2B2;t++)if(n.$2B2===n.$VD.get_$3o(t)){n.set_$15U(!1);n.$73=n.$2B2;n.set_$EG(t);break}}function $74P(n,t){n.$73=t;n.$73.set_$jg(!0)}_d.$SE.prototype={$14D:null,$2V:!1,$44x:!1,$1Qb:!1,$2TB:!1,$1Sy:0,$B:null,$4Sn:null,$VD:null,$73:null,$3F:null,$2B2:null,$4So:null,$je:!1,get_$5P5:function(){return!!this.$73&&this.$73.get_$jg()},get_$21S:function(){return this.$44x},set_$21S:function(n){if(this.$44x!==n){this.$44x=n;$N(this,"IsSuggestionPopulationInProgress");this.set_$2SS(!n)}return n},get_$15U:function(){return this.$1Qb},set_$15U:function(n){if(this.$1Qb!==n){this.$1Qb=n;$N(this,"IsModuleLinkSelected")}return n},get_$2SS:function(){return this.$2TB},set_$2SS:function(n){if(this.$2TB!==n){this.$2TB=n;$N(this,"IsPeopleModuleSuggestionVisible");if(this.$1Qb&&!n){this.set_$15U(!1);this.set_$EG(-1)}}return n},get_$EG:function(){return this.$kv},set_$EG:function(n){if(this.$kv!==n){this.$kv=n;$N(this,"ItemHighlightedIndex");if(this.$je)return n;this.$kv>=0&&this.$kv<this.$VD.get_$C()&&$74P(this,this.$VD.get_$3o(this.$kv))}return n},get_$3O:function(){return this.$VD},get_$4Lh:function(){return-1},set_$4Lh:function(n){return n},get_$7D:function(){return this.$3F},set_$7D:function(n){this.$3F=n;return n},get_$1p:function(){return this.$2B2},set_$1p:function(n){if(this.$2B2!==n){this.$2B2=n;$N(this,"SelectedItem");$4sT(this)}return n},get_$3Y4:function(){return this.$4Sn},set_$3Y4:function(n){if(this.$4Sn!==n){this.$4Sn=n;$4sT(this)}return n},$5Ha:function(){this.$73=null;this.$14D=null;this.$VD.$1t();this.set_$EG(-1);this.set_$21S(!1);this.set_$2SS(!1);this.set_$15U(!1);this.$2V=!1},$xY:function(){if(!_js.$8.$a(this.$3F)&&this.$2V)if(this.$3F.trim().length>=4&&this.$VD.get_$C()<5){this.$14D=_pc.$15.$1NC(this.$3F,_g.$2Z.$BJ("directory"),null,_pc.$15.$wy(0,5),null,null,_pc.$15.$mr,4);this.$14D.add_$2t(this.$$d_$9Qv);OwaApplication.$1W.$11(this.$14D)}else this.set_$21S(!1)},$2ex:function(n){this.$73&&this.$73.set_$jg(!1);var t=1;(n||this.$2TB)&&(t=0);this.$1Qb&&this.set_$15U(!1);this.$kv<this.$VD.get_$C()-t&&this.set_$EG(this.$kv+1);this.$kv===this.$VD.get_$C()&&this.$2TB&&this.set_$15U(!0);return this.$kv<this.$VD.get_$C()||this.$1Qb},$2f2:function(n){this.$73&&this.$73.set_$jg(!1);var t=n?1:0;this.$1Qb&&this.set_$15U(!1);this.$kv>=t&&this.set_$EG(this.$kv-1);return this.$kv>=0},$2CI:function(){var t=this.$3F.trim().length;this.$VD.$1t();this.set_$EG(-1);if(this.$B.get_$L()==="Mouse"){this.$2V=!0;var i=[1];var r=_d.$5r.$3yW(this.$3F,5,0,null);var n=this;Array.forEach(r,function(t){var r=n.$4So.$Vu(t,_y.$17.$Km,!1,1);r.$eL(1,i,"");n.$je?r.set_$E5(!1):r.set_$E5(!0);r.$OP.set_$3M5(1);n.$VD.$D(r)});this.$VD.get_$C()<5&&t>=this.$1Sy&&t>=4?this.set_$21S(!0):this.set_$2SS(!0)}},$9Qv:function(n){n.remove_$2t(this.$$d_$9Qv);if(this.$14D===n){if(this.$VD.get_$C()<5&&$5(n.$1d)){for(var u=n.get_$18i(),o=[1],s=this.$VD.get_$C(),i=0;i<u.get_$C()&&this.$VD.get_$C()<5;i++){for(var f=u.get_$3o(i),e=!0,r=0;r<s;r++)if(_pc.$l.$31V(f,this.$VD.get_$3o(r).get_$1u())){e=!1;break}if(e){var t=this.$4So.$Vu(f,_y.$17.$Km,!1,1);t.$eL(1,o,"");t.set_$E5(!0);t.$OP.set_$3M5(1);this.$VD.$D(t)}}this.$1Qb&&this.set_$EG(this.$VD.get_$C())}this.set_$21S(!1)}}};_d.$4y=function(n,t){this.$$d_$9bW=Function.createDelegate(this,this.$9bW);_d.$4y.initializeBase(this);this.$1kf=-1;this.$2e=n;this.set_$4o(t);this.$1fK=!1};_d.$4y.$AJg=function(n,t,i,r){var f="";if(r.length)if(t&&t.get_$C()){for(var o={},v=t.get_$C(),s=0;s<v;s++){var h=t.$7cF(s);if(h.get_$3p())for(var y=h.get_$3p().length,c=0;c<y;c++){var e=i.$14Y(h.get_$3p()[c]);!e||!e.get_$sK()||e.get_$1y()in o||(o[e.get_$1y()]=1)}else return""}for(var p=r.length,l=0;l<p;l++){var a=r[l].get_$1y();if(!(a in o)){f=a;break}}}else f=r[0].get_$1y();else{i.get_$3p()||i.set_$3p(new _js.$c);var u=new _pc.$6C;u.set_$sK(!0);u.set_$1o("Outlook");u.set_$1y(i.get_$3p().get_$C().toString());u.set_$r(!1);f=u.get_$1y();i.get_$3p().$D(u)}return f};_d.$4y.$AJh=function(n,t,i){var u=i.get_$2ji().length;var f=_d.$4y.$AJg(n,t,i.get_$1u(),i.get_$2ji());if(!u){var r=i.get_$1u().get_$3p().get_$3o(0);i.set_$7Xy(r.get_$1y());i.set_$2ji([r])}return f};function $3bQ(n){n.get_$qB().$14.$1t();n.get_$qB().$14.$6S(n.get_$Pj())}function $74T(n,t){var r=-1;var i=null;if(t in n.get_$1D5()||t in n.get_$2NE())if(t===_nbs.NonBootStrings.l_BusinessPhoneNumber_Text||t===_nbs.NonBootStrings.l_HomePhoneNumber_Text||t===_nbs.NonBootStrings.l_MobilePhoneNumber_Text){r=n.get_$1D5()[t];--n.$1kf;n.set_$Pj($3bR(n,n.get_$Pj(),r,n.get_$1D5()))}else{i=n.get_$Pj()[n.$1kf];r=n.get_$2NE()[t];i.$I9.$14.$6C(r);for(var f=0,o=i.$I9.$14.get_$C(),u=0;u<o;u++){var e=i.$I9.$14.get_$3o(u);e.$2E in n.get_$2NE()&&(n.get_$2NE()[e.$2E]=f);f++}i.$I9.$14.get_$C()||n.set_$Pj($3bR(n,n.get_$Pj(),n.$1kf,n.get_$1D5()))}}function $3bR(n,t,i,r){for(var o=[],f=0,s=t.length,u=0;u<s;u++)if(t[u]&&u!==i){var e=t[u];e.$2E in r&&(r[e.$2E]=f);o[f]=e;f++}return o}function $74S(n,t){if(n.get_$4o()===_nbs.NonBootStrings.l_Phone_Text){$74T(n,t);return}var i=-1;if(t in n.get_$1D5()){i=n.get_$1D5()[t];n.set_$Pj($3bR(n,n.get_$Pj(),i,n.get_$1D5()))}}_d.$4y.prototype={$2e:null,$1fK:!1,$1kf:0,$3vM:null,$3vN:null,$2oF:null,$2oE:null,$4bd:null,get_$8Mm:function(){return this.get_$4o()!==_nbs.NonBootStrings.l_LinkItem_Text},get_$8MZ:function(){return this.$1fK&&this.get_$3O().get_$C()>0},get_$7Y4:function(){return this.$2e.get_$28G().get_$L()==="Mouse"?_d.$4.get_$59n():_d.$4.get_$59m()},get_$7Y3:function(){return this.$2e.get_$28G().get_$L()==="Mouse"?_d.$4.get_$59o():_d.$4.get_$59m()},get_$7Y2:function(){return this.$2e.get_$28G().get_$L()==="Mouse"?_d.$4.get_$7Xp():_d.$4.get_$7Xq()},get_$7Y5:function(){return this.$2e.get_$28G().get_$L()==="Mouse"?_d.$4.get_$59o():_d.$4.get_$7Xo()},get_$9zf:function(){if(!this.$4bd){var n=this;this.$4bd=new _C(this.$$d_$9bW,_d.$4y.$A,this,"CanDisplayAddFieldMenu",function(){return n.get_$7fH()})}return this.$4bd},get_$7fH:function(){return this.get_$Pj().length>0},get_$qB:function(){this.$2oF||(this.$2oF=new _0365m.$2c(this.get_$Pj()));return this.$2oF},set_$qB:function(n){this.$2oF=n;$L8(this,"AddFieldsMenuViewModel","CanDisplayAddFieldMenu","ShowAddFieldMenuCommand");return n},get_$Ag:function(){if(this.get_$1zc()){var n=this.get_$3O().get_$3o(0);return n.get_$Ag()}return null},get_$1zc:function(){if(this.$2e.get_$66())return!0;if(this.get_$3O().get_$C()!==1||this.$2e.get_$1Dn()&&this.$2e.get_$2t8().$2wF)return!1;var n=this.get_$3O().get_$3o(0);return n.get_$1zc()},get_$7Xi:function(){return _js.$8.$4B(_nbs.NonBootStrings.l_PersonaAddField_AT_Tooltip_Text,this.get_$4o())},get_$Pj:function(){this.$2oE||(this.$2oE=[]);return this.$2oE},set_$Pj:function(n){this.$2oE=n;$3bQ(this);return n},get_$1D5:function(){this.$3vM||(this.$3vM={});return this.$3vM},get_$2NE:function(){this.$3vN||(this.$3vN={});return this.$3vN},$5WT:function(){var n=this.get_$4o();this.$1fK&&(n+=_nbs.NonBootStrings.l_PersonaCardGroupHeaderGroupLabel_Text);n+=".";return n},$AJi:function(n,t,i){if(this.$2e.get_$66()){_a.$3.$1K3(t,"profileFields");var r=this;var e=new(_d.$4y.$2bn.$$(n))(this.$2e,i,t,function(n,t,u){var e=r.$2e.get_$66()===2||r.$2e.get_$66()===3;r.$2e.get_$66()===1&&r.$1fK&&(e=!0);var f=new _d.$2n(r.$2e,t,n.get_$29K(),n.get_$4o(),e);r.$2e.get_$66()===1&&n.get_$29K()==="PersonaAssistantNames"&&f.set_$1E6(!1);r.$1fK&&n.get_$29K()!=="PersonaTitles"||f.set_$JX(!0);i===_nbs.NonBootStrings.l_Email_Text&&r.$2e.get_$66()===2&&f.set_$JX(!1);r.get_$3O().$D(f);if(!u.get_$AHh()){$74S(r,u.get_$AHg());$3bQ(r)}});if(e.get_$AHh()){var u=this.get_$Pj().length;var o=new _0365m.$o(i,null,new _C(e.$$d_$AHi,_d.$4y.$A));if(this.get_$4o()===_nbs.NonBootStrings.l_Phone_Text&&i!==_nbs.NonBootStrings.l_BusinessPhoneNumber_Text&&i!==_nbs.NonBootStrings.l_HomePhoneNumber_Text&&i!==_nbs.NonBootStrings.l_MobilePhoneNumber_Text){var f=null;if(this.$1kf===-1){var s=[];f=new _0365m.$HH(_nbs.NonBootStrings.l_OtherPhoneNumber_Text,null,new _0365m.$2c(s));this.get_$Pj()[u]=f;this.$1kf=u;this.get_$1D5()[_nbs.NonBootStrings.l_OtherPhoneNumber_Text]=u}else f=this.get_$Pj()[this.$1kf];this.get_$2NE()[i]=f.$I9.$14.get_$C();f.$I9.$14.$D(o)}else{this.get_$Pj()[u]=o;this.get_$1D5()[i]=u}$3bQ(this)}}},$6n6:function(){$3u(this,"IsClickable","ClickCommand")},$7Y6:function(){this.get_$Pj().length>0&&this.get_$Pj()[0].$QK.$s()},$5MJ:function(n){throw Error.notImplemented();},$9bW:function(){if(this.get_$Pj().length>0)if(this.get_$4o()===_nbs.NonBootStrings.l_Phone_Text)if(this.get_$Pj().length===1)if(this.get_$Pj()[0].$2E===_nbs.NonBootStrings.l_OtherPhoneNumber_Text){var n=this.get_$Pj()[0];if(n.$I9.$14.get_$C()===1){this.get_$qB().set_$1O(!1);this.get_$qB().$14.$1t();n.$I9.$14.get_$3o(0).$QK.$s();$3(this,"CanDisplayAddFieldMenu")}else this.get_$qB().set_$1O(!0)}else{this.get_$qB().set_$1O(!1);this.get_$qB().$14.$1t();this.get_$Pj()[0].$QK.$s();$3(this,"CanDisplayAddFieldMenu")}else this.get_$qB().set_$1O(!0);else if(this.get_$Pj().length>1)this.get_$qB().set_$1O(!0);else{this.get_$qB().set_$1O(!1);this.get_$qB().$14.$1t();this.get_$Pj()[0].$QK.$s();$3(this,"CanDisplayAddFieldMenu")}}};_d.$4y.$2bn=function(n,t,i,r){this.$$d_$AHi=Function.createDelegate(this,this.$AHi);this.$2e=n;this.$5b1=t;this.$6Tu=i;this.$5AN=r};_d.$4y.$2bn.$$=function(n){var t="$2bn"+"$1"+"$"+n.getName().replace(/\./g,"_");if(!_d.$4y[t]){var r=_d.$4y[t]=function(){(this.$$gta=this.$$gta||{})["_d.$4y.$2bn"]={T:n};for(var i=[],t=0;t<arguments.length;++t)i[t]=arguments[t];_d.$4y.$2bn.apply(this,i)};r.registerClass("_d.PersonaCardProfileFieldsGroupListViewModel."+t);var u=_d.$4y.$2bn.prototype;for(var f in u){var i={key:f,value:u[f]};"constructor"!==i.key&&(r.prototype[i.key]=i.value)}}return _d.$4y[t]};_d.$4y.$2bn.prototype={$2e:null,$6Tu:null,$5AN:null,$5b1:null,get_$A7:function(){return this.$2e},get_$AHg:function(){return this.$5b1},get_$2cb:function(){return this.$6Tu},get_$7Yc:function(){return this.$5AN},get_$AHh:function(){for(var t=this.get_$2cb().length,n=0;n<t;n++){var i=_d.$4y.$AJh(this.$$gta["_d.$4y.$2bn"].T,this.get_$2cb()[n].get_$AHy(),this.get_$A7());if(!_js.$8.$a(i))return!0}return!1},$AHi:function(){var i=null;var r=!1;var t=0;var f=this.get_$2cb().length;for(t=0;t<f;t++){var n=this.get_$2cb()[t];r||n.get_$29K()!=="PersonaTitles"||(r=!0);var u=_d.$4y.$AJh(this.$$gta["_d.$4y.$2bn"].T,n.get_$AHy(),this.get_$A7());if(!_js.$8.$a(u)){this.get_$A7().set_$44q(!1);if(!n.get_$AHy()){var e=n.$AHz(this.get_$A7().get_$1u());n.set_$AHy(e)}i=n.$AI1(n.$AI0(),[u]);if(i)this.get_$7Yc()(this.get_$2cb()[t],i,this);else throw Error.invalidOperation("Trying to add field when no new field can be added");if(!r)break}}}};_d.$1Q=function(n,t){this.$$d_$8FO=Function.createDelegate(this,this.$8FO);this.$$d_$7uz=Function.createDelegate(this,this.$7uz);this.$$d_$9Qu=Function.createDelegate(this,this.$9Qu);_d.$1Q.initializeBase(this,[n]);this.$2yL=t;this.$wl()};_d.$1Q.$1rn=function(n,t){if(!n)return t;var i=n.$1Ll();i&&(t=t.concat.apply(t,i));return t};_d.$1Q.$AJv=function(n,t,i,r,u){if(!r.get_$1u().$AJo(n,t,u)){var f=_d.$4y.$AJh(n,t,r);t||(t=new(_pc.$1F.$$(n)));t.$D(i,f);u.val=t.$7cF(0)}return t};_d.$1Q.$AJw=function(n,t,i){if(!t)return null;for(var u=new(_pc.$1F.$$(n)),e=t.get_$C(),f=0;f<e;++f){var r=t.$7cF(f);_d.$2n.$15k(r.get_$1n())||(i?u.$5AB(r.get_$1n(),r.get_$3p()):u.$AIC(r.get_$1n(),r.get_$3p()))}return u.get_$C()?u:null};_d.$1Q.$AJx=function(n,t){if(!t)return!1;var r=t.length;if(!r)return!1;for(var u=new(_pc.$1F.$$(n)),i=0;i<r;i++)u.$AIB(t[i].get_$AHy());return _d.$1Q.$AJy(n,u)};_d.$1Q.$AJy=function(n,t){if(!t)return!1;for(var f={},e=t.get_$C(),i=0;i<e;i++)for(var o=t.$7cF(i).get_$3p(),s=o.length,r=0;r<s;r++)f[o[r]]=!0;for(var h=_0365f.$5F.$C(f),u=0;u<e;u++){var c=t.$7cF(u);if(c.get_$3p().length!==h)return!0}return!1};function $74h(n,t,i){if(!t.$Af||!t.$Af.get_$1n())return!1;if(_g.$2R.$YG(t.$Af.get_$1n())){i?t.remove_$12w(n.$$d_$7uz):t.add_$12w(n.$$d_$7uz);return!0}if(_g.$Lb.$20s(t.$Af.get_$1n())&&n.$2Iu){i?t.remove_$12w(n.$$d_$9h6):t.add_$12w(n.$$d_$9h6);return!0}if(t.$Ly==="PersonaPersonalHomePages"||t.$Ly==="PersonaBusinessHomePages"){var r=t.$Af.get_$3p()[0];var u=n.$2e.get_$1u().$14Y(r);(t.get_$5kF()||r===_nbs.NonBootStrings.l_PeopleSharepointProfileName_Text||u.get_$1o()==="Facebook"||u.get_$1o()==="LinkedIn")&&(i?t.remove_$12w(n.$$d_$AFp):t.add_$12w(n.$$d_$AFp));return!0}t.$Ly==="PersonaImAddresses"&&(i?t.remove_$12w(n.$$d_$8FO):n.$2e.get_$1yo()||i||t.add_$12w(n.$$d_$8FO));return!1}function $74Y(n){if(n.$2e.get_$66()){var t=n.$2e.get_$1u();var i;var f,e;var l=(e=_d.$1Q.$AJv(String,t.get_$1P0(),"",n.$2e,f={val:i}),i=f.val,e);t.get_$1P0()||t.set_$1P0(l);n.$2NS=new _d.$2n(n.$2e,i,"PersonaGivenNames",_nbs.NonBootStrings.l_GivenName_Text,!0);var r;var o,s;var a=(s=_d.$1Q.$AJv(String,t.get_$1Sw(),"",n.$2e,o={val:r}),r=o.val,s);t.get_$1Sw()||t.set_$1Sw(a);n.$2Z9=new _d.$2n(n.$2e,r,"PersonaMiddleNames",_nbs.NonBootStrings.l_MiddleName_Text,!0);var u;var h,c;var v=(c=_d.$1Q.$AJv(String,t.get_$1Jn(),"",n.$2e,h={val:u}),u=h.val,c);t.get_$1Jn()||t.set_$1Jn(v);n.$2U0=new _d.$2n(n.$2e,u,"PersonaSurnames",_nbs.NonBootStrings.l_Surname_Text,!0);$L8(n,"FirstName","MiddleName","LastName")}}function $74j(n){var t=null;if(n.$2e.get_$66()){t=new _d.$4y(n.$2e,_nbs.NonBootStrings.l_YOMI_Text);n.$Ob[n.$Ob.length]=t}var i=n.$2e.get_$1u();n.$AK1(String,t,[new _d.$HA(_nbs.NonBootStrings.l_Company_Text,"PersonaYomiCompanyNames",i.get_$2jk())],_nbs.NonBootStrings.l_Company_Text,!1);n.$AK1(String,t,[new _d.$HA(_nbs.NonBootStrings.l_Surname_Text,"PersonaYomiLastNames",i.get_$1pd())],_nbs.NonBootStrings.l_Surname_Text,!1);n.$AK1(String,t,[new _d.$HA(_nbs.NonBootStrings.l_GivenName_Text,"PersonaYomiFirstNames",i.get_$1pb())],_nbs.NonBootStrings.l_GivenName_Text,!1)}function $74U(n){var i=null;var f=n.$2e.get_$66();var u;if(f){i=new _d.$4y(n.$2e,_nbs.NonBootStrings.l_Email_Text);n.$Ob[n.$Ob.length]=i;u=""}else u=String.format(_nbs.NonBootStrings.l_SendActionTitle_Text,_nbs.NonBootStrings.l_Email_Text);var r=[];if(f){var t=n.$2e.get_$1u();r=[new _d.$m2(_nbs.NonBootStrings.l_Email_ProfileField_Text,"PersonaEmails1",t.get_$UO(),t),new _d.$m2(_nbs.NonBootStrings.l_Email2_Text,"PersonaEmails2",t.get_$13x(),t),new _d.$m2(_nbs.NonBootStrings.l_Email3_Text,"PersonaEmails3",t.get_$13y(),t)]}else{var e=$74m(n);r[r.length]=new _d.$m2(n.$2e.get_$1Dn()?_nbs.NonBootStrings.l_Email_Text:u,"PersonaEmailAddress",e,n.$2e.get_$1u())}n.$AK1(_g.$1q,i,r,_nbs.NonBootStrings.l_Email_Text,!0);n.$2e.get_$66()===2&&i.$7Y6()}function $74m(n){var i=n.$2e.get_$1u();var t=new(_pc.$1F.$$(_g.$1q));n.$AK2(_g.$1q,i.get_$UO(),t);n.$AK2(_g.$1q,i.get_$13x(),t);n.$AK2(_g.$1q,i.get_$13y(),t);return t}function $3bS(n,t,i){var r=new(_pc.$1F.$$(_g.$3G));n.$AK2(_g.$3G,t,r);n.$AK2(_g.$3G,i,r);return r}function $74W(n){var t=null;var r=n.$2e.get_$66();var u=n.$2e.get_$1u();if(r){t=new _d.$4y(n.$2e,_nbs.NonBootStrings.l_IMAddress_Text);n.$Ob[n.$Ob.length]=t}var i=_nbs.NonBootStrings.l_IMAddress_Text;r?i=_nbs.NonBootStrings.l_IMAddress_ProfileField_Text:n.$2e.get_$1yo()||(i=String.format(_nbs.NonBootStrings.l_SendActionTitle_Text,_nbs.NonBootStrings.l_IMAddress_Text));var f=[new _d.$HA(i,"PersonaImAddresses",u.get_$g4())];n.$AK1(String,t,f,_nbs.NonBootStrings.l_IMAddress_Text,!0)}function $74c(n){var i=null;var t=n.$2e.get_$1u();var r=!n.$2e.get_$66();if(!r){i=new _d.$4y(n.$2e,_nbs.NonBootStrings.l_Phone_Text);n.$Ob[n.$Ob.length]=i}var u=n.$2Iu?_nbs.NonBootStrings.l_CallActionTitle_Text:"{0}";var f=[];if(r){var e=$3bS(n,t.get_$mJ(),t.get_$12c());f[f.length]=new _d.$F2(String.format(u,_nbs.NonBootStrings.l_BusinessPhoneNumber_Text),"PersonaBusinessPhoneNumbers",e)}else f=[new _d.$F2(_nbs.NonBootStrings.l_BusinessPhoneNumber_ProfileField_Text,"PersonaBusinessPhoneNumbers",t.get_$mJ()),new _d.$F2(_nbs.NonBootStrings.l_BusinessPhoneNumber2_ProfileField_Text,"PersonaBusinessPhoneNumbers2",t.get_$12c())];n.$AK1(_g.$3G,i,f,_nbs.NonBootStrings.l_BusinessPhoneNumber_Text,!1);f=[];if(r){var o=$3bS(n,t.get_$rj(),t.get_$14w());f[f.length]=new _d.$F2(String.format(u,_nbs.NonBootStrings.l_HomePhoneNumber_Text),"PersonaHomePhones",o)}else f=[new _d.$F2(_nbs.NonBootStrings.l_HomePhoneNumber_ProfileField_Text,"PersonaHomePhones",t.get_$rj()),new _d.$F2(_nbs.NonBootStrings.l_HomePhoneNumber2_ProfileField_Text,"PersonaHomePhones2",t.get_$14w())];n.$AK1(_g.$3G,i,f,_nbs.NonBootStrings.l_HomePhoneNumber_Text,!1);f=[];if(r){var s=$3bS(n,t.get_$ti(),t.get_$17D());f[f.length]=new _d.$F2(String.format(u,_nbs.NonBootStrings.l_MobilePhoneNumber_Text),"PersonaMobilePhones",s)}else f=[new _d.$F2(_nbs.NonBootStrings.l_MobilePhoneNumber_ProfileField_Text,"PersonaMobilePhones",t.get_$ti()),new _d.$F2(_nbs.NonBootStrings.l_MobilePhoneNumber2_ProfileField_Text,"PersonaCarPhones",t.get_$17D())];n.$AK1(_g.$3G,i,f,_nbs.NonBootStrings.l_MobilePhoneNumber_Text,!1);n.$AK1(_g.$3G,i,[new _d.$F2(r?String.format(u,_nbs.NonBootStrings.l_OtherPhoneNumber_Text):_nbs.NonBootStrings.l_OtherPhoneNumber_ProfileField_Text,"PersonaOtherTelephones",t.get_$1Hi())],_nbs.NonBootStrings.l_OtherPhoneNumber_Text,!1);n.$AK1(_g.$3G,i,[new _d.$F2(r?String.format(u,_nbs.NonBootStrings.l_BusinessFaxPhoneNumber_Text):_nbs.NonBootStrings.l_BusinessFaxPhoneNumber_ProfileField_Text,"PersonaWorkFaxes",t.get_$1Kk())],_nbs.NonBootStrings.l_BusinessFaxPhoneNumber_Text,!1);n.$AK1(_g.$3G,i,[new _d.$F2(r?String.format(u,_nbs.NonBootStrings.l_HomeFaxPhoneNumber_Text):_nbs.NonBootStrings.l_HomeFaxPhoneNumber_ProfileField_Text,"PersonaHomeFaxes",t.get_$1Do())],_nbs.NonBootStrings.l_HomeFaxPhoneNumber_Text,!1);n.$AK1(_g.$3G,i,[new _d.$F2(r?String.format(u,_nbs.NonBootStrings.l_OtherFaxPhoneNumber_Text):_nbs.NonBootStrings.l_OtherFaxPhoneNumber_ProfileField_Text,"PersonaOtherFaxes",t.get_$1Hh())],_nbs.NonBootStrings.l_OtherFaxPhoneNumber_Text,!1);n.$AK1(_g.$3G,i,[new _d.$F2(r?String.format(u,_nbs.NonBootStrings.l_OrganizationMainPhoneNumber_Text):_nbs.NonBootStrings.l_OrganizationMainPhoneNumber_ProfileField_Text,"PersonaOrganizationMainPhones",t.get_$1Hd())],_nbs.NonBootStrings.l_OrganizationMainPhoneNumber_Text,!1);n.$AK1(_g.$3G,i,[new _d.$F2(r?String.format(u,_nbs.NonBootStrings.l_AssistantPhoneNumber_Text):_nbs.NonBootStrings.l_AssistantPhoneNumber_ProfileField_Text,"PersonaAssistantPhoneNumbers",t.get_$1B2())],_nbs.NonBootStrings.l_AssistantPhoneNumber_Text,!1);n.$AK1(_g.$3G,i,[new _d.$F2(r?String.format(u,_nbs.NonBootStrings.l_CallbackPhoneNumber_Text):_nbs.NonBootStrings.l_CallbackPhoneNumber_ProfileField_Text,"PersonaCallbackPhones",t.get_$1BQ())],_nbs.NonBootStrings.l_CallbackPhoneNumber_Text,!1);n.$AK1(_g.$3G,i,[new _d.$F2(r?String.format(u,_nbs.NonBootStrings.l_PagerPhoneNumber_Text):_nbs.NonBootStrings.l_PagerPhoneNumber_ProfileField_Text,"PersonaPagers",t.get_$1Hl())],_nbs.NonBootStrings.l_PagerPhoneNumber_Text,!1);n.$AK1(_g.$3G,i,[new _d.$F2(r?String.format(u,_nbs.NonBootStrings.l_RadioPhoneNumber_Text):_nbs.NonBootStrings.l_RadioPhoneNumber_ProfileField_Text,"PersonaRadioPhones",t.get_$1IH())],_nbs.NonBootStrings.l_RadioPhoneNumber_Text,!1);n.$AK1(_g.$3G,i,[new _d.$F2(r?String.format(u,_nbs.NonBootStrings.l_TelexPhoneNumber_Text):_nbs.NonBootStrings.l_TelexPhoneNumber_ProfileField_Text,"PersonaTelexNumbers",t.get_$1Jw())],_nbs.NonBootStrings.l_TelexPhoneNumber_Text,!1);n.$AK1(_g.$3G,i,[new _d.$F2(r?String.format(u,_nbs.NonBootStrings.l_TTYTDDPhoneNumber_Text):_nbs.NonBootStrings.l_TTYTDDPhoneNumber_ProfileField_Text,"PersonaTTYTDDPhoneNumbers",t.get_$1KH())],_nbs.NonBootStrings.l_TTYTDDPhoneNumber_Text,!1)}function $74d(n){n.$2e.get_$66()?$74f(n):$74e(n)}function $74e(n){var t=n.$2e.get_$1u();n.$AJz(_g.$3N,null,_nbs.NonBootStrings.l_BusinessAddress_Text,"PhysicalAddresses",t.get_$iJ(),!1,_d.$1Q.$AJy(_g.$3N,t.get_$iJ()));n.$AJz(_g.$3N,null,_nbs.NonBootStrings.l_HomeAddress_Text,"PhysicalAddresses",t.get_$jK(),!1,_d.$1Q.$AJy(_g.$3N,t.get_$jK()));n.$AJz(_g.$3N,null,_nbs.NonBootStrings.l_OtherAddress_Text,"PhysicalAddresses",t.get_$kn(),!1,_d.$1Q.$AJy(_g.$3N,t.get_$kn()))}function $74f(n){var t=new _d.$4y(n.$2e,_nbs.NonBootStrings.l_Address_Text);n.$Ob[n.$Ob.length]=t;var i=n.$2e.get_$1u();n.$AK1(_g.$3N,t,[new _d.$so(_nbs.NonBootStrings.l_BusinessAddressSuffix_LowerCase_Text,"PersonaBusinessAddresses",i.get_$iJ())],_nbs.NonBootStrings.l_BusinessAddressSuffix_LowerCase_Text,!1);n.$AK1(_g.$3N,t,[new _d.$so(_nbs.NonBootStrings.l_HomeAddressSuffix_LowerCase_Text,"PersonaHomeAddresses",i.get_$jK())],_nbs.NonBootStrings.l_HomeAddressSuffix_LowerCase_Text,!1);n.$AK1(_g.$3N,t,[new _d.$so(_nbs.NonBootStrings.l_OtherAddressSuffix_LowerCase_Text,"PersonaOtherAddresses",i.get_$kn())],_nbs.NonBootStrings.l_OtherAddressSuffix_LowerCase_Text,!1)}function $74b(n){var t=null;var r=n.$2e.get_$1u();var i=!n.$2e.get_$66();if(!i){t=new _d.$4y(n.$2e,_nbs.NonBootStrings.l_Other_Text);n.$Ob[n.$Ob.length]=t}n.$AK1(String,t,[new _d.$HA(i?_nbs.NonBootStrings.l_BusinessWebPage_Text:_nbs.NonBootStrings.l_BusinessWebPage_ProfileField_Text,"PersonaBusinessHomePages",n.$4N4)],_nbs.NonBootStrings.l_BusinessWebPage_Text,!1);n.$AK1(String,t,[new _d.$HA(i?_nbs.NonBootStrings.l_Schools_Text:_nbs.NonBootStrings.l_Schools_ProfileField_Text,"PersonaSchools",r.get_$2eQ())],_nbs.NonBootStrings.l_Schools_Text,!1);n.$AK1(String,t,[new _d.$HA(i?_nbs.NonBootStrings.l_PersonalWebPage_Text:_nbs.NonBootStrings.l_PersonalWebPage_ProfileField_Text,"PersonaPersonalHomePages",r.get_$1UA())],_nbs.NonBootStrings.l_PersonalWebPage_Text,!1);n.$AK1(String,t,[new _d.$HA(i?_nbs.NonBootStrings.l_Profession_Text:_nbs.NonBootStrings.l_Profession_ProfileField_Text,"PersonaProfessions",r.get_$1l1())],_nbs.NonBootStrings.l_Profession_Text,!1);n.$AK1(String,t,[new _d.$HA(i?_nbs.NonBootStrings.l_Spouse_Text:_nbs.NonBootStrings.l_Spouse_ProfileField_Text,"PersonaSpouseNames",r.get_$1nV())],_nbs.NonBootStrings.l_Spouse_Text,!1);i&&n.$AK1(Array,t,[new _d.$1Cd(_nbs.NonBootStrings.l_Children_Text,"PersonaChildren",r.get_$1Mb())],_nbs.NonBootStrings.l_Children_Text,!1);n.$AK1(String,t,[new _d.$HA(i?_nbs.NonBootStrings.l_Hobbies_Text:_nbs.NonBootStrings.l_Hobbies_ProfileField_Text,"PersonaHobbies",r.get_$1dP())],_nbs.NonBootStrings.l_Hobbies_Text,!1);n.$AK1(_a.$7,t,[new _d.$10I(i?_nbs.NonBootStrings.l_Anniversary_Text:_nbs.NonBootStrings.l_Anniversary_ProfileField_Text,"PersonaWeddingAnniversariesLocal",r.get_$1pN())],_nbs.NonBootStrings.l_Anniversary_Text,!1);n.$AK1(_a.$7,t,[new _d.$10I(i?_nbs.NonBootStrings.l_Birthday_Text:_nbs.NonBootStrings.l_Birthday_ProfileField_Text,"PersonaBirthdaysLocal",r.get_$1Z3())],_nbs.NonBootStrings.l_Birthday_Text,!1);n.$AK1(String,t,[new _d.$HA(i?_nbs.NonBootStrings.l_LocationInPersonCard_Text:_nbs.NonBootStrings.l_LocationInPersonCard_ProfileField_Text,"PersonaLocations",r.get_$1fw())],_nbs.NonBootStrings.l_LocationInPersonCard_Text,!1)}function $74X(n){var r=n.$2UC.get_$C();if(r>0&&!n.$2e.get_$66()&&n.$2e.get_$1u().get_$1J()===1){var u=new _d.$4y(n.$2e,_nbs.NonBootStrings.l_LinkItem_Text);n.$Ob[n.$Ob.length]=u;for(var t=0;t<r;t++){var f=n.$2UC.$7cF(t);var i=new(_pc.$1F.$$(String));i.$D(f.get_$1n().toString(),f.get_$3p()[0]);n.$AK0(String,u,null,"PersonaBusinessHomePages",i,!0,_d.$1Q.$AJy(String,i),!0)}}}function $74g(n){if(!n.$2e.get_$66()&&n.$2e.get_$1u().get_$1J()===1&&!_js.$8.$a(n.$2e.get_$2ng())){var t=n.$2e.get_$1u().$84A();if(!_js.$8.$a(t)){var u=_js.$8.$4B("{0}/?user={1}",n.$2e.get_$2ng(),encodeURIComponent(t));var i=new(_pc.$1F.$$(String));i.$D(u,_nbs.NonBootStrings.l_PeopleSharepointProfileName_Text);var r=new _d.$4y(n.$2e,_nbs.NonBootStrings.l_ProfileSection_Text);n.$Ob[n.$Ob.length]=r;n.$AK0(String,r,null,"PersonaBusinessHomePages",i,!0,!1,!0)}}}function $74o(n,t){var e=n.$2e.get_$1u();n.$2UC=new(_pc.$1F.$$(String));n.$4N4=new(_pc.$1F.$$(String));var i=[];if(t)for(var v=t.get_$C(),o=0;o<v;o++)for(var u=t.$7cF(o),y=u.get_$3p().length,s=0;s<y;s++)for(var l=e.get_$3p(),p=l.get_$C(),h=0;h<p;++h){var r=l.get_$3o(h);if(r.get_$1y()===u.get_$3p()[s])switch(r.get_$1o()){case"Facebook":case"LinkedIn":n.$2UC.$D(u.get_$1n().toString(),r.get_$1y());i[i.length]=r.get_$1o();break;default:n.$4N4.$D(u.get_$1n().toString(),r.get_$1y());break}}if(e.$89C()>0)for(var a=e.$3zD(),w=a.length,c=0;c<w;c++){var f=a[c];if(!Array.contains(i,f.get_$1cb())){n.$2UC.$D(f.get_$1cb(),f.get_$1y());i[i.length]=f.get_$1cb()}}}function $4sY(n){var t=null;var f=n.$2e.get_$1u();t=new _d.$4y(n.$2e,_nbs.NonBootStrings.l_PersonaCardNotesPivotOption_Text);n.$Ob[n.$Ob.length]=t;var i=f.get_$JO();if(i)for(var e=i.get_$C(),s=e===1,h=f.get_$3p(),r=0;r<e;r++){var u=i.$7cF(r);if(!_js.$8.$15(u.get_$1n().get_$fB().Value)){var o=new _d.$2n(n.$2e,u,"PersonaBodies",n.$2e.get_$66()?_nbs.NonBootStrings.l_PersonaCardNotes_ProfileField_Text:"",s);var c=this;h.$Dn(function(n){if(n.get_$1y()===u.get_$3p()[0]){o.set_$1sD(n.get_$1cb());return!0}else return!1});t.get_$3O().$D(o)}}return t}function $74a(n){var t=$4sY(n);var o=n.$2e.get_$1u();var i=o.get_$JO();if(n.$2e.get_$66()&&t)if(i&&t.get_$3O().get_$C()>0){for(var r=new(_pc.$1F.$$(_g.$6j)),s=i.get_$C(),h=o.get_$3p(),u=0;u<s;u++)for(var f=i.$7cF(u),c=f.get_$3p().length,e=0;e<c;e++){var v=this;h.$Dn(function(n){if(n.get_$1y()===f.get_$3p()[e]&&n.get_$1o()==="Outlook"){var t=new _g.$6j;t.set_$3s("Text");t.set_$1n(f.get_$1n().get_$1n());r.$D(t,n.get_$1y());return!0}else return!1})}if(r.get_$C()>0){var l=[new _d.$10G(_nbs.NonBootStrings.l_PersonaCardNotes_ProfileField_Text,"PersonaBodies",r)];t.$AJi(_g.$6j,l,_nbs.NonBootStrings.l_PersonaCardNotesPivotOption_Text)}}else{var a=[new _d.$10G(_nbs.NonBootStrings.l_PersonaCardNotes_ProfileField_Text,"PersonaBodies",null)];t.$AJi(_g.$6j,a,_nbs.NonBootStrings.l_PersonaCardNotesPivotOption_Text)}}function $74i(n){var t=!1;var r=n.$2e.get_$1u();var i=new _d.$4y(n.$2e,_nbs.NonBootStrings.l_Work_Text);i.$1fK=!0;var s=!1;var f=n.$2e.get_$66();if(f!==2){if(!r.get_$3p()||!r.get_$3p().get_$C())return;for(var e=null,v=",",h,c,y=(c=$74n(n,h={val:e}),e=h.val,c),p=e.length,o=0;o<p;o++){var l=e[o];if(_js.$8.$a(l))s=!0;else{var w=y.get_$3o(l);var u=w.split(v);t=$1q9(n,i,r.get_$pm(),u,"PersonaTitles",_nbs.NonBootStrings.l_JobTitle_Text,!0)||t;t=$1q9(n,i,r.get_$xB(),u,"PersonaDepartments",_nbs.NonBootStrings.l_Department_Text,!0)||t;t=$1q9(n,i,r.get_$wg(),u,"PersonaCompanyNames",_nbs.NonBootStrings.l_Company_Text,!0)||t;t=$1q9(n,i,r.get_$tv(),u,"PersonaOfficeLocations",_nbs.NonBootStrings.l_OfficeLocation_Text,!0)||t;t=$1q9(n,i,r.get_$16D(),u,"PersonaManagers",_nbs.NonBootStrings.l_Manager_Text,!0)||t;t=$1q9(n,i,r.get_$12O(),u,"PersonaAssistantNames",_nbs.NonBootStrings.l_Assistant_Text,!0)||t;var a=i.get_$3O().get_$C();a>0&&i.get_$3O().get_$3o(a-1).set_$1E6(!1)}}(f===1||f===3)&&s&&(t=$4sX(n,i))}else t=$4sX(n,i);(!f&&t||f)&&(n.$Ob[n.$Ob.length]=i)}function $74n(n,t){t.val=[];for(var f=_a.$3r.$$(String).$8V(),i=n.$2e.get_$1u(),s=i.get_$3p().get_$C(),o=0;o<s;++o){var r=i.get_$3p().get_$3o(o);var u=new Sys.StringBuilder;if(!i.$14Y(r.get_$1y()).get_$r()){u.append($1qA(n,i.get_$pm(),r.get_$1y()));u.append($1qA(n,i.get_$xB(),r.get_$1y()));u.append($1qA(n,i.get_$wg(),r.get_$1y()));u.append($1qA(n,i.get_$tv(),r.get_$1y()));u.append($1qA(n,i.get_$16D(),r.get_$1y()));u.append($1qA(n,i.get_$12O(),r.get_$1y()));var e=u.toString().toLowerCase();if(f.$NO(e))f.set_$3o(e,f.get_$3o(e)+","+r.get_$1y());else{f.set_$3o(e,r.get_$1y());t.val[o]=e}}}return f}function $1qA(n,t,i){var u="";var r=t?$4sZ(n,t,i):null;r&&r.get_$1n()&&(u=r.get_$1n().toString());return u}function $1q9(n,t,i,r,u,f,e){var l=$74V(n,t,i,r,u,f,e);var s=n.$2e.get_$66();if(!l&&(s===1||s===3)){for(var h=!1,a=r.length,o=0;o<a;o++){var c=r[o];if(n.$2e.get_$1u().$14Y(c).get_$sK()||$74k(n,i,c)){h=!0;break}}h&&$74Z(n,t,i,r,u,f,e);return!1}return!0}function $74k(n,t,i){if(!t)return!1;for(var o=t.get_$C(),r=0;r<o;++r){var f=t.$7cF(r);if(f)for(var e=f.get_$3p(),s=e.length,u=0;u<s;u++){var h=e[u];if(h===i)return!0}}return!1}function $74V(n,t,i,r,u,f,e){if(!i||!i.get_$C())return!1;var o=$4sZ(n,i,r[0]);if(!o)return!1;var s=new _g.$3O(o.get_$1n().toString());s.Attributions=r;var h=new _d.$2n(n.$2e,new _pc.$vK(s),u,f,e);h.set_$5DP(r.join(","));t.get_$3O().$D(h);return!0}function $74Z(n,t,i,r,u,f,e){if(!i){var o=n.$2e.get_$1u();switch(u){case"PersonaTitles":i=o.set_$pm(new(_pc.$1F.$$(String)));break;case"PersonaDepartments":i=o.set_$xB(new(_pc.$1F.$$(String)));break;case"PersonaCompanyNames":i=o.set_$wg(new(_pc.$1F.$$(String)));break;case"PersonaOfficeLocations":i=o.set_$tv(new(_pc.$1F.$$(String)));break;case"PersonaManagers":i=o.set_$16D(new(_pc.$1F.$$(String)));break;case"PersonaAssistantNames":i=o.set_$12O(new(_pc.$1F.$$(String)));break}}i.$AIC("",r);var h=i.$7cF(i.get_$C()-1);var s=new _d.$2n(n.$2e,h,u,f,e);s.set_$5DP(r.join(","));s.set_$JX(!0);t.get_$3O().$D(s)}function $4sX(n,t){var i=n.$2e.get_$1u();var r=n.$2e.get_$66();var u=[new _d.$HA(_nbs.NonBootStrings.l_JobTitle_Text,"PersonaTitles",i.get_$pm()),new _d.$HA(_nbs.NonBootStrings.l_Department_Text,"PersonaDepartments",i.get_$xB()),new _d.$HA(_nbs.NonBootStrings.l_Company_Text,"PersonaCompanyNames",i.get_$wg()),new _d.$HA(_nbs.NonBootStrings.l_OfficeLocation_Text,"PersonaOfficeLocations",i.get_$tv()),new _d.$HA(_nbs.NonBootStrings.l_Manager_Text,"PersonaManagers",i.get_$16D()),new _d.$HA(_nbs.NonBootStrings.l_Assistant_Text,"PersonaAssistantNames",i.get_$12O())];r===2||r===3?n.$AK1(String,t,u,_nbs.NonBootStrings.l_Work_Text,!1):t.$AJi(String,u,_nbs.NonBootStrings.l_Work_Text);return!0}function $4sZ(n,t,i){for(var e=null,s=t.get_$C(),r=0;r<s;++r){var u=t.$7cF(r);if(u)for(var o=u.get_$3p(),h=o.length,f=0;f<h;f++)if(o[f]===i){e=u;break}}return e}function $74l(n){var t=n.$2e.get_$1u();switch(n.$2yL){case 0:t.set_$1P0(_d.$1Q.$AJw(String,t.get_$1P0(),!0));t.set_$1Sw(_d.$1Q.$AJw(String,t.get_$1Sw(),!0));t.set_$1Jn(_d.$1Q.$AJw(String,t.get_$1Jn(),!0));t.set_$UO(_d.$1Q.$AJw(_g.$1q,t.get_$UO(),!1));t.set_$13x(_d.$1Q.$AJw(_g.$1q,t.get_$13x(),!1));t.set_$13y(_d.$1Q.$AJw(_g.$1q,t.get_$13y(),!1));t.set_$mJ(_d.$1Q.$AJw(_g.$3G,t.get_$mJ(),!0));t.set_$12c(_d.$1Q.$AJw(_g.$3G,t.get_$12c(),!0));t.set_$rj(_d.$1Q.$AJw(_g.$3G,t.get_$rj(),!0));t.set_$14w(_d.$1Q.$AJw(_g.$3G,t.get_$14w(),!0));t.set_$ti(_d.$1Q.$AJw(_g.$3G,t.get_$ti(),!0));t.set_$17D(_d.$1Q.$AJw(_g.$3G,t.get_$17D(),!0));t.set_$1Hi(_d.$1Q.$AJw(_g.$3G,t.get_$1Hi(),!0));t.set_$1Do(_d.$1Q.$AJw(_g.$3G,t.get_$1Do(),!0));t.set_$1Hh(_d.$1Q.$AJw(_g.$3G,t.get_$1Hh(),!0));t.set_$1Hd(_d.$1Q.$AJw(_g.$3G,t.get_$1Hd(),!0));t.set_$1B2(_d.$1Q.$AJw(_g.$3G,t.get_$1B2(),!0));t.set_$1BQ(_d.$1Q.$AJw(_g.$3G,t.get_$1BQ(),!0));t.set_$1Hl(_d.$1Q.$AJw(_g.$3G,t.get_$1Hl(),!0));t.set_$1IH(_d.$1Q.$AJw(_g.$3G,t.get_$1IH(),!0));t.set_$1Jw(_d.$1Q.$AJw(_g.$3G,t.get_$1Jw(),!0));t.set_$1KH(_d.$1Q.$AJw(_g.$3G,t.get_$1KH(),!0));t.set_$1Kk(_d.$1Q.$AJw(_g.$3G,t.get_$1Kk(),!0));t.set_$g4(_d.$1Q.$AJw(String,t.get_$g4(),!0));break;case 1:t.set_$2jk(_d.$1Q.$AJw(String,t.get_$2jk(),!0));t.set_$1pb(_d.$1Q.$AJw(String,t.get_$1pb(),!0));t.set_$1pd(_d.$1Q.$AJw(String,t.get_$1pd(),!0));t.set_$pm(_d.$1Q.$AJw(String,t.get_$pm(),!0));t.set_$xB(_d.$1Q.$AJw(String,t.get_$xB(),!0));t.set_$wg(_d.$1Q.$AJw(String,t.get_$wg(),!0));t.set_$tv(_d.$1Q.$AJw(String,t.get_$tv(),!0));t.set_$16D(_d.$1Q.$AJw(String,t.get_$16D(),!0));t.set_$12O(_d.$1Q.$AJw(String,t.get_$12O(),!0));t.set_$1MF(_d.$1Q.$AJw(String,t.get_$1MF(),!0));t.set_$1UA(_d.$1Q.$AJw(String,t.get_$1UA(),!0));t.set_$1l1(_d.$1Q.$AJw(String,t.get_$1l1(),!0));t.set_$1nV(_d.$1Q.$AJw(String,t.get_$1nV(),!0));t.set_$1Mb(_d.$1Q.$AJw(Array,t.get_$1Mb(),!0));t.set_$1dP(_d.$1Q.$AJw(String,t.get_$1dP(),!0));t.set_$1pN(_d.$1Q.$AJw(_a.$7,t.get_$1pN(),!0));t.set_$1Z3(_d.$1Q.$AJw(_a.$7,t.get_$1Z3(),!0));t.set_$1fw(_d.$1Q.$AJw(String,t.get_$1fw(),!0));t.set_$2eQ(_d.$1Q.$AJw(String,t.get_$2eQ(),!0));t.set_$iJ(_d.$1Q.$AJw(_g.$3N,t.get_$iJ(),!0));t.set_$jK(_d.$1Q.$AJw(_g.$3N,t.get_$jK(),!0));t.set_$kn(_d.$1Q.$AJw(_g.$3N,t.get_$kn(),!0));break;case 2:t.set_$JO(_d.$1Q.$AJw(_g.$6j,t.get_$JO(),!0));break}}_d.$1Q.prototype={$2yL:0,$Ob:null,$2UC:null,$4N4:null,$2NS:null,$2Z9:null,$2U0:null,get_$89t:function(){return this},$wl:function(){this.get_$3O().$1t();this.$Ob=[];this.$2e.get_$66()&&this.$2e.set_$2ji(this.$2e.get_$1u().$3zJ());switch(this.$2yL){case 0:$74Y(this);$74U(this);$74c(this);$74W(this);break;case 1:_g.$V.get_$I().get_$2z().get_$7l()==="ja-JP"&&$74j(this);$74g(this);$74o(this,this.$2e.get_$1u().get_$1MF());$74i(this);$74d(this);$74b(this);$74X(this);break;case 2:this.$2e.get_$66()?$74a(this):$4sY(this);break}this.get_$3O().$6S(this.$Ob)},$1Ll:function(){var n=[];if(!this.$2yL){n=_d.$1Q.$1rn(this.$2NS,n);n=_d.$1Q.$1rn(this.$2Z9,n);n=_d.$1Q.$1rn(this.$2U0,n)}for(var u=this.get_$3O().get_$C(),t=0;t<u;t++)for(var r=this.get_$3O().get_$3o(t),f=r.get_$3O().get_$C(),i=0;i<f;i++)n=_d.$1Q.$1rn(r.get_$3O().get_$3o(i),n);return n},$iq:function(){$74l(this)},$4h5:function(n){return n},$3PX:function(n){return n},$3sd:function(n){var t=n;t&&t.$1R()},$81U:function(n){for(var t=n,r=t.$5WT(),i=0;i<t.get_$3O().get_$C();i++){var u=t.get_$3O().get_$3o(i);r+=u.$5WT()}return r},$AJz:function(n,t,i,r,u,f,e){return this.$AK0(n,t,i,r,u,f,e,!1)},$AK0:function(n,t,i,r,u,f,e,o){if(!u)return!1;var y=u.get_$C();if(!y)return!1;var w=!this.$2e.get_$66()&&(f||!e);var c=!1;var l=!t;var h=null;var p="";if(!l){h=new Array(0);p=i}for(var a=0;a<y;++a){var v=u.$7cF(a);if(this.$2e.get_$1u().$8Iw(v)){var s=new _d.$2n(this.$2e,v,r,p,w,o);if(_g.$3N.isInstanceOfType(v.get_$1n())){if(_js.$8.$15(s.$2Co)&&_js.$8.$15(s.$2Cp)&&_js.$8.$15(s.$2Cq))continue}else if(_js.$8.$15(s.$Hb))continue;c=this.$2e.get_$1Dn()?!1:$74h(this,s,!1);if(l){t=new _d.$4y(this.$2e,i);t.$1fK=s.get_$5mx();t.get_$3O().$D(s);this.$Ob[this.$Ob.length]=t;c&&t.$6n6()}else Array.add(h,s)}}if(!l&&h.length>0){t.get_$3O().$6S(h);c&&t.$6n6()}return!0},$AK1:function(n,t,i,r,u){for(var f=!1,s=_d.$1Q.$AJx(n,i),h=i.length,e=0;e<h;e++){var o=i[e];f=this.$AJz(n,t,o.get_$4o(),o.get_$29K(),o.get_$AHy(),u,s)||f}this.$2e.get_$66()&&t&&t.$AJi(n,i,r);return f},$AK2:function(n,t,i){if(t)for(var f=t.get_$C(),r=0;r<f;r++){var u=t.$7cF(r);i.$5AB(u.get_$1n(),u.get_$3p())}},$7uz:function(n){var t=n.$Af.get_$1n();this.$2e.$2t1(t)},$8FO:function(n){var t=n.$Af.get_$1n();this.$2e.$427(t)},$9Qu:function(){if(!this.$2e.get_$66()){var n=this.get_$1p();if(n){var t=n.get_$3O().get_$3o(0);_g.$2R.$YG(t.$Af.get_$1n())&&t.get_$Ag().$s()}}}};_d.$2n=function(n,t,i,r,u,f){this.$$d_$9QM=Function.createDelegate(this,this.$9QM);this.$$d_$9QL=Function.createDelegate(this,this.$9QL);this.$$d_$9Yk=Function.createDelegate(this,this.$9Yk);this.$$d_$kj=Function.createDelegate(this,this.$kj);this.$2JU=new(_js.$DO.$$(_d.$2n));_d.$2n.initializeBase(this);this.$2e=n;this.$Af=t;this.$Ly=i;this.$8K=r;this.$1sE="";this.$2RH=u;this.$3SS=f;$4sa(this);this.$2e.get_$66()&&this.get_$CM()||this.$2RH?this.set_$1sD(""):this.set_$1sD(_d.$2n.$2O3(this.$Af,this.$2e.get_$1u(),this.$1sE))};_d.$2n.$2O3=function(n,t,i){var r=null;var u="";var e=null;if(!n||!n.get_$3p()||!n.get_$3p().length)return u;e=new(_a.$3f.$$(String));for(var s=i.split(","),o=0,h=n.get_$3p().length;o<h;++o){r=t.$14Y(n.get_$3p()[o]);if(r&&!r.get_$r()&&(_js.$8.$a(i)||_d.$2n.$8Ix(r.get_$1y(),s))){var f=r.get_$1cb();_js.$8.$15(f)&&(f=_u.Strings.l_Unknown_Text);if(e.$76(f))continue;_js.$8.$a(u)||(u+=_nbs.NonBootStrings.l_AttributionsSepartor_Text);u+=f;e.$D(f)}}return u};_d.$2n.$15k=function(n){return n?String.isInstanceOfType(n)?_js.$8.$a(n):Array.isInstanceOfType(n)?!n.length:_g.$2R.$YG(n)?_g.$2R.$1QS(n)||_js.$8.$a(n.RoutingType)?_js.$8.$a(n.OriginalDisplayName):_js.$8.$a(n.EmailAddress):_g.$Lb.$20s(n)?_js.$8.$a(n.Number):_g.$3N.isInstanceOfType(n)?_js.$8.$a(n.get_$Vg())&&!n.$4gd().$Hj.$T1():_g.$6j.isInstanceOfType(n)?_js.$8.$a(n.get_$1n()):!1:!0};_d.$2n.get_$4io=function(){return _a.$11.get_$7l()in _a.$1k.$2To};_d.$2n.$8Ix=function(n,t){for(var r=t,u=r.length,i=0;i<u;++i){var f=r[i];if(f===n)return!0}return!1};_d.$2n.$3iR=function(n,t,i,r){var o=n.$3zJ();if(!t&&(!o||!o.length))return null;var u=[];var c={};var f=0;if(t)for(var e=0;e<t.get_$C();++e)if(n.$2tH(t.$7cF(e).get_$3p())){u[f]=new _g.$KR(new _g.$1V(r));u[f].OldValue=t.$7cF(e).get_$1n();u[f].NewValue=i;for(var s=0;s<t.$7cF(e).get_$3p().length;s++)c[t.$7cF(e).get_$3p()[s]]="1";f++}if(!_js.$8.$a(i))for(var h=0;h<o.length;h++)if(!c[o[h].get_$1y()]){u[f]=new _g.$KR(new _g.$1V(r));u[f].OldValue="";u[f].NewValue=i;break}return u};function $74s(n){return _g.$6j.isInstanceOfType(n.$Af.get_$1n())?n.$Af.get_$1n().get_$Uh():!1}function $74t(n){var t=$2FP(n);var i=$74r(n);if(_d.$2n.$15k(t)&&_d.$2n.$15k(i))return!1;else if(n.$2e.get_$66()===3)return!0;else if(_d.$2n.$15k(t)!==_d.$2n.$15k(i))return!0;else{if(n.$OW===_g.$3N){var r=t.get_$Vg();var u=i.get_$Vg();return r!==u}if(n.$OW===_g.$1q){var f=_g.$2R.$xn(t);var e=i.EmailAddress;var o=t.Name;var s=i.Name;return f!==e||o!==s}if(n.$OW===_a.$7){var h=t;var c=i;return!h.$4i(c)}return t!==i}}function $74r(n){if(n.$OW===_a.$7)return n.$1Nc;if(n.$OW===_g.$3N)return n.$290;if(n.$OW===_g.$1q){var t=new _g.$1q;t.Name=n.$fi;t.RoutingType=n.$Af.get_$1n().RoutingType;_g.$2R.$1QS(n.$Af.get_$1n())||_js.$8.$a(t.RoutingType)?t.OriginalDisplayName=n.$Hb:t.EmailAddress=n.$Hb;return n.set_$7uy(t)}if(n.$Ly==="PersonaBodies"){n.$J8&&n.$J8.$s();return n.$Hb}return n.$Hb}function $74p(n){var i=_g.$2R.$xn(n.$13w);var r=n.$Af.get_$1n().EmailAddress;var f=n.$Af.get_$1n().OriginalDisplayName;var e=_g.$2R.$xn(n.$13w);var t=n.$13w.Name;var o=n.$Af.get_$1n().Name;t===r&&(t=i);var u=[];switch(n.$Ly){case"PersonaEmails1":u=$3bT(n,r,i,o,t,f,e,"PersonaEmails1","PersonaEmails1OriginalDisplayNames","PersonaEmails1DisplayNames");break;case"PersonaEmails2":u=$3bT(n,r,i,o,t,f,e,"PersonaEmails2","PersonaEmails2OriginalDisplayNames","PersonaEmails2DisplayNames");break;case"PersonaEmails3":u=$3bT(n,r,i,o,t,f,e,"PersonaEmails3","PersonaEmails3OriginalDisplayNames","PersonaEmails3DisplayNames");break}return u}function $3bT(n,t,i,r,u,f,e,o,s,h){var l=[];var c=0;if(n.$2e.get_$66()===3||t!==i){l[c]=new _g.$KR(new _g.$1V(o));l[c].OldValue=t||null;l[c].NewValue=i||null;++c;l[c]=new _g.$KR(new _g.$1V(s));l[c].OldValue=f||null;l[c].NewValue=e||null;++c}if(n.$2e.get_$66()===3||r!==u){l[c]=new _g.$KR(new _g.$1V(h));l[c].OldValue=r||null;l[c].NewValue=u||null}return l}function $4sa(n){var t=$2FP(n);if(String.isInstanceOfType(t)){n.$Hb=t;n.$OW=String}else if(n.$Ly==="PersonaBirthdaysLocal"||n.$Ly==="PersonaWeddingAnniversariesLocal"){n.$OW=_a.$7;if(!_d.$2n.$15k(t)){n.$1Nc=t;n.$Hb=n.$1Nc.get_$4S()!==1604||n.get_$CM()?t.$2b(1):t.$2b(8)}}else if(_g.$3N.isInstanceOfType(t)){n.$290=$74q(n,t);var i=n.$290.get_$5pa();n.$2Co=i.length>0?i[0]:null;n.$2Cp=i.length>1?i[1]:null;n.$2Cq=i.length>2?i[2]:null;n.$OW=_g.$3N}else if(_g.$2R.$YG(t)){n.$13w=t;$74u(n);n.$OW=_g.$1q;n.$7v3=t.OriginalDisplayName}else if(_g.$6j.isInstanceOfType(t)){n.$Hb=t.get_$1n();n.$OW=String}}function $2FP(n){if(_g.$2R.$YG(n.$Af.get_$1n()))return n.$Af.get_$1n();else if(_g.$Lb.$20s(n.$Af.get_$1n()))return n.$Af.get_$1n().Number;else if(_g.$3N.isInstanceOfType(n.$Af.get_$1n()))return n.$Af.get_$1n();else if(_g.$6j.isInstanceOfType(n.$Af.get_$1n()))return n.$Af.get_$1n().get_$fB().Value;else if(n.$Ly==="PersonaBirthdaysLocal"||n.$Ly==="PersonaWeddingAnniversariesLocal"){_d.$2n.$15k(n.$Af.get_$1n())||(n.$5Ne=n.$Af.get_$1n());return n.$5Ne}else return n.$Ly==="PersonaBusinessHomePages"&&n.$3SS?n.$Af.get_$3p()&&n.$Af.get_$3p().length>0?n.$Af.get_$3p()[0]===_nbs.NonBootStrings.l_PeopleSharepointProfileName_Text?n.$Af.get_$1n():n.$2e.get_$1u().$14Y(n.$Af.get_$3p()[0]).get_$1cb():"":Array.isInstanceOfType(n.$Af.get_$1n())?n.$Af.get_$1n().join(", "):n.$Af.get_$1n()?n.$Af.get_$1n():""}function $74q(n,t){var i=_g.$3N.$qp();i.set_$NC(t.get_$NC());i.set_$R8(t.get_$R8());i.set_$4M(t.get_$4M());i.set_$Qe(t.get_$Qe());i.set_$Pu(t.get_$Pu());return i}function $74u(n){n.$Hb=null;n.$fi=null;var t=_g.$2R.$xn(n.$13w);if(_js.$8.$15(t)){n.$fi="";n.$Hb="";return}switch(n.$2e.get_$66()){case 2:case 3:case 1:n.$fi=_js.$8.$a(n.$13w.Name)?n.$2OB(n.$13w.EmailAddress):n.$13w.Name;break}n.$Hb=t}_d.$2n.prototype={$2e:null,$Af:null,$8K:null,$Ly:"FolderId",$3SS:!1,$1of:null,$1sE:null,$1sC:null,$2RH:!1,$OW:null,$fi:null,$7v3:null,$Hb:null,$2Co:null,$2Cp:null,$2Cq:null,$1Nc:null,$290:null,$13w:null,$LI:null,$4Px:null,$J8:null,$4Oq:null,$4Oh:null,$pO:!1,$5Ne:null,add_$12w:function(n){this.$2JU.$w3(n)},remove_$12w:function(n){this.$2JU.$10i(n)},get_$Nc:function(){return _a.UserAgent.getInstance().$9W},get_$au:function(){return _a.UserAgent.getInstance().$Mi},get_$2xK:function(){return this.$fi},set_$2xK:function(n){this.$fi=n;this.$2e.set_$1zR(!0);return n},get_$7sg:function(){return _nbs.NonBootStrings.l_DisplayAs_Text},get_$CM:function(){return!!this.$2e.get_$66()&&this.$2e.get_$1u().$2tH(this.$Af.get_$3p())&&!$74s(this)},get_$1zc:function(){return this.$2JU.get_$2PR()},get_$A0N:function(){return this.$2e.get_$35a()&&this.$2e.get_$1u().get_$6G()&&this.$2e.get_$1u().get_$6G().length>1&&_g.$2R.$YG(this.$Af.get_$1n())&&_g.$2R.$4i(this.$Af.get_$1n(),this.$2e.get_$5O6())?!0:!1},get_$JX:function(){return this.$pO},set_$JX:function(n){if(this.$pO!==n){this.$pO=n;$3(this,"SetFocusOnActive")}return n},get_$8Mh:function(){return this.$OW!==_g.$1q},get_$8Mn:function(){return this.$OW!==String||this.$3SS||this.$Ly==="PersonaBodies"},get_$5kF:function(){return!this.$3SS},get_$5mx:function(){return this.$Ly==="PersonaTitles"||this.$Ly==="PersonaDepartments"||this.$Ly==="PersonaCompanyNames"||this.$Ly==="PersonaManagers"||this.$Ly==="PersonaOfficeLocations"||this.$Ly==="PersonaAssistantNames"},get_$8Ml:function(){return this.$OW!==String||this.$Ly!=="PersonaBodies"},get_$8Mg:function(){return this.$OW!==_a.$7||!this.get_$CM()},get_$8Jj:function(){return!this.$2e.get_$66()||this.$OW!==_a.$7||this.get_$CM()},get_$8IZ:function(){return this.$OW===_g.$3N&&this.get_$1E6()&&!_js.$8.$a(this.$2Co)&&_js.$8.$a(this.$2Cp)&&_js.$8.$a(this.$2Cq)},get_$8Ib:function(){return this.$OW===_g.$3N&&this.get_$1E6()&&!_js.$8.$a(this.$2Co)&&!_js.$8.$a(this.$2Cp)&&_js.$8.$a(this.$2Cq)},get_$8Ia:function(){return this.$OW===_g.$3N&&this.get_$1E6()&&!_js.$8.$a(this.$2Co)&&!_js.$8.$a(this.$2Cp)&&!_js.$8.$a(this.$2Cq)},get_$46a:function(){return this.$OW!==_g.$3N},get_$8IY:function(){return!this.get_$46a()&&this.get_$1E6()},get_$A4k:function(){return this.$Hb},set_$A4k:function(n){this.$Hb=n;this.$2e.set_$1zR(!0);return n},get_$7pV:function(){return this.$1Nc},set_$7pV:function(n){this.$1Nc=n;this.$2e.set_$1zR(!0);return n},get_$7uy:function(){return this.$13w},set_$7uy:function(n){this.$13w=n;this.$2e.set_$1zR(!0);return n},get_$1sD:function(){return this.$1sC},set_$1sD:function(n){if(this.$1sC!==n){this.$1sC=n;$3(this,"AttributionDisplayString")}return n},get_$5DP:function(){return this.$1sE},set_$5DP:function(n){if(this.$1sE!==n){this.$1sE=n;this.get_$1E6()||this.set_$1sD(_d.$2n.$2O3(this.$Af,this.$2e.get_$1u(),n))}return n},get_$8D7:function(){return!!this.$2e.get_$1u().get_$JO()&&this.$2e.get_$1u().get_$JO().get_$C()>1},get_$1E6:function(){return this.$2RH||_js.$8.$a(this.$1sC)},set_$1E6:function(n){if(this.$2RH!==n){this.$2RH=n;n?this.set_$1sD(""):this.set_$1sD(_d.$2n.$2O3(this.$Af,this.$2e.get_$1u(),this.$1sE))}return n},get_$Ag:function(){this.get_$1zc()?this.$LI||(this.$LI=new _C(this.$$d_$kj,_d.$2n.$A)):this.$LI=null;return this.$LI},get_$9Yj:function(){this.$4Px||(this.$4Px=new _C(this.$$d_$9Yk,_d.$2n.$A));return this.$4Px},get_$9QK:function(){this.$4Oq||(this.$4Oq=new _C(this.$$d_$9QL,_d.$2n.$A));return this.$4Oq},get_$9Pk:function(){this.$4Oh||(this.$4Oh=new _C(this.$$d_$9QM,_d.$2n.$A));return this.$4Oh},$5WT:function(){var n="";if(this.get_$46a())n+=_js.$8.$15(this.$8K)?" "+this.$Hb:_js.$8.$4B(_nbs.NonBootStrings.l_PersonaCardProfileFieldConcatenationLabel_Text," "+this.$8K,this.$Hb);else for(var i=this.$290.get_$5pa(),u=i.length,t=0;t<u;++t){var r=i[t];_js.$8.$15(r)||(n+=" "+r)}this.get_$1zc()&&(n+=" "+_nbs.NonBootStrings.l_PersonaCardClickableGroup_Link_Text);n+=".";this.get_$1E6()||(n=_js.$8.$4B(_nbs.NonBootStrings.l_PersonaCardProfileFieldAttributionConcatenationLabel_Text,n,this.$1sC+"."));return n},$1Ll:function(){if(!this.get_$CM()||!$74t(this))return null;var n="";var t="";if(this.$OW===_a.$7){_d.$2n.$15k(this.$1Nc)||(n=this.$1Nc.$4D().$5XT());_d.$2n.$15k(this.$Af.get_$1n())||(t=$2FP(this).$4D().$5XT())}else if(this.$OW===_g.$3N){n=this.$290.get_$5Iz();t=this.$Af.get_$1n().get_$5Iz()}else if(this.$OW===_g.$1q)return $74p(this);else if(this.$OW===String&&this.$Ly==="PersonaBodies"){n=this.$Hb;_js.$8.$a(this.$Af.get_$1n().get_$1n())||(t=$2FP(this))}else{n=this.$Hb;_d.$2n.$15k(this.$Af.get_$1n())||(t=$2FP(this))}if(this.$Ly==="PersonaGivenNames")return _d.$2n.$3iR(this.$2e.get_$1u(),this.$2e.get_$1u().get_$1P0(),n,this.$Ly);else if(this.$Ly==="PersonaMiddleNames")return _d.$2n.$3iR(this.$2e.get_$1u(),this.$2e.get_$1u().get_$1Sw(),n,this.$Ly);else if(this.$Ly==="PersonaSurnames")return _d.$2n.$3iR(this.$2e.get_$1u(),this.$2e.get_$1u().get_$1Jn(),n,this.$Ly);else{var i=new _g.$KR(new _g.$1V(this.$Ly));i.OldValue=t;i.NewValue=n;return[i]}},$kj:function(){this.$2JU.$1II(this)},$9Yk:function(){this.$2e.set_$1zR(!0)},$9ut:function(n){this.$Af.set_$1n(n);$4sa(this);$3(this,"StringDisplayValue")},$9QL:function(){if(!this.$1of){this.$1of=new _g.$1q;this.$1of.EmailAddress=this.$Hb;this.$1of.Name=this.$fi}var n=!1;if(_js.$8.$a(this.$Hb)){this.set_$2xK("");n=!0}else{var i=this.$Af.get_$1n();if(_js.$8.$a(this.$fi)||this.$fi===this.$2OB(_g.$2R.$xn(i))||this.$fi===this.$2OB(this.$1of.EmailAddress)){var t=this.$2OB(this.$Hb);if(t!==this.$fi){this.set_$2xK(t);n=!0}}}if(n){this.$1of.EmailAddress=this.$Hb;this.$1of.Name=this.$fi;$3(this,"EmailDisplayAs")}},$9QM:function(){if(_js.$8.$a(this.$fi)&&!_js.$8.$a(this.$Hb)){this.set_$2xK(this.$2OB(this.$Hb));$3(this,"EmailDisplayAs")}},$2OB:function(n){if(_js.$8.$15(n))return"";if(!this.get_$CM())return n;var t=this.$2e.$fu(_d.$2n.get_$4io());return _js.$8.$a(t)?_js.$8.$4B("({0})",n):_js.$8.$4B("{0} ({1})",t,n)}};_d.$5Y=function(n,t){_d.$5Y.initializeBase(this);if(!$5(n)){this.set_$1u(n.$18);this.set_$66(t)}};_d.$5Y.prototype={get_$1u:function(){return this.$W(_d.$5Y.$1Hw)},set_$1u:function(n){this.$M(_d.$5Y.$1Hw,n);return n},get_$NP:function(){return this.$W(_d.$5Y.$3ni)},set_$NP:function(n){this.$M(_d.$5Y.$3ni,n);return n},get_$8QX:function(){return this.$W(_d.$5Y.$49Y)},set_$8QX:function(n){this.$M(_d.$5Y.$49Y,n);return n},get_$66:function(){return this.$W(_d.$5Y.$17F)},set_$66:function(n){this.$M(_d.$5Y.$17F,n);return n},get_$ja:function(){return this.$W(_d.$5Y.$44u)},set_$ja:function(n){this.$M(_d.$5Y.$44u,n);return n},get_$C8:function(){return this.$W(_d.$5Y.$4TF)},set_$C8:function(n){this.$M(_d.$5Y.$4TF,n);return n},get_$nX:function(){return this.$W(_d.$5Y.$44A)},set_$nX:function(n){this.$M(_d.$5Y.$44A,n);return n},get_$28:function(){return this.$W(_d.$5Y.$4Rm)},set_$28:function(n){this.$M(_d.$5Y.$4Rm,n);return n},get_$3pD:function(){return this.$W(_d.$5Y.$3pE)},set_$3pD:function(n){this.$M(_d.$5Y.$3pE,n);return n},get_$26V:function(){return!$5(this.get_$1u())&&!$5(this.get_$1u().get_$6P())?[this.get_$1u()]:null},get_$4Td:function(){return null}};_d.$10H=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p){this.$B=n;this.$1H=t;this.$k=i;this.$Jg=r;this.$2UE=u;this.$2c6=f;this.$sW=e;this.$282=o;this.$1Da=s;this.$1xx=h;this.$5av=c;this.$7A=l;this.$1T1=a;this.$Ba=v;this.$AI=y;this.$6M=p};_d.$10H.prototype={$6M:null,$B:null,$1H:null,$k:null,$Jg:null,$2c6:null,$sW:null,$282:null,$1Da:null,$AI:null,$Ba:null,$1xx:null,$5av:null,$hC:null,$2UE:null,$mt:!1,$7A:null,$1T1:null};_d.$Gb=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p){_d.$Gb.initializeBase(this,[n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p])};function $752(n,t,i,r,u,f){var e=this;n.$1T1.$E(function(e){var o=e.$7kq(t,i,r,n.$B,n.$k,n.$1xx,n.$mt,n.$6M,n.$hC,u);o.$41();f(o)})}function $753(n,t,i,r,u){var f=new _d.$HR(t,i,r,n.$B,n.$k,n.$mt,n.$6M,n.$hC,u);f.$41();return f}function $751(n,t,i,r,u){var f=new _d.$Kx(t,i,r,n.$B,n.$k,n.$1xx,n.$5av,n.$mt,n.$6M,n.$hC,u,n.$1H);f.$41();return f}function $755(n,t,i,r,u,f){if(n.$B.get_$L()!=="Mouse"){var e=new _d.$B5(t,r,i,n.$B,n.$k,null,n.$sW,n.$mt,n.$6M,n.$hC,u);e.$41();f(e)}else{var o=this;n.$Jg.$E(function(e){var o=new _d.$B5(t,r,i,n.$B,n.$k,e.$E(),n.$sW,n.$mt,n.$6M,n.$hC,u);o.$41();f(o)})}}function $754(n,t,i,r,u,f){if(n.$B.get_$L()!=="Mouse"){var e=new _d.$5G(t,r,i,n.$B,n.$k,null,n.$1Da,n.$mt,n.$6M,n.$hC,u,n.$1H);e.$41();f(e)}else{var o=this;n.$Jg.$E(function(e){var o=new _d.$5G(t,r,i,n.$B,n.$k,e.$E(),n.$1Da,n.$mt,n.$6M,n.$hC,u,n.$1H);o.$41();f(o)})}}function $757(n,t,i,r,u,f){if(n.$B.get_$L()!=="Mouse"){var e=new _d.$30(t,r,i,n.$B,n.$1H,n.$k,null,n.$2UE,n.$sW,n.$282,n.$mt,n.$Ba,n.$6M,n.$hC,n.$1T1,u);e.$41();f(e)}else{var o=this;n.$Jg.$E(function(e){var o=new _d.$30(t,r,i,n.$B,n.$1H,n.$k,e.$E(),n.$2UE,n.$sW,n.$282,n.$mt,n.$Ba,n.$6M,n.$hC,n.$1T1,u);o.$41();f(o)})}}function $756(n,t,i,r,u,f){if(n.$B.get_$L()!=="Mouse"){var e=this;n.$1T1.$E(function(e){var o=e.$5Le(t,r,i,n.$B,n.$k,null,n.$1Da,n.$mt,n.$6M,n.$hC,u);o.$41();f(o)})}else{var o=this;n.$Jg.$E(function(e){n.$1T1.$E(function(o){var s=o.$5Le(t,r,i,n.$B,n.$k,e.$E(),n.$1Da,n.$mt,n.$6M,n.$hC,u);s.$41();f(s)})})}}_d.$Gb.prototype={$7kn:function(n,t,i,r,u,f,e){var o=null;switch(n.get_$1J()){case 5:$752(this,n,t,u,f,e);break;case 2:o=$751(this,n,t,u,f);break;default:o=$753(this,n,t,u,f);break}o&&e(o)},$2uA:function(n,t,i,r,u,f){switch(n.get_$1J()){case 2:$754(this,n,t,r,u,f);break;case 4:$755(this,n,t,r,u,f);break;case 5:$756(this,n,t,r,u,f);break;default:$757(this,n,t,r,u,f);break}}};_d.$10I=function(n,t,i){_d.$10I.initializeBase(this,[n,t,i])};_d.$10I.prototype={$AHz:function(n){switch(this.get_$29K()){case"PersonaWeddingAnniversariesLocal":n.set_$1pN(new(_pc.$1F.$$(_a.$7)));return n.get_$1pN();case"PersonaBirthdaysLocal":n.set_$1Z3(new(_pc.$1F.$$(_a.$7)));return n.get_$1Z3();default:throw this.$AI2();}},$AI0:function(){return null}};_d.$m2=function(n,t,i,r){_d.$m2.initializeBase(this,[n,t,i]);this.$18=r};_d.$m2.prototype={$18:null,$1cE:null,get_$AHy:function(){if($5(this.$1cE)&&!$5(_d.$sp.prototype.get_$AHy.call(this))){this.$1cE=new(_pc.$1F.$$(_g.$1q));for(var n=0;n<_d.$sp.prototype.get_$AHy.call(this).get_$C();++n)this.$18.$2tH(_d.$sp.prototype.get_$AHy.call(this).$7cF(n).get_$3p())?this.$1cE.$5AB(_d.$sp.prototype.get_$AHy.call(this).get_$3o(n),_d.$sp.prototype.get_$AHy.call(this).$7cF(n).get_$3p()):this.$1cE.$AIC(_d.$sp.prototype.get_$AHy.call(this).get_$3o(n),_d.$sp.prototype.get_$AHy.call(this).$7cF(n).get_$3p())}return this.$1cE},set_$AHy:function(n){this.$1cE=null;_d.$sp.prototype.set_$AHy.call(this,n);return n},$AHz:function(n){switch(this.get_$29K()){case"PersonaEmails1":n.set_$UO(new(_pc.$1F.$$(_g.$1q)));return n.get_$UO();case"PersonaEmails2":n.set_$13x(new(_pc.$1F.$$(_g.$1q)));return n.get_$13x();case"PersonaEmails3":n.set_$13y(new(_pc.$1F.$$(_g.$1q)));return n.get_$13y();default:throw this.$AI2();}},$AI1:function(n,t){_d.$sp.prototype.get_$AHy.call(this).$AIC(n,t);this.$1cE=null;return _d.$sp.prototype.get_$AHy.call(this).$7cF(_d.$sp.prototype.get_$AHy.call(this).get_$C()-1)},$AI0:function(){var n=new _g.$1q;n.EmailAddress="";n.RoutingType="SMTP";return n}};_d.$QI=function(n){this.$$d_$9aw=Function.createDelegate(this,this.$9aw);_d.$QI.initializeBase(this);this.set_$13F("");this.set_$cp(_u.Strings.l_MailSearchError_Text);this.set_$275(_u.Strings.l_MailSearchNoResults_Text);this.set_$2UT(_u.Strings.l_MailSearchInProgress_Text);this.add_$AJU(this.$$d_$9aw);this.$e1=n==="Mouse"?3:5};function $4sc(n,t){n.$2Bj(t);$758(n,t)}function $758(n,t){var i=t.get_$1u();var r="";_js.$8.$a(i.get_$mZ())||_js.$8.$a(i.get_$4o())?_js.$8.$a(i.get_$mZ())?_js.$8.$a(i.get_$4o())?i.get_$1l()&&!_js.$8.$a(i.get_$1l().EmailAddress)&&i.get_$1l().RoutingType==="SMTP"?r=i.get_$1l().EmailAddress:i.get_$1l()&&!_js.$8.$a(i.get_$1l().OriginalDisplayName)&&i.get_$1l().RoutingType==="EX"&&(r=i.get_$1l().OriginalDisplayName):r=i.get_$4o():r=i.get_$mZ():r=String.format(_nbs.NonBootStrings.l_PeopleModulePersonaInformation_Text,i.get_$mZ(),i.get_$4o());t.$eL(1,null,r)}_d.$QI.prototype={$e1:0,$1uA:null,$2KX:null,$aP:null,$4Sq:null,$G2:!1,get_$1bt:function(){return this.$aP},set_$1bt:function(n){this.$aP=n;$3(this,"EnterKeyCommand");return n},get_$9gs:function(){return this.$4Sq},set_$9gs:function(n){this.$4Sq=n;$3(this,"PersonaItemsRenderedCommand");return n},get_$5JN:function(){return _nbs.NonBootStrings.l_PeopleSearchPersonaList_AT_Text},get_$2I9:function(){return _y.$Fe.prototype.get_$2I9.call(this)},set_$2I9:function(n){if(this.get_$2I9()!==n){n===1?this.set_$1OS(!1):this.set_$1OS(!0);_y.$Fe.prototype.set_$2I9.call(this,n)}return n},get_$1uB:function(){_a.$3.$m(this.$1uA,"PersonaListVM.CurrentDisplayOption");return this.$1uA},set_$1uB:function(n){_a.$3.$m(n,"PersonaListVM.CurrentDisplayOption");this.$1uA=n;return n},get_$1OS:function(){return this.$G2},set_$1OS:function(n){this.$G2=n;$3(this,"FocusItemOnSelect");return n},get_$6Qk:function(){return this},$4h5:function(n){return _pc.$l.isInstanceOfType(n)?this.$Vu(n):n},$3PX:function(n){return _d.$96.isInstanceOfType(n)?n.get_$1u():n},$3sd:function(n){var t=n;t&&t.$1R()},$81U:function(n){var t=n;var i=t.$Gx;var r=t.$18n;_js.$8.$a(r)||(i+=" "+r);return i},$2Bj:function(n){n.$eL(0,_d.$La.$5Yt(this.get_$1uB().$2wc),_u.Strings.l_NameIsUnavailable_Text);this.$2KX&&(n.$2bz=this.$2KX.get_$4fn())},$Vu:function(n){var t=new _d.$96(n,_y.$17.$Km,!1,this.$e1);$4sc(this,t);return t},$5MJ:function(n){return n},$9aw:function(n,t){this.set_$1OS(!0)}};_d.$fe=function(n,t,i){_a.$3.$m(n,"owaShell");_a.$3.$m(t,"offlineBootstrapper");_a.$3.$m(i,"personaViewModelFactory");this.$B=n;this.$Aw=t;this.$5q=i};_d.$fe.prototype={$B:null,$Aw:null,$5q:null,$7nM:function(){return new _d.$EY(this.$B,this.$Aw,this.$5q)},$7nK:function(n){return new _d.$1CM(this.$B,this.$Aw,this.$5q,n)}};_d.$EY=function(n,t,i){this.$$d_$9tE=Function.createDelegate(this,this.$9tE);_d.$EY.initializeBase(this,[n,n.get_$L()==="TouchNarrow"?0:1]);_a.$3.$K(t,"offlineBootstrapper");_a.$3.$K(i,"personaViewModelFactory");this.$Aw=t;this.$5q=i;this.$2bp=_y.$17.$1sN;this.$5kr=(this.$2bp&1)==1&&_y.$17.$35c(n.get_$L(),this.$2bp)};_d.$EY.$8JU=function(n){var i=n;if(i.get_$2ds()==="ErrorConnectionFailed")return!0;if(!n.$1d)return!1;var t=n.$1d.ErrorCode;return $5(t)?!1:!_g.$7e.$11U(t)};function $4sd(n,t){n.$2Bj(t);$759(n,t,n.$4Sj);t.$6ii()}function $759(n,t,i){if(i){t.set_$fS(!0);for(var u=i.length,f=new Array(u),r=0;r<u;r++){var e=new(_a.$CG.$$(_d.$96))(t,i[r].get_$q7());f[r]=new _0365m.$o(i[r].get_$1Q(),null,new _C(e.$$d_$AGx,_d.$EY.$A))}t.set_$1aO(f)}}_d.$EY.prototype={$5kr:!1,$Aw:null,$5q:null,$2bp:0,$e1:0,$4Sk:!1,$4Sj:null,$IQ:null,$1uA:null,$35U:!0,$48w:null,$48x:null,$1lK:null,get_$5JN:function(){return _nbs.NonBootStrings.l_PeoplePersonaList_AT_Text},get_$9gr:function(){return this.$B.get_$L()==="Mouse"?41:3},get_$38R:function(){this.$48w||(this.$48w=this.get_$8Pq().$E());return this.$48w},get_$8Po:function(){return this.get_$38R()},get_$8Pp:function(){return this.get_$38R()},get_$1uB:function(){_a.$3.$m(this.$1uA,"PersonaPagedListVM.CurrentDisplayOption");return this.$1uA},set_$1uB:function(n){_a.$3.$m(n,"PersonaPagedListVM.CurrentDisplayOption");this.$1uA=n;return n},get_$5Mz:function(){return this.get_$Oe().$BV},set_$5Mz:function(n){this.get_$Oe().set_$5Mz(n);return n},get_$Oe:function(){this.$IQ||(this.$IQ=new _d.$Mv(this.$5kr));return this.$IQ},get_$45F:function(){return this.$35U},set_$45F:function(n){if(this.$35U!==n){this.$35U=n;$3(this,"IsGroupHeadersEnabled")}return n},get_$3O:function(){return this.$24.$1w},get_$6Qi:function(){return this.$e1},set_$6Qi:function(n){if(this.$e1!==n){this.$e1=n;$3(this,"PersonaControlSize")}return n},get_$8Pq:function(){this.$48x||(this.$48x=new _d.$EY.$8Pr(this.$B,this.get_$Oe()));return this.$48x},$9tE:function(n,t){$3(this,"SelectedItemModelPropertiesChanged")},$Vu:function(n){var t=this.$5q.$Vu(n,this.$2bp,this.$4Sk,this.$e1);$4sd(this,t);return t},$7ia:function(n){this.$4Sk=n;n?this.set_$6Qi(this.$B.get_$L()==="TouchWide"?7:5):this.set_$6Qi(this.$B.get_$L()==="Mouse"?3:5)},$2Bj:function(n){n.set_$E5(this.$4Sk);n.$eL(0,_d.$La.$5Yt(this.get_$1uB().$2wc),_u.Strings.l_NameIsUnavailable_Text);if(this.$24&&_pc.$KP.isInstanceOfType(this.$24)){var t=this.$24.get_$10R();t&&t.$2Q&&_pc.$V4.isInstanceOfType(t.$2Q)&&(n.$2bz=t.$2Q.get_$4fn())}},$9MY:function(){this.$12&&this.$12.$q("PropertiesChanged",this.$$d_$9tE)},$9LM:function(){this.$12&&this.$12.$Y("PropertiesChanged",this.$$d_$9tE)},$9Uu:function(){if(this.$B.get_$L()==="TouchNarrow"||this.$24.$z2||!this.get_$3O().get_$C()){_a.$6.$19(null,"NavigateToPeople",this.$24.$z2?this.$if:null);_a.$6.endPT("NavigateToPeopleHub_"+this.$B.get_$L());_a.$6.$19(null,"PeoplePicker",this.$24.$z2?this.$if:null);_a.$6.endPT("PeoplePicker")}},$1xQ:function(){if(this.$Aw.get_$ar()&&_d.$EY.$8JU(this.$24.$yx)){var n=this.$24.get_$10R();if(n.$iV)return _u.Strings.l_OfflinePivotsError_Text;if(n.get_$2Rk())return _u.Strings.l_OfflineUnsupportedFolder_Text}return _d.$4f.prototype.$1xQ.call(this)}};_d.$EY.$8Pr=function(n,t){_a.$3.$K(n,"owaShell");_a.$3.$K(t,"peopleGroupGenerator");this.$B=n;this.$4SL=t};_d.$EY.$8Pr.prototype={$B:null,$4SL:null,$E:function(){return this.$B.get_$L()==="TouchNarrow"?new _d.$eJ(this.$B,this.$4SL):new _d.$1AM(this.$B,this.$4SL)}};_d.$VB=function(n,t){_d.$VB.initializeBase(this,[_d.$VB.$3xv(n),t]);_a.$3.$K(n,"owaShell");this.$B=n};_d.$VB.$3xv=function(n){switch(n.get_$L()){case"Mouse":return 50;case"TouchWide":return 40;case"TouchNarrow":return 25;default:throw Error.argumentOutOfRange("this.owaShell.CurrentLayout",n.get_$L());}};_d.$VB.prototype={$B:null,get_$6Qk:function(){return this},$4h5:function(n){return _pc.$l.isInstanceOfType(n)?this.$Vu(n):n},$3PX:function(n){return _d.$96.isInstanceOfType(n)?n.get_$1u():n},$3sd:function(n){var t=n;t&&t.$1R()},$81U:function(n){var t=n;var i=t.$Gx;var r=t.$18n;_js.$8.$a(r)||(i+=" "+r);return i},$Vu:function(n){var t=new _d.$96(n,_y.$17.$Km,!1);var i=[1];t.$eL(1,i,"");return t}};_d.$10G=function(n,t,i){_d.$10G.initializeBase(this,[n,t,i])};_d.$10G.prototype={$AHz:function(n){switch(this.get_$29K()){case"PersonaBodies":n.set_$JO(new(_pc.$1F.$$(_g.$6j)));return n.get_$JO();default:throw this.$AI2();}},$AI0:function(){var n=new _g.$6j;n.set_$1n("");n.set_$3s("Text");return n}};_d.$F2=function(n,t,i){_d.$F2.initializeBase(this,[n,t,i])};_d.$F2.prototype={$AHz:function(n){switch(this.get_$29K()){case"PersonaBusinessPhoneNumbers":n.set_$mJ(new(_pc.$1F.$$(_g.$3G)));return n.get_$mJ();case"PersonaBusinessPhoneNumbers2":n.set_$12c(new(_pc.$1F.$$(_g.$3G)));return n.get_$12c();case"PersonaHomePhones":n.set_$rj(new(_pc.$1F.$$(_g.$3G)));return n.get_$rj();case"PersonaHomePhones2":n.set_$14w(new(_pc.$1F.$$(_g.$3G)));return n.get_$14w();case"PersonaMobilePhones":n.set_$ti(new(_pc.$1F.$$(_g.$3G)));return n.get_$ti();case"PersonaCarPhones":n.set_$17D(new(_pc.$1F.$$(_g.$3G)));return n.get_$17D();case"PersonaOtherTelephones":n.set_$1Hi(new(_pc.$1F.$$(_g.$3G)));return n.get_$1Hi();case"PersonaWorkFaxes":n.set_$1Kk(new(_pc.$1F.$$(_g.$3G)));return n.get_$1Kk();case"PersonaHomeFaxes":n.set_$1Do(new(_pc.$1F.$$(_g.$3G)));return n.get_$1Do();case"PersonaOtherFaxes":n.set_$1Hh(new(_pc.$1F.$$(_g.$3G)));return n.get_$1Hh();case"PersonaOrganizationMainPhones":n.set_$1Hd(new(_pc.$1F.$$(_g.$3G)));return n.get_$1Hd();case"PersonaAssistantPhoneNumbers":n.set_$1B2(new(_pc.$1F.$$(_g.$3G)));return n.get_$1B2();case"PersonaCallbackPhones":n.set_$1BQ(new(_pc.$1F.$$(_g.$3G)));return n.get_$1BQ();case"PersonaPagers":n.set_$1Hl(new(_pc.$1F.$$(_g.$3G)));return n.get_$1Hl();case"PersonaRadioPhones":n.set_$1IH(new(_pc.$1F.$$(_g.$3G)));return n.get_$1IH();case"PersonaTelexNumbers":n.set_$1Jw(new(_pc.$1F.$$(_g.$3G)));return n.get_$1Jw();case"PersonaTTYTDDPhoneNumbers":n.set_$1KH(new(_pc.$1F.$$(_g.$3G)));return n.get_$1KH();default:throw this.$AI2();}},$AI0:function(){return new _g.$3G("","Mobile")}};_d.$so=function(n,t,i){_d.$so.initializeBase(this,[n,t,i])};_d.$so.prototype={$AHz:function(n){switch(this.get_$29K()){case"PersonaBusinessAddresses":n.set_$iJ(new(_pc.$1F.$$(_g.$3N)));return n.get_$iJ();case"PersonaHomeAddresses":n.set_$jK(new(_pc.$1F.$$(_g.$3N)));return n.get_$jK();case"PersonaOtherAddresses":n.set_$kn(new(_pc.$1F.$$(_g.$3N)));return n.get_$kn();default:throw this.$AI2();}},$AI0:function(){var n=new _g.$3N;n.set_$NC("");return n}};_d.$sp=function(n,t,i){this.$8K=n;this.$K3=t;this.$1sB=i};_d.$sp.$$=function(n){var t="$sp"+"$1"+"$"+n.getName().replace(/\./g,"_");if(!_d[t]){var r=_d[t]=function(){(this.$$gta=this.$$gta||{})["_d.$sp"]={T:n};for(var i=[],t=0;t<arguments.length;++t)i[t]=arguments[t];_d.$sp.apply(this,i)};r.registerClass("_d."+t);var u=_d.$sp.prototype;for(var f in u){var i={key:f,value:u[f]};"constructor"!==i.key&&(r.prototype[i.key]=i.value)}}return _d[t]};_d.$sp.prototype={$8K:null,$K3:"FolderId",$1sB:null,get_$4o:function(){return this.$8K},get_$29K:function(){return this.$K3},get_$AHy:function(){return this.$1sB},set_$AHy:function(n){this.$1sB=n;return n},$AI1:function(n,t){this.$1sB.$AIC(n,t);return this.$1sB.$7cF(this.$1sB.get_$C()-1)},$AI2:function(){return Error.invalidOperation(String.format("Property '{0}' is not supported for {1} fields: ",this.$K3,this.$$gta["_d.$sp"].T.getName()))}};_d.$1Cd=function(n,t,i){_d.$1Cd.initializeBase(this,[n,t,i])};_d.$1Cd.prototype={$AHz:function(n){switch(this.get_$29K()){case"PersonaChildren":n.set_$1Mb(new(_pc.$1F.$$(Array)));return n.get_$1Mb();default:throw this.$AI2();}},$AI0:function(){return new Array(0)}};_d.$HA=function(n,t,i){_d.$HA.initializeBase(this,[n,t,i])};_d.$HA.prototype={$AHz:function(n){switch(this.get_$29K()){case"PersonaYomiCompanyNames":n.set_$2jk(new(_pc.$1F.$$(String)));return n.get_$2jk();case"PersonaYomiLastNames":n.set_$1pd(new(_pc.$1F.$$(String)));return n.get_$1pd();case"PersonaYomiFirstNames":n.set_$1pb(new(_pc.$1F.$$(String)));return n.get_$1pb();case"PersonaImAddresses":n.set_$g4(new(_pc.$1F.$$(String)));return n.get_$g4();case"PersonaBusinessHomePages":n.set_$1MF(new(_pc.$1F.$$(String)));return n.get_$1MF();case"PersonaSchools":n.set_$2eQ(new(_pc.$1F.$$(String)));return n.get_$2eQ();case"PersonaPersonalHomePages":n.set_$1UA(new(_pc.$1F.$$(String)));return n.get_$1UA();case"PersonaProfessions":n.set_$1l1(new(_pc.$1F.$$(String)));return n.get_$1l1();case"PersonaSpouseNames":n.set_$1nV(new(_pc.$1F.$$(String)));return n.get_$1nV();case"PersonaHobbies":n.set_$1dP(new(_pc.$1F.$$(String)));return n.get_$1dP();case"PersonaOfficeLocations":n.set_$tv(new(_pc.$1F.$$(String)));return n.get_$tv();case"PersonaTitles":n.set_$pm(new(_pc.$1F.$$(String)));return n.get_$pm();case"PersonaDepartments":n.set_$xB(new(_pc.$1F.$$(String)));return n.get_$xB();case"PersonaCompanyNames":n.set_$wg(new(_pc.$1F.$$(String)));return n.get_$wg();case"PersonaManagers":n.set_$16D(new(_pc.$1F.$$(String)));return n.get_$16D();case"PersonaAssistantNames":n.set_$12O(new(_pc.$1F.$$(String)));return n.get_$12O();case"PersonaLocations":n.set_$1fw(new(_pc.$1F.$$(String)));return n.get_$1fw();default:throw this.$AI2();}},$AI0:function(){return""}};_d.$96=function(n,t,i,r,u,f,e,o,s){this.$$d_$6M5=Function.createDelegate(this,this.$6M5);this.$$d_$9Xo=Function.createDelegate(this,this.$9Xo);_d.$96.initializeBase(this,[n,t,i,r,null,u,f,e,o,s]);u||this.set_$3nL(new _d.$Jt(f,this,null))};function $4se(n,t,i,r,u){var f=null;if(!$5(i)&&!$5(r)){for(var e=0,l=r.get_$C();e<l;e++){f=r.$7cF(e);if(f.get_$1n().toString()===u)break;f=null}for(var h=i.get_$3p(),a=h.length,o=0;o<a;++o)for(var v=h[o],c=f.get_$3p(),y=c.length,s=0;s<y;++s){var p=c[s];if(p===v)return _js.$8.$4B(_nbs.NonBootStrings.l_PersonCard_Title_Text,t.get_$4o(),u)}}return t.get_$4o()}_d.$96.prototype={$2bz:null,$4Pu:null,get_$1u:function(){return this.$18},set_$1u:function(n){this.set_$1sL(n);this.$UF&&this.$UF.$1ow(n);return n},get_$5Iy:function(){return this.$OP},get_$2VA:function(){return this.get_$1u().get_$31().$4gd()},get_$3A1:function(){return this.get_$1u().get_$1o()},get_$22w:function(){return this.get_$1u().get_$31()},$8R6:function(n){this.$4Pu=n;this.$OP.get_$CQ().add_$1IL(this.$$d_$9Xo);this.$OP.$2uA()},$2u6:function(n,t){return new _d.$w7(this.get_$1u(),n,t)},$5ZL:function(){var n=this.get_$1u();if(n.get_$BO()===2)return" ";var f=n.get_$4o();var i=n.get_$2Lb();var r=n.get_$mZ();if(_js.$8.$a(f))return _js.$8.$a(i)?_js.$8.$a(r)?" ":r:i;else{var t=null;if(!$5(n.get_$pm()))for(var u=0,e=n.get_$pm().get_$C();u<e;u++){t=n.get_$pm().$7cF(u);if(t.get_$1n().toString()===n.get_$4o())break;t=null}return _js.$8.$a(i)?_js.$8.$a(r)?f:$4se(this,n,t,n.get_$wg(),r):$4se(this,n,t,n.get_$xB(),i)}},$5XI:function(){var t=null;if(this.$2bz&&this.get_$1u().get_$4fo()&&this.get_$1u().get_$3p())for(var i=0,f=this.get_$1u().get_$4fo().get_$C();i<f;i++){var n=this.get_$1u().get_$4fo().$7cF(i);if(n.get_$1n()&&n.get_$3p()){for(var r=0,e=n.get_$3p().length;r<e;r++){var u=this.get_$1u().$14Y(n.get_$3p()[r]);if(u&&u.get_$1o()===this.$2bz){t=n.get_$1n();break}}if(!_js.$8.$a(t))break}}if(_js.$8.$a(t)){if(!this.$2bz)return _y.$17.prototype.$5XI.call(this)}else return t;return null},$9Xo:function(){var n=this.$OP.get_$CQ();if(n.$7f){n.$7f.add_$2bq(this.$$d_$6M5);n.remove_$1IL(this.$$d_$9Xo)}},$6M5:function(){var n=this.$OP.get_$CQ().$7f;n.remove_$2bq(this.$$d_$6M5);this.$4Pu(n.$18);this.$4Pu=null}};_d.$97=function(n,t,i,r,u,f,e){this.$GL=-1;_d.$97.initializeBase(this,[n,t,i,u,f,e,!1,null,r]);$5(n.get_$1l())||this.set_$1mQ(n.get_$1l());$5(n.get_$31())||this.set_$6ak(n.get_$31())};function $3bU(n,t,i,r){if(i)for(var u=0;u<i.get_$C();++u)r.$4i(i.get_$3o(u))||t.$D(i.get_$3o(u))}function $4sg(n,t){if($3bV(n,t)){n.set_$JU(n.$GL+1);return!0}n.set_$JU(-1);return!1}function $3bV(n,t){return n.$GL<t.get_$C()-1&&n.$sB?!0:!1}function $4sf(n,t){if(n.$GL===-1&&n.$sB){n.set_$JU(t.get_$C()-1);return!0}n.set_$JU(-1);return!1}function $75A(n){if(n.$GL>0&&n.$sB){n.set_$JU(n.$GL-1);return!0}n.set_$JU(-1);return!1}_d.$97.prototype={$N1:null,$hB:null,$2Ax:null,$4Z6:null,$sB:!1,add_$5kb:function(n){this.$Y("IsPersonaDetailsShown",n)},remove_$5kb:function(n){this.$q("IsPersonaDetailsShown",n)},get_$6Qo:function(){return this.$N1},set_$6Qo:function(n){if(this.$N1!==n){this.$N1=n;$3(this,"PersonaEmailAddresses")}return n},get_$9gt:function(){return this.$hB},set_$9gt:function(n){if(this.$hB!==n){this.$hB=n;$3(this,"PersonaPostalAddresses")}return n},get_$8Cu:function(){return this.get_$40N()&&!this.get_$1yF()},get_$40N:function(){return!!this.$N1},get_$JU:function(){return this.$GL},set_$JU:function(n){if(this.$GL!==n){this.$GL=n;$3(this,"ResultItemHighlightedIndex")}return n},get_$1mQ:function(){return this.$2Ax},set_$1mQ:function(n){if(this.$2Ax!==n){this.$2Ax=n;$3(this,"SelectedEmailItem")}return n},get_$6ak:function(){return this.$4Z6},set_$6ak:function(n){if(this.$4Z6!==n){this.$4Z6=n;$3(this,"SelectedPostalAddressItem")}return n},get_$36g:function(){return this.$sB},set_$36g:function(n){if(this.$sB!==n){this.$sB=n;$3(this,"IsPersonaDetailsShown")}return n},$6lu:function(){return $5(this.$N1)?$5(this.$hB)?!1:$4sg(this,this.$hB):$4sg(this,this.$N1)},$ab:function(){return $5(this.$2Ax)?_y.$17.prototype.$ab.call(this):$3fu(this,this.$2Ax)},$7fL:function(){return $5(this.$N1)?$5(this.$hB)?!1:$3bV(this,this.$hB):$3bV(this,this.$N1)},$AA1:function(){return $5(this.$N1)?$5(this.$hB)?!1:$4sf(this,this.$hB):$4sf(this,this.$N1)},$AA2:function(){return!$5(this.$N1)||!$5(this.$hB)?$75A(this):!1},$9w2:function(){$5(this.$N1)?$5(this.$hB)||this.$GL>-1&&this.$GL<this.$hB.get_$C()&&this.set_$6ak(this.$hB.get_$3o(this.$GL)):this.$GL>-1&&this.$GL<this.$N1.get_$C()&&this.set_$1mQ(this.$N1.get_$3o(this.$GL))},$6S3:function(){if(!$5(this.$hB))throw Error.invalidOperation("Email Addresses should not be populated when PostallAddresses are already populated!");if(this.get_$1u().get_$6G()&&this.$Ho(8)){for(var t=new _js.$c,n=0;n<this.get_$1u().get_$6G().length;++n)this.get_$1u().get_$1l()&&this.get_$1u().get_$6G()[n]&&this.get_$1u().get_$1l().EmailAddress!==this.get_$1u().get_$6G()[n].EmailAddress&&t.$D(this.get_$1u().get_$6G()[n]);if(t.get_$C()>0){this.set_$6Qo(new _js.$c);this.set_$6Qo(t)}}},$40M:function(){return!$5(this.$N1)||!$5(this.$hB)?!0:!1},$9i7:function(){if(!$5(this.$N1))throw Error.invalidOperation("Postal Addresses should not be populated when EmailAddresses are already populated!");if(this.$Ho(8)){var n=new _js.$c;$3bU(this,n,this.get_$1u().get_$jK(),this.get_$1u().get_$31());$3bU(this,n,this.get_$1u().get_$iJ(),this.get_$1u().get_$31());$3bU(this,n,this.get_$1u().get_$kn(),this.get_$1u().get_$31());n.get_$C()>0&&this.set_$9gt(n)}}};_d.$1Cx=function(n,t,i){this.$$d_$6MM=Function.createDelegate(this,this.$6MM);_d.$1Cx.initializeBase(this,[n,null,i,!0]);_a.$3.$1G(t,"sipUri");this.$18=_h.$2G.$3ok(n,t);this.$18.$Y("Presence",this.$$d_$6MM);this.set_$Am(_y.$SK.$3yb(this.$18.$N4))};_d.$1Cx.prototype={$18:null,$49:function(){this.$18.$q("Presence",this.$$d_$6MM);this.$18.$1R();_js.$9.prototype.$49.call(this)},$6MM:function(n,t){this.set_$Am(_y.$SK.$3yb(this.$18.$N4))}};_d.$10j=function(n){_d.$10j.initializeBase(this,[n])};_d.$10j.prototype={get_$5O6:function(){return this.get_$l6().$2vM},get_$35a:function(){return this.get_$l6().$WJ},get_$1yo:function(){return this.get_$l6().get_$1yo()},get_$1Dn:function(){return this.get_$l6().get_$1Dn()},get_$l6:function(){return this.$2e},$4Qj:function(n){this.get_$l6().$4Qj(n)},$4T0:function(n){if(this.get_$l6().get_$4Sl()){this.get_$l6().get_$4Sl().$UF.$4T0(n);_d.$6z.$gQ(11,this.get_$2t8().$AD,this.get_$1u().get_$1J())}},$427:function(n){if(this.get_$l6().get_$4Sl()){this.get_$l6().get_$4Sl().$UF.$427(n);_d.$6z.$gQ(12,this.get_$2t8().$AD,this.get_$1u().get_$1J())}},$2t1:function(n){if(this.get_$l6().get_$4Sl()){this.get_$l6().get_$4Sl().$UF.$2t1(n);_d.$6z.$gQ(10,this.get_$2t8().$AD,this.get_$1u().get_$1J())}}};_d.$tB=function(n){_d.$tB.initializeBase(this,[n])};_d.$tB.prototype={get_$2ng:function(){return this.get_$29V().get_$2ng()},get_$5dA:function(){return this.get_$29V().get_$5dA()},get_$2UA:function(){return this.get_$29V().get_$2UA()},get_$29V:function(){return this.$2e},$fu:function(n){var r=_d.$1Lv.prototype.$fu.call(this,n);if(!_js.$8.$a(r))return r;var u=this.get_$29V().$e0.$2NS;var h=u?u.$Hb:null;var f=this.get_$29V().$e0.$2Z9;var c=f?f.$Hb:null;var e=this.get_$29V().$e0.$2U0;var l=e?e.$Hb:null;var t=null;var i=null;var o,s;var a=this,v=this;_g.$70.$3kj(h,c,l,null,null,null,null,null,null,null,function(n){return""},function(n){return""},o={val:t},s={val:i});t=o.val;i=s.val;return n?i:t}};_d.$Ve=function(){this.$3vm=new _d.$N5([new _h.$CF("PersonaDisplayNameFirstLast","Ascending")],_nbs.NonBootStrings.l_FolderSortListFirstName_Text,_nbs.NonBootStrings.l_FolderSortListFirstName_LowerCase_Text);this.$49M=new _d.$N5([new _h.$CF("PersonaDisplayNameLastFirst","Ascending")],_nbs.NonBootStrings.l_FolderSortListLastName_Text,_nbs.NonBootStrings.l_FolderSortListLastName_LowerCase_Text);this.$5IW=new _d.$N5([new _h.$CF("PersonaCompanyName","Ascending"),new _h.$CF("PersonaDisplayNameFirstLast","Ascending")],_nbs.NonBootStrings.l_FolderSortListCompanyName_Text,_nbs.NonBootStrings.l_FolderSortListCompanyName_LowerCase_Text);this.$5da=new _d.$N5([new _h.$CF("PersonaHomeCity","Ascending"),new _h.$CF("PersonaDisplayNameFirstLast","Ascending")],_nbs.NonBootStrings.l_FolderSortListHomeCity_Text,_nbs.NonBootStrings.l_FolderSortListHomeCity_LowerCase_Text);this.$6q4=new _d.$N5([new _h.$CF("PersonaWorkCity","Ascending"),new _h.$CF("PersonaDisplayNameFirstLast","Ascending")],_nbs.NonBootStrings.l_FolderSortListWorkCity_Text,_nbs.NonBootStrings.l_FolderSortListWorkCity_LowerCase_Text);this.$6Uy=new _d.$N5([new _h.$CF("PersonaCreationTime","Descending"),new _h.$CF("PersonaDisplayNameFirstLast","Ascending")],_nbs.NonBootStrings.l_FolderSortListRecentlyAdded_Text,_nbs.NonBootStrings.l_FolderSortListRecentlyAdded_LowerCase_Text);_d.$Ve.initializeBase(this);this.set_$4o(_d.$Ve.$1ul);this.set_$2I9(1);this.get_$3O().$D(this.$3vm);this.get_$3O().$D(this.$49M);this.get_$3O().$D(this.$5IW);this.get_$3O().$D(this.$5da);this.get_$3O().$D(this.$6q4);this.get_$3O().$D(this.$6Uy)};_d.$Ve.prototype={$ADu:function(n){for(var t=0;t<this.get_$3O().get_$C();t++){var i=this.get_$3O().get_$3o(t);i.$VP.length>1&&(i.$VP[1]=n.get_$1p().$H0)}},$5MJ:function(n){throw Error.notImplemented("CreateViewModelFromModel");}};_d.$N5=function(n,t,i){_d.$N5.initializeBase(this);_a.$3.$K(n,"sortByProperties");_a.$3.$85(n.length,1,2,"sortByProperties");_a.$3.$K(t,"displayName");_a.$3.$K(i,"contextMenuDisplayName");this.$VP=n;this.$7K=t;this.$1Br=i};_d.$N5.prototype={$VP:null,$7K:null,$1Br:null,get_$1o:function(){return this.$7K},toString:function(){return this.$7K}};_d.$IK=function(n,t){this.$$d_$9Mr=Function.createDelegate(this,this.$9Mr);this.$$d_$9Zn=Function.createDelegate(this,this.$9Zn);this.$1PP=-1;this.$j3={};_d.$IK.resolveInheritance();this.apcl=this.$Y;this.rpcl=this.$q;_d.$IK.initializeBase(this,[_pc.$15.$xo,_pc.$15.$jD(),!0,n,!1,null,t,null,null]);this.set_$1ls("PersonaDetailedView");this.$12a();this.set_$r(!1);this.set_$QJ(!0);this.set_$pP(!0)};function $71e(n){var u=n.$3F;if(_js.$8.$15(u))return!0;var i=_rw.$36.$6Po(u);var f=i.length;if(f===1){var t;var e,o;var s=(o=_rw.$36.$2tu(i[0],e={val:t}),t=e.val,o);if(!s||!t)return!0;n.$1kc=new _js.$c;n.$2EU=new _js.$c;n.$1kc.$D(s);n.$2EU.$D(t)}else{n.$1kc=new _js.$c;n.$2EU=new _js.$c;n.$cC=new _js.$c;for(var r=0;r<f;r++)$71d(n,i[r])}if(n.$1kc.get_$C()>0){$KL(n,"BulkResolvePersonasReady",n.$1kc);return!1}return!0}function $71d(n,t){var i;var u,f;var r=(f=_rw.$36.$2tu(t,u={val:i}),i=u.val,f);if(r){n.$1kc.$D(r);n.$2EU.$D(i);if(!i){var e=r.get_$1l().Name;n.$cC.get_$C()||n.$5qj(e);n.$cC.$D(e)}}}function $4qw(n,t){var i=n.get_$7nV()(t);if(!Object.getType(i).implementsInterface(_pc.$yb))throw Error.argument("The server search action must implement IQueryAction interface");n.$2qu=i;n.$2qu.add_$2t(n.$$d_$9Mr);n.$1W.$11(n.$2qu)}function $71f(n,t,i){if($5(t.$1d)){var r=t.get_$18i();n.$j3[n.$29Y]=r}else{n.set_$19l(_nbs.NonBootStrings.l_ServerSearchError_Text);n.set_$1lr("")}}_d.$IK.prototype={$2qu:null,$1kc:null,$2EU:null,$cC:null,$29Y:null,$3lY:!1,add_$6Hu:function(n){this.$2G("BulkResolvePersonasReady",n)},remove_$6Hu:function(n){this.$2H("BulkResolvePersonasReady",n)},add_$6gw:function(n){this.$2G("SingleActionResultsReady",n)},remove_$6gw:function(n){this.$2H("SingleActionResultsReady",n)},get_$6mb:function(){return this.$cC},set_$6mb:function(n){this.$cC!==n&&(this.$cC=n);return n},get_$2rh:function(){return this.$3lY},set_$2rh:function(n){this.$3lY!==n&&(this.$3lY=n);return n},get_$4j0:function(){return this.$2EU},$6X4:function(){this.$cC=null;this.$1kc=null;this.$2EU=null;var n=this.$j3;for(var t in n){var i={key:t,value:n[t]};delete this.$j3[i.key]}},$5qj:function(n){this.$1PP=0;this.$29Y=n;$4qw(this,n)},$5bd:function(n){_a.$3.$K(n,"HandleResultsFromSpeech");var i=$2FK(this,n);if(!(i===1&&$4qx(this,n.get_$3o(0)))){var t=this;_js.$J.get_$I().$1s(_a.$0.$Xv,"ResultVisible",function(){t.set_$ZO(!0);t.set_$2Pj(!0)},1e3)}},$49:function(){if(!$5(this.$j3)){var n=this.$j3;for(var t in n){var i={key:t,value:n[t]};var r=i.key;delete this.$j3[r]}}_y.$5Z.prototype.$49.call(this)},$7h5:function(){},$9z5:function(){if(this.$3F in this.$j3){var n=this.$j3[this.$3F];$4qz(this);$2FK(this,n);return!1}if(this.$1Dj){this.set_$31o(!1);if($5(this.$cC)||!this.$cC.get_$C())return $71e(this)}if(this.$cC&&this.$cC.get_$C()>0){$3az(this);var t=this.$cC.$79(this.$3F);if(t!==-1){this.set_$37K(!1);this.set_$3NQ(!0);this.set_$1lr("");this.set_$19l(String.format(_nbs.NonBootStrings.l_SearchingForResultsString_Text,this.$3F));$2kv(this);this.$3zv();this.set_$Hr(!0);this.add_$6gw(this.$$d_$9Zn);return!1}}return!0},$9zd:function(){if(this.$3F in this.$j3){var n=this.$j3[this.$3F];$2FK(this,n);return!1}return!0},$9Mr:function(n){if($5(n.$1d)&&$5(n.get_$18i()))throw Error.invalidOperation("The response is not processed correctly!");var t=0;if(n===this.$2qu){var i;$71f(this,n,i={val:t});t=i.val;$ex(this,"SingleActionResultsReady")}n.remove_$2t(this.$$d_$9Mr);if(!$5(this.$cC)){do this.$1PP++;while(this.$1PP<this.$cC.get_$C()&&this.$cC.get_$3o(this.$1PP)in this.$j3);if(this.$1PP<this.$cC.get_$C()){this.$29Y=this.$cC.get_$3o(this.$1PP);$4qw(this,this.$29Y)}else this.$1PP=-1}},$9Zn:function(){if(this.$3F in this.$j3){var n=this.$j3[this.$3F];$2FK(this,n)}this.remove_$6gw(this.$$d_$9Zn)}};_d.FindRecipientMailComposeViewModelFactory=function(n,t){this.$k=n;this.$5q=t};_d.FindRecipientMailComposeViewModelFactory.prototype={$k:null,$5q:null,$7lg:function(){return new _d.$IK(this.$k,this.$5q)}};_d.$2C=function(n,t,i,r,u,f,e,o,s){this.$$d_$4P1=Function.createDelegate(this,this.$4P1);this.$$d_$9Xg=Function.createDelegate(this,this.$9Xg);this.$$d_$5Ag=Function.createDelegate(this,this.$5Ag);this.$$d_$9o7=Function.createDelegate(this,this.$9o7);this.$$d_$A9j=Function.createDelegate(this,this.$A9j);this.$$d_$6lp=Function.createDelegate(this,this.$6lp);this.$$d_$9Rz=Function.createDelegate(this,this.$9Rz);this.$$d_$4QR=Function.createDelegate(this,this.$4QR);this.$$d_$9t2=Function.createDelegate(this,this.$9t2);this.$$d_$4Yq=Function.createDelegate(this,this.$4Yq);this.$$d_$9Xs=Function.createDelegate(this,this.$9Xs);this.$3JV={};this.$GL=-1;this.$H8=-1;this.$2VN=8;this.$23E=20;_d.$2C.initializeBase(this,[_y.$x.$w.get_$L()]);this.set_$QJ(!0);this.$1wT=this.$21b?"Email":"Text";this.$2rf=!$5(i)&&i;this.$1W=$5(r)?OwaApplication.$1W:r;this.$5Tr=!$5(u)&&u;this.$5Ho=f;this.$J=s?s:OwaApplication.get_$Xr();this.$3pL=n;this.$1Hv=t;this.$5q=e;this.$1H=o};function $71m(n){$2kt(n);$3az(n);var t=_a.$6.acss(_a.$0.$Xv,"GetPersonasFromCache");var i=_d.$5r.$5Yu(n.$1Hv,n.$3F,n.$2VN,0,n.$5Ho);_a.$6.aces(t);i.length>0&&_d.$6z.$8SF(_js.$8.$15(n.$3F)?-1:n.$3F.length,i.length);t=_a.$6.acss(_a.$0.$Xv,"CreatePersonaViewModels");var r=new(_0365f.$n.$$(Object));var u=this;Array.forEach(i,function(t){r.$D(n.$2u8(t))});n.$AY.$6S(r.get_$3O());_a.$6.aces(t);n.set_$37K(!0);n.$1Vp=!0;n.$2fy=!1;$71p(n);t=_a.$6.acss(_a.$0.$Xv,"ToggleResultVisible");$3b0(n);_a.$6.aces(t);n.$6XG();$2ks(n);$4r0(n);$N(n,"ShouldHideBordersForUseThisLocationButton")}function $71p(n){n.set_$1lr(n.get_$6Zo());n.$AY.get_$C()===n.$2VN?n.set_$19l(String.format(_nbs.NonBootStrings.l_ResultsDisplayedString_Text,n.$2VN)):n.set_$19l("");$2kv(n);if(n.$2rf){n.set_$7Z4(String.format(_nbs.NonBootStrings.l_AddRecipient_Text,n.$3F));$4qz(n)}}function $2FK(n,t){$3az(n);n.$2fy=!0;if(t.get_$C()===1){var u=t.get_$3o(0);if($4qx(n,u)){n.$1Vp=n.$nl;n.set_$X1(n.$2u8(u));return 1}}for(var i=0,f=new Array(Math.min(t.get_$C(),n.$23E)),r=0;r<t.get_$C()&&i<n.$23E;r++){f[r]=n.$2u8(t.get_$3o(r));i++}n.$AY.$6S(f);n.$AY.get_$C()===n.$23E?n.set_$19l(String.format(_nbs.NonBootStrings.l_ServerResultsDisplayedString_Text,n.$23E)):n.$AY.get_$C()?n.set_$19l(""):n.set_$19l(_nbs.NonBootStrings.l_NoMatchFound_Text);n.set_$1lr("");$4qy(n);i===1&&n.$6lp();$4r0(n);$N(n,"ShouldHideBordersForUseThisLocationButton");return i}function $4qx(n,t){return!!t.get_$6G()&&t.get_$6G().length===1}function $71h(n){n.set_$19l(_nbs.NonBootStrings.l_ServerSearchError_Text);n.set_$1lr("");$4qy(n)}function $2kv(n){n.set_$A0z(n.$2dx!==""||n.$2Do!==""||n.$1lC)}function $4qz(n){n.set_$9zi(n.$2rf&&_a.$3q.$WP(n.$3F))}function $3az(n){var t=this;n.$AY.$Bd(function(t){t.remove_$5kb(n.$$d_$9Xg)});n.$AY.$1t()}function $71j(n){n.$2dG&&n.$2dG.$s()}function $4r0(n){if(n.$AY.get_$C()>0&&n.$AY.get_$3o(0).$40M()){var t=n.$AY.get_$3o(0);if(!_d.$5r.$8Il(t.get_$1u(),n.$3F)){t.set_$36g(!0);var i=_d.$5r.$86N(t.$N1,n.$3F);if(i!==-1){t.set_$JU(i);n.set_$ie(n.$GL);n.set_$JU(-1)}}}}function $4qy(n){n.set_$3NQ(!1);$2kv(n);n.$nl&&$3b0(n);n.$6XG();$2ks(n)}function $2FL(n){n.set_$9z0(n.get_$AEQ()&&n.$10u&&(n.$AY.get_$C()>0&&n.$H8<n.$AY.get_$C()||n.$1QV&&n.$rt||n.$15H))}function $2ks(n){if(!_js.$8.$a(n.$3F)){var t=_a.$6.acss(_a.$0.$Xv,"ApplyHitHighlight");n.get_$41N().$5dV(n.$3F,".searchHitHighlight");_a.$6.aces(t)}}function $71i(n){n.set_$ie(0);n.set_$JU(0);n.set_$jU(!1);n.set_$1Pb(!1)}function $71k(n){n.set_$ZO(!1);$2kt(n);n.set_$JU(-1);n.set_$ie(-1);n.set_$jU(!1);n.set_$1Pb(!1);n.$2fy=!1;n.$7h5()}function $3b0(n){!_js.$8.$15(n.$3F)&&n.$gI&&(n.$AY.get_$C()>0||n.$1JT)?n.set_$ZO(!0):n.set_$ZO(!1)}function $71o(n){if(n.$H8>=0&&n.$H8<n.$AY.get_$C()){var t=n.$AY.get_$3o(n.$H8);t.$9w2();n.set_$X1(t)}}function $71n(n,t,i){if($5(t.$1d)){var r=t.get_$18i();var u=_a.$6.acss(_a.$0.$Xv,"HandleServerResults");i.val=$2FK(n,r);_a.$6.aces(u)}else $71h(n)}function $71l(n){n.$AY.get_$C()>0?n.$AY.get_$C()===n.$H8?n.set_$JU(n.$H8-1):n.set_$JU(n.$H8):n.$3zv()}function $2kt(n){if(n.$1lC){n.set_$3NQ(!1);n.$2fE=null;n.set_$1lr(_u.Strings.l_SearchOutlookDirectory_Text);n.set_$19l("");n.set_$37K(!0)}}function $71g(n){return n.$3pL(n.$3F)}function $2kw(n){return $2ku(n)?n.$AY.get_$3o(n.$H8):null}function $2ku(n){return n.$H8>-1&&n.$H8<n.$AY.get_$C()}_d.$2C.prototype={$1W:null,$2rf:!1,$1Hv:null,$5Tr:!1,$5Ho:null,$J:null,$3pL:null,$1H:null,$5q:null,$5Ah:null,$4Z8:null,$11b:null,$2TF:!0,$2dG:null,$1Jz:null,$3VM:null,$1wT:null,$2dx:null,$2Do:null,$vv:null,$1JT:!0,$10u:!1,$2aP:!1,$40i:!1,$AY:null,$2fE:null,$rt:!1,$15H:!1,$2H0:null,$1QV:!0,$1lC:!1,$3PN:null,$2Bv:!1,$2fu:!1,$1n8:!1,$pA:null,$b2:null,$2KP:null,$Jm:null,$RU:null,$2fy:!1,$1Vp:!1,$1Dj:!1,$7zb:!1,add_$hO:function(n){this.$Y("SelectedResultItem",n)},remove_$hO:function(n){this.$q("SelectedResultItem",n)},add_$14r:function(n){this.$Y("ResultVisible",n)},remove_$14r:function(n){this.$q("ResultVisible",n)},add_$6Qu:function(n){this.$2G("PersonaResolutionCompleted",n)},remove_$6Qu:function(n){this.$2H("PersonaResolutionCompleted",n)},get_$X1:function(){return this.$4Z8},set_$X1:function(n){if(n&&_pc.$l.isInstanceOfType(n.get_$1sL())&&n.get_$1u().get_$BO()!==1){var t=new _pc.$l;t.$Qq(n.get_$1u().$Od());n.set_$1u(t)}this.$4Z8=n;$N(this,"SelectedResultItem");n&&this.$9at();return n},get_$AEQ:function(){return!0},get_$8Qb:function(){return null},get_$6ly:function(){return _y.$x.$w.get_$L()==="Mouse"?3:_y.$x.$w.get_$L()==="TouchWide"?11:10},get_$AEu:function(){return""},set_$AEu:function(n){return n},get_$A15:function(){return!_js.$8.$a(this.get_$8Qb())},get_$8P3:function(){return!1},set_$8P3:function(n){return n},get_$A2D:function(){return!1},set_$A2D:function(n){return n},get_$AEt:function(){return null},get_$9ys:function(){return!this.$AY.get_$C()&&this.get_$2RL()},get_$9z0:function(){return this.$2Bv},set_$9z0:function(n){if(this.$2Bv!==n){this.$2Bv=n;$N(this,"ShouldPreventDefaultOnTab")}return n},get_$3Rv:function(){return this.$1Vp},set_$3Rv:function(n){this.$1Vp=n;return n},get_$3Rz:function(){return!this.$1JT||!$2ku(this)},get_$4bR:function(){return this.$2fu},set_$4bR:function(n){if(this.$2fu!==n){this.$2fu=n;$N(this,"ShouldPreventDefaultOnLeftArrow")}return n},get_$1ls:function(){return this.$3PN},set_$1ls:function(n){if(this.$3PN!==n){this.$3PN=n;$N(this,"ResultItemTemplateId")}return n},get_$9mH:function(){return this.$2dG},set_$9mH:function(n){if(this.$2dG!==n){this.$2dG=n;$N(this,"RefreshLayoutCommand")}return n},get_$1K0:function(){return this.$1Jz},set_$1K0:function(n){if(this.$1Jz!==n){this.$1Jz=n;$N(this,"TextBoxBackspaceCommand")}return n},get_$4fh:function(){return this.$3VM},set_$4fh:function(n){this.$3VM!==n&&(this.$3VM=n);return n},get_$2KQ:function(){return this.$2KP},set_$2KQ:function(n){if(this.$2KP!==n){this.$2KP=n;$N(this,"CtrlKCommand")}return n},get_$59M:function(){return this.$vv},set_$59M:function(n){this.$vv!==n&&(this.$vv=n);return n},get_$8Qa:function(){return null},get_$4Xa:function(){return this.$pA},set_$4Xa:function(n){this.$pA!==n&&(this.$pA=n);return n},get_$49c:function(){return this.$b2},set_$49c:function(n){this.$b2!==n&&(this.$b2=n);return n},get_$4es:function(){return this.$11b},set_$4es:function(n){this.$11b!==n&&(this.$11b=n);return n},get_$1lr:function(){return this.$2dx},set_$1lr:function(n){if(this.$2dx!==n){this.$2dx=n;$N(this,"ResultInformation")}return n},get_$19l:function(){return this.$2Do},set_$19l:function(n){if(this.$2Do!==n){this.$2Do=n;$N(this,"TopResultInformation")}return n},get_$A0z:function(){return this.$1JT},set_$A0z:function(n){if(this.$1JT!==n){this.$1JT=n;$AO(this,"ShowInformationButton","ShouldDeleteKeyBeIgnored")}return n},get_$8OZ:function(){return this.$2TF},set_$8OZ:function(n){if(n!==this.$2TF){this.$2TF=n;$N(this,"IsTextBoxEnabled")}return n},get_$9MX:function(){return this.$2aP},set_$9MX:function(n){if(this.$2aP!==n){this.$2aP=n;$N(this,"OnBeforeResultsVisible")}return n},get_$ZO:function(){return this.$10u},set_$ZO:function(n){OwaApplication.$jA&&(n=!1);if(this.$10u!==n){this.$10u=n;$2FL(this);this.set_$9MX(n);n||this.$hT("");$N(this,"ResultVisible")}return n},get_$2Pj:function(){return this.$40i},set_$2Pj:function(n){this.$40i=n;$N(this,"HaveInvokedTypedownForQueryString");return n},get_$JU:function(){return this.$GL},set_$JU:function(n){var t=$2kw(this);if(t){this.set_$4bR(t.$sB);var i="";t.$N1&&t.$N1.get_$C()>0&&!t.$sB&&(i=" "+_nbs.NonBootStrings.l_FindRecipient_AT_MultipleEmailAddresses_Text);this.$10u?this.$AY.get_$C()===1?this.$hT(String.format(_nbs.NonBootStrings.l_FindRecipient_AT_SingleResult_Text,t.$Gx)+i):this.$hT(String.format(_nbs.NonBootStrings.l_FindRecipient_AT_MultipleResults_Text,t.$Gx)+i):this.$hT("")}else this.set_$4bR(!1);if(this.$GL!==n){this.$GL=n;$N(this,"ResultItemHighlightedIndex")}return n},get_$3NQ:function(){return this.$1lC},set_$3NQ:function(n){if(this.$1lC!==n){this.$1lC=n;$N(this,"QueryInProgress")}return n},get_$jU:function(){return this.$rt},set_$jU:function(n){n&&(this.$1QV?this.$hT(String.format(_nbs.NonBootStrings.l_FindRecipient_AT_Search_Text,this.get_$6Zo(),this.$3F)):this.$hT(_nbs.NonBootStrings.l_NoMatchFound_Text));if(this.$rt!==n){this.$rt=n;$2FL(this);$N(this,"IsActionButtonHighlighted")}return n},get_$8Lp:function(){return!1},set_$8Lp:function(n){return n},get_$1Pb:function(){return this.$15H},set_$1Pb:function(n){n&&this.$hT(this.$2H0);if(this.$15H!==n){this.$15H=n;$2FL(this);$N(this,"IsAddSmtpAddressAsPersonaButtonHighlighted")}return n},get_$37K:function(){return this.$1QV},set_$37K:function(n){if(this.$1QV!==n){this.$1QV=n;$2FL(this);$N(this,"IsServerSearchAllowed")}return n},get_$9zi:function(){return this.$1n8},set_$9zi:function(n){if(this.$1n8!==n){this.$1n8=n;$N(this,"ShowAddSmtpAddressAsPersonaButton")}return n},get_$7Z4:function(){return this.$2H0},set_$7Z4:function(n){if(this.$2H0!==n){this.$2H0=n;$N(this,"AddSmtpAddressAsPersonaString")}return n},get_$7y5:function(){return this.$1wT},set_$7y5:function(n){if(this.$1wT!==n){this.$1wT=n;$N(this,"FindTextBoxType")}return n},get_$31o:function(){return this.$1Dj},set_$31o:function(n){if(this.$1Dj!==n){this.$1Dj=n;$N(this,"HasTextBeenPasted")}return n},get_$8W:function(){return _a.UserAgent.getInstance().$9W},get_$2RL:function(){return!_a.UserAgent.getInstance().$d2},get_$6Zo:function(){return this.$5Tr?_nbs.NonBootStrings.l_SearchDirectory_Text:_u.Strings.l_SearchOutlookDirectory_Text},get_$7nV:function(){return this.$3pL},get_$ie:function(){return this.$H8},set_$ie:function(n){if(this.$H8!==n){this.$H8=n;$2FL(this);$N(this,"ShouldDeleteKeyBeIgnored")}return n},get_$41N:function(){this.$RU||(this.$RU=new _a.$8I("psearchHighlight"));return this.$RU},$12a:function(){this.$1Hv.$Rz=_pc.$15.$wy(0,220);this.$1Hv.$Ov(null)},$6lm:function(n){var t=_d.$5r.$A9x(n,this.$1Hv);if(t){if(n.get_$BO()===1&&t.get_$BO()!==1){var i=new _pc.$l;i.$Qq(t.$Od());i.set_$1l(n.get_$1l());$Fp(this,"PersonaResolutionCompleted",n.get_$1l().EmailAddress,i)}}else if(this.$1Hv.$np)if(n.get_$BO()===1){this.$3JV[n.get_$1l().EmailAddress]=n;var r=_pc.$15.$5L4(n.get_$1l().EmailAddress,_pc.$15.$mr);r.add_$2t(this.$$d_$9Xs);this.$1W.$11(r)}else _d.$5r.$5AM(n,this.$1Hv)},$7rJ:function(n){_d.$5r.$7rK(n,this.$1Hv);if(n.get_$BO()!==1){var t=new _pc.$wS(n.get_$6P(),"recipientcache");this.$1W.$11(t)}},$hT:function(n){this.$J.$9lH(_a.$GX,new _a.$GX(n))},$5ey:function(){_y.$5Z.prototype.$5ey.call(this);this.set_$J5(new _C(this.$$d_$4Yq,_d.$2C.$A));this.set_$4es(new _C(this.$$d_$9t2,_d.$2C.$A));this.set_$1KI(new _C(this.$$d_$4QR,_d.$2C.$A));this.set_$59M(new _C(this.$$d_$9Rz,_d.$2C.$A));this.set_$4Xa(new _C(this.$$d_$6lp,_d.$2C.$A));this.set_$49c(new _C(this.$$d_$A9j,_d.$2C.$A));this.$2KP=new _C(this.$$d_$9Rz,_d.$2C.$A);this.$Jm=new _C(this.$$d_$9o7,_d.$2C.$A);this.$5Ah=new _C(this.$$d_$5Ag,_d.$2C.$A);this.$AY=new _js.$c},$9at:function(){this.$2fy&&this.$6lm(this.$4Z8.get_$1u());_d.$6z.$8SH(_js.$8.$15(this.$3F)?-1:this.$3F.length,this.$AY.get_$C(),this.$GL!==-1?this.$GL:this.$H8);$71k(this)},$7h5:function(){this.set_$7D("")},$6XG:function(){this.$AY.get_$C()>0?$71i(this):this.$3zv()},$2u8:function(n){var t;t=this.$5q?this.$5q.$7nN(n,_y.$17.$Km,!1):new _d.$97(n,_y.$17.$Km,!1,this.$1H);var i=[1];t.$eL(1,i,"");t.$6S3();t.add_$5kb(this.$$d_$9Xg);return t},$9cu:function(){if(this.$gI){this.$1Vp=!0;this.$21b||this.set_$2wV(!1);if($5(this.$3F)||this.$3F.trim()==="")this.set_$ZO(!1);else if(!this.$40i&&this.$ln.$2T)this.$4QR();else{var n=this.$10u;$3b0(this);n||$2ks(this)}}},$6NU:function(){if(this.$gI&&!this.$21b)if(this.$20a){var n=this;_js.$J.get_$I().$40(_a.$0.$3M3,"TextBox.SetFocus",function(){n.set_$Hr(!0)})}else this.set_$ZO(!1)},$9Ls:function(){if(this.$10u&&!this.$5G8()&&this.$H8>=0&&this.$AY.get_$C()>0){var n=this.$AY.get_$3o(this.$H8);if(this.$GL!==-1&&this.$H8){var t=this.$AY.get_$3o(this.$H8-1);if(t.$AA1()){this.set_$ie(this.$H8-1);this.set_$JU(-1);var r=t.$N1.get_$3o(t.$GL).EmailAddress;this.$hT(String.format(_nbs.NonBootStrings.l_FindRecipient_AT_SecondaryItemSelected_Text,r,t.$Gx))}else{this.set_$ie(this.$H8-1);this.set_$JU(this.$H8)}}else if(n.$AA2()){if(this.$GL!==-1){this.set_$ie(this.$GL);var i=n.$N1.get_$3o(n.$GL).EmailAddress;this.$hT(String.format(_nbs.NonBootStrings.l_FindRecipient_AT_SecondaryItemSelected_Text,i,n.$Gx))}this.set_$JU(-1)}else this.set_$JU(this.$H8)}},$9Lr:function(){if(this.$10u&&!this.$5G7()&&$2ku(this)){var n=this.$AY.get_$3o(this.$H8);if(n.$6lu()){if(this.$GL!==-1){this.set_$ie(this.$GL);this.set_$JU(-1);var t=n.$N1.get_$3o(n.$GL).EmailAddress;this.$hT(String.format(_nbs.NonBootStrings.l_FindRecipient_AT_SecondaryItemSelected_Text,t,n.$Gx))}}else{this.set_$ie(this.$H8+1);this.set_$JU(this.$H8)}}},$9z5:function(){return!0},$9QY:function(){this.set_$ZO(!1);$2kt(this)},$9zd:function(){return!0},$3zv:function(){if(this.$1n8){this.set_$1Pb(!0);this.set_$jU(!1)}else{this.set_$1Pb(!1);this.$1JT?this.set_$jU(!0):this.set_$jU(!1)}this.set_$ie(-1);this.set_$JU(-1)},$5G7:function(){if(this.$rt)return!0;if(this.$15H&&this.$1JT){this.set_$1Pb(!1);this.set_$jU(!0);return!0}if(this.$H8===this.$AY.get_$C()-1){var n=this.$AY.get_$3o(this.$H8);if(!n.$7fL()){this.$1n8?this.set_$1Pb(!0):this.$1JT&&this.set_$jU(!0);if(this.$15H||this.$rt){n.$6lu();this.set_$ie(this.$AY.get_$C());this.set_$JU(this.$H8)}return!0}}return!1},$5G8:function(){if(this.$rt)if(this.$1n8){this.set_$1Pb(!0);this.set_$jU(!1)}else this.$AY.get_$C()>0&&this.set_$jU(!1);else this.$15H&&this.$AY.get_$C()>0&&this.set_$1Pb(!1);return this.$rt||this.$15H},$4Yq:function(){this.$rt?this.$1QV&&this.$vv.$2T&&this.$vv.$s():this.$15H&&this.$2rf&&_a.$3q.$WP(this.$3F)?this.$5Ag():this.$10u&&this.$AY.get_$C()>0&&(this.$GL!==-1?this.set_$X1(this.$AY.get_$3o(this.$GL)):$71o(this))},$9t2:function(){this.$2Bv?this.$4Yq():this.set_$ZO(!1)},$9Rz:function(){var t=this.$9zd();if(t){if(!this.$1QV||$5(this.$3F)||this.$3F.trim()==="")return;_a.$6.stPT(_a.$0.$Xv,"VM.FindRecipient.Search",3);_a.$6.$1X(_a.$0.$Xv,"ServerSearch");this.set_$37K(!1);this.set_$3NQ(!0);this.set_$1lr("");this.set_$19l(String.format(_nbs.NonBootStrings.l_SearchingForResultsString_Text,this.$3F));$2kv(this);this.set_$Hr(!0);this.$hT(this.$2Do);var n=$71g(this);if(!Object.getType(n).implementsInterface(_pc.$yb))throw Error.argument("The server search action must implement IQueryAction interface");this.$2fE=n;this.$2fE.add_$2t(this.$$d_$4P1);this.$1W.$11(this.$2fE);_d.$6z.$8SG(_js.$8.$15(this.$3F)?-1:this.$3F.length,this.$AY.get_$C())}},$9Xs:function(n){var t=n;if($5(t.$1d)){var u=this.$3JV[t.$3F];if(t.$Ck.get_$C()>0){var i=t.$Ck.get_$3o(0);var f=null;if(!$5(i.get_$6G()))for(var r=0;r<i.get_$6G().length;r++)i.get_$6G()[r]&&i.get_$6G()[r].EmailAddress&&i.get_$6G()[r].EmailAddress.toLowerCase()===t.$3F.toLowerCase()&&(f=i.get_$6G()[r]);if(f){u=i;var e=new _pc.$l;e.$Qq(u.$Od());e.set_$1l(f);$Fp(this,"PersonaResolutionCompleted",t.$3F,e)}}_d.$5r.$5AM(u,this.$1Hv)}delete this.$3JV[t.$3F];n.remove_$2t(this.$$d_$4P1)},$5Ag:function(){var n=new _g.$1q;n.MailboxType="OneOff";n.RoutingType="SMTP";n.EmailAddress=this.$3F;n.Name=this.$3F;this.$2fy=!0;this.set_$X1(this.$2u8(_pc.$l.$Dh(n)))},$4QR:function(){if(this.$nl||this.$7zb){$71j(this);if(!this.$gI||_js.$8.$15(this.$3F)){this.set_$ZO(!1);this.set_$JU(-1);$2kt(this);return}var n=this.$9z5();if(n){_a.$6.stPT(_a.$0.$Xv,"VM.FindRecipient.TypeDown",3);var t=_a.$6.$1X(_a.$0.$Xv,"NicknameCacheSearch",!0);$71m(this);_a.$6.$19(t,null,null,null,this.$AY.get_$C().toString());_a.$6.endPT("VM.FindRecipient.TypeDown")}this.set_$2Pj(!0)}},$4P1:function(n){if($5(n.$1d)&&$5(n.get_$18i()))throw Error.invalidOperation("The response is not processed correctly!");var t=0;if(n===this.$2fE){var i;$71n(this,n,i={val:t});t=i.val}n.remove_$2t(this.$$d_$4P1);_a.$6.$19(null,"ServerSearch",null,null,t.toString());_a.$6.endPT("VM.FindRecipient.Search")},$9o7:function(){if($2ku(this)){var n=this.$AY.get_$3o(this.$H8).get_$1u();this.$7rJ(n);this.set_$JU(-1);this.$AY.$6C(this.$H8);$71l(this)}},$6lp:function(){var n=$2kw(this);n&&n.$40M()&&n.set_$36g(!0)},$A9j:function(){var n=$2kw(this);if(n&&n.$40M()){n.set_$36g(!1);n.set_$JU(-1);this.set_$JU(this.$H8)}},$9Xg:function(n,t){var r=$2kw(this);if(r){var i=n;if(r===i){this.set_$4bR(i.$sB);if(!i.$sB){r.set_$JU(-1);this.set_$JU(this.$H8)}}if(i.$sB){var u=this;_js.$J.get_$I().$40(_d.$2C.$A,"FindRecipientViewModel.ApplyHitHighlight",function(){$2ks(u)})}}}};_d.$1HD=function(n,t,i,r,u,f,e,o){_d.$1HD.initializeBase(this,[n,t,i,r,u,f,e,o])};_d.$1HD.prototype={$3pN:function(n,t,i){return new _d.$tX(n,t,i)}};_d.$1HE=function(n,t,i,r,u,f,e,o){_d.$1HE.initializeBase(this,[n,t,i,r,u,f,e,o])};_d.$1HE.prototype={$2oN:function(n,t,i){if($5(n))throw Error.argument("personaViewModel is invalid");n.set_$1Co(!1);n.$eL(1,new Array(0),n.$18.get_$1l().EmailAddress);var r=this.$3pN(n,2,i);this.$2q2(r,2);this.$1U.$D(r);return r}};_d.$EZ=function(n,t,i,r){this.$1aG_0=n;this.$B_0=t;this.$1H=i;this.$k=r};_d.$EZ.prototype={$B_0:null,$1H:null,$1aG_0:null,$k:null,$Vu:function(n,t,i,r,u,f){u=u?!0:!1;return new _d.$96(n,t,i,r,this.$1aG_0,this.$B_0,u,f,this.$1H)},$7nN:function(n,t,i){return new _d.$97(n,t,i,this.$1H)},$7nL:function(n,t,i,r,u,f){return new _d.$Hs(n,t,i,r,this.$k,u,f)},$ib:function(n,t,i,r){return _pc.$l.isInstanceOfType(n)?this.$Vu(n,t,i,r):this.$Vu(_pc.$l.$1ND(n),t,i,r)}};_d.$KU=function(){this.$$d_$9f2=Function.createDelegate(this,this.$9f2);_d.$KU.initializeBase(this);this.$6Oz=new _C(this.$$d_$9f2,_d.$KU.$A);this.$AY=new _js.$c};function $75n(n,t){var i=new _d.$97(t,_y.$17.$Km,!1);var r=[1];i.$eL(1,r,"");i.$6S3();return i}function $75o(n,t){var i=new Sys.StringBuilder;i.append("Name,Main Email,Secondary Email"+t);for(var f=0;f<n.$AY.get_$C();f++){var r=n.$AY.get_$3o(f);i.append("Name: "+r.$Gx+",");i.append("Email: "+r.$18n);if(!$5(r.$N1))for(var u=0;u<r.$N1.get_$C();u++){i.append(",");var e=r.$N1.get_$3o(u);i.append("Email "+(u+1).toString()+": "+e.EmailAddress)}i.append(t)}return i.toString()}_d.$KU.prototype={$AY:null,$6Oz:null,$3WC:null,get_$A8s:function(){return this.$3WC},set_$A8s:function(n){if(this.$3WC!==n){this.$3WC=n;$3(this,"TotalResultsInRecipientCache")}return n},$FZ:function(){this.$AY.$1t();for(var n=_pc.$15.$jD(),t=0;t<n.$1w.get_$C();t++)this.$AY.$D($75n(this,n.$1w.get_$3o(t)));this.set_$A8s(String.format(_nbs.NonBootStrings.l_RecipientCacheTotalItems_Text,n.$1w.get_$C()))},$e6:function(){},$TZ:function(){},$l1:function(){},$9f2:function(){console.log($75o(this,"\r\n"))}};_d.$Vw=function(n,t){this.$B=n;this.$5q=t};_d.$Vw.prototype={$B:null,$5q:null,$1ac:function(n,t,i){return new _d.$1HD(this.$B.get_$L(),i,n,t,3,!1,!1,this.$5q)},$7od:function(n,t){return new _d.$1HE(this.$B.get_$L(),3,n,t,3,!1,!1,this.$5q)}};_d.$pE=function(n){n.$11(new _h.$jP(!0))};_d.$sh=function(n){var t=new _pc.$Pm;n.$11(t)};_d.$tD=function(){var n=_pc.$15.$jD();n.$Rz=_pc.$15.$wy(0,220);n.$Ov(null)};_d.$Bf=function(){this.$$d_$5bX=Function.createDelegate(this,this.$5bX);this.$$d_$12y=Function.createDelegate(this,this.$12y);this.$$d_$7qY=Function.createDelegate(this,this.$7qY);this.$$d_$7rE=Function.createDelegate(this,this.$7rE);_d.$Bf.initializeBase(this);this.$1v=new _y.$4p;this.$2d4=new _js.$c;this.$2d4.$D(new _a.$2E(new _C(this.$$d_$7rE,_d.$Bf.$A),_nbs.NonBootStrings.l_TaskDeleteOneOccurrence_Text));this.$2d4.$D(new _a.$2E(new _C(this.$$d_$7qY,_d.$Bf.$A),_nbs.NonBootStrings.l_TaskDeleteAllOccurrences_Text));this.$2d4.$D(new _a.$2E(new _C(this.$$d_$12y,_d.$Bf.$A),_u.Strings.l_ConfirmDialog_Cancel_Text))};function $76d(n,t){for(var i=0;i<t.get_$C();i++){var r=t.get_$3o(i);if(_g.$9Q.isInstanceOfType(r)&&r.get_$34D())return!0}return!1}function $76e(n,t){var i="";t===2?i=_nbs.NonBootStrings.l_PontTypeDeleteFlaggedMessage_Text:t===4?i=_nbs.NonBootStrings.l_PontTypeDeleteFlaggedContacts_Text:t===8&&(i=_nbs.NonBootStrings.l_PontTypeDeleteFlaggedItems_Text);n.$6Rs=t;n.$1v.$2u(2,i,n.$$d_$5bX,!0,_u.Strings.l_Yes_Text,_u.Strings.l_No_Text,_u.Strings.l_Warning_Text)}function $4tM(n){while(n.$1NN<n.$1fU.get_$C()){var t=n.$1fU.get_$3o(n.$1NN);if(_g.$9Q.isInstanceOfType(t)&&t.get_$YL()){n.set_$9lw(String.format(_nbs.NonBootStrings.l_TaskDeleteRecurringPrompt_Text,t.get_$2i()));n.set_$3Nu(!0);return}Array.add(n.$2HK,t.get_$i());n.$1NN++}n.$2HK.length>0&&$4tL(n,n.$2HK,0,!n.$2h7.length);n.$2h7.length>0&&$4tL(n,n.$2h7,1,!0);n.$1NN=0}function $4tK(n,t){var i=n.$1fU.get_$3o(n.$1NN);Array.add(t,i.get_$i());n.set_$3Nu(!1);n.$1NN++;$4tM(n)}function $4tL(n,t,i,r){var u=new _h.$L3(t,"MoveToDeletedItems",0);u.$3hl=i;u.$Gw=n.$2k;u.$1b5=1;if(r){var f=this;u.add_$2t(function(t){$5(n.$3ro)||n.$3ro()})}OwaApplication.$1W.$11(u);r&&($5(n.$3rp)||n.$3rp())}_d.$Bf.prototype={$3Nv:null,$2d4:null,$3Nt:!1,$1v:null,$2k:null,$1fU:null,$2HK:null,$2h7:null,$1NN:0,$3rp:null,$3ro:null,$6Rs:0,get_$3Nu:function(){return this.$3Nt},set_$3Nu:function(n){if(this.$3Nt!==n){this.$3Nt=n;$3(this,"RecurrenceDeletionDialogIsShow")}return n},get_$9lw:function(){return this.$3Nv},set_$9lw:function(n){if(this.$3Nv!==n){this.$3Nv=n;$3(this,"RecurrenceDialogMessage")}return n},$IJ:function(n,t,i,r){if(!this.$1NN){if($76d(this,n)){_a.$4Y.$2u(_u.Strings.l_AssignedTaskInformation_Text,1);return}this.$1fU=n;this.$2k=t;this.$3rp=i;this.$3ro=r;var e=n.get_$C();if(e){var u=0;if(n.get_$C()===1){var o=n.get_$3o(0);_pc.$l.isInstanceOfType(o)?u=4:_g.$9Q.isInstanceOfType(o)||(u=2)}else for(var f=0;f<e;f++){var s=n.get_$3o(f);_g.$9Q.isInstanceOfType(s)||(u=8)}if(u&&(u&_g.$V.get_$I().get_$13().get_$17M())===u){$76e(this,u);return}this.$5bX(!0,!1)}}},$5bX:function(n,t){if(t){var i;(i=_g.$V.get_$I().get_$13()).set_$17M(i.get_$17M()&~this.$6Rs);_h.$2D.$CL(_g.$V.get_$I().get_$13().$DB,OwaApplication.$1W)}if(n){this.$2HK=[];this.$2h7=[];this.$1NN=0;$4tM(this)}},$7rE:function(){$4tK(this,this.$2h7)},$7qY:function(){$4tK(this,this.$2HK)},$12y:function(){this.set_$3Nu(!1)}};_d.$Os=function(n){this.$$d_$27l=Function.createDelegate(this,this.$27l);_d.$Os.initializeBase(this);this.set_$DT(this);this.set_$1EU(!0);this.$KH=new _d.$u5(n,!0);this.$KH.$41();this.$KH.$Y("SelectedTreeNode",this.$$d_$27l)};function $76g(n){n.$12x||(n.$12x=new _a.$2E(n.$4f,_u.Strings.l_CancelButtonLabel_LowerCase_Text));return n.$12x}function $76f(n,t,i){n.$2GX?n.$2GX.$LI!==t&&n.$2GX.set_$Ag(t):n.$2GX=new _a.$2E(t,i);return n.$2GX}_d.$Os.prototype={$KH:null,$4d1:null,$2GX:null,$12x:null,get_$2J3:function(){return this.$KH.get_$2B7()?this.$4d1?!_g.$28.$4N(this.$4d1,this.$KH.get_$2B7().get_$o())&&this.$KH.get_$2B7().get_$BI()!=="todosearch":!1:!1},$VM:function(n,t,i,r){var u=this,f=this;var e=new _C(function(){n.$s();u.set_$1O(!1)},_d.$Os.$A,this,"CanExecuteAction",function(){return f.get_$2J3()});this.set_$St(new _js.$c);this.$7W.$D($76f(this,e,i));this.$7W.$D($76g(this));this.set_$4o(t);this.$4d1=r;$3(this,"CanExecuteAction");this.$KH.$41();this.set_$1O(!0)},$27l:function(n,t){$3(this,"CanExecuteAction")}};_d.$1GI=function(n){_d.$1GI.initializeBase(this,[n])};_d.$1GI.prototype={get_$2S5:function(){return!0},get_$6gb:function(){return!1}};_d.$Qh=function(n){_d.$Qh.initializeBase(this);_a.$3.$K(n,"parentTaskFolderPicker");this.$T=new _js.$c;this.$KH=n;this.$1v=n.$1v};function $3bo(n,t){n.$1v.$2u(0,t,null,!1,null,null,_nbs.NonBootStrings.l_TaskActionErrorDialogTitle_Text)}_d.$Qh.prototype={$iO:null,$1z8:null,$1v1:null,$10j:null,$ww:null,$BZ:0,$T:null,$38:!1,$13e:!1,$yP:!1,$1TH:null,$1v:null,$gK:!1,$8d:null,$KH:null,$EZ:!1,get_$RY:function(){return this.$yP},set_$RY:function(n){if(n!==this.$yP){this.$yP=n;$3(this,"IsEdit")}return n},get_$Og:function(){return this.$T.get_$C()>0},get_$2L:function(){return this.$38},set_$2L:function(n){if(this.$38!==n){this.$38=n;$3(this,"IsSelected")}return n},get_$mu:function(){return this.$13e},set_$mu:function(n){if(n!==this.$13e){this.$13e=n;$3(this,"DisableSelection")}return n},get_$CT:function(){return this.$BZ},set_$CT:function(n){if(n!==this.$BZ){this.$BZ=n;$3(this,"TreeNodeMode")}return n},get_$26x:function(){return this.$1TH},set_$26x:function(n){if(n!==this.$1TH){this.$1TH=n;$3(this,"NewNodeViewModel")}return n},get_$1Bz:function(){return this.$ww},set_$1Bz:function(n){if(n!==this.$ww){this.$ww=n;$3(this,"CreateCommand")}return n},get_$1Ic:function(){return this.$10j},set_$1Ic:function(n){if(n!==this.$10j){this.$10j=n;$3(this,"RenameCommand")}return n},get_$7rX:function(){return this.$1v1},set_$7rX:function(n){if(n!==this.$1v1){this.$1v1=n;$3(this,"DeleteTaskFolderPromptCommand")}return n},get_$8Gu:function(){return this.$1z8},set_$8Gu:function(n){if(n!==this.$1z8){this.$1z8=n;$3(this,"InitiateRenameTaskFolderCommand")}return n},get_$2Iz:function(){return this.$iO},set_$2Iz:function(n){if(n!==this.$iO){this.$iO=n;$3(this,"CancelRenameCommand")}return n},get_$7w:function(){return this.$EZ},set_$7w:function(n){if(n!==this.$EZ){this.$EZ=n;$3(this,"IsCollapsed")}return n}};_d.$u5=function(n,t){this.$$d_$6NR=Function.createDelegate(this,this.$6NR);_d.$u5.initializeBase(this);this.$53=t;this.$1v=new _y.$4p;this.$SN=n;this.$SN.add_$2Ig(this.$$d_$6NR);this.$41()};_d.$u5.prototype={$1v:null,$53:!1,$3rE:null,$9Q:null,$M3:null,$9tm:null,$SN:null,get_$eJ:function(){return this.$9Q},set_$eJ:function(n){if(this.$9Q!==n){this.$9Q=n;$3(this,"SelectedTreeNode")}return n},get_$2B7:function(){if(!this.$9Q||!this.$SN.$aw)return null;var n=this.$9Q;return this.$SN.$5Zw(n.$1We.get_$19Y())},get_$2AM:function(){return this.$M3},set_$2AM:function(n){if(n!==this.$M3){this.$M3=n;$3(this,"RootTreeNode")}return n},$41:function(){this.$SN.$aw&&this.$6NR(this.$SN)},$6NR:function(n){for(var r=null,h=n.$2HQ,u=new _d.$1GI(this),t,i,f,e,o=0;o<h.get_$C();o++){t=h.get_$3o(o);if(!$5(t)){i=new _d.$Si(t,this);if(!$5(t.get_$1Ju())){for(var s=0;s<t.get_$1Ju().get_$C();s++){e=t.get_$1Ju().get_$3o(s);f=new _d.$I3(e,i,this);e.get_$2DF()===1&&(r=f);i.$T.$D(f)}u.$T.$D(i)}}}if(!u.$T.get_$C())throw Error.invalidOperation("Unable to get task folders");if($5(r))throw Error.argumentNull("Couldn't get default task folder");this.set_$2AM(u);this.$3rE=r;this.$3rE.set_$2L(!0)}};_d.$I3=function(n,t,i){this.$$d_$7rV=Function.createDelegate(this,this.$7rV);this.$$d_$7rU=Function.createDelegate(this,this.$7rU);this.$$d_$9oO=Function.createDelegate(this,this.$9oO);this.$$d_$9oN=Function.createDelegate(this,this.$9oN);this.$$d_$7fA=Function.createDelegate(this,this.$7fA);this.$$d_$4WL=Function.createDelegate(this,this.$4WL);this.$$d_$3rn=Function.createDelegate(this,this.$3rn);this.$$d_$7rW=Function.createDelegate(this,this.$7rW);this.$$d_$8Gt=Function.createDelegate(this,this.$8Gt);_d.$I3.initializeBase(this,[i]);this.$1We=n;this.$Bi=t;this.$HF=n.get_$Kb();this.set_$CT(1);this.set_$8Gu(new _C(this.$$d_$8Gt,_d.$I3.$A));this.set_$7rX(new _C(this.$$d_$7rW,_d.$I3.$A));this.$5Or=new _C(this.$$d_$3rn,_d.$I3.$A);if(n.get_$2DF()){this.$1z8.set_$69(!1);this.$1v1.set_$69(!1)}this.set_$1Ic(new _C(this.$$d_$4WL,_d.$I3.$A));this.set_$2Iz(new _C(this.$$d_$7fA,_d.$I3.$A));this.$KH.$53||(this.$8d=new _0365m.$2c([new _0365m.$o(_u.Strings.l_Rename_LowerCase_Text,null,this.$1z8),new _0365m.$o(_u.Strings.l_Delete_LowerCase_Text,null,this.$1v1)]))};_d.$I3.prototype={$10k:null,$1v0:null,$5Or:null,$2LX:0,$1We:null,$HF:null,$Bi:null,$6pb:!1,get_$Kb:function(){return this.$HF},set_$Kb:function(n){if(n!==this.$HF){this.$HF=n;$3(this,"FolderName")}return n},get_$2S5:function(){return!1},get_$6gb:function(){return!1},$8Gt:function(){if(!this.$gK){this.set_$26x(this);this.set_$RY(!0);this.set_$CT(4)}},$7fA:function(){this.set_$RY(!1);this.set_$Kb(this.$1We.get_$Kb());this.set_$CT(1)},$4WL:function(){if(_js.$8.$15(this.$HF)){this.set_$Kb(this.$1We.get_$Kb());this.set_$RY(!1);return}if(this.$HF.trim()===this.$1We.get_$Kb()){this.set_$RY(!1);return}if(!$5(this.$10k)){this.$10k.remove_$21(this.$$d_$9oN);this.$10k.remove_$29(this.$$d_$9oO);this.$10k=null}var n=this.$10k=new _c.$1DX(this.$1We,this.$HF,this.$KH.$SN);n.add_$21(this.$$d_$9oN);n.add_$29(this.$$d_$9oO);this.$gK=!0;OwaApplication.$1W.$11(n);this.set_$RY(!1)},$9oO:function(n){this.$gK=!1},$9oN:function(n){this.$gK=!1;this.set_$Kb(this.$1We.get_$Kb());$3bo(this,this.$10k.$1d.message)},$7rW:function(){var n=this;this.$1v.$2u(1,String.format(_u.Strings.l_DeleteFolderConfirmation_Text,this.$HF),function(t,i){t&&n.$5Or.$s()},!1,null,null,_u.Strings.l_DeleteFolderDialogTitle_Text)},$3rn:function(){if(!this.$gK){if(!$5(this.$1v0)){this.$1v0.remove_$21(this.$$d_$7rU);this.$1v0.remove_$29(this.$$d_$7rV);this.$1v0=null}var n=this.$1v0=new _c.$15V(this.$1We,this.$Bi.$Be,this.$KH.$SN);n.add_$21(this.$$d_$7rU);n.add_$29(this.$$d_$7rV);this.$gK=!0;this.$Bi.$gK=!0;OwaApplication.$1W.$11(n);this.$6pb=this.$38;this.set_$2L(!1);this.$2LX=this.$Bi.$T.$79(this);this.$2LX>=0&&this.$Bi.$T.$6C(this.$2LX)}},$7rV:function(n){this.$Bi.$gK=!1;this.$gK=!1;this.$6pb&&this.$KH.$3rE.set_$2L(!0)},$7rU:function(n){this.$2LX>=0&&this.$Bi.$T.$6r(this.$2LX,this);this.$Bi.$gK=!1;this.$gK=!1;$3bo(this,this.$1v0.$1d.message)}};_d.$Si=function(n,t){this.$$d_$7oP=Function.createDelegate(this,this.$7oP);this.$$d_$7oQ=Function.createDelegate(this,this.$7oQ);this.$$d_$8Gi=Function.createDelegate(this,this.$8Gi);this.$$d_$3pa=Function.createDelegate(this,this.$3pa);_d.$Si.initializeBase(this,[t]);this.$Be=n;this.$Sx=n.get_$WA();this.set_$1Bz(new _C(this.$$d_$3pa,_d.$Si.$A));var i=new _C(this.$$d_$8Gi,_d.$Si.$A);this.set_$mu(!0);this.set_$CT(1);if(!this.$KH.$53){this.$9JJ=new _0365m.$o(null,_d.$4.get_$59n(),i);this.$8d=new _0365m.$2c([new _0365m.$o(_u.Strings.l_CreateNewFolder_LowerCase_Text,null,i)])}};_d.$Si.prototype={$Be:null,$9JJ:null,$1TK:null,$x0:null,$Sx:null,get_$2S5:function(){return!0},get_$6gb:function(){return!0},$8Gi:function(){if(!this.$gK){if(!$5(this.$x0)){this.$x0.remove_$29(this.$$d_$7oQ);this.$x0.remove_$21(this.$$d_$7oP);this.$x0=null}this.$x0=new _c.$156(this.$Be,this.$KH.$SN);this.$x0.add_$29(this.$$d_$7oQ);this.$x0.add_$21(this.$$d_$7oP);var n=new _d.$I3(this.$x0.$1TJ,this,this.$KH);n.set_$RY(!0);n.set_$mu(!0);this.set_$26x(this.$1TK=n);this.set_$CT(3)}},$3pa:function(){if(!_js.$8.$15(this.$1TK.$HF)){this.$1TK.set_$RY(!1);this.$1TK.set_$CT(2);this.$x0.$9wh(this.$1TK.$HF);this.$gK=!0;OwaApplication.$1W.$11(this.$x0);this.$T.$D(this.$1TK)}},$7oP:function(n){this.$T.$34(this.$1TK);this.$gK=!1;$3bo(this,this.$x0.get_$cp())},$7oQ:function(n){this.$1TK.set_$CT(1);this.$gK=!1}};_d.$1GL=function(n,t){_d.$1GL.initializeBase(this,[n,t])};_d.$Vl=function(n,t,i,r,u,f,e,o){this.$$d_$9R5=Function.createDelegate(this,this.$9R5);this.$$d_$8Tk=Function.createDelegate(this,this.$8Tk);_d.$Vl.initializeBase(this,[n,t,i,r,u,f,e,null,o]);this.$4BC=new _C(this.$$d_$8Tk,_d.$Vl.$A);this.$1Wd=new _d.$Bf};_d.$Vl.prototype={$4BC:null,$4Vm:null,$1Wd:null,$3y0:function(n,t){if((n&1)==1)throw Error.notImplemented();var f=new _c.$122(this.$DW(),this.$5b,this.$Si);var i=_h.$13.$86r(_c.$1GK,f);var r=i.$1w.get_$C();r||(r=this.get_$1jH());var u=new _h.$8J(0,this.get_$1jH());u.$1R4=1;i.$Ov(u);return i},$7m9:function(n){this.set_$DG(!0);var t=new _y.$Uc(!1);var i=new _y.$JH;switch(this.$Si.$BV){case"TaskStartDate":var r=this;return new(_y.$Cg.$$(_a.$9K))(t,function(n){if(_g.$9Q.isInstanceOfType(n)&&n.get_$91())return n.get_$91();else if(n.get_$7L())return n.get_$7L().get_$91();return null},n);case"TaskDueDate":var u=this;return new(_y.$Cg.$$(_a.$9K))(t,function(n){if(_g.$9Q.isInstanceOfType(n)&&n.get_$Bx())return n.get_$Bx();else if(n.get_$7L())return n.get_$7L().get_$Bx();return null},n);case"ItemClass":var f=this,e=this;return new(_y.$Ab.$$(_g.$y))(i,function(n){return n.get_$7n()},function(n){return $5(n)?"":n.startsWith("IPM.Note")?_nbs.NonBootStrings.l_ItemClassMessage_Text:n.startsWith("IPM.Task")?_nbs.NonBootStrings.l_ItemClassTask_Text:_nbs.NonBootStrings.l_ItemClassOther_Text},_u.Strings.l_EmptyGroupHeader_Text);case"TaskStatus":var o=this,s=this;return new(_y.$Ab.$$(_a.$9K))(i,function(n){if(_g.$9Q.isInstanceOfType(n))return n.get_$Az();else if(n.get_$7L())return n.get_$7L().get_$Ji()?"Completed":"NotStarted";return null},function(n){var t=new _d.$nO;return t.$2x(n,!1)},_u.Strings.l_EmptyGroupHeader_Text);default:return _lv.$5w.prototype.$7m9.call(this,n)}},$IJ:function(n){var i=this.$xq($1L7(this));var t=this;this.$1Wd.$IJ(this.$2o,this.$DW(),function(){t.$eO(null);t.$eO(i);t.$rc()},null)},$5g9:function(){if(!$5(this.$MQ)){if(!_g.$28.$4N(this.$24.get_$o(),this.$MQ)){var n=$1L7(this);if(n&&n.length>0){var t=this.$xq(n);var i=new _h.$KJ(n,this.$MQ,0);this.$eO(null);this.$eO(t);OwaApplication.$1W.$11(i)}}this.$rc()}},$4gQ:function(){if(this.$12)if(_g.$9Q.isInstanceOfType(this.$12)){var n=this.$12;var t=n.get_$Az()==="Completed"?"Today":"MarkComplete";this.$us(t)}else _lv.$5w.prototype.$4gQ.call(this)},$us:function(n){if(this.$2o){var o=this.get_$7q();if(!o)return;for(var r=[],u=[],f=0;f<o;f++){var t=this.$2o.get_$3o(f);if(_g.$9Q.isInstanceOfType(t)){if(t.get_$34D()){_a.$4Y.$2u(_u.Strings.l_AssignedTaskInformation_Text,1);return}Array.add(r,t)}else Array.add(u,t)}if(r.length>0){var i=new _c.$ch(n,this.$DW());i.set_$3O(r);this.$14E=i;i.add_$2t(this.$$d_$9R5);OwaApplication.$1W.$11(i)}if(u.length){var e=new _h.$XA(n,this.$DW());e.set_$3O(u);this.$14E=e;OwaApplication.$1W.$11(e);this.$1P8()}else this.$1P8()}},$886:function(){return"Sort by"},$3od:function(n){return n.$7lb(this)},$5er:function(){_lv.$14.prototype.$5er.call(this);var n=this;this.$aU.$Y("IsShown",function(t,i){if(n.$aU.$30&&n.$12){var r=n.$aU.$14.get_$3o(n.$aU.$14.get_$C()-1);r.set_$r(_g.$9Q.isInstanceOfType(n.$12))}})},$8Tk:function(){this.$2o&&this.$us("MarkComplete")},$9R5:function(n){$5(this.$4Vm)||this.$4Vm.get_$MT()()}};_d.$u7=function(n,t,i,r,u,f,e,o){this.$B=n;this.$b=t;this.$J=i;this.$2D=r;this.$Aw=u;this.$7B=f;this.$aS=e;this.$MX=o};_d.$u7.prototype={$B:null,$b:null,$J:null,$Aw:null,$2D:null,$7B:null,$aS:null,$MX:null,$7oR:function(){return new _d.$Vl(this.$B,this.$b,this.$J,this.$2D,this.$Aw,this.$7B,this.$aS,this.$MX)}};_d.$Ot=function(n,t){_d.$Ot.initializeBase(this);this.set_$4K(!1);this.$SN=t};_d.$Ot.prototype={$7U:0,$2V:!1,$xS:null,$KH:null,$SN:null,get_$3wF:function(){return this.$2V?_u.Strings.l_CollapseFolderPane_AT_Text:_u.Strings.l_ExpandFolderPane_AT_Text},get_$4K:function(){return this.$2V},set_$4K:function(n){if(this.$2V!==n){this.$2V=n;$3u(this,"IsExpanded","FolderPaneExpandCollapseButtonLabel")}this.set_$XE(this.$2V?_d.$Ot.$3WF:_d.$Ot.$3WE);return n},get_$XE:function(){return this.$7U},set_$XE:function(n){if(this.$7U!==n){this.$7U=n;$3(this,"Width")}return n},$41:function(){this.$KH=new _d.$u5(this.$SN,!1);this.$KH.$41()}};_d.$1GQ=function(){_d.$1GQ.initializeBase(this,[!1])};_d.$1GQ.prototype={$2KM:function(){var n=this.$J3.$6ji;return new _h.$CF(n,this.$fY)},$7lD:function(){this.$BW.$D(new _d.$Sj(_nbs.NonBootStrings.l_SortBy_TaskDueDate_Text,_nbs.NonBootStrings.l_SortBy_TaskDueDate_UpperCase_Text,_u.Strings.l_OldestOnTop_Text,_u.Strings.l_NewestOnTop_Text,"Ascending",11,"TaskDueDate",!0));this.$BW.$D(new _d.$Sj(_nbs.NonBootStrings.l_SortBy_TaskStartDate_Text,_nbs.NonBootStrings.l_SortBy_TaskStartDate_UpperCase_Text,_u.Strings.l_OldestOnTop_Text,_u.Strings.l_NewestOnTop_Text,"Ascending",10,"TaskStartDate",!0));this.$BW.$D(new _d.$Sj(_nbs.NonBootStrings.l_SortBy_TaskStatus_Text,_nbs.NonBootStrings.l_SortBy_TaskStatus_UpperCase_Text,_nbs.NonBootStrings.l_NotStartedOnTop_Text,_nbs.NonBootStrings.l_NotStartedOnBottom_Text,"Ascending",12,"TaskStatus",!0));this.$BW.$D(new _d.$Sj(_u.Strings.l_SortBy_Subject_Text,_u.Strings.l_SortBy_Subject_UpperCase_Text,_u.Strings.l_AOnTop_Text,_u.Strings.l_ZOnTop_Text,"Ascending",8,"Subject",!0));this.$BW.$D(new _d.$Sj(_u.Strings.l_SortBy_Attachments_Text,_u.Strings.l_SortBy_Attachments_UpperCase_Text,_u.Strings.l_WithOnTop_Text,_u.Strings.l_WithoutOnTop_Text,"Descending",4,"HasAttachments",!0));this.$BW.$D(new _d.$Sj(_u.Strings.l_SortBy_Importance_Text,_u.Strings.l_SortBy_Importance_UpperCase_Text,_u.Strings.l_HighOnTop_Text,_u.Strings.l_LowOnTop_Text,"Descending",5,"Importance",!0));this.$BW.$D(new _d.$Sj(_u.Strings.l_SortBy_Type_Text,_u.Strings.l_SortBy_Type_UpperCase_Text,_u.Strings.l_MessagesOnTop_Text,_u.Strings.l_MessagesOnBottom_Text,"Ascending",6,"ItemClass",!0))}};_d.$Sj=function(n,t,i,r,u,f,e,o){_d.$Sj.initializeBase(this,[n,t,i,r,u,f,e,e,o]);this.$6ji=e};_d.$Sj.prototype={$6ji:"FolderId"};_d.$8q=function(){_d.$8q.initializeBase(this)};_d.$8q.prototype={get_$gB:function(){return this.$W(_d.$8q.$44n)},set_$gB:function(n){this.$M(_d.$8q.$44n,n);return n},get_$yX:function(){return this.$W(_d.$8q.$46X)},set_$yX:function(n){this.$M(_d.$8q.$46X,n);return n},get_$5Qy:function(){return this.$W(_d.$8q.$3tM)},set_$5Qy:function(n){this.$M(_d.$8q.$3tM,n);return n},get_$eZ:function(){return this.$W(_d.$8q.$4fQ)},set_$eZ:function(n){this.$M(_d.$8q.$4fQ,n);return n},get_$DI:function(){return this.$W(_d.$8q.$1zu)},set_$DI:function(n){this.$M(_d.$8q.$1zu,n);return n},get_$26V:function(){return this.get_$yX()?null:[this.get_$eZ()]},get_$4Td:function(){return null}};_d.$56=function(n,t,i,r){this.$$d_$6MV=Function.createDelegate(this,this.$6MV);this.$$d_$6KX=Function.createDelegate(this,this.$6KX);this.$$d_$9db=Function.createDelegate(this,this.$9db);this.$$d_$1BY=Function.createDelegate(this,this.$1BY);this.$$d_$9Q8=Function.createDelegate(this,this.$9Q8);this.$$d_$9P8=Function.createDelegate(this,this.$9P8);this.$$d_$88U=Function.createDelegate(this,this.$88U);this.$$d_$9Ox=Function.createDelegate(this,this.$9Ox);this.$$d_$bq=Function.createDelegate(this,this.$bq);this.$$d_$3nR=Function.createDelegate(this,this.$3nR);this.$$d_$2JT=Function.createDelegate(this,this.$2JT);this.$$d_$7rT=Function.createDelegate(this,this.$7rT);this.$$d_$8Te=Function.createDelegate(this,this.$8Te);this.$$d_$7Xe=Function.createDelegate(this,this.$7Xe);this.$$d_$9hp=Function.createDelegate(this,this.$9hp);this.$$d_$7hM=Function.createDelegate(this,this.$7hM);this.$$d_$4YC=Function.createDelegate(this,this.$4YC);this.$$d_$7ur=Function.createDelegate(this,this.$7ur);_d.$56.initializeBase(this);this.$J=n||null;this.$E7=t;this.$4U=i;this.$Ka=r;this.$Q2=new _C(this.$$d_$7ur,_d.$56.$A);this.$DO=new _C(this.$$d_$4YC,_d.$56.$A);this.$4f=new _C(this.$$d_$7hM,_d.$56.$A);this.$28w=new _C(this.$$d_$9hp,_d.$56.$A);this.$iF=new _C(this.$$d_$7Xe,_d.$56.$A);this.$4BE=new _C(this.$$d_$8Te,_d.$56.$A);this.$Jm=new _C(this.$$d_$7rT,_d.$56.$A);this.$iR=new _C(this.$$d_$2JT,_d.$56.$A);this.$1v=new _y.$4p;this.$1Wd=new _d.$Bf;this.get_$1Ec()&&$4tN(this);_y.$x.$w.add_$UA(this.$$d_$3nR);_y.$x.$w.add_$KA(this.$$d_$bq)};function $76i(n){var t={};if(n.$Gb.get_$6T()&&n.$Gb.get_$6T().get_$C()>0){var i=n.$Gb.get_$6T().$6W();t["Tasks reading pane item categories"]=i}return t}function $4tO(n){n.set_$A9(!1);n.set_$gB(!1);n.$s7?$2lN(n):n.$Gb?!n.$Gb.get_$1HC()&&n.$Gb.get_$JN()&&n.$Gb.get_$JN().get_$1n()?$2lN(n):n.$39B():n.set_$3VH(null)}function $2lN(n){n.set_$3VH(new _d.$Ln(n.$Gb,n.$E7));n.set_$47d(n.$8J.get_$5cF());n.$8J.$Y("DueDate",n.$$d_$9P8);n.$8J.$Y("Status",n.$$d_$9P8);n.$8J.$Y("ReminderIsSet",n.$$d_$9Q8);n.$8J.$Y("ReminderDueBy",n.$$d_$9Q8);n.$8J.$Y("IsPrivate",n.$$d_$9Q8);$76k(n);n.$s7?_a.$6.$19(null,"TasksCompose.New"):_a.$6.$19(null,"TasksOpen.ItemOpen")}function $76j(n){n.$NM=new _y.$GB(n.get_$5rS(),n.$$d_$1BY,n.$iR,n.$1z4)}function $76h(n){var i=n.$8J.get_$3H6();var t=new _c.$bf(i,n.$Gt);var r=this;t.add_$29(function(i){n.set_$3VH(null);n.set_$gB(!1);n.set_$yX(!1);n.set_$Aq(!1);n.set_$A9(!0);n.get_$1Ec()?n.get_$7c()&&n.get_$7c()():$BF(n,"NewTaskClosed",n,t.$5S)});t.add_$21(n.$$d_$9db);OwaApplication.$1W.$11(t)}function $76m(n,t){var r=n.$8J.get_$3H6();var i=new _c.$nZ(r);var u=this;i.add_$29(function(i){n.set_$gB(!1);n.set_$Aq(!1);n.set_$A9(!0);if(n.get_$1Ec()){n.$Gb&&_h.$13.$AGi(_g.$9Q,Boolean,n.$Gb,"NeedsUpdate",n.$Gb.get_$1HC(),!0,function(n,t){n.set_$1HC(t)});n.get_$7c()&&n.get_$7c()()}else if(t){var r=n.$8J?n.$8J.$JZ.get_$i():null;$BF(n,"NewTaskClosed",n,r)}else n.$39B()});i.add_$21(n.$$d_$9db);OwaApplication.$1W.$11(i)}function $2lM(n,t){n.set_$gB(!1);if(n.$8J&&n.$8J.$YE&&!t){var i=new _js.$c;i.$D(n.$8J.$JZ);n.$1Wd.$IJ(i,null,null,null)}if(n.$s7){n.set_$3VH(null);$BF(n,"NewTaskClosed",n,null)}else $2lN(n);n.set_$yX(!1);n.get_$1Ec()&&n.get_$7c()&&n.get_$7c()()}function $76l(n,t){if(n.$Ka){var i=this;n.$Ka.$E(function(i){n.$rJ=i;n.$rJ&&n.$rJ.$VM(n.$8J.$it,t,!0)})}}function $4tN(n){$76j(n);n.$2cw=new _0365m.$2c([new _0365m.$o(_u.Strings.l_Delete_LowerCase_Text,null,n.$Jm),n.$NM.$1ab()]);n.get_$1Ec()||n.$2cw.$14.$D(new _0365m.$o(_u.Strings.l_OpenInSeparateWindowMenuItem_LowerCase_Text,null,n.$28w));n.$2x9=new _0365m.$2c([new _0365m.$o(_u.Strings.l_Delete_LowerCase_Text,null,n.$Jm),n.$NM.$1ab(),new _0365m.$o(_nbs.NonBootStrings.l_TaskFormMarkCompleteButton_LowerCase_Text,null,n.$4BE)]);n.$2cw.$Y("IsShown",n.$$d_$6KX);n.$2x9.$Y("IsShown",n.$$d_$6KX)}function $76k(n){n.set_$3nJ(new _d.$4Q(n.$8J.$Bj,_g.$V.get_$I().get_$13().get_$MF(),new _y.$4p,_y.$x.$w));n.$ET.$Y("RecurrenceSelected",n.$$d_$6MV);n.$ET.set_$1O(!1)}_d.$56.prototype={$J:null,$4U:null,$Ka:null,$JA:null,$s7:!1,$T0:!1,$8J:null,$Gb:null,$T6:!1,$On:!1,$192:!1,$2T2:!1,$Q2:null,$DO:null,$4f:null,$28w:null,$iF:null,$4BE:null,$Jm:null,$iR:null,$1z4:null,$1WJ:null,$29D:null,$1bd:null,$1v:null,$J8:null,$IO:null,$2Ok:null,$d8:!1,$2cw:null,$2x9:null,$ET:null,$1Wd:null,$6pK:null,$Gt:null,$2Rl:!1,$35q:!1,$Cd:!1,$NM:null,$E7:null,$rJ:null,add_$9JI:function(n){this.$2G("NewTaskClosed",n)},remove_$9JI:function(n){this.$2H("NewTaskClosed",n)},add_$A6o:function(n){this.$2G("TaskDelete",n)},remove_$A6o:function(n){this.$2H("TaskDelete",n)},get_$5rS:function(){return _g.$V.get_$I().get_$Ht()},get_$g6:function(){return this.$8J?this.$8J.$x:null},get_$Aq:function(){return this.$Cd},set_$Aq:function(n){if(this.$Cd!==n){this.$Cd=n;$3(this,"IsSaving")}return n},get_$A9:function(){return this.$T6},set_$A9:function(n){if(this.$T6!==n){this.$T6=n;$3(this,"Loading")}return n},get_$gB:function(){return this.$On},set_$gB:function(n){if(this.$On!==n){this.$On=n;$3(this,"IsEditMode");this.$IO&&this.$IO.$s();if(this.$On){this.$T0&&this.$bq();this.$8J&&(this.$6pK=new _a.$mD(this.$8J))}}return n},get_$yX:function(){return this.$s7},set_$yX:function(n){if(this.$s7!==n){this.$s7=n;$3(this,"IsNewTask");if(this.$s7){this.$Gb=null;$4tO(this);this.set_$gB(!0)}}return n},get_$47d:function(){return this.$2T2},set_$47d:function(n){if(this.$2T2!==n){this.$2T2=n;$3(this,"IsShowDetails");this.$bq()}return n},get_$8Dv:function(){return _y.$x.$w.get_$L()!=="Mouse"},get_$2Ko:function(){return this.$Gb},set_$2Ko:function(n){if(this.$Gb!==n){_a.$6.$1X(_d.$56.$A,"TasksOpen.ItemOpen");this.$Gb&&this.$Gb.remove_onCacheOperation(this.$$d_$9Ox);this.$Gb=n;$3(this,"CurrentTask");this.$Gb&&this.$Gb.add_onCacheOperation(this.$$d_$9Ox);this.set_$yX(!1);$4tO(this)}return n},get_$3VH:function(){return this.$8J},set_$3VH:function(n){if(this.$8J!==n){this.$8J=n;$3(this,"TaskViewModel");$3(this,"IsReadOnly")}return n},get_$1zx:function(){return this.$d8},set_$1zx:function(n){if(this.$d8!==n){this.$d8=n;$3(this,"IsEditorInitialized")}return n},get_$A4R:function(){if(!this.$1WJ){this.$1WJ=new _js.$c;this.$1WJ.$D("NotStarted");this.$1WJ.$D("InProgress");this.$1WJ.$D("Completed");this.$1WJ.$D("WaitingOnOthers");this.$1WJ.$D("Deferred")}return this.$1WJ},get_$9jk:function(){if(!this.$29D){this.$29D=new _js.$c;this.$29D.$D("Low");this.$29D.$D("Normal");this.$29D.$D("High")}return this.$29D},get_$7uL:function(){if(!this.$1bd){this.$1bd=new _js.$c;this.$1bd.$D(0);this.$1bd.$D(1);this.$1bd.$D(2);this.$1bd.$D(3)}return this.$1bd},get_$1Ec:function(){return!_y.$x.$w.get_$9l()},get_$44f:function(){return this.$2Rl},set_$44f:function(n){if(this.$2Rl!==n){this.$2Rl=n;$3(this,"IsDiscoveryMode");$3(this,"IsReadOnly")}return n},get_$8Lb:function(){return this.$35q},set_$8Lb:function(n){if(this.$35q!==n){this.$35q=n;$3(this,"IsItemAttachment");$3(this,"IsReadOnly")}return n},get_$Cc:function(){var n=!1;this.$8J&&this.$8J.$JZ&&this.$8J.$JZ.get_$34D()&&(n=!0);return this.$2Rl||n||this.$35q},get_$7c:function(){return this.$JA},set_$7c:function(n){this.$JA=n;return n},get_$7sU:function(){return!1},get_$3nJ:function(){return this.$ET},set_$3nJ:function(n){if(this.$ET!==n){this.$ET=n;$3(this,"ComposeRecurrenceViewModel")}return n},get_$1kp:function(){return 1},get_$2PH:function(){return null},get_$5im:function(){if(this.$On){this.$IO&&this.$IO.$s();return this.$6pK.$8In()||this.$8J.$1LU.get_$17B()!==this.$8J.$JZ.get_$2Gm()||this.$8J.$1X1.get_$17B()!==this.$8J.$JZ.get_$2iR()||!_g.$C.$4N(this.$8J.$Bj.get_$K1(),this.$8J.$JZ.get_$1Uj())||this.$8J.$it.get_$FQ()||this.$8J.$YE}else return!1},get_$28:function(){return this.$Gt},set_$28:function(n){this.$Gt=n;return n},$3NL:function(n){if(!this.$1v.$30)if(this.get_$5im()){var t=this;this.$1v.$2u(2,_nbs.NonBootStrings.l_DiscardTaskEntryMessage_Text,function(i,r){if(i){t.get_$1Ec()&&(t.$192=!0);$2lM(t)}n&&n(i)},!1,_u.Strings.l_Discard_Text,_nbs.NonBootStrings.l_ConfirmDialog_Back_Text,_nbs.NonBootStrings.l_DiscardTaskEntryTitle_Text)}else if(n){this.$On&&$2lM(this);n(!0)}},$pN:function(n){this.$1z4=n;$4tN(this)},$39B:function(){var n=new _c.$DT(500,[this.$Gb.get_$i()],0,this.$2Rl);n.add_$2t(this.$$d_$88U);this.set_$A9(!0);OwaApplication.$1W.$11(n)},$FZ:function(){_y.$1Mq.prototype.$FZ.call(this);this.$T0=!0;this.$s7&&this.$bq()},$TZ:function(){_y.$1Mq.prototype.$TZ.call(this);this.$T0=!1},$9Ox:function(n,t){var i=t;i.$EN!=="NeedsUpdate"||this.$On||this.$39B()},$88U:function(n){var t=n;if(this.$Gb&&t.$Bg.length===1&&t.$Bg[0].Id===this.$Gb.get_$i().Id){var i=_h.$1L.get_$I().$3f(this.$Gb.get_$i().Id);this.$Gb=i;this.$Gb.set_$1HC(!1);$2lN(this);this.set_$A9(!1)}},$9Q8:function(n,t){this.get_$Cc()||this.$On||this.$4YC()},$9P8:function(n,t){this.$8J.$6d0()},$2JT:function(){this.$1BY(null,null,!0)},$1BY:function(n,t,i){var r=_g.$Bx.$1ot(this.$Gb.get_$6T(),i,t,n);if(r){var u=new _h.$R2([r],null);u.set_$3O([this.$Gb]);OwaApplication.$1W.$11(u)}},$7ur:function(){this.set_$gB(!0)},$4YC:function(){if(this.$8J.get_$C0())if(this.$Cd){_js.Trace.logInfo(_d.$56.$A,"TaskReadingPaneViewModel.SaveTask has been called while a save operation is in progress. Ignoring...");return}else this.set_$Aq(!0);else{this.$1v.$2u(0,this.$8J.$pv,null);return}this.$IO&&this.$IO.$s();this.$s7&&!this.$8J.$YE?$76h(this):$76m(this,this.$8J.$YE)},$9db:function(n){var t=n;if(t&&t.$1d){this.get_$g6().$Db(this.$8J.get_$6jh());var i=_y.$5u.$3kl(t.$1d,41,51,63,700,88,89,42,41);this.get_$g6().$2j(i);this.set_$Aq(!1)}},$7hM:function(){var n=this;this.$3NL(function(t){t&&$2lM(n)})},$9hp:function(){if(this.$8J.$it.get_$Bz()){this.$1v.$2u(0,_nbs.NonBootStrings.l_TaskValidationAttachmentInProgress_Text,null);return}var t={};this.$s7||(t.ItemID=this.$Gb.get_$i());var n=new _d.$8q;n.set_$eZ(this.$Gb);n.set_$gB(this.$On);n.set_$yX(this.$s7);if(this.$On){this.$IO&&this.$IO.$s();n.set_$5Qy(this.$8J.$9s2());n.set_$DI(this.$8J.$YE);if(n.get_$DI()){n.set_$yX(!1);n.set_$eZ(this.$8J.$JZ)}}_y.$x.$w.$N3(_d.$hm,null,t,_y.$48.get_$T4(),n,!1);$2lM(this,!0)},$7Xe:function(){if(this.$4U&&this.$4U.$3N("AttachmentsFilePicker")&&_y.$x.$w.get_$L()!=="TouchNarrow"){var n=_a.$6.$1X(_a.$0.$1P,"AttachmentsFilePickerPanelOpen",!0);_js.Trace.logInfo(_a.$0.$6y,"Opening OWA's file picker from calendar compose");$76l(this,n)}else{_js.Trace.logInfo(_a.$0.$l,"Opening OS's file picker");this.$8J.$it.$u9(!1,null,null)}},$8Te:function(){this.$8J.set_$Ji(_a.$7.get_$2F().$4D());this.$4YC()},$6KX:function(n,t){(this.$2cw.$30||this.$2x9.$30)&&this.$NM.$1tj($76i(this),1)},$7rT:function(){if(!this.get_$Cc())if(this.get_$1Ec()){var n=new _js.$c;n.$D(this.$Gb);this.$1Wd.$IJ(n,this.$Gb.get_$28(),null,this.get_$7c())}else $BF(this,"TaskDelete",this,this.$Gb)},$6MV:function(n,t){this.$ET.$ZJ&&!_cc.$UN.isInstanceOfType(this.$ET.$ZJ)&&this.$ET.set_$1O(!0)},$3nR:function(n){if(!this.$192&&this.get_$5im()){n.$1Lk(_nbs.NonBootStrings.l_DiscardTaskEntryMessage_Text);!this.get_$1Ec()&&this.$J&&this.$J.$9lH(_y.$H5,new _y.$H5(3,null))}else this.$192=!1},$bq:function(){this.$2Ok&&this.$2Ok.$2T&&this.$2Ok.$s()}};_d.$123=function(n,t,i,r){this.$J=n;this.$E7=t;this.$2NY=i;this.$Ka=r};_d.$123.prototype={$J:null,$E7:null,$2NY:null,$Ka:null,$E:function(){return new _d.$56(this.$J,this.$E7,this.$2NY,this.$Ka)}};_d.$hm=function(n,t,i,r){this.$J=n;this.$E7=t;this.$2NY=i;this.$Ka=r};_d.$hm.prototype={$J:null,$E7:null,$2NY:null,$Ka:null,$br:function(n,t){var r=n.ItemID;var i=new _d.$56(this.$J,this.$E7,this.$2NY,this.$Ka);if($5(r))i.set_$yX(!0);else{var e=new _g.$1t(r);var u=new _g.$9Q;u.set_$i(e);_h.$1L.get_$I().$IB(r,u);i.set_$2Ko(u)}var f=n.DiscoveryMode;!$5(f)&&Boolean.parse(f)&&i.set_$44f(!0);return i},$wx:function(n,t){var r=n;var i=new _d.$56(this.$J,this.$E7,this.$2NY,this.$Ka);var u=this;i.$Y("TaskViewModel",function(n,t){if(r.get_$gB()&&i.$8J){i.set_$gB(r.get_$gB());i.$8J.$9qH(r.get_$5Qy());i.$8J.$YE=r.get_$DI();i.set_$47d(i.$8J.get_$5cF())}});i.set_$2Ko(r.get_$eZ());i.set_$yX(r.get_$yX());return i}};_d.$Ln=function(n,t){this.$$d_$9ZK=Function.createDelegate(this,this.$9ZK);this.$$d_$9Q3=Function.createDelegate(this,this.$9Q3);this.$$d_$6NG=Function.createDelegate(this,this.$6NG);this.$$d_$9OH=Function.createDelegate(this,this.$9OH);this.$$d_$9XV=Function.createDelegate(this,this.$9XV);this.$$d_$1jx=Function.createDelegate(this,this.$1jx);this.$$d_$17Z=Function.createDelegate(this,this.$17Z);_d.$Ln.initializeBase(this);this.$JZ=n?n:_d.$Ln.$7lE();$4tP(this,this.$JZ);this.set_$g7(new _y.$5u);this.$6d0();this.$tj=new _a.$mD(this.$JZ);var i=this;t.$E(function(n){i.$5f=n.$1aa(i.$JZ.get_$i(),i.$JZ.get_$1P()?i.$JZ.get_$1P().get_$AIt():new _js.$c,!0,!0,null,!0,null,null);i.$it=n.$1aZ(i.$JZ.get_$i(),i.$JZ.get_$1P()?i.$JZ.get_$1P().get_$AIt():new _js.$c,!1,3,!0,null,!0,new _y.$5u,null);i.$it.add_$17Z(i.$$d_$17Z)});this.$Y("Status",this.$$d_$1jx);this.$Y("PercentComplete",this.$$d_$9XV);this.$Y("CompleteDate",this.$$d_$9OH);this.$Y("StartDate",this.$$d_$6NG);this.$Y("DueDate",this.$$d_$9Q3);this.$Y("ReminderIsSet",this.$$d_$9ZK)};_d.$Ln.$7lE=function(){var n=new _g.$9Q;n.set_$6Y("Normal");n.set_$3M(new _g.$6j(new _g.$6b("Text","")));return n};function $4tP(n,t){n.$Zc=t.get_$2i();n.$Cy=t.get_$Bx()?t.get_$Bx().$3g():null;n.$6F=t.get_$91()?t.get_$91().$3g():null;n.$Co=t.get_$Az();n.$1df=t.get_$6Y();n.$KS=t.get_$Ji()?t.get_$Ji().$3g():null;n.$Gu=t.get_$kt()?t.get_$kt():"0";isNaN(_a.$BY.$10L(n.$Gu))&&(n.$Gu="0");n.$1ey=t.get_$8F()==="Private";n.$1Ul=t.get_$PU();n.$hH=t.get_$1IZ()?t.get_$1IZ().$3g():null;n.$1iT=t.get_$2ZB();n.$1Z1=t.get_$2II();n.set_$26Y(t.get_$26Y());var r=t.get_$3M()?t.get_$3M().get_$1n():null;_js.$8.$a(r)&&(r="<html><head></head></html>");n.set_$3M(r);n.set_$DF("");var u=new Sys.StringBuilder;if(!$5(t.get_$wf()))for(var i=0;i<t.get_$wf().get_$C();i++){u.append(t.get_$wf().get_$3o(i));i!==t.get_$wf().get_$C()-1&&u.append(" ")}n.$fP=u.toString();n.$1X1=new _d.$iX(t.get_$2iR());n.$1LU=new _d.$iX(t.get_$2Gm());n.$Bj=new _cc.$10n(t.$3g(),new _g.$1GM,_a.$7.get_$2F(),null)}function $4tQ(n,t){t.set_$2i(n.$Zc);t.set_$Bx(n.$Cy);t.set_$91(n.$6F);t.set_$Az(n.$Co);t.set_$6Y(n.$1df);t.set_$Ji(n.$KS);t.set_$kt(n.$Gu.toString());t.set_$8F(n.$1ey?"Private":"Normal");t.set_$PU(n.$1Ul);t.set_$1IZ(n.$hH);t.set_$2ZB(n.$1iT);t.set_$2II(n.$1Z1);t.set_$26Y(n.$oX);var i;i="Mouse"!==_y.$x.$w.get_$L()?new _g.$6b("Text",n.$5G):new _g.$6b("HTML",n.$5G);var u=new _g.$6j(i);t.set_$3M(u);var r=new(_a.$Z.$$(String));_js.$8.$a(n.$fP)||r.$D(n.$fP);t.set_$wf(r);t.set_$2iR(n.$1X1.get_$17B());t.set_$2Gm(n.$1LU.get_$17B());t.get_$Az()!=="Completed"&&n.$tj.$10p("CompleteDate");if(n.$tj.$gE("CompleteDate")){n.$tj.$10p("Status");n.$tj.$10p("PercentComplete")}t.set_$1Uj(n.$Bj.get_$K1())}_d.$Ln.prototype={$YE:!1,$mx:null,$5G:null,$fP:null,$1Z1:null,$1iT:null,$hH:null,$1Ul:!1,$1ey:!1,$Gu:null,$KS:null,$1df:"Low",$Co:"NotStarted",$6F:null,$Cy:null,$JZ:null,$1X1:null,$1LU:null,$Zc:null,$4fM:null,$x:null,$5f:null,$it:null,$Bj:null,$pv:null,$oX:null,$tj:null,get_$2i:function(){return this.$Zc},set_$2i:function(n){if(this.$Zc!==n){this.$Zc=n;$3(this,"Subject")}return n},get_$g7:function(){return this.$x},set_$g7:function(n){if(this.$x!==n){this.$x=n;$3(this,"InfoBarViewModel")}return n},get_$Bx:function(){return this.$Cy},set_$Bx:function(n){if(!_a.$7.$4N(this.$Cy,n)){this.$Cy=n;$3(this,"DueDate")}return n},get_$91:function(){return this.$6F},set_$91:function(n){if(!_a.$7.$4N(this.$6F,n)){this.$6F=n;$3(this,"StartDate")}return n},get_$Az:function(){return this.$Co},set_$Az:function(n){if(this.$Co!==n){this.$Co=n;$3(this,"Status")}return n},get_$6Y:function(){return this.$1df},set_$6Y:function(n){if(this.$1df!==n){this.$1df=n;$3(this,"Importance")}return n},get_$Ji:function(){return this.$KS},set_$Ji:function(n){if(!_a.$7.$4N(this.$KS,n)){this.$KS=n;$3(this,"CompleteDate")}return n},get_$kt:function(){return this.$Gu},set_$kt:function(n){if(this.$Gu!==n){this.$Gu=n;$3(this,"PercentComplete")}return n},get_$dB:function(){return this.$1ey},set_$dB:function(n){if(this.$1ey!==n){this.$1ey=n;$3(this,"IsPrivate")}return n},get_$PU:function(){return this.$1Ul},set_$PU:function(n){if(this.$1Ul!==n){this.$1Ul=n;$3(this,"ReminderIsSet")}return n},get_$1IZ:function(){return this.$hH},set_$1IZ:function(n){if(!_a.$7.$4N(this.$hH,n)){this.$hH=n;$3(this,"ReminderDueBy")}return n},get_$2ZB:function(){return this.$1iT},set_$2ZB:function(n){if(this.$1iT!==n){this.$1iT=n;$3(this,"Mileage")}return n},get_$2II:function(){return this.$1Z1},set_$2II:function(n){if(this.$1Z1!==n){this.$1Z1=n;$3(this,"BillingInformation")}return n},get_$wf:function(){return this.$fP},set_$wf:function(n){if(this.$fP!==n){this.$fP=n;$3(this,"Companies")}return n},get_$3M:function(){return this.$5G},set_$3M:function(n){if(this.$5G!==n){this.$5G=n;$3(this,"Body")}return n},get_$DF:function(){return this.$mx},set_$DF:function(n){if(this.$mx!==n){this.$mx=n;$3(this,"EditorContent")}return n},get_$26Y:function(){return this.$oX},set_$26Y:function(n){this.$oX!==n&&(this.$oX=n);return n},get_$5cF:function(){return!!this.$6F||this.$Co!=="NotStarted"||this.$1df!=="Normal"||!!this.$KS||_a.$BY.$10L(this.$Gu)>0||this.$1ey||this.$1Ul||!!this.$hH||this.$1X1.get_$17B()>0||this.$1LU.get_$17B()>0||!_js.$8.$a(this.$1iT)||!_js.$8.$a(this.$1Z1)||!_js.$8.$a(this.$fP)||!!this.$Bj.get_$K1()},get_$C0:function(){var t=!0;if(this.$it.get_$Bz()){this.$pv=_nbs.NonBootStrings.l_TaskValidationAttachmentInProgress_Text;return!1}if(_js.$8.$15(this.$Zc)){this.$pv=_nbs.NonBootStrings.l_TaskValidationEmptySubject_Text;return!1}if(this.$Cy&&this.$6F&&this.$6F.$2U(this.$Cy)>0){this.$pv=_nbs.NonBootStrings.l_TaskValidationEarlyDueDate_Text;return!1}var n=_a.$BY.$10L(this.$Gu);if(isNaN(n)||n<0||n>100){this.$pv=_nbs.NonBootStrings.l_TaskValidationPercentInvalid_Text;return!1}if(isNaN(_a.$BY.$10L(this.$1X1.$q0))||_a.$BY.$10L(this.$1X1.$q0)<0){this.$pv=_nbs.NonBootStrings.l_TaskValidationTotalWorkInvalid_Text;return!1}if(isNaN(_a.$BY.$10L(this.$1LU.$q0))||_a.$BY.$10L(this.$1LU.$q0)<0){this.$pv=_nbs.NonBootStrings.l_TaskValidationActualWorkInvalid_Text;return!1}if(this.$1X1.get_$17B()>1525252319){this.$pv=_nbs.NonBootStrings.l_TaskValidationMaxTotalWork_Text;return!1}if(this.$1LU.get_$17B()>1525252319){this.$pv=_nbs.NonBootStrings.l_TaskValidationMaxActualWork_Text;return!1}return t},get_$3H6:function(){$4tQ(this,this.$JZ);return this.$tj},$9s2:function(){var n=this.$JZ.$3g();$4tQ(this,n);return n},$9qH:function(n){$4tP(this,n)},get_$6jh:function(){this.$4fM||(this.$4fM=[41,42,51,63,700,88,89,10020,10030,10040,10050,10060,10070,10080,10010]);return this.$4fM},$6d0:function(){this.$x.$Db(this.get_$6jh());this.$JZ.get_$34D()&&this.$x.$2j(10010);if(this.$Co==="Completed")this.$x.$2j(10080,this.$KS.$2b(1));else if(this.$Cy){var t=new _a.$Ms(_a.$7.get_$2F().$4D(),this.$Cy.$4D()).get_$vQ();var n=Math.floor(t);n?n===1?this.$x.$2j(10040):n>1&&n<15?this.$x.$2j(10050,n.toString()):n===-1?this.$x.$2j(10030):n<-1&&n>-15?this.$x.$2j(10070,Math.abs(n).toString()):n<-14&&this.$x.$2j(10060):this.$x.$2j(10020)}},$1jx:function(n,t){if(this.$Co==="Completed"){this.$KS||this.set_$Ji(_a.$7.get_$2F().$4D());this.set_$kt("100")}else{this.set_$Ji(null);(this.$Co==="NotStarted"||_a.$BY.$10L(this.$Gu)===100)&&this.set_$kt("0")}},$9XV:function(n,t){var i=_a.$BY.$10L(this.$Gu);i?i>0&&i<100?this.set_$Az("InProgress"):i===100&&this.set_$Az("Completed"):this.set_$Az("NotStarted")},$9OH:function(n,t){this.$KS?this.set_$Az("Completed"):this.set_$Az("NotStarted")},$6NG:function(n,t){this.$6F&&(!this.$Cy||this.$Cy.$2U(this.$6F)<0)&&this.set_$Bx(this.$6F)},$9Q3:function(n,t){this.$Cy||this.set_$91(null)},$9ZK:function(n,t){if(this.$1Ul&&!this.$hH){var i=_a.$7.get_$2F();this.$Cy?this.$Cy.$9K(i)<=0?this.set_$1IZ(new _a.$7(i.get_$4S(),i.get_$3T(),i.get_$5n(),8,0,0)):this.set_$1IZ(new _a.$7(this.$Cy.get_$4S(),this.$Cy.get_$3T(),this.$Cy.get_$5n(),8,0,0)):this.set_$1IZ(new _a.$7(i.get_$4S(),i.get_$3T(),i.get_$5n(),8,0,0).$2w(1))}},$17Z:function(){if($5(this.$JZ.get_$i())){var i=new _a.$mD(this.$JZ);var t=new _c.$bf(i);var n=this;t.add_$2t(function(i){n.$JZ.set_$i(t.$5S);n.$YE=!0;$5(n.$it)||n.$it.$18V(n.$JZ.get_$i(),n.$JZ.get_$1P()?n.$JZ.get_$1P().get_$AIt():new _js.$c,null)});OwaApplication.$1W.$11(t)}else this.$YE&&($5(this.$it)||this.$it.$18V(this.$JZ.get_$i(),this.$JZ.get_$1P().get_$AIt(),null))}};_d.$iX=function(n){_d.$iX.initializeBase(this);$76x(this,n)};function $76x(n,t){n.$q0=t.toString();n.$1AA=0;if(t){if(t>0){for(var r=[1,60,480,2400],f=[10,4],i=0;i<r.length-1&&t>=r[i+1];)i++;while(i>0){for(var u=0;u<f.length;u++)for(var e=1;e<=f[u];e++)if(!(t%(r[i]*e/f[u]))){n.$q0=(t/r[i]).toString();n.$1AA=i;return}i--}}}else n.$1AA=1}_d.$iX.prototype={$1AA:0,$q0:null,get_$AG9:function(){return this.$q0},set_$AG9:function(n){if(this.$q0!==n){this.$q0=n;$N(this,"WorkAmount")}return n},get_$AGC:function(){return this.$1AA},set_$AGC:function(n){if(this.$1AA!==n){this.$1AA=n;$N(this,"WorkUnit")}return n},get_$17B:function(){var n=_a.$BY.$10L(this.$q0);switch(this.$1AA){case 1:n*=60;break;case 2:n*=480;break;case 3:n*=2400;break}return Math.floor(n)},toLocaleString:function(){var n=new _d.$wj;var t=_a.$BY.$10L(this.$q0)===1?n.$2x(this.$1AA,1):n.$2x(this.$1AA,2);return String.format(_nbs.NonBootStrings.l_WorkUnitFormatString_Text,this.$q0,t)},$4i:function(n){if(!n||!_d.$iX.isInstanceOfType(n))return!1;var t=n;return this.get_$17B()===t.get_$17B()}};_d.$4Z=function(n){this.$$d_$7sS=Function.createDelegate(this,this.$7sS);this.$$d_$13h=Function.createDelegate(this,this.$13h);this.$$d_$2ns=Function.createDelegate(this,this.$2ns);this.$$d_$9hY=Function.createDelegate(this,this.$9hY);this.$$d_$9YA=Function.createDelegate(this,this.$9YA);this.$$d_$6Rg=Function.createDelegate(this,this.$6Rg);this.$$d_$28s=Function.createDelegate(this,this.$28s);_d.$4Z.initializeBase(this);this.$P=n;this.set_$6Re(new _C(this.$$d_$28s,_d.$4Z.$A));this.set_$6Rh(new _C(this.$$d_$6Rg,_d.$4Z.$A));this.set_$6Rd(new _C(this.$$d_$9YA,_d.$4Z.$A));this.$1v=new _y.$4p;this.set_$2w1(_g.$V.get_$I().get_$2z().get_$6Rf());$3bX(this)};function $75G(n,t){switch(t){case"Idle":case"Disconnected":return"";case"Connecting":return _nbs.NonBootStrings.l_PlayOnPhoneDialing_Text;case"Connected":return _nbs.NonBootStrings.l_PlayOnPhoneConnected_Text;default:throw Error.invalidOperation("Invalid Call State.");}}function $3bX(n){if(!$5(n.$1ke)){n.$AAy();n.$1ke=""}n.set_$2rn(!0);n.set_$23T("");n.set_$2Sg(!1)}_d.$4Z.prototype={$1ke:null,$P:null,$1v:null,get_$6Re:function(){return this.$W(_d.$4Z.$4TP)},set_$6Re:function(n){this.$M(_d.$4Z.$4TP,n);return n},get_$6Rh:function(){return this.$W(_d.$4Z.$4TQ)},set_$6Rh:function(n){this.$M(_d.$4Z.$4TQ,n);return n},get_$6Rd:function(){return this.$W(_d.$4Z.$4TN)},set_$6Rd:function(n){this.$M(_d.$4Z.$4TN,n);return n},get_$2rn:function(){return this.$W(_d.$4Z.$3lf)},set_$2rn:function(n){this.$M(_d.$4Z.$3lf,n);return n},get_$2Sg:function(){return this.$W(_d.$4Z.$46o)},set_$2Sg:function(n){this.$M(_d.$4Z.$46o,n);return n},get_$6Rc:function(){return this.$W(_d.$4Z.$4TO)},set_$6Rc:function(n){this.$M(_d.$4Z.$4TO,n);return n},get_$2w1:function(){return this.$W(_d.$4Z.$3s5)},set_$2w1:function(n){this.$M(_d.$4Z.$3s5,n);return n},get_$23T:function(){return this.$W(_d.$4Z.$4C9)},set_$23T:function(n){this.$M(_d.$4Z.$4C9,n);return n},$7gp:function(){$5(this.$1ke)||this.$6Rg()},$9hY:function(n){if(n.EventType!=="Reload"){var t=n;this.set_$23T($75G(this,t.callState));(t.callState==="Disconnected"||t.callState==="Idle")&&$3bX(this)}},$4e0:function(){var n=new _g.$Ac;n.NotificationType="PlayOnPhoneNotification";n.CallId=this.$1ke;var t=new _h.$B8(n);t.$Hd(_d.$4Z.$A,"PlayOnPhoneNotification",this.$$d_$9hY,2)},$AAy:function(){var n=new _g.$Ac;n.NotificationType="PlayOnPhoneNotification";n.CallId=this.$1ke;var t=new _h.$B8(n);t.$1op()},$28s:function(){this.set_$23T(_nbs.NonBootStrings.l_PlayOnPhoneDialing_Text);var n=new _c.$1Ci(this.$P.get_$i().Id,this.get_$2w1());this.set_$2Sg(!0);n.add_$29(this.$$d_$2ns);n.add_$21(this.$$d_$13h);OwaApplication.$1W.$11(n)},$6Rg:function(){var n=new _c.$1Ck(this.$1ke);this.set_$23T(_nbs.NonBootStrings.l_PlayOnPhoneDisconnecting_Text);n.add_$2t(this.$$d_$7sS);OwaApplication.$1W.$11(n)},$9YA:function(){this.set_$6Rc(!0)},$2ns:function(n){this.$1ke=n.$Dz.PhoneCallId.Id;this.set_$2rn(!1);this.$4e0()},$13h:function(n){var i=n;var t=_nbs.NonBootStrings.l_PLayOnPhoneFailed_Text;if(i.get_$hJ()&&i.get_$hJ().Body){var r=i.get_$hJ().Body.ResponseCode;switch(r){case"ErrorInvalidId":case"ErrorInvalidIdMalformed":t=_nbs.NonBootStrings.l_ErrorUMInvalidObjectID_Text;break;case"ErrorPhoneNumberNotDialable":t=_nbs.NonBootStrings.l_ErrorUMDialingRules_Text;break;case"ErrorIPGatewayNotFound":t=_nbs.NonBootStrings.l_ErrorUMIPGateway_Text;break;case"ErrorInvalidPhoneNumber":case"ErrorInvalidSIPUri":t=_nbs.NonBootStrings.l_InvalidPhoneNumber_Text;break}}this.set_$23T("");this.$1v.$2u(0,t,null);this.set_$2rn(!0);this.set_$2Sg(!1)},$7sS:function(n){$3bX(this)}};_d.$CK=function(n,t){_d.$CK.initializeBase(this);_a.$3.$m(t,"nativeBridge");this.set_$3o(n);this.$37x=!1;this.$5lL=_g.$V.get_$I().get_$2z().get_$21A();this.$c=t;this.set_$4TR(new _d.$4Z(n));$76o(this)};function $76o(n){if(n.get_$3o().get_$1P())for(var i=0;i<n.get_$3o().get_$1P().get_$C();i++){var t=n.get_$3o().get_$1P().get_$3o(i);if(t.get_$1N()===n.get_$3o().get_$4jT()){if(!n.get_$21A()){n.set_$CG(new _d.$oI(t,_y.$8u.$2zd(t.get_$3l(),!1),n.get_$3o().get_$i().Id));n.$37x=_g.$y.$46z(n.get_$3o().get_$7n())?!0:t.get_$Bw()==="audio/mp3"?!0:!1}if(n.get_$4bk()||n.get_$6fU()){n.$XM=new Array(1);n.$XM[0]=t.get_$3l().Id}break}}}_d.$CK.prototype={$5lL:!1,$c:null,$37x:!1,$4ca:!1,$XM:null,get_$3o:function(){return this.$W(_d.$CK.$15s)},set_$3o:function(n){this.$M(_d.$CK.$15s,n);return n},get_$CG:function(){return this.$W(_d.$CK.$4d4)},set_$CG:function(n){this.$M(_d.$CK.$4d4,n);return n},get_$4TR:function(){return this.$W(_d.$CK.$4TS)},set_$4TR:function(n){this.$M(_d.$CK.$4TS,n);return n},get_$4bk:function(){var n=!1;this.get_$48H()&&this.$37x&&!this.get_$21A()&&(this.get_$8L1()||this.$c.$5i(this.$c.get_$1Yx()))&&(n=!0);return n},get_$6fU:function(){return!this.get_$21A()&&this.get_$48H()&&!this.get_$4bk()&&_a.UserAgent.getInstance().$5oh},get_$5D9:function(){return this.$XM},get_$48H:function(){return _g.$y.$5mU(this.get_$3o().get_$7n())},get_$A2Q:function(){return this.$4ca},set_$A2Q:function(n){this.$4ca=n;$3(this,"SignalCleanup");return n},get_$21A:function(){return this.$5lL&&_g.$y.$46z(this.get_$3o().get_$7n())},get_$8L1:function(){return _a.UserAgent.getInstance().$41f},$jr:function(){this.set_$A2Q(!0);this.get_$4TR().$7gp()}};_d.$I7=function(n,t,i,r){_d.$I7.initializeBase(this);this.$qk=n;this.$5iv=t;this.$6iy=i?i:_d.$4.get_$7XQ();this.$5TE=r?r:_d.$4.get_$7XP()};_d.$I7.prototype={$5iv:!1,$6iy:null,$5TE:null,$qk:0,$6kL:3e3,$3T1:!1,$2o8:!1,$JD:!1,$2Gb:null,$4NI:null,get_$ez:function(){return this.$2Gb},set_$ez:function(n){if(this.$2Gb!==n){this.$2Gb=n;$3u(this,"ActionMessage","HideDefaultMessage")}return n},get_$3T2:function(){return this.$3T1},set_$3T2:function(n){this.$3T1=n;n&&this.set_$Bz(!1);$3u(this,"HideDefaultMessage","ShowNotification");return n},get_$7XZ:function(){return this.$2o8},set_$7XZ:function(n){this.$2o8=n;this.set_$9Jq(n?this.$6iy:this.$5TE);$3(this,"ActivitySucceeded");return n},get_$9Jq:function(){return this.$4NI},set_$9Jq:function(n){this.$4NI=n;$3(this,"NotificationIcon");return n},get_$Bz:function(){return this.$JD},set_$Bz:function(n){this.$JD=n;n&&this.set_$3T2(!1);$3(this,"IsInProgress");return n},get_$8Lk:function(){return this.$qk===1},get_$5d1:function(){return this.$3T1||!this.$2Gb},$1ms:function(n,t){this.set_$3T2(!0);this.set_$7XZ(n);this.set_$ez(t)},$9ul:function(n,t){this.set_$Bz(!0);this.set_$ez(t)},$9vN:function(n){this.set_$3T2(!1);this.set_$Bz(!1);this.set_$ez(n)},$1pH:function(n){if(this.$6kL>0){var t=this;_js.$J.get_$I().$1s(_a.$0.$59d,"ActivityStatusViewModelTimer",function(){t.$AG();n&&n()},this.$6kL)}else{this.$AG();n()}},$AG:function(){this.set_$ez(null);this.set_$3T2(!1);this.set_$Bz(!1)}};_d.$ev=function(n,t){_a.$3.$1G(n,"text");_a.$3.$K(t,"action");this.$2E=n;this.$2Z=t};_d.$ev.$$=function(n){var t="$ev"+"$1"+"$"+n.getName().replace(/\./g,"_");if(!_d[t]){var r=_d[t]=function(){(this.$$gta=this.$$gta||{})["_d.$ev"]={T:n};for(var i=[],t=0;t<arguments.length;++t)i[t]=arguments[t];_d.$ev.apply(this,i)};r.registerClass("_d."+t);var u=_d.$ev.prototype;for(var f in u){var i={key:f,value:u[f]};"constructor"!==i.key&&(r.prototype[i.key]=i.value)}}return _d[t]};_d.$ev.prototype={$2E:null,$2Z:null,get_$1Q:function(){return this.$2E},get_$q7:function(){return this.$2Z}};_d.$15t=function(){};_d.$15t.prototype={singular:1,plural:2};_d.$15t.registerEnum("_d.$15t",!1);_d.$136=function(){};_d.$136.prototype={$2x:function(n,t){var u=new Sys.StringBuilder;var e="{0}; ";if($5(n))return"";if(!_js.$c.isInstanceOfType(n))throw Error.argumentType("value",Object.getType(n),_js.$c,"Value must be an ObservableCollection");if(!n.get_$C())return"";for(var f=n,i=null,r=0;r<f.get_$C();r++){i=f.get_$3o(r);i.get_$SG()||u.append(_js.$8.$4B(e,i.get_$93().get_$1N()))}return u.toString()},$5Jw:function(n,t){throw Error.notImplemented();}};_d.$13o=function(){};_d.$13o.prototype={$2x:function(n,t){var r=n;var i=null;switch(r){case 0:i=_nbs.NonBootStrings.l_ZeroMinutesDuration_Text;break;case 18e5:i=_nbs.NonBootStrings.l_ThirtyMinutesDuration_Text;break;case 36e5:i=_nbs.NonBootStrings.l_OneHourDuration_Text;break;case 54e5:i=_nbs.NonBootStrings.l_NinetyMinutesDuration_Text;break;case 72e5:i=_nbs.NonBootStrings.l_TwoHoursDuration_Text;break;case-1:i=_nbs.NonBootStrings.l_AllDayDuration_Text;break;case-2:i=_nbs.NonBootStrings.l_CustomDuration_Text;break;default:i="";break}return i},$5Jw:function(n,t){throw Error.notImplemented();}};_d.$13y=function(){};_d.$13y.prototype={$2x:function(n,t){var r=n;var i=null;switch(r){case 0:i="";break;case 1:i=_nbs.NonBootStrings.l_CalendarLayoutTypeStandard_Text;break;case 2:i=_nbs.NonBootStrings.l_CalendarLayoutTypeHorizontalAgenda_Text;break;case 3:i=_nbs.NonBootStrings.l_CalendarLayoutTypeVerticalAgenda_Text;break;default:throw Error.argumentType("value",Object.getType(n),_js.$c,String.format("Value '{0}' is not a supported CalendarLayoutType.",n));}return i},$5Jw:function(n,t){throw Error.notImplemented();}};_d.$13u=function(){};_d.$13u.prototype={$2x:function(n,t){if(Number.isInstanceOfType(n)){var i=Math.abs(n)%24;return new _a.$7(1,1,1,i,0,0).$2b(0)}throw Error.argument(String.format("Expected an int for the hour value. Actual type was '{0}'",n?Object.getType(n).getName():"null"));},$5Jw:function(n,t){throw Error.notImplemented();}};_d.$vw=function(){};_d.$vw.prototype={$2x:function(n,t){return _g.$TG.isInstanceOfType(n)?n.get_$1o():n},$5Jw:function(n,t){throw Error.notImplemented();}};_d.$148=function(){};_d.$148.prototype={$2x:function(n,t){var r=n;var i=null;switch(r){case 1:i=_nbs.NonBootStrings.l_CalendarViewTypeDay_Text;break;case 2:i=_nbs.NonBootStrings.l_CalendarViewTypeWeek_Text;break;case 3:i=_nbs.NonBootStrings.l_CalendarViewTypeWorkWeek_Text;break;case 4:i=_nbs.NonBootStrings.l_CalendarViewTypeMonth_Text;break;case 5:i=_nbs.NonBootStrings.l_CalendarViewTypeAgenda_Text;break;default:throw Error.argumentType("value",Object.getType(n),_js.$c,String.format("Value '{0}' is not a supported CalendarViewType.",n));}return i},$5Jw:function(n,t){throw Error.notImplemented();}};_d.$15H=function(){};_d.$15H.prototype={$2x:function(n,t){switch(n){case 1:return _ucc.CalCoreStrings.l_Sunday_Text;case 2:return _ucc.CalCoreStrings.l_Monday_Text;case 4:return _ucc.CalCoreStrings.l_Tuesday_Text;case 8:return _ucc.CalCoreStrings.l_Wednesday_Text;case 16:return _ucc.CalCoreStrings.l_Thursday_Text;case 32:return _ucc.CalCoreStrings.l_Friday_Text;case 64:return _ucc.CalCoreStrings.l_Saturday_Text;default:return""}},$5Jw:function(n,t){throw Error.notImplemented();}};_d.$15a=function(){};_d.$15a.prototype={$2x:function(n,t){switch(n){case 0:return _d.$65;case 1:return _d.$Lu;case 2:return _d.$Rj;default:throw Error.invalidOperation("Not supported CalendarItemDetailsPivotType: "+n.toString());}},$5Jw:function(n,t){var i=n;if(i===_d.$65)return 0;if(i===_d.$Lu)return 1;if(i===_d.$Rj)return 2;throw Error.invalidOperation("Not supported Type: "+i);}};_d.$jt=function(){};_d.$jt.prototype={$2x:function(n,t){var i=_js.$9a.$W(Number,n);if(i===_d.$CN.$1TP)return _nbs.NonBootStrings.l_ReminderPickerDurationNone_Text;var r=i*60;return _a.$7.$2zs(r)},$5Jw:function(n,t){throw Error.notImplemented();}};_d.$wj=function(){};_d.$wj.prototype={$2x:function(n,t){var i="";if(Number.isInstanceOfType(n)){var r=_js.$1i.$or(_d.$15t,t.toString());switch(n){case 0:i=r===1?_nbs.NonBootStrings.l_DurationUnitMinute_Text:_nbs.NonBootStrings.l_DurationUnitMinutes_Text;break;case 1:i=r===1?_nbs.NonBootStrings.l_DurationUnitHour_Text:_nbs.NonBootStrings.l_DurationUnitHours_Text;break;case 2:i=r===1?_nbs.NonBootStrings.l_DurationUnitDay_Text:_nbs.NonBootStrings.l_DurationUnitDays_Text;break;case 3:i=r===1?_nbs.NonBootStrings.l_DurationUnitWeek_Text:_nbs.NonBootStrings.l_DurationUnitWeeks_Text;break}}return i},$5Jw:function(n,t){throw Error.notImplemented();}};_d.$kE=function(){};_d.$kE.prototype={$2x:function(n,t){var i=n;switch(i){case"Free":return _nbs.NonBootStrings.l_FreeBusyFree_Text;case"Busy":return _nbs.NonBootStrings.l_FreeBusyBusy_Text;case"Tentative":return _nbs.NonBootStrings.l_FreeBusyTentative_Text;case"WorkingElsewhere":return _nbs.NonBootStrings.l_FreeBusyWorkingElsewhere_Text;case"OOF":return _nbs.NonBootStrings.l_FreeBusyOof_Text;case"NoData":return _nbs.NonBootStrings.l_NoDataAvailable_Text;default:return""}},$5Jw:function(n,t){throw Error.notImplemented();}};_d.$1DH=function(){};_d.$1DH.prototype={$2x:function(n,t){switch(n){case"None":return _nbs.NonBootStrings.l_None_Text;case"First":return _nbs.NonBootStrings.l_First_Text;case"Second":return _nbs.NonBootStrings.l_Second_Text;case"Third":return _nbs.NonBootStrings.l_Third_Text;case"Fourth":return _nbs.NonBootStrings.l_Fourth_Text;case"Last":return _nbs.NonBootStrings.l_Last_Text;default:return""}},$5Jw:function(n,t){throw Error.notImplemented();}};_d.$10m=function(){};_d.$10m.prototype={$2x:function(n,t){if(String.isInstanceOfType(n))return n;var i=n;var r="";$5(i)||(r=i.$2Dn());return r},$5Jw:function(n,t){throw Error.notImplemented();}};_d.$10v=function(){};_d.$10v.prototype={$2x:function(n,t){var r=n;var i=null;switch(r){case-15:i=_nbs.NonBootStrings.l_ReminderSnoozeOption_FifteenMinutesBeforeStart_Text;break;case-10:i=_nbs.NonBootStrings.l_ReminderSnoozeOption_TenMinutesBeforeStart_Text;break;case-5:i=_nbs.NonBootStrings.l_ReminderSnoozeOption_FiveMinutesBeforeStart_Text;break;case 0:i=_nbs.NonBootStrings.l_ReminderSnoozeOption_ZeroMinutesBeforeStart_Text;break;case 5:i=_nbs.NonBootStrings.l_ReminderSnoozeOption_FiveMinutes_Text;break;case 10:i=_nbs.NonBootStrings.l_ReminderSnoozeOption_TenMinutes_Text;break;case 15:i=_nbs.NonBootStrings.l_ReminderSnoozeOption_FifteenMinutes_Text;break;case 30:i=_nbs.NonBootStrings.l_ReminderSnoozeOption_ThirtyMinutes_Text;break;case 60:i=_nbs.NonBootStrings.l_ReminderSnoozeOption_OneHour_Text;break;case 120:i=_nbs.NonBootStrings.l_ReminderSnoozeOption_TwoHours_Text;break;case 240:i=_nbs.NonBootStrings.l_ReminderSnoozeOption_FourHours_Text;break;case 480:i=_nbs.NonBootStrings.l_ReminderSnoozeOption_EightHours_Text;break;case 720:i=_nbs.NonBootStrings.l_ReminderSnoozeOption_HalfDay_Text;break;case 1440:i=_nbs.NonBootStrings.l_ReminderSnoozeOption_OneDay_Text;break;case 2880:i=_nbs.NonBootStrings.l_ReminderSnoozeOption_TwoDays_Text;break;case 4320:i=_nbs.NonBootStrings.l_ReminderSnoozeOption_ThreeDays_Text;break;case 5760:i=_nbs.NonBootStrings.l_ReminderSnoozeOption_FourDays_Text;break;case 10080:i=_nbs.NonBootStrings.l_ReminderSnoozeOption_OneWeek_Text;break;case 20160:i=_nbs.NonBootStrings.l_ReminderSnoozeOption_TwoWeeks_Text;break;default:i="";break}return i},$5Jw:function(n,t){throw Error.notImplemented();}};_d.$1Dc=function(){};_d.$1Dc.prototype={$2x:function(n,t){var i=n;switch(i){case"Accept":return _nbs.NonBootStrings.l_Accepted_Text;case"Tentative":return _nbs.NonBootStrings.l_Tentative_Text;case"Decline":return _nbs.NonBootStrings.l_Declined_Text;case"Unknown":case"NoResponseReceived":return _nbs.NonBootStrings.l_NoResponseReceived_Text;case"Organizer":default:return""}},$5Jw:function(n,t){throw Error.notImplemented();}};_d.$1EA=function(){};_d.$1EA.prototype={$2x:function(n,t){var r=n;var i=null;switch(r){case"Normal":i=_nbs.NonBootStrings.l_Normal_Text;break;case"Personal":i=_nbs.NonBootStrings.l_Personal_Text;break;case"Private":i=_nbs.NonBootStrings.l_Private_Text;break;case"Confidential":i=_nbs.NonBootStrings.l_Confidential_Text;break;default:i=_nbs.NonBootStrings.l_Normal_Text;break}return i},$5Jw:function(n,t){throw Error.notImplemented();}};_d.$nO=function(){};_d.$nO.prototype={$2x:function(n,t){if($5(n))return"";else switch(n){case"NotStarted":return _u.Strings.l_TaskStatusNotStarted_Text;case"InProgress":return _u.Strings.l_TaskStatusInProgress_Text;case"Completed":return _u.Strings.l_TaskStatusCompleted_Text;case"Deferred":return _u.Strings.l_TaskStatusDeferred_Text;case"WaitingOnOthers":return _u.Strings.l_TaskStatusWaitingOnOthers_Text;default:return""}},$5Jw:function(n,t){throw Error.notImplemented();}};_d.$1HP=function(){};_d.$1HP.prototype={$2x:function(n,t){var i=n;return i?i.toLocaleString():""},$5Jw:function(n,t){throw Error.notImplemented();}};_d.$DH=function(n){_d.$DH.initializeBase(this);this.$B=n};function $76p(n){}function $76q(n){if(n.$B.get_$L()==="TouchNarrow"){var t=_y.$22.$Aj(n);t.$i1(new _C(n.$$d_$1HR,_a.$0.$Fb));n.set_$6k(t)}}_d.$DH.prototype={$B:null,$Jm:null,$100:null,$2K:null,$44U:!1,$3HS:null,$3r9:null,$38B:null,$7pu:null,$54:null,get_$9T:function(){return this.$2K},set_$9T:function(n){if(n===this.$2K)return n;this.$2K=n;$3(this,_d.$DH.$5Mg);return n},get_$3Nf:function(){return this.$54},set_$3Nf:function(n){this.$54=n;return n},get_$48c:function(){return this.$38B},set_$48c:function(n){if(n===this.$38B)return n;this.$38B=n;$3(this,_d.$DH.$5nB);return n},get_$6Ev:function(){return this.$3HS},set_$6Ev:function(n){if(n===this.$3HS)return n;this.$3HS=n;$3(this,_d.$DH.$6Ew);return n},get_$KN:function(){return this.$B.get_$L()==="TouchNarrow"?_y.$1Mq.prototype.get_$KN.call(this):0},$FZ:function(){_js.Trace.logInfo(_a.$0.$Fb,"UIRPVM ->PostTransitionIn");_y.$1Mq.prototype.$FZ.call(this);$76p(this)},$TZ:function(){_y.$1Mq.prototype.$TZ.call(this);this.$54&&this.$54.set_$2SF(!1)},$pN:function(n,t){this.$Jm=n;this.$100=t},$6cZ:function(n,t){if($5(n))throw Error.argumentNull("item");if(n!==this.$2K){this.set_$9T(n);this.$44U=t;var i=this.$2K.$1DN();this.$3r9=_h.$i.$Jo(i);$5(this.$3r9)?this.set_$6Ev(_u.Strings.l_Move_UpperCase_Text):this.set_$6Ev(String.format(_nbs.NonBootStrings.l_MoveToFolder_UpperCase_Text,this.$3r9.get_$1o()));this.$2K.get_$7x()?this.$2K.get_$7x()===3&&this.$44U?this.set_$48c(_nbs.NonBootStrings.l_ContactMustBeViewedFromPeopleModule_Text):this.set_$48c(_nbs.NonBootStrings.l_ItemMustBeMoved_Text):this.set_$48c(_nbs.NonBootStrings.l_ItemNotSupported_Text);$76q(this)}}};_d.$xz=function(){};_d.$xz.registerInterface("_d.$xz");_d.$16d=function(n,t){_d.$16d.initializeBase(this,[1,"ForgottenAttachment.AttachmentEvent"]);this.set_$5SF(n);this.set_$9ra(t)};_d.$16d.prototype={get_$5SF:function(){return this.$W("Event")},set_$5SF:function(n){$1I(this,"Event",n);return n},get_$9ra:function(){return this.$W("RuleNum")},set_$9ra:function(n){$1I(this,"RuleNum",n);return n}};_d.$FW=function(){};_d.$FW.$$cctor=function(){_d.$FW.$3Uo={};_d.$FW.$3Uo.en=!0};_d.$FW.$7zh=function(n){return typeof window.NLG!="undefined"&&typeof window.Microsoft_NaturalLanguage_AttachmentRes!="undefined"&&!!window.Microsoft_NaturalLanguage_AttachmentRes[n]};_d.$FW.$39L=function(n){var t=document.createElement("script");t.type="text/javascript";t.src=String.format("{0}/{1}",_y.$x.$w.get_$3QB(),n).toLowerCase();document.getElementsByTagName("head")[0].appendChild(t)};_d.$FW.$5YA=function(n){return n.substr(0,2)};_d.$FW.prototype={$Le:function(n){if($5(n))return!1;var t=_d.$FW.$5YA(n);if(!(t in _d.$FW.$3Uo))return!1;typeof window.NLG=="undefined"&&_d.$FW.$39L("microsoft.naturallanguage.clientruntime.js");typeof window.Microsoft_NaturalLanguage_AttachmentRes!="undefined"&&window.Microsoft_NaturalLanguage_AttachmentRes[t]||_d.$FW.$39L("microsoft.naturallanguage.attachmentres."+t+".js");return!0},$40R:function(n,t,i,r,u){u.val=null;if($5(r)||r.length<2)return!1;$5(t)&&(t="");$5(n)&&(n="");var f=_d.$FW.$5YA(r);if(!_d.$FW.$7zh(f))return!1;var o=_a.$6.$1X(_a.$0.$IY,"ForgottenAttachment.Start",!0);var s=this.$844();var h=i?NLG.PlainTextConverter.getPlainText(t):t;var e=new NLG.EmailData;e.body=NLG.PlainTextConverter.getLastMessage(h,f);e.subject=n;u.val=s.hasAttachments(e,f);_a.$6.$19(o);return u.val.hasAttachment},$3Nq:function(n,t){OwaApplication.$77.$D(new _d.$16d(n,t.ruleNumber))},$844:function(){return new NLG.FAD.ForgottenAttachmentDetector}};_d.$Tx=function(n,t,i,r,u){this.$$d_$8BE=Function.createDelegate(this,this.$8BE);this.$1v=t;this.$E4=i;this.$b=r;var f=_a.UserAgent.getInstance();this.$3Rx=n.get_$L()==="Mouse"&&!!r.get_$Pl()&&r.get_$Pl().get_$5Gw()&&!!r.get_$13()&&r.get_$13().get_$2sN()&&!(f.$9W&&f.$Cs.get_$36()<9);this.$rN=u;this.$3Rx&&u.$Le(r.get_$2z().get_$7l())};function $71v(n,t){var r=document.createElement("div");var i=$(r);i.html(t);i.find("#divRplyFwdMsg").nextAll().remove();var u=String.format('img[src*="{0}"]',_d.$Tx.$5DI);var f=i.find(u).first();return f.size()>0}_d.$Tx.prototype={$3Rx:!1,$rN:null,$5P7:!1,$2Tt:null,$5e7:!1,$1v:null,$E4:null,$b:null,$40R:function(n,t){if(!this.$3Rx||this.$5e7)return!1;var f=!1;if($5(t)){t=n.get_$8j();f=!0}if(!$5(n.get_$1xO())){n.get_$1xO().$s();var i=!1;if(t)if(f)i=t.get_$C()>0;else for(var r=0;r<t.get_$C();r++){var h=t.get_$3o(r);if(!h.get_$SG()){i=!0;break}}var e=n.get_$3s()==="HTML";if(i||e&&$71v(this,n.get_$DF()))this.$5P7&&this.$rN.$3Nq(2,this.$2Tt);else{var u;var o,s;if(s=this.$rN.$40R(n.get_$2i(),n.get_$DF(),e,this.$b.get_$2z().get_$7l(),o={val:u}),u=o.val,s){this.$2Tt=u;this.$5P7=!0;this.$1v.$2u(1,_nbs.NonBootStrings.l_MailComposeForgottenAttachmentMessage_Text,this.$$d_$8BE,!0,_nbs.NonBootStrings.l_MailComposeForgottenAttachmentSendAnyway_Text,_nbs.NonBootStrings.l_MailComposeForgottenAttachmentDontSend_Text,_nbs.NonBootStrings.l_MailComposeForgottenAttachmentTitle_Text);return!0}}}return!1},$8BE:function(n,t){if(t){this.$b.get_$13().set_$2sN(!1);_h.$2D.$CL(this.$b.get_$13().$DB,OwaApplication.$1W);this.$rN.$3Nq(3,this.$2Tt);this.$3Rx=!1}if(n){this.$5e7=!0;this.$rN.$3Nq(0,this.$2Tt);this.$E4.$s()}else this.$rN.$3Nq(1,this.$2Tt)}};_d.$kC=function(n,t,i){this.$B=n;this.$b=t;this.$5V7=i};_d.$kC.prototype={$B:null,$b:null,$5V7:null,$5L2:function(n,t){return new _d.$Tx(this.$B,n,t,this.$b,this.$5V7)}};_d.$KS=function(){this.$oz=new(_0365f.$n.$$(_g.$cG));this.$1U=new(_0365f.$n.$$(_g.$1q));this.$J0=new _js.$c};function $4sj(n,t){switch(t){case 1:return 0;case 4:return 1;case 2:return 1;case 3:return 1;case 5:return 2;default:return 3}}function $4sk(n,t){for(var i=n.$oz.get_$C()-1;i>=0;i--)$75H(n,n.$oz.get_$3o(i),t)||n.$oz.$6C(i)}function $75H(n,t,i){if(t&&t.Recipients&&t.Recipients.length>0){for(var f=t.Recipients,r=new(_0365f.$n.$$(_g.$1q)),u=0;u<f.length;u++){var e=f[u];_g.$2R.$5JQ(i,e)&&r.$D(e)}if(!r.get_$C())return!1;t.Recipients=r.$6W()}return!0}_d.$KS.prototype={$5S:null,$11V:0,$wr:0,$J0:null,$1U:null,$oz:null,$2xv:0,$1t:function(){this.$oz.$1t();this.$1U.$1t();this.$J0.$1t();this.$11V=0;this.$wr=0},$7Yb:function(n){this.$oz.$1t();this.$oz.$6S(n)},$ADI:function(n){this.$1U.$1t();this.$1U.$6S(n);$4sk(this,n)},$32Z:function(){for(var n=null,t=0;t<this.$oz.get_$C();t++)(!n||$4sj(this,n.Action)<$4sj(this,this.$oz.get_$3o(t).Action))&&(n=this.$oz.get_$3o(t));return n},$8IB:function(n){$4sk(this,n)}};_d.$3Y=function(n,t,i,r,u){this.$$d_$9YC=Function.createDelegate(this,this.$9YC);this.$$d_$9YD=Function.createDelegate(this,this.$9YD);this.$$d_$9YE=Function.createDelegate(this,this.$9YE);this.$$d_$7eh=Function.createDelegate(this,this.$7eh);this.$$d_$3lQ=Function.createDelegate(this,this.$3lQ);this.$$d_$7ef=Function.createDelegate(this,this.$7ef);this.$$d_$7eg=Function.createDelegate(this,this.$7eg);this.$$d_$9nx=Function.createDelegate(this,this.$9nx);this.$k=n;this.$Qh=t;this.$x=r;this.$5D7=i;this.$B=u;this.$34i=!0};function $75L(n,t,i,r){return r===8&&t.$J0.get_$C()>i.$J0.get_$C()?16:r}function $3ba(n){for(var i=n.$Qh.get_$ZI(),f=new(_0365f.$n.$$(_g.$1q)),t=0;t<i.get_$C();t++)for(var r=0;r<i.get_$3o(t).$1U.get_$C();r++){var u=i.get_$3o(t).$1U.get_$3o(r);u.$CB&&u.$Ne&&f.$D(u.$CB.get_$1l())}return f.$6W()}function $3bb(n,t){if(t&&t.Id){n.$1UJ=_a.$6.$1X(_a.$0.$In,"DlpPolicyTipsGeneric",!0);var i=new _g.$d5;i.ItemId=_g.$1t.$vT(t,!0);i.BodyOrSubjectChanged=n.$WF.$11V!==n.$L5.$11V||n.$WF.$wr!==n.$L5.$wr;i.NeedToReclassify=!n.$L5.$5S;i.CustomizedStringsNeeded=n.$34i;i.Recipients=$3ba(n);i.EventTrigger=n.$WF.$2xv;var r=new _c.$17B(i);_js.Trace.logInfo(_a.$0.$In,"Sending PolicyTip request to server for ItemId: "+t.Id+" CorrelationId: "+r.$AJc());$75V(n,r,n.$$d_$9YE,n.$$d_$9YD,n.$$d_$9YC)}}function $75P(n,t){return!t.$J0.get_$C()&&!t.$11V&&!t.$wr}function $75O(n,t){return t.$11V!==n.$L5.$11V||t.$wr!==n.$L5.$wr}function $75N(n,t){if(t.$J0.get_$C()!==n.$L5.$J0.get_$C())return!0;for(var i=0;i<n.$L5.$J0.get_$C();i++){var r=t.$J0.get_$3o(i);var u=n.$L5.$J0.get_$3o(i);if(r.get_$3l()&&u.get_$3l()&&r.get_$3l().Id!==u.get_$3l().Id)return!0}return!1}function $75Q(n){var t=$3ba(n);return n.$L5.$1U?!$3bZ(n,n.$L5.$1U.get_$3O(),t)||!$3bZ(n,t,n.$L5.$1U.get_$3O()):!!t&&!!t.length}function $3bZ(n,t,i){if(!i||!i.length)return!0;if(!t||!i.length)return!1;for(var u=i,f=u.length,r=0;r<f;++r){var e=u[r];if(!_g.$2R.$5JQ(t,e))return!1}return!0}function $75V(n,t,i,r,u){i&&t.add_$29(i);t.add_$21(r);u&&t.add_$2t(u);n.$4Wg=!0;n.$k.$11(t)}function $3bY(n){_js.Trace.logInfo(_a.$0.$In,"Clearing Existing PolicyTips");n.$x.$Db(_d.$3Y.$TX);n.$1I0.$1t();n.$1UH.$1t();n.$1UI.$1t();n.$ky.set_$36Y(!1);n.$ky.set_$2St(!1);$2lH(n);$2lF(n);n.$3lQ()}function $75I(n){n.get_$6MD()&&n.get_$6MD()(n.$x)}function $75X(n,t,i){if(t&&i){var r=t.Recipients;var u=i.Recipients;$3bZ(n,r,u)||n.$ky.set_$36Y(!1);t.Action!==i.Action&&n.$ky.set_$36Y(!1)}}function $75W(n,t){if(t){t.ComplianceURL&&n.$ky.$9vA(t.ComplianceURL);t.PolicyTipMessageBlockString&&n.$ky.set_$7d5(t.PolicyTipMessageBlockString);t.PolicyTipMessageNotifyString&&n.$ky.set_$9K5(t.PolicyTipMessageNotifyString);t.PolicyTipMessageOverrideString&&n.$ky.set_$9f5(t.PolicyTipMessageOverrideString)}}function $2lE(n){var t=new _a.$6I;if(n.$1UH.get_$C()>0){for(var i="",u=0;u<n.$1UH.get_$C();u++){var e=n.$1UH.get_$3o(u);i+=e.ContentType}t.$6w("A",i.length>=20?i.substring(0,20):i)}if(n.$1UI.get_$C()>0){for(var r="",f=0;f<n.$1UI.get_$C();f++)r+=n.$1UI.get_$3o(f);t.$6w("C",r.length>=20?r.substring(0,20):r)}t.$5I("T",n.$2zZ());t.$6w("MS",n.$5sY?"T":"F");return t.toString()}function $2lG(n){var t=n.$L5.$32Z();if(t){_js.Trace.logInfo(_a.$0.$In,"PolicyTipResponse: Action:{0}, Recipients:{1}",t.Action,t.Recipients);n.$ky.set_$7XS(t.Action);$75T(n,t);$75R(n,t);$75S(n,t);$2lH(n);$2lF(n);n.$x.$5Z(91);n.$x.$12B(91,n.$ky);n.$3lQ()}else $3bY(n)}function $75U(n,t){for(var i=0;i<n.$Qh.get_$ZI().get_$C();i++){var r=n.$Qh.get_$ZI().get_$3o(i);if(_rw.$36.isInstanceOfType(r)){r.get_$6A().set_$3Rv(!1);r.$2dW(t)}}}function $75T(n,t){n.$1I0.$1t();if(t.Recipients)for(var u=t.Recipients,f=u.length,i=0;i<f;++i){var e=u[i];var r=$75M(n,e);r&&($4sl(n,n.$1I0,r)||n.$1I0.$D(new _d.$Oa(r)))}}function $4sl(n,t,i){if(i&&i.$CB&&i.$CB.get_$1l()){var u=this;var r=t.$Dn(function(n){var t=n.$2d2;return t&&t.$CB&&t.$CB.get_$1l()?t.$CB.get_$1l().EmailAddress===i.$CB.get_$1l().EmailAddress:!1});return r<t.get_$C()}return!1}function $75J(n,t,i){if(i&&i.$1B&&i.$1B.get_$B4()&&i.$1B.get_$B4().AttachmentId){var u=this;var r=t.$Dn(function(n){return n.AttachmentId.Id===i.$1B.get_$B4().AttachmentId.Id});return r<t.get_$C()}return!1}function $75R(n,t){n.$1UH.$1t();if(t.AttachmentIds)for(var r=t.AttachmentIds,f=r.length,i=0;i<f;++i){var e=r[i];var u=$75K(n,n.$L5.$J0,e);u&&n.$1UH.$D(u)}}function $75K(n,t,i){for(var r=0;r<t.get_$C();r++){var u=t.get_$3o(r);if(i.Id===u.get_$B4().AttachmentId.Id)return u.get_$B4()}return null}function $75S(n,t){n.$1UI.$1t();if(t.Classifications)for(var r=t.Classifications,u=r.length,i=0;i<u;++i){var f=r[i];n.$1UI.$D(f)}}function $2lH(n){for(var f=n.$ky.$f0===1,t=0;t<n.$Qh.get_$ZI().get_$C();t++){var i=n.$Qh.get_$ZI().get_$3o(t);if(i.$1U)for(var r=0;r<i.$1U.get_$C();r++){var u=i.$1U.get_$3o(r);u.set_$8On(!f&&$4sl(n,n.$1I0,u))}}}function $2lF(n){var t=n.$5D7.get_$60();if(t&&t.get_$1P())for(var i=0;i<t.get_$1P().get_$C();i++){var r=t.get_$1P().get_$3o(i);r.set_$8Om($75J(n,n.$1UH,r))}}function $75M(n,t){if(t)for(var r=0;r<n.$Qh.get_$ZI().get_$C();r++){var u=n.$Qh.get_$ZI().get_$3o(r);if(u.$1U)for(var f=0;f<u.$1U.get_$C();f++){var i=u.$1U.get_$3o(f);if(i.$CB&&i.$CB.get_$1l()&&t.EmailAddress===i.$CB.get_$1l().EmailAddress)return i}}return null}_d.$3Y.prototype={$k:null,$x:null,$Qh:null,$5D7:null,$B:null,$WF:null,$L5:null,$ot:null,$4SH:!1,$4Wg:!1,$404:!1,$3Kn:0,$1I0:null,$1UI:null,$1UH:null,$6MC:null,$6MB:null,$6MG:null,$6ME:null,$3Jz:null,$ky:null,$1UJ:null,$5sY:!1,$34i:!1,get_$4Pv:function(){return this.$6MB},set_$4Pv:function(n){this.$6MB=n;return n},get_$6MD:function(){return this.$6MC},set_$6MD:function(n){this.$6MC=n;return n},get_$3Jy:function(){return this.$6MG},set_$3Jy:function(n){this.$6MG=n;return n},get_$3Jx:function(){return this.$6ME},set_$3Jx:function(n){this.$6ME=n;return n},get_$6MJ:function(){return this.$3Jz},set_$6MJ:function(n){this.$3Jz=n;return n},$41:function(){this.$WF=new _d.$KS;this.$L5=new _d.$KS;this.$ot=new _d.$KS;this.$1I0=new _js.$c;this.$1UH=new _js.$c;this.$1UI=new _js.$c;this.$ky=new _d.$HD("PolicyTipsComplexContent",1,this.$1I0,this.$1UI,this.$$d_$9nx,this.$$d_$7eg,this.$$d_$7ef,this.$$d_$3lQ,this.$$d_$7eh,this.$B);this.$3Kn=0},$2zZ:function(){if(_a.$61.$2v&&this.$L5){var n=this.$L5.$32Z();if(n)return n.Action}return 0},$2ha:function(n,t,i,r,u){if(_a.$61.$2v&&!this.$404){_js.Trace.logInfo(_a.$0.$In,"Prepares to submit PolicyTips action...");if(this.$4Wg){_js.Trace.logInfo(_a.$0.$In,"PolicyTips action is pending. Wating for the request to be completed before sending the new one.");this.$4SH=!0;this.$ot.$5S=n;this.$ot.$J0.$1t();if(t&&t.get_$C()>0)for(var e=0;e<t.get_$C();e++)_at.$1I.isInstanceOfType(t.get_$3o(e))?this.$ot.$J0.$D(t.get_$3o(e).$1B):_g.Attachment.isInstanceOfType(t.get_$3o(e))&&this.$ot.$J0.$D(t.get_$3o(e));this.$ot.$11V=i;this.$ot.$wr=r;this.$ot.$2xv=u}else{this.$4SH=!1;this.$WF.$5S=n;this.$WF.$J0.$1t();this.$WF.$11V=i;this.$WF.$wr=r;if(t&&t.get_$C()>0)for(var f=0;f<t.get_$C();f++)_at.$1I.isInstanceOfType(t.get_$3o(f))?this.$WF.$J0.$D(t.get_$3o(f).$1B):_g.Attachment.isInstanceOfType(t.get_$3o(f))&&this.$WF.$J0.$D(t.get_$3o(f));this.$WF.$2xv=$75L(this,this.$L5,this.$WF,u);if(this.$ky.$gG)return;if($75P(this,this.$WF)){this.$L5.$1t();$3bY(this);return}var o=$75Q(this);var s=$75O(this,this.$WF);var h=$75N(this,this.$WF);var c=s||h;o&&c?$3bb(this,n):s&&!this.$ky.$1EZ||h?$3bb(this,n):o&&this.$3Kn!==2&&$3bb(this,n)}}},$3lQ:function(){this.get_$4Pv()&&this.get_$4Pv()()},$7eg:function(n){if(this.get_$3Jy()){this.get_$3Jy()(n);$2lF(this);$2lH(this);$2lG(this)}},$7ef:function(n){if(this.get_$3Jx()){this.get_$3Jx()(n);$2lF(this);$2lH(this);$2lG(this)}},$7eh:function(){this.$3Jz&&this.$3Jz()},$9YE:function(n){var t=n;_js.Trace.logInfo(_a.$0.$In,"PolicyTips succeeded: {0}",t.$28u.EvaluationResult+" CorrelationId: "+t.$AJc());var i=this.$L5.$32Z();this.$L5.$5S=this.$WF.$5S;this.$L5.$J0.$1t();this.$L5.$J0.$6S(this.$WF.$J0.$6W());this.$L5.$11V=this.$WF.$11V;this.$L5.$wr=this.$WF.$wr;this.$L5.$7Yb(t.$oz);this.$L5.$ADI(t.$4TW.Recipients);var r=this.$L5.$32Z();$75X(this,i,r);this.$3Kn=t.$28u.OptimizationResult;this.$3Kn===1&&(this.$404=!0);if(this.$34i){this.$34i=!1;$75W(this,t.$28u.CustomizedStrings)}$2lG(this);this.$1UJ&&_a.$6.$19(this.$1UJ,"DlpPolicyTipsGeneric","",null,$2lE(this))},$9YD:function(n){var i=n;var t=i.$28u;if(t){_js.Trace.logWarning(_a.$0.$In,"PolicyTips failed with EvaluationResult code of: {0}",t.EvaluationResult+" CorrelationId: "+i.$AJc()+" Diagnostic: "+t.DiagnosticData);this.$1UJ&&t.DiagnosticData?_a.$6.$19(this.$1UJ,"DlpPolicyTipsGeneric",_g.$Nh.toString(t.EvaluationResult)+":"+t.DiagnosticData,i.$AJc(),$2lE(this)):t&&!t.DiagnosticData&&_a.$6.$19(this.$1UJ,"DlpPolicyTipsGeneric",i.$1d.message?_g.$Nh.toString(t.EvaluationResult)+":"+i.$1d.message:_g.$Nh.toString(t.EvaluationResult),i.$AJc(),$2lE(this))}else{_js.Trace.logWarning(_a.$0.$In,"PolicyTipsResponse is null (PolicyTipsRequest is timed out) CorrelationId: "+i.$AJc());this.$1UJ&&_a.$6.$19(this.$1UJ,"DlpPolicyTipsGeneric","PolicyTipsRequest timed out",i.$AJc(),$2lE(this));this.$404=!0}$3bY(this)},$9YC:function(n){_js.Trace.logInfo(_a.$0.$In,"PolicyTips completed: {0}",n);this.$4Wg=!1;$75I(this);if(this.$4SH){_js.Trace.logInfo(_a.$0.$In,"Submiting pending PolicyTips request...");this.$2ha(this.$ot.$5S,this.$ot.$J0,this.$ot.$11V,this.$ot.$wr,this.$ot.$2xv)}},$9nx:function(){for(var t=this.$1I0.get_$C()-1;t>=0;t--){var i=this.$1I0.get_$3o(t);var n=i.$2d2.$CB;n&&n.get_$1l()&&n.get_$1l().EmailAddress&&$75U(this,n.get_$1l().EmailAddress)}var r=$3ba(this);this.$L5.$8IB(r);$2lG(this)}};_d.$46=function(n,t,i,r){this.$$d_$3lP=Function.createDelegate(this,this.$3lP);this.$$d_$2dW=Function.createDelegate(this,this.$2dW);this.$$d_$9VF=Function.createDelegate(this,this.$9VF);this.$$d_$9VG=Function.createDelegate(this,this.$9VG);this.$$d_$85E=Function.createDelegate(this,this.$85E);this.$k=n;this.$Qh=t;this.$x=i;this.$1H=r};_d.$46.$9VE=function(n){var t=n.$1gE;var i=t?t.length:-1;_js.Trace.logInfo(_a.$0.$sc,String.format("GetMailTipsAction completed. Number of MailTips Retrieved From Server: {0}",i))};function $4s9(n){var i=[];if(n.$Qh.get_$ZI()&&n.$Qh.get_$ZI().get_$C()>0)for(var t=0;t<n.$Qh.get_$ZI().get_$C();t++)n.$Qh.get_$ZI().get_$3o(t)&&$73c(n,i,n.$Qh.get_$ZI().get_$3o(t).$1U);return i}function $73e(n){var t=null;if(_d.$41.isInstanceOfType(n.$Qh)){var r=n.$Qh;if(r){var i=r.$Xx;i&&i.get_$1u()&&(t=i.get_$1u().get_$1l())}}if(!t){t=new _g.$1q;t.EmailAddress=_g.$V.get_$I().get_$2z().get_$AM();t.Name=_g.$V.get_$I().get_$2z().get_$Fn()}return t}function $4sB(n,t){if(!t.length){$3bK(n);$2l8(n);return}for(var r=$4s8(n,n.$146,t),i=0;i<r.length;i++)n.$2dW(r[i].EmailAddress)}function $73i(n,t,i,r,u){i&&t.add_$29(i);t.add_$21(r);u&&t.add_$2t(u);n.$k.$11(t)}function $73j(n,t){for(var u=[],r=0;r<t.length;r++){var i=t[r].EmailAddress;if(!Array.contains(u,i)){Array.add(u,i);var f=$4sA(n,i);if(!f)continue;f.$1eY&&n.$5qc(i)}}}function $3bK(n){_js.Trace.logInfo(_a.$0.$sc,"Clearing Existing MailTips...");n.$x.$Db(_d.$46.$TX);n.$1gB.$1t();n.$1ia.$1t();n.$1k1.$1t();n.$1lq.$1t();n.$1cA.$1t();n.$2Tp.$1t();n.$1at.$1t();Array.clear(n.$146);n.$19m=0;n.$1yy=0;n.$1wD=0;n.$3lP()}function $3bL(n){if(n.$1FM){for(var c=!n.$1ia.get_$C(),l=!n.$1gB.get_$C(),a=!n.$1lq.get_$C(),v=!n.$1at.get_$C(),y=!n.$1k1.get_$C(),p=!n.$1cA.get_$C(),w=n.$19m<_g.$V.get_$I().get_$39r(),f=0;f<n.$1FM.length;f++){for(var r=!1,t=n.$1FM[f],s=!1,e=0;e<n.$146.length;e++){var b=n.$146[e];if(b.EmailAddress===t.recipientAddress){s=!0;break}}if(!s){var h=$4sA(n,t.recipientAddress);if(h){var i=new _d.$Oa(h);var o=new _g.$1q;o.EmailAddress=i.get_$Vg();o.Name=i.get_$1o();Array.add(n.$146,o);if(t.isModerated){n.$1ia.$D(i);r=!0}if(t.mailboxFull){n.$1gB.$D(i);r=!0}if(t.totalMemberCount>0){n.$19m+=t.totalMemberCount;if(t.totalMemberCount>1){i.$10b=t.totalMemberCount;n.$2Tp.$D(i);r=!0}else n.$1yy+=t.totalMemberCount}if(t.externalMemberCount>0){n.$1wD+=t.externalMemberCount;i.$2yD=t.externalMemberCount;n.$1cA.$D(i);r=!0}if(t.deliveryRestricted){n.$1lq.$D(i);r=!0}if(!_js.$8.$a(t.customMailTip)){i.$5NJ=_y.$3X.$5Ju(t.customMailTip);n.$1at.$D(i);r=!0}if(!_js.$8.$a(t.outOfOffice)){i.$3jU=_y.$3X.$5Ju(t.outOfOffice);n.$1k1.$D(i);r=!0}r&&n.$5qc(t.recipientAddress)}}}var u=new _y.$yF;if(n.$1ia.get_$C()>0&&c){var k=new _d.$1BJ("MailtipsComplexContent",n.$1ia,n.$$d_$2dW,n.$$d_$3lP,u.$2x(300,null),n.$1H);n.$x.$5Z(300);n.$x.$12B(300,k)}if(n.$1gB.get_$C()>0&&l){var d=new _d.$1DD("MailtipsComplexContent",n.$1gB,n.$$d_$2dW,n.$$d_$3lP,u.$2x(100,null),n.$1H);n.$x.$5Z(100);n.$x.$12B(100,d)}if(n.$1lq.get_$C()>0&&a){var g=new _d.$1Dd("MailtipsComplexContent",n.$1lq,n.$$d_$2dW,n.$$d_$3lP,u.$2x(200,null),n.$1H);n.$x.$5Z(200);n.$x.$12B(200,g)}if(n.$1k1.get_$C()>0&&y){var nt=new _d.$13S("MailtipsComplexContent",n.$1k1,n.$$d_$2dW,n.$$d_$3lP,u.$2x(4100,null),n.$1H);n.$x.$5Z(4100);n.$x.$12B(4100,nt)}if(n.$1at.get_$C()>0&&v){var tt=new _d.$15B("MailtipsComplexContent",n.$1at,n.$$d_$2dW,n.$$d_$3lP,u.$2x(4e3,null),n.$1H);n.$x.$5Z(4e3);n.$x.$12B(4e3,tt)}if(n.$1cA.get_$C()>0)if(p||!n.$1c9){n.$x.$5Z(4300);n.$1c9=new _d.$16I("MailtipsComplexContent",n.$1cA,n.$$d_$2dW,n.$$d_$3lP,u.$2x(4300,null),n.$1H);n.$1c9.set_$3v3(n.$1wD);n.$x.$12B(4300,n.$1c9)}else n.$1c9.set_$3v3(n.$1wD);if(n.$19m>=_g.$V.get_$I().get_$39r())if(w||!n.$15u){n.$x.$5Z(3900);n.$15u=new _d.$1AO("MailtipsComplexContent",n.$2Tp,n.$$d_$2dW,n.$$d_$3lP,u.$2x(3900,null),n.$1H);n.$15u.set_$42I(n.$1yy);n.$15u.set_$4gl(n.$19m);n.$x.$12B(3900,n.$15u)}else{n.$15u.set_$42I(n.$1yy);n.$15u.set_$4gl(n.$19m)}}n.$3lP()}function $2l8(n){n.get_$6LG()&&n.get_$6LG()(n.$x)}function $73f(n,t){for(var s=Sys.Net.XMLDOM(t),r=new _h.$1B1,u=0;u<s.firstChild.childNodes.length;u++){var i=s.firstChild.childNodes[u];if(i.nodeType===1){var c=_a.$3Q.$W7(i);switch(c){case"RecipientAddress":r.recipientAddress=_a.$3Q.$Ke(i.childNodes[1]);break;case"OutOfOffice":if(i.childNodes)for(var f=0;f<i.childNodes.length;f++){var h=i.childNodes[f];var l=_a.$3Q.$W7(h);if(l==="ReplyBody"){var e=$4s7(n,_a.$3Q.$Ke(h));if(e&&!_js.$8.$a(e)){r.outOfOffice=e;break}}}break;case"MailboxFull":r.mailboxFull=Boolean.parse(_a.$3Q.$Ke(i));break;case"IsModerated":r.isModerated=Boolean.parse(_a.$3Q.$Ke(i));break;case"CustomMailTip":var o=$4s7(n,_a.$3Q.$Ke(i));o&&!_js.$8.$a(o)&&(r.customMailTip=o);break;case"TotalMemberCount":r.totalMemberCount=Number.parseInvariant(_a.$3Q.$Ke(i));break;case"ExternalMemberCount":r.externalMemberCount=Number.parseInvariant(_a.$3Q.$Ke(i));break;case"MaxMessageSize":r.maxMessageSize=Number.parseInvariant(_a.$3Q.$Ke(i));break;case"DeliveryRestricted":r.deliveryRestricted=Boolean.parse(_a.$3Q.$Ke(i));break}}}return r}function $4s7(n,t){var i;var r,u;return(u=_a.$1d.$7jQ(_a.UserAgent.getInstance(),t,r={val:i}),i=r.val,u)?i:""}function $4s6(n,t,i){for(var r=0;r<t.length;r++)if(t[r].EmailAddress===i)return!0;return!1}function $73c(n,t,i){if(i)for(var r=0;r<i.get_$C();r++)if(i.get_$3o(r).$CB.get_$1l()){var f=i.get_$3o(r).$CB.get_$1l().EmailAddress;if(!$4s6(n,t,f)){var u=new _g.$1q;u.EmailAddress=f;u.Name=i.get_$3o(r).$CB.get_$1o();Array.add(t,u)}}}function $4s8(n,t,i){if(!i||!i.length)return t;var r=[];if(!t)return r;for(var u=0;u<t.length;u++){var f=t[u];$4s6(n,i,f.EmailAddress)||Array.add(r,f)}return r}function $73d(n,t,i){var f=[];if(t)for(var e=_h.$Bw.get_$I(),r=0;r<t.length;r++){var u=t[r];e.$5JS(u.EmailAddress,i.EmailAddress)?Array.add(n.$1FM,e.$5YJ(u.EmailAddress,i.EmailAddress)):Array.add(f,u)}return f}function $4sA(n,t){for(var u=null,r=0;r<n.$Qh.get_$ZI().get_$C();r++){var f=n.$Qh.get_$ZI().get_$3o(r).$1U;if(f){var i=$73b(n,t,f);if(i){if(i.$1eY)return i;u=i}}}return u}function $73b(n,t,i){for(var r=0;r<i.get_$C();r++){var u=i.get_$3o(r);var f=u.$CB;if(!f){_js.Trace.logInfo(_a.$0.$sc,"skipping null recipients in the current recipient collection during find recipient");continue}var e=f.get_$1l();if(!e){_js.Trace.logInfo(_a.$0.$sc,"skipping recipient with null EmailAddress in the current recipient collection during find recipient");continue}if(e.EmailAddress===t)return u}return null}function $73h(n,t){for(var i=0;i<n.$Qh.get_$ZI().get_$C();i++){var r=n.$Qh.get_$ZI().get_$3o(i);if(_rw.$36.isInstanceOfType(r)){r.get_$6A().set_$3Rv(!1);r.$2dW(t)}}}function $73g(n,t){$1Xd(n,t,300,n.$1ia);$1Xd(n,t,100,n.$1gB);$1Xd(n,t,4100,n.$1k1);$1Xd(n,t,200,n.$1lq);$1Xd(n,t,4e3,n.$1at);$1Xd(n,t,3900,n.$2Tp);$1Xd(n,t,4300,n.$1cA)}function $1Xd(n,t,i,r){for(var e=!1,o=[],f=0;f<r.get_$C();f++){var u=r.get_$3o(f);if(u.get_$Vg()===t){e=!0;i===3900&&u.$10b>0&&(n.$19m-=u.$10b);i===4300&&u.$2yD>0&&(n.$1wD-=u.$2yD);r.get_$C()===1&&i!==3900&&n.$x.$5Z(i);Array.add(o,f)}}if(i===3900){if(!e){n.$19m--;n.$1yy--}if(n.$15u){n.$15u.set_$4gl(n.$19m);n.$15u.set_$42I(n.$1yy)}n.$19m<_g.$V.get_$I().get_$39r()&&n.$x.$5Z(3900)}i===4300&&e&&n.$1c9&&n.$1c9.set_$3v3(n.$1wD);for(var s=o.length-1;s>=0;s--)r.$6C(o[s])}_d.$46.prototype={$1H:null,$6LF:null,$6LE:null,$k:null,$Qh:null,$x:null,$1gB:null,$1ia:null,$1k1:null,$1at:null,$1lq:null,$1cA:null,$2Tp:null,$15u:null,$1c9:null,$1FM:null,$146:null,$2y1:null,$19m:0,$1yy:0,$1wD:0,$2V2:null,get_$6LG:function(){return this.$6LF},set_$6LG:function(n){this.$6LF=n;return n},get_$4PU:function(){return this.$6LE},set_$4PU:function(n){this.$6LE=n;return n},$41:function(){this.$1gB=new _js.$c;this.$1ia=new _js.$c;this.$1k1=new _js.$c;this.$1lq=new _js.$c;this.$1cA=new _js.$c;this.$2Tp=new _js.$c;this.$1at=new _js.$c;this.$1FM=[];this.$146=[];$3bK(this)},$2hZ:function(){_js.Trace.logInfo(_a.$0.$sc,"Prepares to submit mailtips action");var t=$4s9(this);this.$1FM&&Array.clear(this.$1FM);_h.$Bw.get_$I().$5Hd();var n=$73e(this);if(this.$2y1){if(n.EmailAddress!==this.$2y1.EmailAddress){this.$2y1=n;$3bK(this)}}else this.$2y1=n;if(_g.$1Y.$N2)for(var r=0;r<t.length;r++){var e=t[r].EmailAddress;_g.$1Y.$N2.$5YI(e,n.EmailAddress,this.$$d_$85E)}$4sB(this,t);var o=$4s8(this,t,this.$146);var u=$73d(this,o,n);if(!u.length){this.$1FM.length&&$3bL(this);$73j(this,t);$2l8(this);return}for(var f=new Array(u.length),i=0;i<f.length;i++)f[i]=u[i];var s=new _c.$17O(n,f,1);this.$2V2=_a.$6.$1X(_a.$0.$sc,"MailTips");$73i(this,s,this.$$d_$9VG,this.$$d_$9VF,_d.$46.$9VE)},$6W8:function(){$4sB(this,$4s9(this))},$5qc:function(n){if(this.$Qh)for(var t=0;t<this.$Qh.get_$ZI().get_$C();t++)for(var u=this.$Qh.get_$ZI().get_$3o(t),i=0;i<u.$1U.get_$C();i++){var r=u.$1U.get_$3o(i);if(r.$CB.get_$1l().EmailAddress===n){r.set_$5jm(!0);r.set_$5jm(!0)}}},$9VG:function(n){var t=n;if(t.$1gE)for(var i=0;i<t.$1gE.length;i++){_js.Trace.logInfo(_a.$0.$sc,String.format("Raw XML Mailtip Node: [{0}]",t.$1gE[i]));var r=$73f(this,t.$1gE[i]);_h.$Bw.get_$I().$5A7(r,t.$4Zi.EmailAddress);Array.add(this.$1FM,r)}$3bL(this);$2l8(this);_a.$6.$19(this.$2V2,null,"",t.$AJc());this.$2V2=null},$9VF:function(n){!n.$1d||_js.$8.$15(n.$1d.message)?_js.Trace.logWarning(_a.$0.$sc,"GetMailTips action failed without server error."):_js.Trace.logWarning(_a.$0.$sc,"GetMailTips action failed with server error {0}",n.$1d.message);$3bL(this);$2l8(this);var t=_d.$B6.$1xS(n.$1d);t=t||"MailTipsFailure_UnknownError";_a.$6.$19(this.$2V2,null,t,n.$AJc(),_d.$B6.$1co(n.$1d));this.$2V2=null},$3lP:function(){this.get_$4PU()&&this.get_$4PU()()},$2dW:function(n){for(var t=0;t<this.$146.length;t++)if(this.$146[t].EmailAddress===n){Array.removeAt(this.$146,t);break}$73h(this,n);$73g(this,n);this.$x.$7yE()},$85E:function(n,t){var i=JsonParser.deserialize(n);i&&_h.$Bw.get_$I().$5A7(i,t)}};_d.$1CV=function(){};_d.$1CV.prototype={};_d.$1CV.registerEnum("_d.$1CV",!1);_d.$R7=function(){};_d.$R7.prototype={$1C3:!1,$5Q9:null,$nh:!1,$5kh:!1,$5pk:!1,$Gt:null,$7Q:0,$2xC:null,get_$rF:function(){this.$2xC||(this.$2xC=new _d.$15u);return this.$2xC},set_$rF:function(n){this.$2xC=n;return n}};_d.$Cq=function(n,t,i,r,u,f,e,o,s){this.$$d_$2rg=Function.createDelegate(this,this.$2rg);this.$$d_$BS=Function.createDelegate(this,this.$BS);this.$$d_$1dN=Function.createDelegate(this,this.$1dN);this.$$d_$2wn=Function.createDelegate(this,this.$2wn);this.$$d_$3Pz=Function.createDelegate(this,this.$3Pz);this.$$d_$2t9=Function.createDelegate(this,this.$2t9);_d.$Cq.initializeBase(this,[n,t,i,r,u,f,e,o,s]);_a.$3.$pj(t,0,"mode");this.$B.add_$UA(this.$$d_$2t9);this.$2Rs=this.$7Q===1||this.$7Q===3?!0:!1};function $4qQ(n,t,i){n.$3JS(t,i)}function $4qP(n,t,i){var r=t;if(r){var u=!!r.$5w&&!!r.$5w.response&&r.$5w.response.responseKind===-2;n.$8Cc(u,r.get_$hJ(),r.$1d,i,Object.getType(r)===_pc.$jd)}}function $4qO(n){n.$8Hk();n.$3JS(null,null)}function $70U(n){if(n.$Hn){n.set_$1ED(!0);return!0}return!1}function $70T(n){n.$Cu=n.$hC.$7nP(n.$18,n.$7Q);n.$Cu.add_$9rn(n.$$d_$BS);n.$Cu.add_$7ew(n.$$d_$2rg);n.$Cu.add_$6Rx(n.$$d_$6Rw)}_d.$Cq.prototype={$Cu:null,$4Y2:null,$Vn:null,$r3:null,$1EC:!1,$Hn:!1,$Gt:null,$1C3:!1,$6qB:null,$3h1:null,$2Rs:!1,add_$2x8:function(n){this.$2G("EditCompleted",n)},remove_$2x8:function(n){this.$2H("EditCompleted",n)},get_$uh:function(){return this.$Cu.get_$uh()},get_$UC:function(){return this.$Cu.get_$UC()},get_$gB:function(){return this.$7Q===1},get_$KN:function(){return this.$B.get_$L()!=="Mouse"?1:0},get_$1ED:function(){return this.$1EC},set_$1ED:function(n){if(this.$1EC!==n){this.$1EC=n;$3(this,"IsDiscardChangesDialogShown")}return n},get_$3sK:function(){if(!this.$r3){this.$r3=new _js.$c;this.$r3.$D(new _a.$2E(new _C(this.$$d_$3Pz,_d.$Cq.$A),_nbs.NonBootStrings.l_ConfirmDialog_Save_Text,null));this.$r3.$D(new _a.$2E(new _C(this.$$d_$2wn,_d.$Cq.$A),_u.Strings.l_ConfirmDialog_Discard_Text,null));this.$r3.$D(new _a.$2E(new _C(this.$$d_$1dN,_d.$Cq.$A),_u.Strings.l_ConfirmDialog_Cancel_Text,null))}return this.$r3},get_$nX:function(){return this.$Cu.$15Y},get_$4Sl:function(){return this.$Cu.$73},get_$5ir:function(){return _d.$9N.prototype.get_$5ir.call(this)&&this.$7Q!==2},get_$4Y3:function(){this.$4Y2||(this.$4Y2=new _y.$2Q(_y.$d.get_$BS(),_y.$d.get_$1Iy(),_nbs.NonBootStrings.l_SaveMenuItem_LowerCase_Text,this.get_$uh()));return this.$4Y2},get_$3lT:function(){this.$Vn||(this.$Vn=new _y.$2Q(_y.$d.get_$9J(),_y.$d.get_$LH(),_nbs.NonBootStrings.l_CancelItem_LowerCase_Text,this.get_$UC()));return this.$Vn},get_$44q:function(){return this.$2Rs},set_$44q:function(n){this.$2Rs=n;$3(this,"IsEnteringEditMode");return n},$41:function(){$70T(this);this.get_$4Sl()&&this.get_$4Sl().set_$8E4(!0);_d.$9N.prototype.$41.call(this)},$158:function(n){if(this.get_$4Sl()){this.get_$4Sl().set_$2wd(n.$5Q9);this.get_$4Sl().$1fy=n.$5pk}this.$Cu.set_$20w(n.$5kh);var t=_a.$6.acss(_a.$0.$A7,"SetParentFolderId");if(this.$7Q===3||this.$7Q===2)if(n.$Gt){this.$Gt=n.$Gt;this.$1C3=n.$1C3}else{this.$Gt=_g.$2Z.$BJ("contacts").get_$o();this.$1C3=!0}_a.$6.aces(t)},$5et:function(n){_d.$9N.prototype.$5et.call(this,n);this.$Cu.set_$20w(n.get_$nX());this.$Gt=n.get_$28();this.$1C3=n.get_$3pD()},$8Cc:function(n,t,i,r,u){if(this.$Cu.$Cd){this.$Cu.set_$Aq(!1);if(i){var f=this.$87R(u);this.get_$D3().$2u(0,f,null)}else if(t){var e=_pc.$l.$1C2(t,r===1?3:2);this.$3JS(e,null)}else r===2?this.$3JS(null,null):n&&this.get_$D3().$2u(0,_nbs.NonBootStrings.l_OfflineErrorInfoMessage_Text,null)}},$5I8:function(){this.$2rg()},$9Xe:function(){this.$Hn=!1},$2rg:function(){$70U(this)||$4qO(this)},$3JS:function(n,t){$BF(this,"EditCompleted",n,t)},$8Hn:function(){},$5WP:function(n,t){n.val=[this.get_$4Y3(),this.get_$3lT()];t.val=null},$87R:function(n){return n?_nbs.NonBootStrings.l_SaveContactFailureMessage_Text:_nbs.NonBootStrings.l_UpdateContactFailureMessage_Text},$1Tb:function(n,t){if(this.$Cu.$Cd)return!0;if(this.$Hn){this.$2rg();return!0}else{this.$1R();return!1}},$49:function(){this.$B.remove_$UA(this.$$d_$2t9);_a.$1.prototype.$49.call(this)},$2t9:function(n){this.$Hn&&n.$1Lk(_nbs.NonBootStrings.l_PersonaCard_BrowserWindowUnloadWarning_Text)},$3Pz:function(){this.$Cu.set_$Aq(!0);this.$1dN();this.$BS()},$2wn:function(){this.$1dN();$4qO(this)},$1dN:function(){this.set_$1ED(!1)}};_d.$Kx=function(n,t,i,r,u,f,e,o,s,h,c,l){this.$$d_$ABk=Function.createDelegate(this,this.$ABk);this.$$d_$9Q7=Function.createDelegate(this,this.$9Q7);this.$$d_$6Nl=Function.createDelegate(this,this.$6Nl);this.$$d_$6Lm=Function.createDelegate(this,this.$6Lm);_d.$Kx.initializeBase(this,[n,t,i,r,u,o,s,h,c]);_a.$3.$9t(this.get_$1et(),"ComposeGroupCard is only supported for PDLs. Specified persona is not a PDL.");_a.$3.$9t(this.$B.get_$L()==="Mouse","ComposeGroupCard is only supported for Mouse Layout.");this.$1xx=f;this.$5au=e;this.$1H=l};function $70b(n){if(_js.$8.$15(n.$xx.$1xz.$Hb)){_a.$4Y.$2u(_nbs.NonBootStrings.l_GroupNamePrompt_Text,0);n.$Cu.set_$Aq(!1);return!0}return!1}function $70a(n){n.set_$89s(new _d.$U6(new _d.$p8(n),n.$1H));if(n.$1xx){var t=null;n.$7Q===1&&(t=n.$18.get_$1l().ItemId);n.set_$9hD(n.$1xx.$5LF(t,new _d.$p8(n),_nbs.NonBootStrings.l_GroupCardAddMembersWatermark_Text));n.$1kg.set_$6f0(n.get_$gB())}n.$1CA=new _js.$c}function $70Z(n){if(n.$1CA)for(var t=0;t<n.$1CA.get_$C();t++){var i=n.$1CA.get_$3o(t);if(i&&i.$Om){var f=i.$5B.$18;var e=_d.$DU.$5Kv(f);var r=new _g.$KR(new _g.$1V("PersonaMembers"));r.DeleteMemberFromPDL=e;var o=[r];var u;n.$1uw=(u=n.$1uw).concat.apply(u,o)}}}_d.$Kx.prototype={$1xx:null,$5au:null,$1H:null,$1CA:null,$is:null,$1uw:null,$1NS:null,$xx:null,$1kg:null,$CX:null,get_$2uX:function(){return this.$1NS},set_$2uX:function(n){if(this.$1NS!==n){this.$1NS=n;$3(this,"CurrentMembersCountLabel")}return n},get_$8K3:function(){return this.$is.$20T},get_$7uU:function(){return this.$is},set_$7uU:function(n){if(this.$is!==n){this.$is=n;$3(this,"EditableMembers")}return n},get_$89s:function(){return this.$xx},set_$89s:function(n){this.$xx=n;$3(this,"GroupCardProfileFieldsListViewModel");return n},get_$9hD:function(){return this.$1kg},set_$9hD:function(n){this.$1kg=n;$3(this,"PickerViewModel");return n},get_$1Zc:function(){return this.$CX},set_$1Zc:function(n){if(this.$CX!==n){this.$CX&&this.$CX.$q("IsNotesLoaded",this.$$d_$6Lm);this.$CX=n;this.$CX&&this.$CX.$Y("IsNotesLoaded",this.$$d_$6Lm);$3(this,"CardNotesViewModel")}return n},get_$1et:function(){return!!this.$18.get_$1l()&&this.$18.get_$1l().RoutingType==="MAPIPDL"},$158:function(n){_d.$Cq.prototype.$158.call(this,n);this.set_$1Zc(new _d.$PI(this.$18,this.$8U,this.$B,this.$k,n.$nh));this.$7Q===1&&this.$CX.$Le();$70a(this);$1Xe(this)},$6nB:function(n){if(n){n.$Om?this.$1CA.$D(n):this.$1CA.$34(n);this.$Hn=!0}},$BS:function(){_a.$6.stPT(_a.$0.$AC,"SaveGroup_"+this.$B.get_$L(),3);_a.$6.$1X(_a.$0.$AC,"SaveGroup");_a.$g.$2Dw("VM.GroupCard.Save");var n=[];var i=this.$xx.$1Ll();n=n.concat.apply(n,i);$70Z(this);this.$1uw&&this.$1uw.length>0&&(n=n.concat.apply(n,this.$1uw));var r=this.$1kg.$1Ll();n=n.concat.apply(n,r);if(n&&n.length>0){if($70b(this))return;var t;if(this.$7Q===1)t=new _pc.$12M(this.$18.get_$6P(),n,_h.$Ar.toString(2));else{if(!this.$Gt)throw Error.argumentNull("parentFolderId","Can't create group when parent folder is undefined");t=new _pc.$jd(this.$18.get_$6P(),n,new _g.$CI(this.$Gt),_h.$Ar.toString(2),this.$1C3)}t.add_$29(this.$$d_$6Nl);t.add_$21(this.$$d_$6Nl);this.$k.$11(t)}else{this.$Hn=!1;this.$Cu.set_$Aq(!1);this.get_$UC().$s()}},$8Hk:function(){this.$xx&&this.$xx.$iq();this.$Hn=!1},$9Xe:function(){_d.$Cq.prototype.$9Xe.call(this);this.set_$1Zc(new _d.$PI(this.$18,this.$8U,this.$B,this.$k));this.$CX.$Le();this.$xx&&this.$xx.$wl();this.$1kg&&this.$1kg.$9pV()},$87R:function(n){return n?_nbs.NonBootStrings.l_SaveGroupFailureMessage_Text:_nbs.NonBootStrings.l_UpdateGroupFailureMessage_Text},$8Hn:function(){this.$7Q===1&&this.$7un()},$7un:function(){this.$1CA?this.$1CA.$1t():this.$1CA=new _js.$c;this.$1uw=[];if(this.$is){if(this.$is.$24){this.$is.$24.$q("TableSize",this.$$d_$ABk);this.$is.$24.$1w.$1t()}}else{this.set_$7uU(this.$5au.$7mD(this.$B,this));this.$is.$Y(_d.$4f.$2SL,this.$$d_$9Q7)}var n=_c.$dq.$E(this.$18,_d.$VB.$3xv(this.$B));this.$is.set_$GP(new _c.$xX(n,null));this.set_$2uX(String.format(_nbs.NonBootStrings.l_GroupCardCurrentMembersCount_Text,0));this.$is.$24.$Y("TableSize",this.$$d_$ABk);this.$is.$5m()},$ABk:function(n,t){this.set_$2uX(String.format(_nbs.NonBootStrings.l_GroupCardCurrentMembersCount_Text,this.$is.$24.$SM))},$9Q7:function(n,t){$3(this,"IsEditableMembersListLoading")},$6Nl:function(n){$4qP(this,n,2)},$6Lm:function(n,t){this.$CX.$1QA&&this.$CX.$nh&&this.$xx.$Wh&&this.$xx.$Wh.$9ut(this.$18.get_$JO().get_$3o(0))}};_d.$HR=function(n,t,i,r,u,f,e,o,s){this.$$d_$6Nl=Function.createDelegate(this,this.$6Nl);this.$$d_$6Lm=Function.createDelegate(this,this.$6Lm);_d.$HR.initializeBase(this,[n,t,i,r,u,f,e,o,s])};function $70d(n){var t=new _d.$14V(n);n.set_$9gn(new _d.$1Q(t,0));n.set_$9go(new _d.$1Q(t,1));n.set_$9gm(new _d.$1Q(t,2))}function $70e(n){n.$e0.$wl();n.$185.$wl();n.$ow.$wl()}function $70f(n){var t=new _pc.$6C;t.set_$sK(!0);t.set_$1o("Outlook");t.set_$r(!1);n.$18.get_$3p()||n.$18.set_$3p(new _js.$c);if(n.$18.$5by()){n.$3M1=_h.$2G.$2KN();t.set_$1y(n.$18.get_$3p().get_$C().toString());n.$18.get_$3p().$D(t);n.$18.get_$UO()&&n.$18.get_$UO().$D(n.$18.get_$UO().get_$3o(0),n.$18.get_$3p().get_$C().toString())}else{n.$3M1=n.$18.$8Cl()?n.$18.get_$6P():_h.$2G.$2KN();for(var r=n.$18.get_$3p().get_$C(),i=0;i<r;i++){var u=n.$18.get_$3p().get_$3o(i);if(u.get_$1o()==="GAL"){t.set_$1y(i.toString());n.$18.get_$3p().set_$3o(i,t);break}}}n.$3h1=t.get_$1y()}_d.$HR.prototype={$e0:null,$185:null,$ow:null,$CX:null,$3M1:null,get_$8ER:function(){return _g.$V.get_$I().get_$2z().get_$7l()==="ja-JP"},get_$8MX:function(){return this.$7Q===2&&this.get_$dC()},get_$9gn:function(){return this.$e0},set_$9gn:function(n){this.$e0=n;$3(this,"PersonaCardProfileFieldsListViewModelLeft");return n},get_$9go:function(){return this.$185},set_$9go:function(n){this.$185=n;$3(this,"PersonaCardProfileFieldsListViewModelRight");return n},get_$9gm:function(){return this.$ow},set_$9gm:function(n){this.$ow=n;$3(this,"PersonaCardProfileFieldsListViewModelBottom");return n},get_$1Zc:function(){return this.$CX},set_$1Zc:function(n){if(this.$CX!==n){this.$CX&&this.$CX.$q("IsNotesLoaded",this.$$d_$6Lm);this.$CX=n;this.$CX&&this.$CX.$Y("IsNotesLoaded",this.$$d_$6Lm);$3(this,"CardNotesViewModel")}return n},$41:function(){_d.$Cq.prototype.$41.call(this);$70d(this);this.$7Q===3&&$70f(this);$1Xe(this)},$158:function(n){_d.$Cq.prototype.$158.call(this,n);this.set_$1Zc(new _d.$PI(this.$18,this.$8U,this.$B,this.$k,n.$nh));this.$7Q===1&&this.$CX.$Le()},$8Hk:function(){this.$e0.$iq();this.$185.$iq();this.$ow.$iq();this.$Hn=!1},$9Xe:function(){_d.$Cq.prototype.$9Xe.call(this);$70e(this)},$BS:function(){_a.$6.stPT(_a.$0.$AC,"SavePersona_"+this.$B.get_$L(),3);_a.$6.$1X(_a.$0.$AC,"SaveContact");_a.$g.$2Dw("VM.PersonCard.Save");var i=this.$e0.$1Ll();var u=this.$185.$1Ll();var f=this.$ow.$1Ll();var r=i.concat.apply(i,u);var t=r.concat.apply(r,f);if(!$5(t)&&t.length>0){var n=null;if(this.$7Q===1)n=new _pc.$12M(this.$18.get_$6P(),t,_h.$Ar.toString(1));else{if($5(this.$Gt))throw Error.argumentNull("parentFolderId","Can't create persona when parent folder is undefined");n=new _pc.$jd(this.$7Q===3?this.$3M1:this.$18.get_$6P(),t,new _g.$CI(this.$Gt),_h.$Ar.toString(1),this.$1C3)}n.add_$29(this.$$d_$6Nl);n.add_$21(this.$$d_$6Nl);n.$FO=this.$8U.$AD;this.$k.$11(n)}else{this.$Hn=!1;this.$Cu.set_$Aq(!1);this.get_$UC().$s()}},$6Nl:function(n){$4qP(this,n,1)},$6Lm:function(n,t){this.$CX.$1QA&&this.$CX.$nh&&this.$ow&&this.$ow.$wl()}};_d.$5G=function(n,t,i,r,u,f,e,o,s,h,c,l){this.$$d_$9Rt=Function.createDelegate(this,this.$9Rt);this.$$d_$4P1=Function.createDelegate(this,this.$4P1);this.$$d_$9Vf=Function.createDelegate(this,this.$9Vf);this.$$d_$6Mw=Function.createDelegate(this,this.$6Mw);_d.$5G.initializeBase(this,[n,t,i,r,u,f,o,s,h,c]);this.$1Da=e;this.$1EW=!!l&&l.$3N("ModernGroups")};_d.$5G.$5Ys=function(n){return!n.get_$1l()||_js.$8.$a(n.get_$1l().EmailAddress)?"":n.get_$1l().EmailAddress};function $729(n){return n.get_$1et()?0:0}function $72B(n){return 1}function $72A(n){return n.get_$1et()?1:2}function $72C(n,t){var i=new _c.$Pi(t.$5S,t.$2H6,t.$B6,t.$uW,1);n.set_$LV(!0);i.add_$2t(n.$$d_$9Rt);n.$k.$11(i)}function $728(n,t,i){i.val=null;if(!$5(t)&&t.length>0){i.val=new _js.$c;for(var r=0;r<t.length;r++)i.val.$D($727(n,t[r]))}}function $727(n,t){var i=n.$1Da.$E(t);i.add_$4Sh(n.$$d_$5Kl);return i}function $726(n){if(!$5(n.$1Tr)){n.$1Tr.$1t();n.$1Tr=null}}_d.$5G.prototype={$1EW:!1,$1Tr:null,$AV:null,$1Da:null,$CX:null,get_$1Zc:function(){return this.$CX},set_$1Zc:function(n){if(this.$CX!==n){this.$CX=n;$3(this,"CardNotesViewModel")}return n},get_$32H:function(){return this.$8U.$2Ly?!0:this.$18.$2PO()||!this.get_$1et()},get_$5iw:function(){return this.get_$C8()===$729(this)},get_$5ix:function(){return this.get_$C8()===$72B(this)},get_$35V:function(){return this.get_$C8()===$72A(this)},get_$8ME:function(){return this.$AV.$20T},get_$2Jn:function(){var n=_d.$7l.prototype.get_$2Jn.call(this);n.$nh=this.$CX.$nh;return n},get_$3Sg:function(){return this.$8U.$1bH?!1:!this.$18.$2PO()&&this.get_$1et()},get_$8Jz:function(){return!!this.$18.get_$1l()&&this.$18.get_$1l().RoutingType.toUpperCase()==="SMTP"},get_$1et:function(){return!!this.$18.get_$1l()&&this.$18.get_$1l().RoutingType.toUpperCase()==="MAPIPDL"},get_$7qh:function(){return this.$1EW?_nbs.NonBootStrings.l_DeleteContactListConfirmationPromptTile_Text:_nbs.NonBootStrings.l_DeleteGroupConfirmationPromptTile_Text},$41:function(){_d.$7l.prototype.$41.call(this);this.set_$1Zc(new _d.$PI(this.$18,this.$8U,this.$B,this.$k));this.$AV=new _d.$VB(this.$B,0);this.$AV.add_$6ac(this.$$d_$6Mw);this.$AV.$Y(_d.$4f.$2SL,this.$$d_$9Vf);var n=_d.$5G.$5Ys(this.$18);this.get_$4Sl().$KF(2,n,0);$1Xe(this)},$8Hu:function(){this.get_$35V()&&this.$CX.$Le()},$5Yv:function(){var n=_nbs.NonBootStrings.l_GroupCardMembersWithoutCountPivotOption_Text;var i=_nbs.NonBootStrings.l_GroupCardOwnersWithoutCountPivotOption_Text;var t=_nbs.NonBootStrings.l_GroupCardNotesPivotOption_Text;return this.get_$1et()?[new _a.$5V(n,null),new _a.$5V(t,null)]:[new _a.$5V(n,null),new _a.$5V(i,null),new _a.$5V(t,null)]},$86K:function(){return this.get_$5ix()?24:this.get_$35V()?21:this.get_$5iw()?25:100},$9Xe:function(){_d.$7l.prototype.$9Xe.call(this);this.set_$1Zc(new _d.$PI(this.$18,this.$8U,this.$B,this.$k));var n=_d.$5G.$5Ys(this.$18);this.get_$4Sl().$KF(2,n,0)},$8NB:function(){return!0},$9tM:function(){$He(this,[_d.$5G.$45G,_d.$5G.$45I,_d.$5G.$45H]);this.get_$35V()&&this.$CX.$Le()},$8Hn:function(){if(this.$18.get_$1l()&&this.$18.get_$1l().ItemId||this.$18.get_$6P()){var t=_c.$dq.$E(this.$18,_d.$VB.$3xv(this.$B));$72C(this,t);this.$AV.set_$GP(new _c.$xX(t,null));this.$AV.$5m()}else if(this.$18.get_$1l()&&_a.$3q.$WP(this.$18.get_$1l().EmailAddress)){this.set_$LV(!0);var n=_pc.$15.$5L4(this.$18.get_$1l().EmailAddress,_pc.$15.$mr);n.add_$2t(this.$$d_$4P1);this.$k.$11(n)}},$6Mw:function(n,t){var i=n;if(i&&i.$12){this.$5Kl(i.$12);this.$AV.set_$1p(null)}},$4P1:function(n){var t=n;($5(this.$18.get_$1l())||$5(this.$18.get_$1l().ItemId))&&$5(this.$18.get_$6P())&&this.set_$LV(!1);if($5(t.$1d)&&t.$Ck.get_$C()>0){$5(this.get_$4Sl())||(this.get_$4Sl().$1fy=!0);var i=t.$Ck.get_$3o(0);this.set_$1u(i)}t.remove_$2t(this.$$d_$4P1)},$9Rt:function(n){var t=n;this.set_$LV(!1);if(!t.$1d){var r=_a.$6.acss(_a.$0.$1xw,"SetGroupMembers");$726(this);var i;$728(this,t.$1Tr,i={val:this.$1Tr});this.$1Tr=i.val;this.get_$8Jz()&&this.$CX.set_$JO(t.$Wh);t.$Ci&&this.$18.set_$6P(t.$Ci);this.get_$1et()&&this.get_$C8()===1&&this.$CX.$Le();this.get_$4Sl().$KF(1,t.$OV,0);_a.$6.aces(r);$4sp(this);$2FQ(this);$He(this,[_d.$5G.$5sE,_d.$5G.$6PM,_d.$5G.$45G,_d.$5G.$45I,_d.$5G.$45H])}_a.$6.$19(null,"OpenContact");_a.$6.$19(null,"NavigateToPeople",t.$1d?t.$1d.message:null);_a.$6.endPT("OpenPersonCard_"+this.$B.get_$L());_a.$6.endPT("NavigateToPeopleHub_"+this.$B.get_$L())},$9Vf:function(n,t){$3(this,"IsMembersListLoading")}};_d.$B5=function(n,t,i,r,u,f,e,o,s,h,c){this.$$d_$9Qw=Function.createDelegate(this,this.$9Qw);_d.$B5.initializeBase(this,[n,t,i,r,u,f,e,o,s,h,c])};function $72U(n){n.$4UX=new _d.$UU(new _d.$10j(n));n.$4UX.$9vb(n.$18);$3(n,_d.$B5.$6Tv)}function $72T(n,t){var i=new _g.$Tt;i.Id=t.get_$31().get_$164();i.Sources=4;i.MaxResults=1;var r=new _c.$pl(i);r.add_$2t(n.$$d_$9Qw);n.$k.$11(r)}_d.$B5.prototype={$4UX:null,get_$32H:function(){return!0},get_$5ji:function(){return this.get_$C8()===1},get_$3Sg:function(){return!1},$41:function(){_d.$OG.prototype.$41.call(this);$4sC(this,0);$1Xe(this)},$5Yv:function(){var n=new(_0365f.$n.$$(_a.$5V));n.$D(new _a.$5V(_nbs.NonBootStrings.l_PersonaCardLocationPivotOption_Text,null));this.$18.get_$31().get_$T8()==="PhonebookServices"&&n.$D(new _a.$5V(_nbs.NonBootStrings.l_PersonaCardLocationInformationPivotOption_Text,null));return n.$6W()},$8Hn:function(){var n=this.$18;if(n.get_$31().get_$T8()==="PhonebookServices"&&!_js.$8.$a(n.get_$31().get_$164()))if(n.get_$BO()!==3){this.set_$LV(!0);$72T(this,n)}else $72U(this)},$9tM:function(){_d.$OG.prototype.$9tM.call(this);$3(this,_d.$B5.$5jj)},$86K:function(){return this.get_$5ji()?20:this.get_$469()?26:100},$9Qw:function(n){this.set_$LV(!1);var t=n;if(!t.$1d&&t.$Ck.get_$C()===1){var i=t.$Ck.get_$3o(0);i.set_$BO(3);this.set_$1u(i)}}};_d.$14A=function(n,t,i,r){_d.$14A.initializeBase(this,[1,"VM.PersonCard.Open"]);this.set_$q7(n);this.set_$4g(t);this.set_$2Q5(i);this.set_$3r(r)};_d.$14A.prototype={get_$q7:function(){return this.$W("a")},set_$q7:function(n){$1I(this,"a",n);return n},get_$4g:function(){return this.$W("loc")},set_$4g:function(n){$1I(this,"loc",n);return n},get_$2Q5:function(){return this.$W("h")},set_$2Q5:function(n){$1I(this,"h",n);return n},get_$3r:function(){return this.$W("t")},set_$3r:function(n){$1I(this,"t",n);return n},$3Vg:function(){var n=new _a.$6I;n.$5I("a",this.get_$q7()).$5I("h",this.get_$2Q5()).$5I("loc",this.get_$4g()).$5I("t",this.get_$3r());return n.toString()}};_d.$tC=function(n,t,i,r){_d.$tC.initializeBase(this,[1,"VM.Recipient.Cache"]);this.set_$q7(n);this.set_$6UR(t);this.set_$5Em(i);$5(r)?this.set_$Qo(-100):this.set_$Qo(r)};_d.$tC.prototype={get_$q7:function(){return this.$W("A")},set_$q7:function(n){$1I(this,"A",n);return n},get_$6UR:function(){return this.$W("QL")},set_$6UR:function(n){$1I(this,"QL",n);return n},get_$5Em:function(){return this.$W("CRL")},set_$5Em:function(n){$1I(this,"CRL",n);return n},get_$Qo:function(){return this.$W("SI")},set_$Qo:function(n){$1I(this,"SI",n);return n},$3Vg:function(){var n=new _a.$6I;n.$5I("a",this.get_$q7()).$5I("ql",this.get_$6UR()).$5I("crl",this.get_$5Em()).$5I("si",this.get_$Qo());return n.toString()}};_d.$15u=function(){};_d.$15u.prototype={$2VT:null,$Be:null,$27e:!1,$1Dl:!1};_d.$DU=function(n,t,i,r,u,f){this.$$d_$4Pj=Function.createDelegate(this,this.$4Pj);this.$$d_$9WM=Function.createDelegate(this,this.$9WM);_d.$DU.initializeBase(this);_a.$3.$m(t,"findRecipientViewModelFactory");_a.$3.$m(i,"recipientWellViewModelFactory");_a.$3.$m(r,"personaViewModelFactory");_a.$3.$m(f,"groupCard");this.$j2=t;this.$5q=r;this.$5at=u;this.$3zV=f;this.$52=$722(this,n);this.set_$8UI(i.$7mF(_y.$17.$Km));this.$QQ.$1U.add_$1Y(this.$$d_$9WM)};_d.$DU.$9Ho=function(n){return n.get_$1l().MailboxType==="Mailbox"};_d.$DU.$5Kv=function(n){var t=n.get_$1l();t.RoutingType==="MAPIPDL"&&(t.EmailAddress="");t.ItemId&&(t.ItemId.ChangeKey=null);return t};function $722(n,t){var r=_pc.$15.$xo;n.$3MG=!1;var u=null;if(n.$3zV.get_$1u().get_$1J()===5){r=_pc.$15.$83p;n.$3MG=!0;u=_d.$DU.$9Ho}var i=n.$j2.$E(r,_pc.$15.$jD(),!1,"PersonaDetailedView",n.$3MG,u,n.$5q);_d.$DR.$1aH(i);i.$12a();i.set_$M0(t);i.set_$1ls("PersonaDetailedView");i.add_$hO(n.$$d_$4Pj);return i}function $71x(n,t){var i=t.$ab();if(n.$3MG&&!$721(n,i))n.get_$D3().$2u(0,_nbs.NonBootStrings.l_RecipientNotInAd_PeoplePicker_Text,null);else if(!$71y(n,i)){var r=_pc.$l.$Dh(i);r.set_$1J(t.get_$1u().get_$1J());r.set_$6P(t.get_$1u().get_$6P());var u=$720(n,r);u.$1JC=!0;n.$QQ.$7ZN(u,3)}}function $721(n,t){return t.MailboxType==="Mailbox"}function $71y(n,t){var i=t.ItemId;return i&&t.MailboxType==="PrivateDL"&&i===n.$5at?!0:$71z(n,t)}function $71z(n,t){if(t){if(!$5(t.ItemId)&&!$5(t.ItemId.Id)){for(var e=t.ItemId.Id.toLowerCase(),r=0;r<n.$QQ.$8i.get_$C();r++){var i=n.$QQ.$8i.get_$3o(r);if(i&&!$5(i.ItemId)&&!$5(i.ItemId.Id)&&i.ItemId.Id.toLowerCase()===e)return!0}return!1}if(t.EmailAddress)for(var o=t.EmailAddress.toLowerCase(),u=0;u<n.$QQ.$8i.get_$C();u++){var f=n.$QQ.$8i.get_$3o(u);if(f&&f.EmailAddress&&f.EmailAddress.toLowerCase()===o)return!0}}return!1}function $720(n,t){var i=n.$5q.$Vu(t,n.$QQ.$1Ui,!0,3);var r=[1];i.$eL(1,r,"");return i}_d.$DU.prototype={$52:null,$j2:null,$5q:null,$5at:null,$3zV:null,$QQ:null,$2Zn:null,$3MG:!1,$1v:null,$3SW:!1,get_$8UI:function(){return this.$QQ},set_$8UI:function(n){this.$QQ=n;$3(this,"MembersRecipientWellViewModel");return n},get_$9JA:function(){return this.$2Zn},set_$9JA:function(n){if(this.$2Zn!==n){this.$2Zn=n;$3u(this,"NewlyAddedMembersCountLabel","IsNewlyAddedMembersLabelShown")}return n},get_$D3:function(){return this.$1v||(this.$1v=new _y.$4p)},get_$5kA:function(){return!!this.$QQ&&!!this.$QQ.$1U&&this.$QQ.$1U.get_$C()>0},get_$6f0:function(){return this.$3SW},set_$6f0:function(n){this.$3SW=n;$3(this,"ShowCompactList");return n},$9pV:function(){this.$QQ.$1U.$1t()},$1Ll:function(){var n=[];if(this.$QQ&&this.$QQ.$1U)for(var t=0;t<this.$QQ.$1U.get_$C();t++){var i=this.$QQ.$1U.get_$3o(t);if(i){var r=i.$5B.$18;if(r){var f=_d.$DU.$5Kv(r);var u=new _g.$KR(new _g.$1V("PersonaMembers"));u.AddMemberToPDL=f;var e=[u];n=n.concat.apply(n,e)}}}return n},$4Pj:function(n,t){var i=n.get_$X1();if(!$5(i)){$71x(this,i);this.$3zV.set_$1zR(!0)}},$9WM:function(n,t){this.set_$9JA(String.format(_nbs.NonBootStrings.l_GroupCardNewlyAddedMembersCount_Text,this.$QQ.$1U.get_$C()))}};_d.$Pn=function(n,t){this.$$d_$9Xf=Function.createDelegate(this,this.$9Xf);_d.$Pn.initializeBase(this);$5(n)&&Error.argumentNull("persona");this.$18=n;this.$73=$71w(this,t)};function $71w(n,t){var i=null;i=$5(t)?new _d.$96(n.$18,_y.$17.$Km,!1,3):t.$Vu(n.$18,_y.$17.$Km,!1,3);i.set_$1Co(!0);i.set_$E5(!0);i.set_$Vx(new _C(n.$$d_$9Xf,_a.$0.$A7));i.set_$Ag(i.$1bU);return i}_d.$Pn.prototype={$18:null,$73:null,add_$4Sh:function(n){this.$2G("PersonaClicked",n)},remove_$4Sh:function(n){this.$2H("PersonaClicked",n)},$9Xf:function(){$Cq(this,"PersonaClicked",this.$18)}};_d.$5c=function(n,t){this.$48k=this.$$gta["_d.$5c"].T===Number||Type.isEnum(this.$$gta["_d.$5c"].T)?0:this.$$gta["_d.$5c"].T===Boolean?!1:null;this.$48k=n;this.$2we=t};_d.$5c.$$=function(n){var i="$5c"+"$1"+"$"+n.getName().replace(/\./g,"_");if(!_d[i]){var t=_d[i]=function(){(this.$$gta=this.$$gta||{})["_d.$5c"]={T:n};for(var i=[],t=0;t<arguments.length;++t)i[t]=arguments[t];_d.$5c.apply(this,i)};t.registerClass("_d."+i);var u=_d.$5c.prototype;for(var f in u){var r={key:f,value:u[f]};"constructor"!==r.key&&(t.prototype[r.key]=r.value)}t.$AHA=function(n){var r=null;var u=new(_0365f.$n.$$(String));if($5(n.get_$6G())||!n.get_$6G().length)return null;r=[];for(var t=0,e=0,o=n.get_$6G().length;t<o;++t){var f=!$5(n.get_$6G()[t])&&n.get_$6G()[t].RoutingType==="MAPIPDL";if(!$5(n.get_$6G()[t])&&(f||!_js.$8.$a(n.get_$6G()[t].EmailAddress))){var i=_g.$2R.$1QS(n.get_$6G()[t])?n.get_$6G()[t].OriginalDisplayName:n.get_$6G()[t].EmailAddress;if(!f&&(_js.$8.$15(i)||u.$76(i.toLowerCase())))continue;r[e++]=new(_d.$5c.$$(_g.$1q))(n.get_$6G()[t],i);n.get_$6G()[t].RoutingType!=="MAPIPDL"&&u.$D(i.toLowerCase())}}return r};t.$AHB=function(n,t){var s=new(_0365f.$n.$$(String));var r=n.get_$g4();if($5(r)||!r.get_$C())return null;for(var h=[],f=0,c=0,l=r.get_$C();f<l;++f){var e=r.$7cF(f);if(!$5(e)&&!$5(e.get_$1n())){var o=e.get_$1n();if(!_js.$8.$a(t)&&o.trim().toLowerCase()===t)continue;var u=o.trimStart();var i=u.toLowerCase();if(i.startsWith("sip:")){u=i.substr(4).trimStart();i=u.toLowerCase()}if(s.$79(i)<0){s.$D(i);h[c]=new(_d.$5c.$$(String))(o,u);c++}}}return h};t.$AHC=function(n){var i=[];t.$GS(n.get_$mJ(),_nbs.NonBootStrings.l_BusinessPhoneNumber_Text,n,i);t.$GS(n.get_$12c(),_nbs.NonBootStrings.l_BusinessPhoneNumber_Text,n,i);t.$GS(n.get_$ti(),_nbs.NonBootStrings.l_MobilePhoneNumber_Text,n,i);t.$GS(n.get_$17D(),_nbs.NonBootStrings.l_MobilePhoneNumber_Text,n,i);t.$GS(n.get_$rj(),_nbs.NonBootStrings.l_HomePhoneNumber_Text,n,i);t.$GS(n.get_$14w(),_nbs.NonBootStrings.l_HomePhoneNumber_Text,n,i);t.$GS(n.get_$1Hi(),_nbs.NonBootStrings.l_OtherPhoneNumber_Text,n,i);t.$GS(n.get_$1Kk(),_nbs.NonBootStrings.l_BusinessFaxPhoneNumber_Text,n,i);t.$GS(n.get_$1Do(),_nbs.NonBootStrings.l_HomeFaxPhoneNumber_Text,n,i);t.$GS(n.get_$1Hh(),_nbs.NonBootStrings.l_OtherFaxPhoneNumber_Text,n,i);t.$GS(n.get_$1Hd(),_nbs.NonBootStrings.l_OrganizationMainPhoneNumber_Text,n,i);t.$GS(n.get_$1B2(),_nbs.NonBootStrings.l_AssistantPhoneNumber_Text,n,i);t.$GS(n.get_$1BQ(),_nbs.NonBootStrings.l_CallbackPhoneNumber_Text,n,i);t.$GS(n.get_$1Hl(),_nbs.NonBootStrings.l_PagerPhoneNumber_Text,n,i);t.$GS(n.get_$1IH(),_nbs.NonBootStrings.l_RadioPhoneNumber_Text,n,i);t.$GS(n.get_$1Jw(),_nbs.NonBootStrings.l_TelexPhoneNumber_Text,n,i);t.$GS(n.get_$1KH(),_nbs.NonBootStrings.l_TTYTDDPhoneNumber_Text,n,i);return i};t.$GS=function(n,t,i,r){if(!$5(n)&&n.get_$C())for(var e=0,s=r.length,h=n.get_$C();e<h;++e){var u=n.$7cF(e);if(!$5(u)&&!$5(u.get_$1n())){var o=u.get_$1n();if(!_js.$8.$15(o.Number)){var f=h>1?_d.$2n.$2O3(u,i,""):"";f=_js.$8.$a(f)?"":String.format(" {0}",f);var c=String.format("{0} [{1}{2}]",o.Number,t,f);r[s]=new(_d.$5c.$$(_g.$3G))(o,c);s++}}}};t.$8FP="sip:"}return _d[i]};_d.$5c.prototype={$2we:null,get_$AH9:function(){return this.$48k},get_$1bP:function(){return this.$2we}};_d.$QC=function(n,t,i,r,u){this.$$d_$1Tc=Function.createDelegate(this,this.$1Tc);this.$$d_$9di=Function.createDelegate(this,this.$9di);this.$$d_$9Nf=Function.createDelegate(this,this.$9Nf);_d.$QC.initializeBase(this,[n,t,i]);this.$k=r;this.$c=u;this.$B.get_$L()==="TouchNarrow"&&this.set_$6k($740(this))};_d.$QC.$E=function(n,t,i,r,u){return new _d.$QC(n,t,i,r,u)};function $740(n){var t;t=n.get_$ps().get_$2J5()?[n.get_$ps().get_$4Y3(),n.get_$ps().get_$5OZ(),new _y.$2Q(_y.$d.get_$9J(),_y.$d.get_$LH(),_nbs.NonBootStrings.l_CancelItem_LowerCase_Text,new _C(n.$$d_$1Tc,_a.$0.$1XG))]:[new _y.$2Q(_y.$d.get_$12L(),_y.$d.get_$1B0(),_nbs.NonBootStrings.l_ButtonBack_Text,new _C(n.$$d_$9J,_a.$0.$1XG))];return _y.$22.$Aj(n,t,null)}_d.$QC.prototype={$k:null,$c:null,$el:null,get_$7fu:function(){return this.get_$ps().get_$2J5()?new _C(this.$$d_$9Nf,_a.$0.$1XG):null},get_$ps:function(){if(!this.$el){this.$el=_d.$5a.$5L1(this.$B,this.$k,this.$c);this.$el.add_$3XU(this.$$d_$9di)}return this.$el},get_$8Oj:function(){return this.$B.get_$L()==="TouchWide"},get_$3sw:function(){return 0},get_$2QH:function(){return this.get_$ps().$1PM},$TZ:function(){_y.$1Mq.prototype.$TZ.call(this);this.get_$ps().$6XD()},$7m3:function(){return null},$7o2:function(){return null},$5Ku:function(){return{}},$9Nf:function(){this.$B.$7C(this.get_$ps())},$9di:function(){this.$B.get_$L()==="TouchNarrow"?this.$9J():$3(this,"ImageSource")},$1Tc:function(){this.get_$ps().$1Tc()||this.$9J()}};_d.$zz=function(n,t,i,r,u,f){this.$$d_$4P2=Function.createDelegate(this,this.$4P2);_d.$zz.initializeBase(this,[n,t,i,r,u]);this.$2HM=f};_d.$zz.prototype={$2HM:!1,$7nd:function(n,t){var i=n.$2uB(2,_y.$17.$XR,t);var r=i.get_$6A();r?r.set_$QJ(!1):i.$Y("FindRecipientViewModel",this.$$d_$4P2);return i},$5bi:function(){this.get_$bn().$1DF();_d.$8C.prototype.$5bi.call(this)},$6M6:function(n){this.$2HM||this.get_$bn().$1U.$1t();_d.$8C.prototype.$6M6.call(this,n)},$4P2:function(n,t){var i=n;var r=i.get_$6A();r.set_$QJ(!1);i.$q("FindRecipientViewModel",this.$$d_$4P2)}};_d.$1AW=function(n,t,i,r){this.$$d_$9dQ=Function.createDelegate(this,this.$9dQ);this.$$d_$3Ws=Function.createDelegate(this,this.$3Ws);_d.$1AW.initializeBase(this,[n,t,i,r]);this.$6mW=new _d.$l2(_nbs.NonBootStrings.l_LinkPersonaCardUnlinkButtonText_Text,this.$$d_$3Ws,this)};_d.$1AW.prototype={$6mW:null,get_$49q:function(){return 0},$3Ws:function(){this.set_$1Qz(!0);var n=new _pc.$1Gl(this.get_$1u().get_$6P(),this.get_$1u().get_$3p().get_$3o(0).get_$v7());n.add_$2t(this.$$d_$9dQ);OwaApplication.$1W.$11(n)},$9dQ:function(n){var t=n;if(t.$1d)$2ky(this,t.$1d,_nbs.NonBootStrings.l_LinkPersonaCardUnlinkFailureText_Text);else{var i=t.$1XA;$2kx(this);$2kz(this,i)}this.set_$1Qz(!1)}};_d.$l2=function(n,t,i){var r=this;_d.$l2.initializeBase(this,[t,_a.$0.$1F6,i,_d.$7u.$49p,function(){return!i.$395}]);this.$2we=n};_d.$l2.prototype={$2we:null};_d.$7u=function(n,t,i,r){_d.$7u.initializeBase(this);_a.$3.$m(n,"personaGetter");_a.$3.$m(t,"updatePersona");_a.$3.$m(i,"closeLinkPersonaCard");_a.$3.$m(r,"showErrorMessage");this.$6Qq=n;this.$6nY=t;this.$5I3=i;this.$2C3=r};_d.$7u.$3yS=function(n){var i=n.$3zD();var t;switch(i.length){case 0:t="";break;case 1:t=i[0].get_$1cb();break;default:t=String.format(_nbs.NonBootStrings.l_LinkPersonaCardSuggestedPersonaDescription_Text,i.length);break}return t};_d.$7u.$A9z=function(n,t){t.val=n[_d.$7u.$6iJ];return!$5(t.val)};function $2kz(n,t){n.$6nY(t)}function $2kx(n){n.$5I3()}function $2ky(n,t,i){var u=i;var r;var f,e;(e=_d.$7u.$A9z(t,f={val:r}),r=f.val,e)&&(_g.$7e.$11U(r)||(u=_nbs.NonBootStrings.l_LinkPersonaCardConnectionFailureText_Text));n.$2C3(u)}_d.$7u.prototype={$6nY:null,$5I3:null,$2C3:null,$6Qq:null,$395:!1,get_$1Qz:function(){return this.$395},set_$1Qz:function(n){if(this.$395!==n){this.$395=n;$N(this,_d.$7u.$49p)}return n},get_$1u:function(){return this.$6Qq()}};_d.$Ri=function(n,t,i,r,u,f){this.$$d_$86M=Function.createDelegate(this,this.$86M);this.$$d_$7hR=Function.createDelegate(this,this.$7hR);_d.$Ri.initializeBase(this);_a.$3.$m(n,"owaShell");_a.$3.$m(i,"parentSummaryCardViewModel");_a.$3.$m(u,"persona");_a.$3.$m(f,"onLinkActionCompleted");this.$B=n;this.$183=t;this.$2sd=new _C(this.$$d_$7hR,_d.$Ri.$A);this.$1yI=new _d.$96(u,2,!1,7);this.$1PF=new _d.$96(u,8,!1);this.$1PF.$KF(1,_d.$7u.$3yS(u),0);this.$Wn=$72M(this,u);this.$Wn.$1JZ(u);this.$Q3=new _y.$4p;var o=this;var e=function(n){o.$Q3.$2u(0,n,null)};r?r===1?this.$15z=new _d.$1AY(i.$18,this.$$d_$86M,f,this.$$d_$7hR,e):r===2&&(this.$15z=new _d.$1B2(i.$18,this.$$d_$86M,f,this.$$d_$7hR,e)):this.$15z=new _d.$1AW(this.$$d_$86M,f,this.$$d_$7hR,e);this.$3LU=i;this.set_$6k(this.$1aU())};function $72M(n,t){var i=new _d.$Ic;i.$AD=9;if(n.$B.get_$L()!=="TouchNarrow"){i.$2wE=!0;i.$1bH=!0}i.$1No=!0;i.$2M0=!0;return n.$183.$E(i,0)}_d.$Ri.prototype={$B:null,$183:null,$15z:null,$2sd:null,$1yI:null,$1PF:null,$Wn:null,$Q3:null,$3LU:null,get_$20Z:function(){return this.$B.get_$L()==="Mouse"},get_$8LB:function(){return!this.$15z.get_$49q()},get_$8LX:function(){return this.$15z.get_$49q()===1},get_$8LO:function(){return this.$15z.get_$49q()===2},get_$AAl:function(){return this.$15z.$6mW},get_$7XE:function(){return this.$15z.$59G},get_$8Sz:function(){return this.$15z.$5qr},get_$9mg:function(){return this.$15z.$6Va},$7hR:function(){if(_d.$Ri.isInstanceOfType(this.$3LU.get_$4h().get_$7T())){this.$Wn.$1R();this.$3LU.$1Zx();this.$3LU.get_$4h().$BP()}},$86M:function(){return this.$Wn.$7f.$18}};_d.$eN=function(n,t,i,r,u,f){_d.$eN.initializeBase(this,[n,t,i,r,u,f])};_d.$eN.prototype={get_$KN:function(){return this.$B.get_$L()==="TouchWide"?1:this.$B.get_$L()==="TouchNarrow"?2:0},$1aU:function(){if(this.$B.get_$L()==="TouchWide"){var n=new Array(1);n[0]=new _y.$2Q(_y.$d.get_$9J(),_y.$d.get_$LH(),_u.Strings.l_Discard_Text,this.$2sd);return _y.$22.$Aj(this,n,null)}else if(this.$B.get_$L()==="TouchNarrow"){var t=_y.$22.$Aj(this);t.$i1(this.$2sd);return t}return null}};_d.$1AY=function(n,t,i,r,u){this.$$d_$9ZI=Function.createDelegate(this,this.$9ZI);this.$$d_$9Kv=Function.createDelegate(this,this.$9Kv);this.$$d_$9mf=Function.createDelegate(this,this.$9mf);this.$$d_$7XD=Function.createDelegate(this,this.$7XD);_d.$1AY.initializeBase(this,[t,i,r,u]);_a.$3.$m(n,"originalPersona");this.$2bG=n;this.$59G=new _d.$l2(_nbs.NonBootStrings.l_LinkPersonaCardAcceptSuggestionButtonText_Text,this.$$d_$7XD,this);this.$6Va=new _d.$l2(_nbs.NonBootStrings.l_LinkPersonaCardRejectSuggestionButtonText_Text,this.$$d_$9mf,this)};_d.$1AY.prototype={$2bG:null,$59G:null,$6Va:null,get_$49q:function(){return 1},$7XD:function(){this.set_$1Qz(!0);var n=new _pc.$12Z(this.$2bG.get_$6P(),this.get_$1u().get_$6P());n.add_$2t(this.$$d_$9Kv);OwaApplication.$1W.$11(n)},$9Kv:function(n){var t=n;if(t.$1d)$2ky(this,t.$1d,_nbs.NonBootStrings.l_LinkPersonaCardAcceptSuggestionFailureText_Text);else{var i=t.$1XA;$2kx(this);$2kz(this,i)}this.set_$1Qz(!1)},$9mf:function(){this.set_$1Qz(!0);var n=new _pc.$1DJ(this.$2bG.get_$6P(),this.get_$1u().get_$6P());n.add_$2t(this.$$d_$9ZI);OwaApplication.$1W.$11(n)},$9ZI:function(n){var t=n;if(t.$1d)$2ky(this,t.$1d,_nbs.NonBootStrings.l_LinkPersonaCardRejectSuggestionFailureText_Text);else{var i=t.$1XA;$2kx(this);$2kz(this,i)}this.set_$1Qz(!1)}};_d.$KC=function(){this.$$d_$9SA=Function.createDelegate(this,this.$9SA);_d.$KC.initializeBase(this);this.$AG()};function $72O(n,t,i){_a.$3.$m(t,"personaId");var r=$5(i)||!i.length?3:2;$2l0(n,r,t,i,null)}function $72N(n,t,i){_a.$3.$m(t,"personaId");$2l0(n,4,t,null,i)}function $2l0(n,t,i,r,u){var f=!1;if(n.$Co!==t){n.$Co=t;f=!!(f|!0)}if(n.$Ci!==i){n.$Ci=i;f=!!(f|!0)}if(n.$Pc!==r){n.$Pc=r;f=!!(f|!0)}if(n.$1d!==u){n.$1d=u;f=!!(f|!0)}f&&$3u(n,"LinkSuggestionIdsStatusText","LinkSuggestionsAvailable")}_d.$KC.prototype={$Co:0,$Ci:null,$Pc:null,$1d:null,get_$8R1:function(){switch(this.$Co){case 0:case 1:return _u.Strings.l_LoadingWithEllipses_Text;case 2:return _nbs.NonBootStrings.l_PersonaCardSuggestionsAvailable_Text;case 3:return _nbs.NonBootStrings.l_LinkSummaryCardNoSuggestionsText_Text;case 4:return _nbs.NonBootStrings.l_LinkSummaryCardGetSuggestionsFailureText_Text;default:throw Error.invalidOperation("LinkSuggestionIdsViewModel are in an unknown status: "+this.$Co);}},get_$8R3:function(){return this.$Co===2},get_$8R2:function(){return this.$Co===1},$AG:function(){$2l0(this,0,null,null,null)},$88L:function(n){_a.$3.$m(n,"newPersonaId");if(!this.$Co||n!==this.$Ci){$2l0(this,1,n,null,null);var t=new _pc.$17o(n);t.add_$2t(this.$$d_$9SA);OwaApplication.$1W.$11(t)}},$9SA:function(n){var t=n;_0365f.$2d.$4N(t.$Ci,this.$Ci)&&(t.$1d?$72N(this,this.$Ci,t.$1d):$72O(this,this.$Ci,t.$Pc))}};_d.$5T=function(n,t,i){this.$$d_$4P1=Function.createDelegate(this,this.$4P1);this.$$d_$9SI=Function.createDelegate(this,this.$9SI);this.$$d_$6Kq=Function.createDelegate(this,this.$6Kq);this.$$d_$3UE=Function.createDelegate(this,this.$3UE);this.$$d_$UD=Function.createDelegate(this,this.$UD);this.$$d_$5S0=Function.createDelegate(this,this.$5S0);this.$$d_$9aZ=Function.createDelegate(this,this.$9aZ);this.$$d_$9cY=Function.createDelegate(this,this.$9cY);this.$$d_$9OI=Function.createDelegate(this,this.$9OI);this.$$d_$9Uc=Function.createDelegate(this,this.$9Uc);this.$$d_$3mp=Function.createDelegate(this,this.$3mp);_d.$5T.initializeBase(this);_a.$3.$m(n,"owaShell");_a.$3.$m(t,"linkPersonaCardViewModelFactory");_a.$3.$m(i,"persona");this.$B=n;this.$396=t;this.$2Jc=new _C(this.$$d_$3mp,_d.$5T.$A);this.$Q3=new _y.$4p;this.$2Jl=new _js.$c;this.set_$6gx(!0);this.$dK=new _d.$KC;this.$dK.$Y("LinkSuggestionsAvailable",this.$$d_$9Uc);this.$le=new _js.$c;this.$1mH=new _js.$c;this.$6dI(i);this.set_$6k(this.$1aU());this.set_$1uH("");this.$5In=new _C(this.$$d_$9OI,_d.$5T.$A);this.$6iz=new _C(this.$$d_$9cY,_d.$5T.$A);this.$6Zy=new _C(this.$$d_$9aZ,_d.$5T.$A)};function $4r7(n){n.$dK.$AG();n.$dK.$88L(n.$18.get_$6P())}function $4r8(n,t){if(n.$18!==t||!n.$39D){n.$39D=!0;n.$18=t;n.set_$8De(new _d.$96(t,2,!1,7));n.set_$8Dj(new _d.$96(t,4,!1));$72P(n);n.set_$A2X(String.format(_nbs.NonBootStrings.l_LinkSummaryCardSingleComponentText_Text,n.$1PF.$Gx));n.$UD()}}function $72P(n){n.$4Si=new _pc.$V8(n.$18);n.$2Jl.$1t();for(var t=0;t<n.$4Si.$1Mu.length;t++){var i=n.$4Si.$1Mu[t];n.$2Jl.$D($3b2(n,i,_d.$7u.$3yS(i),n.$$d_$9OI))}n.set_$6gx(n.$2Jl.get_$C()===1)}function $72Q(n){if(!n.$dK.get_$8R2()){var f=!1;if($5(n.$dK.$Pc))n.$le.$1t();else{for(var t=0;t<n.$le.get_$C();t++){for(var c=n.$le.get_$3o(t),l=c.get_$1u().get_$6P(),e=!1,i=0;i<n.$dK.$Pc.length;i++){var a=n.$dK.$Pc[i];if(_0365f.$2d.$4N(a,l)){e=!0;break}}if(!e){n.$le.$6C(t);t--}}for(var r=0;r<n.$dK.$Pc.length;r++){for(var o=n.$dK.$Pc[r],s=!0,u=0;u<n.$le.get_$C();u++){var v=n.$le.get_$3o(u);var y=v.get_$1u().get_$6P();if(_0365f.$2d.$4N(o,y)){s=!1;break}}if(s){f=!0;var h=_pc.$K3.$7ol(o);h.add_$2t(n.$$d_$9SI);OwaApplication.$1W.$11(h)}}}f||_a.$6.$19(null,"PersonCard.ContactLinking")}}function $72R(n,t){if($5(t.$1d)){var r=t.get_$18i();n.$1mH.$1t();for(var i=0;i<r.get_$C();i++){var u=r.get_$3o(i);_0365f.$2d.$4N(u.get_$6P(),n.$18.get_$6P())||n.$1mH.$D($3b2(n,u,"",n.$$d_$9aZ))}if(n.$1mH.get_$C()){n.set_$1uH("");$6J(n,"SearchCompletedWithResults")}else n.set_$1uH(_nbs.NonBootStrings.l_NoMatchFound_Text)}else n.set_$1uH(_nbs.NonBootStrings.l_ServerSearchError_Text)}function $3b2(n,t,i,r){var u=new _d.$96(t,10,!1,3,null,n.$B,!0);u.$KF(1,i,0);u.set_$Ag(new _C(r,_d.$5T.$A));u.set_$E5(!0);return u}function $1q7(n,t){n.get_$4h().$BQ(t)}_d.$5T.prototype={$B:null,$396:null,$2Jc:null,$5In:null,$6iz:null,$6Zy:null,$Q3:null,$dK:null,$18:null,$1yI:null,$1PF:null,$4Si:null,$2Jl:null,$le:null,$1mH:null,$3Tg:!1,$3Th:null,$39D:!1,$JA:null,$1m:null,$3u9:null,$14D:null,$3qE:null,$2Au:null,$2B6:null,$2B5:null,add_$6Zm:function(n){this.$2G("SearchCompletedWithResults",n)},remove_$6Zm:function(n){this.$2H("SearchCompletedWithResults",n)},get_$8De:function(){return this.$1yI},set_$8De:function(n){if(this.$1yI!==n){this.$1yI=n;$3(this,_d.$5T.$5cg)}return n},get_$8Dj:function(){return this.$1PF},set_$8Dj:function(n){if(this.$1PF!==n){this.$1PF=n;$3(this,_d.$5T.$5ck)}return n},get_$7vj:function(){this.$3u9||(this.$3u9=new _C(this.$$d_$5S0,_d.$5T.$A));return this.$3u9},get_$20Z:function(){return this.$B.get_$L()==="Mouse"},get_$ZP:function(){if(!this.$1m){this.$1m=new _y.$5Z(this.$B.get_$L());this.$1m.set_$QJ(!1);this.$1m.set_$r(!1);this.$1m.set_$M0(_nbs.NonBootStrings.l_LinkSummaryCardFindContact_Text);this.$1m.set_$UC(new _C(this.$$d_$UD,_d.$5T.$A));this.$1m.set_$J5(new _C(this.$$d_$3UE,_d.$5T.$A));var n=this;this.$1m.$Y("IsExpanded",function(t,i){n.$1m.$2V||n.get_$ZP().set_$Hr(!1)})}return this.$1m},get_$7fk:function(){return _nbs.NonBootStrings.l_LinkSummaryCardDisplayName_Text},get_$6aU:function(){return this.$2Au},set_$6aU:function(n){if(this.$2Au!==n){this.$2Au=n;$3(this,"SelectedComponentItem");this.$B.get_$L()==="TouchNarrow"&&n&&$1q7(this,this.$1u5(0,n.get_$1u(),this.$$d_$6Kq))}return n},get_$6ar:function(){return this.$2B6},set_$6ar:function(n){if(this.$2B6!==n){this.$2B6=n;$3(this,"SelectedSuggestionItem");this.$B.get_$L()==="TouchNarrow"&&n&&$1q7(this,this.$1u5(1,n.get_$1u(),this.$$d_$6Kq))}return n},get_$6ap:function(){return this.$2B5},set_$6ap:function(n){if(this.$2B5!==n){this.$2B5=n;$3(this,"SelectedSearchItem");this.$B.get_$L()==="TouchNarrow"&&n&&$1q7(this,this.$1u5(2,n.get_$1u(),this.$$d_$6Kq))}return n},get_$7fj:function(){return _nbs.NonBootStrings.l_LinkSummaryCardDescription_Text},get_$7iF:function(){return _nbs.NonBootStrings.l_LinkSummaryCardComponentsHeader_Text},get_$7iE:function(){return _nbs.NonBootStrings.l_LinkSummaryCardComponentsDescription_Text},get_$6gx:function(){return this.$3Tg},set_$6gx:function(n){if(this.$3Tg!==n){this.$3Tg=n;$3(this,_d.$5T.$6gy)}return n},get_$A2X:function(){return this.$3Th},set_$A2X:function(n){if(this.$3Th!==n){this.$3Th=n;$3(this,_d.$5T.$6gz)}return n},get_$A5H:function(){return _nbs.NonBootStrings.l_LinkSummaryCardSuggestionsHeader_Text},get_$A5G:function(){return _nbs.NonBootStrings.l_LinkSummaryCardSuggestionsDescription_Text},get_$8T1:function(){return _nbs.NonBootStrings.l_LinkSummaryCardManualLinkTitle_Text},get_$1uH:function(){return this.$3qE},set_$1uH:function(n){this.$3qE=n;$3(this,"CurrentSearchPeopleMessage");return n},get_$1kp:function(){return 0},get_$2PH:function(){return null},get_$7c:function(){return this.$JA},set_$7c:function(n){this.$JA=n;return n},get_$7sU:function(){return!0},$6dI:function(n){_a.$3.$m(n,"newPersona");$4r8(this,n);$4r7(this)},$1Zx:function(){this.set_$6aU(null);this.set_$6ar(null);this.set_$6ap(null)},$6Kq:function(n){_a.$3.$m(n,"newPersona");$4r8(this,n);$4r7(this)},$3mp:function(){$5(this.get_$7c())||_d.$Ri.isInstanceOfType(this.get_$4h().get_$7T())?this.get_$4h().$BP():this.get_$7c()()},$9Uc:function(n,t){$72Q(this)},$9SI:function(n){var i=n;if(i.$1d){if(this.$39D){this.$Q3.$2u(0,_nbs.NonBootStrings.l_LinkSummaryCardGetSuggestionsFailureText_Text,null);this.$3mp();this.$39D=!1}return}var f=!1;if(!$5(this.$dK.$Pc)&&this.$dK.$Pc.length>0)for(var r=0;r<this.$dK.$Pc.length;r++){var o=this.$dK.$Pc[r];if(_0365f.$2d.$4N(o,i.$Ci)){f=!0;break}}if(f){for(var u=i.$18,e=$3b2(this,u,_d.$7u.$3yS(u),this.$$d_$9cY),t=0;t<this.$le.get_$C();t++){var s=this.$le.get_$3o(t);if(_0365f.$2d.$4N(s.get_$1u().get_$6P(),u.get_$6P())){this.$le.$6C(t);this.$le.$6r(t,e);return}}this.$le.$D(e)}this.$dK.$Pc.length===this.$le.get_$C()&&_a.$6.$19(null,"PersonCard.ContactLinking")},$3UE:function(){if(!_js.$8.$15(this.get_$ZP().$3F)){var n=_pc.$15.$83o(this.get_$ZP().$3F);this.$14D=n;this.$14D.add_$2t(this.$$d_$4P1);this.set_$1uH(_u.Strings.l_ListViewModelDefaultLoadingMessage_Text);this.$1mH.$1t();OwaApplication.$1W.$11(this.$14D)}},$4P1:function(n){if($5(n.$1d)&&$5(n.get_$18i()))throw Error.invalidOperation("The response is not processed correctly!");n===this.$14D&&$72R(this,n);n.remove_$2t(this.$$d_$4P1)},$5S0:function(){this.get_$ZP().set_$4K(!0);this.get_$ZP().set_$Hr(!0)},$UD:function(){this.set_$1uH("");this.$1mH.$1t();this.get_$ZP().set_$4K(!1);this.get_$ZP().set_$7D("");this.get_$ZP().set_$Hr(!1);this.$14D=null},$9OI:function(){this.$2Au&&this.$B.get_$L()!=="TouchNarrow"&&$1q7(this,this.$1u5(0,this.$2Au.get_$1u(),this.$$d_$6Kq))},$9cY:function(){this.$2B6&&this.$B.get_$L()!=="TouchNarrow"&&$1q7(this,this.$1u5(1,this.$2B6.get_$1u(),this.$$d_$6Kq))},$9aZ:function(){this.$2B5&&this.$B.get_$L()!=="TouchNarrow"&&$1q7(this,this.$1u5(2,this.$2B5.get_$1u(),this.$$d_$6Kq))}};_d.$YT=function(n,t,i){_d.$YT.initializeBase(this,[n,t,i])};_d.$YT.prototype={get_$KN:function(){return this.$B.get_$L()==="TouchWide"?1:this.$B.get_$L()==="TouchNarrow"?2:0},$1u5:function(n,t,i){return this.$396.$E(this,n,t,i)},$1aU:function(){if(this.$B.get_$L()==="TouchWide"){var n=new Array(1);n[0]=new _y.$2Q(_y.$d.get_$9J(),_y.$d.get_$LH(),_u.Strings.l_Discard_Text,this.$2Jc);return _y.$22.$Aj(this,n,null)}else if(this.$B.get_$L()==="TouchNarrow")return _y.$22.$E(this);return null}};_d.$1B2=function(n,t,i,r,u){this.$$d_$6Kq=Function.createDelegate(this,this.$6Kq);this.$$d_$8T0=Function.createDelegate(this,this.$8T0);_d.$1B2.initializeBase(this,[t,i,r,u]);_a.$3.$m(n,"originalPersona");this.$2bG=n;this.$5qr=new _d.$l2(_nbs.NonBootStrings.l_LinkPersonaCardAcceptSuggestionButtonText_Text,this.$$d_$8T0,this)};_d.$1B2.prototype={$2bG:null,$5qr:null,get_$49q:function(){return 2},$8T0:function(){this.set_$1Qz(!0);var n=new _pc.$1AX(this.$2bG.get_$6P(),this.get_$1u().get_$6P());n.add_$2t(this.$$d_$6Kq);OwaApplication.$1W.$11(n)},$6Kq:function(n){var t=n;if(t.$1d)$2ky(this,t.$1d,_nbs.NonBootStrings.l_LinkPersonaCardAcceptSuggestionTwoGALContactsFailure_Text);else{var i=t.$1XA;$2kx(this);$2kz(this,i)}this.set_$1Qz(!1)}};_d.$OG=function(n,t,i,r,u,f,e,o,s,h,c){this.$$d_$9VM=Function.createDelegate(this,this.$9VM);this.$3A2=_d.$OG.$4he;_d.$OG.initializeBase(this,[n,t,i,r,u,f,o,s,h,c]);this.$sW=e};function $4sC(n,t){n.$3A2=t}_d.$OG.prototype={$sW:null,$1FC:null,$22x:null,$1RJ:null,$4B5:null,$4B3:null,get_$22b:function(){!this.$1FC&&this.get_$1FP()&&(this.$1FC=this.$sW.$3ol(this.get_$1FP().get_$3o(0),!0));return this.$1FC},get_$1FP:function(){this.$22x||(this.$22x=this.$18.$5YL());return this.$22x},get_$4B8:function(){this.get_$1FP()&&(this.$1RJ=this.get_$1FP().get_$3o(0).get_$2VA());return this.$1RJ},get_$469:function(){return this.$3A2===_d.$OG.$4he?!1:this.get_$C8()===this.$3A2},get_$5jo:function(){return!this.get_$dC()&&this.get_$5kV()||this.get_$nX()},get_$5kV:function(){return this.$8U.$AD===2},$41:function(){_d.$7l.prototype.$41.call(this);this.$4B3=new _C(this.$$d_$9VM,_a.$0.$4g);this.$4B3.set_$69(!this.get_$1Dn()&&!this.get_$5jo());this.$4B5="";(this.get_$ja()&&!this.get_$5kV()&&!this.get_$20r()||this.get_$1Ei()||this.$B.get_$L()==="TouchNarrow")&&(this.$4B5="mapErrorMessage")},$9tM:function(){$3(this,"IsMapPivotSelected")},$9VM:function(){this.get_$dC()?this.get_$1FP()&&this.$B.$7C(this.get_$22b()):this.get_$9hi().$s()}};_d.$Ux=function(n,t,i){this.$$d_$9Xh=Function.createDelegate(this,this.$9Xh);_d.$Ux.initializeBase(this);this.$18=n;this.$5Ch=t;this.$73=$74A(this,i)};function $74A(n,t){var i=null;i=$5(t)?new _d.$96(n.$18,_y.$17.$1fk,!1,3):t.$Vu(n.$18,_y.$17.$1fk,!1,3);i.set_$1Co(!0);i.set_$E5(!0);i.set_$Vx(new _C(n.$$d_$9Xh,_a.$0.$A7));i.set_$Ag(i.$1bU);i.$KF(1,n.$18.get_$4o(),0);return i}_d.$Ux.prototype={$18:null,$73:null,$5Ch:0,add_$6Qm:function(n){this.$2G("PersonaDoubleClicked",n)},remove_$6Qm:function(n){this.$2H("PersonaDoubleClicked",n)},get_$7bL:function(){switch(this.$5Ch){case 1:return _d.$4.get_$7bT();case 2:return _d.$4.get_$7bS();default:return _y.$4.get_$ON()}},$9Xh:function(){$Cq(this,"PersonaDoubleClicked",this.$18)}};_d.$4l=function(n,t,i){this.$$d_$6Qm=Function.createDelegate(this,this.$6Qm);this.$$d_$9S9=Function.createDelegate(this,this.$9S9);_d.$4l.initializeBase(this);this.$2e=n;this.$184=t;this.$2bC=i;this.$35X=!1};function $2lB(n,t){return $5(t)||!t.get_$C()}function $74B(n){if(!$5(n.$16B)){n.$16B.$1t();n.$16B=null}if(!$5(n.$16C)){n.$16C.$1t();n.$16C=null}if(!$5(n.$17w)){n.$17w.$1t();n.$17w=null}if(!$5(n.$13c)){n.$13c.$1t();n.$13c=null}}function $3bM(n,t,i,r){r.val=null;if(!$5(t)){r.val=new _js.$c;for(var u=0;u<t.length;u++){var f=0;switch(i){case 1:u>0&&(f=1);break;case 2:n.$2zM===t[u].get_$rS()&&(f=2);break}r.val.$D($4sP(n,t[u],f))}}}function $4sP(n,t,i){var r=null;r=$5(n.$2bC)?new _d.$Ux(t,i,null):n.$2bC.$E(t,i);n.$2e.get_$2SJ()||r.add_$6Qm(n.$$d_$6Qm);return r}_d.$4l.prototype={$2e:null,$184:null,$2bC:null,$36X:!1,$2zM:null,$13c:null,$17w:null,$16B:null,$16C:null,$35X:!1,get_$A1O:function(){return this.$2e.get_$C8()===2&&this.$35X},get_$5kK:function(){return this.$36X},set_$5kK:function(n){if(this.$36X!==n){this.$36X=n;$3(this,_d.$4l.$5kL)}return n},get_$8E5:function(){return $2lB(this,this.$13c)},get_$8EN:function(){return $2lB(this,this.$16B)},get_$8EO:function(){return $2lB(this,this.$16C)},get_$8EX:function(){return $2lB(this,this.$17w)},add_$6OZ:function(n){this.$2G(_d.$4l.$3Kw,n)},remove_$6OZ:function(n){this.$2H(_d.$4l.$3Kw,n)},$85w:function(n){this.$2zM=n;if(!_js.$8.$a(n)){var i=_a.$6.acss(_a.$0.$A7,"GetOrganizationHierarchy");this.set_$5kK(!0);var t=new _pc.$MK(n);t.add_$2t(this.$$d_$9S9);t.$FO=this.$2e.$8U.$AD;OwaApplication.$1W.$11(t);_a.$6.aces(i)}},$9S9:function(n){var t=n;$74B(this);var i;$3bM(this,t.$13c,0,i={val:this.$13c});this.$13c=i.val;var r;$3bM(this,t.$16B,1,r={val:this.$16B});this.$16B=r.val;var u;$3bM(this,t.$17w,2,u={val:this.$17w});this.$17w=u.val;if(!$5(t.$16C)){this.$16C=new _js.$c;this.$16C.$D($4sP(this,t.$16C,1))}this.$35X=!0;$He(this,[_d.$4l.$5Pc,_d.$4l.$6QH,_d.$4l.$5qo,_d.$4l.$5qq,_d.$4l.$5iz,_d.$4l.$5dK,_d.$4l.$5d9,_d.$4l.$5dC,_d.$4l.$5d3,_d.$4l.$6fm]);this.set_$5kK(!1);$6J(this,_d.$4l.$3Kw)},$6Qm:function(n){this.$184.$1JZ(n)}};_d.$7v=function(n,t,i,r,u){this.$$d_$9hf=Function.createDelegate(this,this.$9hf);this.$$d_$9OJ=Function.createDelegate(this,this.$9OJ);this.$$d_$9Xd=Function.createDelegate(this,this.$9Xd);this.$$d_$9QD=Function.createDelegate(this,this.$9QD);this.$$d_$9Yu=Function.createDelegate(this,this.$9Yu);this.$$d_$9LF=Function.createDelegate(this,this.$9LF);this.$$d_$32P=Function.createDelegate(this,this.$32P);this.$$d_$3p5=Function.createDelegate(this,this.$3p5);this.$$d_$7n0=Function.createDelegate(this,this.$7n0);this.$$d_$7mz=Function.createDelegate(this,this.$7mz);this.$$d_$7n1=Function.createDelegate(this,this.$7n1);_d.$7v.initializeBase(this);this.$B=u;this.$1H=r;this.$ma=n;this.$2cs=t;this.$ox=i;this.$6Qf=new _y.$FO};function $3bP(n,t,i,r){var u;switch(i){case 3:u="AddPersonaCardViewModel";break;case 2:u="CreatePersonaCardViewModel";break;case 1:u="EditPersonaCardViewModel";break;default:throw Error.invalidOperation(String.format("Cannot call CreateAndShowComposeCardViewModel with mode not in (Add,Create,Edit). Actual value = {0}",i));}var e=_a.$6.acsa(_a.$0.$A7,u,!0);var f=n.$ma;if(i===1||i===3){f=new _d.$Ic;f.$AD=n.$ma.$AD}r=r||new _d.$R7;r.$7Q=i;$Cq(n,"BeforeComposeCardCreate",r);var o=this;n.$ox.$7kn(t,i,null,null,f,n,function(t){$74R(n,t,r,e)})}function $74R(n,t,i,r){_a.$6.acea(r);if(n.$d){n.$FI.$5et(n.$d);n.$d=null}n.set_$wh(t);n.$FI.$158(i);if(n.$B.get_$9l()||t.$7Q!==2){var u=_a.$6.acss(_a.$0.$A7,"OwaShell.PopUp");n.$B.$7C(n.$FI);_a.$6.aces(u)}else n.$6Qf.$N9(n.$FI);(n.$FI.$7Q===3||n.$FI.$7Q===1)&&n.$2JQ(n.$FI)}function $4sW(n){var t=_a.$6.$1X(_a.$0.$A7,"PersonCard.Popout",!0);if(n.$B.get_$L()!=="Mouse")throw Error.invalidOperation("Persona/Group Card can only be popped out in MUI");var i=$74Q(n);if(n.get_$1Wx().$7Q){n.$FI.$Hn=!1;n.$FI.get_$UC().$s()}n.get_$1Wx().$5I8();n.$B.$N3(_d.$LY,null,null,_y.$48.get_$A7(),i,!1);_a.$6.$19(t);_d.$6z.$gQ(32,8,n.get_$1Wx().$18.get_$1J())}function $74Q(n){var t=new _d.$5Y(n.get_$1Wx(),n.get_$1Wx().$7Q);if(n.get_$1Wx().get_$4Sl()){t.set_$8QX(n.get_$1Wx().get_$4Sl().$Ou);t.set_$NP(n.get_$1Wx().get_$4Sl().get_$NP())}if(n.$FI){t.set_$28(n.$FI.$Gt);t.set_$3pD(n.$FI.$1C3)}else t.set_$C8(n.$7f.get_$C8());t.set_$nX(!0);t.set_$ja(!1);return t}function $4sV(n,t,i,r){_a.$6.acea(r);var u=!1;if(n.$d){u=!0;t.$5et(n.$d);n.$d=null}n.set_$l6(t);i&&$4sU(n,u)}function $4sU(n,t){if(n.$2cs===3)if(t)n.set_$472(!0);else{n.$7f.$7E.set_$20w(!0);n.$7f.$6Rw()}else if(n.$2cs)if(n.$2cs===1&&n.get_$8Nd()){var i=_a.$6.acss(_a.$0.$A7,"OwaShell.PopUp");n.$B.$fj(n.$7f,1,!1);_a.$6.aces(i)}else{var r=_a.$6.acss(_a.$0.$A7,"OwaShell.PopUp");n.$B.$7C(n.$7f);_a.$6.aces(r)}else n.set_$472(!0)}function $2lC(n,t){var i="";t===1?i="NewContact":t===2?i="NewGroup":t===5&&(i="NewModernGroup");_a.$6.stPT(_a.$0.$AC,i,3);_a.$6.$1X(_a.$0.$AC,i);var r=_pc.$l.$3pf();r.set_$1J(t);if(t===2){r.set_$1l(new _g.$1q);r.get_$1l().RoutingType="MAPIPDL"}n.$2gC(r,null)}_d.$7v.prototype={$B:null,$1H:null,$ox:null,$6Qf:null,$1v:null,$7f:null,$FI:null,$1j0:null,$36I:!1,$2cs:0,$ma:null,$d:null,$1ez:!1,add_$6Qj:function(n){this.$2G("PersonaCreated",n)},remove_$6Qj:function(n){this.$2H("PersonaCreated",n)},add_$2sz:function(n){this.$2G("ComposeCardChanged",n)},remove_$2sz:function(n){this.$2H("ComposeCardChanged",n)},add_$5Ir:function(n){this.$2G("ComposeCardChanging",n)},remove_$5Ir:function(n){this.$2H("ComposeCardChanging",n)},add_$5Dt:function(n){this.$2G("BeforeComposeCardCreate",n)},remove_$5Dt:function(n){this.$2H("BeforeComposeCardCreate",n)},add_$1IL:function(n){this.$2G("ReadCardChanged",n)},remove_$1IL:function(n){this.$2H("ReadCardChanged",n)},add_$2cr:function(n){this.$2G("ReadCardChanging",n)},remove_$2cr:function(n){this.$2H("ReadCardChanging",n)},get_$D3:function(){this.$1v||(this.$1v=new _y.$4p);return this.$1v},get_$9J6:function(){if(!this.$1j0){this.$1j0=new _js.$c;var n=!!this.$1H&&this.$1H.$3N("ModernGroups");this.$1j0.$D(new _a.$2E(new _C(this.$$d_$7mz,_d.$7v.$A),n?_nbs.NonBootStrings.l_AddContactString_LowerCase_Text:_nbs.NonBootStrings.l_CreateContactString_LowerCase_Text,n?_nbs.NonBootStrings.l_AddContactDescription_Text:null));this.$B.get_$L()==="Mouse"&&this.$1j0.$D(new _a.$2E(new _C(this.$$d_$7n0,_d.$7v.$A),n?_nbs.NonBootStrings.l_CreateContactListString_LowerCase_Text:_nbs.NonBootStrings.l_CreateGroupString_LowerCase_Text,n?_nbs.NonBootStrings.l_CreateContactListDescription_Text:null));n&&this.$1j0.$D(new _a.$2E(new _C(this.$$d_$3p5,_d.$7v.$A),_nbs.NonBootStrings.l_CreateGroupString_LowerCase_Text,_nbs.NonBootStrings.l_CreateGroupDescription_Text));this.$1j0.$D(new _a.$2E(new _C(this.$$d_$32P,_d.$7v.$A),_u.Strings.l_ConfirmDialog_Cancel_Text,null))}return this.$1j0},get_$46W:function(){return this.$36I},set_$46W:function(n){if(this.$36I!==n){this.$36I=n;$3(this,"IsNewDialogShown")}return n},get_$472:function(){return this.$1ez},set_$472:function(n){if(this.$1ez===n)return n;this.$1ez=n;$3(this,"IsReadCardVisible");this.$7f.set_$Dl(this.$1ez);return n},get_$l6:function(){return this.$7f},set_$l6:function(n){if(this.$7f===n)return n;$6J(this,"ReadCardChanging");if(this.$7f){this.set_$472(!1);this.$7f.remove_$5Ak(this.$$d_$9LF);this.$7f.remove_$2bq(this.$$d_$9Yu);this.$7f.$7E.remove_$5Qx(this.$$d_$9QD);this.$7f.$q("IsVisible",this.$$d_$9Xd);this.$7f.$1R()}this.$7f=n;if(this.$7f){this.$7f.$Y("IsVisible",this.$$d_$9Xd);this.$7f.add_$5Ak(this.$$d_$9LF);this.$7f.add_$2bq(this.$$d_$9Yu);this.$7f.$7E.add_$5Qx(this.$$d_$9QD)}$6J(this,"ReadCardChanged");$3u(this,"ReadCard","HideConductor");return n},get_$wh:function(){return this.$FI},set_$wh:function(n){if(this.$FI===n)return n;$6J(this,"ComposeCardChanging");if(this.$FI){this.$FI.remove_$2x8(this.$$d_$9OJ);this.$FI.$q("IsVisible",this.$$d_$9Xd);this.$FI.$1R()}this.$FI=n;if(this.$FI){this.$FI.$Y("IsVisible",this.$$d_$9Xd);this.$FI.add_$2x8(this.$$d_$9OJ)}$6J(this,"ComposeCardChanged");$3(this,"ComposeCard");return n},get_$1Wx:function(){return this.$FI||this.$7f},get_$8Nd:function(){return _d.$7l.isInstanceOfType(this.$B.$aZ().get_$7T())},$2uA:function(n){var t=_a.$6.acsa(_a.$0.$A7,"CreatePersonaCardViewModel",!0);var i=this;this.$ox.$2uA(n,null,null,this.$ma,this,function(n){$4sV(i,n,!1,t)})},$1JZ:function(n){if(this.$7f&&_pc.$l.$1rv(this.$7f.$18,n)){$4sU(this,!1);return}var t=_a.$6.acsa(_a.$0.$A7,"CreatePersonaCardViewModel",!0);var i=this;this.$ox.$2uA(n,null,null,this.$ma,this,function(n){$4sV(i,n,!0,t)})},$1tQ:function(){this.set_$l6(null)},$7n1:function(){this.$B.get_$L()==="Mouse"?this.set_$46W(!0):$2lC(this,1)},$7mz:function(){this.$32P();$2lC(this,1)},$7n0:function(){this.$32P();$2lC(this,2)},$3p5:function(){this.$32P();$2lC(this,5)},$2gC:function(n,t){$3bP(this,n,2,t)},$3hY:function(n){_a.$6.$1X(_a.$0.$A7,"PersonCard.AddToContacts");$3bP(this,n,3)},$7ui:function(n,t,i){var r=new _d.$R7;r.get_$rF().$27e=t;r.get_$rF().$1Dl=i;this.$1vl(_pc.$l.$Dh(n),r)},$1vl:function(n,t){switch(n.get_$1J()){case 1:_a.$6.stPT(_a.$0.$AC,"EditContact",3);_a.$6.$1X(_a.$0.$AC,"EditContact");break;case 2:_a.$6.stPT(_a.$0.$AC,"EditGroup",3);_a.$6.$1X(_a.$0.$AC,"EditGroup");break;case 5:_a.$6.stPT(_a.$0.$AC,"EditModernGroup",3);_a.$6.$1X(_a.$0.$AC,"EditModernGroup");break;default:break}$3bP(this,n,1,t)},$8RZ:function(n){this.$d=n;switch(this.$d.get_$66()){case 3:this.$3hY(this.$d.get_$1u());break;case 1:this.$1vl(this.$d.get_$1u(),this.$7f?this.$7f.get_$2Jn():new _d.$R7);break;case 2:var t=new _d.$R7;t.$Gt=n.get_$28();t.$1C3=n.get_$3pD();this.$2gC(this.$d.get_$1u(),t);break;default:this.$1JZ(this.$d.get_$1u());break}},$6E:function(){this.$FI&&this.$FI.$Hn?this.get_$D3().$VN(2,this.$FI.$18.get_$1J()===5?[_nbs.NonBootStrings.l_ModernGroupCardDirtyPopoutWarning_Text]:[_nbs.NonBootStrings.l_PersonaCardDirtyPopoutWarning_Text],this.$$d_$9hf,!1,_u.Strings.l_Yes_Text,_u.Strings.l_No_Text,_nbs.NonBootStrings.l_PopoutCardConfirmationPromptTile_Text):$4sW(this)},$49:function(){this.set_$wh(null);this.set_$l6(null);_a.$1.prototype.$49.call(this)},$9LF:function(){this.$3hY(this.$7f.$18)},$9QD:function(){this.$1vl(this.$7f.$18,this.$7f.get_$2Jn())},$9OJ:function(n,t){var i=this.$FI.$7Q;if(n)if(n.get_$1J()===1){_a.$6.$19(null,"SaveContact");_a.$6.endPT("SavePersona_"+this.$B.get_$L())}else if(n.get_$1J()===2){_a.$6.$19(null,"SaveGroup");_a.$6.endPT("SaveGroup_"+this.$B.get_$L())}if(this.$FI.get_$7c()){this.$FI.$Hn=!1;this.$FI.get_$7c()()}(i===3||i===1)&&n&&this.$7f&&this.$7f.$9Xi(n);this.set_$wh(null);i===2&&$Cq(this,"PersonaCreated",n)},$9hf:function(n,t){n&&$4sW(this)},$2JQ:function(n){var u=n.$Ar&&(n.$7Q===2||n.$7Q===3||n.$18.get_$BO()===3);if(u){var t=null;var i=null;var r=n.$18.get_$1J();switch(n.$7Q){case 2:switch(r){case 1:t="NewContact";i="NewContact";break;case 2:t="NewGroup";i="NewGroup";break;case 5:t="NewModernGroup";i="NewModernGroup";break}break;case 1:switch(r){case 1:t="EditContact";i="EditContact";break;case 2:t="EditGroup";i="EditGroup";break}break;case 0:t="OpenContact";i="OpenPersonCard_"+this.$B.get_$L();break;case 3:t="PersonCard.AddToContacts";break}t&&_a.$6.$19(null,t);i&&_a.$6.endPT(i)}},$9Xd:function(n,t){if(_d.$9N.isInstanceOfType(n)){var i=n;i.$Ar&&this.$2JQ(i)}},$9Yu:function(){this.$2JQ(this.$7f)},$32P:function(){this.set_$46W(!1)}};_d.$6z=function(){};_d.$6z.$gQ=function(n,t,i){_d.$6z.$4AY(0,n,t,i)};_d.$6z.$8SE=function(n,t,i){_d.$6z.$4AY(1,n,t,i)};_d.$6z.$8SD=function(n,t,i){_d.$6z.$4AY(n,100,t,i)};_d.$6z.$4AY=function(n,t,i,r){if(_a.$g.get_$RP()){var u=new _d.$14A(n,t,i,r);var f=_a.$6.$1X(_a.$0.$1u,"PeopleCard",!0);_a.$6.$19(f,"PeopleCard","","",u.$3Vg())}};_d.$6z.$8SF=function(n,t){if(_a.$g.get_$RP()){var i=new _d.$tC(0,n,t);var r=_a.$6.$1X(_a.$0.$1u,"RecipientCache",!0);_a.$6.$19(r,"RecipientCache","","",i.$3Vg())}};_d.$6z.$8SG=function(n,t){if(_a.$g.get_$RP()){var i=new _d.$tC(1,n,t);var r=_a.$6.$1X(_a.$0.$1u,"RecipientCache",!0);_a.$6.$19(r,"RecipientCache","","",i.$3Vg())}};_d.$6z.$8SH=function(n,t,i){if(_a.$g.get_$RP()){var r=new _d.$tC(2,n,t,i);var u=_a.$6.$1X(_a.$0.$1u,"RecipientCache",!0);_a.$6.$19(u,"RecipientCache","","",r.$3Vg())}};_d.$6z.$8S6=function(n,t,i){if(!_js.$8.$15(i)){var r=_a.$6.$1X(n,t,!0);_a.$6.$19(r,t,null,null,i)}};_d.$Aq=function(n){this.$$d_$A1m=Function.createDelegate(this,this.$A1m);this.$$d_$5SY=Function.createDelegate(this,this.$5SY);this.$$d_$7wn=Function.createDelegate(this,this.$7wn);this.$$d_$6IX=Function.createDelegate(this,this.$6IX);_d.$Aq.$$(this.$$gta["_d.$Aq"].T).initializeBase(this);this.$5SZ=n};_d.$Aq.$$=function(n){var t="$Aq"+"$1"+"$"+n.getName().replace(/\./g,"_");if(!_d[t]){var i=_d[t]=function(){(this.$$gta=this.$$gta||{})["_d.$Aq"]={T:n};for(var i=[],t=0;t<arguments.length;++t)i[t]=arguments[t];_d.$Aq.apply(this,i)};i.registerClass("_d."+t,_a.$FF);var u=_d.$Aq.prototype;for(var f in u){var r={key:f,value:u[f]};"constructor"!==r.key&&(i.prototype[r.key]=r.value)}i.$7kl=function(n,t,i){return new _0365m.$o(n,null,i,!0)};i.$A=_a.$0.$A7}return _d[t]};_d.$Aq.prototype={$vw:null,$2Aq:null,$1mK:null,$t:null,$5SZ:null,get_$2GY:function(){return this.$vw},set_$2GY:function(n){if(n!==this.$vw){this.$vw=n;$3(this,"ActionCommand")}return n},get_$4Yo:function(){return this.$2Aq},set_$4Yo:function(n){if(n!==this.$2Aq){this.$2Aq=n;$5(n)||this.$2Aq.$Y("IsShown",this.$$d_$6IX);$3(this,"SelectActionItemMenuViewModel")}return n},get_$3O:function(){return this.$t},$AJd:function(n,t){t||(t=_d.$Aq.$$(this.$$gta["_d.$Aq"].T).$7kl);if($5(n)||!n.length)this.$1t();else if(n.length===1){this.$1mK=null;this.set_$4Yo(null);this.set_$2GY(new _C(this.$$d_$7wn,_d.$Aq.$$(this.$$gta["_d.$Aq"].T).$A))}else{var r=n.length;this.$1mK=new Array(r);for(var i=0;i<r;++i){var u=new(_a.$CG.$$(_d.$5c.$$(this.$$gta["_d.$Aq"].T)))(n[i],this.$$d_$5SY);this.$1mK[i]=t(n[i].get_$1bP(),n[i].get_$AH9(),new _C(u.$$d_$AGx,_d.$Aq.$$(this.$$gta["_d.$Aq"].T).$A))}this.set_$4Yo(new _0365m.$2c(this.$1mK));this.set_$2GY(new _C(this.$$d_$A1m,_d.$Aq.$$(this.$$gta["_d.$Aq"].T).$A))}this.$t=n},$1t:function(){if(!$5(this.$1mK))for(var t=this.$1mK,i=t.length,n=0;n<i;++n){var r=t[n];r.$1R()}this.$1mK=null;this.set_$4Yo(null);this.set_$2GY(null);this.$t=null},$49:function(){this.$1t();_a.$1.prototype.$49.call(this)},$A1m:function(){this.$2Aq.set_$1O(!0)},$5SY:function(n){this.$5SZ(n.get_$AH9())},$7wn:function(){this.$5SY(this.$t[0])},$6IX:function(n,t){_d.$7l.$348=this.$2Aq.$30}};_d.$Ic=function(){this.$3sE=!1;this.$2Ly=!1;this.$2wA=!1;this.$2M1=!1;this.$1No=!1;this.$2wG=!1;this.$1bH=!1;this.$2wE=!1;this.$2M0=!1;this.$2wF=!0;this.$AD=8;this.$3sF=!1};_d.$Ic.get_$9gQ=function(){var n=new _d.$Ic;n.$3sE=!0;n.$2Ly=!0;n.$2M1=!0;n.$1No=!0;n.$2wG=!0;n.$2wE=!0;n.$1bH=!0;n.$2wA=!0;n.$5Pf=!0;n.$2wF=!1;n.$AD=0;return n};_d.$Ic.get_$9hT=function(){var n=new _d.$Ic;n.$3sE=!0;n.$2wA=!0;n.$2Ly=!0;n.$2M1=!0;n.$1No=!0;n.$2wG=!0;n.$1bH=!0;n.$2wE=!0;n.$2M0=!0;n.$2wF=!0;n.$AD=1;return n};_d.$Ic.prototype={$2wE:!1,$2M0:!1,$2Ly:!1,$2wA:!1,$2M1:!1,$3sE:!1,$1No:!1,$1bH:!1,$2wG:!1,$5Pf:!1,$AD:0,$2V:!0,$2wF:!1,$3sF:!1};_d.$30=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p){this.$$d_$6Jw=Function.createDelegate(this,this.$6Jw);this.$$d_$7ZE=Function.createDelegate(this,this.$7ZE);this.$$d_$9LG=Function.createDelegate(this,this.$9LG);this.$$d_$8QU=Function.createDelegate(this,this.$8QU);this.$$d_$3hY=Function.createDelegate(this,this.$3hY);this.$$d_$9Xm=Function.createDelegate(this,this.$9Xm);this.$3H7=_d.$30.$4hf;_d.$30.initializeBase(this,[n,t,i,r,f,e,s,c,a,v,p]);this.$2UE=o;this.$1H=u;this.$282=h;this.$1T1=y;this.$Ba=l};function $74v(n,t){return n.$2UE.$E(t)}function $74w(n){n.$e0=new _d.$1Q(new _d.$tB(n),0);n.$185=new _d.$1Q(new _d.$tB(n),1);n.$ow=new _d.$1Q(new _d.$tB(n),2)}function $74y(n){n.$e0.$wl();n.$185.$wl();n.$ow.$wl()}function $2lD(n){var t=new(_0365f.$n.$$(_0365m.$o));n.get_$327()||t.$D(n.get_$7Xv());n.get_$40x()||t.$D(n.get_$7ZF());if(n.$7E.$23R){n.$7E.$23R.$14.$1t();n.$7E.$23R.$14.$6S(t.$6W())}else n.$7E.set_$8UJ(new _0365m.$2c(t.$6W()))}function $74x(n,t){if(_a.$3q.$WP(t.get_$1l().EmailAddress)){var r=_a.$6.acss(_a.$0.$A7,"GetPersonaAction");n.set_$LV(!0);var i=_pc.$K3.$5MM(t.get_$1l());i.add_$2t(n.$$d_$6Jw);i.$FO=n.$8U.$AD;i.$2V=n.$8U.$2V;n.$k.$11(i);_a.$6.aces(r)}}function $4sb(n,t){var r=_a.$6.acss(_a.$0.$A7,"GetPersonaAction");var i=_pc.$K3.$5MN(t.get_$6P(),t.get_$rS());i.add_$2t(n.$$d_$6Jw);i.$FO=n.$8U.$AD;i.$2V=n.$8U.$2V;n.$k.$11(i);_a.$6.aces(r)}function $750(n){$4sb(n,n.$18)}function $74z(n){_a.$6.stPT(_a.$0.$AC,"PersonCard.ModernGroupPivot",5);_a.$6.$1X(_a.$0.$AC,"PersonCard.ModernGroupPivot",!1);var t=this;n.$1T1.$E(function(t){if(!n.$1T2){n.set_$9Hp(t.$7mr(n.$18,n.$184));n.$1T2.$Le()}})}_d.$30.prototype={$2UE:null,$282:null,$1H:null,$1T1:null,$e0:null,$185:null,$ow:null,$3Kx:null,$Ba:null,$8H3:null,$1T2:null,$QN:null,$CX:null,$3rL:null,$3gz:null,$3hd:null,$3hZ:null,$3ha:null,$49T:null,$40y:!1,get_$2bD:function(){this.$3Kx||(this.$3Kx=this.$282?this.$282.$E(this,this.$184):new _d.$4l(this,this.$184));return this.$3Kx},get_$9Hp:function(){return this.$1T2},set_$9Hp:function(n){if(n!==this.$1T2){this.$1T2=n;$3u(this,_d.$30.$6EW,_d.$30.$41D)}return n},get_$1Zc:function(){return this.$CX},set_$1Zc:function(n){if(this.$CX!==n){this.$CX&&this.$CX.$q("IsNotesLoaded",this.$$d_$9Xm);this.$CX=n;this.$CX&&this.$CX.$Y("IsNotesLoaded",this.$$d_$9Xm);$3(this,"CardNotesViewModel")}return n},get_$2Jn:function(){var n=_d.$7l.prototype.get_$2Jn.call(this);n.$nh=this.$CX.$nh;return n},get_$2ng:function(){return this.$Ba&&this.$Ba.$3L&&this.$Ba.$3L.get_$OC()?this.$Ba.$3L.get_$OC().get_$6p():""},get_$1yO:function(){return this.get_$327()&&this.get_$40x()?!0:!1},get_$40x:function(){return this.$8U.$5Pf||!this.$7E.get_$2CC()||this.get_$1yo()||!(this.$4J.get_$CK()?this.$4J.get_$CK().get_$8Je():!1)||this.$18.$7t0()||this.$18.get_$BO()!==3?!0:this.$40y},set_$40x:function(n){this.$40y!==n&&(this.$40y=n);return n},get_$327:function(){return this.$8U.$2wA?!0:!this.$7E.get_$2CC()||this.get_$nX()&&this.get_$nd()||this.$18.get_$BO()!==1&&(this.$18.get_$BO()!==3||!this.$18.$2PO())},get_$32H:function(){return this.$8U.$2Ly?!0:!this.$7E.get_$2CC()||this.get_$nX()&&this.get_$nd()||this.$18.get_$BO()!==3||this.$18.$2PO()},get_$5dA:function(){return!this.$7E.get_$2CC()},get_$8ES:function(){return!this.get_$46L()||!this.$1T2},get_$8Oo:function(){return this.$WJ&&this.$185.get_$3O().get_$C()>0&&this.$e0.get_$3O().get_$C()>0},get_$5jB:function(){return this.get_$C8()===0},get_$8LK:function(){return!1},get_$46L:function(){return this.$18.get_$1J()!==1||this.$3H7===_d.$30.$4hf?!1:this.get_$C8()===this.$3H7},get_$36Q:function(){return this.get_$C8()===1},get_$8Mv:function(){return this.get_$C8()===2},get_$5Al:function(){this.$3ha||(this.$3ha=new _C(this.$$d_$3hY,_d.$30.$A));return this.$3ha},get_$2UA:function(){this.$49T||(this.$49T=new _C(this.$$d_$8QU,_d.$30.$A));return this.$49T},get_$3Sg:function(){return this.$8U.$1bH?!1:!this.$18.$2PO()&&this.$18.get_$BO()===3},get_$8MK:function(){return!!this.$1H&&this.$1H.$3N("ModernGroups")},get_$A1A:function(){return this.$8U.$3sF?!1:this.$18.get_$1J()!==1?!1:this.get_$8MK()?this.$18.$40J():!1},get_$7Z9:function(){this.$3hZ||(this.$3hZ=new _y.$2Q(_y.$d.get_$7Xt(),_y.$d.get_$7Xu(),_u.Strings.l_AddMenuItem_LowerCase_Text,this.get_$5Al()));return this.$3hZ},get_$7qZ:function(){this.$3rL||(this.$3rL=new _y.$32(_u.Strings.l_DeleteItem_LowerCase_Text,this.get_$5Om()));return this.$3rL},$41:function(){_d.$OG.prototype.$41.call(this);this.$7E.set_$1yO(this.get_$1yO());this.set_$1Zc(new _d.$PI(this.$18,this.$8U,this.$B,this.$k));$2lD(this);$74w(this);$1Xe(this)},$5et:function(n){_d.$7l.prototype.$5et.call(this,n);$3(this,_d.$30.$4Qx)},$6KO:function(){_d.$7l.prototype.$6KO.call(this);$2lD(this);$He(this,[_d.$30.$48B,_d.$30.$5dB])},$9S6:function(){$2lD(this);_d.$7l.prototype.$9S6.call(this)},$7ZE:function(){this.$7E.set_$ax(!0);var i=this.$18.$5Xk();var n=new _g.$YA;n.GroupType="OtherContacts";var t=new _c.$12i(i,n);t.add_$2t(this.$$d_$9LG);this.$k.$11(t)},$9Xe:function(){$74y(this);this.set_$1Zc(new _d.$PI(this.$18,this.$8U,this.$B,this.$k));this.$7E.set_$1yO(this.get_$1yO());_d.$7l.prototype.$9Xe.call(this);$3(this,_d.$30.$48B)},$8Hn:function(){if(this.$18.get_$BO()===2&&this.$18.get_$6P()){this.set_$LV(!0);$4sb(this,this.$18)}else this.$18.get_$BO()!==1&&this.$18.get_$BO()!==2||$5(this.$18.get_$1l())||$5(this.$18.get_$1l().EmailAddress)||$74x(this,this.$18)},$8Hu:function(){this.get_$36Q()&&this.$CX.$Le();$750(this)},$5WP:function(n,t){n.val=[];t.val=null;if(this.$B.get_$L()!=="TouchNarrow"||!this.$8U.$2wG){this.get_$327()||this.get_$LV()||(n.val[n.val.length]=this.get_$7Z9());if(this.$18.get_$BO()===3){this.get_$3Sg()&&(t.val=[this.get_$7qZ()]);this.get_$327()&&!this.get_$32H()&&(n.val[n.val.length]=this.get_$5Qw());this.get_$1Ei()&&(n.val[n.val.length]=this.get_$3ml())}}},$9tM:function(){_d.$OG.prototype.$9tM.call(this);$He(this,[_d.$30.$5jC,_d.$30.$5kD,_d.$30.$4Qx,_d.$30.$5jy,_d.$30.$41D]);this.get_$C8()!==2||this.get_$2bD().$35X||this.get_$2bD().$85w(this.$18.get_$rS());this.get_$C8()===1&&this.$18.get_$BO()===3&&this.$CX.$Le();this.get_$46L()&&(this.$1T2||$74z(this))},$5Yv:function(){var n=new(_0365f.$n.$$(_a.$5V));n.$D(new _a.$5V(_nbs.NonBootStrings.l_PersonaCardInformationPivotOption_Text,null));n.$D(new _a.$5V(_nbs.NonBootStrings.l_PersonaCardNotesPivotOption_Text,null));this.$18.get_$1J()===1&&this.$18.get_$rS()&&this.$18.$40J()&&n.$D(new _a.$5V(_nbs.NonBootStrings.l_PersonaCardOrganizationPivotOption_Text,null));if(this.$18.get_$40V()){n.$D(new _a.$5V(_nbs.NonBootStrings.l_PersonaCardLocationPivotOption_Text,null));$4sC(this,n.get_$C()-1)}if(this.get_$A1A()){n.$D(new _a.$5V(_nbs.NonBootStrings.l_PersonaCardModernGroupMembershipPivotOption_Text,null));this.$3H7=n.get_$C()-1}return n.$6W()},$86K:function(){return this.get_$5jB()?20:this.get_$36Q()?21:this.get_$8Mv()?22:this.get_$46L()?27:this.get_$469()?26:100},get_$7Xv:function(){this.$3gz||(this.$3gz=new _0365m.$o(_nbs.NonBootStrings.l_AddToContact_LowerCase_Text,null,this.get_$5Al()));return this.$3gz},get_$7ZF:function(){this.$3hd||(this.$3hd=new _0365m.$o(_nbs.NonBootStrings.l_AddToLyncContact_LowerCase_Text,null,new _C(this.$$d_$7ZE,_d.$30.$A)));return this.$3hd},$3hY:function(){$6J(this,"AddToContactsClicked")},$9LG:function(n){var t=n;if(t.$1d)this.get_$D3().$2u(0,_nbs.NonBootStrings.l_AddToLyncContactError_LowerCase_Text,null);else{this.set_$40x(!0);$2lD(this)}this.$7E.set_$ax(!1)},$6Jw:function(n){var t=n;this.set_$LV(!1);if(!t.$1d){$5(this.get_$4Sl())||(this.get_$4Sl().$1fy=!0);var i=_a.$6.acss(_a.$0.$A7,"SetFullPersona");this.set_$1u(t.$18);this.get_$36Q()&&this.$18.get_$BO()===3&&this.$CX.$Le();_a.$6.aces(i)}this.$9S6();_a.$6.$19(null,"NavigateToPeople",t.$1d?t.$1d.message:null);_a.$6.endPT("NavigateToPeopleHub_"+this.$B.get_$L());_a.$6.$19(null,"PeoplePicker",t.$1d?t.$1d.message:null);_a.$6.endPT("PeoplePicker")},$9Xm:function(n,t){this.$CX.$1QA&&this.$CX.$nh&&this.$ow&&this.$ow.$wl()},$8QU:function(){_a.$g.$2Dw("VM.PersonCard.ContactLinking");if(!this.$18||this.$18.get_$BO()!==3){this.get_$D3().$2u(0,_nbs.NonBootStrings.l_LinkSummaryCardCannotBeLaunched_Text,null);return}this.$QN?this.$QN.$6dI(this.$18):this.$QN=$74v(this,this.$18);this.$B.$7C(this.$QN);this.get_$6Qh()==="Mouse"&&this.$5I8()}};_d.$9N=function(n,t,i,r,u,f,e,o,s){this.$$d_$5I8=Function.createDelegate(this,this.$5I8);this.$$d_$1Tb=Function.createDelegate(this,this.$1Tb);this.$$d_$6Rw=Function.createDelegate(this,this.$6Rw);_d.$9N.resolveInheritance();this.apcl=this.$Y;this.rpcl=this.$q;_d.$9N.initializeBase(this);this.$18=n;this.$mt=f;this.$hC=o;this.$B=r;this.$k=u;this.$8U=i;this.$7Q=t;this.$6M=e;this.$184=s};function $1Xe(n){n.get_$5ir()&&n.$8Hn()}function $2FQ(n){if(n.$3y){var t;var i;var r,u;n.$5WP(r={val:t},u={val:i});t=r.val;i=u.val;n.$3y.set_$I3(t);n.$3y.set_$bB(i);$3(n,"ApplicationBarViewModel")}}_d.$9N.prototype={$hC:null,$B:null,$6M:null,$k:null,$7Q:0,$8U:null,$184:null,$mt:!1,$1v:null,$18:null,$3m:null,$JA:null,$3y:null,$Ar:!1,$3ms:null,$EF:!1,$7j:!1,add_$6II:function(n){this.$2G("ClosePopup",n)},remove_$6II:function(n){this.$2H("ClosePopup",n)},get_$6k:function(){return this.$3y},set_$6k:function(n){if(this.$3y!==n){this.$3y=n;$3(this,"ApplicationBarViewModel")}return n},get_$KN:function(){return 2},get_$D3:function(){this.$1v||(this.$1v=new _y.$4p);return this.$1v},get_$4hW:function(){return this.$18.get_$1J()},get_$1u:function(){return this.$18},set_$1u:function(n){this.$18=n;this.$9Xe();$1Xe(this);$3(this,_d.$9N.$6Qs);return n},get_$6Qh:function(){return this.$B.get_$L()},get_$Dl:function(){return this.$Ar},set_$Dl:function(n){this.$Ar!==n&&(this.$Ar=n);$3(this,"IsVisible");return n},get_$nd:function(){return!_a.UserAgent.getInstance().$d2},get_$3KT:function(){return null},get_$3KV:function(){return null},get_$dC:function(){return this.$B.get_$L()!=="Mouse"},get_$1kp:function(){return 0},get_$2PH:function(){return this.$$d_$1Tb},get_$4h:function(){return this.$3m},set_$4h:function(n){this.$3m=n;return n},get_$7c:function(){return this.$JA},set_$7c:function(n){this.$JA=n;return n},get_$7sU:function(){return!0},get_$1tX:function(){this.$3ms||(this.$3ms=new _C(this.$$d_$5I8,_d.$9N.$A));return this.$3ms},get_$dD:function(){return this.$EF},set_$dD:function(n){if(n!==this.$EF){this.$EF=n;$3(this,"IsTransitionedIn")}return n},get_$5ir:function(){return!this.$mt},$41:function(){if(this.$7j){var n="Initialize should be called on any given instance only once.";_js.Trace.logError(_d.$9N.$A,n)}this.$7j=!0;this.$B.get_$L()!=="Mouse"&&this.set_$6k(this.$1aU())},$5et:function(n){this.set_$6k(null)},$6Rw:function(){this.$184.$6E()},$e6:function(){},$FZ:function(){this.set_$Dl(!0);this.set_$dD(!0)},$l1:function(){this.set_$Dl(!1);this.set_$dD(!1)},$TZ:function(){},$1aU:function(){_js.Trace.logInfo(_a.$0.$A7,"PersonaCardViewModelBase::CreateApplicationBarViewModel - Layout: {0}",this.$B.get_$L());var n;var t;var i,r;this.$5WP(i={val:n},r={val:t});n=i.val;t=r.val;return _y.$22.$Aj(this,n,t)}};_d.$7l=function(n,t,i,r,u,f,e,o,s,h){this.$$d_$7rG=Function.createDelegate(this,this.$7rG);this.$$d_$7rH=Function.createDelegate(this,this.$7rH);this.$$d_$A84=Function.createDelegate(this,this.$A84);this.$$d_$9hQ=Function.createDelegate(this,this.$9hQ);this.$$d_$7cV=Function.createDelegate(this,this.$7cV);this.$$d_$7qg=Function.createDelegate(this,this.$7qg);this.$$d_$5bA=Function.createDelegate(this,this.$5bA);this.$$d_$1Nl=Function.createDelegate(this,this.$1Nl);this.$$d_$5Kl=Function.createDelegate(this,this.$5Kl);_d.$7l.initializeBase(this,[n,0,t,r,u,e,o,s,h]);this.$4J=f;this.$169=i;this.$1Pt=!0;this.$WJ=!1;this.set_$4K(!0)};function $75h(n){n.$7E.set_$kx(n.$5Yv())}function $4sp(n){var t=n.$5Yv();$75g(n,t)&&n.$7E.set_$kx(t)}function $2lI(n){n.$7E.set_$4Bz(new _0365m.$2c(n.$819()))}function $75i(n){n.$7E=n.$hC.$7nO(n.$18,n.$7Q,n.$8U,n.$169);n.$7E.set_$32H(n.get_$32H());n.$7E.set_$1yO(!0);n.$7E.set_$329(!n.get_$3Sg());n.$7E.add_$9hP(n.$$d_$9hQ);n.$7E.add_$A85(n.$$d_$A84);n.$7E.add_$6Rx(n.$$d_$6Rw)}function $75g(n,t){return!n.$7E.$Hz&&!t?!1:n.$7E.$Hz&&t?n.$7E.$Hz.length!==t.length:!0}function $75j(n){var t=n.$86K();_d.$6z.$8SE(t,n.$8U.$AD,n.get_$4hW())}function $75f(n){return n.$18.$8Cm()?[String.format(_nbs.NonBootStrings.l_DeletePersonaMessageFirstLine_Text,n.get_$4Sl().$Gx),_nbs.NonBootStrings.l_DeletePersonaMessageSecondLine_Text]:[String.format(_nbs.NonBootStrings.l_DeletePersonaMessageFirstLine_Text,n.get_$4Sl().$Gx)]}function $75k(n,t){var i=new _pc.$6C;i.set_$sK(!0);i.set_$1o("Outlook");i.set_$r(!1);t.get_$3p()||t.set_$3p(new _js.$c);if(t.$5by()){i.set_$1y(t.get_$3p().get_$C().toString());t.get_$3p().$D(i);t.get_$UO()&&t.get_$UO().$D(t.get_$UO().get_$3o(0),t.get_$3p().get_$C().toString())}else for(var u=t.get_$3p().get_$C(),r=0;r<u;r++){var f=t.get_$3p().get_$3o(r);if(f.get_$1o()==="GAL"){i.set_$1y(r.toString());t.get_$3p().set_$3o(r,i);break}}if(t.get_$1l()){t.set_$UO(new(_pc.$1F.$$(_g.$1q)));t.get_$UO().$D(t.get_$1l(),(t.get_$3p().get_$C()-1).toString())}return t}_d.$7l.prototype={$169:null,$7E:null,$1vh:null,$12x:null,$Jm:null,$2V:!1,$WJ:!1,$4J:null,$2vM:null,$1Pt:!1,$yL:!1,add_$5Ak:function(n){this.$2G("AddToContactsClicked",n)},remove_$5Ak:function(n){this.$2H("AddToContactsClicked",n)},add_$5Oq:function(n){this.$2G("DeleteSucceeded",n)},remove_$5Oq:function(n){this.$2H("DeleteSucceeded",n)},add_$3J4:function(n){this.$2G("OnBack",n)},remove_$3J4:function(n){this.$2H("OnBack",n)},add_$2bq:function(n){this.$2G("PersonaInCompletedState",n)},remove_$2bq:function(n){this.$2H("PersonaInCompletedState",n)},get_$7uo:function(){return this.$7E.get_$1be()},get_$5Om:function(){this.$Jm||(this.$Jm=new _C(this.$$d_$1Nl,_d.$7l.$A));return this.$Jm},get_$9hi:function(){return this.$7E.get_$4TY()},get_$KN:function(){switch(this.$B.get_$L()){case"TouchWide":return 1;case"TouchNarrow":return 2;default:return 0}},get_$2Jn:function(){var n=new _d.$R7;n.$5Q9=this.get_$4Sl().get_$2wd();n.$5pk=!0;n.$5kh=this.get_$nX();return n},get_$nX:function(){return this.$7E.$15Y},get_$4Sl:function(){return this.$7E.$73},get_$4K:function(){return this.$8U.$2M0?!0:this.$2V},set_$4K:function(n){this.$2V=n;this.$7E&&this.$7E.set_$4K(n);this.$WJ&&(_d.$7l.$5gy=n);$He(this,["IsExpanded","IsHoverCardExpanded"]);return n},get_$35a:function(){return this.$WJ},set_$35a:function(n){this.$WJ=n;if(this.$7E){this.$7E.set_$A0b(n);this.$7E.set_$35a(n)}$3(this,"IsHoverCard");return n},get_$5j2:function(){return this.get_$ja()&&this.get_$4K()?!0:!1},get_$1Ei:function(){return this.$WJ&&this.$B.get_$L()==="TouchWide"},get_$8Og:function(){return this.$WJ&&this.$B.get_$L()!=="Mouse"},get_$C8:function(){return this.$7E.$Lz},get_$1yo:function(){return this.get_$4Sl()?this.get_$4Sl().$UF.get_$1yo():!0},get_$5O6:function(){return this.$2vM},set_$5O6:function(n){if(this.$2vM!==n){this.$2vM=n;$3(this,"DefaultEmailAddress")}return n},get_$ja:function(){return this.$8U.$2M0?!1:this.$1Pt},set_$ja:function(n){this.$1Pt=n;this.$6KO();$He(this,["IsExpandable","IsHoverCardExpanded"]);return n},get_$2SJ:function(){return this.$8U.$AD===9},get_$20r:function(){return!this.$8U.$AD},get_$46p:function(){return this.$8U.$AD===1},get_$LV:function(){return this.$yL},set_$LV:function(n){if(this.$yL!==n){this.$yL=n;$He(this,["IsCardLoading","HidePersonaActions","HideNameControlForMouse"]);this.$9Tl()}return n},get_$1Dn:function(){return this.$8U.$1No||this.get_$LV()?!0:!1},get_$5Qw:function(){this.$1vh||(this.$1vh=new _y.$2Q(_y.$d.get_$cn(),_y.$d.get_$2MX(),_nbs.NonBootStrings.l_EditMenuItem_LowerCase_Text,this.get_$7uo()));return this.$1vh},get_$3ml:function(){this.$12x||(this.$12x=new _y.$2Q(_y.$d.get_$9J(),_y.$d.get_$LH(),_nbs.NonBootStrings.l_Close_LowerCase_Text,this.get_$1tX()));return this.$12x},get_$7qh:function(){return _nbs.NonBootStrings.l_DeletePersonaConfirmationPromptTile_Text},$41:function(){$75i(this);!this.get_$dC()&&this.get_$4Sl()&&this.get_$4Sl().$UF.add_$9Kx(this.$$d_$5bA);$2lI(this);$75h(this);this.$7E.set_$C8(0);_d.$9N.prototype.$41.call(this)},$5et:function(n){_d.$9N.prototype.$5et.call(this,n);this.set_$ja(n.get_$ja());this.$7E.set_$C8(n.get_$C8());this.$7E.set_$20w(n.get_$nX())},$1Nl:function(){if(!this.$8NB()){this.get_$D3().$2u(0,_nbs.NonBootStrings.l_WaitAndRetry_Text,null);return}if(!this.get_$3Sg()){this.get_$D3().$2u(0,String.format(_nbs.NonBootStrings.l_DeletePersonaFailed_Text,this.get_$4Sl().$Gx),null);return}this.get_$D3().$VN(2,$75f(this),this.$$d_$7qg,!1,_u.Strings.l_Delete_LowerCase_Text,_u.Strings.l_CancelButtonLabel_LowerCase_Text,this.get_$7qh())},$9S6:function(){$4sp(this);$2lI(this);this.$7E.set_$C8(this.$7qN());$2FQ(this);$6J(this,"PersonaInCompletedState")},$9Xi:function(n){this.get_$4Sl()&&(this.get_$4Sl().$1fy=!0);this.set_$1u(n);$2FQ(this);$2lI(this);this.$8Hu()},$5I8:function(){if(!this.get_$nX()){$6J(this,"ClosePopup");this.get_$7c()&&this.get_$7c()()}},$6KO:function(){this.$7E.set_$ja(this.get_$ja());$2lI(this)},$4Qj:function(n){try{this.$6M.$TS(n);_d.$6z.$gQ(14,this.$8U.$AD,this.$18.get_$1J())}catch(t){_js.Trace.logException(_d.$7l.$A,t,"Failed to open URL")}},$7YC:function(){if(this.$4J&&this.$B.get_$L()==="Mouse"){var n=this;this.$4J.add_$gz(function(){if(!n.$B7&&n.$4J.get_$gC()&&n.get_$4Sl()){var t=n.get_$4Sl().$UF;n.$4J.get_$CK().apcl("SignInState",t.$$d_$5lp||(t.$$d_$5lp=Function.createDelegate(t,t.$5lp)))}})}},$9nf:function(){if(this.$4J&&this.$B.get_$L()==="Mouse"){var n=this;this.$4J.add_$gz(function(){if(n.$4J.get_$gC()&&n.get_$4Sl()){var t=n.get_$4Sl().$UF;n.$4J.get_$CK().rpcl("SignInState",t.$$d_$5lp||(t.$$d_$5lp=Function.createDelegate(t,t.$5lp)))}})}},$9Xe:function(){this.$7E.set_$32H(this.get_$32H());this.$7E.set_$329(!this.get_$3Sg());this.$7E.set_$1u(this.$18)},$8Hu:function(){},$9Tl:function(){this.$7E.set_$LV(this.get_$LV())},$1Tb:function(n,t){this.get_$nX()||$6J(this,"ClosePopup");return!1},$5Kl:function(n){if(n.get_$1J()!==2&&!n.get_$6P()){n.set_$BO(1);n=$75k(this,n)}this.$184.$1JZ(n)},$7qN:function(){return 0},$1aU:function(){var n=_d.$9N.prototype.$1aU.call(this);this.$B.get_$L()==="TouchNarrow"&&n.$i1(new _C(this.$$d_$7cV,_d.$7l.$A));return n},$5WP:function(n,t){n.val=[];t.val=null;this.get_$1Ei()&&(n.val[n.val.length]=this.get_$3ml())},$819:function(){var n=[];this.get_$3Sg()&&(n[n.length]=new _0365m.$o(_u.Strings.l_Delete_LowerCase_Text,null,new _C(this.$$d_$1Nl,_d.$7l.$A)));return n},$8NB:function(){return this.$18.get_$BO()===3},$5bA:function(){this.get_$dC()||$6J(this,"ClosePopup")},$9hQ:function(n){$3(this,"PivotSelectedOptionIndex");this.$9tM();$75j(this)},$7qg:function(n,t){if(n){var i=new _pc.$wS(this.$18.get_$6P());i.add_$29(this.$$d_$7rH);i.add_$21(this.$$d_$7rG);i.$FO=this.$8U.$AD;this.$k.$11(i);this.get_$7c()&&this.get_$7c()()}},$7rH:function(n){var t=n.$Ci;_a.$3.$K(t,"personaId");$BF(this,"DeleteSucceeded",this,t)},$7rG:function(n){n.$1d&&this.get_$D3().$2u(0,String.format(_nbs.NonBootStrings.l_DeletePersonaFailed_Text,this.get_$4Sl().$Gx),null)},$A84:function(n){this.set_$4K(n);_d.$6z.$gQ(31,this.$8U.$AD,this.get_$4hW())},$7cV:function(){$6J(this,"OnBack");if(this.get_$7c()){$6J(this,"ClosePopup");this.get_$7c()()}}};_d.$8C=function(n,t,i,r,u){this.$$d_$2ao=Function.createDelegate(this,this.$2ao);this.$$d_$6ZD=Function.createDelegate(this,this.$6ZD);this.$$d_$5I9=Function.createDelegate(this,this.$5I9);this.$$d_$6M6=Function.createDelegate(this,this.$6M6);this.$$d_$1Tb=Function.createDelegate(this,this.$1Tb);_d.$8C.initializeBase(this);this.$B=n;this.$1kW=t;this.$7F=i;this.$DM=r;this.set_$6V0(u);this.set_$6k($75w(this));this.$Q3=new _y.$4p};function $3bf(n){n.$yM=!1;n.$1Pg=!1;n.get_$bn().get_$6A().set_$7D("");n.get_$bn().get_$6A().set_$Hr(!1);n.get_$bn().get_$6A().set_$ZO(!1);n.get_$N0().$78()}function $4sw(n){n.$5bi()}function $75w(n){switch(n.$B.get_$L()){case"TouchWide":return $75v(n);case"TouchNarrow":return $75u(n)}return null}function $75u(n){var t=_y.$22.$Aj(n,null,null);t.set_$15w([t.$i1(n.get_$1bJ()),t.$12E()]);t.set_$I3([new _y.$2Q(_y.$d.get_$2r(),_y.$d.get_$2z1(),_u.Strings.l_Folders_Text,n.get_$N0().get_$5Uo())]);t.set_$bB($75x(n));t.set_$4Yi(n.get_$N0().get_$113());return t}function $75v(n){var t=_y.$22.$Aj(n,null,null);t.set_$15w([t.$12E()]);t.set_$I3([new _y.$2Q(_y.$d.get_$wa(),_y.$d.get_$1Zl(),_nbs.NonBootStrings.l_AcceptItem_LowerCase_Text,n.get_$uh()),new _y.$2Q(_y.$d.get_$9J(),_y.$d.get_$LH(),_nbs.NonBootStrings.l_Discard_LowerCase_Text,n.get_$1bJ())]);t.set_$4Yi(n.get_$N0().get_$113());return t}function $75x(n){return[n.get_$N0().$5MB()]}function $4sx(n,t){t?n.set_$1tm(_nbs.NonBootStrings.l_LeaveConfirmationDialogTitle_PeoplePicker_Text):n.set_$1tm(_nbs.NonBootStrings.l_CancelConfirmationDialogTitle_PeoplePicker_Text);n.set_$7ie($75y(n,t));n.set_$1zf(!0)}function $75y(n,t){var i=new _js.$c;var r=this;i.$D(new _a.$2E(new _C(function(){n.set_$1zf(!1);t&&$4sw(n);n.$yM=!0;n.$4Tl()},_d.$8C.$A),_nbs.NonBootStrings.l_Ok_LowerCase_Text,""));if(t){var u=this;i.$D(new _a.$2E(new _C(function(){n.set_$1zf(!1);n.$yM=!0;n.$4Tl()},_d.$8C.$A),_nbs.NonBootStrings.l_DiscardAndCloseDialogButton_PeoplePicker_Text,""))}var f=this;i.$D(new _a.$2E(new _C(function(){n.set_$1zf(!1)},_d.$8C.$A),_u.Strings.l_CancelButtonText_Text,""));return i}_d.$8C.prototype={$1kW:null,$7F:null,$B:null,$Q3:null,$18Q:null,$JA:null,$DM:null,$dy:null,$EW:null,$DO:null,$4jC:null,$4X:null,$1Pg:!1,$2RR:!1,$wn:null,$2Jt:null,$4Tl:null,$yM:!1,add_$1m4:function(n){this.$2G("SaveCompleted",n)},remove_$1m4:function(n){this.$2H("SaveCompleted",n)},add_$6RD:function(n){this.$2G("PickerClosed",n)},remove_$6RD:function(n){this.$2H("PickerClosed",n)},get_$1kp:function(){return 1},get_$7c:function(){return this.$JA},set_$7c:function(n){this.$JA=n;return n},get_$7sU:function(){return!0},get_$2PH:function(){return this.$$d_$1Tb},get_$N0:function(){if(!this.$dy){this.$dy=this.$1kW.$7nJ();this.$dy.add_$2bv(this.$$d_$6M6)}return this.$dy},get_$1bJ:function(){this.$EW||(this.$EW=new _C(this.$$d_$5I9,_d.$8C.$A));return this.$EW},get_$uh:function(){this.$DO||(this.$DO=new _C(this.$$d_$6ZD,_d.$8C.$A));return this.$DO},get_$6V0:function(){return this.$18Q},set_$6V0:function(n){if(this.$18Q!==n){this.$18Q=n;$3(this,"RecipientWellLabel")}return n},get_$bn:function(){if(!this.$4X){var n=null;this.$DM&&this.$DM.get_$C()>0&&this.$B.get_$L()!=="TouchNarrow"&&(n=this.$DM.$3g());this.$4X=this.$7nd(this.$7F,n);this.$4X.set_$4bV(!1);this.$4X.$1U.add_$1Y(this.$$d_$2ao)}return this.$4X},get_$6pJ:function(){this.$4jC||(this.$4jC=this.get_$N0().$5aA());return this.$4jC},get_$KN:function(){return this.$B.get_$L()!=="Mouse"?1:0},get_$1zf:function(){return this.$2RR},set_$1zf:function(n){if(n!==this.$2RR){this.$2RR=n;$3(this,"IsConfirmDialogShown")}return n},get_$7ie:function(){return this.$2Jt},set_$7ie:function(n){if(n!==this.$2Jt){this.$2Jt=n;$3(this,"ConfirmDialogButtonData")}return n},get_$1tm:function(){return this.$wn},set_$1tm:function(n){if(n!==this.$wn){this.$wn=n;$3(this,"ConfirmDialogTitle")}return n},get_$au:function(){return _a.UserAgent.getInstance().$Mi},$e6:function(){_y.$1Mq.prototype.$e6.call(this);this.get_$N0().$5m()},$TZ:function(){_y.$1Mq.prototype.$TZ.call(this);var n=this;_js.$J.get_$I().$40(_a.$0.$dz,"RichPeoplePicker.PostTransitionOut",function(){$6J(n,"PickerClosed")})},$6ni:function(n){this.get_$bn().$1U.$1t();if(this.$B.get_$L()!=="TouchNarrow"&&n&&n.get_$C()>0){var t=this;n.$Bd(function(n){if(_y.$E5.isInstanceOfType(n)){var i=n;i.$Ne?t.get_$bn().$1rU(i.$CB):t.get_$bn().$2Gt(i.$CB)}})}this.$yM=!1;this.$1Pg=!1},$7nd:function(n,t){return n.$2uB(_d.$KE.$29W,_y.$17.$XR,t)},$5bi:function(){this.$1Pg&&$Cq(this,"SaveCompleted",this.get_$bn().$1U)},$6M6:function(n){if(n.get_$1l()){_a.$3q.$WP(_g.$2R.$xn(n.get_$1l()))||n.get_$1l().RoutingType==="MAPIPDL"?this.get_$bn().$1rU(n):this.get_$bn().$2Gt(n);this.$B.get_$L()==="TouchNarrow"&&this.$6ZD()}else{if(this.$B.get_$L()==="TouchNarrow"){this.get_$N0().get_$1Hx().set_$1p(null);this.get_$N0().get_$pF().set_$1p(null)}this.$Q3.$2u(0,_nbs.NonBootStrings.l_NoEmailAddressError_PeoplePicker_Text,null)}},$49:function(){if(this.$dy&&Sys.IDisposable.isInstanceOfType(this.$dy)){this.$dy.dispose();this.$dy=null}_a.$1.prototype.$49.call(this)},$5I9:function(){this.$JA()},$1Tb:function(n,t){if(this.$yM){$3bf(this);return!1}this.$4Tl=n;if(this.$1Pg){$4sx(this,!0);return!0}if(t===1||!t){$4sx(this,!1);return!0}$3bf(this);return!1},$2ao:function(n,t){this.$1Pg=!0},$6ZD:function(){this.$yM=!0;$4sw(this);this.$5I9();$3bf(this)}};_d.$mY=function(n,t,i){this.$B=n;this.$1kW=t;this.$7F=i};_d.$mY.prototype={$B:null,$1kW:null,$7F:null,$5M1:function(n,t){return new _d.$8C(this.$B,this.$1kW,this.$7F,n,t)}};_d.$5r=function(){};_d.$5r.$5Yu=function(n,t,i,r,u,f){if(!n)throw Error.argumentNull("cacheTable invalid");if(!t)throw Error.argumentNull("querystring invalid");var e=[];if(""===t.trim()||!i)return e;for(var h=0,o=null,c=0;c<n.$1w.get_$C()&&h<i;c++){var s=n.$1w.get_$3o(c);if(s&&_d.$5r.$8NA(s,t,r,u))if(f){o?o.set_$1u(s):o=new _d.$w7(s,f,"");for(var a=!1,v=e.length,l=0;l<v;l++)if(e[l].toLowerCase()===o.get_$1bP().toLowerCase()){a=!0;break}if(!a){Array.add(e,o.get_$1bP());h++}}else{Array.add(e,s);h++}}return e};_d.$5r.$3yW=function(n,t,i,r){return _d.$5r.$5Yu(_pc.$15.$jD(),n,t,i,null,r)};_d.$5r.$A9x=function(n,t){return t.$np?_d.$5r.$86O(n,t):null};_d.$5r.$5AM=function(n,t){if(n){_a.$3.$K(n.get_$1l(),"Persona with no email address can't be added to the cache");if(n.get_$1l().RoutingType==="SMTP"&&n.get_$1l().EmailAddress&&_a.$3q.$WP(n.get_$1l().EmailAddress)){t.$1w.$D(n);var i=new Array(0);n.$AF4();Array.add(i,_d.$5r.$1Ot("PersonaDisplayNames","",n.get_$1o()));Array.add(i,_d.$5r.$1Ot("PersonaSurnames","",n.get_$1WS()));Array.add(i,_d.$5r.$1Ot("PersonaMiddleNames","",n.get_$2ZA()));Array.add(i,_d.$5r.$1Ot("PersonaGivenNames","",n.get_$1xo()));Array.add(i,_d.$5r.$1Ot("PersonaEmails1","",n.get_$1l().EmailAddress));Array.add(i,_d.$5r.$1Ot("PersonaEmails1DisplayNames","",n.get_$1l().Name));Array.add(i,_d.$5r.$1Ot("PersonaType","",_h.$Ar.toString(n.get_$1J())));n.get_$1l().MailboxType==="Mailbox"&&Array.add(i,_d.$5r.$1Ot("PersonaImAddresses","",n.get_$Al()));var r=new _pc.$jd(n.get_$6P(),i,new _g.$CI(new _g.$7N("recipientcache")),_h.$Ar.toString(1));OwaApplication.$1W.$11(r)}}};_d.$5r.$7rK=function(n,t){for(var r=t.$1w.get_$C(),i=0;i<r;i++){var u=t.$1w.get_$3o(i);if(_pc.$l.$1rv(n,u)){t.$1w.$6C(i);return}}};_d.$5r.$86O=function(n,t){if(!t.$np)throw Error.invalidOperation("IsPersonaInRecipientCache should not be called if the cache was not loaded!");for(var u=t.$1w.get_$C(),i=0;i<u;i++){var r=t.$1w.get_$3o(i);if(_pc.$l.$31V(n,r))return r}return null};_d.$5r.$8Il=function(n,t){return _d.$5r.$1eK(n.get_$1o(),t,0)||_d.$5r.$5kc(n,t,0)||_d.$5r.$1eK(n.get_$1l().EmailAddress,t,0)?!0:!1};_d.$5r.$86N=function(n,t){for(var r=n.get_$C(),i=0;i<r;i++)if(n.get_$3o(i)&&_d.$5r.$1eK(n.get_$3o(i).EmailAddress,t,0))return i;return-1};_d.$5r.$8NA=function(n,t,i,r){if(r&&!r(n))return!1;if(_d.$5r.$1eK(n.get_$1o(),t,i)||_d.$5r.$1eK(n.get_$Eu(),t,i)||_d.$5r.$5kc(n,t,i))return!0;if(n.get_$6G())for(var f=n.get_$6G().length,u=0;u<f;u++)if(_d.$5r.$1eK(n.get_$6G()[u].EmailAddress,t,i))return!0;return!1};_d.$5r.$1eK=function(n,t,i){if(!_js.$8.$15(n)){t=t.toLocaleLowerCase();if(i===1&&n.toLowerCase()===t||!i&&n.toLowerCase().startsWith(t))return!0}return!1};_d.$5r.$5kc=function(n,t,i){if(!_js.$8.$15(n.get_$1o()))for(var u=n.get_$1o().split(" "),f=u.length,r=0;r<f;r++)if(_d.$5r.$1eK(u[r],t,i))return!0;return!1};_d.$5r.$1Ot=function(n,t,i){var r=new _g.$KR(new _g.$1V(n));r.OldValue=t;r.NewValue=i;return r};_d.$5r.$59H=function(){};_d.$5r.$59H.prototype={$86u:function(n,t,i,r){return _d.$5r.$3yW(n,t,i,r)}};_d.$5a=function(n,t,i,r,u,f){this.$$d_$5TV=Function.createDelegate(this,this.$5TV);this.$$d_$9Qr=Function.createDelegate(this,this.$9Qr);this.$$d_$AEI=Function.createDelegate(this,this.$AEI);this.$$d_$AEJ=Function.createDelegate(this,this.$AEJ);this.$$d_$3LM=Function.createDelegate(this,this.$3LM);this.$$d_$2Gv=Function.createDelegate(this,this.$2Gv);this.$$d_$1dN=Function.createDelegate(this,this.$1dN);this.$$d_$2wn=Function.createDelegate(this,this.$2wn);this.$$d_$3Pz=Function.createDelegate(this,this.$3Pz);this.$$d_$1Tb=Function.createDelegate(this,this.$1Tb);this.$$d_$6Ix=Function.createDelegate(this,this.$6Ix);this.$$d_$2sg=Function.createDelegate(this,this.$2sg);this.$$d_$4Q5=Function.createDelegate(this,this.$4Q5);this.$$d_$9Xu=Function.createDelegate(this,this.$9Xu);this.$$d_$9Xv=Function.createDelegate(this,this.$9Xv);this.$$d_$9NR=Function.createDelegate(this,this.$9NR);this.$Xl=0;_d.$5a.initializeBase(this);if(_js.$8.$a(r))throw Error.argumentNull("emailAddress");this.$B=n;this.$k=t;this.$c=i;this.set_$6k($76r(this));this.$B6=r.toLocaleLowerCase();this.$28l=_d.$5a.$82z(r);this.$37p=u;this.$5BU=f;this.set_$2QH(this.$28l+"&isPreview=false")};_d.$5a.$5L1=function(n,t,i){return new _d.$5a(n,t,i,_g.$V.get_$I().get_$2z().get_$AM(),!0,!1)};_d.$5a.$5L3=function(n,t,i,r){return new _d.$5a(t,i,r,n,!1,!0)};_d.$5a.$82z=function(n){n=n.toLowerCase();var t=String.format("service.svc/s/GetUserPhoto?email={0}",encodeURIComponent(n));t+="&size="+String.format("HR{0}x{1}",240,240);return t};function $76r(n){var t;t=n.get_$2J5()?[n.get_$4Y3(),n.get_$5OZ(),n.get_$3lT()]:[n.get_$3lT()];return _y.$22.$Aj(n,t,null)}function $2FR(n,t,i,r){return new _pc.$1H4(t,i,r,n.$B6,!n.$37p)}function $76t(n,t){var i=new _at.$wx;i.$4V4(t,n.$$d_$9Qr,n.$$d_$5TV,_d.$5a.$hl)}function $76s(n,t){var i=null;switch(t){case 1:i=_nbs.NonBootStrings.l_CannotAttachFilesInSnapView_Text;break;case 0:i=_nbs.NonBootStrings.l_AttachmentFileReadError_Text;break;default:break}_js.$8.$a(i)||n.get_$D3().$2u(0,i,null)}_d.$5a.prototype={$B:null,$k:null,$c:null,$28l:null,$1PM:null,$RR:null,$1v:null,$2b6:null,$yp:!1,$1WH:0,$2by:null,$B6:null,$37p:!1,$5BU:!1,$DO:null,$7I:null,$Jm:null,$r3:null,$1EC:!1,$yM:!1,add_$3XU:function(n){this.$2G("UploadPhotoClosed",n)},remove_$3XU:function(n){this.$2H("UploadPhotoClosed",n)},get_$2J5:function(){return this.$5BU||_g.$V.get_$I().get_$5z().get_$2fa()&&this.get_$5kf()},get_$20Z:function(){return this.$B.get_$L()==="Mouse"},get_$489:function(){return this.$B.get_$L()==="TouchNarrow"},get_$D3:function(){this.$1v||(this.$1v=new _y.$4p);return this.$1v},get_$7vA:function(){return!this.get_$45B()&&_a.UserAgent.getInstance().$iG&&(!this.$c.$5i(this.$c.get_$B9())||!this.$c.get_$B9().get_$bW().get_$3Hm())?!0:!1},get_$1ED:function(){return this.$1EC},set_$1ED:function(n){if(this.$1EC!==n){this.$1EC=n;$3(this,"IsDiscardChangesDialogShown")}return n},get_$yq:function(){return this.$yp},set_$yq:function(n){if(this.$yp!==n){this.$yp=n;$3(this,"IsWorking")}return n},get_$7el:function(){return this.get_$5hU()&&_g.$V.get_$I().get_$5z().get_$2fa()?new _C(this.$$d_$9NR,_d.$5a.$hl):null},get_$9h7:function(){return this.get_$5kf()&&_g.$V.get_$I().get_$5z().get_$2fa()?new _C(this.$$d_$9Xv,_d.$5a.$hl):null},get_$9eQ:function(){return this.$2b6},set_$9eQ:function(n){this.$2b6=n;$3(this,"OpenPhotoPickerCommand");return n},get_$7YR:function(){return new _C(this.$$d_$9Xu,_d.$5a.$hl)},get_$Xu:function(){return this.$RR},set_$Xu:function(n){this.$RR=n;$3(this,"Files");return n},get_$3sw:function(){return 0},get_$KN:function(){return this.get_$20Z()?0:1},get_$uh:function(){this.$DO||(this.$DO=new _C(this.$$d_$4Q5,_d.$5a.$hl));return this.$DO},get_$1bJ:function(){this.$7I||(this.$7I=new _C(this.$$d_$2sg,_d.$5a.$hl));return this.$7I},get_$1Nj:function(){this.$Jm||(this.$Jm=new _C(this.$$d_$6Ix,_d.$5a.$hl));return this.$Jm},get_$4Y3:function(){return new _y.$2Q(_y.$d.get_$BS(),_y.$d.get_$1Iy(),_nbs.NonBootStrings.l_SaveMenuItem_LowerCase_Text,this.get_$uh())},get_$5OZ:function(){return new _y.$2Q(_y.$d.get_$xE(),_y.$d.get_$xF(),_u.Strings.l_DeleteItem_LowerCase_Text,this.get_$1Nj())},get_$1kp:function(){return this.get_$20Z()?2:0},get_$2PH:function(){return this.$$d_$1Tb},get_$3lT:function(){return new _y.$2Q(_y.$d.get_$9J(),_y.$d.get_$LH(),_nbs.NonBootStrings.l_CancelItem_LowerCase_Text,this.get_$1bJ())},get_$45B:function(){return this.$37p&&this.$c.$5i(this.$c.get_$B9())&&this.$c.get_$B9().get_$bW().get_$2zN()},get_$5hU:function(){return this.$37p&&this.$c.$5i(this.$c.get_$B9())&&this.$c.get_$B9().get_$bW().get_$2Iv()},get_$5kf:function(){return this.get_$45B()||this.get_$5hU()||_a.UserAgent.getInstance().$iG},get_$2QH:function(){return this.$1PM},set_$2QH:function(n){this.$1PM=n!==""?n+String.format("&sc={0}",(new Date).getTime()):n;$3(this,"ImageSource");return n},get_$3sK:function(){if(!this.$r3){this.$r3=new _js.$c;this.$r3.$D(new _a.$2E(new _C(this.$$d_$3Pz,_d.$5a.$hl),_nbs.NonBootStrings.l_ConfirmDialog_Save_Text,null));this.$r3.$D(new _a.$2E(new _C(this.$$d_$2wn,_d.$5a.$hl),_u.Strings.l_ConfirmDialog_Discard_Text,null));this.$r3.$D(new _a.$2E(new _C(this.$$d_$1dN,_d.$5a.$hl),_u.Strings.l_ConfirmDialog_Cancel_Text,null))}return this.$r3},$TZ:function(){_y.$1Mq.prototype.$TZ.call(this);this.$6XD()},$6XD:function(){this.$Xl=0;this.$1WH=0;this.set_$yq(!1);this.set_$2QH(this.$28l+"&isPreview=false");this.$2by=this.$1PM;this.$yM=!1},$9Xv:function(){if(this.get_$45B()){_js.Trace.logInfo(_d.$5a.$hl,"Call to get photo from gallery");this.$c.get_$B9().$30V(!1,this.$$d_$2Gv,this.$$d_$3LM);return}if(this.$c.$5i(this.$c.get_$B9())&&this.$c.get_$B9().get_$bW().get_$3Hm()){_js.Trace.logInfo(_d.$5a.$hl,"Call to native file picker");var n=this,t=this;this.$c.get_$B9().$3Kf(!1,"*",1,function(t){t.length>0&&n.$2Gv(t[0])},function(n){$76s(t,n)});return}_a.UserAgent.getInstance().$iG&&this.$2b6&&this.$2b6.$s()},$9NR:function(){_js.Trace.logInfo(_d.$5a.$hl,"Call to get photo from camera");this.$c.get_$B9().$30U(!1,this.$$d_$2Gv,this.$$d_$3LM)},$9Xu:function(){$76t(this,this.$RR.$3o(0))},$2Gv:function(n){var t=$2FR(this,1,null,n);t.add_$29(this.$$d_$AEJ);t.add_$21(this.$$d_$AEI);this.$1WH=1;this.$2by=this.$28l+"&isPreview=true";this.set_$yq(!0);this.$k.$11(t)},$9Qr:function(n){var t=$2FR(this,1,n,null);t.add_$29(this.$$d_$AEJ);t.add_$21(this.$$d_$AEI);this.$1WH=1;this.$2by=this.$28l+"&isPreview=true";this.set_$yq(!0);this.$k.$11(t)},$AEJ:function(n){this.set_$yq(!1);this.set_$2QH(this.$2by);this.$Xl=this.$1WH;if(this.$1WH===3){this.$yM=!0;$6J(this,"UploadPhotoClosed");this.$2sg()}},$AEI:function(n){this.set_$yq(!1);this.get_$D3().$2u(0,n.$1d.message,null)},$4Q5:function(){if(!this.$yp)switch(this.$Xl){case 0:this.$2sg();break;case 1:var n=$2FR(this,0,"",null);n.add_$29(this.$$d_$AEJ);n.add_$21(this.$$d_$AEI);this.$1WH=3;this.set_$yq(!0);this.$k.$11(n);break;case 2:var t=$2FR(this,2,"",null);t.add_$29(this.$$d_$AEJ);t.add_$21(this.$$d_$AEI);this.$1WH=3;this.set_$yq(!0);this.$k.$11(t);break}},$1Tc:function(){return this.$1Tb(null,2)},$6Ix:function(){if(!this.$yp)switch(this.$Xl){case 0:this.set_$2QH("");this.$Xl=2;break;case 1:var n=$2FR(this,3,"",null);n.add_$29(this.$$d_$AEJ);n.add_$21(this.$$d_$AEI);this.$1WH=0;this.$2by=this.$28l+"&isPreview=false";this.set_$yq(!0);this.$k.$11(n);break;case 2:break}},$1Tb:function(n,t){if(this.$yp)return!0;if(this.$yM)return!1;if(this.$Xl){this.set_$1ED(!0);return!0}return!1},$3LM:function(n){_js.Trace.logError(_d.$5a.$hl,n.message)},$5TV:function(){this.get_$D3().$2u(0,"Error when reading the file",null)},$2sg:function(){this.get_$4h()&&this.get_$4h().get_$7T()===this&&this.$1HR()},$3Pz:function(){this.$yM=!0;this.$1dN();this.$4Q5()},$2wn:function(){this.$yM=!0;this.$1dN();this.$2sg();this.get_$489()&&$6J(this,"UploadPhotoClosed")},$1dN:function(){this.set_$1ED(!1)}};_d.$oI=function(n,t,i){this.$1B=n;this.$3U6=t;this.$6Pi=i};_d.$oI.prototype={$1B:null,$3U6:null,$6Pi:null};OSF.AppSpecificSetup.registerClass("OSF.AppSpecificSetup");_d.$sd.registerClass("_d.$sd");_d.$1CF.registerClass("_d.$1CF");CoreViewModelsComponent.registerClass("CoreViewModelsComponent",null,_a.$1L9);_d.$9d.registerClass("_d.$9d",_a.$FF,IPopOutViewModel);_d.$D8.registerClass("_d.$D8",null,IPopOutHelper);_d.$QK.registerClass("_d.$QK",_js.$9,_d.$1Iq);_d.$Vg.registerClass("_d.$Vg");_d.$EC.registerClass("_d.$EC",_a.$FF);_d.$an.registerClass("_d.$an");_d.$G5.registerClass("_d.$G5",_a.$FF);_d.$Is.registerClass("_d.$Is",_a.$FF);_d.$5e.registerClass("_d.$5e",_0365m.$2c);_d.$CN.registerClass("_d.$CN",_a.$FF,ICalendarItemViewModel);_d.$PB.registerClass("_d.$PB");_d.$5f.registerClass("_d.$5f",_a.$FF);_d.$oh.registerClass("_d.$oh");_d.$CM.registerClass("_d.$CM",_a.$FF);_d.$og.registerClass("_d.$og");_d.$Lx.registerClass("_d.$Lx",_a.$FF);_d.$En.registerClass("_d.$En");_d.$1NB.registerClass("_d.$1NB",_y.$1Mq);_d.$9B.registerClass("_d.$9B");_d.$1N1.registerClass("_d.$1N1",_a.$FF,_g.$K5,_js.$yO,_g.$Pq);_d.$M0.registerClass("_d.$M0",_d.$1N1,_g.$1In,_g.$K5,_js.$yO);_d.$aw.registerClass("_d.$aw");_d.$Eo.registerClass("_d.$Eo",_a.$FF,_y.$1Jg);_d.$1GT.registerClass("_d.$1GT",_js.$9,_g.$kR);_d.$Jf.registerClass("_d.$Jf",_a.$FF);_d.$1s.registerClass("_d.$1s",_a.$FF,_d.$xk,_d.$18e);_d.$1ND.registerClass("_d.$1ND",_d.$1s);_d.$1NN.registerClass("_d.$1NN",_d.$1ND);_d.$nw.registerClass("_d.$nw",_d.$1NN);_d.$Ji.registerClass("_d.$Ji",_d.$M0);_d.$Sy.registerClass("_d.$Sy",null,_0365m.$198);_d.$oX.registerClass("_d.$oX");_d.$Ul.registerClass("_d.$Ul",_0365m.$HH);_d.$13n.registerClass("_d.$13n",_d.$Ul);_d.$oZ.registerClass("_d.$oZ",_a.$FF);_d.$vg.registerClass("_d.$vg");_d.$13p.registerClass("_d.$13p",_d.$vg);_d.$Jm.registerClass("_d.$Jm");_d.$IB.registerClass("_d.$IB",_a.$FF);_d.$7T.registerClass("_d.$7T",_a.$FF);_d.$7o.registerClass("_d.$7o",_d.$1s);_d.$G6.registerClass("_d.$G6",_d.$7o);_d.$Qx.registerClass("_d.$Qx");_d.$G7.registerClass("_d.$G7");_d.$Qz.registerClass("_d.$Qz",_0365m.$o);_d.$Kp.registerClass("_d.$Kp",_a.$FF,_y.$eB);_d.$3e.registerClass("_d.$3e",_d.$1NB,_c.$1Ho);_d.$PE.registerClass("_d.$PE",_js.$9);_d.$Iu.registerClass("_d.$Iu");_d.$oj.registerClass("_d.$oj",_d.$1N1);_d.$j9.registerClass("_d.$j9");_d.$WQ.registerClass("_d.$WQ");_d.$Iw.registerClass("_d.$Iw",_y.$1Mq,_y.$18f);_d.$M1.registerClass("_d.$M1",_d.$7o);_d.$149.registerClass("_d.$149",_d.$M1);_d.$ov.registerClass("_d.$ov",_d.$M1);_d.$Wq.registerClass("_d.$Wq",_0365m.$o);_d.$92.registerClass("_d.$92",_d.$1s);_d.$1NQ.registerClass("_d.$1NQ",_d.$92);_d.$zP.registerClass("_d.$zP",_d.$1NQ);_d.$12W.registerClass("_d.$12W",_d.$Jf,_d.$xk,_d.$18e);_d.$iV.registerClass("_d.$iV",_d.$12W);_d.$ZE.registerClass("_d.$ZE");_d.$1MU.registerClass("_d.$1MU",_js.$9,_d.$1J7,_js.$yO,Sys.IDisposable);_d.$G4.registerClass("_d.$G4",_d.$1MU);_d.$9f.registerClass("_d.$9f",_a.$FF);_d.$WP.registerClass("_d.$WP",null,_js.$Ra);_d.$oe.registerClass("_d.$oe",null,_js.$Ra);_d.$GD.registerClass("_d.$GD",_d.$1MU);_d.$Cm.registerClass("_d.$Cm",_a.$RE,_y.$1JS);_d.$51.registerClass("_d.$51",_rw.$36);_d.$oG.registerClass("_d.$oG");_d.$Ek.registerClass("_d.$Ek",_a.$FF);_d.$DL.registerClass("_d.$DL",_d.$Ek);_d.$p5.registerClass("_d.$p5");_d.$Js.registerClass("_d.$Js",_a.$FF);_d.$vJ.registerClass("_d.$vJ",null,_y.$1J1);_d.$14R.registerClass("_d.$14R",_cc.$8v);_d.$p6.registerClass("_d.$p6");_d.$M3.registerClass("_d.$M3",null,_y.$1JX,_y.$1Ja,_y.$1JZ);_d.$84.registerClass("_d.$84",_a.$RE,_y.$1JS);_d.$p7.registerClass("_d.$p7",_cc.$8v);_d.$Wc.registerClass("_d.$Wc");_d.$z.registerClass("_d.$z",_y.$1Mq,_y.$qg,_y.$YG,_y.$eA,_y.$xs,_d.$1Iq,_y.$xt,_y.$1Hu,IComposeCalendarItemViewModel);_d.$DM.registerClass("_d.$DM",null,IComposeCalendarItemViewModelFactory,_y.$19p,_y.$yW);_d.$R8.registerClass("_d.$R8");_d.$Dv.registerClass("_d.$Dv",_a.$FF,_cc.$1Hv,_c.$1Hm,_d.$1JW,_g.$kR);_d.$IF.registerClass("_d.$IF",_a.$FF);_d.$pA.registerClass("_d.$pA");_d.$14W.registerClass("_d.$14W");_d.$4Q.registerClass("_d.$4Q",_y.$M8,_cc.$1Hb);_d.$4B.registerClass("_d.$4B",_js.$9,_d.$1JF);_d.$Nf.registerClass("_d.$Nf");_d.$lk.registerClass("_d.$lk",_js.$9);_d.$s7.registerClass("_d.$s7",_y.$M8);_d.$SD.registerClass("_d.$SD",_a.$FF);_d.$47.registerClass("_d.$47",_d.$SD);_d.$sK.registerClass("_d.$sK",null,_y.$19p);_d.$gT.registerClass("_d.$gT");_d.$Gk.registerClass("_d.$Gk");_d.$FD.registerClass("_d.$FD",_js.$9);_d.$Zv.registerClass("_d.$Zv");_d.$Lt.registerClass("_d.$Lt",_a.$FF);_d.$G0.registerClass("_d.$G0",_a.$FF);_d.$Lu.registerClass("_d.$Lu",_a.$FF);_d.$WJ.registerClass("_d.$WJ");_d.$NP.registerClass("_d.$NP",_a.$FF);_d.$P9.registerClass("_d.$P9",_a.$RE,_y.$1JS);_d.$3d.registerClass("_d.$3d",_y.$1Mq,_y.$YG,_y.$eA,_y.$xs,_d.$1Iq,_y.$1Hi,_js.$yO,Sys.IDisposable);_d.$It.registerClass("_d.$It",null,ICalendarItemDetailsViewModelFactory,_y.$19p,ICalendarReadingPaneViewModelFactory);_d.$5z.registerClass("_d.$5z",_a.$FF,_y.$18h);_d.$j5.registerClass("_d.$j5");_d.$PA.registerClass("_d.$PA",_cc.$8v);_d.$13z.registerClass("_d.$13z",_y.$CW);_d.$j7.registerClass("_d.$j7",null,ICalendarMailComposeConductorFactory);_d.$cL.registerClass("_d.$cL",_cc.$8v);_d.$65.registerClass("_d.$65",_a.$FF);_d.$cM.registerClass("_d.$cM");_d.$zw.registerClass("_d.$zw");_d.$7K.registerClass("_d.$7K",_a.$FF);_d.$KX.registerClass("_d.$KX",_a.$FF,_y.$18h);_d.$116.registerClass("_d.$116",_a.$FF,_g.$K5,_js.$yO);_d.$96.registerClass("_d.$96",_y.$17,_g.$1Iw,_pc.$1Ip);_d.$Lj.registerClass("_d.$Lj",_d.$96);_d.$EZ.registerClass("_d.$EZ",null,IPersonaViewModelFactory,_y.$Xr);_d.$ZL.registerClass("_d.$ZL",_d.$EZ);_d.$3a.registerClass("_d.$3a",_d.$84);_d.$6h.registerClass("_d.$6h",_a.$FF,_d.$1J4,_g.ICalendarTimePeriod);_d.$4m.registerClass("_d.$4m",_d.$7o,_y.$Rh,_d.$1JM);_d.$4m.$3ir.registerClass("_d.$4m.$3ir");_d.$5k.registerClass("_d.$5k",_y.$1Mq,_y.$qg);_d.$KY.registerClass("_d.$KY",_a.$FF,_g.$K5,_js.$yO,_g.$Pq);_d.$tX.registerClass("_d.$tX",_y.$E5);_d.$6p.registerClass("_d.$6p",_y.$1Mq,_y.$qg,_y.$eA,ISchedulingViewModel);_d.$Fm.registerClass("_d.$Fm",null,ISchedulingViewModelFactory);_d.$7w.registerClass("_d.$7w",_d.$M1,_y.$Rh,Sys.IDisposable,_d.$1JM);_d.$1GY.registerClass("_d.$1GY",null,_d.$1JR);_d.$uC.registerClass("_d.$uC",_a.$FF);_d.$uD.registerClass("_d.$uD",_a.$FF);_d.$FE.registerClass("_d.$FE",_a.$FF);_d.$ie.registerClass("_d.$ie");_d.$G2.registerClass("_d.$G2",_a.$FF,_d.$1He,_js.$yO);_d.$Gr.registerClass("_d.$Gr",_y.$1Mq);_d.$PX.registerClass("_d.$PX");_d.$Ij.registerClass("_d.$Ij",_a.$FF,_d.$1Hh,_js.$yO,_d.$1J4);_d.$mZ.registerClass("_d.$mZ",_a.$FF);_d.$F6.registerClass("_d.$F6",_a.$FF,_d.$1Hg,_js.$yO);_d.$111.registerClass("_d.$111",_a.$FF);_d.$QY.registerClass("_d.$QY",_d.$G2);_d.$N1.registerClass("_d.$N1",_d.$G2);_d.$1E4.registerClass("_d.$1E4",_d.$N1);_d.$bB.registerClass("_d.$bB",_a.$FF);_d.$wO.registerClass("_d.$wO",_a.$FF);_d.$X9.registerClass("_d.$X9",_a.$FF);_d.$Nl.registerClass("_d.$Nl",_a.$FF);_d.$Bo.registerClass("_d.$Bo",_a.$1);_d.$Nw.registerClass("_d.$Nw",null,IModuleHelpProvider);_d.$4.registerClass("_d.$4");_d.$FA.registerClass("_d.$FA",_js.$9);_d.$Uf.registerClass("_d.$Uf",_js.$9,_y.$1Hw);_d.$1BB.registerClass("_d.$1BB",null,IMeetNowManagerFactory);_d.$Uk.registerClass("_d.$Uk");_d.$fR.registerClass("_d.$fR",_a.$FF,IOpenAnotherMailboxViewModel);_d.$Yq.registerClass("_d.$Yq",null,_d.$19m);_d.$4f.registerClass("_d.$4f",_a.$FF);_d.$7m.registerClass("_d.$7m",_a.$FF);_d.$tJ.registerClass("_d.$tJ",_a.$FF);_d.$5O.registerClass("_d.$5O",_a.$FF);_d.$7c.registerClass("_d.$7c",_y.$1Mq);_d.$129.registerClass("_d.$129",null,_d.$1IG);_d.$1De.registerClass("_d.$1De",_d.$129);_d.$1N0.registerClass("_d.$1N0",_a.$FF);_d.$14M.registerClass("_d.$14M",_d.$1N0);_d.$1CN.registerClass("_d.$1CN",_d.$1N0);_d.$10C.registerClass("_d.$10C",null,_y.$19K);_d.$3E.registerClass("_d.$3E",_y.$M8,_y.$19K);_d.$Ov.registerClass("_d.$Ov",_a.$FF);_d.$Wy.registerClass("_d.$Wy",null,_y.$19p);_d.$Wy.$4Tb.registerClass("_d.$Wy.$4Tb");_d.$pc.registerClass("_d.$pc");_d.$16E.registerClass("_d.$16E",null,_d.$1LO);_d.$Bn.registerClass("_d.$Bn",null,_d.$1LO);_d.$3s.registerClass("_d.$3s");_d.$un.registerClass("_d.$un",_d.$3s);_d.$12j.registerClass("_d.$12j",_d.$un);_d.$12h.registerClass("_d.$12h",_d.$un);_d.$uo.registerClass("_d.$uo",_d.$3s);_d.$mr.registerClass("_d.$mr",_d.$3s);_d.$13h.registerClass("_d.$13h",_d.$mr);_d.$13g.registerClass("_d.$13g",_d.$mr);_d.$k1.registerClass("_d.$k1");_d.$X6.registerClass("_d.$X6");_d.$2f.registerClass("_d.$2f");_d.$1MC.registerClass("_d.$1MC",_d.$2f);_d.$16D.registerClass("_d.$16D",_d.$1MC);_d.$6N.registerClass("_d.$6N",_d.$2f);_d.$pd.registerClass("_d.$pd",_d.$6N);_d.$pe.registerClass("_d.$pe");_d.$16G.registerClass("_d.$16G",_d.$1MC);_d.$Tl.registerClass("_d.$Tl",_d.$6N);_d.$16r.registerClass("_d.$16r",_d.$3s);_d.$17L.registerClass("_d.$17L",_d.$3s);_d.$q5.registerClass("_d.$q5",_d.$3s);_d.$17u.registerClass("_d.$17u",_d.$3s);_d.$17y.registerClass("_d.$17y",_d.$3s);_d.$1Ab.registerClass("_d.$1Ab",_d.$3s);_d.$1DQ.registerClass("_d.$1DQ",_d.$3s);_d.$VP.registerClass("_d.$VP",_d.$3s);_d.$1EV.registerClass("_d.$1EV",_d.$3s);_d.$1Eg.registerClass("_d.$1Eg",_d.$3s);_d.$1Ej.registerClass("_d.$1Ej",_d.$3s);_d.$5E.registerClass("_d.$5E");_d.$12O.registerClass("_d.$12O",null,_y.$ky,_a.$190);_d.$2q.registerClass("_d.$2q",_a.$FF,_y.$1JU);_d.$HQ.registerClass("_d.$HQ",_d.$2q);_d.$w4.registerClass("_d.$w4",_y.$1Mq,_y.$YG,_y.$eA,_y.$xs,_y.$qg);_d.$RI.registerClass("_d.$RI");_d.$16F.registerClass("_d.$16F",_a.$R);_d.$16F.prototype.$9S=_a.$R.prototype.$9S;_d.$J5.registerClass("_d.$J5",null,IExtensibilityStatistics);_d.$J5.$59X.registerClass("_d.$J5.$59X");_d.$J5.$7d8.registerClass("_d.$J5.$7d8");_d.$J5.$5T1.registerClass("_d.$J5.$5T1");_d.$J5.$7xQ.registerClass("_d.$J5.$7xQ");_d.$IJ.registerClass("_d.$IJ",_a.$FF);_d.$wu.registerClass("_d.$wu",_y.$1Mq,_y.$YG,_y.$eA,_y.$xs,_y.$qg);_d.$pf.registerClass("_d.$pf");_d.$Tm.registerClass("_d.$Tm",_d.$2q);_d.$16H.registerClass("_d.$16H",_a.$R);_d.$16H.prototype.$9S=_a.$R.prototype.$9S;_d.$wv.registerClass("_d.$wv",_js.$DK);_d.$RJ.registerClass("_d.$RJ",null,IExtensibilityViewModelFactory);_d.$GJ.registerClass("_d.$GJ",_a.$FF,_y.$1JT);_d.$Ck.registerClass("_d.$Ck");_d.$14K.registerClass("_d.$14K",_d.$Ck);_d.$wo.registerClass("_d.$wo");_d.$7h.registerClass("_d.$7h");_d.$1AD.registerClass("_d.$1AD",_d.$Ck);_d.$5v.registerClass("_d.$5v",_d.$Ck);_d.$IQ.registerClass("_d.$IQ",_d.$Ck);_d.$Mb.registerClass("_d.$Mb",_d.$Ck);_d.$1M7.registerClass("_d.$1M7",null,_y.$19K);_d.$Tr.registerClass("_d.$Tr",_d.$1M7);_d.$x3.registerClass("_d.$x3",_d.$1M7);_d.$2C.registerClass("_d.$2C",_y.$5Z);_d.$ce.registerClass("_d.$ce",_d.$2C);_d.$67.registerClass("_d.$67",_y.$1Mq,_y.$eA);_d.$l7.registerClass("_d.$l7");_d.$Rj.registerClass("_d.$Rj",_a.$FF);_d.$l8.registerClass("_d.$l8");_d.$z6.registerClass("_d.$z6",null,ILocationViewModelFactory);_d.$9X.registerClass("_d.$9X",_a.$FF,_y.$xs);_d.$l9.registerClass("_d.$l9");_d.$8Z.registerClass("_d.$8Z",_d.$84);_d.$Z2.registerClass("_d.$Z2",_y.$Fe.$$(_d.$96));_d.$1Cg.registerClass("_d.$1Cg",_a.$FF);_d.$m4.registerClass("_d.$m4",_d.$1Cg);_d.$10O.registerClass("_d.$10O",_d.$67);_d.$Z3.registerClass("_d.$Z3",_d.$1Cg);_d.$6Q.registerClass("_d.$6Q",_y.$1Mq,_y.$qg,_y.$YG,_y.$eA,_y.$xs);_d.$fi.registerClass("_d.$fi");_d.$rc.registerClass("_d.$rc");_d.$yP.registerClass("_d.$yP");_d.$r6.registerClass("_d.$r6");_d.$sw.registerClass("_d.$sw");_d.$9q.registerClass("_d.$9q",_js.$9);_d.$An.registerClass("_d.$An",_d.$9q,_y.$1Hu);_d.$6l.registerClass("_d.$6l",_d.$9q);_d.$1Ap.registerClass("_d.$1Ap",_d.$6l);_d.$DY.registerClass("_d.$DY",_d.$9q);_d.$Pw.registerClass("_d.$Pw");_d.$Px.registerClass("_d.$Px",_d.$9q);_d.$Rk.registerClass("_d.$Rk",_d.$9q);_d.$UZ.registerClass("_d.$UZ",_d.$9q);_d.$1As.registerClass("_d.$1As",_d.$9q);_d.$KD.registerClass("_d.$KD",_d.$9q);_d.$rb.registerClass("_d.$rb",_d.$9q);_d.$DX.registerClass("_d.$DX",_d.$9q);_d.$8a.registerClass("_d.$8a",_d.$9q);_d.$Bv.registerClass("_d.$Bv",_d.$9q,_y.$1JK);_d.$90.registerClass("_d.$90",_d.$9q);_d.$Gy.registerClass("_d.$Gy",_d.$9q);_d.$1Au.registerClass("_d.$1Au",_d.$9q,_y.$1JH);_d.$1Av.registerClass("_d.$1Av",_d.$9q);_d.$Py.registerClass("_d.$Py",_d.$9q);_d.$41.registerClass("_d.$41",_d.$9q,_y.$1J1);_d.$KE.registerClass("_d.$KE",_js.$9);_d.$4x.registerClass("_d.$4x",_d.$9q);_d.$Ez.registerClass("_d.$Ez",_d.$9q);_d.$7F.registerClass("_d.$7F",_d.$9q);_d.$1Aw.registerClass("_d.$1Aw",_d.$9q);_d.$ET.registerClass("_d.$ET",_d.$9q);_d.$Gz.registerClass("_d.$Gz",_d.$9q);_d.$Pz.registerClass("_d.$Pz",_d.$9q);_d.$1At.registerClass("_d.$1At",_d.$9q);_d.$ec.registerClass("_d.$ec",_d.$9q);_d.$ES.registerClass("_d.$ES",_d.$9q,_y.$1JY,_y.$1Ja,_y.$1JZ);_d.$15Z.registerClass("_d.$15Z",_y.$1Mr);_d.$HD.registerClass("_d.$HD",_d.$15Z);_d.$m8.registerClass("_d.$m8",_y.$M8);_d.$m9.registerClass("_d.$m9",_a.$FF,_y.$18h);_d.$1Mt.registerClass("_d.$1Mt",_a.$FF);_d.$sr.registerClass("_d.$sr",_d.$1Mt);_d.$Mg.registerClass("_d.$Mg",null,IMailComposeActionFactory);_d.$1Aq.registerClass("_d.$1Aq");_d.$1Ar.registerClass("_d.$1Ar",null,IMailComposeContextFactory);_d.$YX.registerClass("_d.$YX",null,IMailComposeViewModelFactory,_y.$19p);_d.$yj.registerClass("_d.$yj",_a.$FF);_d.$Mi.registerClass("_d.$Mi",_d.$15Z);_d.$13S.registerClass("_d.$13S",_d.$Mi);_d.$15B.registerClass("_d.$15B",_d.$Mi);_d.$16I.registerClass("_d.$16I",_d.$Mi);_d.$1AO.registerClass("_d.$1AO",_d.$Mi);_d.$Q1.registerClass("_d.$Q1",_d.$1Mt);_d.$1BJ.registerClass("_d.$1BJ",_d.$Mi);_d.$Oa.registerClass("_d.$Oa",_a.$FF);_d.$1DD.registerClass("_d.$1DD",_d.$Mi);_d.$1Dd.registerClass("_d.$1Dd",_d.$Mi);_d.$B6.registerClass("_d.$B6",_js.$9,_y.$1JP);_d.$S.registerClass("_d.$S",_a.$1,_g.$1Iv,_y.$1JO,_y.$1JS);_d.$ra.registerClass("_d.$ra",null,IMailComposeDiscardManager);_d.$1m.registerClass("_d.$1m",_a.$RE);_d.$1Ax.registerClass("_d.$1Ax");_d.$Ao.registerClass("_d.$Ao",_y.$1Mq,_y.$K7,_y.$MY,_y.$xs,_js.$yO,_y.$r5,_y.$qg,_y.$YG,_y.$eA);_d.$AU.registerClass("_d.$AU",_a.$FF,_y.$1JQ);_d.$re.registerClass("_d.$re",null,IMailResponseViewModelFactory);_d.$lS.registerClass("_d.$lS",_a.$FF);_d.$Cc.registerClass("_d.$Cc");_d.$YB.registerClass("_d.$YB",null,IInstantSearchFactory);_d.$r8.registerClass("_d.$r8",_js.$9,IInstantSearchRefinerManager);_d.$r8.$Xn.registerClass("_d.$r8.$Xn");_d.$r8.$18U.registerClass("_d.$r8.$18U");_d.$yS.registerClass("_d.$yS",_a.$FF,_y.$1I2);_d.$ZC.registerClass("_d.$ZC",_a.$FF,IRefinerViewModel,_js.$yO);_d.$10B.registerClass("_d.$10B",_d.$ZC);_d.$VS.registerClass("_d.$VS",_js.$9,ISearchRefinerCategoryViewModel,_js.$yO);_d.$Do.registerClass("_d.$Do",_a.$FF);_d.$o7.registerClass("_d.$o7");_d.$wi.registerClass("_d.$wi",_y.$1Mq);_d.$DQ.registerClass("_d.$DQ",_lv.$5w);_d.$16a.registerClass("_d.$16a");_d.$1A7.registerClass("_d.$1A7",null,_y.$qt,_y.$19p);_d.$CU.registerClass("_d.$CU",_y.$1Mq,_y.$ya);_d.$IR.registerClass("_d.$IR",_y.$1Mq,_y.$ya);_d.$yt.registerClass("_d.$yt",null,IItemPartPartnerViewModelFactory);_d.$yu.registerClass("_d.$yu",null,IItemReadingPaneContextFactory);_d.$1AF.registerClass("_d.$1AF",null,_y.$Gw,_y.$19p);_d.$Rm.registerClass("_d.$Rm",null,IMailErrorHandler);_d.$lD.registerClass("_d.$lD",_a.$FF);_d.$5M.registerClass("_d.$5M",_y.$M8,IMailFolderPermissionsDialogViewModel);_d.$Ru.registerClass("_d.$Ru",_a.$FF,_y.$1Jg);_d.$VW.registerClass("_d.$VW",_a.$FF,ISharedFolderViewModel);_d.$4O.registerClass("_d.$4O",_a.$FF);_d.$Ix.registerClass("_d.$Ix",_d.$4O);_d.$WZ.registerClass("_d.$WZ",_a.$FF);_d.$NR.registerClass("_d.$NR",_d.$4O);_d.$Dl.registerClass("_d.$Dl",_d.$4O);_d.$C0.registerClass("_d.$C0",_d.$4O);_d.$QA.registerClass("_d.$QA",_a.$FF);_d.$LN.registerClass("_d.$LN",_a.$FF,INotificationTrayViewModel);_d.$zk.registerClass("_d.$zk",null,INotificationTrayViewModel);_d.$sc.registerClass("_d.$sc",_js.$9,_d.$1A4,_js.$yO);_d.$SQ.registerClass("_d.$SQ",_d.$4O);_d.$ub.registerClass("_d.$ub",_js.$9,_d.$1A4,_js.$yO);_d.$F1.registerClass("_d.$F1",_y.$1Mq,_y.$YG,_y.$eA,_y.$xs);_d.$OO.registerClass("_d.$OO",_d.$F1);_d.$KL.registerClass("_d.$KL",_d.$F1);_d.$LR.registerClass("_d.$LR",_d.$F1);_d.$Mq.registerClass("_d.$Mq",_d.$F1);_d.$s8.registerClass("_d.$s8",_js.$9);_d.$KM.registerClass("_d.$KM",_a.$FF);_d.$LS.registerClass("_d.$LS",_y.$Fe.$$(_d.$KM));_d.$zu.registerClass("_d.$zu",_y.$1Mq,IOptionsViewModel);_d.$9b.registerClass("_d.$9b",_d.$zu,_y.$YG,_y.$eA,_y.$xs);_d.$zt.registerClass("_d.$zt",_d.$zu);_d.$Uw.registerClass("_d.$Uw",_d.$F1);_d.$Zj.registerClass("_d.$Zj",_a.$FF);_d.$OM.registerClass("_d.$OM",_d.$F1);_d.$Ca.registerClass("_d.$Ca",_d.$F1);_d.$PI.registerClass("_d.$PI",_a.$FF);_d.$1Lv.registerClass("_d.$1Lv",null,_d.$1IK);_d.$p8.registerClass("_d.$p8",_d.$1Lv);_d.$Iz.registerClass("_d.$Iz",_a.$FF);_d.$14V.registerClass("_d.$14V",_d.$p8);_d.$m0.registerClass("_d.$m0");_d.$AC.registerClass("_d.$AC",_a.$FF);_d.$oW.registerClass("_d.$oW",_a.$FF);_d.$Wz.registerClass("_d.$Wz",_a.$FF);_d.$qB.registerClass("_d.$qB");_d.$VB.registerClass("_d.$VB",_d.$4f,_0365f.$kT);_d.$qG.registerClass("_d.$qG",_d.$VB,_0365f.$kT);_d.$qH.registerClass("_d.$qH");_d.$qA.registerClass("_d.$qA");_d.$U6.registerClass("_d.$U6",_a.$FF);_d.$2n.registerClass("_d.$2n",_a.$FF);_d.$4y.registerClass("_d.$4y",_y.$Fe.$$(_d.$2n));_d.$1N8.registerClass("_d.$1N8",_y.$Fe.$$(_d.$4y));_d.$FM.registerClass("_d.$FM",_a.$FF,_y.$UE);_d.$jM.registerClass("_d.$jM");_d.$w7.registerClass("_d.$w7",_y.$EX);_d.$Jt.registerClass("_d.$Jt",_a.$FF,_y.$1J0);_d.$TQ.registerClass("_d.$TQ",null,ICompositePersonaViewModelFactory);_d.$jR.registerClass("_d.$jR",_a.$FF);_d.$52.registerClass("_d.$52",_a.$FF);_d.$Ww.registerClass("_d.$Ww",_a.$FF);_d.$cF.registerClass("_d.$cF",_y.$Fe.$$(_d.$Ww));_d.$La.registerClass("_d.$La");_d.$16J.registerClass("_d.$16J",null,_y.$19K);_d.$1N2.registerClass("_d.$1N2",_a.$FF);_d.$8m.registerClass("_d.$8m",_y.$Fe.$$(_d.$1N2),_y.$MY,_y.$xs,_js.$yO,_y.$r5,_y.$Rh);_d.$KN.registerClass("_d.$KN",_d.$8m);_d.$DR.registerClass("_d.$DR");_d.$Pe.registerClass("_d.$Pe",_d.$1N2);_d.$1Lz.registerClass("_d.$1Lz");_d.$1AL.registerClass("_d.$1AL",_a.$FF);_d.$yz.registerClass("_d.$yz",_a.$FF);_d.$z0.registerClass("_d.$z0",_a.$FF);_d.$1AM.registerClass("_d.$1AM",_d.$z0,_y.$18h);_d.$eJ.registerClass("_d.$eJ",_d.$z0,_y.$MY,_y.$xs,_js.$yO,_y.$r5,_y.$Rh);_d.$l3.registerClass("_d.$l3");_d.$l4.registerClass("_d.$l4");_d.$UU.registerClass("_d.$UU",_d.$1N8);_d.$3l.registerClass("_d.$3l",_0365m.$2c,_y.$y9);_d.$zF.registerClass("_d.$zF",null,IMeCardViewModelFactory);_d.$sE.registerClass("_d.$sE");_d.$sD.registerClass("_d.$sD");_d.$OS.registerClass("_d.$OS");_d.$V5.registerClass("_d.$V5",_a.$FF,_0365m.$Fc);_d.$Mv.registerClass("_d.$Mv",null,_0365m.$198);_d.$LY.registerClass("_d.$LY",null,_y.$19p);_d.$QI.registerClass("_d.$QI",_y.$Fe.$$(_a.$9K),_0365f.$kT,_d.$1Ii);_d.$1CL.registerClass("_d.$1CL",_d.$QI);_d.$SC.registerClass("_d.$SC",_y.$IY);_d.$EY.registerClass("_d.$EY",_d.$VB,_d.$1Ii);_d.$1CM.registerClass("_d.$1CM",_d.$EY);_d.$Hs.registerClass("_d.$Hs",_d.$96);_d.$sk.registerClass("_d.$sk",_a.$FF);_d.$SE.registerClass("_d.$SE",_js.$9,IPeopleSearchSuggestionAdaptorViewModel,_y.$1Hx,_js.$yO);_d.$1Q.registerClass("_d.$1Q",_d.$1N8,_0365f.$kT);_d.$5Y.registerClass("_d.$5Y",_a.$RE,_y.$1JS);_d.$10H.registerClass("_d.$10H");_d.$Gb.registerClass("_d.$Gb",_d.$10H,IPersonaCardViewModelFactory);_d.$10I.registerClass("_d.$10I",_d.$sp.$$(_a.$7));_d.$m2.registerClass("_d.$m2",_d.$sp.$$(_g.$1q));_d.$fe.registerClass("_d.$fe");_d.$EY.$8Pr.registerClass("_d.$EY.$8Pr");_d.$10G.registerClass("_d.$10G",_d.$sp.$$(_g.$6j));_d.$F2.registerClass("_d.$F2",_d.$sp.$$(_g.$3G));_d.$so.registerClass("_d.$so",_d.$sp.$$(_g.$3N));_d.$1Cd.registerClass("_d.$1Cd",_d.$sp.$$(Array));_d.$HA.registerClass("_d.$HA",_d.$sp.$$(String));_d.$97.registerClass("_d.$97",_d.$96,_pc.$yX,_pc.$1Ip);_d.$1Cx.registerClass("_d.$1Cx",_0365m.$o);_d.$10j.registerClass("_d.$10j",_d.$1Lv);_d.$tB.registerClass("_d.$tB",_d.$10j);_d.$N5.registerClass("_d.$N5",_a.$FF,_y.$18x);_d.$Ve.registerClass("_d.$Ve",_y.$Fe.$$(_d.$N5));_d.$IK.registerClass("_d.$IK",_d.$2C,_rw.$192,_js.$yO);_d.FindRecipientMailComposeViewModelFactory.registerClass("_d.FindRecipientMailComposeViewModelFactory",null,IFindRecipientMailComposeViewModelFactory);_d.$1HD.registerClass("_d.$1HD",_y.$2W);_d.$1HE.registerClass("_d.$1HE",_d.$1HD);_d.$KU.registerClass("_d.$KU",_a.$FF,_y.$Rh);_d.$Vw.registerClass("_d.$Vw");_d.$pE.registerClass("_d.$pE");_d.$sh.registerClass("_d.$sh");_d.$tD.registerClass("_d.$tD");_d.$Bf.registerClass("_d.$Bf",_a.$FF);_d.$Os.registerClass("_d.$Os",_y.$M8);_d.$Qh.registerClass("_d.$Qh",_a.$FF);_d.$1GI.registerClass("_d.$1GI",_d.$Qh);_d.$u5.registerClass("_d.$u5",_y.$1Mq);_d.$I3.registerClass("_d.$I3",_d.$Qh);_d.$Si.registerClass("_d.$Si",_d.$Qh);_d.$1GL.registerClass("_d.$1GL",_lv.$rd);_d.$Vl.registerClass("_d.$Vl",_lv.$5w);_d.$u7.registerClass("_d.$u7");_d.$Ot.registerClass("_d.$Ot",_y.$1Mq);_d.$1GQ.registerClass("_d.$1GQ",_lv.$6F);_d.$Sj.registerClass("_d.$Sj",_lv.$Q0);_d.$8q.registerClass("_d.$8q",_a.$RE,_y.$1JS);_d.$56.registerClass("_d.$56",_y.$1Mq,_y.$YG,_y.$eA,_y.$xs,_d.$1IW,_y.$1A6);_d.$123.registerClass("_d.$123",null,ITaskReadingPaneViewModelFactory);_d.$hm.registerClass("_d.$hm",null,_y.$19p);_d.$Ln.registerClass("_d.$Ln",_a.$FF);_d.$iX.registerClass("_d.$iX",_js.$9,_js.$Ra);_d.$4Z.registerClass("_d.$4Z",_a.$FF);_d.$CK.registerClass("_d.$CK",_a.$FF,_y.$1Jg);_d.$I7.registerClass("_d.$I7",_a.$FF);_d.$136.registerClass("_d.$136",null,_js.$1Kw);_d.$13o.registerClass("_d.$13o",null,_js.$1Kw);_d.$13y.registerClass("_d.$13y",null,_js.$1Kw);_d.$13u.registerClass("_d.$13u",null,_js.$1Kw);_d.$vw.registerClass("_d.$vw",null,_js.$1Kw);_d.$148.registerClass("_d.$148",null,_js.$1Kw);_d.$15H.registerClass("_d.$15H",null,_js.$1Kw);_d.$15a.registerClass("_d.$15a",null,_js.$1Kw);_d.$jt.registerClass("_d.$jt",null,_js.$1Kw);_d.$wj.registerClass("_d.$wj",null,_js.$1Kw);_d.$kE.registerClass("_d.$kE",null,_js.$1Kw);_d.$1DH.registerClass("_d.$1DH",null,_js.$1Kw);_d.$10m.registerClass("_d.$10m",null,_js.$1Kw);_d.$10v.registerClass("_d.$10v",null,_js.$1Kw);_d.$1Dc.registerClass("_d.$1Dc",null,_js.$1Kw);_d.$1EA.registerClass("_d.$1EA",null,_js.$1Kw);_d.$nO.registerClass("_d.$nO",null,_js.$1Kw);_d.$1HP.registerClass("_d.$1HP",null,_js.$1Kw);_d.$DH.registerClass("_d.$DH",_y.$1Mq,IUnsupportedItemReadingPaneViewModel);_d.$16d.registerClass("_d.$16d",_a.$R);_d.$16d.prototype.$9S=_a.$R.prototype.$9S;_d.$FW.registerClass("_d.$FW",null,_d.$xz);_d.$Tx.registerClass("_d.$Tx");_d.$kC.registerClass("_d.$kC");_d.$KS.registerClass("_d.$KS");_d.$3Y.registerClass("_d.$3Y");_d.$46.registerClass("_d.$46");_d.$R7.registerClass("_d.$R7");_d.$9N.registerClass("_d.$9N",_a.$FF,_y.$MY,_y.$xs,_js.$yO,_y.$r5,_y.$YG,_y.$eA,_y.$Rh);_d.$Cq.registerClass("_d.$Cq",_d.$9N,_y.$qg);_d.$Kx.registerClass("_d.$Kx",_d.$Cq,_d.$1IL);_d.$HR.registerClass("_d.$HR",_d.$Cq);_d.$7l.registerClass("_d.$7l",_d.$9N,_y.$qg);_d.$5G.registerClass("_d.$5G",_d.$7l);_d.$OG.registerClass("_d.$OG",_d.$7l);_d.$B5.registerClass("_d.$B5",_d.$OG);_d.$14A.registerClass("_d.$14A",_a.$R);_d.$14A.prototype.$9S=_a.$R.prototype.$9S;_d.$tC.registerClass("_d.$tC",_a.$R);_d.$tC.prototype.$9S=_a.$R.prototype.$9S;_d.$15u.registerClass("_d.$15u");_d.$DU.registerClass("_d.$DU",_a.$FF);_d.$Pn.registerClass("_d.$Pn",_y.$1Mq);_d.$QC.registerClass("_d.$QC",_d.$F1);_d.$8C.registerClass("_d.$8C",_y.$1Mq,_y.$qg,_y.$YG,_y.$eA,_y.$xs);_d.$zz.registerClass("_d.$zz",_d.$8C);_d.$7u.registerClass("_d.$7u",_js.$9);_d.$1AW.registerClass("_d.$1AW",_d.$7u);_d.$l2.registerClass("_d.$l2",_C);_d.$Ri.registerClass("_d.$Ri",_y.$1Mq);_d.$eN.registerClass("_d.$eN",_d.$Ri,_y.$qg);_d.$1AY.registerClass("_d.$1AY",_d.$7u);_d.$KC.registerClass("_d.$KC",_a.$FF);_d.$5T.registerClass("_d.$5T",_y.$1Mq,_y.$YG,_y.$eA,_y.$xs);_d.$YT.registerClass("_d.$YT",_d.$5T,_y.$qg);_d.$1B2.registerClass("_d.$1B2",_d.$7u);_d.$Ux.registerClass("_d.$Ux",_y.$1Mq);_d.$4l.registerClass("_d.$4l",_y.$1Mq);_d.$7v.registerClass("_d.$7v",_a.$FF,_d.$1Ij,IModernGroupCardFacade);_d.$6z.registerClass("_d.$6z");_d.$Ic.registerClass("_d.$Ic");_d.$30.registerClass("_d.$30",_d.$OG);_d.$mY.registerClass("_d.$mY");_d.$5r.registerClass("_d.$5r");_d.$5r.$59H.registerClass("_d.$5r.$59H",null,IPeopleSuggestionLoader);_d.$5a.registerClass("_d.$5a",_y.$1Mq,_y.$eA);_d.$oI.registerClass("_d.$oI");_d.$9d.$6Ty=["ReadMessageItem","ItemAttachment"];_d.$D8.$3VK=null;_d.$QK.$A=_a.$0.$6E;_d.$EC.$A=_a.$0.$1c;_d.$G5.$A=_a.$0.$1c;_d.$5e.$2C0=[new _d.$Uk(_nbs.NonBootStrings.l_FreeBusyFree_Text,null,"Free"),new _d.$Uk(_nbs.NonBootStrings.l_FreeBusyWorkingElsewhere_Text,null,"WorkingElsewhere"),new _d.$Uk(_nbs.NonBootStrings.l_FreeBusyTentative_Text,null,"Tentative"),new _d.$Uk(_nbs.NonBootStrings.l_FreeBusyBusy_Text,null,"Busy"),new _d.$Uk(_nbs.NonBootStrings.l_FreeBusyOof_Text,null,"OOF")];_d.$CN.$1TP=-1;_d.$CN.$A=_a.$0.$1c;_d.$5f.$A=_a.$0.$6y;_d.$CM.$A=_a.$0.$6y;_d.$Eo.$A=_a.$0.$3lB;_d.$Jf.$6kv=["TotalEvents0","TotalEvents1","TotalEvents2","TotalEvents3","TotalEvents4","TotalEvents5","TotalEvents6"];_d.$Ji.$5Nf=["Duration","TimeLabel","IsStartingEvent","IsEndingEvent"];_d.$1s.$6Il=["CanOpenItem","CanSelectItem","IsOwnerOfItem","CanUpdateItemDetails"];_d.$1s.$3sG=!1;_d.$7T.$5N4=6e4;_d.$3e.$A=_a.$0.$1c;_d.$3e.$4OK=["CalendarHeaderHeight","CalendarHeadersHidden"];_d.$PE.$1a=_a.$0.$2rT;_d.$Iw.$1a=_a.$0.$2rT;_d.$Cm.$1O6=new _H("EmailAddress",_g.$1q,_d.$Cm);_d.$Cm.$3jK=new _H("AttendeeType",_d.$oH,_d.$Cm);_d.$Cm.$21e=new _H("IsValid",Boolean,_d.$Cm);_d.$51.$5Nv=0;_d.$84.$1sw=new _H("CalendarItem",_g.$2o,_d.$84);_d.$84.$4Qz=new _H("OriginalCalendarItem",_g.$2o,_d.$84);_d.$84.$2qL=new _H("Attendees",_js.$c,_d.$84);_d.$84.$1zu=new _H("IsDraft",Boolean,_d.$84);_d.$84.$3wO=new _H("ForceDirty",Boolean,_d.$84);_d.$84.$$cctor();_d.$z.$A=_a.$0.$1c;_d.$IF.$A=_a.$0.$1c;_d.$4B.$4Ly="OOF";_d.$47.$I5=null;_d.$47.$eE=null;_d.$Gk.$sL="ItemID";_d.$FD.$5VR="DetailedMerged";_d.$P9.$1sw=new _H("CalendarItem",_g.$2o,_d.$P9);_d.$3d.$7qM=0;_d.$3d.$A=_a.$0.$1c;_d.$PA.$4Bj=1;_d.$65.$A=_a.$0.$1c;_d.$3a.$3uU=new _H("EventStart",_a.$7,_d.$3a);_d.$3a.$3uO=new _H("EventEnd",_a.$7,_d.$3a);_d.$3a.$3tE=new _H("DurationSelectedValue",_d.$14S,_d.$3a);_d.$3a.$4jA=new _H("ViewStartDate",_a.$7,_d.$3a);_d.$3a.$2xt=new _H("EventRequiredAttendees",_js.$c,_d.$3a);_d.$3a.$2xs=new _H("EventOptionalAttendees",_js.$c,_d.$3a);_d.$3a.$3L3=new _H("OriginalResourceAttendees",_js.$c,_d.$3a);_d.$3a.$3L2=new _H("OriginalRequiredAttendees",_js.$c,_d.$3a);_d.$3a.$3L1=new _H("OriginalOptionalAttendees",_js.$c,_d.$3a);_d.$3a.$4Z9=new _H("SelectedRoomList",_g.$1q,_d.$3a);_d.$3a.$4ZA=new _H("SelectedRoom",_g.$1q,_d.$3a);_d.$3a.$43k=new _H("IsAnyAvailableRoomSelected",Boolean,_d.$3a);_d.$3a.$$cctor();_d.$4m.$6Oa=0;_d.$4m.$5DO=3;_d.$5k.$A=_a.$0.$El;_d.$6p.$A=_a.$0.$El;_d.$Ek.$A=_a.$0.$El;_d.$Bo.$67=_a.$0.$7i;_d.$FA.$1a=_a.$0.$6m0;_d.$Uf.$1a=_a.$0.$5sA;_d.$4f.$1ai="CurrentMessage";_d.$4f.$2Tc="ItemsLoaded";_d.$4f.$2SL="IsLoadingRows";_d.$4f.$2UT=_u.Strings.l_ListViewModelDefaultLoadingMessage_Text;_d.$4f.$275=_u.Strings.l_MailNoResults_Text;_d.$4f.$6fR="ShowInfoMessage";_d.$4f.$4A9="";_d.$4f.$cp=_u.Strings.l_FailedRequestError_Text;_d.$5O.$4Ns=-864e5;_d.$7c.$A=_a.$0.$Ej;_d.$3E.$2TR=new _H("IsVisible",Boolean,_d.$3E,!1);_d.$3E.$44s=new _H("IsError",Boolean,_d.$3E,!1,null,_d.$3E.$9Tn);_d.$3E.$47N=new _H("IsRetriable",Boolean,_d.$3E,!1);_d.$3E.$45s=new _H("IsListening",Boolean,_d.$3E,!1,null,_d.$3E.$9Tt);_d.$3E.$484=new _H("IsThinking",Boolean,_d.$3E,!1,null,_d.$3E.$9Ty);_d.$3E.$4dB=new _H("SpeechLevel",Number,_d.$3E,0);_d.$3E.$4dV=new _H("StateDescription",String,_d.$3E,"");_d.$3E.$3hF=new _H("AdditionalInformation",_js.$c,_d.$3E);_d.$3E.$4N8=new _H("NoResultsAvailableText",String,_d.$3E,_nbs.NonBootStrings.l_SpeechNoResultsAvailable_Text);_d.$3E.$4dQ=new _H("StartListeningCommand",_js.$DK,_d.$3E);_d.$3E.$4dc=new _H("StopListeningCommand",_js.$DK,_d.$3E);_d.$Ov.$4AT=!1;_d.$Bn.$2Zz=null;_d.$Bn.$4Mx=["junkemail","drafts"];_d.$k1.$3r7=18e5;_d.$X6.$3r7=18e5;_d.$X6.$3AG=1e6;_d.$2f.$1xB={wasSuccessful:!1};_d.$2f.$5Cn={wasProxySuccessful:!1,errorMessage:_d.$2f.$12P};_d.$2f.$2Hs={wasSuccessful:!1,errorMessage:_d.$2f.$12P};_d.$2f.$5Co={error:1,errorMessage:_d.$2f.$12P};_d.$2f.$12P=String.format(_nbs.NonBootStrings.l_AsyncMethodNotExecutedBecauseAsyncLimitIsExceeded_Text,3);_d.$2f.$1pS=new RegExp(" ","g");_d.$VP.$5NL={wasSuccessful:!0};_d.$2q.$5T2="ExtensionBecomeActiveTestOnly";_d.$2q.$2a0="NoActiveOwaExtensions";_d.$2q.$2VC="MarketplaceUrl";_d.$2q.$3Jd="OnGetExtensibilityContextCompleted";_d.$2q.$5d4="HideExtensionContainer";_d.$2q.$59Y="ActiveExtensionsCount";_d.$2q.$12P=String.format(_nbs.NonBootStrings.l_AsyncMethodNotExecutedBecauseAsyncLimitIsExceeded_Text,3);_d.$2q.$35S=!1;_d.$2q.$1On=null;_d.$RI.$EH={};_d.$IJ.$5d6="HideExtensionContextMenu";_d.$IJ.$4fF="TabSelectedExtension";_d.$GJ.$33B=window.matchMedia&&window.matchMedia("screen and (-webkit-min-device-pixel-ratio: 2)").matches;_d.$Tr.$5OK=new _g.$SG("Default");_d.$67.$A=_a.$0.$4g;_d.$9X.$A=_a.$0.$4g;_d.$8Z.$4Yh=new _H("SearchTerm",String,_d.$8Z);_d.$8Z.$4YY=new _H("SearchPositionLatitude",Number,_d.$8Z);_d.$8Z.$4YZ=new _H("SearchPositionLongitude",Number,_d.$8Z);_d.$8Z.$4Z3=new _H("SelectedOptionIndex",Number,_d.$8Z);_d.$8Z.$4Z0=new _H("SelectedLocation",_g.$3V,_d.$8Z);_d.$An.$3jH=new _H("AttachmentWellViewModel",_y.$18b,_d.$An);_d.$An.$1FZ=new _H("Menu",_0365m.$2c,_d.$9q);_d.$DY.$4AG=new _y.$32(_nbs.NonBootStrings.l_LoadingPermissions_LowerCase_Text,null,null);_d.$Rk.$1FZ=new _H("Menu",_0365m.$2c,_d.$Rk);_d.$DX.$6SF=[6800,3200,3205,3210,3215,3220,3100,3105,3110,3115,3120,3250,3255,3260];_d.$Bv.$TX=[84,85,86,87];_d.$90.$3wc=new _H("FromDetailsViewModel",_d.$96,_d.$90);_d.$90.$4Zd=new _H("SenderDetailsViewModel",_d.$96,_d.$90);_d.$90.$4AQ=new _H("LocationViewModel",_cc.$EQ,_d.$90);_d.$90.$46C=new _H("IsMeetingForwardOnBehalfOf",Boolean,_d.$90);_d.$90.$9lz=new _H("RecurrencePatternDataObject",_cc.$De,_d.$90);_d.$KE.$29W=7;_d.$KE.$6Uu=1;_d.$4x.$4X1=new _H("ResizeEditorCommand",_js.$DK,_d.$4x);_d.$6l.$TX=[60,40,43,1001,700,50,800,88,89];_d.$Ez.$1FZ=new _H("Menu",_0365m.$2c,_d.$Ez);_d.$7F.$4Bb=10;_d.$7F.$TX=[62,45,46,47,700,55,70,65,66,75,800,88,80,48,89];_d.$ET.$6gm=_a.UserAgent.getInstance().$9W?_js.$8.$4B("{0}{0}","<P></P>"):_js.$8.$4B("{0}{0}","<P><BR></P>");_d.$ET.$6VM=new RegExp("[\n\r]+","g");_d.$Mi.$1Lh=["mailto:"];_d.$Q1.$1Lh=["mailto:"];_d.$Oa.$5VB=new RegExp("([\\w-\\.@]+)\\s\\<\\s*[\\w-\\.]+@[\\w-\\.]+\\s*\\>");_d.$Oa.$2xI=new RegExp("([\\w-\\.]+)@[\\w-\\.]+");_d.$S.$4jF=new _H("ViewModelId",String,_d.$S);_d.$S.$2b9=new _H("Operation",_y.$Hk,_d.$S);_d.$S.$17F=new _H("Mode",_y.$lB,_d.$S);_d.$S.$4R3=new _H("OriginalId",_g.$1t,_d.$S);_d.$S.$4R2=new _H("OriginalDocumentId",Number,_d.$S);_d.$S.$4R4=new _H("OriginalItem",_g.$y,_d.$S);_d.$S.$3t4=new _H("DraftId",_g.$1t,_d.$S);_d.$S.$4di=new _H("StoreId",String,_d.$S);_d.$S.$Zd=new _H("Subject",String,_d.$S,"");_d.$S.$1vj=new _H("EditorContent",String,_d.$S,"");_d.$S.$4V2=new _H("RawEditorContent",String,_d.$S);_d.$S.$4fi=new _H("TextEditorContent",String,_d.$S);_d.$S.$3kD=new _H("BodyType",String,_d.$S);_d.$S.$1Wy=new _H("ToRecipients",_js.$MX,_d.$S);_d.$S.$3U8=new _H("SpeechResultRecipients",_js.$MX,_d.$S);_d.$S.$2Dp=new _H("ToQueryString",String,_d.$S);_d.$S.$1MU=new _H("CcRecipients",_js.$MX,_d.$S);_d.$S.$1tJ=new _H("CcQueryString",String,_d.$S);_d.$S.$1M6=new _H("BccRecipients",_js.$MX,_d.$S);_d.$S.$1sQ=new _H("BccQueryString",String,_d.$S);_d.$S.$3Ru=new _H("AutoAddSignature",Boolean,_d.$S,!0);_d.$S.$1yp=new _H("Importance",String,_d.$S,"Normal");_d.$S.$4Uu=new _H("QuotedBody",String,_d.$S);_d.$S.$4cl=new _H("SmimeContent",String,_d.$S);_d.$S.$4cn=new _H("SmimeErrorCode",Number,_d.$S);_d.$S.$4co=new _H("SmimeRecipientCerts",Array,_d.$S);_d.$S.$4ck=new _H("SmimeCertRawData",String,_d.$S);_d.$S.$44L=new _H("IsComplete",Boolean,_d.$S);_d.$S.$368=new _H("IsMeeting",Boolean,_d.$S);_d.$S.$46D=new _H("IsMeetingForward",Boolean,_d.$S);_d.$S.$47F=new _H("IsReplyAllOnBcc",Boolean,_d.$S);_d.$S.$22d=new _H("Location",_g.$3V,_d.$S);_d.$S.$40T=new _H("HasLocation",Boolean,_d.$S);_d.$S.$4Bn=new _H("MeetingCalendarTimePeriod",_cc.$9C,_d.$S);_d.$S.$4Ud=new _H("ProposedNewTime",_cc.$BD,_d.$S);_d.$S.$1x4=new _H("From",_g.$Bc,_d.$S);_d.$S.$4Zf=new _H("Sender",_g.$Bc,_d.$S);_d.$S.$48F=new _H("IsUpgraded",Boolean,_d.$S);_d.$S.$459=new _H("IsFromShown",Boolean,_d.$S);_d.$S.$43y=new _H("IsBccShown",Boolean,_d.$S);_d.$S.$28P=new _H("ParentFolderNameToPost",String,_d.$S);_d.$S.$4Rn=new _H("ParentFolderIdToPost",_g.$3R,_d.$S);_d.$S.$1Yo=new _H("AttachmentCollection",_js.$c,_d.$S);_d.$S.$3jB=new _H("AttachmentsToHide",Array,_d.$S);_d.$S.$4iX=new _H("UpgradeFailed",Boolean,_d.$S);_d.$S.$3k0=new _H("Baseline",_d.$1m,_d.$S);_d.$S.$40G=new _H("HasBeenSavedByUser",Boolean,_d.$S);_d.$S.$47H=new _H("IsReplyForward",Boolean,_d.$S);_d.$S.$3t6=new _H("Draft",_g.$y,_d.$S);_d.$S.$4Xc=new _H("RightsManagementLicenseData",_g.$gS,_d.$S);_d.$S.$1tg=new _H("ComplianceId",String,_d.$S);_d.$S.$44E=new _H("IsClassified",Boolean,_d.$S);_d.$S.$3mR=new _H("ClassificationGuid",String,_d.$S);_d.$S.$3mT=new _H("Classification",String,_d.$S);_d.$S.$3mQ=new _H("ClassificationDescription",String,_d.$S);_d.$S.$3mS=new _H("ClassificationKeep",Boolean,_d.$S);_d.$S.$2BH=new _H("Sensitivity",String,_d.$S,"Normal");_d.$S.$1zo=new _H("IsDeliveryReceiptRequested",Boolean,_d.$S);_d.$S.$215=new _H("IsReadReceiptRequested",Boolean,_d.$S);_d.$S.$2CV=new _H("SmimeEncryptMessage",Boolean,_d.$S);_d.$S.$2CW=new _H("SmimeSignMessage",Boolean,_d.$S);_d.$S.$1ts=new _H("ConversationId",_g.$1t,_d.$S);_d.$S.$4Rk=new _H("ParentConversationNodeId",String,_d.$S);_d.$S.$46g=new _H("IsOriginalIdCalendarItemId",Boolean,_d.$S);_d.$S.$46c=new _H("IsOccurrenceReferencingMaster",Boolean,_d.$S);_d.$S.$46r=new _H("IsPoppedOutFromInline",Boolean,_d.$S);_d.$S.$45w=new _H("IsLoadedDraft",Boolean,_d.$S);_d.$S.$4jb=new _H("WasCleanNewMessageBeforePopout",Boolean,_d.$S);_d.$S.$41C=new _H("HideIncludeEntrypoint",Boolean,_d.$S,!1);_d.$S.$4jf=new _H("WasSavingBeforePopout",Boolean,_d.$S,!1);_d.$S.$46S=new _H("IsMovedToDraftFromOutbox",Boolean,_d.$S,!1);_d.$S.$4SR=new _H("PerfContext",_a.$AA,_d.$S,null);_d.$S.$4XZ=new _H("RichTextEditorSupported",Boolean,_d.$S,null);_d.$S.$3si=new _H("DlpSenderOverride",String,_d.$S,null);_d.$S.$3sh=new _H("DlpFalsePositive",String,_d.$S,null);_d.$S.$3uy=new _H("ExplicitLogonUser",String,_d.$S,null);_d.$S.$42B=new _H("IncludeOriginalFromInToRecipients",Boolean,_d.$S,!1);_d.$S.$1c4=new _H("ExtendedPropertyCollection",_js.$c,_d.$S,null);_d.$S.$11D=null;_d.$S.$$cctor();_d.$1m.$Zd=new _H("Subject",String,_d.$1m,"");_d.$1m.$1vj=new _H("EditorContent",String,_d.$1m,"");_d.$1m.$1Wy=new _H("ToRecipients",_js.$c,_d.$1m);_d.$1m.$2Dp=new _H("ToQueryString",String,_d.$1m);_d.$1m.$1MU=new _H("CcRecipients",_js.$c,_d.$1m);_d.$1m.$1tJ=new _H("CcQueryString",String,_d.$1m);_d.$1m.$1M6=new _H("BccRecipients",_js.$c,_d.$1m);_d.$1m.$1sQ=new _H("BccQueryString",String,_d.$1m);_d.$1m.$1yp=new _H("Importance",String,_d.$1m,"Normal");_d.$1m.$1x4=new _H("From",_g.$1q,_d.$1m);_d.$1m.$1tg=new _H("ComplianceId",String,_d.$1m);_d.$1m.$2BH=new _H("Sensitivity",String,_d.$1m,"Normal");_d.$1m.$1zo=new _H("IsDeliveryReceiptRequested",Boolean,_d.$1m);_d.$1m.$215=new _H("IsReadReceiptRequested",Boolean,_d.$1m);_d.$1m.$2CV=new _H("SmimeEncryptMessage",Boolean,_d.$1m);_d.$1m.$2CW=new _H("SmimeSignMessage",Boolean,_d.$1m);_d.$1m.$1Yo=new _H("AttachmentCollection",_js.$c,_d.$1m);_d.$1m.$1c4=new _H("ExtendedPropertyCollection",_js.$c,_d.$1m,null);_d.$1m.$2xG=new _a.$EP(_g.$1q);_d.$1m.$$cctor();_d.$AU.$A=_a.$0.$l;_d.$r8.$Xn.$4Nu=new _d.$ZC(_u.Strings.l_MailSearchRefinerDateOlderThan1Week_Text,0);_d.$r8.$Xn.$4Nt=new _d.$ZC(_u.Strings.l_MailSearchRefinerDateOlderThan1Month_Text,0);_d.$r8.$Xn.$4Nv=new _d.$ZC(_u.Strings.l_MailSearchRefinerDateOlderThan1Year_Text,0);_d.$CU.$A=_a.$0.$1P;_d.$IR.$A=_a.$0.$6E;_d.$5M.$ML=_a.$0.$7i;_d.$5M.$2tS=null;_d.$5M.$$cctor();_d.$Ru.$A=_a.$0.$4Lm;_d.$OO.$A=_a.$0.$GG;_d.$KL.$A=_a.$0.$GG;_d.$LR.$A=_a.$0.$GG;_d.$Mq.$A=_a.$0.$GG;_d.$F1.$A=_a.$0.$GG;_d.$LS.$49Q=new _H("LastSelectedItem",_d.$KM,_d.$LS,null,null,null);_d.$9b.$A=_a.$0.$GG;_d.$Zj.$6om="\\((?:UTC|GMT)[\\s\\d\\+\\-:]*\\)";_d.$Ca.$67=_a.$0.$1nq;_d.$Iz.$A=_a.$0.$A7;_d.$AC.$A=_a.$0.$A7;_d.$52.$A=_a.$0.$7i;_d.$cF.$1ul=_nbs.NonBootStrings.l_DisplayPreferences_LowerCase_Text;_d.$La.$6Qv=[8,0,2,1];_d.$La.$6Qw=[9,0,2,1];_d.$8m.$A=_a.$0.$AC;_d.$8m.$1ul=_nbs.NonBootStrings.l_PeopleFilterListDefaultTitle_Text;_d.$3l.$2sK="ChatSignInState";_d.$3l.$45T="IsIMPresenceStateAvailable";_d.$3l.$6So="PresenceImageType";_d.$3l.$5sa="MeTileAriaLabel";_d.$3l.$5hM="IsBusy";_d.$3l.$5Eh="BusyMessage";_d.$3l.$3uG="ErrorMessage";_d.$3l.$A=_a.$0.$23K;_d.$3l.$5R8="PersonalSettings/EditAccount.aspx?chgPhoto=1";_d.$3l.$5RA="_blank";_d.$3l.$5R9="width=600,height=400,toolbar=no,directories=no,status=no,menubar=no,scrollbars=no";_d.$3l.$6Gp=7;_d.$Hs.$A=_a.$0.$2bo;_d.$4y.$A=_a.$0.$A7;_d.$2n.$A=_a.$0.$A7;_d.$5Y.$44u=new _H("IsExpandable",Boolean,_d.$5Y);_d.$5Y.$1Hw=new _H("Persona",_pc.$l,_d.$5Y);_d.$5Y.$17F=new _H("Mode",_d.$1CV,_d.$5Y);_d.$5Y.$49Y=new _H("LayoutType",_y.$1Cc,_d.$5Y);_d.$5Y.$3ni=new _H("ControlSize",_y.$1Ca,_d.$5Y);_d.$5Y.$4TF=new _H("PivotSelectedOptionIndex",Number,_d.$5Y);_d.$5Y.$44A=new _H("IsCardInPopoutState",Boolean,_d.$5Y);_d.$5Y.$3pE=new _H("CreatePersonaCardUnderMyContactsFolder",Boolean,_d.$5Y);_d.$5Y.$4Rm=new _H("ParentFolderId",_g.$3R,_d.$5Y);_d.$EY.$A=_a.$0.$AC;_d.$Ve.$1ul=_nbs.NonBootStrings.l_SortOptionsListDefaultTitle_Text;_d.$IK.$A=_a.$0.$Xv;_d.$2C.$A=_a.$0.$Xv;_d.$KU.$A=_a.$0.$Xv;_d.$Bf.$A=_a.$0.$19a;_d.$Os.$A=_a.$0.$19a;_d.$I3.$A=_a.$0.$19a;_d.$Si.$A=_a.$0.$19a;_d.$Vl.$A=_a.$0.$4fV;_d.$Ot.$3WF=175;_d.$Ot.$3WE=47;_d.$8q.$4fQ=new _H("Task",_g.$9Q,_d.$8q);_d.$8q.$3tM=new _H("EditedTask",_g.$9Q,_d.$8q);_d.$8q.$46X=new _H("IsNewTask",Boolean,_d.$8q);_d.$8q.$44n=new _H("IsEditMode",Boolean,_d.$8q);_d.$8q.$1zu=new _H("IsDraft",Boolean,_d.$8q);_d.$56.$A=_a.$0.$19a;_d.$4Z.$A=_a.$0.$28s;_d.$4Z.$3lf=new _H("CanDial",Boolean,_d.$4Z,!0);_d.$4Z.$4TO=new _H("PlayOnPhoneActive",Boolean,_d.$4Z,!1);_d.$4Z.$3s5=new _H("DialString",String,_d.$4Z,"");_d.$4Z.$4C9=new _H("MessageText",String,_d.$4Z,"");_d.$4Z.$4TP=new _H("PlayOnPhoneCommand",_js.$DK,_d.$4Z);_d.$4Z.$4TQ=new _H("PlayOnPhoneDisconnectCommand",_js.$DK,_d.$4Z);_d.$4Z.$4TN=new _H("PlayOnPhoneActiveCommand",_js.$DK,_d.$4Z);_d.$4Z.$46o=new _H("IsPhoneCallActive",Boolean,_d.$4Z,!1);_d.$CK.$15s=new _H("Item",_g.$hu,_d.$CK);_d.$CK.$4d4=new _H("Source",_d.$oI,_d.$CK,null);_d.$CK.$4TS=new _H("PlayOnPhoneViewModel",_d.$4Z,_d.$CK);_d.$DH.$5Mg="CurrentItem";_d.$DH.$5nB="ItemNotSupported";_d.$DH.$6Ew="MoveButtonText";_d.$DH.$7pv="DebugInfo";_d.$DH.$8Jc="IsCurrentModuleTasksModule";_d.$FW.$3Uo=null;_d.$FW.$$cctor();_d.$Tx.$5DI=String.format("service.svc/s/GetFileAttachment?id={0}","");_d.$3Y.$TX=[91];_d.$46.$TX=[300,100,200,4100,4300,3900,4e3];_d.$Cq.$A=_a.$0.$A7;_d.$5G.$5sE="Members";_d.$5G.$6PM="Owners";_d.$5G.$45I="IsGroupOwnersPivotSelected";_d.$5G.$45G="IsGroupMembersPivotSelected";_d.$5G.$45H="IsGroupNotesPivotSelected";_d.$B5.$5jj="IsLocationInformationPivotSelected";_d.$B5.$6Tv="ProfileFieldsForLocations";_d.$7u.$49p="LinkingActionInProgress";_d.$7u.$6iJ="ErrorCode";_d.$Ri.$A=_a.$0.$1F6;_d.$5T.$5ck="HeaderTextViewModel";_d.$5T.$5cg="HeaderImageViewModel";_d.$5T.$6gy="SingleComponent";_d.$5T.$6gz="SingleComponentText";_d.$5T.$A=_a.$0.$1F6;_d.$OG.$4he=-1;_d.$4l.$6fm="ShowOrganizationPanel";_d.$4l.$5dC="HideManagerList";_d.$4l.$5Pc="DirectReports";_d.$4l.$6QH="Peers";_d.$4l.$5qq="Manager";_d.$4l.$5qo="ManagementChain";_d.$4l.$5iz="IsHierarchyAvailable";_d.$4l.$3Kw="OrganizationHierarchyLoadCompleted";_d.$4l.$5d3="HideDirectReportsList";_d.$4l.$5d9="HideManagementChainList";_d.$4l.$5dK="HidePeersList";_d.$4l.$5kL="IsOrganizationHierachyLoading";_d.$7v.$A=_a.$0.$A7;_d.$30.$5dB="HideManageProfiles";_d.$30.$41D="HideModernGroupMembershipPivotContent";_d.$30.$5jC="IsInformationPivotSelected";_d.$30.$5jy="IsModernGroupMembershipPivotSelected";_d.$30.$5kD="IsNotesPivotSelected";_d.$30.$48B="IsTwoColumnWidth";_d.$30.$6EW="ModernGroupMembershipPivotViewModel";_d.$30.$4Qx="OrganizationHierarchyViewModel";_d.$30.$A=_a.$0.$A7;_d.$30.$4hf=-1;_d.$9N.$6Qs="Persona";_d.$9N.$A=_a.$0.$A7;_d.$7l.$A=_a.$0.$A7;_d.$7l.$5gy=!1;_d.$7l.$348=!1;_d.$8C.$A=_a.$0.$dz;_d.$5a.$hl=_a.$0.$1XG