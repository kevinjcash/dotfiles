Type.registerNamespace("_h");_h.$v2=function(n){this.$$d_$8Dy=Function.createDelegate(this,this.$8Dy);_h.$v2.initializeBase(this);this.$2pi=n;this.$4f=new _C(this.$$d_$8Dy,_a.$0.$LA);this.set_$r(!0);this.set_$Az(this.$2pi.$wC);var t=this;this.$2pi.$Y("AppStatus",function(){t.set_$Az(t.$2pi.$wC)})};_h.$v2.prototype={$2pi:null,$Co:null,$4f:null,$6Z:!1,get_$Az:function(){return this.$Co},set_$Az:function(n){if(n!==this.$Co){this.$Co=n;$3(this,"Status");_js.$8.$a(this.$Co)?this.set_$r(!0):this.set_$r(!1)}return n},get_$r:function(){return this.$6Z},set_$r:function(n){if(n!==this.$6Z){this.$6Z=n;$3(this,"IsHidden")}return n},get_$Fw:function(){return this.$4f},$8Dy:function(){this.set_$r(!0)}};_h.$St=function(){};_h.$St.prototype={initialize:1,reachShowLimit:2,appCacheStatusChanges:3,removeALT1doneText:4,removeUpdatingPausedText:5,removeDisconnectedText:6,removeConnectingText:7,removeUpToDateText:8,connectionStatusChange:9,detectingConnectivityChange:10,syncingStatusEvent:11,postALT1SyncOrderChange:12};_h.$St.registerEnum("_h.$St",!1);_h.$iN=function(){};_h.$AI=function(n,t,i,r,u){this.$$d_$4O4=Function.createDelegate(this,this.$4O4);this.$$d_$8Bz=Function.createDelegate(this,this.$8Bz);this.$$d_$8AR=Function.createDelegate(this,this.$8AR);this.$$d_$8AQ=Function.createDelegate(this,this.$8AQ);this.$67=_a.$0.$LA;this.$1PA=new Sys.EventHandlerList;this.$F6=t;this.$J=n;this.$44=i;this.$TT=r;this.$1A5=!1;this.$1wW=!1;this.$1dv=!1;this.$38V=this.$TT.get_$Va();this.$2NV=_a.$7.$Yu.$5X();this.$1E0=null;u&&($4wy(this,u.status)?this.$F6.set_$1re(!0):$4wz(this,u.status)&&this.$F6.set_$1re(!1));$7Dk(this);$4x0(this)};function $7Dk(n){_js.Trace.logInfo(n.$67,"AppCacheStatusMonitor subscribe to events");n.$J.$Hd(_h.$o3,n.$$d_$8AQ);n.$J.$Hd(_h.$ih,n.$$d_$8AR);n.$J.$Hd(_a.$OQ,n.$$d_$8Bz);n.$J.$Hd(_h.$ik,n.$$d_$4O4)}function $2ly(n){var t=n.$1PA.getHandler("StatusChanged");t&&t()}function $7Dh(n,t){n.$1PA.addHandler("StatusChanged",t)}function $7Dj(n,t){n.$1PA.removeHandler("StatusChanged",t)}function $7Di(n){if(n.$TT.get_$Va().$5X()-n.$38V.$5X()>3e5){_js.Trace.logInfo(n.$67,"AppCacheInstaller stopped");if(n.$1E0){n.$44.$5A(n.$1E0);n.$1E0=null}n.set_$5fg(!0)}}function $4wy(n,t){return t===1||t===4}function $4wz(n,t){return t===5||!t}function $4x0(n){if(!n.$F6.get_$1re()&&!n.$1E0){n.set_$5fg(!1);var t=this;n.$1E0=n.$44.$p3(n.$67,"installerStoppedDuringALT1Check",function(){$7Di(n)},3e5)}}_h.$AI.prototype={$J:null,$F6:null,$44:null,$TT:null,$38V:null,$1E0:null,$1dv:!1,$1A5:!1,$2NV:0,$1wW:!1,add_$A4Q:function(n){$7Dh(this,n)},remove_$A4Q:function(n){$7Dj(this,n)},get_$6pB:function(){return this.$1A5},set_$6pB:function(n){if(this.$1A5!==n){this.$1A5=n;$2ly(this)}return n},get_$5U1:function(){return this.$1wW},set_$5U1:function(n){if(this.$1wW!==n){this.$1wW=n;$2ly(this)}return n},get_$5fg:function(){return this.$1dv},set_$5fg:function(n){if(this.$1dv!==n){this.$1dv=n;$2ly(this)}return n},get_$A2B:function(){var n=this.$TT.get_$Va().$5X();_js.Trace.logInfo(this.$67,String.format("Now = {0}, ResumeTime = {1}, pausedShowTime = {2}, ConnectingShowtime = {3}, InactiveTime = {4}, FirstVersionMismatchTime = {5}",n,this.$F6.get_$2pd(),5e3,3e3,this.$F6.get_$2pc(),this.$2NV));return this.$F6.get_$2pc()>this.$2NV&&n<this.$F6.get_$2pd()+5e3+3e3},$8AQ:function(n){_js.Trace.logInfo(this.$67,String.format("Receiving AppCacheStatus={0}",_a.$ux.toString(n.$Co)));this.$38V=this.$TT.get_$Va();if($4wy(this,n.$Co)){_js.Trace.logInfo(this.$67,"AppCache finishes downloading");this.$F6.set_$1re(!0);this.$1wW=!0;this.$1A5=!1;if(this.$1E0){this.$44.$5A(this.$1E0);this.$1E0=null}$2ly(this)}else $4wz(this,n.$Co)&&this.$F6.set_$1re(!1);$4x0(this)},$8AR:function(n){_js.Trace.logInfo(this.$67,"AppCache finishs the update");this.set_$6pB(!1);this.set_$5U1(!0)},$8Bz:function(n){if(!n.$Vs&&!this.$1A5){this.$2NV=this.$TT.get_$Va().$5X();_js.Trace.logInfo(this.$67,String.format("firstVersionMismatchTime={0}",this.$2NV));this.set_$6pB(!0);this.set_$5U1(!1)}},$4O4:function(n){_js.Trace.logInfo(this.$67,"Reset lastStatusEventTime when app comes from background to foreground");this.$38V=this.$TT.get_$Va()}};_h.$72=function(n,t,i,r,u,f,e,o){this.$$d_$8Cd=Function.createDelegate(this,this.$8Cd);this.$$d_$8CX=Function.createDelegate(this,this.$8CX);this.$$d_$4OW=Function.createDelegate(this,this.$4OW);this.$$d_$4O4=Function.createDelegate(this,this.$4O4);this.$67=_a.$0.$LA;_h.$72.initializeBase(this);this.$1As=e;this.$F6=i;this.$J=n;this.$1A=t;this.$TT=u;this.$44=r;this.$Bv=f;var s=this;this.$Bv.$Y("DetectingConnectivity",function(){$7Dn(s)});this.$492=_a.$7.$Yu.$5X();this.$2Uf=_a.$7.$Yu.$5X();this.$3Na=null;this.$28Y=null;this.$2Jw=null;this.$3I0=!1;o&&(this.$1RF=o);$7Do(this);$7Dq(this)};function $7Dq(n){n.$J.$Hd(_h.$ik,n.$$d_$4O4);n.$J.$Hd(_a.$TR,n.$$d_$4OW);n.$J.$Hd(_h.$Sd,n.$$d_$8CX);n.$J.$Hd(_h.$iN,n.$$d_$8Cd);var t=this;n.$1As.add_$A4Q(function(){$1L5(n,3)})}function $7Dp(n){$4x1(n);switch(n.$wC){case _u.Strings.l_AppStatus_ALT1Done_Text:n.$F6.set_$2Pb(!0);$1qL(n,null,1e4,4);break;case _u.Strings.l_AppStatus_AppCachePaused_Text:$1qL(n,null,5e3,5);break;case _u.Strings.l_AppStatus_Disconnected_Text:$1qL(n,null,1e4,6);break;case _u.Strings.l_AppStatus_Connecting_Text:$1qL(n,null,3e3,7);break;case _u.Strings.l_AppStatus_MailSyncComplete_Text:n.$5oC=n.$1RF.get_$43N();$1qL(n,null,3e3,8);break;default:break}}function $1qL(n,t,i,r){_js.Trace.logInfo(n.$67,"Scheduling timer callback to {0} with delay {1}",_h.$St.toString(r),i);$4x1(n);var u=this;n.$28Y=n.$44.$1s(n.$67,_h.$St.toString(r),function(){n.$28Y=null;t&&t();$1L5(n,r)},i)}function $4x1(n){if(n.$28Y){_js.Trace.logInfo(_a.$0.$LA,"Cancelling existing pending updater");n.$44.$5A(n.$28Y);n.$28Y=null}}function $7Do(n){if(n.$F6.get_$5CN())n.set_$LA(_u.Strings.l_AppStatus_Connecting_Text);else{n.$F6.set_$5CN(!0);$1L5(n,1)}}function $1L5(n,t){_js.Trace.logInfo(n.$67,"TryUpdateAppStatus {0}",_h.$St.toString(t));if(!n.$Bv.$1bE)if(n.$Bv.$QD)if(n.$F6.get_$1re()&&n.$F6.get_$1A0()||n.$1As.$1A5)if(n.$1As.$1A5){_js.Trace.logInfo(n.$67,"VersionMismatchReported");n.$1As.get_$A2B()?n.set_$LA(_u.Strings.l_AppStatus_AppCachePaused_Text):n.set_$LA(_u.Strings.l_AppStatus_AppCacheDownloading_Text)}else if(n.$F6.get_$2Pb()||!n.get_$4bg()){_js.Trace.logInfo(n.$67,"Check syncing status");n.$1RF&&n.$1RF.$2jT?n.$1RF.$1Qd?n.set_$LA(_u.Strings.l_AppStatus_MailSyncing_Text):n.$TT.get_$Va().$5X()-n.$1RF.get_$43N()<3e3?n.$wC===_u.Strings.l_AppStatus_MailSyncComplete_Text?n.$5oC!==n.$1RF.get_$43N()&&$1qL(n,null,3e3,8):n.set_$LA(_u.Strings.l_AppStatus_MailSyncComplete_Text):n.set_$LA(""):n.set_$LA("")}else n.set_$LA(_u.Strings.l_AppStatus_ALT1Done_Text);else{_js.Trace.logInfo(n.$67,"ALT1");n.get_$4bg()&&(n.$1As.$1dv?n.set_$LA(_u.Strings.l_AppStatus_AppCacheAborted_Text):n.set_$LA(_u.Strings.l_AppStatus_ALT1_Text))}else{var i=n.$TT.get_$Va().$5X();_js.Trace.logInfo(n.$67,"App disconnected, now={0},lostconnectionTimeMS={1}",i,n.$2Uf);if(i-n.$2Uf<1e4||n.$wC===_u.Strings.l_AppStatus_Connecting_Text)n.set_$LA(_u.Strings.l_AppStatus_Disconnected_Text);else{_js.Trace.logInfo(n.$67,"InstallerStoppedDuringALT1={0}",n.$1As.$1dv);n.get_$4bg()&&n.$1As.$1dv&&!n.$1As.$1wW?n.set_$LA(_u.Strings.l_AppStatus_AppCacheAborted_Text):n.set_$LA("")}}}function $7Dn(n){_js.Trace.logInfo(_a.$0.$LA,"HandleConnectionManagerChanges");if(!n.$Bv.$1bE){if(n.$3I0){n.$Bv.$QD||$4x2(n,10);n.$3I0=!1}$1L5(n,10)}}function $4x2(n,t){if(n.$wC!==_u.Strings.l_AppStatus_Disconnected_Text){n.$2Uf=n.$TT.get_$Va().$5X();_js.Trace.logInfo(_a.$0.$LA,"{0} Set lostConnectionTimeMS = {1}",_h.$St.toString(t),n.$2Uf)}}_h.$72.prototype={$F6:null,$J:null,$44:null,$TT:null,$1A:null,$Bv:null,$wC:null,$492:0,$2Uf:0,$3I0:!1,$3Na:null,$28Y:null,$2Jw:null,$1As:null,$1RF:null,$5oC:0,get_$LA:function(){return this.$wC},set_$LA:function(n){if(n!==this.$wC){var t;t=this.$wC===""?0:this.$492+3e3-this.$TT.get_$Va().$5X();if(t<=0){this.$wC=n;this.$492=this.$TT.get_$Va().$5X();_js.Trace.logInfo(this.$67,"Rasing AppStatusEvent Status = {0}",this.$wC);$7Dp(this);$N(this,"AppStatus")}else if(!this.$3Na){_js.Trace.logInfo(this.$67,"Can't set status to {0} within the limit, scheduling a timer callback to update the status with delay = {1}",n,t);var i=this;this.$3Na=this.$44.$1s(this.$67,"UpdateAppStatus",function(){i.$3Na=null;$1L5(i,2)},t)}}return n},get_$4bg:function(){return this.$1A.get_$3It()},$4OW:function(n){_js.Trace.logInfo(_a.$0.$LA,"OnConnectionStatusChanged");if(this.$2Jw){_js.Trace.logInfo(_a.$0.$LA,"Cancel connectionStatusDelayer");this.$44.$5A(this.$2Jw)}var t=this;this.$2Jw=this.$44.$1s(this.$67,"ConnectionStatusDelayer",function(){t.$2Jw=null;if(t.$Bv.$1bE){_js.Trace.logInfo(_a.$0.$LA,"Don't change the app status since it's still detecting the connectivity");t.$3I0=!0}else{t.$Bv.$QD||$4x2(t,9);$1L5(t,9)}},3e3)},$4O4:function(n){_js.Trace.logInfo(this.$67,"OnAppResume");this.set_$LA(_u.Strings.l_AppStatus_Connecting_Text)},$8CX:function(n){if(_h.$4S.isInstanceOfType(n.$2C)){this.$1RF=n.$2C;$1L5(this,11)}},$8Cd:function(n){$1L5(this,12)}};_h.$Jp=function(n,t,i){_h.$Jp.resolveInheritance();this.dispose=this.$1R;_h.$Jp.initializeBase(this,[n,t,i,[10]])};function $2lz(n){n.set_$1Qe(n.$Bv.$QD&&n.$2TE)}_h.$Jp.prototype={$2TE:!1,$8Bh:function(n){this.$2TE=!0;$2lz(this)},$8Bg:function(n){this.$2TE=!1;$2lz(this)},$8CW:function(n){if(this.$2TE){_js.Trace.logWarning(_h.$Jp.$A,"Failed to get module finish event for calendar module and received sync complete event. This may indicate a problem in the sync framework.");this.$2TE=!1;$2lz(this)}},$8An:function(){$2lz(this)}};_h.$4S=function(n,t,i,r,u,f,e,o){this.$$d_$8AP=Function.createDelegate(this,this.$8AP);this.$$d_$9PF=Function.createDelegate(this,this.$9PF);this.$$d_$8Aw=Function.createDelegate(this,this.$8Aw);this.$$d_$40A=Function.createDelegate(this,this.$40A);_h.$4S.resolveInheritance();this.dispose=this.$1R;_h.$4S.initializeBase(this,[i,u,e,[4,11,5,12]]);_a.$3.$K(n,"userConfiguration");_a.$3.$K(t,"folderMappings");_a.$3.$K(r,"clientStore");_a.$3.$K(f,"syncFolderSettingProcessor");this.$b=n;this.$1i=t;this.$7b=r;this.$ER=f;this.$vW=o;this.$pc=_a.$3r.$$(Number).$8V();this.$3wL=_a.$3r.$$(Number).$8V();$7EX(this);$7EY(this);this.set_$6pH(this.$vW.get_$2Gk()===_h.$4S.$4Ax);$1qM(this)};function $7EV(n,t,i){_a.$3.$K(t,"unsentInfo");_a.$3.$K(i,"updateInfo");var r;r=t.length>0?i.length>0?String.format("{0}{1}{2}",t,_u.Strings.l_OfflineActivityInfoSeperator_Text,i):t:i;return r}function $4xM(n){_js.Trace.logInfo(_h.$4S.$A,"UpdateModuleFinishStatus");n.$3wL.set_$3o(n.$2ho,_a.$7.get_utcNow().$5X());n.$ao.Id===n.$2ho&&n.set_$2R6(!1);n.$2ho=""}function $7EX(n){var t=n.$1i.nameToId("inbox");n.set_$15G(t)}function $7EY(n){$4xN(n);n.$J.$Hd(_h.$NG,n.$$d_$40A);n.$J.$Hd(_h.$jg,n.$$d_$8Aw);n.$J.$Hd(_a.$bl,n.$$d_$9PF);n.$vW.add_$59b(n.$$d_$8AP)}function $1qM(n){_js.Trace.logInfo(_h.$4S.$A,"UpdateMailActivityInfo: Connected:{0}",n.$Bv.$QD);if(n.$Bv.$QD&&n.$2R5&&n.$2jT){n.set_$4Al("");n.set_$1Qe(!0);return}n.set_$1Qe(!1);$7EZ(n);if(n.$Bv.$QD)n.set_$4Al($4xL(n));else{var t=this;$7EW(n,function(t){n.$Bv.$QD||n.set_$4Al($7EV(n,$4xL(n),t))})}}function $7EZ(n){n.set_$7fs(!n.$Bv.$QD&&n.$1kC>0)}function $4xL(n){return n.$1kC>0?String.format(_u.Strings.l_UnsentInfo_Text,n.$1kC):""}function $7EW(n,t){var i="";var u=n.$b.get_$5U().$aW(n.$ao);var r=-1;u.$Bm===1?r=4:(u.$Bm===2||u.$Bm===3)&&(r=5);if(!n.$ER.$8Kk(r,n.$ao.Id)){t(i);return}if(n.$7b.get_$g9()){var f=this;n.$4Y.$84t(r,new _bc.$IH(n.$ao),function(r){i=$7EU(n,r);t(i)})}else{_js.Trace.logError(_h.$4S.$A,"ClientStore should be available when we try to GetLastUpdateInfo");t(i)}}function $4xN(n){_js.Trace.logInfo(_h.$4S.$A,"Update outbox total count");if(n.$7b.get_$g9()){var t=n.$1i.nameToId("outbox");if(!t){_js.Trace.logError(_h.$4S.$A,"There is no FolderId for outbox");return}var i=new _e.$ck(n.$7b,n.$b.get_$13().get_$E6());var r=this,u=this,f=this;i.$Bl(new _a.$6i("MailOfflineActivityIndicator.UpdateOutboxTotalCount"),function(r){i.$83w(r,t,function(t,i){n.set_$4RJ(t)})},function(){},function(n){_js.Trace.logWarning(_h.$4S.$A,"Failed to get outbox total count due to error:",n.$3j)})}else _js.Trace.logError(_h.$4S.$A,"ClientStore is not available when we try to UpdateOutboxTotalCount")}function $7EU(n,t){if(!$5(t)){var i=_a.$7.$3x(t);var r;r=i.$9K(_a.$7.get_$2F())?1:0;return $7ET(n,i,r)}return""}function $7ET(n,t,i){return String.format(_u.Strings.l_UpdatedOn_Text,t.$2b(i))}_h.$4S.prototype={$7b:null,$b:null,$1i:null,$ER:null,$pc:null,$3wL:null,$2R5:!1,$1kC:0,$2Up:null,$ao:null,$2sG:!1,$vW:null,$2jT:!1,$2ho:null,$2uW:!1,get_$6pH:function(){return this.$2jT},set_$6pH:function(n){if(this.$2jT!==n){this.$2jT=n;$1qM(this)}return n},get_$4Al:function(){return this.$2Up},set_$4Al:function(n){if(n!==this.$2Up){this.$2Up=n;_js.Trace.logInfo(_h.$4S.$A,"MailActivityInfo changes to {0}, Connected = {1}",this.$2Up,this.$Bv.$QD);this.$J.$9lH(_h.$s4,new _h.$s4(this,this.$2Up))}return n},get_$4RJ:function(){return this.$1kC},set_$4RJ:function(n){if(this.$1kC!==n){this.$1kC=n;$1qM(this)}return n},get_$7fs:function(){return this.$2sG},set_$7fs:function(n){if(n!==this.$2sG){this.$2sG=n;this.$J.$9lH(_h.$pp,new _h.$pp(this.$2sG))}return n},get_$15G:function(){return this.$ao},set_$15G:function(n){if(this.$ao!==n){this.$ao=n;this.set_$2R6(this.$pc.$NO(this.$ao.Id));$1qM(this)}return n},get_$2R6:function(){return this.$2R5},set_$2R6:function(n){if(this.$2R5!==n){this.$2R5=n;$1qM(this)}return n},get_$43N:function(){return this.$3wL.get_$3o(this.$ao.Id)},$49:function(){this.$J.$11q(_h.$NG,this.$$d_$40A);this.$J.$11q(_h.$jg,this.$$d_$8Aw);this.$J.$11q(_a.$bl,this.$$d_$9PF);this.$vW.remove_$59b(this.$$d_$8AP);_h.$S1.prototype.$49.call(this)},$8Bh:function(n){if($5(n.$xe)||!n.$xe.length)_js.Trace.logWarning(_h.$4S.$A,"FoldersToSync is empty, moduleName:{0} for enqueued event",n.$HS);else{_js.Trace.logInfo(_h.$4S.$A,"FoldersToSync: {0}, event:{1}",n.$xe.toString(),_a.$Gi.toString(n.$NV));Array.contains(n.$xe,this.$ao.Id)&&this.set_$2R6(!0);for(var r=n.$xe,f=r.length,i=0;i<f;++i){var t=r[i];if(this.$pc.$NO(t)){var u;this.$pc.set_$3o(t,(u=this.$pc).set_$3o(t,u.get_$3o(t)+1))}else this.$pc.set_$3o(t,1)}}},$8Bg:function(n){if($5(n.$xe)||!n.$xe.length)_js.Trace.logWarning(_h.$4S.$A,"FoldersToSync is empty, moduleName:{0} event:{1}",n.$HS,_a.$Gi.toString(n.$NV));else{_js.Trace.logInfo(_h.$4S.$A,"FoldersToSync: {0}, event:{1}",n.$xe.toString(),_a.$Gi.toString(n.$NV));if(Array.contains(n.$xe,this.$ao.Id)&&this.$2R5)if(n.$NV===3){this.$2ho=this.$ao.Id;this.$2uW||$4xM(this)}else this.set_$2R6(!1);for(var r=n.$xe,f=r.length,i=0;i<f;++i){var t=r[i];if(this.$pc.$NO(t)){var u=this.$pc.get_$3o(t);u>1?this.$pc.set_$3o(t,--u):this.$pc.$34(t)}else _js.Trace.logWarning(_h.$4S.$A,"We can't find folder {0} in the syncingFoldersMap, moduleName:{1} event:{2}",t,n.$HS,_a.$Gi.toString(n.$NV))}}},$8CW:function(n){if(this.$pc.$AHc()>0){var t=new Sys.StringBuilder;var i=this;this.$pc.$AHd(function(n,i){t.append(String.format("Key:{0},Value:{1};",n,i))});_js.Trace.logWarning(_h.$4S.$A,"syncingFoldersMap = {0} when sync session completes",t.toString());this.set_$2R6(!1);this.$pc=_a.$3r.$$(Number).$8V()}},$8An:function(){$1qM(this)},$8Aw:function(n){this.$2uW=n.$T6;_js.Trace.logInfo(_h.$4S.$A,"CurrentMailListTableLoading = {0}",this.$2uW);this.$2uW||_js.$8.$a(this.$2ho)||$4xM(this)},$8AP:function(){this.set_$6pH(this.$vW.get_$2Gk()===_h.$4S.$4Ax)},$40A:function(n){var t=n.$2Q;t&&t.get_$o()&&this.set_$15G(t.get_$o())},$9PF:function(n){n.$1Nh===5&&$4xN(this)}};_h.$2g=function(n,t,i,r,u,f,e,o,s,h,c,l){this.$$d_$8Bw=Function.createDelegate(this,this.$8Bw);this.$$d_$8Ba=Function.createDelegate(this,this.$8Ba);this.$$d_$8Bx=Function.createDelegate(this,this.$8Bx);this.$$d_$8BC=Function.createDelegate(this,this.$8BC);this.$$d_$8BD=Function.createDelegate(this,this.$8BD);this.$$d_$8IE=Function.createDelegate(this,this.$8IE);this.$$d_$8B6=Function.createDelegate(this,this.$8B6);this.$$d_$9cB=Function.createDelegate(this,this.$9cB);this.$$d_$8BA=Function.createDelegate(this,this.$8BA);this.$$d_$6IE=Function.createDelegate(this,this.$6IE);this.$5s=new Sys.EventHandlerList;_h.$2g.resolveInheritance();this.dispose=this.$1R;_h.$2g.initializeBase(this);_a.$3.$m(f,"nativeBridge");this.$kp=n;this.$72=u;this.set_$5c(t);this.$1A=i;this.$J=r;this.$c=f;this.$1Jp=o;this.$6GQ=s;this.$ER=e;this.$1H=h;this.$z4=c;this.$VA=l;$7Et(this)};function $7Ei(n){return n.$c.$5i(n.$c.get_$4a())?new _g.$sX(n.$c,n.$1H,n.$z4,n.$VA):new _g.$fQ(n.$1H,n.$z4,n.$VA)}function $4xX(n,t,i){_a.$3.$K(t,"successCallback");_a.$3.$K(i,"failureCallback");if(n.$1A.get_$3It()){_js.Trace.logInfo(_h.$2g.$1z,"Removing client store and associated local storage.");var r=this,u=this;n.$7b.$6mN(function(){n.$72.$3Oa();n.$kp.$1t();_js.Trace.logInfo(_h.$2g.$1z,"Client store successfully removed.");t()},function(n){_js.Trace.logError(_h.$2g.$1z,"We failed to uninstall client store due to error: "+n.message);i(n)})}else{_js.Trace.logWarning(_h.$2g.$1z,"Remove client store called, but offline is not supported by this user agent");t()}}function $4xV(n,t,i){if(_e.$6G.isInstanceOfType(t)){var r=t;r.$3rs()}n.$kp.$1t();if(i){var u=n.$5WQ(i);u.$AF("DeprovisionAndReload")}}function $7Em(n){_js.Trace.logInfo(_h.$2g.$1z,"Initializing UI Dependent Offline Components");var t=this;n.$ER.$E(function(t){_js.Trace.logInfo(_h.$2g.$1z,"sync folder setting cache has been initialized");n.$4ej=new _h.$1Bp(_g.$h.$1i);if(n.$1A.get_$6n()&&window.owaSD&&window.owaSD.readyState!==4){_js.Trace.logInfo(_h.$2g.$1z,"SSSD readyState: {0}",window.owaSD.readyState);window.owaSD.onreadystatechange=n.$$d_$9cB}else $4xW(n);n.$1gA=new _h.$4S(_g.$V.get_$I(),_g.$h.$1i,n.$J,n.$7b,n.get_$Df(),t,n.$Bv,n.get_$Df().get_$AAV());n.$2Ii=new _h.$Jp(n.$J,n.get_$Df(),n.$Bv);n.$6jI&&n.get_$Df().$y();n.$J.$AIJ(_h.$Yr,new _h.$Yr)})}function $4xW(n){n.$kp.$9gg(n.$7b,window.owaSD)}function $4xY(n){if(n.$5Uq&&n.$1e6){var t=this;n.$ER.$E(function(n){n.$6cu(_h.$i.$aX("msgfolderroot"))})}}function $7Eq(n,t){n.$Bv=t.$Bv;$4xY(n)}function $7Et(n){n.$J.$Hd(_h.$pg,n.$$d_$8B6);n.$J.$Hd(_a.$OQ,n.$$d_$8IE);n.$J.$Hd(_h.$XF,n.$$d_$8BD);n.$J.$Hd(_h.$cm,n.$$d_$8BC);n.$J.$Hd(_a.$E3,n.$$d_$8Bx)}function $7Eu(n){n.$J.$11q(_a.$OQ,n.$$d_$8IE);n.$J.$11q(_h.$XF,n.$$d_$8BD);n.$J.$11q(_h.$cm,n.$$d_$8BC);n.$J.$11q(_a.$E3,n.$$d_$8Bx)}function $7Ej(n,t,i,r,u,f){var e="sync";n.$6jI=$5(r)||$5(r.get_$3o(e))||r.get_$3o(e).toString()==="true";n.$1Jp.get_$1n().$E(t,i,_a.$11.get_$7l(),u,OwaApplication.$2Lc,f,n.$kp)}function $7En(n,t,i,r,u,f,e){var o=this,s=this;$7Ep(n,t,function(o){var s=new _g.$V(o);$7Er(n,t,u,function(t){$7Eh(n,t,i,r,s,function(n){n.$Hf.set_$1tB(OwaApplication.$2Lc);f(n,s)},function(t){_js.Trace.logError(_h.$2g.$1z,"CreateOfflineMailboxDataContextFromClientStore Failed: {0}",t.$3j);n.$7b.$cV();e(new _e.$1g(t).$Sd())})},function(t){_js.Trace.logError(_h.$2g.$1z,"Failed to provision the offline client: {0}",t.message);n.$7b.$cV();e(t)})},function(t){_js.Trace.logError(_h.$2g.$1z,"Failed to load OWA user configuration: {0}",t.message);n.$7b.$cV();e(t)})}function $7Er(n,t,i,r,u){var f=new _g.$g2(n.$7b.get_$8F7(),"DeviceType","1.0");f.HasPAL=n.$1A.get_$6n();if(n.$c.$5i(n.$c.get_$4a())){if(n.$c.$5i(n.$c.get_$Bc())){f.DeviceModel=n.$c.get_$Bc().get_$8P().get_$2Ll();f.DeviceFriendlyName=n.$c.get_$Bc().get_$8P().get_$7s0();if(n.$c.get_$Bc().get_$8P().get_$1bF()===1){f.DeviceOS="iOS "+n.$c.get_$4a().get_$92().get_$1k7();f.DeviceType="iPhone"}else if(n.$c.get_$Bc().get_$8P().get_$1bF()===2){f.DeviceOS="iOS "+n.$c.get_$4a().get_$92().get_$1k7();f.DeviceType="iPad"}else if(n.$c.get_$Bc().get_$8P().get_$1bF()===3){f.DeviceOS="Android "+n.$c.get_$4a().get_$92().get_$1k7();f.DeviceType="Android"}else if(n.$c.get_$Bc().get_$8P().get_$1bF()===4){f.DeviceOS="Windows "+n.$c.get_$4a().get_$92().get_$1k7();f.DeviceType="Windows 8"}}f.ClientVersion=n.$c.get_$4a().get_$92().get_$36();f.DeviceOSLanguage=n.$c.get_$4a().get_$92().get_$8Q8()}var e=_e.$AE.$2Nr(n.$7b);var o=this;e.$86n(function(o){if(o){_js.Trace.logInfo(_h.$2g.$1z,"Client is already provisioned.");r(f)}else if(f.HasPAL||i){_js.Trace.logInfo(_h.$2g.$1z,"Provisioning the client with the server...");var h=t?t.get_$3YL():new _g.$3U(function(){},n.$1H,n.$z4,n.$VA);var s=new _g.$K9("Exchange2013");s.TimeZoneContext=new _g.$Lo;s.TimeZoneContext.TimeZoneDefinition=new _g.$JZ;s.TimeZoneContext.TimeZoneDefinition.Id="UTC";n.$1A.get_$6n()&&n.$72.$3Oa();h.$6UB(new _g.$g0(s,f),null,function(t,i){if("Success"===i.Body.ResponseMessages.Items[0].ResponseClass){_js.Trace.logInfo(_h.$2g.$1z,"...server call succeeded, saving results to the database...");e.$9x8(!0,function(){_js.Trace.logInfo(_h.$2g.$1z,"Provisioning completed.");r(f)},u)}else if("Error"===i.Body.ResponseMessages.Items[0].ResponseClass&&"ErrorMaximumDevicesReached"===i.Body.ResponseMessages.Items[0].ResponseCode){_js.Trace.logError(_h.$2g.$1z,"Maximum number of allowed partnerships already created.");var o=new _a.$4V([_u.Strings.l_ProvisionFailedDueToMaxDevices_Text],0,n.$$d_$8Ba,0,!1,_u.Strings.l_Close_Text,"",_u.Strings.l_ProvisionFailedDueToMaxDevices_Title_Text);n.$J.$9lH(_a.$4V,o)}else{_js.Trace.logError(_h.$2g.$1z,"Provisioning call returned a response error.");var s=Error.create(i.Body.ResponseMessages.Items[0].MessageText);u(s)}},u)}else{_js.Trace.logWarning(_h.$2g.$1z,"The client is not provisioned, and we should not provision it automatically.  Removing the 'offline enabled' flag and reloading.");n.$2dU(t,window.location)}},u)}function $7Ep(n,t,i,r){if(_g.$V.get_$I().$5hy){var u=_e.$AE.$2Nr(n.$7b);var f=this;u.$rU(function(u){if(u){_js.Trace.logInfo(_h.$2g.$1z,"Found OWA user configuration in client store.");i(u)}else{_js.Trace.logInfo(_h.$2g.$1z,"Getting OWA user configuration from the server...");var f=t?t.get_$3YL():new _g.$3U(function(){},n.$1H,n.$z4,n.$VA);f.$rU(null,function(n,t){_js.Trace.logInfo(_h.$2g.$1z,"...server call succeeded");i(t)},r)}},_e.$1g.$5Kk(r))}else{_js.Trace.logInfo(_h.$2g.$1z,"OWA user configuration has already been loaded.");i(_g.$V.get_$I().get_$A6())}}function $7Eh(n,t,i,r,u,f,e){var h=_e.$AE.$2Nr(n.$7b);var o=new _e.$6M(n.$7b);var s=null;_js.Trace.logInfo(_h.$2g.$1z,"Creating OfflineMailboxDataContext from client store database.");var c=this,l=this;n.$7b.get_$13M().$Bl(new _a.$6i("OfflineManager.CreateOfflineMailboxDataContextFromClientStore"),function(t){$7Eo(n,t,h,o,function(n){s=n});o.$8Fx(t)},function(){_js.Trace.logInfo(_h.$2g.$1z,"CreateOfflineMailboxDataContextFromClientStore transaction succeeded.");n.$1Jp.$E(function(e){var h=new _e.$6G(n.$7b,u.get_$13().get_$E6(),i,r,new _g.$AD(n.$J),n.$J,o,t.HasPAL,t.DeviceID,t.DeviceType,s,u.get_$2z(),e);h.$8Rh(function(){h.set_$7ww(function(){return OwaApplication.$2Lc});h.$A4A(_js.$J.get_$I());f(h)})})},e)}function $7Eo(n,t,i,r,u){_js.Trace.logInfo(_h.$2g.$1z,"Checking if action queue is empty.");var f=this;r.$8KD(t,function(n){if(n){_js.Trace.logInfo(_h.$2g.$1z,"Action queue is empty therefore we're removing the IdentityCorrelationTable setting.");i.$7gy(t,function(){_js.Trace.logInfo(_h.$2g.$1z,"IdentityCorrelationTable setting reset.");u(null)})}else{_js.Trace.logInfo(_h.$2g.$1z,"Action queue is not empty therefore we're loading the IdentityCorrelationTable setting.");i.$84Q(t,function(n){n?_js.Trace.logInfo(_h.$2g.$1z,"IdentityCorrelationTable setting loaded with {0} items.",n.map.count):_js.Trace.logInfo(_h.$2g.$1z,"IdentityCorrelationTable setting loaded but had no value.");u(n)})}})}function $7El(n,t,i){t=t||"";i=i||"";var r=t.split("@")[0];var u=i.split("@")[0];return r===u}function $7Es(n,t){n.$485=!0;n.$72.set_$20f(!0);var i=this;t.$p3(_a.$0.$Eh,"StartOfflineSessionInUseThread",function(){if(n.$1e6&&!n.$B7){n.get_$Df()&&n.get_$Df().get_$1Qe()&&n.$72.get_$A7g()>1e4&&_a.$g.$9H("Core.Models.Sync.SuspendedDuringSync");n.$72.set_$20f(!0)}},5e3)}function $7Ek(n,t){if(n.$c.$5i(n.$c.get_$Bc())&&n.$c.get_$Bc().get_$8P().get_$5Bw()){_js.Trace.logInfo(_h.$2g.$1z,"the native bridge device state indicates the application was reset.  the offline manager will clear all offline data.");var i=this,r=this;$4xX(n,function(){t()},function(t){n.$c.get_$4a().$2sS(0,"Unable to remove the client store. "+t.message)})}else t()}_h.$2g.prototype={$kp:null,$1A:null,$J:null,$c:null,$ER:null,$1Jp:null,$6GQ:null,$1H:null,$z4:null,$VA:null,$7b:null,$Bv:null,$1e6:!1,$72:null,$5Uq:!1,$5gV:!1,$1gA:null,$2Ii:null,$4ej:null,$6jI:!1,$485:!1,$8Q6:null,get_$5c:function(){return this.$7b},set_$5c:function(n){this.$7b&&this.$7b.remove_$34I(this.$$d_$6IE);this.$7b=n;if(this.$7b){this.$6IE(!1);this.$7b.add_$34I(this.$$d_$6IE)}else this.set_$ar(!1);return n},get_$2rD:function(){return this.$2Ii},set_$2rD:function(n){this.$2Ii=n;return n},get_$4ek:function(){return this.$4ej},set_$4ek:function(n){this.$4ej=n;return n},get_$ar:function(){return this.$1e6},set_$ar:function(n){if(n!==this.$1e6){this.$1e6=n;var t=this.$5s.getHandler("IsClientStoreInstalled");t&&t()}return n},get_$AEk:function(){return this.$72},set_$AEk:function(n){this.$72=n;return n},get_$4RJ:function(){return this.$1gA?this.$1gA.$1kC:0},get_$4c5:function(){return this.$72.get_$Mk()&&this.$1e6&&this.$72.get_$6fg()?!this.$Bv.$QD:!1},get_$20g:function(){return this.$485},get_$Df:function(){var n=null;this.$1Jp.get_$5mf()&&(n=this.$1Jp.get_$1n().$rX());return n},$42V:function(n,t,i,r,u,f,e){var s=this.$72.get_$20f();var h=this.$72.get_$Mk();if(h&&!s){_js.Trace.logInfo(_a.$0.$GT,"Initializing offline mailbox data context");var c=this,o=this;this.$4U3(null,t,!1,i,r,e,function(t){_js.Trace.logInfo(_a.$0.$GT,"Prepare offline component completed successfully");n(t)},function(t){_js.Trace.logError(_a.$0.$GT,"Offline Initialization failed - reverting to KIOSK mode. {0}",t.message);o.$8Q6=String.format("OfflineInit failed:{0}",t.message);var i=new _g.$1Y(null,u,f,new _g.$AD(o.$J),o.$J);i.$Bv.set_$2ZP(!0);n(i)})}else throw Error.invalidOperation();},$4U3:function(n,t,i,r,u,f,e,o){_a.$3.$K(e,"onOfflineReady");var s=this,h=this;this.$8Hv(n,t,i,u,f,function(n){$.cookie("X-Offline","1",{path:"/"});$7Es(s,r);s.$kp.$4e0(s.$J,s.get_$Df(),n.$Hf);e(n)},function(n){h.$c.$5i(h.$c.get_$4a())&&h.$c.get_$4a().$2sS(1,n.message||"prepare offline component failed with an unknown error");o(n)})},$4WA:function(n,t){this.$J.$9lH(_a.$S2,new _a.$S2(!1));this.$2dU(n,t)},$2dU:function(n,t){$.cookie("X-Offline",null,{path:"/"});this.$72.$6mf();$4xV(this,n,t)},$9nG:function(n,t){_a.$3.$K(n,"successCallback");_a.$3.$K(t,"failureCallback");this.$72.get_$4bT()?$4xX(this,n,t):n()},$49:function(){$7Eu(this);this.$485&&this.$72.set_$20f(!1);this.$1gA&&this.$1gA.$1R();this.$2Ii&&this.$2Ii.dispose();if(this.$1Jp.get_$5mf()&&this.get_$Df()){this.$J.$11q(_a.$kA,this.$$d_$8BA);this.get_$Df().dispose()}},$5WQ:function(n){return new _a.$T0(n,this.$c)},$8Hv:function(n,t,i,r,u,f,e){var o=this;$7Ek(this,function(){o.$7b.$431(function(){$7En(o,n,$7Ei(o),new _g.$pF,i,function(n,e){o.$7b.$A4z(n.$7s,o.$J);var s=t?t.get_$3o("connected"):null;if("false"===s){n.$Bv.set_$1aK(!1);n.$Bv.set_$2ZP(!1)}else n.$Bv.set_$2ZP(!0);$7Eq(o,n);o.$6GQ.$E(function(s){var h=s.$E(new _a.$12T,OwaApplication.get_$1jD(),OwaApplication.get_$TQ(),t);OwaApplication.get_$TQ().set_$V4(h);o.$1Jp.$E(function(s){$7Ej(o,n,h,t,r,u);o.$J.$Hd(_a.$kA,o.$$d_$8BA);i&&o.$72.$9xy(e.get_$2z().get_$AM(),e.get_$2z().get_$Fn());f(n)})})},function(n){_js.Trace.logWarning(_h.$2g.$1z,"Failed to initialize the offline mailbox data context - disposing the client store. {0}",n);o.$7b.$cV();e(n)})},e)})},$9cB:function(){if(window.owaSD&&window.owaSD.readyState===4){window.owaSDReceivedTime=(new Date).toString();$4xW(this)}},$8B6:function(n){var t;if(this.$1A.get_$6n()){var r=this;t=new _a.$4V([_u.Strings.l_PALFatalQuotaError_Text],0,function(n,t){},0,!1,null,null,null)}else{this.$72.$6mf();this.$J.$9lH(_a.$S2,new _a.$S2(!1));var i=this;t=new _a.$4V([_u.Strings.l_BrowserFatalQuotaError1_Text,_u.Strings.l_BrowserFatalQuotaError2_Text],0,function(n,t){n&&$4xV(i,_g.$1Y.$w,window.location)},0,!1,_u.Strings.l_Refresh_StartWithUpperCase_Text,null,null)}this.$J.$9lH(_a.$4V,t)},$8Bx:function(n){_js.Trace.logInfo(_h.$2g.$1z,"Handling OwaApplicationStartedEvent");this.$72.$7sN(_g.$V.get_$I().get_$Nq().AllowOfflineOn)&&this.$2dU(_g.$1Y.$w,window.location)},$8BA:function(n){_js.Trace.logInfo(_h.$2g.$1z,"Handling FolderMappingsLoadedEvent");$7Em(this)},$8BD:function(n){if(this.$1e6){if(!this.$1gA){_js.Trace.logInfo(_h.$2g.$1z,"SyncFolderEvent can only be processed after MailActivityIndicator initialization");return}this.get_$Df().$6i2(n.$2Q.get_$o().Id)}},$8BC:function(n){this.$5Uq=!0;$4xY(this)},$6IE:function(n){this.$72.get_$4bT()?this.set_$ar(!1):this.set_$ar(this.$7b.get_$g9());n&&this.$72.$4XX()},$8IE:function(n){if(n.$Vs===1)if(this.$5gV)_js.Trace.logInfo(_h.$2g.$1z,"ignoring invalid device id error because it has already been handled.");else{this.$5gV=!0;if(this.$c.$5i(this.$c.get_$4a()))this.$c.get_$4a().$2sS(0,"The mowa device id is not longer valid.  It may have been removed via ECP.");else if($7El(this,n.$3Xb,this.$72.get_$4Nm())){_js.Trace.logWarning(_h.$2g.$1z,"The user {0} does not have a valid device id.  Removing store and restarting.",this.$72.get_$4Nm());this.$2dU(_g.$1Y.$w,window.location)}else{_js.Trace.logWarning(_h.$2g.$1z,"The user {0} is not the same as the offline enabled user {1}.",n.$3Xb,this.$72.get_$4Nm());var t=new _a.$4V([String.format(_u.Strings.l_OfflineUserOtherUserMessage_Text,this.$72.get_$9Kp())],1,this.$$d_$8Bw,3,!1,_u.Strings.l_OfflineUserOtherUserMessage_SignIn_Text,_u.Strings.l_OfflineUserOtherUserMessage_Cancel_Text,null);this.$J.$9lH(_a.$4V,t)}}},$8Bw:function(n,t){n?this.$2dU(_g.$1Y.$w,window.location):this.$J.$9lH(_a.$N4,new _a.$N4(!1))},$8Ba:function(n,t){var i=new _g.$bj(5);this.$J.$9lH(_g.$bj,i)}};_h.$OR=function(n){this.$ZN=_a.$3r.$$(Object).$8V();this.$196=n};function $7Ew(n,t,i,r){var u=[new _h.$OR.$86A];var f=new _h.$OR.$7xt(t,r,n.$196);var e=new _h.$OR.$7xz(t,r,n.$196);Array.add(u,f);Array.add(u,e);if(i!=="TouchNarrow"){Array.add(u,new _h.$OR.$82b(f));Array.add(u,new _h.$OR.$85D(e))}return u}function $4xa(n,t,i,r){if(i===t.length)r();else{var u=this;$7Ex(n,t[i],function(){$4xa(n,t,i+1,r)})}}function $7Ex(n,t,i){_js.Trace.logInfo(_a.$0.$Iv,"Executing page data payload action for '"+t.get_$4RY()+"' variable");var r=this;t.$s(function(t){_js.Trace.logInfo(_a.$0.$Iv,"Saving result to page data payload variable '"+t.get_$4RY()+"'");n.$ZN.set_$3o(_bc.$lp.toString(t.get_$4RY()),t.get_$hJ());i()})}_h.$OR.prototype={$196:!1,$y:function(n,t,i,r){_js.Trace.logInfo(_a.$0.$Iv,"Start generatint the page data payload for layout '{0}' with '{1}' rows to load...",t,i);var u=$7Ew(this,n,t,i);$4xa(this,u,0,r)},$1Ow:function(n){return this.$ZN.get_$3o(_bc.$lp.toString(n))}};_h.$OR.$86C=function(n){this.$6PR=n};_h.$OR.$86C.prototype={$6PR:0,$lE:null,get_$4RY:function(){return this.$6PR},get_$hJ:function(){return this.$lE},set_$hJ:function(n){this.$lE=n;return n},$s:function(n){var t;var i,r;if(r=this.$A9l(i={val:t}),t=i.val,r){var u=this;t.add_$29(function(t){u.$9xG(t);n(u)});var f=this;t.add_$21(function(t){_js.Trace.logWarning(_a.$0.$Iv,"Action '"+t.$1sK+"' failed. Clearing page data payload and moving on.");f.set_$hJ(null);n(f)});OwaApplication.$1W.$11(t)}else{this.set_$hJ(null);n(this)}}};_h.$OR.$2io=function(n){_h.$OR.$2io.$$(this.$$gta["_h.$OR.$2io"].TResult).initializeBase(this,[n])};_h.$OR.$2io.$$=function(n){var t="$2io"+"$1"+"$"+n.getName().replace(/\./g,"_");if(!_h.$OR[t]){var r=_h.$OR[t]=function(){(this.$$gta=this.$$gta||{})["_h.$OR.$2io"]={TResult:n};for(var i=[],t=0;t<arguments.length;++t)i[t]=arguments[t];_h.$OR.$2io.apply(this,i)};r.registerClass("_h.PageDataPayloadGenerator."+t,_h.$OR.$86C);var u=_h.$OR.$2io.prototype;for(var f in u){var i={key:f,value:u[f]};"constructor"!==i.key&&(r.prototype[i.key]=i.value)}}return _h.$OR[t]};_h.$OR.$2io.prototype={$9xG:function(n){var t=n;this.set_$hJ(t.get_$hJ())}};_h.$OR.$86A=function(){_h.$OR.$86A.initializeBase(this,[1])};_h.$OR.$86A.prototype={$A9l:function(n){n.val=new _h.$Nm;return!0}};_h.$OR.$4A4=function(n,t,i,r){_h.$OR.$4A4.$$(this.$$gta["_h.$OR.$4A4"].TResult).initializeBase(this,[i]);this.$5eX=n;this.$ug=t;this.$196=r};_h.$OR.$4A4.$$=function(n){var t="$4A4"+"$1"+"$"+n.getName().replace(/\./g,"_");if(!_h.$OR[t]){var r=_h.$OR[t]=function(){(this.$$gta=this.$$gta||{})["_h.$OR.$4A4"]={TResult:n};for(var i=[],t=0;t<arguments.length;++t)i[t]=arguments[t];_h.$OR.$4A4.apply(this,i)};r.registerClass("_h.PageDataPayloadGenerator."+t,_h.$OR.$2io.$$(n));var u=_h.$OR.$4A4.prototype;for(var f in u){var i={key:f,value:u[f]};"constructor"!==i.key&&(r.prototype[i.key]=i.value)}}return _h.$OR[t]};_h.$OR.$4A4.prototype={$5eX:!1,$ug:0,$196:!1,get_$AIi:function(){return this.$5eX},get_$4Xj:function(){return this.$ug},get_$9h:function(){return this.$196?"NoClutter":"All"}};_h.$OR.$7xt=function(n,t,i){_h.$OR.$7xt.initializeBase(this,[n,t,3,i])};_h.$OR.$7xt.prototype={$A9l:function(n){if(this.get_$AIi()){n.val=null;return!1}n.val=new _h.$e8(_g.$2Z.$BJ("inbox").get_$o(),null,_h.$5n.$1Ol(0,this.get_$4Xj()),!1,"All",this.get_$9h(),null);return!0}};_h.$OR.$7xz=function(n,t,i){_h.$OR.$7xz.initializeBase(this,[n,t,4,i])};_h.$OR.$7xz.prototype={$A9l:function(n){if(!this.get_$AIi()){n.val=null;return!1}n.val=new _h.$k5(_g.$2Z.$BJ("inbox").get_$o(),null,null,"MailListItem",_h.$5n.$1Ol(0,this.get_$4Xj()),!0,"All",this.get_$9h(),null,!1,null,null);return!0}};_h.$OR.$85D=function(n){_h.$OR.$85D.initializeBase(this,[6]);this.$5Tm=n};_h.$OR.$85D.prototype={$5Tm:null,$A9l:function(n){var i=this.$5Tm.get_$hJ();if(!i){n.val=null;return!1}var t=i.Body.ResponseMessages.Items[0];if(!t.RootFolder.Items||!t.RootFolder.Items.length){n.val=null;return!1}var r=t.RootFolder.Items[0];n.val=new _h.$J8(101,[r.ItemId],_h.$v.$2pW(_h.$v.get_$38C()),"ItemNormalizedBody",2,!1);return!0}};_h.$OR.$82b=function(n){_h.$OR.$82b.initializeBase(this,[5]);this.$5Te=n};_h.$OR.$82b.prototype={$5Te:null,$A9l:function(n){var t=this.$5Te.get_$hJ();if(!t||!t.Body.Conversations.length){n.val=null;return!1}var i=t.Body.Conversations[0];var r=_a.$7.$3x(i.LastModifiedTime);n.val=_h.$FY.$E(101,i.ConversationId.Id,i.ConversationId.ChangeKey,20,r,_h.$v.get_$38C(),"ItemPartUniqueBody","");return!0}};_h.$101=function(){};_h.$101.prototype={$E:function(n,t,i,r,u){return _h.$101.$6hp.$E(n,t,i,r,u)}};_h.$101.$7jJ=function(n,t,i,r,u,f){_h.$101.$7jJ.initializeBase(this,[n,t,i,r,u]);_a.$3.$K(f,"response");this.$33=f};_h.$101.$7jJ.prototype={$33:null,$9vK:function(){this.get_$6PN().set_$1cH(this.$33);this.get_$2uy().set_$5Tf(0)},$9gh:function(){for(var t=this.$33.Body.Conversations,i=t,u=i.length,n=0;n<u;++n){var f=i[n];f.FolderId=this.get_$429()}var r=new _e.$TX(new _e.$RA(this.get_$5c(),_g.$V.get_$I().get_$13().get_$E6()),t,[]);r.set_$AIY(11);var e=this;r.$AIb(function(){})}};_h.$101.$7pX=function(n,t,i,r,u,f){_h.$101.$7pX.initializeBase(this,[n,t,i,r,u]);_a.$3.$K(f,"response");this.$33=f};_h.$101.$7pX.prototype={$33:null,$9vK:function(){this.get_$6PN().set_$3vZ(this.$33);this.get_$2uy().set_$5Tn(0)},$9gh:function(){var t=this.$33.Body.ResponseMessages.Items[0];var i=t.RootFolder.Items;var n=new _e.$Uh(new _e.$lP(this.get_$5c(),_g.$V.get_$I().get_$13().get_$E6()),i,[],[],null);n.set_$AIY(11);var r=this;n.$AIb(function(){})}};_h.$101.$6hp=function(n,t,i,r,u){_a.$3.$K(n,"pageDataPayloadAdapter");_a.$3.$K(t,"clientStore");_a.$3.$K(i,"inboxFolderId");_a.$3.$K(r,"datapoint");this.$dw=n;this.$7b=t;this.$1dg=i;this.$KY=r;this.$5EG=u};_h.$101.$6hp.$E=function(n,t,i,r,u){var f=JsonParser.deserialize(u.responseText);var e=f.findMailFolderItem;if(e)return new _h.$101.$7pX(n,t,i,r,r.get_$5Tl(),e);else{var o=f.findConversation;if(!o){_js.Trace.logWarning(_a.$0.$Iv,"Both FindMailFolderItem and FindConversation values in the SSSD response are null");return null}return new _h.$101.$7jJ(n,t,i,r,r.get_$5Td(),o)}};_h.$101.$6hp.prototype={$dw:null,$7b:null,$1dg:null,$KY:null,$5EG:0,get_$6PN:function(){return this.$dw},get_$5c:function(){return this.$7b},get_$2uy:function(){return this.$KY},get_$429:function(){return this.$1dg},$9gb:function(){if(this.$5EG){var n=_a.$6.acss(_a.$0.$QX,"PersistSSSD_GenerateReloadNotification");this.$9vK();this.$1cd();_a.$T.$2hC=1;_a.$6.aces(n)}else{var t=_a.$6.acss(_a.$0.$QX,"PersistSSSD_NoReloadRequired");if(_a.$T.get_$15j()){_a.$T.$3WG();_a.$T.$2hC=2}_a.$6.aces(t)}this.$9gh()},$1cd:function(){this.$KY.set_$6c1((new Date).toString());_js.Trace.logInfo(_a.$0.$Iv,"SSSD receive time = {0}, Reload notification time = {1}",this.get_$2uy().get_$6c0(),this.get_$2uy().get_$6c1());_e.$2r.$2zW(this.$1dg.Id,"SSSD",!1);_a.$T.$3U9++}};function OfflineBootComponent(){}OfflineBootComponent.prototype={$1aH:function(n,t,i){var r=this;n.$Ax(_h.$2g).$AHm(IOfflineManager).$AHn().$AHo(function(){return new _h.$2g(n.$2AC(_bc.$km),n.$2AC(IClientStore),n.$2AC(_a.$k),n.$2AC(_0365f.$L),n.$2AC(_h.$O4),n.$2AC(_a.$4g),n.$AGW(ISyncFolderSettingProcessor),n.$AGW(ISyncManagerFactory),n.$AGW(INotificationHandlerProxyFactory),n.$2AC(_a.$38),n.$2AC(_g.$kZ),n.$2AC(_g.$V0))});var u=this;n.$Ax(_h.$v2).$AHm(IAppStatusBarViewModel).$AHn().$AHo(function(){return new _h.$v2(n.$2AC(_h.$72))});var f=this;n.$Ax(_h.$AI).$AHn().$AHo(function(){return new _h.$AI(n.$2AC(_0365f.$L),n.$2AC(_h.$2g).$72,n.$2AC(_js.$Bt),n.$2AC(_a.$kl),OwaApplication.$1rk)});var e=this;n.$Ax(_h.$72).$AHn().$AHo(function(){return new _h.$72(n.$2AC(_0365f.$L),n.$2AC(_a.$k),n.$2AC(_h.$2g).$72,n.$2AC(_js.$Bt),n.$2AC(_a.$kl),n.$2AC(_h.$2g).$Bv,n.$2AC(_h.$AI),n.$2AC(_h.$2g).$1gA)});var o=this;n.$Ax(_h.$OR).$AHm(IPageDataPayloadGenerator).$AHo(function(){return new _h.$OR(n.$2AC(_g.$3u).get_$13().get_$Gz())});var s=this;n.$Ax(_h.$101).$AHm(IPageDataPayloadPersisterFactory).$AHo(function(){return new _h.$101})},$82P:function(){return[]}};_h.$v2.registerClass("_h.$v2",_a.$FF,IAppStatusBarViewModel);_h.$iN.registerClass("_h.$iN");_h.$AI.registerClass("_h.$AI");_h.$72.registerClass("_h.$72",_js.$9);_h.$Jp.registerClass("_h.$Jp",_h.$S1,_h.$xm,_h.$1Ko,Sys.IDisposable);_h.$4S.registerClass("_h.$4S",_h.$S1,_h.$y8,_h.$1Ko,Sys.IDisposable);_h.$2g.registerClass("_h.$2g",_js.$15l,IOfflineManager,Sys.IDisposable);_h.$OR.registerClass("_h.$OR",null,IPageDataPayloadGenerator);_h.$OR.$86C.registerClass("_h.$OR.$86C");_h.$OR.$86A.registerClass("_h.$OR.$86A",_h.$OR.$2io.$$(_g.$LT));_h.$OR.$7xt.registerClass("_h.$OR.$7xt",_h.$OR.$4A4.$$(_g.$PY));_h.$OR.$7xz.registerClass("_h.$OR.$7xz",_h.$OR.$4A4.$$(_g.$L8));_h.$OR.$85D.registerClass("_h.$OR.$85D",_h.$OR.$2io.$$(_g.$RQ));_h.$OR.$82b.registerClass("_h.$OR.$82b",_h.$OR.$2io.$$(_g.$RP));_h.$101.registerClass("_h.$101",null,IPageDataPayloadPersisterFactory);_h.$101.$6hp.registerClass("_h.$101.$6hp",null,_bc.$1LB);_h.$101.$7jJ.registerClass("_h.$101.$7jJ",_h.$101.$6hp);_h.$101.$7pX.registerClass("_h.$101.$7pX",_h.$101.$6hp);OfflineBootComponent.registerClass("OfflineBootComponent",null,_a.$1L9);_h.$Jp.$A=_a.$0.$Eh;_h.$4S.$4Ax=0;_h.$4S.$A=_a.$0.$Eh;_h.$2g.$1z=_a.$0.$Eh