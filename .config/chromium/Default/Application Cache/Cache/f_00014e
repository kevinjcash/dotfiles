Type.registerNamespace("_at");_at.$14m=function(n,t,i,r){_at.$14m.initializeBase(this);this.$5S=n;this.$2EK=t;this.$1k=i;this.$CS=r};_at.$14m.prototype={$2EK:null,$1k:null,$CS:null,$5S:null,$3zp:null,$5gb:function(n){var t=new _g.$14n(this.$2C);n.$3oQ(this.$5S,this.$2EK,this.$1k,this.$CS,t,this.$$d_$AJb,this.$$d_$9e1)},$6Ti:function(n,t,i){try{_a.$3.$1G(n,"result");this.$3zp=n;t()}catch(r){i(r)}}};function AttachmentsComponent(){}AttachmentsComponent.prototype={$1aH:function(n,t,i){if(t.get_$6n()){var r=this;n.$Ax(_at.$YD).$AHn().$AHo(function(){var t=_bc.$YC.isInstanceOfType(_g.$1Y.$w)?_g.$1Y.$w:null;return new _at.$2u(n.$2AC(_a.$4g),t?t.get_$AU().get_$1Lx():null,t?t.get_$7bm():null)})}else{var u=this;n.$Ax(_at.$YD).$AHn().$AHo(function(){return new _at.$1EB})}var f=this;n.$Ax(IAttachmentViewModelFactory).$AHo(function(){return new _at.$P6(n.$2AC(IInferenceTracker),n.$2AC(_y.$N),n.$2AC(_at.$YD),n.$2AC(_a.$k),n.$2AC(_a.$4g),n.$AGW(IAttachmentProviderItemViewModelFactory),n.$2AC(_a.$38),n.$AGW(IAttachmentPreviewViewModelFactory),n.$AGW(IItemStoreGetterFactory),n.$2AC(IUriFileAttachmentViewModelFactory))});var e=this;n.$Ax(_at.$12P).$AHm(IUriFileAttachmentViewModelFactory).$AHn().$AHo(function(){return new _at.$12P(n.$2AC(_a.$UJ),n.$2AC(_a.$3k),n.$2AC(IInferenceTracker),n.$2AC(_a.$38),n.$AGW(IAttachmentPreviewViewModelFactory),n.$AGW(IItemStoreGetterFactory))})},$82P:function(){return null}};_at.$3h=function(n){this.$$d_$3zx=Function.createDelegate(this,this.$3zx);this.$$d_$5Sc=Function.createDelegate(this,this.$5Sc);this.$$d_$AED=Function.createDelegate(this,this.$AED);this.$$d_$AEE=Function.createDelegate(this,this.$AEE);this.$$d_$8BM=Function.createDelegate(this,this.$8BM);this.$7r=0;_at.$3h.initializeBase(this,[n]);this.set_$CG("about:blank");this.set_$U(-1);this.get_$H().load(this.$$d_$8BM)};function $3Z7(n,t,i,r){n.set_$3Uh(t);n.set_$EB(i);n.set_$2Hw(r);n.$7r=3;n.get_$3XT().$s();n.$3m6=!1}function $6sT(n){var t=n.get_$H()[0];t.contentWindow.document.body.innerHTML="";n.$xg=t.contentWindow.document.createElement("form");n.$xg.method="POST";n.$xg.encType="multipart/form-data";n.$xg.encoding="multipart/form-data";$6sS(n,n.$xg);n.$NW=$(t.contentWindow.document.createElement("input"));n.$NW.attr("type","file");n.$NW.attr("name","fileInput");var i=this;n.$NW.change(function(t){n.$3zx()});_a.UserAgent.getInstance().$9W&&n.$NW[0].attachEvent("onchange",n.$$d_$3zx);n.$xg.appendChild(n.$NW[0])}function $6sS(n,t){n.get_$H()[0].contentWindow.document.body.appendChild(t)}function $6sU(n,t){var i=t.lastIndexOf("\\");return t.substr(i+1)}function $4lT(n){_js.Trace.logInfo(_at.$3h.$A,"Uploading attachment via form submit.");$2F4(n,"parentItemId",n.get_$9s().Id);$2F4(n,"parentChangeKey",n.get_$9s().ChangeKey);$2F4(n,"isInline",n.get_$93().get_$6K().toString());$2F4(n,"X-OWA-CANARY",_a.$3P.$1DR());n.$xg.submit();n.$7r=2}function $2F4(n,t,i){var r=$(n.$xg.ownerDocument.createElement("input"));r.attr("type","hidden");r.attr("name",t);r.val(i);n.$xg.appendChild(r[0])}_at.$3h.prototype={$xg:null,$NW:null,$47a:!1,$1d:null,$U9:0,$2hg:null,$3m6:!1,$3XR:null,get_$93:function(){return this.$W(_at.$3h.$3j5)},set_$93:function(n){this.$M(_at.$3h.$3j5,n);return n},get_$9s:function(){return this.$W(_at.$3h.$4Ro)},set_$9s:function(n){this.$M(_at.$3h.$4Ro,n);return n},get_$2a:function(){return this.$W(_at.$3h.$1EG)},set_$2a:function(n){n||(this.$7r=-1);this.$M(_at.$3h.$1EG,n);return n},get_$2yP:function(){return this.$W(_at.$3h.$3vR)},set_$2yP:function(n){this.$M(_at.$3h.$3vR,n);return n},get_$2EI:function(){return this.$W(_at.$3h.$3XS)},set_$2EI:function(n){this.$M(_at.$3h.$3XS,n);return n},get_$6o2:function(){return this.$3XR},set_$6o2:function(n){if(this.$3XR===n)return n;this.$3XR=n;$N(this,"UploadAndShareAttachmentCommand");return n},get_$3XT:function(){return this.$W(_at.$3h.$4iZ)},set_$3XT:function(n){this.$M(_at.$3h.$4iZ,n);return n},get_$EB:function(){return this.$1d},set_$EB:function(n){this.$1d=n;$N(this,"Error");return n},get_$2Hw:function(){return this.$U9},set_$2Hw:function(n){this.$U9=n;$N(this,"AttachmentError");return n},get_$3Uh:function(){return this.$2hg},set_$3Uh:function(n){this.$2hg=n;$N(this,"SuccessResponse");return n},$4Oe:function(){_js.$D.prototype.$4Oe.call(this);this.$M(_at.$3h.$3XS,new _C(this.$$d_$AEE,_at.$3h.$A));this.set_$6o2(new _C(this.$$d_$AED,_at.$3h.$A))},$8BM:function(n){if(this.$7r){if(this.$7r===2){_js.Trace.logInfo(_at.$3h.$A,"Response received.");var t="";try{t=this.get_$H()[0].contentWindow.document.body.innerText}catch(i){if(!(_a.UserAgent.getInstance().$9W&&i.number===-2146828218)){_js.Trace.logException(_at.$3h.$A,i,"Unhandled exception while executing HandleCreateAttachmentResponse");return}}if(this.$47a)_js.$8.$a(t)&&$3Z7(this,null,"Error sending the attachment upload form",1);else{var u=this,r=this;_at.$BP.$8As(t,this.get_$93(),this.get_$9s(),_g.$1Y.$w,function(n){_js.Trace.logInfo(_at.$3h.$A,"HandleCreateAttachmentResponse completed.");$3Z7(u,n,null,0)},function(n,t){_js.Trace.logInfo(_at.$3h.$A,"HandleCreateAttachmentResponse failed: {0}",n.message);var i=1;if(n.ResponseCode){var u=n.ResponseCode.toString();r.get_$93().get_$6K()&&u==="ErrorInvalidOperation"?i=4:u==="ErrorMessageSizeExceeded"&&(i=3)}var f=_at.$87.$5XR(t)||_at.$87.$2OF(n);$3Z7(r,null,f,i)})}}}else{_js.Trace.logInfo(_at.$3h.$A,"Initializing.");this.$7r=1;$6sT(this);_js.$J.get_$I().$1s(_at.$3h.$A,"ExecuteOpenFilePicker",this.$$d_$5Sc,0)}},$3zx:function(){if(!this.$3m6){this.$3m6=!0;var n=this.$NW[0].value;if(!_js.$8.$a(n)){this.get_$93().set_$1N($6sU(this,n));this.get_$2yP().$s()}}},$5Sc:function(){this.$NW[0].click()},$AEE:function(){this.$47a=!1;this.$xg.action=_g.$5q.get_$5D6();$4lT(this)},$AED:function(){this.$47a=!0;this.$xg.action=_g.$5q.get_$7bq();$2F4(this,"subscriptionId",this.get_$Z().get_$IA());$4lT(this)}};_at.AttachmentPolicyLevel=function(){};_at.AttachmentPolicyLevel.prototype={undefined:0,block:1,forceSave:2,allow:3};_at.AttachmentPolicyLevel.registerEnum("_at.AttachmentPolicyLevel",!1);_at.$1IA=function(){};_at.$1IA.registerInterface("_at.$1IA");_at.$5t=function(n,t){this.$LC=n||_at.$5t.$88b();this.$2g8=t;this.$13Z=this.$2g8?this.$LC.DirectFileAccessOnPublicComputersEnabled:this.$LC.DirectFileAccessOnPrivateComputersEnabled;if(this.$13Z){this.$5TX=_at.$5t.$5MG(this.$LC.BlockedFileTypes,this.$LC.ForceSaveFileTypes,this.$LC.AllowedFileTypes);this.$6E8=_at.$5t.$5MG(this.$LC.BlockedMimeTypes,this.$LC.ForceSaveMimeTypes,this.$LC.AllowedMimeTypes)}this.$6Rn=_at.$5t.$7jS(this.$LC.ActionForUnknownFileAndMIMETypes)};_at.$5t.get_$I=function(){_at.$5t.$w||(_at.$5t.$w=new _at.$5t(_g.$V.get_$I().get_$5DE(),_g.$V.get_$I().get_$9zZ()));return _at.$5t.$w};_at.$5t.$7jS=function(n){var t;try{t=_js.$1i.$Qb(_at.AttachmentPolicyLevel,n)}catch(i){t=1}return t};_at.$5t.$5Yx=function(n,t){return n[t]||0};_at.$5t.$5MG=function(n,t,i){var r={};_at.$5t.$3gs(r,i,3);_at.$5t.$3gs(r,t,2);_at.$5t.$3gs(r,n,1);return r};_at.$5t.$3gs=function(n,t,i){if(t)for(var u=t,f=u.length,r=0;r<f;++r){var e=u[r];n[e]=i}};_at.$5t.$88b=function(){var n=new _g.$aa;return JsonParser.deserialize('{"AllowedFileTypes":[".rpmsg", ".xlsx", ".xlsm", ".xlsb", ".tiff", ".pptx", ".pptm", ".ppsx", ".ppsm", ".docx", ".docm", ".zip", ".xls", ".wmv", ".wma", ".wav", ".vsd", ".vss", ".vst",  ".vdx", ".vsx", ".vtx", ".vsdx", ".vssx", ".vstx", ".vsdm", ".vssm", ".vstm",".txt", ".tif", ".rtf", ".pub", ".ppt", ".png", ".pdf", ".one", ".mp3", ".jpg", ".gif", ".doc", ".bmp", ".avi"],"AllowedMimeTypes":["image/jpeg", "image/png", "image/gif", "image/bmp"],"ForceSaveFileTypes":[".swf", ".spl", ".dir", ".dcr"],"ForceSaveMimeTypes":["Application/x-shockwave-flash", "Application/octet-stream", "Application/futuresplash", "Application/x-director"],"BlockedFileTypes":[".vsmacros", ".msh2xml", ".msh1xml", ".ps2xml", ".ps1xml", ".mshxml", ".gadget", ".mhtml", ".psc2", ".psc1", ".msh2", ".msh1", ".aspx", ".xml", ".wsh", ".wsf", ".wsc", ".vsw", ".vbs", ".vbp", ".vbe", ".url", ".tmp", ".shs", ".shb", ".sct", ".scr", ".scf", ".reg", ".pst", ".ps2", ".ps1", ".prg", ".prf", ".plg", ".pif", ".pcd", ".osd", ".ops", ".mst", ".msp", ".msi", ".msh", ".msc", ".mht", ".mdz", ".mdw", ".mdt", ".mde", ".mdb", ".mda", ".maw", ".mav", ".mau", ".mat", ".mas", ".mar", ".maq", ".mam", ".mag", ".maf", ".mad", ".lnk", ".ksh", ".jse", ".its", ".isp", ".ins", ".inf", ".htc", ".hta", ".hpj", ".hlp", ".fxp", ".exe", ".der", ".csh", ".crt", ".cpl", ".com", ".cnt", ".cmd", ".chm", ".cer", ".bat", ".bas", ".asx", ".asp", ".app", ".adp", ".ade", ".ws", ".vb", ".js"],"BlockedMimeTypes":["application/x-javascript", "application/javascript", "application/msaccess", "x-internet-signup", "text/javascript", "application/xml", "application/prg", "application/hta", "text/scriplet", "text/xml"], "ActionForUnknownFileAndMIMETypes":"ForceSave","BlockWacViewingThroughUI":false,"WacViewableFileTypes":[".doc", ".docx", ".ppt", ".pptx", "xls", ".xlsx"],"WacViewingOnPublicComputersEnabled":true,"WacViewingOnPrivateComputersEnabled":true,"ForceWacViewingFirstOnPublicComputers":false,"ForceWacViewingFirstOnPrivateComputers":false,"ForceWebReadyDocumentViewingFirstOnPublicComputers":false,"ForceWebReadyDocumentViewingFirstOnPrivateComputers":false,"DirectFileAccessOnPrivateComputersEnabled":true,"DirectFileAccessOnPublicComputersEnabled":true,"WebReadyDocumentViewingOnPublicComputersEnabled":true,"WebReadyDocumentViewingOnPrivateComputersEnabled":true,"WebReadyDocumentViewingForAllSupportedTypes":false,"WebReadyFileTypes":[".xlsx", ".pptx", ".docx", ".xls", ".rtf", ".ppt", ".pps", ".pdf", ".dot", ".doc"],"WebReadyMimeTypes":["application/vnd.openxmlformats-officedocument.presentationml.presentation", "application/vnd.openxmlformats-officedocument.wordprocessingml.document", "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet", "application/vnd.ms-powerpoint", "application/x-mspowerpoint", "application/vnd.ms-excel", "application/x-msexcel", "application/msword", "application/pdf"],"WebReadyDocumentViewingSupportedFileTypes":[".xlsx", ".pptx", ".docx", ".xls", ".rtf", ".ppt", ".pps", ".pdf", ".dot", ".doc"],"WebReadyDocumentViewingSupportedMimeTypes":["application/vnd.openxmlformats-officedocument.presentationml.presentation", "application/vnd.openxmlformats-officedocument.wordprocessingml.document", "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet", "application/vnd.ms-powerpoint", "application/x-mspowerpoint", "application/vnd.ms-excel", "application/x-msexcel", "application/msword", "application/pdf"]}')};_at.$5t.$1wQ=function(n,t){if(!n)return!1;for(var r=n,u=r.length,i=0;i<u;++i){var f=r[i];if(f===t)return!0}return!1};function $6sH(n,t,i){var r=_at.$5t.$5Yx(n.$5TX,t);if(r===1)return 1;var u=_at.$5t.$5Yx(n.$6E8,i);return u===1?1:r===2||u===2?2:r===3||u===3?3:n.$6Rn}function $6sK(n,t){var i=n.$2g8?n.$LC.WacViewingOnPublicComputersEnabled:n.$LC.WacViewingOnPrivateComputersEnabled;return i&&$6sM(n,t)}function $6sJ(n,t,i){var r=n.$2g8?n.$LC.WebReadyDocumentViewingOnPublicComputersEnabled:n.$LC.WebReadyDocumentViewingOnPrivateComputersEnabled;return r&&$6sL(n,t,i)}function $6sI(n,t,i,r){return!i&&!r?!1:t?i?n.$LC.ForceWacViewingFirstOnPublicComputers:n.$LC.ForceWebReadyDocumentViewingFirstOnPublicComputers:i?n.$LC.ForceWacViewingFirstOnPrivateComputers:n.$LC.ForceWebReadyDocumentViewingFirstOnPrivateComputers}function $6sM(n,t){return _at.$5t.$1wQ(n.$LC.WacViewableFileTypes,t)}function $6sL(n,t,i){if(_js.$8.$a(t)){if(!_js.$8.$a(i))return n.$LC.WebReadyDocumentViewingForAllSupportedTypes?_at.$5t.$1wQ(n.$LC.WebReadyDocumentViewingSupportedMimeTypes,i):_at.$5t.$1wQ(n.$LC.WebReadyMimeTypes,i)}else return n.$LC.WebReadyDocumentViewingForAllSupportedTypes?_at.$5t.$1wQ(n.$LC.WebReadyDocumentViewingSupportedFileTypes,t):_at.$5t.$1wQ(n.$LC.WebReadyFileTypes,t);return!1}_at.$5t.prototype={$2g8:!1,$13Z:!1,$6Rn:0,$LC:null,$5TX:null,$6E8:null,$30X:function(n,t,i){$5(i)&&(i=!0);$5(n)||(n=n.toLowerCase());var f;f=this.$13Z?$6sH(this,n,t):1;var u=!1;var r=!1;var e=!1;var o=!1;if(i){$6sK(this,n)&&(r=!0);$6sJ(this,n,t)&&(u=!0);e=$6sI(this,this.$2g8,r,u);r&&this.$LC.WacEditableFileTypes&&n&&(o=_at.$5t.$1wQ(this.$LC.WacEditableFileTypes,n))}return new _at.$13G(this.$13Z,f,r,u,e,o)}};_at.$13G=function(n,t,i,r,u,f){!n;this.$13Z=n;this.$mF=t;this.$1p8=i;this.$1KV=r;this.$2Ni=u;this.$4jX=f};_at.$13G.prototype={$mF:0,$13Z:!1,$2Ni:!1,$1p8:!1,$1KV:!1,$4jX:!1,get_$37y:function(){return this.$1KV||this.$1p8},toString:function(){return String.format("Attachment PolicyLevel: {0}, DirectFileAccessEnabled: {1}, WAC: {2}, Stellent: {3}, ForceBrowserView: {4}, WacEdit: {5}",this.$mF,this.$13Z,this.$1p8,this.$1KV,this.$2Ni,this.$4jX)}};_at.$wx=function(){this.$1sI=new FileReader};_at.$wx.prototype={$1sI:null,$5SM:null,get_$EB:function(){return this.$1sI.error},get_$1w4:function(){return this.$5SM},get_$hJ:function(){return this.$1sI.result},get_$6L0:function(){return this.$1sI.onloadend},set_$6L0:function(n){this.$1sI.onloadend=n;return n},$6Un:function(n){var t=n;this.$1sI.readAsDataURL(t.$2IB)},$4V4:function(n,t,i,r){var u=this;this.set_$6L0(function(){if(!u.get_$EB()&&u.get_$hJ()){var n=u.get_$hJ().indexOf(",");var f=u.get_$hJ().substring(n+1,u.get_$hJ().length);_js.Trace.logInfo(r,"No error - Reading the file.");u.get_$hJ().substring(0,n).indexOf("base64")!==-1?t(f):t(_a.$9R.$Ew(f))}else{_js.Trace.logWarning(r,"File reader failed with error code {0}",u.get_$EB());i()}});try{this.$6Un(n)}catch(f){this.$5SM=f;_a.UserAgent.getInstance().$Mi&&f.name==="NS_ERROR_FILE_ACCESS_DENIED"?_js.Trace.logInfo(r,"Firefox: failed to read an attachment. Exception: {0}",f.message):_js.Trace.logWarning(r,"Unexpected exception was thrown by FileReader.ReadAsDataURL: "+f.message);i()}}};_at.$wy=function(){};_at.$wy.prototype={$3oe:function(){return new _at.$wx}};_at.$BP=function(n,t,i){_at.$BP.initializeBase(this);this.$mW=n;this.$1B=t;this.$JS=i};_at.$BP.$8As=function(n,t,i,r,u,f){try{var e=JsonParser.deserialize(n);if(e&&e.Body)if(e.Body.ResponseMessages){var s=e.Body.ResponseMessages.Items[0];if(s.ResponseCode!=="NoError"){_js.Trace.logError(_at.$BP.$A,"Got a attachment error response with {0}",s.ResponseCode);var a=s.MessageText;var l={};l.ResponseCode=s.ResponseCode;f(Error.create(a,l),null)}else{var o=s.Attachments[0];t.set_$3l(o.AttachmentId);i.Id=o.AttachmentId.RootItemId;i.ChangeKey=o.AttachmentId.RootItemChangeKey;t.set_$50(o.Size||0);t.set_$Bw(o.ContentType);t.get_$6K()&&t.set_$H7(o.ContentId);u(e)}}else{_js.Trace.logError(_at.$BP.$A,"Got no response message in the body; assuming it is a fault response");var c=e;f(Error.create(c.Body.FaultMessage),c.Body)}else{_js.Trace.logError(_at.$BP.$A,"Got no response or response without body");f(Error.create(""),null)}}catch(h){_js.Trace.logError(_at.$BP.$A,"Got exception processing response: {0}, exception: {1}",n,h);n===""&&(h=Error.create(""));f(h,null)}};_at.$BP.$6TQ=function(n,t,i){t.set_$3l(n.Attachments[0].AttachmentId);t.get_$6K()&&t.set_$H7(n.Attachments[0].ContentId);n.Attachments[0].Size>0&&t.set_$50(n.Attachments[0].Size);i.Id=n.Attachments[0].AttachmentId.RootItemId;i.ChangeKey=n.Attachments[0].AttachmentId.RootItemChangeKey};function $4lQ(n,t){_at.$BP.$6TQ(t,n.$1B,n.$JS)}function $4lP(n){var r=new _g.$1t(n.$JS.Id);r.ChangeKey=n.$JS.ChangeKey;var i=n.$1B.$2O2();var t=new _g.$Wl(r);t.Attachments=[i];t.RequireImageType=i.IsInline;t.IncludeContentIdInResponse=i.IsInline;t.ClientSupportsIrm=!0;return new _g.$Wk(n.get_$70(),t)}_at.$BP.prototype={$mW:0,$1B:null,$JS:null,$BA:null,$88K:function(){if(this.$1d||!this.$5w||!this.$5w.response){_js.Trace.logInfo(_at.$BP.$A,"No success response because there's an error, or action is not complete.  Error: {0}",this.$1d);return null}return this.$5w.response.result},$5gb:function(n){var t=new _g.$wH(this.$2C);t.clientStoreItem=this.$mW;t.isQueued=!1;t.palContext=new _g.$sR(!1);this.$BA=$4lP(this);n.$1NA(this.$BA,t,this.$$d_$AJb,this.$$d_$9e1)},$4UT:function(n){$4lQ(this,n)}};_at.$14o=function(n,t,i){_at.$14o.initializeBase(this,[n,t,i]);var r=t.$Ft;this.$5NQ=r};_at.$14o.prototype={$5NQ:null,$5gb:function(n){var i=$4lP(this);var t=new _g.$wH(this.$2C);t.clientStoreItem=this.$mW;t.isQueued=!0;t.palContext=new _g.$sR(!0);t.dataFile=this.$5NQ.$Od();n.$1NA(i,t,this.$$d_$AJb,this.$$d_$9e1)},$4UT:function(n){$4lQ(this,n)}};_at.$15K=function(n,t,i){_at.$15K.initializeBase(this);this.$mW=n;this.$1B=t;this.$JS=i;this.$8p=t.get_$3l()||t.get_$B0()};_at.$15K.prototype={$mW:0,$1B:null,$8p:null,$JS:null,$4UT:function(n){this.$JS.Id=n.RootItemId.RootItemId;this.$JS.ChangeKey=n.RootItemId.RootItemChangeKey;this.$1B.get_$B0()&&this.$1B.set_$3l(this.$1B.get_$B0())},$5gb:function(n){var i=new _g.$Wr;i.ClientSupportsIrm=!0;var r=new _g.$15L(this.$2C);r.itemContexts=new Array(1);var t=new _g.$15M;t.clientStoreItem=this.$mW;t.parentItemId=new _g.$1t(this.$JS.Id);t.parentItemId.ChangeKey=this.$JS.ChangeKey;i.AttachmentIds=[new _g.$Ag(this.$8p.Id)];var u=new _g.$bm(this.get_$70());u.Body=i;r.itemContexts[0]=t;n.$1b6(u,r,this.$$d_$AJb,this.$$d_$9e1)}};_at.$cq=function(n){_at.$cq.initializeBase(this);_a.$6.$1X(_at.$cq.$A,"DownloadAttachment");this.$8p=n};_at.$cq.prototype={$8p:null,$2uc:null,$5gb:function(n){var i=new _g.$16j(this.$2C);var t=new _g.$cs(this.get_$70());t.Body.AttachmentIds=[new _g.$Ag(this.$8p)];t.Body.ShapeName="ItemAttachment";t.Body.AttachmentShape=_h.$v.get_$8PK();n.$3x4(t,i,this.$$d_$AJb,this.$$d_$9e1)},$4UT:function(n){var t=n.Attachments.length;if(t!==1){_js.Trace.logWarning(_a.$0.$1P,"GetAttachment response length = {0}",t);return}var i=n.Attachments[0];if(!i){_js.Trace.logWarning(_a.$0.$1P,"GetAttachment response contained null attachment");return}var r=_a.$1H.$AI4(_g.$8L,i);this.$2uc=r.get_$3o();if(!this.$2uc){_js.Trace.logWarning(_a.$0.$1P,"GetAttachment response contained null item");return}_js.Trace.logInfo(_a.$0.$1P,"GetAttachment succeeded for '{0}' on '{1}'",r.get_$1N(),this.$2uc.get_$2i());_a.$6.$19(null,"DownloadAttachment")}};_at.$MJ=function(n,t){_at.$MJ.initializeBase(this);this.$1z=n;this.$1B=t;this.$8p=t.get_$3l()||t.get_$B0();if(!_g.$5d.isInstanceOfType(t)&&!_g.$8L.isInstanceOfType(t)&&!_g.$8z.isInstanceOfType(t))throw Error.notImplemented("Only FileAttachment, ItemAttachment and ItemIdAttachment are supported to get content.");};function $4lS(n){var t=new XMLHttpRequest;var i=String.format(_g.$8L.isInstanceOfType(n.$1B)?_g.$5q.get_$1Yq():_g.$5q.get_$7bo(),encodeURIComponent(n.$8p.Id));var r=this;t.onreadystatechange=function(){if(t.readyState===4)if(t.status===200){var i=$3Z6(n,t.responseText);_g.$5d.isInstanceOfType(n.$1B)?n.$1B.set_$CZ(i):_g.$8L.isInstanceOfType(n.$1B)&&n.$1B.set_$JM(i);$Ep(n,null)}else{var r=String.format("Unable to get file attachment content.\nAttachmentId = {0}\nResponseBody = {1}\nStatusText = {2}",n.$8p.Id,t.responseText,t.statusText);_js.Trace.logError(n.$1z,r);$Ep(n,Error.create(r))}};t.open("GET",i,!0);_a.$j.$6hs(t);t.send(null);return 1}function $3Z6(n,t){if(t.startsWith("data:")){var i=";base64,";var r=t.indexOf(i);return t.substr(r+i.length)}else return t}_at.$MJ.prototype={$1z:null,$1B:null,$8p:null,$6JM:function(){if(_g.$5d.isInstanceOfType(this.$1B)){var n=this.$1B;if(_a.$190.isInstanceOfType(n.$Ft)){var r=n.$Ft;var u=new _at.$wy;var f=u.$3oe();var t=this,i=this;f.$4V4(r,function(i){n.set_$CZ($3Z6(t,i));$Ep(t,null)},function(){var t=String.format("Unable to read content of file {0}.",n.get_$1N());_js.Trace.logWarning(i.$1z,t);$Ep(i,Error.create(t))},this.$1z);return 1}else return $4lS(this)}else return _g.$8L.isInstanceOfType(this.$1B)?$4lS(this):_h.$12V.prototype.$6JM.call(this)},$6Ti:function(n,t,i){var r=this.$1B;if(_js.$8.$a(n))i(Error.create(String.format("The MIME content of item {0} cannot be retrieved.",r.get_$i().Id)));else{r.set_$JM($3Z6(this,n));t()}},$5gb:function(n){n.$3yD(this.$1B.get_$i(),null,this.$$d_$AJb,this.$$d_$9e1)}};var IAttachmentDataProviderMap=function(){};IAttachmentDataProviderMap.registerInterface("IAttachmentDataProviderMap");_at.$1IM=function(){};_at.$1IM.registerInterface("_at.$1IM");var IAttachmentPreviewViewModelFactory=function(){};IAttachmentPreviewViewModelFactory.registerInterface("IAttachmentPreviewViewModelFactory");_at.$1IJ=function(){};_at.$1IJ.registerInterface("_at.$1IJ");_at.$YD=function(){};_at.$YD.registerInterface("_at.$YD");_at.$13E=function(n,t){_at.$13E.initializeBase(this,[1,"VM.Attachment.DeleteStarted"]);this.set_$50(n);this.set_$8P9(t)};_at.$13E.prototype={get_$50:function(){return this.$W("s")},set_$50:function(n){$1I(this,"s",n);return n},get_$8P9:function(){return this.$W("w")},set_$8P9:function(n){$1I(this,"w",n);return n}};_at.$CL=function(n,t,i,r,u){this.$OY=_js.$8.$a(n)?"#":n;this.$bk=t;this.$LI=i;this.$6Z=r;this.$8NN=u;this.$2E=u?_nbs.NonBootStrings.l_OpenInBrowser_Text:_nbs.NonBootStrings.l_Download_Text;_js.Trace.logInfo(_a.$0.$1P,'AttachmentDownloadLinkViewModel isHidden={0}, preventNavigation={1}, text="{2}", URL={3}',this.$6Z,this.$bk,this.$2E,this.$OY)};_at.$CL.get_$5cq=function(){_at.$CL.$325||(_at.$CL.$325=new _at.$CL("#",!0,null,!0,!1));return _at.$CL.$325};_at.$CL.$E=function(n,t,i){_a.$3.$K(n,"viewModel");_a.$3.$K(i,"owaShell");var r;var u;var f;if(t){var e,o,s;_at.$CL.$7eH(n,e={val:u},o={val:r},s={val:f});u=e.val;r=o.val;f=s.val}else{var h,c,l;_at.$CL.$5Eu(n,h={val:u},c={val:r},l={val:f});u=h.val;r=c.val;f=l.val}if(_at.$5x.isInstanceOfType(n)){var a=n;a.$bd.get_$qY()&&(r=!0)}return new _at.$CL(u,r,f,!1,t)};_at.$CL.$5Eu=function(n,t,i,r){var u=!1;if(_at.$5x.isInstanceOfType(n)){var f=n;u=f.$bd.get_$qY()}if(!n.$Gv.$13Z||u||n.$Gv.$2Ni||n.$1B.get_$IU()){i.val=!0;t.val="#";r.val=n.$u8;return}switch(n.$Gv.$mF){case 3:i.val=!1;t.val=n.$OY;r.val=n.$6dL;break;case 2:i.val=!0;r.val=n.$u8;t.val=n.$OY;break;case 1:i.val=!0;t.val="#";r.val=n.$u8;break;case 0:default:i.val=!0;t.val="#";r.val=n.$u8;break}};_at.$CL.$7eH=function(n,t,i,r){if(n.$1B.get_$IU()){i.val=!0;t.val="#";r.val=n.$u8;return}switch(n.get_$Bq()){case 5:i.val=!0;t.val="#";r.val=n.$6OD;break;case 3:i.val=!0;t.val="#";r.val=n.$1k2;break;case 1:case 2:i.val=!0;t.val="#";r.val=n.$Gv.$mF===3?new _C(function(){n.$6O&&n.$6O.$A0o(n)},_a.$0.$1P):n.$u8;break;default:_at.$CL.$5Eu(n,t,i,r);break}};_at.$CL.prototype={$bk:!1,$OY:null,$LI:null,$2E:null,$6Z:!1,$8NN:!1};_at.$13F=function(n,t,i,r,u){_at.$13F.initializeBase(this,[1,"VM.Attachment.Open"]);this.set_$50(n);this.set_$6Rm(t);this.set_$Cc(i)};_at.$13F.prototype={get_$50:function(){return this.$W("s")},set_$50:function(n){$1I(this,"s",n);return n},get_$6Rm:function(){return this.$W("pl")},set_$6Rm:function(n){$1I(this,"pl",n);return n},get_$Cc:function(){return this.$W("ro")},set_$Cc:function(n){$1I(this,"ro",n);return n}};_at.$13H=function(n,t,i,r){_at.$13H.initializeBase(this,[1,"VM.Attachment.ServerDeleteCompleted"]);this.set_$Ze(n);this.set_$50(t);this.set_$6FO(i);this.set_$Bw(r||"")};_at.$13H.prototype={get_$50:function(){return this.$W("s")},set_$50:function(n){$1I(this,"s",n);return n},get_$Ze:function(){return this.$W("suc")},set_$Ze:function(n){$1I(this,"suc",n);return n},get_$6FO:function(){return this.$W("nl")},set_$6FO:function(n){$1I(this,"nl",n);return n},get_$Bw:function(){return this.$W("ct")},set_$Bw:function(n){$1I(this,"ct",n);return n}};_at.$13J=function(n,t,i,r,u){_at.$13J.initializeBase(this,[1,"VM.Attachment.SingleUploadCompleted"]);this.set_$Ze(n);this.set_$50(t);this.set_$6Rm(i);this.set_$6FO(r);this.set_$Bw(u||"")};_at.$13J.prototype={get_$50:function(){return this.$W("s")},set_$50:function(n){$1I(this,"s",n);return n},get_$Ze:function(){return this.$W("suc")},set_$Ze:function(n){$1I(this,"suc",n);return n},get_$6Rm:function(){return this.$W("pl")},set_$6Rm:function(n){$1I(this,"pl",n);return n},get_$6FO:function(){return this.$W("nl")},set_$6FO:function(n){$1I(this,"nl",n);return n},get_$Bw:function(){return this.$W("ct")},set_$Bw:function(n){$1I(this,"ct",n);return n}};_at.$Dp=function(){};_at.$Dp.$6lJ=function(n,t,i,r,u){if(_a.$g.get_$RP()){var f=new _at.$13F(n,t,i,r,u);_a.$g.$8n.$AP(f)}};_at.$Dp.$A95=function(n,t){if(_a.$g.get_$RP()){var i=new _at.$13E(n,t);_a.$g.$8n.$AP(i)}};_at.$Dp.$A9D=function(n,t,i,r){if(_a.$g.get_$RP()){var u=new _at.$13H(n,t,i,r);_a.$g.$8n.$AP(u)}};_at.$Dp.$2Dx=function(n){if(_a.$g.get_$RP()){var t=new _at.$13M(n);_a.$g.$8n.$AP(t)}};_at.$Dp.$A9E=function(n,t,i,r,u){if(_a.$g.get_$RP()){var f=new _at.$13J(n,t,i,r,u);_a.$g.$8n.$AP(f)}};_at.$13M=function(n){_at.$13M.initializeBase(this,[1,"VM.Attachment.UploadStarted"]);$1I(this,"t",n)};_at.$1I=function(n,t,i,r,u,f,e,o,s){this.$$d_$AEH=Function.createDelegate(this,this.$AEH);this.$$d_$5TV=Function.createDelegate(this,this.$5TV);this.$$d_$4Zs=Function.createDelegate(this,this.$4Zs);this.$$d_$5Kb=Function.createDelegate(this,this.$5Kb);this.$$d_$2tj=Function.createDelegate(this,this.$2tj);this.$$d_$5Oc=Function.createDelegate(this,this.$5Oc);this.$$d_$7qp=Function.createDelegate(this,this.$7qp);this.$$d_$5DF=Function.createDelegate(this,this.$5DF);this.$$d_$7kJ=Function.createDelegate(this,this.$7kJ);this.$$d_$9Qt=Function.createDelegate(this,this.$9Qt);this.$$d_$1b6=Function.createDelegate(this,this.$1b6);this.$$d_$9eK=Function.createDelegate(this,this.$9eK);this.$$d_$6O5=Function.createDelegate(this,this.$6O5);this.$$d_$3Ke=Function.createDelegate(this,this.$3Ke);this.$$d_$9x5=Function.createDelegate(this,this.$9x5);this.$$d_$2wq=Function.createDelegate(this,this.$2wq);this.$$d_$TS=Function.createDelegate(this,this.$TS);this.$3vQ=new _at.$wy;this.$Wm=2;_at.$1I.resolveInheritance();this.apcl=this.$Y;this.rpcl=this.$q;_at.$1I.initializeBase(this);this.$2D=f;this.$1H=o;this.$12R=s;this.set_$93(n);this.$B=t;this.set_$9fc(u);this.$1A=e;_g.$5d.isInstanceOfType(n)&&(this.$14C=n.get_$CZ());u&&(this.$5H=u.get_$md());this.$53=i;this.$A0=r;this.set_$1BU(!this.$53);this.set_$5TR(_a.$7R.$Y0(n.get_$1N()));this.set_$6Rl(_at.$5t.get_$I().$30X(this.$xU,this.$1B.get_$Bw(),_y.$8u.$48J(this.$B,this.$1A)));this.$1B&&this.$1B.get_$3l()&&this.set_$27t(this.$Gv.get_$37y()&&!this.$1B.get_$IU()&&!this.$1B.get_$sG());this.$3X9();this.$2EH();this.$6nX();$4lL(this);$3Z4(this);this.$u8=new _C(this.$$d_$TS,_at.$1I.$A);this.$2wr=new _C(this.$$d_$2wq,_at.$1I.$A);this.$6dL=new _C(this.$$d_$9x5,_at.$1I.$A);this.$6OD=new _C(this.$$d_$3Ke,_at.$1I.$A);this.$1k2=new _C(this.$$d_$6O5,_at.$1I.$A);this.$5qp=new _C(this.$$d_$9eK,_at.$1I.$A);if(!this.get_$8J6()){this.$Jm=new _C(this.$$d_$1b6,_at.$1I.$A);this.$3JX=new _C(this.$$d_$9Qt,_at.$1I.$A);this.$3Jb=new _C(this.$$d_$7kJ,_at.$1I.$A)}this.$cG=new _y.$iW;$4lK(this);this.$Ww()};function $1XX(n,t,i,r){_js.Trace.logWarning(_at.$1I.$A,"create failed with error: {0}, {1}",t,i);n.$FW=!0;n.$U9=t;n.$2q7=i;n.$6O&&n.$6O.$379(n.$5H)&&n.$6O.$18c(n,!1)}function $11x(n,t){n.$1v?n.get_$D3().$2u(0,t,null):_a.$4Y.$2u(t,1)}function $4lK(n){if(n.$B.get_$L()!=="TouchNarrow"){var t=new _0365m.$2c(new Array(0));n.get_$8KW()&&n.get_$3Nz()&&!n.$53&&t.$14.$D(new _0365m.$o(_u.Strings.l_ContextMenu_ManagePermissions_Text,null,n.$5qp));n.get_$Bq()!==4&&t.$14.$D(new _0365m.$o(_nbs.NonBootStrings.l_Download_LowerCase_Text,null,n.$2wr));n.set_$2Jy(t)}}function $6sO(n,t){_js.Trace.logInfo(_at.$1I.$A,"Submitting server action for file attachment with content.");var i=new _at.$BP(2,t,n.$6O.get_$9s());i.add_$21(n.$$d_$2tj);i.add_$2t(n.$$d_$5Kb);OwaApplication.$1W.$11(i)}function $4lM(n,t){var i=n.$5Mr=n.$3vQ.$3oe();i.$4V4(t,n.$$d_$4Zs,n.$$d_$5TV,_at.$1I.$A)}function $6sR(n){_js.Trace.logInfo(_at.$1I.$A,"Submitting action for item or id attachment.");var t=new _at.$BP(2,n.$1B,n.$6O.get_$9s());t.add_$21(n.$$d_$2tj);t.add_$2t(n.$$d_$5Kb);OwaApplication.$1W.$11(t)}function $4lJ(n){_js.Trace.logInfo(_at.$1I.$A,"Starting attachment upload.");var t=this,i=this;_g.$1Y.$w.$2xz("CreateAttachment",n.$$d_$AEH,$6sN(n),function(n){_js.Trace.logInfo(_at.$1I.$A,"Upload attachment enqueued. UploadOnlineOnlyAttachment will be called when we have connection to the server.")},function(t){_js.Trace.logWarning(_at.$1I.$A,"Enqueueing upload attachment failed: {0}",t.message);$1XX(n,1,_at.$87.$2OF(t),!0);$2jx(n,null)})}function $6sN(n){var t=n.$6O.get_$9s();var i=new _g.$1t(t.Id);i.ChangeKey=t.ChangeKey;var r=new _g.$Wl(i);return new _g.$Wk(null,r)}function $2jx(n,t){var i=n.$FW?_y.$v5.toString(n.$U9):"";_js.Trace.logInfo(_at.$1I.$A,"Attachment create completed. Status: {0}",i);if(n.$4Uq){t&&n.set_$3XV(t.$88K());n.$4Uq(n.$2EJ)}n.set_$6o4(!1);n.set_$27t(!n.$FW&&n.$Gv.get_$37y()&&!n.$1B.get_$IU()&&!n.$1B.get_$sG());$4lK(n);_at.$Dp.$A9E(!n.$FW,n.$1B.get_$50(),n.$Gv.$mF,n.$1B.get_$1N().length,n.$1B.get_$Bw());if(_g.$8L.isInstanceOfType(n.$1B)){n.$6O.$18c(n,!1);n.set_$93(t.$1B);n.$3X9();n.$6O.$12A(n)}if(!n.$FW&&(n.$1A.get_$5DD()||_g.$8z.isInstanceOfType(n.$1B)||_g.$9w.isInstanceOfType(n.$1B)||_g.$5d.isInstanceOfType(n.$1B)&&_y.$ky.isInstanceOfType(n.$1B.$Ft))){_js.Trace.logInfo(_at.$1I.$A,"Incrementing parent well size.");(!t||n.$6O.$379(n.$5H))&&n.$6O.$Ua(n.$1B.get_$50());$4lL(n)}$Cq(n,"OnUploadCompleteEvent",n)}function $3Z3(n){$6sQ(n);n.$1B?n.$1B.get_$3l()?_js.Trace.logInfo(_at.$1I.$A,"SafeOpenAttachment: Name={0}, ID={1}",n.$1B.get_$1N(),n.$1B.get_$3l().Id):_js.Trace.logWarning(_at.$1I.$A,"SafeOpenAttachment: AttachmentId is null"):_js.Trace.logWarning(_at.$1I.$A,"SafeOpenAttachment: Attachment is null");_js.Trace.logInfo(_at.$1I.$A,"SafeOpenAttachment: Policy={0}",n.$Gv.toString());if(n.$Gv.$2Ni){_js.Trace.logInfo(_at.$1I.$A,"Attachment policy forces browser viewing.");n.$B.get_$L()==="Mouse"?$11x(n,_nbs.NonBootStrings.l_ForceBrowserViewingFirstAlert_Text):$11x(n,_nbs.NonBootStrings.l_ForceBrowserViewingFirstAlertNonMouse_Text);return}if(!n.$Gv.$13Z){$11x(n,_nbs.NonBootStrings.l_DirectFileAccessDisabled_Text);return}if(n.$Gv.$mF===1){$11x(n,_nbs.NonBootStrings.l_BlockedAlert_Text);return}if(n.$1B.get_$IU()){var i=_a.$j.$rV();_js.Trace.logInfo(_a.$0.$3i,"Saving S/MIME attachment {0}.",n.$1B.get_$1N());var r=_g.$5d.isInstanceOfType(n.$1B)?n.$1B.get_$CZ():n.$1B.get_$JM();var u=i.SaveFile(n.$1B.get_$1N(),r);u?_js.Trace.logInfo(_a.$0.$3i,"S/MIME attachment {0} is saved successfully.",n.$1B.get_$1N()):_js.Trace.logWarning(_a.$0.$3i,"S/MIME attachment {0} is not saved. Check the log of S/MIME plugin instead.",n.$1B.get_$1N());return}else if(n.$1B.get_$sG()){var f=_a.$j.$rV();var t=n.$1B;f.SaveFile(t.get_$1N(),t.get_$CZ());return}if(n.$Gv.$mF===2){$6sP(n);return}n.$4QX()}function $6sP(n){if(n.$B.get_$L()==="Mouse"){_js.Trace.logInfo(_at.$1I.$A,"Attachment policy forces save.");n.$1A.get_$8W()?$11x(n,_nbs.NonBootStrings.l_IE_ForceSaveAlert_Text):$11x(n,_nbs.NonBootStrings.l_Default_ForceSaveAlert_Text)}else{_js.Trace.logInfo(_at.$1I.$A,"Attachment policy forces save, but device doesn't support download.");$11x(n,_nbs.NonBootStrings.l_UnsupportedAttachment_Text)}}function $4lI(n,t){var i=n.$8p;i!==t&&n.$6Hb(i,t)}function $4lL(n){n.set_$2g4(n.$1kR||_g.$8z.isInstanceOfType(n.$1B)&&!n.$1B.get_$50()||_g.$5d.isInstanceOfType(n.$1B)&&_y.$ky.isInstanceOfType(n.$1B.$Ft)&&!n.$1B.get_$50())}function $3Z4(n){n.get_$3Nz()&&(n.$Wm===2?n.set_$6fJ(!0):n.set_$6fJ(!1))}function $6sQ(n){if(!n.$1B.get_$IU()&&!n.$1B.get_$sG()&&n.get_$6HC()){var t=_g.$1Y.$w.$rW(n.$1B.get_$3l());n.$1B.get_$3l().Id!==t.Id&&n.$1B.set_$3l(t)}}function $3Z2(n,t){var i=new _a.$6I;i.$6w("E",n.$xU);i.$5I("S",n.$1B.get_$50());var r="A";_at.$HZ.isInstanceOfType(n)?r="C":n.get_$Bq()===5?r="T":n.$1B.get_$6K()&&(r="I");i.$6w("T",r);i.$5I("O",t?1:0);return i.toString()}_at.$1I.prototype={$u8:null,$2wr:null,$6dL:null,$6OD:null,$1k2:null,$Jm:null,$3JX:null,$3Jb:null,$5qp:null,$cG:null,$53:!1,$A0:!1,$B:null,$1A:null,$5H:null,$1H:null,$12R:null,$2D:null,$1B:null,$OY:null,$21d:!1,$2J0:!1,$4ia:!1,$6O6:!1,$Gv:null,$6O:null,$38:!1,$by:!1,$2Cw:null,$3Ub:null,$12Q:0,$14P:null,$1Oe:0,$2EJ:null,$8p:null,$1kR:!1,$FW:!1,$U9:0,$2q7:null,$Om:!1,$xU:null,$4Uq:null,$Ub:null,$4bY:!1,$3Sl:!1,$32s:null,$1oC:null,$DU:null,$2Rn:!1,$14C:null,$1s5:null,$1Lt:null,$wH:null,$ng:!1,$5Mr:null,$1Cc:null,$1v:null,add_$1Tk:function(n){this.$2G("OnUploadCompleteEvent",n)},remove_$1Tk:function(n){this.$2H("OnUploadCompleteEvent",n)},add_$1Td:function(n){this.$2G("OnDeleteCompleteEvent",n)},remove_$1Td:function(n){this.$2H("OnDeleteCompleteEvent",n)},add_$27R:function(n){this.$2G("OnDownloadCompleteEvent",n)},remove_$27R:function(n){this.$2H("OnDownloadCompleteEvent",n)},get_$3iu:function(){return this.$1Lt},set_$3iu:function(n){this.$1Lt=n;return n},get_$Bq:function(){this.$12Q||(this.$12Q=this.$3x5());return this.$12Q},set_$Bq:function(n){n!==this.$12Q&&(this.$12Q=n);return n},get_$93:function(){return this.$1B},set_$93:function(n){var t=this.$1B;if(t!==n){$5(t)||t.remove_$83(this.$$d_$5DF);this.$1B=n;var i=$5(n);if(!i){n.add_$83(this.$$d_$5DF);_js.Trace.logInfo(_a.$0.$1P,"Attachment: {0}",n.get_$1N())}$4lI(this,i?null:n.get_$3l());$3(this,"Attachment");$3(this,"ReferenceAttachment");$3Z4(this)}return n},get_$GI:function(){return this.$Wm},set_$GI:function(n){if(this.$Wm!==n){this.$Wm=n;$3Z4(this)}return n},get_$3Nz:function(){return _g.$9w.isInstanceOfType(this.$1B)?this.$1B:null},get_$2L:function(){return this.$38},set_$2L:function(n){this.$38=n;$3(this,"IsSelected");return n},get_$3t3:function(){return this.$OY},set_$3t3:function(n){if(this.$OY!==n){this.$OY=n;_js.Trace.logInfo(_at.$1I.$A,"Attachment download URL: {0}",this.$OY);$3(this,"DownloadUrl")}return n},get_$8Om:function(){return this.$21d},set_$8Om:function(n){if(this.$21d!==n){this.$21d=n;$3(this,"IsTriggeredPolicyTip")}return n},get_$1BU:function(){return this.$2J0},set_$1BU:function(n){this.$2J0=n;$3(this,"CanDelete");return n},get_$6o4:function(){return this.$4ia},set_$6o4:function(n){this.$53||this.set_$1BU(!n);this.$4ia=n;$3(this,"UploadInProgress");return n},get_$27t:function(){return this.$6O6},set_$27t:function(n){this.$6O6=n;$3(this,"OpenDocumentInBrowserLinkVisible");return n},get_$6Rl:function(){return this.$Gv},set_$6Rl:function(n){this.$Gv=n;this.$12Q=this.$3x5();return n},get_$8IP:function(){return this.$6O},get_$9fc:function(){return this.$6O},set_$9fc:function(n){this.$6O=n;$3(this,"ParentWell");return n},get_$SG:function(){return this.$by},set_$SG:function(n){if(this.$by!==n){this.$by=n;this.$6O&&this.$6O.$8CN(this);$3(this,"ShouldBeHidden")}return n},get_$6QM:function(){return this.$1kR},set_$6QM:function(n){if(this.$1kR!==n){this.$1kR=n;$3(this,"PendingNonHtml5Upload")}return n},get_$2g4:function(){return this.$4bY},set_$2g4:function(n){if(this.$4bY!==n){this.$4bY=n;$3(this,"ShouldSizeBeHidden")}return n},get_$8OF:function(){return!1},get_$6Pa:function(){return!1},get_$6fJ:function(){return this.$3Sl},set_$6fJ:function(n){if(this.$3Sl!==n){this.$3Sl=n;$3(this,"ShowEditPermissionsInCompose")}return n},get_$5TR:function(){return this.$xU},set_$5TR:function(n){if(this.$xU!==n){this.$xU=n;$3(this,"FileExtension")}return n},get_$4dq:function(){return this.$2Cw},set_$4dq:function(n){this.$2Cw=n;$3(this,"SubmitUploadFormCommand");return n},get_$A4w:function(){return this.$3Ub},set_$A4w:function(n){this.$3Ub=n;$3(this,"SubmitUploadAndShareFormCommand");return n},get_$IA:function(){throw Error.notImplemented("This getter must be overridden");},set_$IA:function(n){throw Error.notImplemented("This setter must be overriden");return n},get_$D3:function(){this.$1v||(this.$1v=new _y.$4p);return this.$1v},set_$D3:function(n){this.$1v=n;return n},get_$1Nj:function(){return this.$Jm},get_$3wX:function(){return this.$14P},set_$3wX:function(n){this.$14P=n;_js.Trace.logWarning(_at.$1I.$A,"Attachment form upload error: {0}",this.$14P);$3(this,"FormUploadError");return n},get_$3wW:function(){return this.$1Oe},set_$3wW:function(n){this.$1Oe=n;_js.Trace.logWarning(_at.$1I.$A,"Attachment form upload error code: {0}",this.$1Oe);$3(this,"FormUploadAttachmentError");return n},get_$3XV:function(){return this.$2EJ},set_$3XV:function(n){this.$2EJ=n;$3(this,"UploadSuccessResponse");return n},get_$6HC:function(){return!1},get_$6OQ:function(){return this.$FW},get_$2Hw:function(){return this.$U9},get_$YC:function(){return this.$Ub},set_$YC:function(n){this.$Ub=n;return n},get_$nM:function(){var n=_y.$8u.$2zd(this.$1B.get_$3l(),this.$A0,_g.$5q.get_$5eI());_js.Trace.logInfo(_at.$1I.$A,"Image preview URL: {0}",n);return n},get_$au:function(){return this.$1A.get_$rx()},get_$44D:function(){return this.$1A.get_$1E8()},get_$1zt:function(){return this.get_$Bq()!==2&&this.get_$Bq()!==1||this.$1B.get_$6K()?!1:this.$Gv.$mF===3},get_$44i:function(){return this.get_$Bq()!==2?!1:this.$Gv.$mF===3},get_$8Cy:function(){return this.get_$Bq()!==2&&this.get_$Bq()!==4},get_$8D0:function(){return!this.$1B.get_$IU()&&(this.get_$Bq()===2||this.get_$Bq()===1)},get_$41o:function(){if(this.$32s)return this.$32s;var n;n=this.get_$36U()?this.get_$Bq()===5||this.$B.get_$L()!=="TouchNarrow"&&(!this.$A0||this.$A0&&this.get_$Bq()!==3):this.get_$Bq()===5||this.$B.get_$L()==="Mouse"&&this.get_$Bq()!==3;_js.Trace.logInfo(_at.$1I.$A,"IconLinkViewModel preview = {0}",n);this.$32s=_at.$CL.$E(this,n,this.$B);return this.$32s},get_$A7A:function(){if(this.$1oC)return this.$1oC;if(this.$B.get_$L()!=="Mouse"){this.$1oC=_at.$CL.get_$5cq();return this.$1oC}var t=!1;var n=!1;if(this.$1B.get_$IU()){n=_g.$8L.isInstanceOfType(this.$1B);t=_g.$8L.isInstanceOfType(this.$1B)}else switch(this.get_$Bq()){case 3:n=!1;t=this.get_$5i7()?!1:!this.$A0;break;case 6:n=!1;t=!1;break;case 1:case 2:t=!1;n=!1;break;case 5:case 4:n=!0;break;case 0:default:n=!0;break}if(n){_js.Trace.logInfo(_at.$1I.$A,"TextLinkViewModel is hidden");this.$1oC=_at.$CL.get_$5cq()}else{_js.Trace.logInfo(_at.$1I.$A,"TextLinkViewModel preview = {0}",t);this.$1oC=_at.$CL.$E(this,t,this.$B)}return this.$1oC},get_$2Jy:function(){if(!this.$DU){var n=new Array(0);this.$DU=new _0365m.$2c(n)}return this.$DU},set_$2Jy:function(n){this.$DU=n;$3(this,"ContextMenu");return n},get_$fS:function(){return this.$B.get_$L()!=="Mouse"},get_$4o:function(){var n=this.get_$Bq();switch(n){case 4:return _nbs.NonBootStrings.l_BlockedContent_Text;case 1:case 2:return _nbs.NonBootStrings.l_ClickForPreview_Text;case 6:case 3:return this.$1B.get_$1N();case 5:return _nbs.NonBootStrings.l_ClickForPreview_Text;default:break}return""},get_$34v:function(){return this.$2Rn},set_$34v:function(n){if(this.$2Rn!==n){this.$2Rn=n;this.$2EH()}return n},get_$15M:function(){return this.$Om},set_$15M:function(n){if(this.$Om!==n){this.$Om=n;$3(this,"IsDeleted")}return n},get_$1bn:function(){_a.$3.$9t(this.get_$Bq()===5,"Invalid Operation: EmbeddedItemClass should only be invoked when the Attachment is an ItemAttachment");return this.$1B.get_$Bq()},get_$5i7:function(){return!!this.$1H&&(this.$1H.$3N("DocCollab")||this.$1H.$3N("ModernAttachments"))},get_$8KW:function(){return!!this.$1H&&this.$1H.$3N("AttachmentsFilePicker")},get_$36U:function(){return this.get_$5i7()&&this.$B.get_$L()!=="TouchNarrow"&&(this.$Gv.$1p8||this.get_$Bq()===1||this.get_$Bq()===2)},get_$7bx:function(){return this.$1s5},set_$7bx:function(n){if(this.$1s5!==n){this.$1s5=n;$3(this,"AttachmentPreviewViewModel")}return n},get_$gD:function(){return this.$ng},set_$gD:function(n){this.$ng=n;n&&this.set_$27t(!1);return n},get_$8J6:function(){return!this.$6O},get_$7fO:function(){_js.Trace.logInfo(_at.$1I.$A,"Attachment class: {0}",this.$12Q);var n;switch(this.get_$Bq()){case 0:n=!0;break;case 5:_js.Trace.logInfo(_at.$1I.$A,"Embedded item class: {0}",this.get_$1bn());switch(this.get_$1bn()){case 6:case 3:case 1:case 2:case 5:case 7:n=!0;break;default:n=!1;break}break;default:n=!1;break}_js.Trace.logInfo(_at.$1I.$A,"Can open: {0}",n);return n},$2EH:function(){this.$6O?this.set_$SG(this.$2Rn||this.$1B.get_$6K()&&this.$6O.get_$8EC()):this.set_$SG(this.$2Rn||this.$1B.get_$6K());this.set_$SG(this.$by||this.$1B.get_$yi())},$9Qt:function(){_js.Trace.logInfo(_at.$1I.$A,"File selected.");this.set_$34v(!1);this.$6O&&this.$6O.$9Qs(this)},$1XF:function(){_js.Trace.logInfo(_at.$1I.$A,"submitting upload to server");this.$FW=!1;if(_g.$5d.isInstanceOfType(this.$1B)){var n=this.$1B;this.$6o3(n)}else(_g.$8z.isInstanceOfType(this.$1B)||_g.$8L.isInstanceOfType(this.$1B)||_g.$9w.isInstanceOfType(this.$1B))&&$4lJ(this)},$4dp:function(){_js.Trace.logInfo(_at.$1I.$A,"submitting delete to server");this.$FW=!1;var n=new _at.$15K(2,this.$1B,this.$6O.get_$9s());n.add_$21(this.$$d_$7qp);n.add_$2t(this.$$d_$5Oc);OwaApplication.$1W.$11(n)},$3xu:function(){var r=this.$1B;var u=r.$Ft;var n=this.$3vQ.$3oe();var t=this;n.set_$6L0(function(){if(n.get_$EB())_js.Trace.logWarning(_at.$1I.$A,"HTML5 file reader attach failed with error code {0}",n.get_$EB());else{var i=n.get_$hJ().indexOf(",");var r=n.get_$hJ().substring(i+1,n.get_$hJ().length);t.$14C=n.get_$hJ().substring(0,i).indexOf("base64")!==-1?r:_a.$9R.$Ew(r);$Cq(t,"OnUploadCompleteEvent",t)}});try{n.$6Un(u)}catch(i){this.$1A.get_$rx()&&i.name==="NS_ERROR_FILE_ACCESS_DENIED"?_js.Trace.logInfo(_at.$1I.$A,"Firefox: failed to read an attachment. Exception: {0}",i.message):_js.Trace.logException(_at.$1I.$A,i,"Unexpected exception was thrown by FileReader.ReadAsDataURL.")}},$4Ur:function(){this.$14C=null;$Cq(this,"OnDeleteCompleteEvent",this)},$2Kx:function(){var n=new _a.$6I;n.$6w("E",this.$xU);n.$5I("S",this.$1B.get_$50());return n.toString()},$13p:function(){_js.Trace.logInfo(_at.$1I.$A,"Getting attachment content from server");this.$FW=!1;var n=new _at.$MJ(_at.$1I.$A,this.$1B);var t=this;n.add_$2t(function(){$Cq(t,"OnDownloadCompleteEvent",t);t.set_$27t(!1)});var i=this;n.add_$21(function(){_js.Trace.logWarning(_at.$1I.$A,"Download failed with error: {0}",n.$1d.message);i.$FW=!0;i.$ng||i.$2tj(n)});OwaApplication.$1W.$11(n)},$5gA:function(n){if(_g.$8z.isInstanceOfType(this.$1B)||_g.$8L.isInstanceOfType(this.$1B)){_js.Trace.logInfo(_at.$1I.$A,"Uploading item or id attachment.");$6sR(this)}else if(_g.$5d.isInstanceOfType(this.$1B)){var t=this.$1B;if(this.$14C){_js.Trace.logInfo(_at.$1I.$A,"Uploading file attachment with pasted image from clipboard.");this.$4Zs(this.$14C)}else if(t.get_$CZ()){_js.Trace.logInfo(_at.$1I.$A,"Uploading file attachment with content.");this.$4Zs(null)}else if(this.$1A.get_$2q8()){_js.Trace.logInfo(_at.$1I.$A,"Uploading HTML5 file attachment.");$4lM(this,t.$Ft)}else{_js.Trace.logInfo(_at.$1I.$A,"Uploading Non-HTML5 file attachment.");this.$AEG()}}else if(this.$1A.get_$2q8()&&_g.$9w.isInstanceOfType(this.$1B)){var i=this.$1B;_js.Trace.logInfo(_at.$1I.$A,"Uploading HTML5 reference attachment.");$4lM(this,i.$Ft)}else{_js.Trace.logError(_at.$1I.$A,"Unsupported upload type.");n(null)}},$3x5:function(){var n=0;if(_g.$5d.isInstanceOfType(this.$1B))if(this.$Gv.get_$37y())n=3;else if(this.$Gv.$mF===1)n=4;else{var t,i;(i=_y.$8u.$4bS(this.$1B,t={val:n}),n=t.val,i)||(n=6)}else n=_g.$8L.isInstanceOfType(this.$1B)?5:_g.$8z.isInstanceOfType(this.$1B)?0:4;return n},$3X9:function(){var n=!!this.$1B.get_$3l();var t=n?this.$1B.get_$3l().Id:null;var i=t?_bc.$Bi.$5ha(t):!1;var r=this.$Gv.$mF===1;_js.Trace.logInfo(_at.$1I.$A,"UpdateDownloadUrl: idExists={0}, isClientId={1}, isDiscovery={2}, policyInfo: {3}",n,i,this.$A0,this.$Gv.toString());!n||r||i||this.$1B.get_$sG()?this.set_$3t3(null):this.set_$3t3(_y.$8u.$2zd(this.$1B.get_$3l(),this.$A0))},$2tj:function(n){$1XX(this,1,_at.$87.$2zv(n),!0)},$5Kb:function(n){$2jx(this,n)},$6nX:function(){this.set_$6QM(!this.$53&&this.$1A.get_$5DD()&&$5(this.$1B.get_$3l())&&!_g.$8z.isInstanceOfType(this.$1B))},$5DF:function(n,t){if(t==="ContentType"||t==="Name"||t==="AttachmentId"){t==="Name"&&this.set_$5TR(_a.$7R.$Y0(this.$1B.get_$1N()));if(t==="ContentType"||t==="Name"){this.set_$6Rl(_at.$5t.get_$I().$30X(this.$xU,this.$1B.get_$Bw(),this.$B.get_$L()==="Mouse"||this.$1A.get_$1fJ()));this.$2EH()}if(t==="AttachmentId"){$4lI(this,this.$1B.get_$3l());this.$6nX()}this.$3X9()}},$4Zs:function(n){var t=this.$1B;n&&t.set_$CZ(n);$6sO(this,t)},$AEG:function(){this.$2Cw.$s()},$7kJ:function(){_js.$8.$a(this.$14P)||$1XX(this,this.$1Oe,this.$14P,!1);$2jx(this,null)},$6o3:function(n){$4lJ(this)},$5Og:function(n){_js.Trace.logInfo(_at.$1I.$A,"Not a PAL file attachment.")},$4QX:function(){_js.Trace.logInfo(_at.$1I.$A,"Opening attachment with download URL {0}",this.$OY);this.$53?this.$cG.$4Qe(this.$OY,"_self"):this.$cG.$4Qe(this.$OY,"_blank")},$6Hb:function(n,t){this.$8p=t;_js.Trace.logInfo(_at.$1I.$A,"Attachment ID: {0}",this.$8p?this.$8p.Id:"null")},$9eK:function(){this.$6O.$9eO(this)},$1b6:function(){_js.Trace.logInfo(_at.$1I.$A,"Deleting attachment.");this.$1Cc=_a.$6.$1X(_a.$0.$1P,"AttachmentDeleteAttachment",!0);this.set_$15M(!0);var n=!!this.$1B.get_$3l()&&!!this.$1B.get_$3l().Id&&!this.$1B.get_$3l().Id.startsWith("smime-");if(n){_js.Trace.logInfo(_at.$1I.$A,"Deleting attachment from server.");this.$6O.$18c(this,!1);this.$6O.$18L(this)}else if(this.$4ia)_js.Trace.logError(_at.$1I.$A,"Somehow a user was able to try to delete an attachment in the process of being uploaded.");else{if(_g.$5d.isInstanceOfType(this.$1B)){var t=this.$1B;this.$5Og(t)}else _js.Trace.logInfo(_at.$1I.$A,"Not a file attachment.");this.$6O.$18c(this,!0);_a.$6.$19(this.$1Cc,null,"",null,$3Z2(this,!1));this.$1Cc=null}_at.$Dp.$A95(this.$1B.get_$50(),!n)},$AEH:function(n,t,i){this.set_$6o4(!0);if(this.$Om){_js.Trace.logInfo(_at.$1I.$A,"Attachment skipped because it's been deleted while it was pending.",this.$1B.get_$1N());t(null);return}var u=n;var r=u.Body.ParentItemId;this.$6O.get_$9s().Id=r.Id;this.$6O.get_$9s().ChangeKey=r.ChangeKey;this.$4Uq=t;this.$5gA(t)},$5TV:function(){$1XX(this,2,_at.$87.$83c(this.$5Mr),!1);$2jx(this,null)},$7qp:function(n){_js.Trace.logWarning(_at.$1I.$A,"delete failed with error: {0}",n.$1d.message);this.$FW=!0;this.set_$15M(!1);this.$6O.$379(this.$5H)&&!this.$ng&&this.$6O.$12A(this);if(this.$1Cc){_a.$6.$19(this.$1Cc,null,_at.$87.$2zv(n),n?n.$AJc():null,$3Z2(this,!0));this.$1Cc=null}},$5Oc:function(n){$Cq(this,"OnDeleteCompleteEvent",this);_at.$Dp.$A9D(this.$FW,this.$1B.get_$50(),this.$1B.get_$1N().length,this.$1B.get_$Bw());if(this.$1Cc){_a.$6.$19(this.$1Cc,null,"",n?n.$AJc():null,$3Z2(this,!0));this.$1Cc=null}},$9x5:function(){_y.$98.$3SN=this.$B.get_$L()==="Mouse"&&this.$B.get_$9l()&&!this.get_$8OF();this.$2D&&this.$6O&&this.$6O.get_$9s()&&this.$2D.$3Ka(this.$6O.get_$9s())},$TS:function(){(this.$53||this.$1B.get_$3l())&&(this.get_$36U()&&(this.$53||this.$B.get_$L()==="Mouse")?this.$6O5():this.$2wq())},$2wq:function(){if(this.$1B.get_$3l())if(_g.$8L.isInstanceOfType(this.$1B))this.$3Ke();else if(_g.$5d.isInstanceOfType(this.$1B))$3Z3(this);else if(_g.$8z.isInstanceOfType(this.$1B)){var n=this.$1B;n.get_$i()?this.$3Ke():n.get_$LU()?this.$3Ke():$3Z3(this)}else $3Z3(this);_at.$Dp.$6lJ(this.$1B.get_$50(),this.$Gv.$mF,this.$53,!1,!1)},$3Ke:function(){if(!this.get_$7fO()){_js.Trace.logInfo(_at.$1I.$A,"Unsupported item.");$11x(this,_nbs.NonBootStrings.l_ItemAttachmentNotSupported_Text);return}var t=this.$1B.get_$3l().Id;var n=null;_g.$8L.isInstanceOfType(this.$1B)?n=this.$1B.get_$JM():_g.$8z.isInstanceOfType(this.$1B)&&(n=this.$1B.get_$JM());this.$1B.get_$sG()&&_a.$j.$7dt(t,[this.$1B.get_$B4().DateTimeReceived,n]);var i={};i.AttachmentItemID=t;_js.Trace.logInfo(_at.$1I.$A,"Opening item attachment in pop-out window.");this.$B.$6E(_y.$qt,null,i,_y.$48.get_$T4())},$6O5:function(){if(this.$1s5){this.$1s5.$N5();return}if(this.$12R){var n=this;this.$12R.$E(function(t){if(!n.$6O){_js.Trace.logError(_a.$0.$1P,"OpenDocumentInBrowser: Parent well is null.");return}n.set_$7bx(t.$E(n,n.$6O.get_$5DK()));n.$1s5.$N5()})}_at.$Dp.$6lJ(this.$1B.get_$50(),this.$Gv.$mF,this.$53,!0,this.$Gv.$1p8)}};_at.$P6=function(n,t,i,r,u,f,e,o,s,h){this.$AFQ=_at.$1I;_a.$3.$K(t,"owaShell");_a.$3.$K(i,"palDownloadManager");_a.$3.$K(r,"userAgent");_a.$3.$K(u,"nativeBridge");_a.$3.$K(s,"itemStoreGetterFactory");this.$2D=n;this.$B=t;this.$bd=i;this.$1A=r;this.$c=u;this.$2I0=f;this.$1H=e;this.$12R=o;this.$21v=s;this.$4ic=h};function $4lN(n,t,i,r,u,f,e,o){var s=this;n.$3oO(t[i],u,f,e,function(s){Array.add(r,s);i<t.length-1?$4lN(n,t,i+1,r,u,f,e,o):o(r)})}function $4lO(n){return n.$1H?n.$1H.$3N("AttachmentsFilePicker"):!1}_at.$P6.prototype={$B:null,$1A:null,$bd:null,$c:null,$1H:null,$12R:null,$21v:null,$2D:null,$2I0:null,$2qB:null,$AFQ:null,$4ic:null,$E:function(n,t,i,r){if($4lO(this)&&(_g.$9w.isInstanceOfType(n)||_g.$5d.isInstanceOfType(n)&&_y.$UC.isInstanceOfType(n.$Ft))){if(!this.$2qB&&this.$2I0){var u=this;this.$2I0.$E(function(n){u.$2qB=n})}_a.$3.$m(this.$2qB,"attachmentProviderItemViewModelFactory");return this.$2qB.$E(n,this.$B,t,i,r,this.$1A)}else if(_g.$5d.isInstanceOfType(n)&&_y.$ky.isInstanceOfType(n.$Ft)){_a.$3.$m(this.$4ic,"uriFileAttachmentViewModelFactory");return this.$4ic.$E(n,this.$B,t,i,r,this.$1A)}else return new _at.$5x(n,this.$B,t,i,r,this.$bd,this.$2D,this.$c,this.$1A,this.$1H,this.$12R,this.$21v)},$3oO:function(n,t,i,r,u){if($4lO(this)&&this.$2I0&&(_g.$9w.isInstanceOfType(n)||_g.$5d.isInstanceOfType(n)&&_y.$UC.isInstanceOfType(n.$Ft))){var f=this;var e=function(e){var o=e.$E(n,f.$B,t,i,r,f.$1A);u(o)};this.$2I0.$E(e)}else{var o=new _at.$5x(n,this.$B,t,i,r,this.$bd,this.$2D,this.$c,this.$1A,this.$1H,this.$12R,this.$21v);u(o)}},$7kG:function(n,t,i,r,u){if(!n){u(null);return}if(!n.length){u(new Array(0));return}$4lN(this,n,0,new Array(0),t,i,r,u)}};_at.$87=function(){};_at.$87.$2zv=function(n){var t;if(n){if(_h.$qT.isInstanceOfType(n)&&(t=n.get_$1LO())){if(t.responseCode)return t.responseCode;if(t.response){if(t.response.fault){var r=t.response.fault;var i=_at.$87.$5XR(r);if(i)return i}if(t.response.statusCode)return _at.$87.$3wS(t.response.statusCode)}}if(n.$1d)return _at.$87.$2OF(n.$1d)}return"UnknownError"};_at.$87.$2OF=function(n){if(n){var t;if(t=n.responseCode)return t.toString();if(t=n.StackTrace)return _at.$87.$5XS(t.toString());if(t=n.ErrorCode)return _at.$87.$3wS(t);if(t=n.name){var i=t.toString();if(i!=="Error")return i;else if(n.message)return n.message}}return"UnknownError"};_at.$87.$5XR=function(n){if(n){if(n.ResponseCode)return n.ResponseCode.toString();if(n.StackTrace)return _at.$87.$5XS(n.StackTrace);if(n.ErrorCode)return _at.$87.$3wS(n.ErrorCode)}return null};_at.$87.$5XS=function(n){var t;var i;if((t=n.indexOf(":"))!==-1||(t=n.indexOf("\n"))!==-1){i=n.substr(0,t);if((t=n.indexOf("\n"))!==-1){var u=new RegExp("[_a-zA-Z0-9.]+\\(");var r=u.exec(n.substr(t));r&&(i=i+"@"+r[0].substr(0,r[0].length-1))}}else i=n;return i};_at.$87.$3wS=function(n){return"HTTP_"+n};_at.$87.$83c=function(n){var t=n.get_$EB();if(t){var i;i=Number.isInstanceOfType(t)?t:t.code;return i>=1&&i<_at.$87.$3vP.length?_at.$87.$3vP[i]:_at.$87.$2OF(t)}return n.get_$1w4()?_at.$87.$2OF(n.get_$1w4()):"UnknownError"};_at.$HZ=function(n,t,i,r,u,f,e,o,s,h,c){this.$$d_$7kI=Function.createDelegate(this,this.$7kI);this.$$d_$7kL=Function.createDelegate(this,this.$7kL);this.$$d_$7bc=Function.createDelegate(this,this.$7bc);_at.$HZ.initializeBase(this,[n,t,i,r,u,s,f,h,c]);this.$EM=e;this.$k=o};function $2jy(n){var t=_g.$1Y.$N2;t?t.$9mO(n.get_$IA(),n.$$d_$7bc,n.get_$CG()):n.$EM.$1IW(n.get_$IA(),_a.$0.$5l,n.get_$CG(),n.$$d_$7bc,0)}function $4lR(n,t){var u=null;if(t&&t.ResponseMessages&&t.ResponseMessages.Items&&t.ResponseMessages.Items.length)if(t.ResponseMessages.Items[0].ResponseCode!=="NoError")u="ResponseMessages response code = "+t.ResponseMessages.Items[0].ResponseCode;else{var i=t.ResponseMessages.Items[0];n.$1B.set_$50(i.Attachments[0].Size);_at.$BP.$6TQ(i,n.$1B,n.$6O.get_$9s());if(_g.$9w.isInstanceOfType(n.$1B)&&i.Attachments.length>=1&&i.ResponseCode==="NoError"){var r=i.Attachments[0];if(r.AttachLongPathName){n.$1B.set_$1B3(r.AttachLongPathName);n.$1B.set_$4Uk(r.ProviderType);n.$1B.set_$4Uj(r.ProviderEndpointUrl)}n.$1B.set_$1N(r.Name)}}else u="The response message received is null";return u}_at.$HZ.prototype={$k:null,$EM:null,$6ma:function(){var n=_g.$1Y.$N2;n?n.$AAn(this.get_$IA(),this.$$d_$7bc):this.$EM.$1oo(this.get_$IA(),this.$$d_$7bc)},$5Kb:function(n){this.$6ma();_at.$1I.prototype.$5Kb.call(this,n)},$6nX:function(){this.set_$6QM(!1)},$7kL:function(n){},$7kI:function(n){this.$2tj(n);this.$5Kb(null)},$7bc:function(n){var t=null;var i=n;t=n?$4lR(this,i.Response):"The notification received is null";if(t){i&&(t+=". AttachmentProviderResultCode = "+i.ResultCode);$1XX(this,1,t,!0)}else this.$9k8(i);this.$5Kb(null)},$9k8:function(n){}};_at.$uX=function(n,t,i,r,u,f,e,o,s,h,c){_at.$uX.initializeBase(this,[n,t,i,r,u,f,e,o,s,h,c])};_at.$uX.$2O1=function(){return"UriFileAttachmentNotification"+(_a.$7.get_$2F().$5X()+_a.$8t.$3NW(0,1e3)).toString()};_at.$uX.prototype={$CS:null,get_$IA:function(){this.$CS||(this.$CS=_at.$uX.$2O1());return this.$CS},set_$IA:function(n){this.$CS=n;return n},get_$CG:function(){return"UriFileAttachmentViewModel"},$5gA:function(n){if(_g.$5d.isInstanceOfType(this.$1B)&&_y.$ky.isInstanceOfType(this.$1B.$Ft)){_js.Trace.logInfo(_a.$0.$5l,"Uploading attachment from URL");var i=this.$1B.$Ft;$2jy(this);var t=new _at.$14m(this.$6O.get_$9s(),i.get_$AEN(),i.get_$1N(),this.get_$IA());t.add_$29(this.$$d_$7kL);t.add_$21(this.$$d_$7kI);this.$k.$11(t)}else{_js.Trace.logError(_a.$0.$5l,"Unsupported upload type detected in addFileAttachment");n(null)}}};_at.$12P=function(n,t,i,r,u,f){this.$EM=n;this.$k=t;this.$2D=i;this.$1H=r;this.$12R=u};_at.$12P.prototype={$EM:null,$k:null,$2D:null,$1H:null,$12R:null,$E:function(n,t,i,r,u,f){return new _at.$uX(n,t,i,r,u,f,this.$EM,this.$k,this.$2D,this.$1H,this.$12R)}};_at.$FT=function(n){this.$1z=n;this.$2Tm={};this.$1R0=new(_0365f.$n.$$(_at.$SA))};function $3Z5(n,t){_a.$3.$K(t,"parameter");_a.$3.$K(t.$8p,"AttachmentId")}function $1pi(n,t,i){}_at.$FT.prototype={$1z:null,$2Tm:null,$1R0:null,get_$C:function(){return this.$1R0.get_$C()},$76:function(n){_a.$3.$1G(n,"attachmentId");return n in this.$2Tm},$D:function(n){$3Z5(this,n);if(!this.$76(n.$8p)){$1pi(this,"FastLookupQueue. Adding {0}",n);this.$1R0.$D(n);this.$2Tm[n.$8p]=""}},$6r:function(n,t){$3Z5(this,t);if(!this.$76(t.$8p)){$1pi(this,"FastLookupQueue. InsertAt {0}",t);this.$1R0.$AGU(n,t);this.$2Tm[t.$8p]=""}},$7rf:function(){$1pi(this,"FastLookupQueue. DeQueue. Current count {0}",this.get_$C());if(this.get_$C()>0){var n=this.$1R0.get_$3o(0);this.$34(n);return n}else return null},$34:function(n){$3Z5(this,n);$1pi(this,"FastLookupQueue. Remove. Current count {0}",this.get_$C());if(this.$76(n.$8p)){$1pi(this,"FastLookupQueue. Remove. Found {0}",n);delete this.$2Tm[n.$8p];for(var i=-1,t=0;t<this.$1R0.get_$C();t++)if(this.$1R0.get_$3o(t).$8p===n.$8p){i=t;break}if(i!==-1){this.$1R0.$6C(i);$1pi(this,"FastLookupQueue. Returning from remove after removal. Current Count {0}",this.get_$C())}}}};_at.$BW=function(){};_at.$BW.$4QX=function(n,t,i,r,u,f,e){_a.$3.$K(n,"initNativeBridge");_a.$3.$K(t,"initClientStore");_a.$3.$K(i,"initAttachmentInfoRecord");_a.$3.$1G(r,"initMimeType");_a.$3.$1G(u,"fileName");_a.$3.$K(f,"initOnOpenAttachmentSuccess");_a.$3.$K(e,"initOnOpenAttachmentError");if(_at.$BW.$36T){_js.Trace.logInfo(_at.$BW.$A,"Already opening an attachment so returning.");return}_js.Trace.logInfo(_at.$BW.$A,"OpenAttachment with record DataID {0}, Size {1}, id {2}",i.AttachmentId,i.DataID,i.Size);_at.$BW.$36T=!0;n.get_$Hl().$9eD(i.DataID,r,u,function(n){_at.$BW.$9Wo(n,i,t,f,e)});t.$5WW(i.AttachmentId,function(n){},null)};_at.$BW.$83b=function(n){var t=null;switch(n){case 0:break;case 1:case 3:t=_nbs.NonBootStrings.l_UnableToFindActivity_Text;break;case 2:t=_nbs.NonBootStrings.l_DownloadAttachmentAgain_Text;break;default:break}_js.Trace.logInfo(_at.$BW.$A,"OpenPalAttachment error code {0}, string: {1}",n,t);return t};_at.$BW.$9Wo=function(n,t,i,r,u){_at.$BW.$36T=!1;var f=!0;switch(n){case 0:f=!1;break;case 1:case 3:break;case 2:i.$5OX(t.AttachmentId);break;default:break}if(f){_js.Trace.logWarning(_at.$BW.$A,"OnOpenDocument failed with errorCode {0}",n);u(n)}else{_js.Trace.logInfo(_at.$BW.$A,"OnOpenDocument succeeded");r()}};_at.$2u=function(n,t,i){this.$$d_$9Pr=Function.createDelegate(this,this.$9Pr);this.$$d_$9Vy=Function.createDelegate(this,this.$9Vy);this.$$d_$6Mn=Function.createDelegate(this,this.$6Mn);_a.$3.$K(n,"initNativeBridge");var r=t?t.get_$4dg():null;this.$c=n;this.$3mZ=i;this.$2v=n.get_$4Rf().$46Z(r);$4lV(this,t)};function $6sW(n,t){var i=null;switch(t){case 0:break;case 7:break;case 3:i=_nbs.NonBootStrings.l_SpeechInvalidCredentials_Text;break;case 8:break;case 1:case 4:var r=this,u=this;n.$3mZ.$7gg(n.$6j,n.$c,function(){_js.Trace.logInfo(_at.$2u.$A,"Successfully completed CleanAllPalAttachmentInfoAndAttachments")},function(n){_js.Trace.logWarning(_at.$2u.$A,"CleanAllPalAttachmentInfoAndAttachments failed due to error {0}",n)});i=_nbs.NonBootStrings.l_SpeechServerBusy_Text;break;case 5:i=_nbs.NonBootStrings.l_SpeechNoNetworkAction_Text;break;case 6:i=_nbs.NonBootStrings.l_SpeechServerBusy_Text;break;case 9:i=_nbs.NonBootStrings.l_UnableToDownload_Text;break;case 2:i=_nbs.NonBootStrings.l_UnknownDataIDType_Text;break;default:break}return i}function $4lV(n,t){if(n.$2v){n.$6j=t;n.$r6=new _at.$FT(_at.$2u.$A);n.$1vZ={};n.$12k=null;n.$J2=null;n.$2uO=0}}function $4lU(n){_js.Trace.logInfo(_at.$2u.$A,"CancelCurrentDownload, canceling the current download");n.$c.get_$oa().$7ez();n.$12k=n.$J2;n.$J2=null}function $2k0(n){_js.Trace.logInfo(_at.$2u.$A,"Inside StartDownloadInternal");if(n.$12k)_js.Trace.logInfo(_at.$2u.$A,"Still waiting for the canceled download to get canceled.");else if(n.$J2)_js.Trace.logInfo(_at.$2u.$A,"Still waiting for the current download to finish.");else{_js.Trace.logInfo(_at.$2u.$A,"StartDownloadInternal, pending items in queue {0}",n.$r6.get_$C());n.$J2=n.$r6.$7rf();n.$2uO=0;if(n.$J2){_js.Trace.logInfo(_at.$2u.$A,"Starting download {0}",n.$J2);$1Kq(n,n.$J2,3);var t=this;n.$3mZ.$A3s(n.$6j,n.$c,n.$$d_$6Mn,function(t){_js.Trace.logWarning(_at.$2u.$A,"Scheduled cleanup failed due to error {0}",t);n.$6Mn()})}else _js.Trace.logInfo(_at.$2u.$A,"Download queue is empty.")}}function $1Kq(n,t,i){var r=this;$2jz(n,t,function(n){n.$1jx(i)})}function $4lW(n,t,i){var r=this;$2jz(n,t,function(n){_js.Trace.logWarning(_at.$2u.$A,"Raising OnError event with error {0} for attachment {1}",i,t);n.$TR(i)})}function $2jz(n,t,i){var r=n.$1vZ[t.$8p];r&&i(r)}function $6sX(n,t){var i=null;if(_bc.$Bi.$5ha(t.$8p)){_js.Trace.logInfo(_at.$2u.$A,"The attachment is not uploaded to the server yet. {0}",t);i=_nbs.NonBootStrings.l_AttachmentOfflineViewingUnsupported_Text}else if(_js.$8.$a(t.$4Rq)){_js.Trace.logInfo(_at.$2u.$A,"Attachment is a quick message {0}",t);i=_nbs.NonBootStrings.l_AttachmentOfflineViewingUnsupported_Text}else if(_js.$8.$a(t.$1iU)){_js.Trace.logInfo(_at.$2u.$A,"Attachment does not have content type set. {0}",t);i=_nbs.NonBootStrings.l_UnknownDataIDType_Text}else if(_js.$8.$a(t.$xU)){_js.Trace.logInfo(_at.$2u.$A,"Attachment does not have a valid file name {0}.",t);i=_nbs.NonBootStrings.l_UnknownDataIDType_Text}else if(n.$r6.get_$C()===10){_js.Trace.logInfo(_at.$2u.$A,"download queue max size reached. Rejecting attachment with params {0}.",t);i=String.format(_nbs.NonBootStrings.l_DownloadAttachmentQueueMaxSizeReached_Text,10)}return i}function $6sV(n,t,i){if(n.$J2&&t===n.$J2.$8p){_js.Trace.logInfo(_at.$2u.$A,"FindStatusAndFireCallback. currently downloading attachment with id {0}",t);i.$1jx(3)}else if(n.$r6.$76(t)){_js.Trace.logInfo(_at.$2u.$A,"FindStatusAndFireCallback. Found in the queue. attachment with id {0}",t);i.$1jx(2)}else{var r=this,u=this;n.$6j.$6Y3(t,function(n){if(n){_js.Trace.logInfo(_at.$2u.$A,"FindStatusAndFireCallback Found the record in db {0} and AttachmentId {1}",n.DataID,n.AttachmentId);i.$1jx(4);i.$6Hc(n)}else{_js.Trace.logInfo(_at.$2u.$A,"FindStatusAndFireCallback. Did not find attachment with id {0} in the db.",t);i.$1jx(1)}},function(n){_js.Trace.logWarning(_at.$2u.$A,"FindStatusAndFireCallback. Got error {0} from DB while retreiving record with id {1}",n,t);i.$1jx(1)})}}_at.$2u.prototype={$2v:!1,$r6:null,$J2:null,$12k:null,$2uO:0,$1vZ:null,$c:null,$3mZ:null,$6j:null,get_$qY:function(){if(!this.$2v&&_g.$1Y.$w){var n=_bc.$YC.isInstanceOfType(_g.$1Y.$w)?_g.$1Y.$w:null;this.$2v=this.$c.get_$4Rf().$46Z(n?n.get_$5c():null);$4lV(this,n?n.get_$AU().get_$1Lx():null)}return this.$2v},$Hd:function(n,t){_a.$3.$1G(n,"attachmentId");_a.$3.$K(t,"callbacks");if(this.get_$qY()){this.$1vZ[n]=t;$6sV(this,n,t)}else _js.Trace.logInfo(_at.$2u.$A,"PAL does not support download.")},$1op:function(n){_a.$3.$1G(n,"attachmentId");this.get_$qY()&&n in this.$1vZ&&delete this.$1vZ[n]},$2wq:function(n){_a.$3.$K(n,"parameters");_a.$3.$K(n.$8p,"AttachmentId");_a.$3.$K(n.$OY,"DownloadUrl");_js.Trace.logInfo(_at.$2u.$A,"DownloadAttachment:Begin download Attachment for parameters {0}",n);if(this.get_$qY()){if(!(n.$8p in this.$1vZ))throw Error.invalidOperation("Subscribe must be called before calling DownloadAttachment.");var t=$6sX(this,n);if(_js.$8.$a(t)){if((!this.$J2||this.$J2.$8p!==n.$8p)&&!this.$r6.$76(n.$8p)){_js.Trace.logInfo(_at.$2u.$A,"Starting download for {0}",n);if(n.$5j0){this.$r6.$6r(0,n);if(this.$J2){$4lU(this);this.$r6.$6r(1,this.$12k);$1Kq(this,this.$12k,2)}else{$1Kq(this,n,2);$2k0(this)}}else{this.$r6.$D(n);$1Kq(this,n,2);$2k0(this)}}}else $4lW(this,n,t)}},$9J:function(n){_a.$3.$K(n,"parameters");_a.$3.$K(n.$8p,"AttachmentId");_js.Trace.logInfo(_at.$2u.$A,"Cancel download for parameters {0}",n);if(this.get_$qY())if(this.$r6.$76(n.$8p)){this.$r6.$34(n);_js.Trace.logInfo(_at.$2u.$A,"Found and removed from queue {0}. Pending Items in queue {1}",n,this.$r6.get_$C());$1Kq(this,n,1)}else if(this.$J2&&this.$J2.$8p===n.$8p){_js.Trace.logInfo(_at.$2u.$A,"Current Download was canceled. {0}",this.$J2);$4lU(this);$1Kq(this,this.$12k,1)}},$6Mn:function(){_js.Trace.logInfo(_at.$2u.$A,"Starting the download now for {0}",this.$J2);if(this.$12k){this.$12k=null;$2k0(this)}else this.$c.get_$oa().$7tm(this.$J2.$OY,1,this.$J2.$xU,this.$J2.$1iU,this.$$d_$9Vy,this.$$d_$9Pr)},$9Vy:function(n){if(this.$J2){this.$2uO+=n;var t=this;$2jz(this,this.$J2,function(n){n.$6Ir(t.$2uO)})}},$9Pr:function(n,t,i){_js.Trace.logInfo(_at.$2u.$A,"OnDownloadComplete with errorCode = {0} httpStatusCode = {1} dataID = {2} for attachment {3}",n,t,i,this.$J2);if(this.$12k)this.$12k=null;else if(n||t!==200){var f=$6sW(this,n);_js.$8.$a(f)||$4lW(this,this.$J2,f);$1Kq(this,this.$J2,1)}else{var r=this.$J2;var u=new AttachmentInfoRecord(this.$J2.$8p,i,this.$J2.$3j9,_a.$7.get_utcNow().$5X(),this.$J2.$4Rq,0,_a.$7.$5Vw(_a.$7.get_utcNow()),!0);var e=this,o=this;this.$6j.$6ZF(u,function(n){_js.Trace.logInfo(_at.$2u.$A,"Successfully saved attachment in DB with dataID {0} and parameters {1}",i,r)},function(n){_js.Trace.logWarning(_at.$2u.$A,"Unable to save the attachment in DB with parameters {0} error {1}",r,n)});$1Kq(this,r,4);var s=this;$2jz(this,r,function(n){_js.Trace.logInfo(_at.$2u.$A,"Raising OnAttachmentInfoRecordAvailable with record {0} for attachment {1}",u,r);n.$6Hc(u)})}this.$J2=null;$2k0(this)}};_at.$SA=function(){};_at.$SA.$7nD=function(n){_a.$3.$K(n,"viewModel");_a.$3.$K(n.$OY,"DownloadUrl should not be empty");var t=null;n.$6O&&n.$6O.get_$9s()&&(t=n.$6O.get_$9s().Id);return _at.$SA.$5Ln(n.$1B,n.$1B.get_$1N(),n.$1B.get_$Bw(),n.$OY,t,!1)};_at.$SA.$5Ln=function(n,t,i,r,u,f){_a.$3.$K(n,"attachment");_a.$3.$K(n.get_$3l(),"attachmentId");_a.$3.$K(r,"downloadUrl");_a.$3.$K(r,"destinationFileName");var e=new _at.$SA;e.$8p=n.get_$3l().Id;e.$3j9=n.get_$50();e.$1cD=t;e.$xU=_a.$7R.$Y0(e.$1cD);e.$1iU=i;e.$OY=_a.Uri.$3PC(r);e.$4Rq=u;e.$5j0=f;_js.$8.$a(e.$1iU)&&!_a.UserAgent.getInstance().$aq&&(e.$1iU="fakeMimeType");return e};_at.$SA.prototype={$1iU:null,$1cD:null,$xU:null,$8p:null,$4Rq:null,$OY:null,$3j9:0,$5j0:!1,toString:function(){return String.format("Attachment with Name {0} Size {1} ContentType {2} AttachmentId{3}",this.$1cD,this.$3j9,this.$1iU,this.$8p)}};_at.$5x=function(n,t,i,r,u,f,e,o,s,h,c,l){_at.$5x.initializeBase(this,[n,t,i,r,u,e,s,h,c]);_a.$3.$m(f,"palDownloadManager");_a.$3.$m(o,"nativeBridge");_a.$3.$m(l,"itemStoreGetter");this.$bd=f;this.$c=o;this.$21v=l;this.$1B&&$4lY(this,null,this.$1B.get_$3l())};function $6sY(n){_js.Trace.logInfo(_at.$5x.$A,"OpenAttachmentUsingPAL, download status={0}",n.$1kH);if(!n.$6O.$379(n.$5H)){_js.Trace.logWarning(_at.$5x.$A,"The context has changed from "+n.$5H+" to "+n.$6O.get_$md()+", opening attachment using PAL has been skipped.");return}if(n.$6O.get_$44M()||!n.$53){_js.Trace.logInfo(_at.$5x.$A,"Returning because the attachment is a fake message. IsComposeReadOnlyWell = {0} and IsReadOnly {1}",n.$6O.get_$44M(),n.$53);return}var t=_at.$SA.$7nD(n);_js.Trace.logInfo(_at.$5x.$A,"PAL attachment download parameters: {0}",t.toString());switch(n.$1kH){case 0:case 1:n.$6Ir(0);_js.Trace.logInfo(_at.$5x.$A,"Starting PAL attachment download.");n.$bd.$2wq(t);break;case 3:case 2:_js.Trace.logInfo(_at.$5x.$A,"Canceling PAL attachment download.");n.$bd.$9J(t);break;case 4:_js.Trace.logInfo(_at.$5x.$A,"PAL attachment download complete.");var i=this;n.$21v.$E(function(){var i=n.$21v.get_$1n().$E(_g.$V.get_$I().get_$13().get_$E6());_at.$BW.$4QX(n.$c,i.get_$1Lx(),n.$5DB,t.$1iU,t.$1cD,function(){_js.Trace.logInfo(_at.$5x.$A,"Attachment opened successfully.")},function(t){_js.Trace.logWarning(_at.$5x.$A,"Attachment open failed with errorCode {0}",t);t===2&&n.set_$4Rd(1);var i=_at.$BW.$83b(t);$11x(n,i)})});break;default:break}}function $4lY(n,t,i){if(n.$bd)if(_g.$8L.isInstanceOfType(n.$1B)){_js.Trace.logInfo(_at.$5x.$A,"ItemAttachment for PAL status:Downloaded");n.set_$4Rd(4)}else if(n.$bd.get_$qY()){!$5(t)&&t.Id&&n.$bd.$1op(t.Id);!$5(i)&&i.Id&&n.$bd.$Hd(i.Id,n)}}function $6sZ(n){if(n.$bd.get_$qY()&&n.$1B&&n.$1B.get_$3l()&&!_g.$8L.isInstanceOfType(n.$1B)){_js.Trace.logInfo(_at.$5x.$A,"Unsubscribing for attachment with name {0} and id {1}",n.$1B.get_$1N(),n.$1B.get_$3l());n.$bd.$1op(n.$1B.get_$3l().Id)}}function $4lX(n,t,i){var r;var u=t;if(t>=1073741824){u/=1073741824;r=_u.Strings.l_SizeWithGigabyteAbbreviation_Text}else if(t>=1048576){u/=1048576;r=_u.Strings.l_SizeWithMegabyteAbbreviation_Text}else if(t>=1024){u/=1024;r=_u.Strings.l_SizeWithKilobyteAbbreviation_Text}else r=_u.Strings.l_SizeWithByteAbbreviation_Text;return String.format(r,Math.round(u*Math.pow(10,i))/Math.pow(10,i))}function $6sa(n){_js.Trace.logInfo(_at.$5x.$A,"Submitting action for PAL attachment upload.");var t=new _at.$14o(2,n.$1B,n.$6O.get_$9s());t.add_$21(n.$$d_$2tj);t.add_$2t(n.$$d_$5Kb);OwaApplication.$1W.$11(t)}_at.$5x.prototype={$c:null,$bd:null,$21v:null,$5DB:null,$1kH:0,$2bP:null,get_$4Rd:function(){return this.$1kH},set_$4Rd:function(n){this.$1kH=n;$3(this,"PALAttachmentDownloadStatus");return n},get_$9fR:function(){return this.$2bP},set_$9fR:function(n){this.$2bP=n;$3(this,"PALAttachmentCurrentDowloadedBytes");return n},get_$6HC:function(){return _at.$1I.prototype.get_$6HC.call(this)||_g.$5d.isInstanceOfType(this.$1B)&&_a.$YE.isInstanceOfType(this.$1B.$Ft)},get_$36U:function(){var n=_at.$1I.prototype.get_$36U.call(this);if(n&&this.$c.$5i(this.$c.get_$Hl())){var t=this.$c.get_$Hl().get_$1Nv().$2a(2);_js.Trace.logInfo(_at.$5x.$A,"SetOneTimeAllowedUrlSupported is {0}",t);n=!!(n&t)}return n},get_$6Pa:function(){return this.$1A.get_$6n()&&this.$53},get_$4bE:function(){return this.get_$36U()?!1:this.$bd.get_$qY()},get_$l2:function(){return!this.$Gv.$13Z||this.$bd.get_$qY()||this.$Gv.$2Ni||this.$1B.get_$IU()?!0:!1},$4hv:function(){$6sZ(this)},$1jx:function(n){_js.Trace.logInfo(_at.$5x.$A,"Got attachment status {0}",n);this.set_$4Rd(n)},$6Ir:function(n){this.set_$9fR(String.format(_nbs.NonBootStrings.l_DownloadAttachmentProgress_Text,$4lX(this,n,1),$4lX(this,this.$1B.get_$50(),0)))},$TR:function(n){_js.Trace.logWarning(_at.$5x.$A,"Unable to download attachment with name {0} and error is {1}",this.$1B.get_$1N(),n);$11x(this,n)},$6Hc:function(n){_js.Trace.logInfo(_at.$5x.$A,"Found/Saved the record in offline db {0} {1}",n.DataID,n.AttachmentId);this.$5DB=n},$6o3:function(n){_a.$YE.isInstanceOfType(n.$Ft)?$6sa(this):_at.$1I.prototype.$6o3.call(this,n)},$5Og:function(n){if(_a.$YE.isInstanceOfType(n.$Ft)){_js.Trace.logInfo(_at.$5x.$A,"Deleting file attachment via PAL.");var t=n.$Ft;this.$c.get_$1r().$13V(t.get_$1CP())}else _at.$1I.prototype.$5Og.call(this,n)},$4QX:function(){if(this.$bd.get_$qY()){_js.Trace.logInfo(_at.$5x.$A,"Will use PAL to open attachment.");$6sY(this)}else _at.$1I.prototype.$4QX.call(this)},$6Hb:function(n,t){$4lY(this,n,t);_at.$1I.prototype.$6Hb.call(this,n,t)}};_at.$1EB=function(){};_at.$1EB.prototype={get_$qY:function(){return!1},$Hd:function(n,t){throw Error.invalidOperation("This method is not implemented for BOWA.");},$1op:function(n){throw Error.invalidOperation("This method is not implemented for BOWA.");},$2wq:function(n){throw Error.invalidOperation("This method is not implemented for BOWA.");},$9J:function(n){throw Error.invalidOperation("This method is not implemented for BOWA.");}};var IWellKnownFileTypes=function(){};IWellKnownFileTypes.registerInterface("IWellKnownFileTypes");_at.$ns=function(){};_at.$ns.prototype={$2x:function(n,t){return String.format(_nbs.NonBootStrings.l_AttachmentParenthesisFormat_Text,n)},$5Jw:function(n,t){throw Error.notImplemented();}};_at.$15r=function(){};_at.$15r.prototype={};_at.$15r.registerEnum("_at.$15r",!1);_at.$135=function(){};_at.$135.prototype={$2x:function(n,t){var i=n;var r=_js.$1i.$or(_a.$WD,t.toString());return i!==r},$5Jw:function(n,t){throw Error.notImplemented();}};_at.$oD=function(){};_at.$oD.prototype={$2x:function(n,t){var i=n;return!i||!i.$1B?"":i.get_$Bq()!==1&&i.get_$Bq()!==2?"":_js.$8.$a(i.$1B.get_$3VQ())?i.get_$nM():"data:"+i.$1B.get_$6k7()+";base64,"+i.$1B.get_$3VQ()},$5Jw:function(n,t){throw Error.notImplemented();}};_at.$sS=function(){};_at.$sS.prototype={$2x:function(n,t){var i=n;var r=!0;try{var u=_js.$1i.$or(_at.$15r,t.toString());switch(u){case 1:i&&i!==1||(r=!1);break;case 2:i&&i!==1&&i!==4||(r=!1);break;case 3:i===3&&(r=!1);break;case 4:(i===3||i===2)&&(r=!1);break;case 5:i===2&&(r=!1);break;case 6:i!==1&&i||(r=!1);break}}catch(f){r=!0}return r},$5Jw:function(n,t){throw Error.notImplemented();}};_at.$14m.registerClass("_at.$14m",_h.$FG.$$(String));AttachmentsComponent.registerClass("AttachmentsComponent",null,_a.$1L9);_at.$3h.registerClass("_at.$3h",_b.$JE);_at.$5t.registerClass("_at.$5t");_at.$13G.registerClass("_at.$13G");_at.$wx.registerClass("_at.$wx",null,_at.$1IA);_at.$wy.registerClass("_at.$wy");_at.$BP.registerClass("_at.$BP",_h.$Jk.$$(_g.$Ta,_g.$aX));_at.$14o.registerClass("_at.$14o",_at.$BP);_at.$15K.registerClass("_at.$15K",_h.$Jk.$$(_g.$Td,_g.$bo));_at.$cq.registerClass("_at.$cq",_h.$Jk.$$(_g.$XG,_g.$aX));_at.$MJ.registerClass("_at.$MJ",_h.$FG.$$(String));_at.$13E.registerClass("_at.$13E",_a.$R);_at.$13E.prototype.$9S=_a.$R.prototype.$9S;_at.$CL.registerClass("_at.$CL");_at.$13F.registerClass("_at.$13F",_a.$R);_at.$13F.prototype.$9S=_a.$R.prototype.$9S;_at.$13H.registerClass("_at.$13H",_a.$R);_at.$13H.prototype.$9S=_a.$R.prototype.$9S;_at.$13J.registerClass("_at.$13J",_a.$R);_at.$13J.prototype.$9S=_a.$R.prototype.$9S;_at.$Dp.registerClass("_at.$Dp");_at.$13M.registerClass("_at.$13M",_a.$R);_at.$13M.prototype.$9S=_a.$R.prototype.$9S;_at.$1I.registerClass("_at.$1I",_a.$FF,_y.$du,_js.$yO);_at.$P6.registerClass("_at.$P6",null,IAttachmentViewModelFactory);_at.$87.registerClass("_at.$87");_at.$HZ.registerClass("_at.$HZ",_at.$1I);_at.$uX.registerClass("_at.$uX",_at.$HZ);_at.$12P.registerClass("_at.$12P",null,IUriFileAttachmentViewModelFactory);_at.$FT.registerClass("_at.$FT");_at.$BW.registerClass("_at.$BW");_at.$2u.registerClass("_at.$2u",null,_at.$YD);_at.$SA.registerClass("_at.$SA");_at.$5x.registerClass("_at.$5x",_at.$1I,_at.$1IJ);_at.$1EB.registerClass("_at.$1EB",null,_at.$YD);_at.$ns.registerClass("_at.$ns",null,_js.$1Kw);_at.$135.registerClass("_at.$135",null,_js.$1Kw);_at.$oD.registerClass("_at.$oD",null,_js.$1Kw);_at.$sS.registerClass("_at.$sS",null,_js.$1Kw);_at.$3h.$3j5=new _H("Attachment",_g.Attachment,_at.$3h);_at.$3h.$4Ro=new _H("ParentItemId",_g.$1t,_at.$3h);_at.$3h.$1EG=new _H("IsEnabled",Boolean,_at.$3h);_at.$3h.$3vR=new _H("FileSelectedCommand",_js.$DK,_at.$3h);_at.$3h.$3XS=new _H("UploadAttachmentCommand",_js.$DK,_at.$3h);_at.$3h.$4iZ=new _H("UploadCompletedCommand",_js.$DK,_at.$3h);_at.$3h.$A=_a.$0.$1P;_at.$5t.$w=null;_at.$BP.$A=_a.$0.$1P;_at.$cq.$A=_a.$0.$1P;_at.$CL.$325=null;_at.$1I.$A=_a.$0.$1P;_at.$87.$3vP=["","NOT_FOUND_ERR","SECURITY_ERR","ABORT_ERR","NOT_READABLE_ERR","ENCODING_ERR","NO_MODIFICATION_ALLOWED_ERR","INVALID_STATE_ERR","SYNTAX_ERR","INVALID_MODIFICATION_ERR","QUOTA_EXCEEDED_ERR","TYPE_MISMATCH_ERR","PATH_EXISTS_ERR"];_at.$BW.$A=_a.$0.$1P;_at.$BW.$36T=!1;_at.$2u.$A=_a.$0.$1P;_at.$5x.$A=_a.$0.$1P