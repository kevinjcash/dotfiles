Type.registerNamespace("_e");_e.$3t=function(){};_e.$3t.$1Uu=function(n,t,i,r,u){u&&(r.onsuccess=function(n){var t=new _a.$Jd(_a.$2x.$14X(_a.$0.$DH),i);_a.$2x.$k3(t,function(){_e.$66.$1Uu(u)})})};_e.$3t.$Ze=function(n,t,i,r,u){u&&(r.onsuccess=function(n){var t=new _a.$Jd(_a.$2x.$14X(_a.$0.$DH),i);_a.$2x.$k3(t,function(){u(n)})})};_e.$3t.$AEB=function(n,t,i){i&&(t.onupgradeneeded=function(t){var r=new _a.$Jd(_a.$2x.$14X(_a.$0.$DH),n);_a.$2x.$k3(r,function(){i(t)})})};_e.$3t.$10l=function(n,t,i,r,u){u&&(r.onerror=function(n){var t=new _a.$Jd(_a.$2x.$14X(_a.$0.$DH),i);_a.$2x.$k3(t,function(){_e.$66.$10m(n.target.error.name,u)})})};_e.$3t.$EB=function(n,t,i,r,u){u&&(r.onerror=function(n){var t=new _a.$Jd(_a.$2x.$14X(_a.$0.$DH),i);_a.$2x.$k3(t,function(){u(n)})})};function CoreStorageComponent(){}CoreStorageComponent.prototype={$1aH:function(n,t,i){var r=this;n.$Ax(_e.$1G).$AHm(_e.$xp).$AHn().$AHo(function(){return _e.$1G.get_$I()});if(t.get_$6n()){var u=this;n.$Ax(_pal.$102).$AHm(_a.$qb).$AHn().$AHo(function(){return new _pal.$102(n.$2AC(_a.UserAgent),n.$2AC(_a.$4g))})}else{var f=this;n.$Ax(_a.$vW).$AHm(_a.$qb).$AHn().$AHo(function(){return new _a.$vW(n.$2AC(_a.UserAgent))})}var e=this;n.$Ax(_a.$xh).$AHo(function(){var t=new _a.$hr(n.$2AC(_js.$Bt),n.$2AC(_a.$T0),n.$2AC(_a.$74));return _e.$WN.$E(n.$2AC(_a.$qb),t,n.$2AC(_a.$4g))});var o=this;n.$Ax(IClientStore).$AHn().$AHo(function(){return new _e.$1n(256,n.$2AC(_e.$xp),n.$2AC(_a.$xh),n.$2AC(_a.$38))});var s=this;n.$Ax(IAttachmentsCleanupManager).$AHn().$AHo(function(){return _e.$5W.$1DQ()});var h=this;n.$Ax(IInlineImageItemStore).$AHo(function(){return new _e.$yN(n.$2AC(IClientStore),_e.$1n.$7s)});var c=this;n.$Ax(IAttachmentInfoItemStore).$AHo(function(){return new _e.$v6(n.$2AC(IClientStore),_e.$1n.$7s)});var l=this;n.$Ax(_e.$yv).$AHm(IItemStoreGetterFactory).$AHo(function(){return new _e.$yv(n.$2AC(IClientStore))});var a=this;n.$Ax(_e.$nt).$AHn().$AHo(function(){return new _e.$nt(n.$2AC(_a.$4g),n.$2AC(_0365f.$L))})},$82P:function(){return[new _a.$6K(_e.$nt,2,8)]}};_e.$7q=function(){};_e.$7q.$E=function(n,t){var i=_e.$7q.$5LU(n);var r=_e.$7q.$5LU(t);return i+"\x01"+r};_e.$7q.$5LU=function(n){return String.isInstanceOfType(n)?"S"+_e.$7q.$9re(n):Number.isInstanceOfType(n)?"N"+_e.$7q.$7mQ(n):Boolean.isInstanceOfType(n)?"B"+_e.$7q.$7kR(n):null};_e.$7q.$9re=function(n){if(n.indexOf("\x01")>=0){_js.Trace.logWarning(_a.$0.$DH,"A composite key is being constructed with the composite key meta-character and will be stripped of the character.  Consequently, sorts and filters, will ignore that character in any comparisons. {0}",n);return n.replace("\x01","")}else return n};_e.$7q.$7mQ=function(n){n>0xfffffffffffff&&(n=0xfffffffffffff);n<_e.$7q.$4ci&&(n=_e.$7q.$4ci);if(n>=0){var i=n.toString(16);var u=13-i.length;var t=new Sys.StringBuilder;t.append("P");for(var r=0;r<u;++r)t.append("0");t.append(i);return t.toString()}else{var f=0xfffffffffffff+n+1;var e=f.toString(16);return"N"+e}};_e.$7q.$7kR=function(n){return n.toString()};_e.$5W=function(){$1qG(this)};_e.$5W.$1DQ=function(){_e.$5W.$w||(_e.$5W.$w=new _e.$5W);return _e.$5W.$w};function $77A(n,t,i,r,u){var f;var o={};var s=[];for(f=0;f<u.length;f++)o[u[f]]=0;var h=_a.$7.get_utcNow().$2w(-3).$5X();for(f=0;f<r.length;f++){var e=r[f];e.LastAccessedDateTime<h?Array.add(s,e.AttachmentId):e.DataID in o?o[e.DataID]=1:Array.add(s,e.AttachmentId)}for(f=0;f<u.length;f++)o[u[f]]||i.get_$1r().$13V(u[f]);_e.$50.$5OY(s,t)}function $3bs(n,t,i,r){if(n.$356||!t.$5i(t.get_$1r())){_js.Trace.logWarning(_e.$5W.$A,"Already executing or the native bridge is not ready");$2lP(n,r,Error.create("Already executing the cleanup or NativeBridge is not available."));return!1}else{n.$356=!0;return!0}}function $4tW(n,t,i){var r=this;t.get_$1r().$5WG(1,function(r){for(var f=r,e=f.length,u=0;u<e;++u){var o=f[u];t.get_$1r().$13V(o)}$4tV(n,i);$1qG(n)})}function $1qG(n){n.$356=!1}function $2lP(n,t,i){t&&t(i)}function $4tV(n,t){t&&t()}_e.$5W.prototype={$356:!1,get_$8KO:function(){return this.$356},$7gh:function(n,t,i){_a.$3.$K(n,"nativeBridge");_js.Trace.logInfo(_e.$5W.$A,"CleanAllPalAttachments start");$3bs(this,n,t,i)&&$4tW(this,n,t)},$7gg:function(n,t,i,r){_a.$3.$K(n,"attachmentStore");_a.$3.$K(t,"initNativeBridge");_js.Trace.logInfo(_e.$5W.$A,"CleanAllPalAttachmentInfoAndAttachments start");if($3bs(this,t,i,r)){var u=this,f=this;_e.$50.$5WI(n,function(f){n.$Bl(new _a.$6i("SyncConversationItemsReadFlagModule.CleanAllPalAttachmentInfoAndAttachments"),function(t){if(f)for(var r=f,u=r.length,i=0;i<u;++i){var e=r[i];n.$II(t,_e.$1l.$5h(e.AttachmentId))}},function(){$4tW(u,t,i)},function(n){_e.$1g.$DN(n,function(t){_js.Trace.logWarning(_e.$5W.$A,"Error occurred during cleanup call {0}",n);$2lP(u,r,t.$Sd());$1qG(u)})})},function(n){_js.Trace.logWarning(_e.$5W.$A,"Error in DB while retrieving all non inline attachment info {0}",n);$2lP(f,r,n.$Sd());$1qG(f)})}},$A3s:function(n,t,i,r){_a.$3.$K(n,"store");_a.$3.$K(t,"nativeBridge");_js.Trace.logInfo(_e.$5W.$A,"AttachmentCleanupManager.StartCleanUp start");if($3bs(this,t,i,r)){var f=null;var e=null;var u=this,o=this;_e.$50.$5WI(n,function(r){f=r;t.get_$1r().$5WG(1,function(r){e=r;$77A(u,n,t,f,e);$4tV(u,i);$1qG(u)})},function(n){_js.Trace.logWarning(_e.$5W.$A,"Error in DB during StartScheduledCleanup {0}",n);$2lP(o,r,n.$Sd());$1qG(o)})}}};var ItemShapeType=function(){};ItemShapeType.prototype={};ItemShapeType.registerEnum("ItemShapeType",!1);_e.$15X=function(){};_e.$15X.prototype={};_e.$15X.registerEnum("_e.$15X",!1);_e.$1Km=function(){};_e.$1Km.registerInterface("_e.$1Km");_e.$xp=function(){};_e.$xp.registerInterface("_e.$xp");_e.$y5=function(){};_e.$y5.registerInterface("_e.$y5");_e.$y6=function(){};_e.$y6.registerInterface("_e.$y6");_e.$1L0=function(){};_e.$1L0.registerInterface("_e.$1L0");_e.$1IF=function(){};_e.$1IF.registerInterface("_e.$1IF");function AddressbookPostalAddress(){}function AddressbookEmailAddressInfo(){}AddressbookEmailAddressInfo.prototype={EmailAddress:null,EmailAddressProperty:null};function AddressbookItemMetaData(){}AddressbookItemMetaData.prototype={OldValue:null,PropertyUriEnum:"FolderId",$3p:null};function AddressbookPhoneNumberInfo(){}AddressbookPhoneNumberInfo.prototype={PhoneNumber:null,PhoneNumberProperty:null};function AddressbookPostalAddressInfo(){}AddressbookPostalAddressInfo.prototype={PostalAddress:null,PostalAddressProperty:null};_e.$12q=function(n){_e.$12q.initializeBase(this);this.$Sm=n};_e.$12q.prototype={$Sm:null,$9kB:function(n,t,i,r,u){var f=n.PersonaId.Id;switch(u){case 1:var e=_e.$6w.$7lX(n);this.$Sm.$6ZO(f,JsonParser.serialize(e));break;case 2:this.$Sm.$1Nl(f);break}}};_e.$o9=function(n,t){this.$1s7=[];_e.$o9.initializeBase(this);_a.$3.$K(n,"attachmentItemStore");_a.$3.$K(t,"inlineImageItemStore");this.$1Lz=n;this.$33g=t};_e.$o9.prototype={$1Lz:null,$33g:null,$3W5:0,$6Qc:function(n){this.$2zL(n)},$4SY:function(n,t,i){_a.$3.$K(n,"tx");_a.$3.$K(t,"emailCleanupContext");_a.$3.$K(t.$2LW,"emailCleanupContext.DeletedMessages");_a.$3.$K(i,"completedCallback");_js.Trace.logInfo(_a.$0.$5c,"Start inline attachment periodic cleanup");Array.clear(this.$1s7);this.$3W5=0;var r=this;this.$7go(n,t.$2LW,function(){t.$Cx.set_$A7r(_e.$CP.get_$1uY()-(t.$1Zv+t.$Cx.get_$2iG()+t.$Cx.get_$3Vb()+t.$Cx.get_$4g8()));t.$Cx.set_$6Go(r.$3W5);i()})},$7go:function(n,t,i){var u=n.$Dv(_e.$1G.get_$I().$1B5.get_$1N());var f=new _a.$8P(null,null);if(!t.$AHc()){i();return}var r=this;u.$JP(f,function(u){u.$C(function(n){_js.Trace.logInfo(_a.$0.$5c,"Number of attachments to process is {0}",n)},null);var f=[];r.$5HL(u,t,f,function(){_e.$CP.$AId(_bc.$qZ,n,r.$1Lz,f);_e.$CP.$AId(_bc.$19F,n,r.$33g,f);_js.Trace.logInfo(_a.$0.$5c,"Completed cleaning inline attachments for given messages, total: {0}",f.length);i()})},null)},$5HM:function(n,t,i,r){_a.$3.$K(n,"tx");_a.$3.$K(t,"messageIds");_a.$3.$85(i,0,t.length,"currentMessageIndex");_a.$3.$K(r,"completedCallback");if(!t.length){r();return}var u=this;this.$5WH(n,t[i].get_$1fW().toString(),function(f){f&&Array.addRange(u.$1s7,f);++i;if(i===t.length){var o=u.$1s7;u.$3W5=u.$1s7.length;for(var s=o,c=s.length,e=0;e<c;++e){var h=s[e];u.$1Lz.$II(n,h);u.$33g.$II(n,h)}_js.Trace.logInfo(_a.$0.$5c,"Completed cleaning inline attachments for given messages, total attachments cleaned: {0} for total messages: {1}",o.length,t.length);Array.clear(u.$1s7);r()}else u.$5HM(n,t,i,r)})},$2zL:function(n){_a.$3.$K(n,"tx");_js.Trace.logInfo(_a.$0.$5c,"Performing attachment and inline image cleanup");this.$1Lz.$qd(n);this.$33g.$qd(n)},$5WH:function(n,t,i){_e.$50.$5WH(n,t,this.$1Lz,i,null)},$5HL:function(n,t,i,r){var u=this;n.$Ds(50,function(f,e,o){for(var s=0;s<e.length;++s){var h=u.$1Lz.$14V(e[s]);if(h.get_$1r().AttachmentType===1&&t.get_$3o(h.get_$1r().MessageID)){Array.add(i,h.get_$1y());u.$3W5++}}e.length===50?u.$5HL(n,t,i,r):r()},null)}};_e.$50=function(){_e.$50.initializeBase(this)};_e.$50.$6Y3=function(n,t,i,r){_a.$3.$1G(n,"id");_a.$3.$K(t,"store");_a.$3.$K(i,"successCallback");var u=null;t.$Bl(new _a.$6i("AttachmentInfoItem.RetrieveRecord"),function(i){t.$Fu(i,_e.$1l.$5h(n),function(n){n&&(u=n.get_$1r())},null)},function(){i(u)},function(n){_e.$1g.$DN(n,r)})};_e.$50.$5WW=function(n,t,i,r){_a.$3.$1G(n,"id");_a.$3.$K(t,"store");_a.$3.$K(i,"successCallback");var u=null;t.$Bl(new _a.$6i("AttachmentInfoItem.GetAttachmentInfoAndUpdateTime"),function(i){t.$1KP(i,_e.$1l.$5h(n),function(t){if($5(t)){_js.Trace.logInfo(_e.$1n.$A,"Message with id {0} not found in local store",n);return}u=t;u.LastAccessedDateTime=_a.$7.get_utcNow().$5X()})},function(){i(u)},function(n){_e.$1g.$DN(n,r)})};_e.$50.$6ZF=function(n,t,i,r){_a.$3.$K(n,"record");_a.$3.$K(t,"store");var u=null;var f=t.$4i1(n);t.$Bl(new _a.$6i("AttachmentInfoItem.SaveAttachmentInfo"),function(n){f.$E1(n,function(n){u=n})},function(){_e.$1g.$AHa(_a.$qe,u,i)},function(n){_e.$1g.$DN(n,r)})};_e.$50.$5OX=function(n,t){_a.$3.$1G(n,"attachmentId");_a.$3.$K(t,"store");_e.$50.$5OY([n],t)};_e.$50.$5OY=function(n,t){_a.$3.$K(n,"attachmentIds");_a.$3.$K(t,"store");t.$Bl(new _a.$6i("AttachmentInfoItem.DeleteAttachmentInfoWithIds"),function(i){for(var u=n,f=u.length,r=0;r<f;++r){var e=u[r];t.$II(i,_e.$1l.$5h(e))}},function(){},function(n){_js.Trace.logError(_e.$1n.$A,"DeleteAttachmentInfoWithIds failed with error {0}",n.$3j)})};_e.$50.$5WI=function(n,t,i){_a.$3.$K(n,"store");_a.$3.$K(t,"successCallback");var r=[];n.$Bl(new _a.$6i("AttachmentInfoItem.GetAllNonInlineAttachmentInfoRecords"),function(t){var u=t.$Dv(_e.$1G.get_$I().$1B5.get_$1N());var f=new _a.$8o(_e.$50.$3jF,0);var e=new _a.$8P(f,null);u.$JP(e,function(t){_e.$50.$6Up(n,t,r,_e.$1g.$aG(i))},_e.$1g.$aG(i))},function(){t(r)},_e.$1g.$aG(i))};_e.$50.$5WH=function(n,t,i,r,u){_a.$3.$K(n,"tx");_a.$3.$1G(t,"messageId");_a.$3.$K(r,"successCallback");var f=[];var h=n.$Dv(_e.$1G.get_$I().$1B5.get_$1N());var e=new _a.$8o(_e.$50.$4C3,t);var o=new _a.$8P(e,null);var s=100;_e.$y.$6UN(_e.$50,n,o,s,function(n,t,u,e){if(u)for(var o=0;o<u.length;o++){var s=i.$14V(u[o]);s.get_$1r().AttachmentType===1&&Array.add(f,s.get_$1y())}e&&r(f)},_e.$1g.$aG(u))};_e.$50.$7kK=function(n,t,i,r,u){return new AttachmentInfoRecord(n.AttachmentId.Id,"InlineAttachmentId",n.Size,_a.$7.get_utcNow().$5X(),t,u?1:0,i,r)};_e.$50.$81k=function(n,t){var i;i=n!==1||t?n===1&&t?1:n||t?3:2:0;return i};_e.$50.$6Up=function(n,t,i,r){var u=100;t.$Ds(u,function(u,f,e){for(var o=0;o<f.length;++o){var s=n.$14V(f[o]);Array.add(i,s.get_$1r())}f.length>0&&_e.$50.$6Up(n,t,i,r)},r)};_e.$50.prototype={get_$iW:function(){return _e.$1G.get_$I().$1B5},$AEy:function(n){_a.$3.$1G(n.AttachmentId,"AttachmentId");_a.$3.$1G(n.DataID,"DataID");_a.$3.$1G(n.MessageID,"MessageID");_a.$3.$1G(n.MessageReceivedDateTime,"MessageReceivedDateTime");_a.$3.$K(n.AttachmentType,"AttachmentType");if(n.LastAccessedDateTime<=0)throw Error.argument("LastAccessedDateTime","LastAccessedDateTime must be set to a valid value");},$7xR:function(n){return _e.$1l.$5h(n.AttachmentId)},$7xV:function(n){return new AttachmentInfoMetadata(_e.$50.$81k(n.AttachmentType,n.Synced))}};function AttachmentInfoMetadata(n){AttachmentInfoMetadata.initializeBase(this);_a.$3.$K(n,"attachmentTypeAndSyncStatus");this.AttachmentTypeAndSyncStatus=n}AttachmentInfoMetadata.prototype={AttachmentTypeAndSyncStatus:0};_e.$v6=function(n,t){_e.$v6.initializeBase(this,[n,t])};_e.$v6.prototype={$5WW:function(n,t,i){_e.$50.$5WW(n,this,t,i)},$5OX:function(n){_e.$50.$5OX(n,this)},$6ZF:function(n,t,i){_e.$50.$6ZF(n,this,t,i)},$6Y3:function(n,t,i){_e.$50.$6Y3(n,this,t,i)}};_e.$FJ=function(n){this.$1ud={};_a.$3.$K(n,"eventAggregator");this.$J=n};function $77B(n){var t=n.$1ud;for(var i in t){var r={key:i,value:t[i]};var u=r.value;delete n.$1ud[u.get_$vB().toLowerCase()]}}function $1L0(n,t){n.$1ud[t.get_$vB().toLowerCase()]=t}_e.$FJ.prototype={$J:null,$Hd:function(n,t){_a.$3.$K(n,"clientStore");_a.$3.$K(n.get_$13M(),"database");_a.$3.$1G(t,"timeZoneId");this.$11q(n.get_$13M());this.$8Rc(n,t);var i=this.$1ud;for(var r in i){var u={key:r,value:i[r]};var f=u.value;f.$Hd()}},$11q:function(n){_a.$3.$K(n,"offline store");var t=this.$1ud;for(var i in t){var r={key:i,value:t[i]};var u=r.value;u.$11q()}$77B(this)},$8Rc:function(n,t){var i=new _e.$UR(n,t);$1L0(this,new _e.$cl(n,i,t,this.$J));$1L0(this,new _e.$tH(n,i,t,this.$J));$1L0(this,new _e.$TC(n,i,t,this.$J));$1L0(this,new _e.$V9(n,i,t,this.$J));$1L0(this,new _e.$1Bx(n,i,t,this.$J));$1L0(this,new _e.$1BG(n,i,t,this.$J));$1L0(this,new _e.$14g(n,i,t,this.$J));$1L0(this,new _e.$Uz(n,i,t,this.$J))}};_e.$M5=function(n){this.$1Up=new(_0365f.$n.$$(String));_a.$3.$K(n,"emailCleanupContext");this.$7d=n};function $77x(n,t,i){var r=this;n.get_$3V1().$Fu(t,_e.$1l.$5h(n.$7d.$3nm),function(r){if(r){n.$5Jq=r.get_$1r();var u=t.$Dv(_e.$1G.get_$I().$iY.get_$1N());var f=new _a.$8P(null,null);u.$JP(f,function(r){r.$C(function(n){},null);var u=[];$4tj(n,t,r,u,i)},null)}else i()},null)}function $4tj(n,t,i,r,u){var f=this;i.$Ds(100,function(f,e,o){for(var s=0;s<e.length;++s){var h=n.get_$3nq().$14V(e[s]);var c=h.get_$1r();var l=c.ConversationId.Id;if($77y(n,c))if(n.$7d.$Cx.get_$2aE()<50){n.$1Up.$D(l);var a;(a=n.$7d.$Cx).set_$2aE(a.get_$2aE()+1);Array.add(r,h.get_$1y())}else{var v;(v=n.$7d.$Cx).set_$3Ig(v.get_$3Ig()+1)}else n.$7d.$2Gf.set_$3o(l,!0)}if(e.length===100)$4tj(n,t,i,r,u);else{_js.Trace.logInfo(_a.$0.$5c,"Number of conversations left uncleaned in this batch is {0}",n.$7d.$Cx.get_$3Ig());n.get_$3nq().$7rY(t,r);u()}},null)}function $77y(n,t){var i=n.get_$7j8().get_$3o(t.FolderId.Id);return $5(i)||_a.$7.$3x(t.LastDeliveryTime).$5X()<i}function $77w(n,t,i){var r=[];var u=this,f=this;n.get_$4gY().$5Tb(t,"ConversationItem",r,function(t){if(!n.$1Up.$76(t.Id)&&!n.$7d.$2Gf.get_$3o(t.Id)){n.$7d.$Cx.set_$2aG(n.$7d.$Cx.get_$2aG()+1);n.$1Up.$D(t.Id)}},function(){if(!n.$1Up.get_$C()){i();return}for(var u=0,r=0;r<n.$1Up.get_$C();r++)n.get_$5Jm().$Fu(t,_e.$1l.$5h(n.$1Up.get_$3o(r)),function(r){u++;if(r&&!n.$7d.$2Gf.get_$3o(r.get_$1r().ConversationId.Id)){for(var l=r.get_$1r(),o=l.ConversationNodes,a=o.length,f=0;f<a;++f)for(var s=o[f],e=0;e<s.Items.length;e++){var h=s.Items[e];n.$7d.$2VY.set_$3o(h.ItemId.Id,h)}var c;(c=n.$7d.$Cx).set_$3If(c.get_$3If()+1);r.$2LZ(t)}u===n.$1Up.get_$C()&&i()},null)})}_e.$M5.prototype={$7d:null,$5Jq:null,$2tU:null,get_$7j8:function(){if(!this.$2tU){this.$2tU=_a.$3r.$$(Number).$8V();var t=this.$5Jq.ModuleSpecificContext;if(t)for(var i=t,u=i.length,n=0;n<u;++n){var r=i[n];this.$2tU.set_$3o(r.FolderId.Id,_a.$7.$3x(r.OldestDeliveryTime).$5X())}}return this.$2tU},get_$3nq:function(){return this.$7d.$AU.get_$Jl()},get_$5Jm:function(){return this.$7d.$AU.get_$Hi()},get_$3V1:function(){return this.$7d.$AU.get_$pd()},get_$4gY:function(){return this.$7d.$AU.get_$4gX()},$2zL:function(n){_js.Trace.logInfo(_a.$0.$5c,"Starting full module conversation cleanup");this.get_$3nq().$qd(n);this.get_$5Jm().$qd(n);this.get_$3V1().$II(n,_e.$1l.$5h(this.$7d.$3nm))},$4SY:function(n,t){_js.Trace.logInfo(_a.$0.$5c,"Starting periodic conversation cleanup");var i=this;$77x(this,n,function(){i.$7d.$Cx.set_$2iG(_e.$CP.get_$1uY()-i.$7d.$1Zv);_js.Trace.logInfo(_a.$0.$5c,"Completed cleaning conversations, number cleaned = {0}, time taken = {1} ms",i.$7d.$Cx.get_$2aE(),i.$7d.$Cx.get_$2iG());$77w(i,n,function(){i.$7d.$Cx.set_$3Vb(_e.$CP.get_$1uY()-(i.$7d.$1Zv+i.$7d.$Cx.get_$2iG()));_js.Trace.logInfo(_a.$0.$5c,"Completed cleaning conversation nodes, number cleaned = {0}, time taken = {1} ms",i.$7d.$Cx.get_$3If(),i.$7d.$Cx.get_$3Vb());t()})})}};function CustomSyncData(n,t){this.IsDataSynced=n;this.ItemShape=t}CustomSyncData.prototype={IsDataSynced:null,ItemShape:0};_e.$4W=function(n){_e.$4W.initializeBase(this,[1,"EmailCleanup"]);$1I(this,_e.$4W.$5HQ,_a.$jJ.toString(n))};_e.$4W.prototype={get_$3W4:function(){return this.$W(_e.$4W.$4gi)||0},set_$3W4:function(n){$1I(this,_e.$4W.$4gi,n);return n},get_$6ks:function(){return this.$W(_e.$4W.$4gh)||0},set_$6ks:function(n){$1I(this,_e.$4W.$4gh,n);return n},get_$2iG:function(){return this.$W(_e.$4W.$4gA)||0},set_$2iG:function(n){$1I(this,_e.$4W.$4gA,n);return n},get_$2aE:function(){return this.$W(_e.$4W.$4NR)||0},set_$2aE:function(n){$1I(this,_e.$4W.$4NR,n);return n},get_$3Ig:function(){return this.$W(_e.$4W.$4NS)||0},set_$3Ig:function(n){$1I(this,_e.$4W.$4NS,n);return n},get_$3Vb:function(){return this.$W(_e.$4W.$4g9)||0},set_$3Vb:function(n){$1I(this,_e.$4W.$4g9,n);return n},get_$3If:function(){return this.$W(_e.$4W.$4NQ)||0},set_$3If:function(n){$1I(this,_e.$4W.$4NQ,n);return n},get_$4g8:function(){return this.$W(_e.$4W.$4gB)||0},set_$4g8:function(n){$1I(this,_e.$4W.$4gB,n);return n},get_$1jG:function(){return this.$W(_e.$4W.$4NU)||0},set_$1jG:function(n){$1I(this,_e.$4W.$4NU,n);return n},get_$A7r:function(){return this.$W(_e.$4W.$4g7)||0},set_$A7r:function(n){$1I(this,_e.$4W.$4g7,n);return n},get_$6Go:function(){return this.$W(_e.$4W.$4NT)||0},set_$6Go:function(n){$1I(this,_e.$4W.$4NT,n);return n},get_$2aG:function(){return this.$W(_e.$4W.$4NW)||0},set_$2aG:function(n){$1I(this,_e.$4W.$4NW,n);return n}};_e.$15y=function(n,t,i,r,u,f,e,o,s){this.$2Gf=_a.$3r.$$(Boolean).$8V();this.$2VY=_a.$3r.$$(_g.$7j).$8V();this.$2LW=_a.$3r.$$(Boolean).$8V();_a.$3.$K(t,"itemStoreGetter");_a.$3.$1G(i,"converationSyncStateId");_a.$3.$1G(r,"messageSyncStateId");_a.$3.$K(u,"folderMappings");_a.$3.$K(f,"datapointTracker");_a.$3.$85(e,0,2147483647,"syncMinimum");_a.$3.$85(o,0,2147483647,"syncWindow");_a.$3.$K(s,"localStorageAdapter");this.$3ma=n;this.$AU=t;this.$3nm=i;this.$4C8=r;this.$5Uj=u;this.$mn=f;this.$19Q=e;this.$2DB=o;this.$1fu=s;this.$Cx=new _e.$4W(n)};_e.$15y.prototype={$19Q:0,$2DB:0,$3ma:0,$3nm:null,$4C8:null,$AU:null,$5Uj:null,$mn:null,$Cx:null,$1Zv:0,$1fu:null,$A4u:function(){this.$mn.get_$2a()&&this.$mn.$AP(this.$Cx)}};_e.$CP=function(n){_e.$CP.initializeBase(this);_a.$3.$K(n,"emailCleanupContext");this.$rE=n};_e.$CP.get_$1uY=function(){return _a.$7.get_$2F().$5X()};_e.$CP.$AId=function(n,t,i,r){for(var f=r,e=f.length,u=0;u<e;++u){var o=f[u];i.$II(t,o)}};function $78P(n,t){_js.Trace.logInfo(_a.$0.$5c,"Starting full module email cleanup because of cleanupType = {0}",_a.$jJ.toString(n.$rE.$3ma));n.get_$5Jg().$2zL(t);n.get_$5sT().$2zL(t);n.get_$5D2().$2zL(t)}function $78Q(n,t){_js.Trace.logInfo(_a.$0.$5c,"Starting periodic email cleanup");n.$rE.$1Zv=_e.$CP.get_$1uY();var i=this;n.get_$5Jg().$4SY(t,function(){n.get_$5sT().$4SY(t,function(){n.get_$5D2().$4SY(t,n.$rE,function(){n.$rE.$Cx.set_$3W4(_e.$CP.get_$1uY()-n.$rE.$1Zv);_js.Trace.logInfo(_a.$0.$5c,"Completed full cleanup (before transaction complete), time taken {0} ms",n.$rE.$Cx.get_$6ks())})})})}_e.$CP.prototype={$rE:null,$3nn:null,$4C1:null,$1s2:null,$1Ly:null,$42l:null,get_$5Jg:function(){this.$3nn||(this.$3nn=new _e.$M5(this.$rE));return this.$3nn},get_$5sT:function(){this.$4C1||(this.$4C1=new _e.$Ff(this.$rE));return this.$4C1},get_$7bt:function(){this.$1Ly||(this.$1Ly=this.$rE.$AU.get_$1Lx());return this.$1Ly},get_$8Gz:function(){this.$42l||(this.$42l=this.$rE.$AU.get_$42j());return this.$42l},get_$5D2:function(){this.$1s2||(this.$1s2=new _e.$o9(this.get_$7bt(),this.get_$8Gz()));return this.$1s2},$6Qc:function(n){_a.$3.$K(n,"tx");switch(this.$rE.$3ma){case 2:$78Q(this,n);break;case 4:case 1:case 3:$78P(this,n);break;default:break}}};_e.$Ff=function(n){this.$3wJ=_a.$3r.$$(Boolean).$8V();_a.$3.$K(n,"emailCleanupContext");this.$7d=n};function $79G(n,t,i){var r=this;n.get_$3V1().$Fu(t,_e.$1l.$5h(n.$7d.$4C8),function(r){if(r){var u=_a.$1X.$AIG(MultiFolderSyncState,r.get_$1r());n.$4ST=u.PerFolderSyncStateContainer;var s=0;var f=[];var e=u.PerFolderSyncStateContainer;for(var o in e){var h={key:o,value:e[o]};Array.add(f,h.value)}$4uI(n,t,f,s,function(){$79I(n,t,function(){i()})})}else i()},null)}function $4uI(n,t,i,r,u){if(!i.length){u();return}var f=this;$79H(n,t,i[r],function(){var f=i[r].Id;n.$3wJ.set_$3o(f,!0);r++;r===i.length?u():$4uI(n,t,i,r,u)})}function $79I(n,t,i){var r=[];var u=this,f=this;n.get_$4gY().$5Tb(t,"MessageItem",r,function(t){n.$7d.$Cx.set_$2aG(n.$7d.$Cx.get_$2aG()+1);n.$7d.$2VY.set_$3o(t.Id,t.Data)},function(){n.$7d.$2VY.$AHd(function(i,r){var u;var f,e;if(e=$4uJ(n,r,f={val:u}),u=f.val,e){var o;(o=n.$7d.$Cx).set_$1jG(o.get_$1jG()+1);var s=_e.$1l.$5h(r.ItemId.Id);n.$7d.$2LW.set_$3o(r.ItemId.Id,!0);n.get_$3Ai().$II(t,s)}});i()})}function $79H(n,t,i,r){_js.Trace.logInfo(_a.$0.$5c,"Starting to cleanup messages for folder {0}",i.Id);var u=i.Id;var f=t.$Dv(_e.$1G.get_$I().$zC.get_$1N());var e=new _a.$8o(MessageItemMetadata.$1Tt(),u);var o=new _a.$8P(e,[new _a.$If(MessageItemMetadata.$2CX(),0)]);var s=this;f.$JP(o,function(i){var u=[];$4uH(n,t,i,u,function(){_e.$CP.$AId(_bc.$MS,t,n.get_$3Ai(),u);r()})},null)}function $4uH(n,t,i,r,u){var f=this;i.$Ds(10,function(f,e,o){for(var s=!1,h=0;h<e.length;++h){var l=n.get_$3Ai().$14V(e[h]);var c=l.get_$1r();s=!1;var a,v;if(v=$4uJ(n,c,a={val:s}),s=a.val,v){var y;(y=n.$7d.$Cx).set_$1jG(y.get_$1jG()+1);n.$7d.$2VY.$34(c.ItemId.Id);n.$7d.$2LW.set_$3o(c.ItemId.Id,!0);Array.add(r,l.get_$1y())}if(!s)break}e.length===10&&n.$7d.$Cx.get_$1jG()<150&&s?$4uH(n,t,i,r,u):u()},null)}function $4uJ(n,t,i){if(n.$7d.$5Uj.idToName(t.ParentFolderId)==="outbox"){i.val=!1;return!1}var u=n.$4ST?n.$4ST[t.ParentFolderId.Id]:null;var f=u?u.ModuleSpecificContext:null;var r;if(f){r=_a.$7.$3x(t.DateTimeReceived).$5X()>=_a.$7.$3x(f.OldestReceivedTime).$5X();i.val=!r}else{r=!1;i.val=!1}return!r&&!n.$7d.$2Gf.$NO(t.ConversationId.Id)&&!n.$3wJ.$NO(t.ParentFolderId.Id)}_e.$Ff.prototype={$7d:null,$4ST:null,get_$3Ai:function(){return this.$7d.$AU.get_$4y()},get_$3V1:function(){return this.$7d.$AU.get_$pd()},get_$4gY:function(){return this.$7d.$AU.get_$4gX()},$2zL:function(n){_js.Trace.logInfo(_a.$0.$5c,"Performing full module message cleanup");this.get_$3Ai().$qd(n);this.get_$3V1().$II(n,_e.$1l.$5h(this.$7d.$4C8))},$4SY:function(n,t){_js.Trace.logInfo(_a.$0.$5c,"Starting periodic message cleanup");var i=this;$79G(this,n,function(){i.$7d.$Cx.set_$4g8(_e.$CP.get_$1uY()-(i.$7d.$1Zv+i.$7d.$Cx.get_$2iG()+i.$7d.$Cx.get_$3Vb()));_js.Trace.logInfo(_a.$0.$5c,"Completed cleaning messages, number cleaned = {0}, time taken = {1} ms",i.$7d.$Cx.get_$1jG(),i.$7d.$Cx.get_$4g8());t()})}};_e.$NW=function(n,t){_e.$NW.$$(this.$$gta["_e.$NW"].TItem,this.$$gta["_e.$NW"].TCreate).initializeBase(this);_a.$3.$K(n,"itemStore");_a.$3.$K(t,"creates");this.$HK=n;this.$3pX=t};_e.$NW.$$=function(n,t){var i="$NW"+"$2"+"$"+n.getName().replace(/\./g,"_")+"$"+t.getName().replace(/\./g,"_");if(!_e[i]){var u=_e[i]=function(){(this.$$gta=this.$$gta||{})["_e.$NW"]={TItem:n,TCreate:t};for(var r=[],i=0;i<arguments.length;++i)r[i]=arguments[i];_e.$NW.apply(this,r)};u.registerClass("_e."+i,_e.$3Z);var f=_e.$NW.prototype;for(var e in f){var r={key:e,value:f[e]};"constructor"!==r.key&&(u.prototype[r.key]=r.value)}}return _e[i]};_e.$NW.prototype={$HK:null,$3pX:null,get_$5nN:function(){return this.$HK},get_$AIe:function(){return this.$3pX},$6Qc:function(n){_a.$3.$K(n,"tx");this.$HK.$qd(n);_e.$3Z.$AHF(this.$$gta["_e.$NW"].TItem,this.$$gta["_e.$NW"].TCreate,this.$HK,n,this.$3pX,null)}};_e.$ck=function(n,t){_e.$ck.initializeBase(this,[n,t])};_e.$ck.prototype={$2QN:function(n,t,i,r){_a.$3.$K(n,"tx");_a.$3.$K(t,"folderId");_a.$3.$85(i,0,2147483647,"totalCount");_a.$3.$85(r,0,2147483647,"unreadCount");var u=this;this.$Fu(n,_e.$1l.$5h(t.Id),function(u){if(!u){_js.Trace.logWarning(_a.$0.$M6,"Folder with id {0} not found in client store",t.Id);return}var f=_a.$1X.$AIG(_g.$EN,u.get_$1r());f.TotalCount+=i;f.UnreadCount+=r;u.$E1(n,null)},null)},$5Nr:function(n,t,i,r){_a.$3.$K(n,"tx");_a.$3.$K(t,"folderId");_a.$3.$85(i,0,2147483647,"totalCount");_a.$3.$85(r,0,2147483647,"unreadCount");var u=this;this.$Fu(n,_e.$1l.$5h(t.Id),function(u){if(!u){_js.Trace.logWarning(_a.$0.$M6,"Folder with id {0} not found in client store",t.Id);return}var f=_a.$1X.$AIG(_g.$EN,u.get_$1r());f.TotalCount>=i?f.TotalCount-=i:_js.Trace.logError(_a.$0.$M6,"Folder {0} total count {1} is less than the amount we are trying to decrement it by {2}",f.DisplayName,f.TotalCount);f.UnreadCount>=r?f.UnreadCount-=r:_js.Trace.logError(_a.$0.$M6,"Folder {0} unread count {1} is less than the amount we are trying to decrement it by {2}",f.DisplayName,f.UnreadCount);u.$E1(n,null)},null)},$ACA:function(n,t,i,r){_a.$3.$K(n,"tx");_a.$3.$K(t,"folderId");_a.$3.$85(i,0,2147483647,"totalCount");_a.$3.$85(r,0,2147483647,"unreadCount");var u=this;this.$Fu(n,_e.$1l.$5h(t.Id),function(t){if(t){var u=t.get_$1r();!$5(i)&&i>=0?u.TotalCount=i:_js.Trace.logError(_a.$0.$M6,"Folder {0} total count is being updated to an invalid value {1}",u.DisplayName,i);u.__type===_g.$EN._dataContractName&&(!$5(r)&&r>=0?u.UnreadCount=r:_js.Trace.logError(_a.$0.$M6,"Folder {0} unread count is being updated to an invalid value {1}",u.DisplayName,r));t.$E1(n,null)}},null)},$83w:function(n,t,i){_a.$3.$K(n,"tx");_a.$3.$K(t,"folderId");var r=this;this.$Fu(n,_e.$1l.$5h(t.Id),function(n){if(!n){_js.Trace.logWarning(_a.$0.$M6,"Folder with id {0} not found in client store",t.Id);return}var r=_a.$1X.$AIG(_g.$EN,n.get_$1r());i(r.TotalCount,r.UnreadCount)},null)}};_e.$UR=function(n,t){_a.$3.$K(n,"clientStore");_a.$3.$1G(t,"timeZoneId");this.$7b=n;this.$7s=t;var i=this;this.$2Q=new(_0365f.$4C.$$(_bc.$194))(function(){return new _e.$ck(i.$7b,i.$7s)});var r=this;this.$5Ue=new(_0365f.$4C.$$(_bc.$193))(function(){return new _e.$Tv(r.$7b,r.$7s)});var u=this;this.$2fi=new(_0365f.$4C.$$(_bc.$Bs.$$(_bc.$ym)))(function(){return new(_e.$7t.$$(_bc.$ym,_e.$6A))(u.$7b,u.$7s)});var f=this;this.$11a=new(_0365f.$4C.$$(_bc.$Bs.$$(_bc.$rM)))(function(){return new(_e.$7t.$$(_bc.$rM,_e.$Lm))(f.$7b,f.$7s)});var e=this;this.$3q=new(_0365f.$4C.$$(_bc.$18j))(function(){return new _e.$RA(e.$7b,e.$7s)});var o=this;this.$3j=new(_0365f.$4C.$$(_bc.$19N))(function(){return new _e.$lP(o.$7b,o.$7s)});var s=this;this.$6Ox=new(_0365f.$4C.$$(_bc.$19o))(function(){return new _e.$1By(s.$7b,s.$7s)});var h=this;this.$6kl=new(_0365f.$4C.$$(_bc.$1AJ))(function(){return new _e.$12E(h.$7b,h.$7s)});var c=this;this.$5DA=new(_0365f.$4C.$$(IAttachmentInfoItemStore))(function(){return new _e.$v6(c.$7b,c.$7s)});var l=this;this.$5fF=new(_0365f.$4C.$$(IInlineImageItemStore))(function(){return new _e.$yN(l.$7b,l.$7s)});var a=this;this.$6q=new(_0365f.$4C.$$(_bc.$Bs.$$(_bc.$kS)))(function(){return new(_e.$7t.$$(_bc.$kS,_e.$PN))(a.$7b,a.$7s)});var v=this;this.$AQ=new(_0365f.$4C.$$(_bc.$Bs.$$(_bc.$MP)))(function(){return new(_e.$7t.$$(_bc.$MP,_e.$64))(v.$7b,v.$7s)});var y=this;this.$5FV=new(_0365f.$4C.$$(_bc.$Bs.$$(_bc.$LD)))(function(){return new(_e.$7t.$$(_bc.$LD,_e.$Dt))(y.$7b,y.$7s)});var p=this;this.$5Ii=new(_0365f.$4C.$$(_bc.$Bs.$$(_bc.$qf)))(function(){return new(_e.$7t.$$(_bc.$qf,_e.$M2))(p.$7b,p.$7s)});var w=this;this.$6Pr=new(_0365f.$4C.$$(_bc.$Bs.$$(_bc.$rC)))(function(){return new(_e.$7t.$$(_bc.$rC,_e.$2U))(w.$7b,w.$7s)});var b=this;this.$5AV=new(_0365f.$4C.$$(_bc.$Bs.$$(_bc.$xd)))(function(){return new(_e.$7t.$$(_bc.$xd,_e.$12o))(b.$7b,b.$7s)});var k=this;this.$5AW=new(_0365f.$4C.$$(_bc.$Bs.$$(_bc.$xe)))(function(){return new(_e.$7t.$$(_bc.$xe,_e.$12p))(k.$7b,k.$7s)});var d=this;this.$6kM=new(_0365f.$4C.$$(_bc.$Bs.$$(_bc.$kx)))(function(){return new(_e.$7t.$$(_bc.$kx,_e.$Qi))(d.$7b,d.$7s)});var g=this;this.$6Vj=new(_0365f.$4C.$$(_bc.$Bs.$$(_bc.$YF)))(function(){return new(_e.$7t.$$(_bc.$YF,_e.$Aa))(g.$7b,g.$7s)});var nt=this;this.$6QQ=new(_0365f.$4C.$$(_bc.$Bs.$$(_bc.$e9)))(function(){return new(_e.$7t.$$(_bc.$e9,_e.$H9))(nt.$7b,nt.$7s)});var tt=this;this.$6Qy=new(_0365f.$4C.$$(_bc.$19q))(function(){return _e.$6P.$E(tt)})};_e.$UR.prototype={$7b:null,$7s:null,$2Q:null,$5Ue:null,$2fi:null,$11a:null,$3q:null,$3j:null,$6Ox:null,$6kl:null,$5DA:null,$5fF:null,$6q:null,$AQ:null,$5FV:null,$5Ii:null,$6Pr:null,$5AV:null,$5AW:null,$6kM:null,$6Vj:null,$6QQ:null,$6Qy:null,get_$5c:function(){return this.$7b},get_$2r:function(){return this.$2Q.get_$1n()},get_$5Uf:function(){return this.$5Ue.get_$1n()},get_$6df:function(){return this.$2fi.get_$1n()},get_$pd:function(){return this.$11a.get_$1n()},get_$1Lx:function(){return this.$5DA.get_$1n()},get_$42j:function(){return this.$5fF.get_$1n()},get_$Jl:function(){return this.$3q.get_$1n()},get_$Hi:function(){return this.$6q.get_$1n()},get_$1c:function(){return this.$AQ.get_$1n()},get_$mQ:function(){return this.$5FV.get_$1n()},get_$4y:function(){return this.$3j.get_$1n()},get_$h5:function(){return this.$6Ox.get_$1n()},get_$Iq:function(){return this.$6Vj.get_$1n()},get_$4gX:function(){return this.$6kl.get_$1n()},get_$3nE:function(){return this.$5Ii.get_$1n()},get_$6Ps:function(){return this.$6Pr.get_$1n()},get_$7Yr:function(){return this.$5AV.get_$1n()},get_$7Ys:function(){return this.$5AW.get_$1n()},get_$1oP:function(){return this.$6kM.get_$1n()},get_$4SK:function(){return this.$6QQ.get_$1n()},get_$1u:function(){return this.$6Qy.get_$1n()},$Bl:function(n,t,i,r){this.$7b.get_$13M().$Bl(n,t,i,r)}};_e.$yv=function(n){this.$7b=n};_e.$yv.prototype={$7b:null,$E:function(n){return new _e.$UR(this.$7b,n)}};_e.$YP=function(n,t,i){this.$1VG=1;_e.$YP.$$(this.$$gta["_e.$YP"].TItem,this.$$gta["_e.$YP"].TUpdate).initializeBase(this);_a.$3.$K(n,"itemStore");_a.$3.$K(t,"updates");_a.$3.$K(i,"deletedIds");this.$HK=n;this.$1XE=t;this.$1ut=i};_e.$YP.$$=function(n,t){var i="$YP"+"$2"+"$"+n.getName().replace(/\./g,"_")+"$"+t.getName().replace(/\./g,"_");if(!_e[i]){var u=_e[i]=function(){(this.$$gta=this.$$gta||{})["_e.$YP"]={TItem:n,TUpdate:t};for(var r=[],i=0;i<arguments.length;++i)r[i]=arguments[i];_e.$YP.apply(this,r)};u.registerClass("_e."+i,_e.$3Z,_e.$yg);var f=_e.$YP.prototype;for(var e in f){var r={key:e,value:f[e]};"constructor"!==r.key&&(u.prototype[r.key]=r.value)}}return _e[i]};_e.$YP.prototype={$HK:null,$1ut:null,$1XE:null,$13d:null,$38L:null,get_$AIY:function(){return this.$1VG},set_$AIY:function(n){this.$1VG=n;return n},get_$5P6:function(){return this.$13d?_0365f.$5F.$C(this.$13d):0},get_$3Np:function(){return this.$38L?this.$38L.length:0},get_$5nN:function(){return this.$HK},get_$AIZ:function(){return this.$1XE},set_$AIZ:function(n){this.$1XE=n;return n},get_$AIa:function(){return this.$1ut},$6Qc:function(n){_a.$3.$K(n,"tx");this.$4Sc(n,null)},$AIb:function(n){_a.$3.$9t(this.$1VG!==1&&!!this.$1VG,"This method should not be used to persist changes in sync code or service command");var t=this,r=this,i=this;this.$HK.$Bl(new _a.$6i("ItemSyncChangeUpdater.PersistChangesFromNonSyncSources",!1),function(n){t.$6Qc(n)},function(){_e.$1g.$lC(n)},function(n){_js.Trace.logWarning(_e.$1n.$A,"Unable to save non sync data to the clientStore. SaveMode={0}, error={1}",i.$1VG,n.$3j)})},$4Sc:function(n,t){_a.$3.$K(n,"tx");var i=!1;var r=!1;var f=this;var u=function(){i&&r&&_e.$1g.$lC(t)};var e=this;_e.$3Z.$AHG(this.$$gta["_e.$YP"].TItem,this.$$gta["_e.$YP"].TUpdate,this.$HK,n,this.$1XE,function(){i=!0;u()},this.$1VG);var o=this;_e.$3Z.$AHJ(this.$$gta["_e.$YP"].TItem,n,this.$HK,this.$1ut,function(){r=!0;u()})},$9kz:function(n,t,i){this.$13d={};_e.$3Z.$9kz(this.$$gta["_e.$YP"].TItem,n,this.$HK,t,this.$13d,i)},$9gf:function(n){if(this.$38L)for(var i=this.$38L,r=i.length,t=0;t<r;++t){var u=i[t];var f=this;_e.$3Z.$AHH(this.$$gta["_e.$YP"].TItem,this.$$gta["_e.$YP"].TUpdate,this.$HK,n,u,null,function(n){})}},$AIc:function(n){if(this.$1VG===1){var t=new _a.$OB(_e.$y.$2eL,10,1,0);this.$HK.$1uq(n,t,null)}}};_e.$GW=function(){_e.$GW.initializeBase(this)};_e.$GW.$1cg=function(n){return n.OutboxItemContext};_e.$GW.$6cI=function(n,t,i,r){_js.Trace.logInfo(r,"SetOutboxItemActionId: ItemId {0} Action Id {1}",t.Id,i);n.$Bl(new _a.$6i("OutboxItem.SetActionId",!1),function(u){n.$Fu(u,_e.$1l.$5h(t.Id),function(n){if(!n||!n.get_$1r()){var f=String.format("Unable to set Action id. Outbox item {0} was not found in the client store",t.Id);_js.Trace.logError(r,f);throw Error.invalidOperation(f);}_js.Trace.logInfo(r,"SetOutboxItemActionId - Item found: {0}. Updating actionId={1}",t.Id,i);n.get_$UI().ActionId=i;n.$E1(u,null)},null)},function(){},function(n){_e.$1g.$DN(n,function(n){_e.$GW.$8CL(n,t,i,r)})})};_e.$GW.$8CL=function(n,t,i,r){var u=String.format("Unable to set Action id. Error '{0}' ItemId {1} Action Id {2}",n.get_$4y(),t.Id,i.toString());_js.Trace.logError(r,u);throw Error.invalidOperation(u);};_e.$GW.$2j0=function(n,t,i,r,u,f){_a.$3.$K(n,"transaction");_a.$3.$K(i,"outboxItemStore");_a.$3.$K(i,"outboxItemId");_js.Trace.logInfo(r,"UpdateOutboxItemContext: OutboxItem Id={0} responseCode={1} sendAction={2} ",i.Id,u,f);t.$Fu(n,_e.$1l.$5h(i.Id),function(t){if(!t){var e=String.format("Unable to update outbox context. Outbox item {0} was not found in the client store",i.Id);_js.Trace.logError(r,e);throw Error.invalidOperation(e);}if(f!==undefined){_js.Trace.logInfo(r,"UpdateOutboxItemContext - Item found: {0}. Updating sendAction={1}.",i.Id,f);t.get_$UI().SendAction=f}if(t.get_$UI().LastResponseCode==="NoError"||u!=="ErrorInvalidIdMalformed"){_js.Trace.logInfo(r,"UpdateOutboxItemContext - Item found: {0}. Updating responseCode={1}.",i.Id,u);t.get_$UI().LastResponseCode=u}t.$E1(n,null)},null)};_e.$GW.prototype={get_$UI:function(){return _e.$GW.$1cg(this.get_$1r())},get_$iW:function(){return _e.$1G.get_$I().$1Tn},$8G4:function(n,t,i,r){var u=new _bc.OutboxItemContext;u.SendAction=n;u.ParentConversationNodeId=t;u.ComplianceId=i;u.LastResponseCode=r;this.get_$1r().OutboxItemContext=u},$9nJ:function(){this.get_$1r().OutboxItemContext=undefined}};_e.$1By=function(n,t){_e.$1By.initializeBase(this,[n,t])};_e.$1By.prototype={get_$vB:function(){return _e.$1G.get_$I().$1Tn.get_$1N()},$6n8:function(n,t,i,r){_e.$GW.$2j0(n,this,t,i,r)},$5a4:function(n,t){var i=this;this.get_$AIs().$Fu(n,_e.$1l.$5h(this.get_$o()),function(n){var i=0;n&&(i=n.get_$1r().TotalCount);t(i)},null)},$4UU:function(n,t){for(var i=0;i<n.length;++i){var r=this.$14V(n[i]);var u=r.get_$1r();Array.add(t,u)}_js.Trace.logInfo(_e.$1n.$A,"GetItems: Returning {0} results to the caller",t.length)}};_e.$H9=function(){_e.$H9.initializeBase(this)};_e.$H9.$1cw=function(n,t,i){_a.$3.$K(n,"peopleFilterItemStore");_a.$3.$K(t,"successCallback");_a.$3.$K(i,"errorCallback");var r=[];n.$Bl(new _a.$6i("PeopleFilterItem.GetPeopleFilters"),function(t){var i=t.$Dv(_e.$1G.get_$I().$2be.get_$1N());var u=new _a.$4w("Data.SortGroupPriority");var f=new _a.$8P(null,[new _a.$If(u,0)]);i.$JP(f,function(t){t.$Ds(100,function(t,i,u){for(var f=0;f<i.length;++f)Array.add(r,n.$14V(i[f]))},null)},null)},function(){t(r)},function(n){_e.$1g.$DN(n,i)})};function $3c6(n,t){var i=_g.$28.$3g(t.FolderId);if(_g.$3R.isInstanceOfType(i)){var r=i;return r.Id}else if(_g.$NK.isInstanceOfType(i)){var u=i;return u.Id}else throw Error.invalidOperation("unpexpected type for data.FolderId: "+i.__type);}_e.$H9.prototype={get_$iW:function(){return _e.$1G.get_$I().$2be},$3xl:function(){return $3c6(this,this.get_$1r())},$AEy:function(n){_a.$3.$K(n.FolderId,"FolderId");var t=$3c6(this,n);_a.$3.$1G(t,"Id")},$7xR:function(n){return _e.$1l.$5h($3c6(this,n))},$7xV:function(n){return new ItemMetadata}};function PersistedDataRecord(){}PersistedDataRecord.prototype={Data:null,Metadata:null};_e.$y=function(){this.$$d_$2LZ=Function.createDelegate(this,this.$2LZ)};_e.$y.$rP=function(n,t,i,r){_a.$3.$K(t,"store");_a.$3.$K(i,"data");_a.$3.$1G(r,"dataTimeZoneId");var u=new n;u.$6mo(i);u.$1E2(t,u.$AB5(i),i,r,r);return u};_e.$y.$14V=function(n,t,i,r){_a.$3.$K(t,"store");_a.$3.$K(i,"e");_a.$3.$K(r,"destinationTimeZoneId");return _e.$y.$AHX(n,t,i.$3D,i.$27,r)};_e.$y.$Fu=function(n,t,i,r,u,f){_a.$3.$K(i,"tx");_a.$3.$K(t,"store");_a.$3.$K(r,"id");_a.$3.$K(u,"destinationTimeZoneId");_a.$3.$K(f,"successCallback");var e=new n;var o=i.$Dv(e.get_$iW().get_$1N());_e.$y.$438(e,t,o,r,u,function(n){f(n)},null)};_e.$y.$7cy=function(n,t,i,r,u,f,e){_a.$3.$K(t,"store");_a.$3.$K(i,"tx");_a.$3.$K(r,"ids");_a.$3.$K(u,"destinationTimeZoneId");_a.$3.$K(f,"successCallback");for(var s=[],h=0,c=i.$Dv(_e.$y.$AHY(n)),o=0;o<r.length;++o){var l=new n;_e.$y.$438(l,t,c,r[o],u,function(n){n&&Array.add(s,n);++h===r.length&&f(s)},function(n){e(n)})}};_e.$y.$1KP=function(n,t,i,r,u,f){_a.$3.$K(t,"store");_a.$3.$K(i,"tx");_a.$3.$K(r,"id");_a.$3.$K(f,"updaterCallback");var e=new n;_e.$y.$8I5(e,t,i,r,u,f)};_e.$y.$AHV=function(n,t,i,r){_a.$3.$K(t,"tx");_a.$3.$K(i,"id");_e.$y.$5fv(t,i,_e.$y.$AHY(n),r)};_e.$y.$1uq=function(n,t,i,r){_a.$3.$K(t,"tx");_a.$3.$K(i,"filter");var u=new(_0365f.$n.$$(_a.$OK));_e.$y.$AHW(n,t,i,100,function(t,i,f,e){f.length&&u.$6S(f);if(e){var h=n.getName();if(u.get_$C())for(var c=0,o=0;o<u.get_$C();o++){var s=u.get_$3o(o);i.$im(s,function(){++c===u.get_$C()&&r&&r()},function(n){_js.Trace.logError(_e.$y.$A,"DeleteByFilterIn<{0}>: An error occured during deleting item #{1} (Id: {2}; Error: {3}-{4}).",h,o,s,n.$Vs,n.$3j)})}else r&&r()}},null)};_e.$y.$6UN=function(n,t,i,r,u,f){_a.$3.$K(t,"tx");if(r<1)throw Error.argumentOutOfRange("batchSize",r,"Batch size should be a positive integer.");var o=_e.$y.$AHY(n);var e=t.$Dv(o);e.$JP(i,function(n){_e.$y.$5nQ(n,r,function(n,t,i){u(n,e,t,i)},f)},null)};_e.$y.$AHW=function(n,t,i,r,u,f){_a.$3.$K(t,"tx");_a.$3.$K(i,"filter");var o=_e.$y.$AHY(n);var e=t.$Dv(o);e.$41s(i,function(n){_e.$y.$5nP(n,r,function(n,t,i){u(n,e,t,i)},f)},null)};_e.$y.$qd=function(n,t){_a.$3.$K(t,"tx");_e.$y.$5fr(t,_e.$y.$AHY(n))};_e.$y.$AHX=function(n,t,i,r,u){var f=new n;f.$1E2(t,_e.$1l.$3wg(i),r.Data,_e.$1n.$7s,u);return f};_e.$y.$AHY=function(n){var t=new n;return t.get_$iW().get_$1N()};_e.$y.$5fv=function(n,t,i,r){var u=n.$Dv(i);u.$im(t.$3Vx(),r,null)};_e.$y.$5nQ=function(n,t,i,r){n.$Ds(t,function(u,f,e){i(u,f,e);e||_e.$y.$5nQ(n,t,i,r)},r)};_e.$y.$5nP=function(n,t,i,r){n.$Ds(t,function(u,f,e){i(u,f,e);e||_e.$y.$5nP(n,t,i,r)},r)};_e.$y.$5fr=function(n,t){var i=n.$Dv(t);i.$1t(null,null)};_e.$y.$438=function(n,t,i,r,u,f,e){i.$3f(r.$3Vx(),function(i){var e=i;if(e){n.$1E2(t,r,e.Data,_e.$1n.$7s,u);f(n)}else f(null)},function(n){_e.$1g.$DN(n,e)})};_e.$y.$8I5=function(n,t,i,r,u,f){var e=i.$Dv(n.get_$iW().get_$1N());_e.$y.$438(n,t,e,r,u,function(n){var t=n?n.$z:null;f(t);n&&n.$E1(i,null)},null)};function $79C(n,t){var i;var r=new PersistedDataRecord;r.Data=n.$z;if(n.$7s!==t){i=_0365f.$5F.$3g(r);n.$AB4(i.Data,n.$7s,t)}else i=r;return i}function $79D(n,t,i){var r=_a.$7.$aV(_a.$7.get_utcNow());switch(i){case 1:_e.$y.$5oK.$2BV(t,r);break;default:_e.$y.$5oF.$2BV(t,r);break}_e.$y.$2eL.$2BV(t,i)}function $79E(n,t){for(var e=n.get_$iW().get_$2QS(),s=e.length,u=0;u<s;++u)for(var h=e[u],o=h.$2ND,c=o.length,f=0;f<c;++f){var i=o[f];var r=i.$5t.$1DO(t);if(r){if(Number.isInstanceOfType(r)){if(i.$Ad!==1)throw Error.argumentType(i.$5t.$5t,Object.getType(r),Number);}else if(String.isInstanceOfType(r)&&i.$Ad)throw Error.argumentType(i.$5t.$5t,Object.getType(r),String);}else i.$5t.$2BV(t,_a.$l0.$7qP(i.$Ad))}}_e.$y.prototype={$z:null,$7s:null,$6j:null,$3D:null,get_$1y:function(){return this.$3D},get_$4i0:function(){return this.$z},$E1:function(n,t){this.$6mo(this.$z);this.$3Q0(n,0,t)},$2LZ:function(n){_a.$3.$K(n,"tx");_e.$y.$5fv(n,this.$3D,this.get_$iW().get_$1N(),null)},$3Q0:function(n,t,i){_a.$3.$K(n,"tx");var r=$79C(this,_e.$1n.$7s);$79D(this,r,t);r.Metadata=this.$AB6(r.Data);$79E(this,r);var u=n.$Dv(this.get_$iW().get_$1N());var f=this;u.$9ky(this.$3D.$3Vx(),r,function(n){_e.$1g.$AHa(_a.$qe,_e.$1l.$3wg(n),i)},null)},$1E2:function(n,t,i,r,u){_a.$3.$K(n,"store");_a.$3.$K(i,"data");_a.$3.$K(t,"id");_a.$3.$1G(r,"sourceTimeZoneId");_a.$3.$1G(u,"destinationTimeZoneId");this.$6j=n;this.$3D=t;this.$z=i;this.$7s=u}};_e.$uN=function(){_e.$uN.$$(this.$$gta["_e.$uN"].R).initializeBase(this)};_e.$uN.$$=function(n){var t="$uN"+"$1"+"$"+n.getName().replace(/\./g,"_");if(!_e[t]){var r=_e[t]=function(){(this.$$gta=this.$$gta||{})["_e.$uN"]={R:n};for(var i=[],t=0;t<arguments.length;++t)i[t]=arguments[t];_e.$uN.apply(this,i)};r.registerClass("_e."+t,_e.$y,_bc.$rP.$$(n),_bc.$19G);var u=_e.$uN.prototype;for(var f in u){var i={key:f,value:u[f]};"constructor"!==i.key&&(r.prototype[i.key]=i.value)}}return _e[t]};_e.$uN.prototype={get_$1r:function(){return this.$z},$AB5:function(n){return this.$7xR(n)},$AB6:function(n){return this.$7xV(n)},$6mo:function(n){this.$AEy(n)},$AB4:function(n,t,i){this.$5Gq(n,t,i)},$1E2:function(n,t,i,r,u){_e.$y.prototype.$1E2.call(this,n,t,i,r,u);this.$5Gq(this.get_$1r(),r,u)},$5Gq:function(n,t,i){var u=this.$$gta["_e.$uN"].R;var f="changeTimeZone";var r=u[f];$5(r)||r(n,t,i,this.$6j.get_$Tt())}};_e.$Aa=function(){_e.$Aa.initializeBase(this)};_e.$Aa.$14j=function(n,t,i,r,u,f){_a.$3.$K(n,"reminderItemStore");_a.$3.$K(u,"successCallback");_a.$3.$85(t,_e.$Aa.$6EJ,_e.$Aa.$3AJ,"maxRemindersToReturn");_a.$3.$1G(r,"endTime");_js.$8.$a(i)&&(i=_a.$7.$Ex(new _a.$7(0,1,1)));if(_a.$7.$3x(i).$2U(_a.$7.$3x(r))>0)throw Error.argumentOutOfRange("beginTime","beginTime is greater than endTime");t||(t=_e.$Aa.$3AJ);var e=[];n.$Bl(new _a.$6i("ReminderItem.GetReminders"),function(u){var s=u.$Dv(_e.$1G.get_$I().$1Um.get_$1N());var o=_e.$Aa.$4Vx;var h=new _a.$YQ(o,n.$30G(i),n.$30G(r),0);var c=new _a.$8P(h,[new _a.$If(o,0)]);s.$JP(c,function(i){i.$Ds(t,function(t,i,r){for(var u=0;u<i.length;++u)Array.add(e,n.$14V(i[u]))},_e.$1g.$aG(f))},_e.$1g.$aG(f))},function(){u(e)},_e.$1g.$aG(f))};_e.$Aa.prototype={get_$iW:function(){return _e.$1G.get_$I().$1Um},$AEy:function(n){_a.$3.$K(n.ItemId,"ReminderType.ItemId");_a.$3.$K(n.UID,"ReminderType.UID");_a.$3.$1G(n.ItemId.Id,"ReminderType.ItemId.Id");_a.$3.$1G(n.ReminderTime,"ReminderType.ReminderTime")},$7xR:function(n){return _e.$1l.$5h(n.ItemId.Id)},$7xV:function(n){return new ItemMetadata}};_e.$1l=function(n){this.$3D=new _a.$OK(n)};_e.$1l.$5h=function(n){_a.$3.$1G(n,"id");return new _e.$1l(n)};_e.$1l.$5Va=function(n){return new _e.$1l(n)};_e.$1l.$6Fh=function(){return new _e.$1l(null)};_e.$1l.$3wg=function(n){return new _e.$1l(n.$Tv())};_e.$1l.prototype={$3D:null,get_$1fW:function(){return this.$3D.$Tv()},$3Vx:function(){return this.$3D},toString:function(){return this.$3D.toString()}};_e.$Gl=function(){_e.$Gl.initializeBase(this)};_e.$Gl.$45N=function(n){_a.$3.$K(n,"actionRecord");_a.$3.$K(n.request,"actionRecord.Request");return!!n.request.actionContext&&!$5(n.request.actionContext.shouldPrecedeOfflineSyncActions)&&n.request.actionContext.shouldPrecedeOfflineSyncActions};_e.$Gl.prototype={get_$iW:function(){return _e.$1G.get_$I().$127},$7xR:function(n){return n.id?_e.$1l.$5Va(n.id):_e.$1l.$6Fh()},$7xV:function(n){return new ActionItemMetadata(_e.$Gl.$45N(n))},$AEy:function(n){},$1E2:function(n,t,i,r,u){var f=i;if(f.request.actionHandler){_js.Trace.logWarning(_a.$0.$Zt,"An ActionItem with id={0} has an ActionHandler.  It is being removed.",t.get_$1fW());f=_0365f.$2d.$3g(f,!0);f.request.actionHandler=null}_e.$uN.prototype.$1E2.call(this,n,t,f,r,u)}};function ActionItemMetadata(n){ActionItemMetadata.initializeBase(this);this.IsHighPriority=n.toString()}ActionItemMetadata.$45O=function(){return new _a.$4w("Metadata.IsHighPriority")};ActionItemMetadata.prototype={IsHighPriority:null};_e.$6w=function(){};_e.$6w.$7k8=function(n,t){var i=new AddressbookOperation;i.Type=n;i.PersonaId=t;return i};_e.$6w.$7lX=function(n){var t=_e.$6w.$5Lp(n);_e.$6w.$5T8(n,t,!0);return t};_e.$6w.$7k9=function(n){var t=_e.$6w.$5Lp(n);_e.$6w.$5T8(n,t,!1);return t};_e.$6w.$5AX=function(n){_a.$3.$K(n,"persona");_a.$3.$K(n.PersonaId,"persona.PersonaId");_a.$3.$1G(n.PersonaId.Id,"persona.PersonaId.Id");return n.PersonaId.Id};_e.$6w.$5Lp=function(n){_a.$3.$K(n,"persona");var t=new AddressbookPersona;t.PersonaId=_e.$6w.$5AX(n);$5(n.GivenName)||(t.FirstName=n.GivenName);$5(n.YomiFirstName)||(t.YomiFirstName=n.YomiFirstName);$5(n.MiddleName)||(t.MiddleName=n.MiddleName);$5(n.Surname)||(t.LastName=n.Surname);$5(n.YomiLastName)||(t.YomiLastName=n.YomiLastName);$5(n.DisplayNamePrefix)||(t.NamePrefix=n.DisplayNamePrefix);$5(n.Generation)||(t.NameSuffix=n.Generation);$5(n.Nickname)||(t.Nickname=n.Nickname);$5(n.DisplayName)||(t.DisplayName=n.DisplayName);$5(n.CompanyName)||(t.CompanyName=n.CompanyName);return t};_e.$6w.$5T8=function(n,t,i){var r=_e.$6w.$81K(n.AttributionsArray);var u=_e.$6w.$AHU(_g.$Bm,[n.Emails1Array,n.Emails2Array,n.Emails3Array],r,_e.$6w.$7xW,["PersonaEmails1","PersonaEmails2","PersonaEmails3"],i);u.length>0&&(t.Emails=u);var f=_e.$6w.$AHU(_g.$5H,[n.BusinessPhoneNumbersArray,n.BusinessPhoneNumbers2Array],r,_e.$6w.$3v6,["PersonaBusinessPhoneNumbers","PersonaBusinessPhoneNumbers2"],i);f.length>0&&(t.BusinessPhoneNumbers=f);var e=_e.$6w.$AHU(_g.$5H,[n.HomePhonesArray,n.HomePhones2Array],r,_e.$6w.$3v6,["PersonaHomePhones","PersonaHomePhones2"],i);e.length>0&&(t.HomePhoneNumbers=e);var o=_e.$6w.$AHU(_g.$5H,[n.MobilePhonesArray,n.CarPhonesArray],r,_e.$6w.$3v6,["PersonaMobilePhones","PersonaCarPhones"],i);o.length>0&&(t.MobilePhoneNumbers=o);var s=_e.$6w.$AHU(_g.$E4,[n.BusinessAddressesArray],r,_e.$6w.$3v7,["PersonaBusinessAddresses"],i);s.length>0&&(t.BusinessPostalAddresses=s);var h=_e.$6w.$AHU(_g.$E4,[n.HomeAddressesArray],r,_e.$6w.$3v7,["PersonaHomeAddresses"],i);h.length>0&&(t.HomePostalAddresses=h);var c=_e.$6w.$AHU(_g.$E4,[n.OtherAddressesArray],r,_e.$6w.$3v7,["PersonaOtherAddresses"],i);c.length>0&&(t.OtherPostalAddresses=c)};_e.$6w.$81K=function(n){var t=new(_0365f.$n.$$(String));if(!n)return t;for(var i=0;i<n.length;i++){var r=n[i];(r.DisplayName==="Facebook"||r.DisplayName==="LinkedIn")&&t.$D(r.Id)}return t};_e.$6w.$AHU=function(n,t,i,r,u,f){for(var h=[],e=0,c,l=t,p=l.length,o=0;o<p;++o){var a=l[o];c={};if($5(a)){e++;continue}for(var v=a,w=v.length,s=0;s<w;++s){var y=v[s];$5(y)||r(y,h,u[e],c,i,f)}e++}return h};_e.$6w.$7xW=function(n,t,i,r,u,f){if(!$5(n.Value)&&!_js.$8.$15(n.Value.EmailAddress))for(var s=0;s<n.Attributions.length;s++){var o=_g.$2R.$xn(n.Value);if(!u.$76(n.Attributions[s])&&!(o in r)){r[o]=!0;if(f){var e=new AddressbookEmailAddressInfo;e.EmailAddress=o;e.EmailAddressProperty=new AddressbookItemMetaData;e.EmailAddressProperty.OldValue=o;e.EmailAddressProperty.PropertyUriEnum=i;e.EmailAddressProperty.$3p=n.Attributions;t[t.length]=e;break}else{t[t.length]=o;break}}}};_e.$6w.$3v6=function(n,t,i,r,u,f){if(!$5(n.Value)&&!_js.$8.$15(n.Value.Number))for(var s=0;s<n.Attributions.length;s++){var o=n.Value.Number;if(!u.$76(n.Attributions[s])&&!(o in r)){r[o]=!0;if(f){var e=new AddressbookPhoneNumberInfo;e.PhoneNumber=o;e.PhoneNumberProperty=new AddressbookItemMetaData;e.PhoneNumberProperty.OldValue=o;e.PhoneNumberProperty.PropertyUriEnum=i;e.PhoneNumberProperty.$3p=n.Attributions;t[t.length]=e;break}else{t[t.length]=o;break}}}};_e.$6w.$3v7=function(n,t,i,r,u,f){if(!$5(n.Value)){var e=new AddressbookPostalAddress;var o=n.Value;_js.$8.$15(o.State)||(e.State=o.State);_js.$8.$15(o.City)||(e.City=o.City);_js.$8.$15(o.Street)||(e.Street=o.Street);_js.$8.$15(o.Country)||(e.Country=o.Country);_js.$8.$15(o.PostalCode)||(e.PostalCode=o.PostalCode);var h=_g.$OY.$3nN(e.Street,e.City,e.State,e.PostalCode,e.Country);if(!(h in r)){r[h]=!0;if(f){var s=new AddressbookPostalAddressInfo;s.PostalAddress=e;s.PostalAddressProperty=new AddressbookItemMetaData;s.PostalAddressProperty.OldValue=h;s.PostalAddressProperty.PropertyUriEnum=i;s.PostalAddressProperty.$3p=n.Attributions;t[t.length]=s}else t[t.length]=e}}};_e.$12o=function(){_e.$12o.initializeBase(this)};_e.$12o.prototype={get_$iW:function(){return _e.$1G.get_$I().$2Gy},$7xR:function(n){return _e.$1l.$6Fh()},$7xV:function(n){return new ItemMetadata},$AEy:function(n){_a.$3.$m(n,"data");_a.$3.$1G(n.PersonaId,"data.PersonaId");_a.$3.$m(n.Type,"data.Type");_a.$3.$pj(n.Type,0,"data.Type is invalid")}};_e.$12p=function(){_e.$12p.initializeBase(this)};_e.$12p.prototype={get_$iW:function(){return _e.$1G.get_$I().$2Gz},$7xR:function(n){return _e.$1l.$5h(n.PersonaId)},$7xV:function(n){return new ItemMetadata},$AEy:function(n){_a.$3.$m(n,"data");_a.$3.$1G(n.PersonaId,"data.PersonaId")}};_e.$Oy=function(){};function $3bq(n,t,i,r,u,f){_js.$8.$a(t.PersonaId.Id)||n.$9kB(t,i,r,u,f)}function $773(n,t){if(_js.$8.$a(t.PersonaId.Id))return!1;for(var u=_g.$28.$BJ("contacts").Id,r=t.FolderIds,f=r.length,i=0;i<f;++i){var e=r[i];if(e.Id===u)return!0}return!1}_e.$Oy.prototype={$9Yo:function(n,t,i,r){_a.$3.$K(i,"addressbookOperationItemStore");_a.$3.$K(r,"addressbookPersonaItemStore");$773(this,n)?$3bq(this,n,t,i,r,1):$3bq(this,n,t,i,r,2)},$6Ix:function(n,t,i,r){_a.$3.$K(i,"addressbookOperationItemStore");_a.$3.$K(r,"addressbookPersonaItemStore");$3bq(this,n,t,i,r,2)},$9kB:function(n,t,i,r,u){var f=_e.$6w.$7k8(u,n.PersonaId.Id);var e=i.$rP(f);e.$E1(t,null);if(u===2)r.$II(t,_e.$1l.$5h(_e.$6w.$5AX(n)));else{var o=_e.$6w.$7k9(n);var s=r.$rP(o);s.$E1(t,null)}}};_e.$pO=function(n,t,i,r,u,f){this.$$d_$17a=Function.createDelegate(this,this.$17a);this.$$d_$5bD=Function.createDelegate(this,this.$5bD);_a.$3.$K(n,"clientStore");_a.$3.$K(t,"getter");_a.$3.$1G(i,"timeZoneId");_a.$3.$K(u,"eventAggregator");this.$7b=n;this.$5Zz=t;this.$7s=i;this.$4dx=r;this.$J=u;this.$1Nh=f};_e.$pO.$$=function(n){var t="$pO"+"$1"+"$"+n.getName().replace(/\./g,"_");if(!_e[t]){var r=_e[t]=function(){(this.$$gta=this.$$gta||{})["_e.$pO"]={TItem:n};for(var i=[],t=0;t<arguments.length;++t)i[t]=arguments[t];_e.$pO.apply(this,i)};r.registerClass("_e."+t,null,_a.$18p);var u=_e.$pO.prototype;for(var f in u){var i={key:f,value:u[f]};"constructor"!==i.key&&(r.prototype[i.key]=i.value)}}return _e[t]};_e.$pO.prototype={$7b:null,$5Zz:null,$7s:null,$4dx:!1,$J:null,$1Nh:0,$1uu:null,$HK:null,get_$4dg:function(){return this.$7b},get_$3Vd:function(){return this.$7s},$Hd:function(){_js.Trace.logInfo(_a.$0.$QX,"Subscribing to {0} DB notification handler callback",this.get_$vB());this.$7b.get_$13M().$Hd(this.get_$vB(),this.$$d_$5bD);this.$A58()},$11q:function(){_js.Trace.logInfo(_a.$0.$QX,"Unsubscribing from {0} DB notification handler callback",this.get_$vB());this.$7b.get_$13M().$11q(this.get_$vB());this.$AB3()},$7xk:function(n){return n},$9yp:function(n,t){return!1},$AHZ:function(n){return this.$1uu[n.toString()]},$5bD:function(n,t,i){_a.$3.$1G(n,"objectStoreName");_a.$3.$K(t,"notificationData");_js.Trace.logInfo(_a.$0.$QX,"{0} offline store genereated notification. Add Event Count: {1}. Update Event Count: {2}. Delete Event Count: {3}",this.get_$vB(),t.get_$lz().length,t.get_$mU().length,t.get_$13W().length);var r=this.$7xk(t);if(r.get_$5ca()){this.$J.$9lH(_a.$bl,new _a.$bl(this.$1Nh));this.$9yp(i,r)&&this.$5W4(i,r);this.$4bF_0(i)&&this.$80m(r)}this.$5HS()},$4bF_0:function(n){return!n||n.$2zU},$5W4:function(n,t){_js.Trace.logInfo(_a.$0.$QX,"{0} raise DbTransactionItemInfoEvent SyncInitiatorId: {1}.",this.get_$vB(),n.$1WW);var i=new _a.$jm(n.$1WW,t.get_$lz(),t.get_$mU());this.$J.$9lH(_a.$jm,i)},$A58:function(){if(this.$4dx&&!this.$HK){_js.Trace.logInfo(_a.$0.$QX,String.format("Subscribed to delete observation for store : {0}",this.get_$vB()));this.$HK=this.$30F(this.$5Zz);this.$1uu={};this.$HK.add_$6mm(this.$$d_$17a)}},$AB3:function(){_js.Trace.logInfo(_a.$0.$QX,String.format("Unsubscribed to delete observation for store : {0}",this.get_$vB()));this.$4dx&&this.$HK&&this.$HK.remove_$6mm(this.$$d_$17a);this.$5HS()},$17a:function(n,t){if(this.$4bF_0(t.get_$Bl().get_$1KE())){var i=t.get_$3o();var r=this;n.$1oq(t.get_$Bl(),i,function(n){n&&(r.$1uu[i.toString()]=n)},null)}},$5HS:function(){this.$1uu&&_0365f.$5F.$C(this.$1uu)>0&&(this.$1uu={})}};_e.$TC=function(n,t,i,r){_e.$TC.initializeBase(this,[n,t,i,!0,r,2])};function $3bv(n,t,i){for(var e=i,h=e.length,u=0;u<h;++u){var f=e[u];var r=null;var o="";if(t==="RowDeleted"){var s=n.$AHZ(f.$3D);if(!s){_js.Trace.logInfo(_a.$0.$QX,String.format("Calendar item not present in client store with id: {0}",f.$3D.toString()));return}r=s.get_$1r()}else{var c=f.$27;r=c.Data;_g.$6Y.changeTimeZone(r,_e.$1n.$7s,n.get_$3Vd(),n.get_$4dg().get_$Tt())}o=r.ParentFolderId.Id;_e.$2r.$80T(t,o,r)}}_e.$TC.prototype={get_$vB:function(){return _e.$1G.get_$I().$wQ.get_$1N()},$80m:function(n){$3bv(this,"RowAdded",n.get_$lz());$3bv(this,"RowModified",n.get_$mU());$3bv(this,"RowDeleted",n.get_$13W())},$9yp:function(n,t){return!!n&&n.$1x8},$30F:function(n){return n.get_$1c()}};_e.$cl=function(n,t,i,r){_e.$cl.initializeBase(this,[n,t,i,!1,r,0])};function $4u5(n,t){for(var u=t,f=u.length,r=0;r<f;++r){var e=u[r];var o=e.$27;var i=o.Data;_e.$2r.$2zS(i.FolderId.Id,i.ParentFolderId.Id,"RowModified","clientStore",i.TotalCount,i.UnreadCount,n.get_$2fx())}}_e.$cl.prototype={get_$vB:function(){return _e.$1G.get_$I().$14J.get_$1N()},get_$2fx:function(){return!1},$80m:function(n){$4u5(this,n.get_$lz());$4u5(this,n.get_$mU())},$30F:function(n){return n.get_$2r()}};_e.$tH=function(n,t,i,r){_e.$tH.initializeBase(this,[n,t,i,!1,r,1])};_e.$tH.$4bF=function(n){return n.get_$lz().length>0||n.get_$mU().length>0||n.get_$13W().length>0};_e.$tH.prototype={get_$vB:function(){return _e.$1G.get_$I().$1Um.get_$1N()},get_$2fx:function(){return!0},$80m:function(n){_e.$tH.$4bF(n)&&_e.$2r.$2O0(this.get_$2fx())},$30F:function(n){return n.get_$Iq()}};_e.$64=function(){_e.$64.initializeBase(this)};_e.$64.$1OJ=function(n){return _e.$64.$5T9(n.ItemId)};_e.$64.$5T9=function(n){return _e.$1l.$5h(n.Id)};_e.$64.$7cx=function(n,t,i,r){_a.$3.$K(n,"tx");_a.$3.$K(t,"calendarItemStore");_a.$3.$K(i,"uid");var u=new _a.$8o(_e.$64.$19v,i);var f=[new _a.$If(_a.$4w.$3D,0)];var e=new _a.$8P(u,f);_e.$y.$6UN(_e.$64,n,e,52,function(n,u,f,e){_js.Trace.logInfo(_e.$64.$A,"BindMultipleByUidIn - Uid:{0}, Query results:{1}",i,f.length);for(var o=0;o<f.length;o++){var s=t.$14V(f[o]);r(s,!!(e&o===f.length-1))}},null)};_e.$64.$5Ev=function(n){var t=_a.$7.$3x(n.Start);var i=_a.$7.$3x(n.End);return Math.floor(i.$5u(t)/36e5)};function $4ta(n){var r=n.get_$1X7();var i=n.get_$y();var t=_a.$7.$3x(i);if(r>0){t=t.$4D().$2w(r);i=_a.$7.$Ex(t)}n.$3hh=i;n.$3hj=t}_e.$64.prototype={$2wz:0,$3hh:null,$3hj:null,get_$28:function(){return this.get_$1r().ParentFolderId.Id},get_$y:function(){return this.get_$1r().Start},get_$3hi:function(){this.$3hh||$4ta(this);return this.$3hh},get_$5Ax:function(){this.$3hj||$4ta(this);return this.$3hj},get_$Ao:function(){return this.$2wz>24},get_$5n6:function(){return this.get_$Ao()?Math.ceil(this.$2wz/24):1},get_$19u:function(){return this.get_$1r().UID},get_$20:function(){return this.get_$1r().End},get_$1X7:function(){return this.get_$1r().unfoldedIndex},get_$5R:function(){return this.get_$1r().IsAllDayEvent},get_$5Qn:function(){return this.$2wz},get_$iW:function(){return _e.$1G.get_$I().$wQ},$AEy:function(n){_a.$3.$K(n.ItemId,"ItemId");_a.$3.$K(n.ParentFolderId,"ParentFolderId");_a.$3.$K(n.UID,"UID");_a.$3.$1G(n.ItemId.Id,"ItemId.Id");_a.$3.$1G(n.ParentFolderId.Id,"ParentFolderId.Id");_a.$3.$1G(n.Start,"Start");_a.$3.$1G(n.End,"End")},$7xR:function(n){return _e.$64.$1OJ(n)},$1E2:function(n,t,i,r,u){this.$2wz=_e.$64.$5Ev(i);_e.$uN.prototype.$1E2.call(this,n,t,i,r,u)},$7xV:function(n){return new CalendarItemMetadata(_e.$64.$5Ev(n))}};function CalendarItemMetadata(n){CalendarItemMetadata.initializeBase(this);this.DurationInHours=n}CalendarItemMetadata.prototype={DurationInHours:0};_e.$Dt=function(){_e.$Dt.initializeBase(this)};_e.$Dt.$3k3=function(n,t,i,r){_a.$3.$K(n,"tx");_a.$3.$K(t,"calendarRecurrenceMasterItemStore");_a.$3.$K(i,"uid");_a.$3.$K(r,"successCallback");var u=n.$Dv(_e.$1G.get_$I().$1BM.get_$1N());var f=new _a.$8o(_e.$Dt.$19v,i);var e=new _a.$8P(f,null);u.$JP(e,function(n){n.$Ds(2,function(n,i,u){if(i.length===1)r(t.$14V(i[0]));else{_a.$3.$85(i.length,0,0,"UID should be unique.");r(null)}},null)},null)};_e.$Dt.$1OJ=function(n){return _e.$1l.$5h(n.ItemId.Id)};_e.$Dt.prototype={get_$AAS:function(){return this.get_$1r().UID},get_$iW:function(){return _e.$1G.get_$I().$1BM},$AEy:function(n){_a.$3.$K(n.ItemId,"ItemId");_a.$3.$1G(n.ItemId.Id,"ItemId.Id");_a.$3.$K(n.UID,"UID")},$7xR:function(n){return _e.$Dt.$1OJ(n)},$7xV:function(n){return new ItemMetadata}};_e.$5h=function(n){this.$6j=n};function $4tX(n,t){return new _a.$OB(_e.$64.$2Cj,t,1,0)}function $2lQ(n,t,i,r,u){var f=this;n.$6j.$Bl(new _a.$6i("Calendar.QueryCalendarItemsInTransaction"),function(n){var r=n.$Dv(_e.$1G.get_$I().$wQ.get_$1N());var f=[new _a.$If(_e.$64.$2Cj,0)];var e=new _a.$8P(t,f);r.$JP(e,i,u)},r,u)}function $77D(n,t,i){for(var f=_a.$6.acss(_e.$5h.$A,"FindItems_MergeResults"),u=i,e=u.length,r=0;r<e;++r){var o=u[r];var s=this;_0365f.$FI.$33n(t,o,function(n,t){var i=n.get_$y();var r=t.get_$y();return i.localeCompare(r)})}_a.$6.aces(f);return t}function $77F(n,t,i,r,u,f,e,o){var s=_a.$6.acss(_e.$5h.$A,"ReadCalendarViewShortDurationItems");var h=n.$6j.$30G(r);var c=_a.$7.$3x(h);var l=c.$2Gs(-25);var a=l.$9L();var v=n.$6j.$30G(u);var y=new _a.$YQ(_e.$64.$2Cj,a,v,2);var p=[new _a.$If(_e.$64.$2Cj,0)];var w=new _a.$8P(y,p);var b=new _e.$5h.$9yc(i,r,u);$4tY(n,t,w,b,f,e,o);_a.$6.aces(s)}function $77E(n,t,i,r,u,f,e,o){var s=_a.$6.acss(_e.$5h.$A,"ReadCalendarViewLongDurationItems");var h=new _a.$OB(_e.$64.$2x0,25,1,0);var c=new _a.$8P(h,null);var l=new _e.$5h.$8SL(i,r,u);$4tY(n,t,c,l,f,e,o);_a.$6.aces(s)}function $4tY(n,t,i,r,u,f,e){var o=String.format("ReadCalendarViewItems_{0}",i.$7h.get_$UR().$5t);var s=_a.$6.acsa(_e.$5h.$A,o,!0);var h=this;t.$JP(i,function(t){_a.$6.acea(s);$3bu(n,t,r,u,f,e)},e)}function $3bu(n,t,i,r,u,f){var e=_a.$6.acsa(_e.$5h.$A,"FindItems_ReadCalendarViewQueryResult_",!0);var o=this;t.$Ds(350,function(o,s,h){_js.Trace.logInfo(_e.$5h.$A,"resultSet.Length = "+s.length);if(s.length>0){var c=_a.$6.acss(_e.$5h.$A,"ProcessCalendarViewQueryResult_"+s.length);$3bt(n,s,i,r,u);_a.$6.aces(c)}_a.$6.acea(e);h||$3bu(n,t,i,r,u,f)},f)}function $3bt(n,t,i,r,u){for(var o=_a.$6.acss(_e.$5h.$A,"FindItem_ProcessCalendarViewQueryResult_"+t.length),f=0;f<t.length;f++){var e=$77C(n,t[f],r);i.$8Nv(e)&&Array.add(u,e)}_a.$6.aces(o)}function $77C(n,t,i){var o=t.$27;var u=o.Data;var r=new _g.$6Y;r.ItemId=u.ItemId;for(var s=i.AdditionalProperties,c=s.length,f=0;f<c;++f){var h=s[f];switch(h.FieldURI){case"ItemParentId":r.ParentFolderId=u.ParentFolderId;break;case"Sensitivity":r.Sensitivity=u.Sensitivity;break;case"AppointmentState":r.AppointmentState=u.AppointmentState;break;case"IsCancelled":r.IsCancelled=u.IsCancelled;break;case"IsSeriesCancelled":r.IsSeriesCancelled=u.IsSeriesCancelled;break;case"HasAttachments":r.HasAttachments=u.HasAttachments;break;case"LegacyFreeBusyStatus":r.FreeBusyType=u.FreeBusyType;break;case"CalendarItemType":r.CalendarItemType=u.CalendarItemType;break;case"Start":r.Start=u.Start;r.StartWallClock=u.StartWallClock;r.StartTimeZoneId=u.StartTimeZoneId;break;case"End":r.End=u.End;r.EndWallClock=u.EndWallClock;r.EndTimeZoneId=u.EndTimeZoneId;break;case"MyResponseType":r.ResponseType=u.ResponseType;break;case"IsAllDayEvent":r.IsAllDayEvent=u.IsAllDayEvent;break;case"EnhancedLocation":r.Location=u.Location;break;case"Organizer":r.Organizer=u.Organizer;break;case"AppointmentReplyTime":r.AppointmentReplyTime=u.AppointmentReplyTime;break;case"Subject":r.Subject=u.Subject;break;case"IsMeeting":r.IsMeeting=u.IsMeeting;break;case"UID":r.UID=u.UID;break;case"InstanceKey":r.InstanceKey=u.InstanceKey;break;case"ItemEffectiveRights":r.EffectiveRights=u.EffectiveRights;break;case"JoinOnlineMeetingUrl":r.JoinOnlineMeetingUrl=u.JoinOnlineMeetingUrl;break;case"ConversationId":r.ConversationId=u.ConversationId;break;case"CalendarIsResponseRequested":r.IsResponseRequested=u.IsResponseRequested;break;case"Categories":r.Categories=u.Categories;break;case"IsRecurring":r.IsRecurring=u.IsRecurring;break;case"IsOrganizer":r.IsOrganizer=u.IsOrganizer;break;default:throw Error.invalidOperation(String.format("Invalid calendar shape property URI: {0}",h.FieldURI));}}var e=new PersistedDataRecord;e.Data=r;e.Metadata=o.Metadata;var l=new _a.$g4(t.$3D,e);return n.$6j.$14V(l)}_e.$5h.prototype={$6j:null,$5Wk:function(n,t,i,r,u,f){_a.$3.$K(r,"shape");_a.$3.$KI(r.BaseShape,"IdOnly","shape.BaseShape");var l=this;var e=function(n){_e.$1g.$DN(n,f)};var o=[];var s=[];var h=this,c=this;this.$6j.$Bl(new _a.$6i("Calendar.GetCalendarView"),function(u){var f=u.$Dv(_e.$1G.get_$I().$wQ.get_$1N());$77E(h,f,n,t,i,r,s,e);$77F(h,f,n,t,i,r,o,e)},function(){u($77D(c,o,s))},e)},$85Z:function(n,t,i,r){var e=new _a.$OB(_e.$64.$2x0,24,0,0);var s=this;var u=function(n){_e.$1g.$DN(n,r)};var f=[];var o=this,h=this;$2lQ(this,e,function(i){var r=new _e.$5h.$3lJ(n);$3bu(o,i,r,t,f,u)},function(){i(f)},u)},$81B:function(n,t,i,r,u,f){_a.$3.$K(n,"calendarFolderId");_a.$3.$K(t,"initialDate");_a.$3.$K(r,"shape");_a.$3.$KI(r.BaseShape,"IdOnly","shape.BaseShape");_a.$3.$K(u,"successCallback");var c=this;var e=function(n){_e.$1g.$DN(n,f)};var o=[];var s=0;var h=this,l=this;$2lQ(this,null,function(u){u.$C(function(n){s=n},e);var f=$4tX(h,t);u.$1mJ(0,f,function(t){t&&u.$Ds(i,function(t,i,u){var f=new _e.$5h.$3lJ(n);$3bt(h,i,f,r,o)},e)},e)},function(){u(o,s)},e)},$81A:function(n,t,i,r,u,f){_a.$3.$K(r,"shape");_a.$3.$KI(r.BaseShape,"IdOnly","shape.BaseShape");var c=this;var e=function(n){_e.$1g.$DN(n,f)};var o=[];var s=0;var h=this,l=this;$2lQ(this,null,function(u){u.$C(function(n){s=n},e);u.$1W9(t,function(){u.$Ds(i,function(t,i,u){var f=new _e.$5h.$3lJ(n);$3bt(h,i,f,r,o)},e)},e)},function(){u(o,s)},e)},$9ss:function(n,t,i){_a.$3.$K(n,"date");_a.$3.$K(t,"successCallback");var r=-1;var e=this;var u=function(n){_e.$1g.$DN(n,i)};var f=this,o=this;$2lQ(this,null,function(t){var i=$4tX(f,n);t.$1mJ(0,i,function(n){r=t.get_$JQ()},u)},function(){t(r)},u)}};_e.$5h.$3lJ=function(n){this.$2k=n};_e.$5h.$3lJ.prototype={$2k:null,$8Nv:function(n){return n.get_$28()===this.$2k&&this.$5g7(n)},$5g7:function(n){return!0}};_e.$5h.$AIg=function(n,t,i){_e.$5h.$AIg.initializeBase(this,[n]);this.$5pd=t;this.$5pc=i};_e.$5h.$AIg.prototype={$5pd:null,$5pc:null,$5g7:function(n){return _e.$5h.$3lJ.prototype.$5g7.call(this,n)&&this.$8La(n)},$8La:function(n){var t=n.get_$20().localeCompare(this.$5pd);var i=n.get_$y().localeCompare(this.$5pc);return t>0&&i<0||!t&&n.get_$y()===n.get_$20()}};_e.$5h.$9yc=function(n,t,i){_e.$5h.$9yc.initializeBase(this,[n,t,i])};_e.$5h.$9yc.prototype={$5g7:function(n){return _e.$5h.$AIg.prototype.$5g7.call(this,n)&&n.get_$5Qn()<25}};_e.$5h.$8SL=function(n,t,i){_e.$5h.$8SL.initializeBase(this,[n,t,i])};_e.$5h.$8SL.prototype={$5g7:function(n){return _e.$5h.$AIg.prototype.$5g7.call(this,n)&&n.get_$5Qn()>=25}};_e.$13l=function(n,t,i){_e.$13l.initializeBase(this);_a.$3.$K(n,"calendarRecurrenceMasterItemStore");_a.$3.$K(t,"calendarItemStore");this.$5FW=n;this.$1BL=t;this.$6jY=i};_e.$13l.prototype={$5FW:null,$1BL:null,$6jY:null,$6Qc:function(n){_a.$3.$K(n,"tx");this.$5FW.$qd(n);this.$1BL.$qd(n);this.$6jY.$II(n,_e.$1l.$5h("CalendarSyncState"))}};_e.$ay=function(n,t){_a.$3.$K(n,"calendarItemStore");_a.$3.$K(t,"calendarRecurrenceMasterStore");this.$1BL=n;this.$1sz=t};_e.$ay.$8V=function(n){_a.$3.$K(n,"itemStoreGetter");return new _e.$ay(n.get_$1c(),n.get_$mQ())};_e.$ay.prototype={$1BL:null,$1sz:null,$5Op:function(n,t,i){var r=this;this.$5Ol(n,t,function(t){t?r.$1sz.$2va(n,t.get_$1y(),i):i()})},$5Ol:function(n,t,i){_a.$3.$K(n,"tx");_a.$3.$K(t,"id");var r=this;this.$1sz.$Fu(n,t,function(t){if(t){var u=new _a.$8o(_e.$64.$19v,t.get_$AAS());r.$1BL.$1uq(n,u,function(){_e.$1g.$AHa(_bc.$LD,t,i)})}else _e.$1g.$AHa(_bc.$LD,t,i)},null)}};_e.$TM=function(n){_e.$TM.$$(this.$$gta["_e.$TM"].TItem).initializeBase(this);_a.$3.$K(n,"itemStore");this.$HK=n};_e.$TM.$$=function(n){var t="$TM"+"$1"+"$"+n.getName().replace(/\./g,"_");if(!_e[t]){var r=_e[t]=function(){(this.$$gta=this.$$gta||{})["_e.$TM"]={TItem:n};for(var i=[],t=0;t<arguments.length;++t)i[t]=arguments[t];_e.$TM.apply(this,i)};r.registerClass("_e."+t,_e.$3Z);var u=_e.$TM.prototype;for(var f in u){var i={key:f,value:u[f]};"constructor"!==i.key&&(r.prototype[i.key]=i.value)}}return _e[t]};_e.$TM.prototype={$HK:null,$6Qc:function(n){_a.$3.$K(n,"tx");this.$HK.$qd(n)}};_e.$1n=function(n,t,i,r){this.$3qc="owa_offline_db";this.$5s=new Sys.EventHandlerList;this.$5NO=n;this.$10z=t;this.$5Nj=i;this.$4U=r};function $77S(n,t,i,r){var f=this;var u=function(n){r(new _e.$1g(n).$Sd())};var e=this;t.$9eC(n.$3qc,n.$5NO,function(t){t.get_$36()!==n.$n8().get_$36()?$77V(n,t,function(){n.$3Q9=!0;$4tg(n,t);$4tf(n,i,r)},u):$77W(n,t,function(){$4tg(n,t);$77U(n,i,r)},u)},u)}function $77W(n,t,i,r){for(var f={},h=t.get_$1TX(),e=0;e<h.length;++e)f[h[e]]=null;var u=new(_0365f.$n.$$(_e.$y6));var o=new(_0365f.$n.$$(_e.$y5));$77P(n,t,f,u,o);for(var s=0;s<u.get_$C();++s)delete f[u.get_$3o(s).get_$1N()];var c=$77O(n,f);if(u.get_$C()||o.get_$C()||c.length){n.$3Q9=!0;var l=this;t.$3m8(n.$n8().get_$36(),$4te(n),function(t){$77M(n,t,o);$77N(n,t,u);$77L(n,t,c)},i,r)}else i()}function $4te(n){return _e.$1G.$7e6(n.$n8(),n.$4U)}function $77P(n,t,i,r,u){for(var e=_0365f.$5F.$3g(i),h=n.$n8(),c=n.$n8().get_$1Er(),o=0;o<c.length;++o){var s=c[o];s.get_$1N()in e&&!$77T(n,t,s)&&delete e[s.get_$1N()]}var l=e;for(var a in l){var v={key:a,value:l[a]};var f=h.$87V(v.key);if(f){r.$76(f)||r.$D(f);f.get_$1v3().$3nM(r,u)}else r.$D(new _e.$D0(v.key,"obsolete",new Array(0),new Array(0),_e.$9H.$QV,0,0,!1,new _e.$9D(h)))}}function $77T(n,t,i){var r=!1;t.$85o(i.get_$1N())!==i.get_$36()?r=!0:$77Q(n,t,i)&&(r=!0);return r}function $77Q(n,t,i){for(var s=!1,e=i.get_$1wH(),h=e.length,u=0;u<h;++u){var r=e[u];var o=r.$2N8;var f=n.$4U.$3N(o);var c=Array.indexOf(t.get_$1r7(),o)>=0;if(f!==c)if(!r.$3Nj&&f)return!0;else if(r.$3Nj!==1||f){if(r.$3Nj===2)return!0}else return!0}return s}function $77N(n,t,i){for(var r=0;r<i.get_$C();++r){_js.Trace.logInfo(_e.$1n.$A,"removing object store {0}",i.get_$3o(r).get_$1N());t.$6WB(i.get_$3o(r).get_$1N())}}function $77M(n,t,i){for(var u=0;u<i.get_$C();++u){var r=i.get_$3o(u);_js.Trace.logInfo(_e.$1n.$A,"removing item {0} from store {1}",r.get_$1y().get_$1fW(),r.get_$5nN().get_$1N());t.$D9(r.get_$5nN().get_$1N(),r.get_$1y().$3Vx())}}function $77L(n,t,i){for(var r=0;r<i.length;++r){_js.Trace.logInfo(_e.$1n.$A,"creating object store {0}",i[r].$1k);$4td(n,i[r],t)}}function $77O(n,t){for(var r=[],i=0;i<n.$n8().get_$1Er().length;++i){var u=n.$n8().get_$1Er()[i];u.get_$1N()in t||Array.add(r,u)}return r}function $77V(n,t,i,r){_js.Trace.logInfo(_e.$1n.$A,"Wiping db.  Actual version '{0}' not equal to desired version '{1}'",t.get_$36(),n.$n8().get_$36());var u=this;t.$6q2(function(){_js.Trace.logInfo(_e.$1n.$A,"Now changing the schema of the database.");t.$3m8(n.$n8().get_$36(),$4te(n),function(t){for(var i=0;i<n.$n8().get_$1Er().length;++i)$4td(n,n.$n8().get_$1Er()[i],t)},i,r)},r)}function $77U(n,t,i){var r=_e.$AE.$2Nr(n);var u=this;r.$82l(function(r){if(_js.$8.$a(r))$4tf(n,t,i);else{n.$1yh=r;t()}},i)}function $4tf(n,t,i){n.$1yh=(_a.$7.get_$2F().$5X().toString()+Math.random().toString().substr(2)).substr(0,32);var r=_e.$AE.$2Nr(n);var u=this;$79X(r,n.$1yh,t,function(t){_js.Trace.logError(_e.$1n.$A,"Unexpected error setting the DatabaseId: {0}",t.message);n.$1yh=null;n.$6mN(function(){i(t)},function(n){_js.Trace.logError(_e.$1n.$A,"Failed to uninstall database after failing to set the database Id: {0}",n.message);i(Error.create(t.message+" "+n.message))})})}function $4td(n,t,i){i.$7n7(t.get_$1N(),t.get_$36(),t.get_$8FA()===1,t.get_$7d1());$77J(n,t,i);$77K(n,t,i)}function $77J(n,t,i){for(var u=t.get_$2QS(),e=u.length,r=0;r<e;++r){var f=u[r];i.$5LN(t.get_$1N()+"_"+f.$1k,t.get_$1N(),f.$2ND)}}function $77K(n,t,i){for(var e=t.get_$1wH(),h=e.length,r=0;r<h;++r){var u=e[r];if(n.$4U.$3N(u.$2N8))for(var o=u.$2QR,c=o.length,f=0;f<c;++f){var s=o[f];i.$5LN(t.get_$1N()+"_"+u.$2N8+"_"+s.$1k,t.get_$1N(),s.$2ND)}}}function $4tg(n,t){n.$ig=t;n.$7kW()}function $77R(n){if(n.$ig){n.$1ue&&n.$1ue.$11q(n.$ig);n.$ig.$4hs()}n.$2JY&&n.$2JY.dispose();n.$2JY=null;n.$1ue=null;n.$ig=null;n.$1yh=null;n.set_$g9(!1)}_e.$1n.prototype={$5NO:0,$5Nj:null,$10z:null,$4U:null,$ig:null,$1yh:null,$1ue:null,$43v:!1,$pk:null,$3Q9:!1,$2JY:null,add_$34I:function(n){this.$5s.addHandler("IsAvailable",n)},remove_$34I:function(n){this.$5s.removeHandler("IsAvailable",n)},get_$g9:function(){return this.$43v},set_$g9:function(n){if(n!==this.$43v){this.$43v=n;var t=this.$5s.getHandler("IsAvailable");t&&t(this.$3Q9)}return n},get_$13M:function(){return this.$ig},get_$8F7:function(){return this.$1yh},get_$Tt:function(){return this.get_$7hI()},get_$7hI:function(){this.$pk||(this.$pk=new _a.$9z);return this.$pk},get_$1tT:function(){return this.$2JY},$jM:function(n){return _e.$1l.$5h(n)},$5pW:function(n,t,i,r){var u=this;_e.$Qi.$2Ou(n,t,function(n){for(var r=new Array(n.length),t=0;t<n.length;t++)r[t]=n[t].get_$1r();u.$pk.$33X(r);_e.$1g.$lC(i)},r)},$431:function(n,t){_a.$3.$K(n,"succeededCallback");_a.$3.$K(t,"failedCallback");var r=this.$5Wd();_a.$3.$K(r,"Databases are not supported by this browser. Check UserAgent.OfflineSupported before calling Install.");this.$3Q9=!1;var i=this,u=this;$77S(this,r,function(){i.set_$g9(!0);i.$pk=new _a.$9z;var r=new(_e.$7t.$$(_bc.$kx,_e.$Qi))(i,_e.$1n.$7s);r.$Bl(new _a.$6i("ClientStore.Install.LoadTimeZones"),function(n){var t=n.$Dv(i.$n8().get_$A7u().get_$1N());i.$5pW(r,n,function(){_js.Trace.logInfo(_e.$1n.$A,"The time zone offsets table has been loaded")},function(n){_js.Trace.logError(_e.$1n.$A,"Failed to load the time zone offsets table: {0}",n.get_$4y())})},function(){n()},function(n){var r=Error.create(n.$3j);_js.Trace.logError(_e.$1n.$A,"Unexpected error during ClientStore Install: {0}",r.message);i.$cV();t(r)})},function(n){_js.Trace.logError(_e.$1n.$A,"Unexpected error during ClientStore Install: {0}",n.message);u.$cV();t(n)})},$6mN:function(n,t){_a.$3.$K(n,"succeededCallback");_a.$3.$K(t,"failedCallback");var i=this.$5Wd();if(this.$ig){this.$ig.$4O();this.$ig=null}var r=this,u=this;i.$7qm(this.$3qc,function(){r.$cV();n()},function(n){_js.Trace.logError(_e.$1n.$A,"Unexpected error during ClientStore Uninstall: {0}",n.$3j);t(new _e.$1g(n).$Sd())})},$cV:function(){_js.Trace.logInfo(_e.$1n.$A,"Disposing the current database, without wiping data.");$77R(this)},$A4z:function(n,t){_a.$3.$1G(n,"timezoneId");_a.$3.$K(t,"eventAggregator");if(!this.$1ue){this.$1ue=new _e.$FJ(t);this.$1ue.$Hd(this,n)}},$5Wd:function(){return this.$5Nj},$n8:function(){return this.$10z},$7kW:function(){this.$2JY=new _e.$TO(this.$n8().get_$7dv(),this.$ig)}};_e.$TO=function(n,t){this.$$d_$1jV=Function.createDelegate(this,this.$1jV);this.$$d_$17a=Function.createDelegate(this,this.$17a);this.$$d_$1jU=Function.createDelegate(this,this.$1jU);this.$$d_$5bD=Function.createDelegate(this,this.$5bD);_e.$TO.resolveInheritance();this.dispose=this.$1R;_e.$TO.initializeBase(this);this.$1BI={};this.$ig=t;this.$12f=n;$77X(this)};function $77X(n){n.$4dj=new Array(n.$12f.length);for(var t=0;t<n.$12f.length;t++){var i=n.$12f[t];n.$1BI[i]={};_js.Trace.logInfo(_a.$0.$1tT,"Subscribing DB notification and observer to store {0}",i);n.$ig.$Hd(i,n.$$d_$5bD);var r=n.$ig.$5Lm(i);n.$4dj[t]=r;r.add_$1jU(n.$$d_$1jU);r.add_$17a(n.$$d_$17a);r.add_$1jV(n.$$d_$1jV)}}function $4th(n,t,i,r){for(var f=i,o=f.length,u=0;u<o;++u){var e=f[u];t[e.$3D.toString()]=e.$27.Data}}_e.$TO.prototype={$12f:null,$1BI:null,$4dj:null,$ig:null,$49:function(){for(var n=0;n<this.$12f.length;n++){var i=this.$12f[n];this.$ig.$11q(i);var t=this.$4dj[n];t.remove_$1jU(this.$$d_$1jU);t.remove_$17a(this.$$d_$17a);t.remove_$1jV(this.$$d_$1jV);delete this.$1BI[i]}},$3c:function(n,t){var i=null;var r=this.$1BI[n];r&&(i=r[t]);return i},$2fK:function(n,t,i){var r=this.$1BI[n];r&&(r[t]=i)},$1jV:function(n,t){var i=n.$Zb;var r=this.$1BI[i];delete r[t.get_$1y().toString()]},$17a:function(n,t){var i=n.$Zb;var r=this.$1BI[i];delete r[t.get_$1y().toString()]},$1jU:function(n,t){_js.Trace.logInfo(_a.$0.$1tT,"Clearing cache: {0}, count: {2}",n.$Zb);this.$1BI[n.$Zb]={}},$5bD:function(n,t,i){var r=this.$1BI[n];$4th(this,r,t.get_$lz(),n);$4th(this,r,t.get_$mU(),n)}};_e.$1g=function(n){this.$9S=this.toString;this.$1sc=n;if(n.$Vs===3){_js.Trace.logWarning(_e.$1n.$A,"QuotaError handled.");var t=_e.$1g.$3NU.getHandler(_a.$X2.toString(3));$5(t)||t()}};_e.$1g.add_$4Py=function(n){_e.$1g.$7Ye(n)};_e.$1g.remove_$4Py=function(n){_e.$1g.$6WH(n)};_e.$1g.$AHa=function(n,t,i){i&&i(t)};_e.$1g.$lC=function(n){n&&n()};_e.$1g.$DN=function(n,t){var i=new _e.$1g(n);t&&t(i)};_e.$1g.$5Kk=function(n){return function(t){n(t.$Sd())}};_e.$1g.$aG=function(n){return function(t){_e.$1g.$DN(t,n)}};_e.$1g.$7Ye=function(n){_e.$1g.$3NU.addHandler(_a.$X2.toString(3),n)};_e.$1g.$6WH=function(n){_e.$1g.$3NU.removeHandler(_a.$X2.toString(3),n)};_e.$1g.prototype={$1sc:null,get_$4y:function(){return this.$1sc.$3j},get_$8Ol:function(){return this.$1sc.$Vs===4},get_$8Na:function(){return this.$1sc.$Vs===3},$Sd:function(){var n=this;n.__type="clientStoreError";n.isTransientError=this.$1sc.$Vs===4||this.$1sc.$Vs===3;return Error.create(this.get_$4y(),n)},toString:function(){return this.get_$4y()}};_e.$M2=function(){_e.$M2.initializeBase(this)};_e.$M2.$3v5=function(n){_a.$3.$K(n,"id");_a.$3.$1G(n.Id,"id.Id");return _e.$1l.$5h(n.Id)};_e.$M2.$5Gn=function(n,t,i,r){_g.$D7.changeTimeZone(n,t,i,r)};_e.$M2.prototype={get_$iW:function(){return _e.$1G.get_$I().$1aD},$7xR:function(n){return _e.$M2.$3v5(n.PersonaId)},$7xV:function(n){return new ItemMetadata},$AEy:function(n){_a.$3.$K(n.PersonaId,"PersonaId");_a.$3.$1G(n.PersonaId.Id,"PersonaId.Id")},$5Gq:function(n,t,i){_e.$M2.$5Gn(n,t,i,this.$6j.get_$Tt())}};_e.$14g=function(n,t,i,r){_e.$14g.initializeBase(this,[n,t,i,!1,r,6])};_e.$14g.prototype={get_$vB:function(){return _e.$1G.get_$I().$iY.get_$1N()},$80m:function(n){},$30F:function(n){return n.get_$Jl()}};_e.$RA=function(n,t){_e.$RA.initializeBase(this,[n,t])};_e.$RA.$3yd=function(n,t){var i;i=t==="Clutter"?new _a.$8o(ConversationItemMetadata.$1Ts(),_e.$7q.$E(n,!0)):t==="NoClutter"?new _a.$8o(ConversationItemMetadata.$1Ts(),_e.$7q.$E(n,!1)):new _a.$8o(ConversationItemMetadata.$1Tt(),n);return i};_e.$RA.prototype={$3nr:null,get_$vB:function(){return _e.$1G.get_$I().$iY.get_$1N()},$2va:function(n,t,i){this.$5fu(n,t,!0,i)},$7rY:function(n,t){for(var r=t,u=r.length,i=0;i<u;++i){var f=r[i];this.$5fu(n,f,!1,null)}},$4iS:function(n,t,i){_e.$6s.$4iS(n,this,t,i)},$5X0:function(n,t,i,r,u,f){_a.$3.$K(n,"folderId");_a.$3.$K(t,"request");_a.$3.$K(i,"actionContext");_a.$3.$K(r,"conversationViewData");_a.$3.$K(u,"successCallback");this.$3nr=r;var e=this;_e.$eP.prototype.$AIf.call(this,t.Paging,_e.$6s.get_$33p(),function(){var i=_e.$RA.$3yd(n,t.ClutterFilter);return new _a.$8P(i,[new _a.$If(ConversationItemMetadata.$2Ts(),1)])},u,f)},$5a4:function(n,t){t(this.$3nr.TotalConversationsInView)},$4UU:function(n,t){_js.Trace.logInfo(_e.$1n.$A,"GetItems: Processing {0} query results",n.length);for(var r=this.$5Zi(this.$3nr.OldestDeliveryTime),e=_a.$7.$3x(r).$5X(),i=0;i<n.length;++i){var u=this.$14V(n[i]);var f=u.get_$1r();var o=_a.$7.$3x(f.LastDeliveryTime).$5X();if(o>=e)Array.add(t,f);else{_js.Trace.logInfo(_e.$1n.$A,"Ignoring items outside the sync window, lastDeliveryTime = {0}, oldestLastDeliveryTime = {1}",u.get_$1r().LastDeliveryTime,r);break}}},$5fu:function(n,t,i,r){_a.$3.$K(n,"tx");_a.$3.$K(t,"id");if(i){var u=this;this.$Fu(n,t,function(i){if(i){var f=i.get_$1r();var e=new _e.$12E(u.get_$4dg(),u.get_$3Vd());var o=TombstonedItemRecord.$E(f.ConversationId.Id,"ConversationItem",null);var s=e.$rP(o);s.$E1(n,null)}_e.$7t.prototype.$2va.call(u,n,t,r)},null)}else _e.$7t.prototype.$2va.call(this,n,t,r)}};_e.$wA=function(n,t){_e.$wA.initializeBase(this,[n,"ConversationNodeSyncStateId"]);_a.$3.$85(t,0,10,"maxDirtyConversationsToGet");this.get_$c8().$5ra=t};_e.$wA.prototype={$7oN:function(n){return new _e.$bK(this.$9B.get_$pd(),this.$9B.get_$Jl(),this.$9B.get_$Hi())}};_e.$1G=function(){this.$14J=$77h(this);this.$1WY=$77p(this);this.$iY=$77g(this);this.$2Dm=$77r(this);this.$2K3=$77f(this);this.$zC=$77j(this);this.$1Tn=$77k(this);this.$127=$77Y(this);this.$1Tw=$77l(this);this.$1aD=$77e(this);this.$wQ=$77c(this);this.$1BM=$77d(this);this.$2Gy=$77Z(this);this.$2Gz=$77a(this);this.$2fj=$77o(this);this.$2be=$77m(this);this.$1Um=$77n(this);this.$1B5=$77b(this);this.$2Dh=$77q(this);this.$2Ql=$77i(this);var n=$122(this,"FolderHierarchySyncStateId");var t=$122(this,"ConversationSyncStateId");var i=$122(this,"MessageSyncStateId");var r=$122(this,"RemindersSyncStateId");var u=$122(this,"PeopleFiltersSyncStateId");var f=$122(this,"PeopleSyncStateId");var e=$122(this,"CalendarSyncState");var o=$122(this,"TimeZoneOffsetsSyncStateId");var h=$122(this,"OwaUserConfigurationSyncStateId");var s=$122(this,"AttachmentsStateId");this.$14J.$MP.$IB(n).$3h9(1);this.$1WY.$MP.$3h9(1);this.$iY.$MP.$IB(t).$f4(this.$2K3).$f4(this.$1B5).$f4(this.$zC).$f4(this.$2Dm);this.$2Dm.$MP.$Wg();this.$2K3.$MP.$f4(this.$iY);this.$zC.$MP.$IB(i).$f4(this.$1B5).$f4(this.$iY).$f4(this.$2Dm);this.$1Tw.$MP.$f4(this.$1aD);this.$1aD.$MP.$IB(f).$f4(this.$1Tw);this.$wQ.$MP.$IB(e).$f4(this.$1BM);this.$1BM.$MP.$f4(this.$wQ);this.$2Gy.$MP.$f4(this.$2Gz);this.$2Gz.$MP.$f4(this.$2Gy);this.$2fj.$MP.$59e();this.$2Dh.$MP.$IB(o).$59e();this.$1B5.$MP.$IB(s).$f4(this.$2Ql);this.$1Um.$MP.$IB(r);this.$2be.$MP.$IB(u);this.$2Ql.$MP.$Wg();this.$1Tn.$MP.$Wg();this.$127.$MP.$Wg();this.$21w=[this.$1WY,this.$14J,this.$iY,this.$2Dm,this.$2K3,this.$zC,this.$1Tn,this.$127,this.$1Tw,this.$1aD,this.$wQ,this.$1BM,this.$2Gy,this.$2Gz,this.$2fj,this.$2be,this.$1Um,this.$1B5,this.$2Dh,this.$2Ql]};_e.$1G.get_$I=function(){return _e.$1G.$w||(_e.$1G.$w=new _e.$1G)};_e.$1G.$7e6=function(n,t){_a.$3.$K(n,"client store schema");_a.$3.$K(t,"flight manager");for(var f={},e=[],o=n.get_$1Er(),h=o.length,r=0;r<h;++r)for(var c=o[r],s=c.get_$1wH(),l=s.length,u=0;u<l;++u){var a=s[u];var i=a.$2N8;if(t.$3N(i)&&!(i in f)){f[i]=null;Array.add(e,i)}}return e};function $77p(n){return new _e.$D0("Sync","15.0.0612.00",null,null,null,0,1,!0,new _e.$9D(n))}function $77h(n){var i=[new _a.$5R(FolderItemMetadata.$1Tt(),0),new _a.$5R(FolderItemMetadata.$2z0(),1)];var r=[new _a.$5R(FolderItemMetadata.$2z0(),1)];var u=[new _a.$5R(FolderItemMetadata.$5QE(),0)];var t=[new _e.$6Z("ParentId",i),new _e.$6Z("FolderPosition",r),new _e.$6Z("DistinguishedFolderId",u)];var f=new _e.$9H("SuperStart",t,2);return new _e.$D0("Folders","15.0.0742.00",t,null,[f],0,1,!1,new _e.$9D(n))}function $77g(n){var t=[new _a.$5R(ConversationItemMetadata.$1Tt(),0),new _a.$5R(ConversationItemMetadata.$2Ts(),0)];var i=[new _a.$5R(ConversationItemMetadata.$1Ts(),0),new _a.$5R(ConversationItemMetadata.$2Ts(),0)];var r=[new _a.$5R(_e.$6s.get_$2w8(),1),new _a.$5R(ConversationItemMetadata.$2Ts(),0)];var u=[new _a.$5R(_e.$6s.get_$2w8(),1)];var f=[new _a.$5R(_e.$6s.get_$3no(),0)];var e=[new _a.$5R(_e.$6s.get_$33p(),0)];var o=[new _e.$6Z("ParentIdDateTimeSort",t),new _e.$6Z("ParentIdAndClutterDateTimeSort",i),new _e.$6Z("DirtyState",r),new _e.$6Z("DirtyStateIndexAloneField",u),new _e.$6Z("ConversationId",f),new _e.$6Z("InstanceKey",e),new _e.$6Z("SaveMode",_e.$1G.$1VH)];return new _e.$D0("Conversations","15.0.0710.00",o,null,null,0,1,!1,new _e.$9D(n))}function $77r(n){var t=[new _a.$5R(_e.$nV.get_$5nO(),0)];var i=[new _e.$6Z("ItemType",t)];return new _e.$D0("TombstonedItems","15.0.0503.00",i,null,_e.$9H.$QV,0,1,!1,new _e.$9D(n))}function $77f(n){var t=[new _e.$6Z("SaveMode",_e.$1G.$1VH)];return new _e.$D0("ConversationNodes","15.0.0760.00",t,null,_e.$9H.$QV,0,1,!1,new _e.$9D(n))}function $77j(n){return $4ti(n,"Messages",1)}function $77k(n){return $4ti(n,"Outbox",0)}function $4ti(n,t,i){_a.$3.$1G("name",t);var r=[new _a.$5R(MessageItemMetadata.$1Tt(),0),new _a.$5R(MessageItemMetadata.$2CX(),0)];var u=[new _a.$5R(MessageItemMetadata.$1Ts(),0),new _a.$5R(MessageItemMetadata.$2CX(),0)];var f=[new _a.$5R(MessageItemMetadata.$5hw(),0),new _a.$5R(MessageItemMetadata.$2CX(),0)];var e=[new _a.$5R(_e.$By.get_$33p(),0)];var o=[new _e.$6Z("DateTime",r),new _e.$6Z("DateTimeAndClutter",u),new _e.$6Z("IsDataSynced",f),new _e.$6Z("InstanceKey",e),new _e.$6Z("SaveMode",_e.$1G.$1VH)];return new _e.$D0(t,"15.0.0710.00",o,null,_e.$9H.$QV,0,i,!1,new _e.$9D(n))}function $77Y(n){var t=[new _a.$5R(_e.$Gl.$2hN,1)];var i=[new _a.$5R(ActionItemMetadata.$45O(),0)];var r=[new _e.$6Z("State",t),new _e.$6Z("IsHighPriority",i)];return new _e.$D0("Actions","15.0.0526.00",r,null,null,1,0,!1,new _e.$9D(n))}function $77l(n){var t=[new _a.$5R(_e.$2U.$3M2,0)];var i=[new _a.$5R(_e.$2U.$1wk,0)];var r=[new _a.$5R(_e.$2U.$1Ck,0)];var u=[new _a.$5R(_e.$2U.$1Nq,0)];var f=[new _a.$5R(_e.$2U.$1wk,0),new _a.$5R(_e.$2U.$1Ck,0)];var e=[new _a.$5R(_e.$2U.$1wk,0),new _a.$5R(_e.$2U.$1Nq,0)];var o=[new _a.$5R(_e.$2U.$2sr,0),new _a.$5R(_e.$2U.$1Ck,0)];var s=[new _a.$5R(_e.$2U.$2sr,0),new _a.$5R(_e.$2U.$1Nq,0)];var h=[new _a.$5R(_e.$2U.$32e,0),new _a.$5R(_e.$2U.$1Ck,0)];var c=[new _a.$5R(_e.$2U.$32e,0),new _a.$5R(_e.$2U.$1Nq,0)];var l=[new _a.$5R(_e.$2U.$3YU,0),new _a.$5R(_e.$2U.$1Ck,0)];var a=[new _a.$5R(_e.$2U.$3YU,0),new _a.$5R(_e.$2U.$1Nq,0)];var v=[new _a.$5R(_e.$2U.$2uF,0),new _a.$5R(_e.$2U.$1Ck,0)];var y=[new _a.$5R(_e.$2U.$2uF,0),new _a.$5R(_e.$2U.$1Nq,0)];var p=[new _a.$5R(_e.$2U.$4Vk,1),new _a.$5R(_e.$2U.$1Ck,0)];var w=[new _a.$5R(_e.$2U.$3sV,0)];var b=[new _a.$5R(_e.$2U.$3sT,0)];var k=[new _e.$6Z("PersonaId",t),new _e.$6Z("FolderId",i),new _e.$6Z("DisplayNameFirstLast",r),new _e.$6Z("DisplayNameLastFirst",u),new _e.$6Z("ActualLastFirst",w),new _e.$6Z("ActualFirstLast",b),new _e.$6Z("CompanyNameFirstLast",o),new _e.$6Z("CompanyNameLastFirst",s),new _e.$6Z("HomeCityFirstLast",h),new _e.$6Z("HomeCityLastFirst",c),new _e.$6Z("WorkCityFirstLast",l),new _e.$6Z("WorkCityLastFirst",a),new _e.$6Z("CreationTimeFirstLast",v),new _e.$6Z("CreationTimeLastFirst",y),new _e.$6Z("RelevanceScoreFirstLast",p),new _e.$6Z("SaveMode",_e.$1G.$1VH),new _e.$6Z("FolderIdDisplayNameFirstLast",f),new _e.$6Z("FolderIdDisplayNameLastFirst",e)];return new _e.$D0("PartialPersona","15.0.0692.00",k,null,null,0,1,!1,new _e.$9D(n))}function $77e(n){var t=[new _e.$6Z("SaveMode",_e.$1G.$1VH)];return new _e.$D0("CompletePersona","15.0.0692.00",t,null,_e.$9H.$QV,0,1,!1,new _e.$9D(n))}function $77c(n){var t=[new _a.$5R(_e.$64.$2Cj,0)];var i=[new _a.$5R(_e.$64.$2x0,1)];var r=[new _a.$5R(_e.$64.$3u1,0)];var u=[new _a.$5R(_e.$64.$19v,0)];var f=[new _e.$6Z("ShortDurationCalendarViewItemsIndices",t),new _e.$6Z("LongDurationCalendarViewItemsIndices",i),new _e.$6Z("PrunningFields",r),new _e.$6Z("RecurrenceIndices",u),new _e.$6Z("SaveMode",_e.$1G.$1VH)];return new _e.$D0("CalendarItem","15.0.0594.00",f,null,_e.$9H.$QV,0,1,!1,new _e.$9D(n))}function $77d(n){var t=[new _a.$5R(_e.$Dt.$19v,0)];var i=[new _e.$6Z("RecurrenceIndices",t),new _e.$6Z("SaveMode",_e.$1G.$1VH)];return new _e.$D0("CalendarRecurrenceMaster","15.0.0594.00",i,null,_e.$9H.$QV,0,1,!1,new _e.$9D(n))}function $77Z(n){return new _e.$D0("AddressbookOperation","15.0.0239.00",null,null,_e.$9H.$QV,1,1,!1,new _e.$9D(n))}function $77a(n){return new _e.$D0("AddressbookPersona","15.0.0239.00",null,null,_e.$9H.$QV,0,1,!1,new _e.$9D(n))}function $77o(n){return new _e.$D0("Settings","15.0.0380.00",null,null,_e.$9H.$QV,0,0,!1,new _e.$9D(n))}function $77m(n){var t=new _a.$4w("Data.SortGroupPriority");var i=[new _a.$5R(t,1)];var r=[new _e.$6Z("sortGroupPriorityIndex",i)];return new _e.$D0("PeopleFilter","15.0.0441.00",r,null,_e.$9H.$QV,0,1,!1,new _e.$9D(n))}function $77b(n){var t=[new _a.$5R(_e.$50.$4C3,0)];var i=[new _a.$5R(_e.$50.$4C5,0)];var r=[new _a.$5R(_e.$50.$3jF,1)];var u=[new _a.$5R(_e.$50.$3jE,1)];var f=[new _a.$5R(_e.$50.$3jE,1),new _a.$5R(_e.$50.$4C5,0)];var e=[new _e.$6Z("messageIdFields",t),new _e.$6Z("messageReceivedDateTimeFields",i),new _e.$6Z("attachmentTypeFields",r),new _e.$6Z("attachmentTypeAndSyncStatusFields",u),new _e.$6Z("attachmentTypeAndSyncStatusByMessageRecievedDateTimeFields",f)];return new _e.$D0("AttachmentInfo","15.0.0557.00",e,null,_e.$9H.$QV,0,1,!1,new _e.$9D(n))}function $77n(n){var t=[new _a.$5R(_e.$Aa.$4Vx,0)];var i=[new _a.$5R(_e.$Aa.$19v,0)];var r=[new _e.$6Z("ReminderTime",t),new _e.$6Z("RecurrenceIndices",i)];return new _e.$D0("Reminders","15.0.0575.00",r,null,_e.$9H.$QV,0,1,!1,new _e.$9D(n))}function $77q(n){return new _e.$D0("TimeZoneOffsets","15.0.0314.00",null,null,_e.$9H.$QV,0,0,!1,new _e.$9D(n))}function $77i(n){return new _e.$D0("InlineImages","15.0.0557.00",null,[_e.$kd.$5E5],_e.$9H.$QV,0,1,!1,new _e.$9D(n))}function $122(n,t){return new _e.$1AG(_e.$1l.$5h(t),n.$1WY,new _e.$9D(n))}_e.$1G.prototype={$21w:null,$12f:null,$14J:null,$1WY:null,$iY:null,$2Dm:null,$2K3:null,$zC:null,$1Tn:null,$127:null,$1Tw:null,$1aD:null,$wQ:null,$1BM:null,$2Gy:null,$2Gz:null,$2fj:null,$2be:null,$1Um:null,$1B5:null,$2Dh:null,$2Ql:null,get_$36:function(){return _e.$1G.$CH},get_$1Er:function(){return this.$21w},get_$7dv:function(){if(!this.$12f){this.$12f=new Array(0);for(var t=this.$21w,r=t.length,n=0;n<r;++n){var i=t[n];i.$5hN&&Array.add(this.$12f,i.$1k)}}return this.$12f},get_$A7u:function(){return this.$2Dh},$87V:function(n){for(var t=0;t<this.$21w.length;++t)if(this.$21w[t].get_$1N().toLowerCase()===n.toLowerCase())return this.$21w[t];return null}};_e.$9D=function(n){this.$2Mv=new(_0365f.$n.$$(_e.$y6));this.$2Mu=new(_0365f.$n.$$(_e.$y5));this.$1y1=new(_0365f.$n.$$(_e.$15X));this.$10z=n;this.$2or=!1};function $77v(n,t,i){if(n.$2or)for(var u=n.$10z.get_$1Er(),f=u.length,r=0;r<f;++r){var e=u[r];$3by(n,e,t,i)}else{$77s(n,t,i);$77t(n,t,i)}}function $77u(n,t,i){for(var r=0;r<n.$2Mu.get_$C();++r){var u=n.$2Mu.get_$3o(r);if(!i.$76(u)){i.$D(u);u.get_$1v3().$3nM(t,i)}}}function $77t(n,t,i){for(var r=0;r<n.$10z.get_$1Er().length;++r){var u=n.$10z.get_$1Er()[r];n.$1y1.$76(u.get_$7rc())&&$3by(n,u,t,i)}}function $77s(n,t,i){for(var r=0;r<n.$2Mv.get_$C();++r){var u=n.$2Mv.get_$3o(r);$3by(n,u,t,i)}}function $3by(n,t,i,r){if(!i.$76(t)){i.$D(t);t.get_$1v3().$3nM(i,r)}}_e.$9D.prototype={$2Mv:null,$2Mu:null,$1y1:null,$10z:null,$2or:!1,$f4:function(n){this.$2Mv.$D(n);return this},$59e:function(){this.$2or=!0;return this},$IB:function(n){this.$2Mu.$D(n);return this},$Wg:function(){this.$2Mu.$1t();this.$2Mv.$1t();this.$1y1.$1t();this.$2or=!1},$3h9:function(n){if(!n)throw Error.invalidOperation("cannot add dependency on 'none'");this.$1y1.$D(n);return this},$3nM:function(n,t){$77v(this,n,t);$77u(this,n,t)}};_e.$Tv=function(n,t){_e.$Tv.initializeBase(this,[n,t])};function $3bz(n,t,i){var r=this;t.$Ds(50,function(r,u,f){for(var e=0;e<u.length;++e)Array.add(i,n.$14V(u[e]));u.length>0&&$3bz(n,t,i)},null)}_e.$Tv.prototype={$88I:function(n,t,i){_a.$3.$K(t,"successCallback");var r=[];var u=this,f=this,e=this;this.$Bl(new _a.$6i("FolderHierarchy.GetSubfolders"),function(t){var i=t.$Dv(_e.$1G.get_$I().$14J.get_$1N());var f=new _a.$8o(FolderItemMetadata.$1Tt(),n);var e=new _a.$8P(f,[new _a.$If(FolderItemMetadata.$2z0(),0)]);i.$JP(e,function(n){$3bz(u,n,r)},null)},function(){t(r)},function(n){_e.$1g.$DN(n,i)})},$81I:function(n,t){_a.$3.$K(n,"successCallback");var i=[];var r=this,u=this,f=this;this.$Bl(new _a.$6i("FolderHierarchy.GetAllFolders"),function(n){var t=n.$Dv(_e.$1G.get_$I().$14J.get_$1N());var u=new _a.$8P(null,[new _a.$If(FolderItemMetadata.$2z0(),0)]);t.$JP(u,function(n){$3bz(r,n,i)},null)},function(){n(i)},function(n){_e.$1g.$DN(n,t)})}};_e.$8H=function(){_e.$8H.initializeBase(this)};_e.$8H.$7xT=function(n){_a.$3.$K(n,"id");_a.$3.$1G(n.Id,"id.Id");return _e.$1l.$5h(n.Id)};_e.$8H.$1OJ=function(n){_a.$3.$K(n,"data");return _e.$8H.$7xT(n.FolderId)};_e.$8H.$1cZ=function(n,t,i,r){_a.$3.$K(n,"folderItemStore");_a.$3.$K(i,"successCallback");var u=t;_a.$3.$1G(u,"distinguishedFolderId");var f=null;n.$Bl(new _a.$6i("FolderItem.FromDistinguishedFolderId"),function(t){var i=t.$Dv(_e.$1G.get_$I().$14J.get_$1N());var r=new _a.$8o(FolderItemMetadata.$5QE(),u);var e=new _a.$8P(r,null);i.$JP(e,function(t){t.$Ds(2,function(t,i,r){i.length>0&&(f=n.$14V(i[0]))},null)},null)},function(){i(f)},function(n){_e.$1g.$DN(n,r)})};_e.$8H.$3xn=function(n){return n.__FolderPositionIndex};_e.$8H.$6ct=function(n,t){n.__FolderPositionIndex=t};_e.$8H.prototype={get_$iW:function(){return _e.$1G.get_$I().$14J},$AEy:function(n){_a.$3.$K(n.FolderId,"FolderId");_a.$3.$1G(n.FolderId.Id,"FolderId.Id");_a.$3.$K(n.ParentFolderId,"ParentFolderId");_a.$3.$1G(n.ParentFolderId.Id,"ParentFolderId.Id");_a.$3.$m(_e.$8H.$3xn(n),"FolderPositionIndex");_a.$3.$85(_e.$8H.$3xn(n),0,2147483647,"FolderPositionIndex")},$7xR:function(n){return _e.$8H.$1OJ(n)},$7xV:function(n){var t=_js.$8.$a(n.DistinguishedFolderId)?_e.$8H.$4N1:n.DistinguishedFolderId;return new FolderItemMetadata(n.ParentFolderId.Id,t,_e.$8H.$3xn(n))}};_e.$EM=function(n){_e.$EM.initializeBase(this,[n])};_e.$EM.$14T=function(n,t){_a.$3.$K(n,"folderId");_a.$3.$1G(n.Id,"folderId.Id");_a.$3.$K(t,"itemId");_a.$3.$1G(t.Id,"itemId.Id");return new _e.$EM(n.Id+":"+t.Id)};function FolderItemMetadata(n,t,i){FolderItemMetadata.initializeBase(this);this.ParentClientStoreId=n;this.DistinguishedFolderId=t;this.FolderPositionIndex=i}FolderItemMetadata.$1Tt=function(){return new _a.$4w("Metadata.ParentClientStoreId")};FolderItemMetadata.$5QE=function(){return new _a.$4w("Metadata.DistinguishedFolderId")};FolderItemMetadata.$2z0=function(){return new _a.$4w("Metadata.FolderPositionIndex")};FolderItemMetadata.prototype={ParentClientStoreId:null,DistinguishedFolderId:null,FolderPositionIndex:0};_e.$kd=function(){_e.$kd.initializeBase(this)};_e.$kd.prototype={get_$iW:function(){return _e.$1G.get_$I().$2Ql},$3z7:function(){var n=_a.$ix.$E(this.get_$1r().Blob);return n.$3z7()},$7xR:function(n){return _e.$1l.$5h(n.Id)},$7xV:function(n){return new ItemMetadata},$AEy:function(n){}};_e.$yN=function(n,t){_e.$yN.initializeBase(this,[n,t])};_e.$6Z=function(n,t){_a.$3.$1G(n,"name");_a.$3.$K(t,"fields");_a.$3.$85(t.length,1,2,"fields must be a 1 or 2 length array");this.$1k=n;this.$2ND=t};_e.$6Z.prototype={$1k:null,$2ND:null};function ItemMetadata(){}_e.$1AG=function(n,t,i){this.$3D=n;this.$HK=t;this.$MP=i};_e.$1AG.prototype={$3D:null,$HK:null,$MP:null,get_$1y:function(){return this.$3D},get_$5nN:function(){return this.$HK},get_$1v3:function(){return this.$MP}};_e.$D0=function(n,t,i,r,u,f,e,o,s){_a.$3.$1G(n,"name");this.$1k=n.toLowerCase();this.$CH=t;this.$5dx=f;this.$1M8=r||[];this.$2QR=i||[];this.$xT=u||_e.$9H.$QV;this.$5Ou=e;this.$5hN=o;this.$MP=s;$79F(this)};function $79F(n){if(n.$1M8.length>0){for(var u={},f=n.$2QR,h=f.length,t=0;t<h;++t)for(var c=f[t],e=c.$2ND,l=e.length,i=0;i<l;++i){var a=e[i];u[a.$5t.$5t]=1}for(var o=n.$1M8,v=o.length,r=0;r<v;++r){var s=o[r];if(s.$5t in u)throw Error.invalidOperation(String.format("The path {0} is declared as both an index and a blob",s.$5t));}}}_e.$D0.prototype={$1k:null,$CH:null,$2QR:null,$1M8:null,$5dx:0,$5Ou:0,$5hN:!1,$MP:null,$xT:null,get_$1N:function(){return this.$1k},get_$36:function(){return this.$CH},get_$2QS:function(){return this.$2QR},get_$7d1:function(){return this.$1M8},get_$8FA:function(){return this.$5dx},get_$7rc:function(){return this.$5Ou},get_$1v3:function(){return this.$MP},get_$1wH:function(){return this.$xT}};_e.$9H=function(n,t,i){this.$2N8=n;this.$2QR=t||new Array(0);this.$3Nj=i};_e.$9H.prototype={$2N8:null,$2QR:null,$3Nj:0};_e.$7t=function(n,t){this.$$d_$A4Z=Function.createDelegate(this,this.$A4Z);this.$$d_$9KZ=Function.createDelegate(this,this.$9KZ);this.$$d_$9Ka=Function.createDelegate(this,this.$9Ka);this.$$d_$9Kb=Function.createDelegate(this,this.$9Kb);this.add_onBeforePut=this.add_$1jV;this.remove_onBeforePut=this.remove_$1jV;this.add_onBeforeDelete=this.add_$17a;this.remove_onBeforeDelete=this.remove_$17a;this.add_onBeforeClear=this.add_$1jU;this.remove_onBeforeClear=this.remove_$1jU;this.bindMultipleIn=this.$7cy;_a.$3.$K(n,"store");_a.$3.$1G(t,"timeZoneId");this.$4C=new Sys.EventHandlerList;this.$6j=n;this.$7s=t;this.$10z=(new this.$$gta["_e.$7t"].TItem).get_$iW()};_e.$7t.$$=function(n,t){var r="$7t"+"$2"+"$"+n.getName().replace(/\./g,"_")+"$"+t.getName().replace(/\./g,"_");if(!_e[r]){var i=_e[r]=function(){(this.$$gta=this.$$gta||{})["_e.$7t"]={TInterface:n,TItem:t};for(var r=[],i=0;i<arguments.length;++i)r[i]=arguments[i];_e.$7t.apply(this,r)};i.registerClass("_e."+r,null,_bc.$Bs.$$(n),_bc.$19I);var f=_e.$7t.prototype;for(var e in f){var u={key:e,value:f[e]};"constructor"!==u.key&&(i.prototype[u.key]=u.value)}i.$9kx="OnPut";i.$7qo="OnDelete";i.$7gt="OnClear";i.$7cT="OnAvailable"}return _e[r]};_e.$7t.prototype={$6j:null,$7s:null,$10z:null,$4C:null,$4du:0,$dp:null,add_$1jV:function(n){var t=this;this.$2oM("OnPut",n,function(){t.$dp.add_$1jV(t.$$d_$9Kb)})},remove_$1jV:function(n){var t=this;this.$3OW("OnPut",n,function(){t.$dp.remove_$1jV(t.$$d_$9Kb)})},add_$17a:function(n){var t=this;this.$2oM("OnDelete",n,function(){t.$dp.add_$17a(t.$$d_$9Ka)})},remove_$17a:function(n){var t=this;this.$3OW("OnDelete",n,function(){t.$dp.remove_$17a(t.$$d_$9Ka)})},add_$1jU:function(n){var t=this;this.$2oM("OnClear",n,function(){t.$dp.add_$1jU(t.$$d_$9KZ)})},remove_$1jU:function(n){var t=this;this.$3OW("OnClear",n,function(){t.$dp.remove_$1jU(t.$$d_$9KZ)})},add_$6Hk:function(n){var t=this;this.$12C("OnAvailable",n,function(){t.$6j.add_$34I(t.$$d_$A4Z)});this.get_$g9()&&n(this)},remove_$6Hk:function(n){var t=this;this.$29t("OnAvailable",n,function(){t.$6j.remove_$34I(t.$$d_$A4Z)})},add_$6mm:function(n){var t=this;this.$2oM("OnDelete",n,function(){t.$dp.add_$17a(t.$$d_$9Ka)})},remove_$6mm:function(n){var t=this;this.$3OW("OnDelete",n,function(){t.$dp.remove_$17a(t.$$d_$9Ka)})},get_$g9:function(){return this.$6j.get_$g9()},get_$3Vd:function(){return this.$7s},get_$4dg:function(){return this.$6j},$Bl:function(n,t,i,r){this.$6j.get_$13M().$Bl(n,t,i,r)},$Fu:function(n,t,i,r){var u=this;_e.$y.$Fu(this.$$gta["_e.$7t"].TItem,this.$6j,n,t,this.$7s,function(n){u.$6my(n,t);i(n)})},$AGV:function(n,t,i,r){var u=this.$82o(t);u?i(u):this.$Fu(n,t,i,r)},$7cy:function(n,t,i,r){var u=this;_e.$y.$7cy(this.$$gta["_e.$7t"].TItem,this.$6j,n,t,this.$7s,function(n){i(n)},r)},$uj:function(n,t,i,r){if(!this.$$gta["_e.$7t"].TItem.isInstanceOfType(t))throw Error.argumentNull("data");var u=t;u.$3Q0(n,i,r)},$1KP:function(n,t,i){_e.$y.$1KP(this.$$gta["_e.$7t"].TItem,this.$6j,n,t,this.$7s,i)},$II:function(n,t){this.$2va(n,t,null)},$2va:function(n,t,i){_e.$y.$AHV(this.$$gta["_e.$7t"].TItem,n,t,i)},$qd:function(n){_e.$y.$qd(this.$$gta["_e.$7t"].TItem,n)},$1uq:function(n,t,i){_e.$y.$1uq(this.$$gta["_e.$7t"].TItem,n,t,i)},$6UN:function(n,t,i,r,u){_e.$y.$6UN(this.$$gta["_e.$7t"].TItem,n,t,i,r,u)},$Nr:function(n,t,i){_a.$3.$K(n,"tx");var r=n.$Dv(this.$10z.get_$1N());r.$JP(t,i,null)},$rP:function(n){return _e.$y.$rP(this.$$gta["_e.$7t"].TItem,this.$6j,n,this.$7s)},$14V:function(n){return _e.$y.$14V(this.$$gta["_e.$7t"].TItem,this.$6j,n,this.$7s)},$5Zi:function(n){return this.$6j.get_$Tt().$2x(_e.$1n.$7s,this.$7s,n)},$30G:function(n){return this.$6j.get_$Tt().$2x(this.$7s,_e.$1n.$7s,n)},$1oq:function(n,t,i,r){this.$Fu(n,t,i,r)},$6mn:function(n,t,i,r){this.$uj(n,t,i,r)},$4i1:function(n){return this.$rP(n)},$2oM:function(n,t,i){this.$4du++||(this.$dp=this.$6j.get_$13M().$5Lm(this.$10z.get_$1N()));this.$12C(n,t,i)},$3OW:function(n,t,i){this.$29t(n,t,i);--this.$4du<=0&&this.$7st()},$12C:function(n,t,i){this.$4C.getHandler(n)||i();this.$4C.addHandler(n,t)},$29t:function(n,t,i){this.$4C.removeHandler(n,t);this.$4C.getHandler(n)||i()},$7st:function(){this.$4du=0;if(this.$dp){this.$dp.$1R();this.$dp=null}},$A4Z:function(n){if(this.$6j.get_$g9()){var t=this.$4C.getHandler("OnAvailable");t&&t(this)}},$9Kb:function(n,t){var i=this.$4C.getHandler("OnPut");if(i){var r=new(_e.$Pu.$$(this.$$gta["_e.$7t"].TInterface))(t.get_$Bl(),_e.$y.$AHX(this.$$gta["_e.$7t"].TItem,this.$6j,t.get_$1y(),t.get_$1r(),this.$7s));i(this,r)}},$9Ka:function(n,t){var i=this.$4C.getHandler("OnDelete");if(i){var r=new(_e.$Pu.$$(_a.$qe))(t.get_$Bl(),_e.$1l.$3wg(t.get_$1y()));i(this,r)}},$9KZ:function(n,t){var i=this.$4C.getHandler("OnClear");if(i){var r=new(_e.$Pu.$$(this.$$gta["_e.$7t"].TInterface))(t.get_$Bl(),this.$$gta["_e.$7t"].TInterface===Number||Type.isEnum(this.$$gta["_e.$7t"].TInterface)?0:this.$$gta["_e.$7t"].TInterface===Boolean?!1:null);i(this,r)}},$82o:function(n){var t=this.$$gta["_e.$7t"].TInterface===Number||Type.isEnum(this.$$gta["_e.$7t"].TInterface)?0:this.$$gta["_e.$7t"].TInterface===Boolean?!1:null;var i=this.$6j.get_$1tT().$3c(this.$10z.get_$1N(),n.toString());i&&(t=this.$rP(i));return t},$6my:function(n,t){n&&this.$6j.get_$1tT().$2fK(this.$10z.get_$1N(),t.toString(),n.$z)}};_e.$Pu=function(n,t){this.$P=this.$$gta["_e.$Pu"].T===Number||Type.isEnum(this.$$gta["_e.$Pu"].T)?0:this.$$gta["_e.$Pu"].T===Boolean?!1:null;_e.$Pu.$$(this.$$gta["_e.$Pu"].T).initializeBase(this);this.$BY=n;this.$P=t};_e.$Pu.$$=function(n){var t="$Pu"+"$1"+"$"+n.getName().replace(/\./g,"_");if(!_e[t]){var r=_e[t]=function(){(this.$$gta=this.$$gta||{})["_e.$Pu"]={T:n};for(var i=[],t=0;t<arguments.length;++t)i[t]=arguments[t];_e.$Pu.apply(this,i)};r.registerClass("_e."+t,Sys.EventArgs,_bc.$qu.$$(n),_bc.$19J);var u=_e.$Pu.prototype;for(var f in u){var i={key:f,value:u[f]};"constructor"!==i.key&&(r.prototype[i.key]=i.value)}}return _e[t]};_e.$Pu.prototype={$BY:null,get_$Bl:function(){return this.$BY},get_$3o:function(){return this.$P}};_e.$eH=function(n,t){_a.$3.$K(t,"syncStateId");this.$9B=new _e.$UR(n,_e.$1n.$7s);this.$6jX=this.$7oN(t)};_e.$eH.prototype={$6jX:null,$9B:null,get_$c8:function(){return this.$6jX},get_$AU:function(){return this.$9B},$30p:function(n,t){var i=this;this.get_$c8().$2Oq(function(t){var r=i.get_$c8().$5Zq(t);n(r)},t)},$A5y:function(n,t,i,r,u,f,e){_js.Trace.logInfo(_e.$eH.$A,"SyncTo");_a.$3.$K(n,"syncState");var o=this,s=this,h=this;this.$9B.$Bl(new _a.$6i("ItemSynchronizer.SyncTo",!1,t,i,r),function(t){o.$5gL(t,n,u)},function(){_e.$1g.$lC(f)},function(n){_e.$1g.$DN(n,e)})},$cV:function(n,t,i,r){var u=this,f=this,e=this;this.$9B.$Bl(new _a.$6i("ItemSynchronizer.Cleanup",!1),function(i){t.$6Qc(i);n!==2&&u.get_$c8().$7rR(i)},function(){_e.$1g.$lC(i)},function(n){_js.Trace.logError(_e.$1n.$A,"Database cleanup failed. Code = {0}, Message = {1}",n.$Vs,n.$3j);_e.$1g.$DN(n,r)})},$6V1:function(n,t,i,r,u){var e=this,f=this,o=this;this.$9B.$Bl(new _a.$6i("ItemSynchronizer.ReconcileClientData",!1),function(i){n.$9kz(i,t,function(){})},function(){i(function(){f.$9B.$Bl(new _a.$6i("ItemSynchronizer.ReconsileClientData",!1),function(t){n.$9gf(t)},function(){_e.$1g.$lC(r)},function(n){_e.$1g.$DN(n,u)})})},function(n){_e.$1g.$DN(n,u)})},$7oN:function(n){return new _e.$nJ(this.$9B.get_$pd(),n)},$5gL:function(n,t,i){i.$6Qc(n);this.get_$c8().$4Sd(n,t)}};_e.$eP=function(n,t){_e.$eP.$$(this.$$gta["_e.$eP"].TInterface,this.$$gta["_e.$eP"].TItem,this.$$gta["_e.$eP"].TResult).initializeBase(this,[n,t])};_e.$eP.$$=function(n,t,i){var r="$eP"+"$3"+"$"+n.getName().replace(/\./g,"_")+"$"+t.getName().replace(/\./g,"_")+"$"+i.getName().replace(/\./g,"_");if(!_e[r]){var f=_e[r]=function(){(this.$$gta=this.$$gta||{})["_e.$eP"]={TInterface:n,TItem:t,TResult:i};for(var u=[],r=0;r<arguments.length;++r)u[r]=arguments[r];_e.$eP.apply(this,u)};f.registerClass("_e."+r,_e.$7t.$$(n,t));var e=_e.$eP.prototype;for(var o in e){var u={key:o,value:e[o]};"constructor"!==u.key&&(f.prototype[u.key]=u.value)}}return _e[r]};_e.$eP.prototype={$AIf:function(n,t,i,r,u){_a.$3.$K(n,"paging");_a.$3.$K(t,"seekToConditionKeyKeyPath");_a.$3.$K(i,"queryCreatorCallback");_a.$3.$K(r,"successCallback");if(_g.$CC.isInstanceOfType(n))this.$84X(n,i,r,u);else if(_g.$Ka.isInstanceOfType(n))this.$87e(n,t,i,r,u);else throw Error.invalidOperation(String.format("Unsupported paging type {0} provided",n));},$84X:function(n,t,i,r){_a.$3.$85(n.Offset,0,Number.MAX_VALUE,"offset");_a.$3.$85(n.MaxEntriesReturned,1,Number.MAX_VALUE,"maxEntriesToReturn");_a.$3.$9t(n.BasePoint==="Beginning","Unsupported paging type provided");var s=n.MaxEntriesReturned;var e=n.Offset;var h=n.BasePoint;var o=new Array(0);var u=0;var f=this,c=this,l=this;this.$Bl(new _a.$6i("ListViewItemStore.GetIndexedPageViewItems"),function(n){f.$5a4(n,function(i){u=i;_a.$3.$85(u,0,Number.MAX_VALUE,"totalItemsInView");_js.Trace.logInfo(_e.$1n.$A,"ListViewItemStore.GetIndexedPageViewItems: totalItemsInView={0}, basePoint={1}, maxEntriesToReturn={2}, offset={3}",u,h,s,e);var r=n.$Dv(f.get_$vB());var c=t();r.$JP(c,function(n){f.$5Se(n,e,s,function(n,t,i){f.$4UU(t,o)})},null)})},function(){i(o,u,e+o.length)},function(n){_e.$1g.$DN(n,r)})},$87e:function(n,t,i,r,u){_a.$3.$85(n.MaxEntriesReturned,1,Number.MAX_VALUE,"maxEntriesToReturn");var o=n.MaxEntriesReturned;var v=n.BasePoint;var l=v==="Beginning";var s=!1;var h=0;var y=n.Condition.Item.FieldURIOrConstant.Item;var a=y.Value;var c=new Array(0);var e=0;var f=this,p=this,w=this;this.$Bl(new _a.$6i("ListViewItemStore.GetSeekToConditionPageViewItems"),function(n){f.$5a4(n,function(r){e=r;_a.$3.$85(e,0,Number.MAX_VALUE,"totalItemsInView");_js.Trace.logInfo(_e.$1n.$A,"ListViewItemStore.GetSeekToConditionPageViewItems: totalItemsInView={0}, isSeekNextRequest={1}, basePoint={2}, maxEntriesToReturn={3}, seekToConditionKeyPath={4}, seekToConditionKeyValue={5}",e,l,v,o,t.$5t,a);var u=n.$Dv(f.get_$vB());var y=i();u.$JP(y,function(n){l?f.$7wt(n,t,a,o,function(n,t,i){h=i;s=n;n&&f.$4UU(t,c)}):f.$5ZU(n,t,a,function(n,t){s=n;if(n){h=t;var i=Math.max(0,t-o+1);u.$JP(y,function(n){f.$5Se(n,i,o,function(n,t,i){f.$4UU(t,c)})},null)}else _js.Trace.logInfo(_e.$1n.$A,"ListViewItemStore.GetSeekToConditionKeyOffset: row NOT found offset={0}, maxEntriesToReturn={1}",t,o)})},null)})},function(){var n;n=l?s?h+c.length:e:s?Math.max(0,e-h-1):0;r(c,e,n)},function(n){_e.$1g.$DN(n,u)})},$5ZU:function(n,t,i,r){var u=this;n.$1mJ(0,new _a.$8o(t,i),function(t){_js.Trace.logInfo(_e.$1n.$A,"ListViewItemStore.GetSeekToConditionKeyOffset: result offset={0}",n.get_$JQ());r(t,n.get_$JQ())},null)},$7wt:function(n,t,i,r,u){var f=this;this.$5ZU(n,t,i,function(t,i){if(t)n.$Ds(r,function(n,f,e){_js.Trace.logInfo(_e.$1n.$A,"ListViewItemStore.ExecuteSeekToConditionQuery: result offset={0}, maxEntriesToReturn={1}, found entries={2}",i,r,f.length);u(t,f,i)},null);else{_js.Trace.logInfo(_e.$1n.$A,"ListViewItemStore.ExecuteSeekToConditionQuery: row NOT found offset={0}, maxEntriesToReturn={1}",i,r);u(t,null,i)}})},$5Se:function(n,t,i,r){var u=this;n.$1W9(t,function(){n.$Ds(i,function(n,u,f){_js.Trace.logInfo(_e.$1n.$A,"ListViewItemStore.ExecuteSeekToIndexQuery: result offset={0}, maxEntriesToReturn={1}, found entries={2}",t,i,u.length);r(n,u,f)},null)},null)}};_e.$1BG=function(n,t,i,r){_e.$1BG.initializeBase(this,[n,t,i,!0,r,4])};_e.$1BG.prototype={get_$vB:function(){return _e.$1G.get_$I().$zC.get_$1N()},get_$2fx:function(){return!0},$80m:function(n){var t=null;if(n.get_$lz().length>0){var r=n.get_$lz()[0].$27;t=r.Data}else if(n.get_$mU().length>0){var u=n.get_$mU()[0].$27;t=_a.$1X.$AIG(_g.$7j,u.Data)}else if(n.get_$13W().length>0){var i=this.$AHZ(n.get_$13W()[0].$3D);i&&(t=i.get_$1r())}t&&t.IsDraft&&this.$80l(t.ParentFolderId.Id)},$9yp:function(n,t){return!!n&&n.$1x8},$30F:function(n){return n.get_$4y()},$80l:function(n){_e.$2r.$2zW(n,"clientStore",this.get_$2fx())}};_e.$zK=function(n,t){_e.$zK.initializeBase(this,[n,"MessageItemSyncStateId"]);_a.$3.$85(t,0,10,"maxUnsyncedItemsToGet");this.get_$c8().$5ru=t};_e.$zK.prototype={$7oN:function(n){return new _e.$lQ(this.$9B.get_$pd(),this.$9B.get_$4y())}};_e.$1BH=function(n,t,i,r,u){_e.$1BH.initializeBase(this,[n,i,u]);_a.$3.$K(t,"attachmentItemStore");_a.$3.$K(r,"attachments");this.$1Lz=t;this.$9g=r};_e.$1BH.prototype={$1Lz:null,$9g:null,$6Qc:function(n){_a.$3.$K(n,"tx");var i=[];var r=this,t=this;_e.$3Z.$AHK(_bc.$MS,_g.$7j,this.get_$5nN(),n,this.get_$AIZ(),function(n){return _e.$1l.$5h(n.ItemId.Id)},function(r){for(var o=t.get_$AIZ(),s=o.length,f=0;f<s;++f){var u=o[f];var e=r.$NO(u.ItemId.Id)?r.get_$3o(u.ItemId.Id).get_$1r():null;if(e&&u.ItemId.ChangeKey===e.ItemId.ChangeKey){var h=_g.$Rq.$5KG(e,u);Array.add(i,h)}else Array.add(i,u)}t.set_$AIZ(i);_e.$3Z.$AHF(_bc.$qZ,AttachmentInfoRecord,t.$1Lz,n,t.$9g,null);_e.$YP.prototype.$6Qc.call(t,n)})}};_e.$lQ=function(n,t){_a.$3.$K(n,"syncStateItemStore");_a.$3.$K(t,"messageItemStore");this.$2hs=n;this.$2VX=t};_e.$lQ.$AAB=function(n,t,i){_a.$3.$K(n,"tx");_a.$3.$K(t,"messageItemStore");_a.$3.$K(i,"itemIds");for(var u=i,f=u.length,r=0;r<f;++r){var e=u[r];t.$Fu(n,_e.$1l.$5h(e.Id),function(i){if(i){var r=MessageItemRecord.$2Nu(i.get_$1r());r.CustomSyncData.IsDataSynced=CustomSyncData.$1uW;t.$uj(n,i,1,null)}},null)}};_e.$lQ.prototype={$2hs:null,$2VX:null,$5ru:0,$2Oq:function(n,t){_a.$3.$K(n,"successCallback");var i=this,r=this;_e.$By.$88x(this.$2VX,this.$5ru,_g.$h.$1i,function(t,r,u){var f=i.$2hs.$rP(new MessageItemSyncState(t,r,u));n(f)},function(n){_js.Trace.logError(_e.$1n.$A,"ClientStore returned error while trying to fetch unsyned item list. Error = {0}",n.get_$4y());t&&t(n)})},$AAJ:function(n,t,i,r){r()},$3Wi:function(n,t){t()},$4Sd:function(n,t){_e.$lQ.$AAB(n,this.$2VX,t.$6L)},$7rR:function(n){throw Error.notImplemented("NYI");},$2OD:function(){return new MessageItemSyncState([],{},!1)},$5Zq:function(n){return $5(n)?this.$2OD():n.get_$1r()},$5XO:function(n){throw Error.notImplemented("This is implemented only in MultiFolderSyncStateProvider");}};_e.$1BV=function(n,t){_e.$1BV.initializeBase(this,[n,t])};_e.$1BV.prototype={$2OD:function(){return new MultiFolderSyncState(this.$2DA)},$5XO:function(n){return new SyncState(n,"")}};_e.$zS=function(n,t){_e.$zS.initializeBase(this,[n,t])};_e.$zS.prototype={$7oN:function(n){return new _e.$1BV(this.$9B.get_$pd(),n)}};_e.$2r=function(){};_e.$2r.$2zW=function(n,t,i){_e.$2r.$2zS(n,null,"Reload",t,_e.$2r.$yI,_e.$2r.$yI,i)};_e.$2r.$2zS=function(n,t,i,r,u,f,e){_a.$3.$1G(n,"folderId");var o=new _a.$18T;o.id="HierarchyNotification";o.type="HierarchyNotification";o.folderId=n;o.parentFolderId=t;o.EventType=i;o.itemCount=u;o.unreadCount=f;o.clientGenerated=!0;o.forceSynchronousProcessing=!e;_a.$g.$9H("Reload.Notification.Source."+r);_e.$2r.$1y4(o)};_e.$2r.$2O0=function(n){var t=new _a.$1DL;t.id="ReminderNotification";t.type="ReminderNotification";t.clientGenerated=!0;t.shouldGetReminders=!0;t.forceSynchronousProcessing=!n;_js.Trace.logInfo(_a.$0.$QX,"Time: {0}, Cache client reminder notification",_a.$7.get_$2F().toString());_e.$2r.$1y4(t)};_e.$2r.$5Vy=function(n,t,i){_a.$3.$1G(n,"folderId");var r=new _g.$1Df;r.clientGenerated=!0;r.FolderId=n;r.EventType=t;r.id="RowNotification"+n;r.type="RowNotification";r.forceSynchronousProcessing=!i;_e.$2r.$1y4(r)};_e.$2r.$5W7=function(n){var t=new _a.$1C1;t.id="OwaUserConfigurationNotification";t.type="OwaUserConfigurationNotification";t.clientGenerated=!0;t.reload=n;_e.$2r.$1y4(t)};_e.$2r.$3wq=function(n){_a.$3.$K(n,"response");var t=new _g.$16X;t.id="FolderHierarchyNotification";t.type="FolderHierarchyNotification";t.clientGenerated=!0;t.folderHierarchy=n;_e.$2r.$1y4(t)};_e.$2r.$80T=function(n,t,i){_a.$3.$1G(t,"GenerateCalendarItemNotification:folderId");_a.$3.$m(i,"GenerateCalendarItemNotification:calendarItem");var r=new _g.$13v;r.clientGenerated=!0;r.EventType=n;r.id="CalendarItemNotification"+t;r.type="CalendarItemNotification";r.FolderId=t;r.Item=i;r.Reload=!1;r.forceSynchronousProcessing=!0;_e.$2r.$1y4(r)};_e.$2r.$1y4=function(n){_a.$3.$KI(n.clientGenerated,!0,"notification.ClientGenerated");OwaApplication.get_$TQ().$nH(n)};_e.$1Bx=function(n,t,i,r){_e.$1Bx.initializeBase(this,[n,t,i,!0,r,5])};_e.$1Bx.prototype={get_$vB:function(){return _e.$1G.get_$I().$1Tn.get_$1N()},get_$2fx:function(){return!0},$80m:function(n){var t=null;if(n.get_$lz().length>0){var r=n.get_$lz()[0].$27;t=r.Data}else if(n.get_$mU().length>0){var u=n.get_$mU()[0].$27;t=u.Data}else if(n.get_$13W().length>0){var i=this.$AHZ(n.get_$13W()[0].$3D);i&&(t=i.get_$1r())}t&&_e.$2r.$2zW(t.ParentFolderId.Id,"serviceCommand",this.get_$2fx())},$30F:function(n){return n.get_$h5()}};_e.$Uz=function(n,t,i,r){_e.$Uz.initializeBase(this,[n,t,i,!1,r,7])};function $3c5(n,t,i,r){for(var f=i,o=f.length,u=0;u<o;++u){var e=f[u];e.$3D.toString()==="OwaUserConfiguration.1"&&t.$6V2(e,r)}}_e.$Uz.prototype={get_$vB:function(){return _e.$1G.get_$I().$2fj.get_$1N()},$7xk:function(n){var t=new _a.$za;$3c5(this,t,n.get_$lz(),0);$3c5(this,t,n.get_$mU(),1);$3c5(this,t,n.get_$13W(),2);return t},$80m:function(n){},$30F:function(n){return n.get_$6df()}};_e.$Lm=function(){_e.$Lm.initializeBase(this)};_e.$Lm.$88R=function(n,t,i){_a.$3.$K(n,"syncStateItemStore");_a.$3.$K(t,"successCallback");var r=[];n.$Bl(new _a.$6i("SyncStateItem.GetSyncStates"),function(t){var u=t.$Dv(_e.$1G.get_$I().$1WY.get_$1N());var f=new _a.$8P(null,null);u.$JP(f,function(t){t.$Ds(_e.$Lm.$5rs,function(t,i,u){for(var f=0;f<i.length;++f)Array.add(r,n.$14V(i[f]))},_e.$1g.$aG(i))},_e.$1g.$aG(i))},function(){t(r)},_e.$1g.$aG(i))};_e.$Lm.prototype={get_$iW:function(){return _e.$1G.get_$I().$1WY},$AEy:function(n){_a.$3.$1G(n.Id,"id")},$7xR:function(n){return _e.$1l.$5h(n.Id)},$7xV:function(n){return new ItemMetadata}};_e.$3Z=function(){};_e.$3Z.$AHF=function(n,t,i,r,u,f){_e.$3Z.$AHG(n,t,i,r,u,f,1)};_e.$3Z.$AHG=function(n,t,i,r,u,f,e){if(!u||!u.length){_e.$1g.$lC(f);return}for(var c=0,s=function(){++c===u.length&&_e.$1g.$lC(f)},o=0;o<u.length;o++){var h=u[o];$5(h)?s():_e.$3Z.$AHI(n,t,i,r,h,null,function(){s()},e)}};_e.$3Z.$AHH=function(n,t,i,r,u,f,e){_e.$3Z.$AHI(n,t,i,r,u,f,e,1)};_e.$3Z.$AHI=function(n,t,i,r,u,f,e,o){var s=i.$4i1(u);f?f(s,r,e):i.$6mn(r,s,o,e)};_e.$3Z.$AHJ=function(n,t,i,r,u){if(!r||!r.length){_e.$1g.$lC(u);return}for(var s=0,e=function(){++s===r.length&&_e.$1g.$lC(u)},f=0;f<r.length;f++){var o=r[f];o?i.$2va(t,o,function(){e()}):e()}};_e.$3Z.$AHK=function(n,t,i,r,u,f,e){var h=0;var o=_a.$3r.$$(n).$8V();u&&u.length||e(o);for(var s=0;s<u.length;s++)i.$1oq(r,f(u[s]),function(n){h++;n&&o.set_$3o(n.get_$1y().get_$1fW().toString(),n);h===u.length&&e(o)},null)};_e.$3Z.$9kz=function(n,t,i,r,u,f){var e=new _a.$8o(_e.$y.$2eL,0);var o=new _a.$8P(e,null);i.$6UN(t,o,r,function(t,i,r,e){for(var c=n.getName(),s=r.length,o=0;o<s;o++){var h=r[o].$3D.$Tv();_js.Trace.logWarning(_e.$3Z.$A,"Dirty item (type: {0}) #{1}/{2}: {3}",c,o,s,h);u[h]=null}e&&f()},null)};_e.$3Z.$3wP=function(n,t){var i=n;for(var r in i){var u={key:r,value:i[r]};t(u.key)}};_e.$nJ=function(n,t){_a.$3.$K(n,"store");_a.$3.$K(t,"syncStateId");this.$6j=n;this.$2DA=t};_e.$nJ.prototype={$6j:null,$2DA:null,$2Oq:function(n,t){_a.$3.$K(n,"successCallback");var i=null;var r=this,u=this,f=this;this.$6j.$Bl(new _a.$6i("SyncStateProvider.GetState"),function(n){r.$5Zh(n,function(n){i=n})},function(){n(i)},function(n){_e.$1g.$DN(n,t)})},$5Zh:function(n,t){_a.$3.$K(t,"successCallback");this.$6j.$AGV(n,_e.$1l.$5h(this.$2DA),t,null)},$AAH:function(n,t){var i=this;this.$3Wi(function(t){t.IsSynced=n},t)},$AAJ:function(n,t,i,r){var u=this;this.$3Wi(function(r){r.Diagnostics.SyncType=n;r.Diagnostics.SyncInProgress=t;r.Diagnostics.SyncError=i?i.message:""},r)},$4Sd:function(n,t){var i=this.$6j.$rP(t);i.$E1(n,null)},$7rR:function(n){this.$6j.$II(n,_e.$1l.$5h(this.$2DA))},$2OD:function(){return new SyncState(this.$2DA,"")},$5Zq:function(n){return $5(n)?this.$2OD():n.get_$1r()},$3Wi:function(n,t){_a.$3.$K(n,"updateDelegate");_a.$3.$K(t,"completedCallback");var i=this,r=this,u=this;this.$6j.$Bl(new _a.$6i("SyncStateProvicer.TryUpdateSyncStateProperties"),function(t){i.$6j.$AGV(t,_e.$1l.$5h(i.$2DA),function(r){var u=i.$5Zq(r);n(u);i.$4Sd(t,u)},null)},function(){t()},function(n){t()})},$5XO:function(n){throw Error.notImplemented("This is implemented only in MultiFolderSyncStateProvider");}};_e.$1Fx=function(){};_e.$1Fx.prototype={$2zR:function(n){_a.$3.$K(n,"folderIds");_a.$3.$85(n.length,1,100,"folderIds should have at least one entry");for(var i=n,u=i.length,t=0;t<u;++t){var r=i[t];_js.Trace.logInfo(_e.$1n.$A,"Generating onSync hierarchy notification. FolderId: {0}",r);_e.$2r.$2zW(r,"sync",!1)}},$2O0:function(){_js.Trace.logInfo(_a.$0.$QX,"Generating onSync reminder notification");_e.$2r.$2O0(!0)},$80p:function(n){_a.$3.$K(n,"folderIds");_a.$3.$KI(n.length>0,!0,"folderIds should have at least one entry");for(var i=n,u=i.length,t=0;t<u;++t){var r=i[t];_js.Trace.logInfo(_a.$0.$QX,"Generating onSync persona notification. FolderId: {0}",r);_e.$2r.$5Vy(r,"RowModified",!0)}},$5W7:function(n){_js.Trace.logInfo(_a.$0.$QX,"Generating onSync owa user configuration notification.");_e.$2r.$5W7(n)},$3wq:function(n){_a.$3.$K(n,"response");_js.Trace.logInfo(_a.$0.$QX,"Generating onSync folder hierarchy notification.");_e.$2r.$3wq(n)}};_e.$6s=function(){_e.$6s.initializeBase(this)};_e.$6s.get_$3no=function(){return new _a.$4w("Data.ConversationId.Id")};_e.$6s.get_$33p=function(){return new _a.$4w("Data.InstanceKey")};_e.$6s.get_$2w8=function(){return new _a.$4w("Data.DirtyState")};_e.$6s.$1OJ=function(n){_a.$3.$K(n,"data");return _e.$EM.$14T(n.FolderId,n.ConversationId)};_e.$6s.$83C=function(n,t,i,r){_a.$3.$K(n,"tx");_a.$3.$K(r,"successCallback");_a.$3.$85(i,0,100,"maxEntriesToReturn");var u=[];var f={};var e={};var o=n.$Dv(_e.$1G.get_$I().$iY.get_$1N());var s=new _a.$8o(_e.$6s.get_$2w8(),2);var h=new _a.$8P(s,[new _a.$If(ConversationItemMetadata.$2Ts(),1)]);o.$JP(h,function(n){n.$Ds(i*2,function(n,o,s){for(var v=0,l=o,y=l.length,c=0;c<y;++c){var p=l[c];var a=t.$14V(p);var h=a.get_$1r().ConversationId.Id;if($5(e[h])){if(v++>=i)break;Array.add(u,new _g.$1t(h));f[h]=a.get_$1r().LastModifiedTime;e[h]=!0}}r(u,f)},null)},null)};_e.$6s.$3xN=function(n,t,i,r){_a.$3.$K(n,"tx");_a.$3.$K(t,"conversationItemStore");_a.$3.$K(i,"conversationId");_a.$3.$1G(i.Id,"conversationId.Id");_a.$3.$K(r,"successCallback");var f=n.$Dv(_e.$1G.get_$I().$iY.get_$1N());var e=new _a.$8o(_e.$6s.get_$3no(),i.Id);var o=new _a.$8P(e,null);var u=[];f.$JP(o,function(n){n.$Ds(100,function(n,i,f){for(var o=i,s=o.length,e=0;e<s;++e){var h=o[e];Array.add(u,t.$14V(h))}r(u)},null)},null)};_e.$6s.$4iS=function(n,t,i,r){var o=100;var s=new _a.$8P(new _a.$8o(_e.$6s.get_$2w8(),1),null);var u=[];var f={};var e={};t.$6UN(n,s,o,function(o,s,h,c){for(var y=h,w=y.length,v=0;v<w;++v){var b=y[v];var l=t.$14V(b);var k=l.get_$1r().ConversationId.Id;e[k]=l.get_$1r().LastModifiedTime;if(l.get_$1r().GlobalItemReadFlags)for(var a=0;a<l.get_$1r().GlobalItemIds.length;a++){var p=l.get_$1r().GlobalItemIds[a];Array.add(u,p);f[p.Id]=l.get_$1r().GlobalItemReadFlags[a]}l.set_$5Pe(0);t.$uj(n,l,1,null)}if(c){_e.$6s.$ACY(n,i,e);_e.$6s.$4iT(n,r,u,0,f)}},null)};_e.$6s.$ACY=function(n,t,i){var r=i;for(var u in r){var f={key:u,value:r[u]};t.$Fu(n,_e.$1l.$5h(f.key),function(r){if(r){var u=i[r.get_$1r().ConversationId.Id];r.get_$1r().LastModifiedTime=u;t.$uj(n,r,1,function(n){})}else _js.Trace.logWarning(_e.$1n.$A,"Can't find ConversationNode with id:{0}",f.key)},null)}};_e.$6s.$4iT=function(n,t,i,r,u){var f=10;r+f>i.length&&(f=i.length-r);if(f)for(var o=0,e=0,s=0;s<f;s++){o++;t.$Fu(n,_e.$1l.$5h(i[r+s].Id),function(s){if(s){o--;if(s.get_$1r().IsRead!==u[s.get_$1r().ItemId.Id]){s.get_$1r().IsRead=u[s.get_$1r().ItemId.Id];e++;t.$uj(n,s,1,function(o){e--;e||_e.$6s.$4iT(n,t,i,r+f,u)})}else o||e||_e.$6s.$4iT(n,t,i,r+f,u)}},null)}};_e.$6s.prototype={get_$5Pe:function(){return this.get_$1r().DirtyState},set_$5Pe:function(n){this.get_$1r().DirtyState=n;return n},get_$iW:function(){return _e.$1G.get_$I().$iY},$AEy:function(n){_a.$3.$K(n.ConversationId,"ConversationId");_a.$3.$1G(n.ConversationId.Id,"ConversationId.Id");_a.$3.$1G(n.LastDeliveryTime,"LastDeliveryTime");_a.$3.$K(n.FolderId,"FolderId");_a.$3.$K(n.FolderId.Id,"FolderId.Id")},$7xR:function(n){return _e.$6s.$1OJ(n)},$7xV:function(n){var t=$5(n.HasClutter)?!1:n.HasClutter;return new ConversationItemMetadata(n.FolderId.Id,t,n.LastDeliveryTime)}};function ConversationItemMetadata(n,t,i){ConversationItemMetadata.initializeBase(this);this.ParentClientStoreId=n;this.ParentClientStoreIdAndClutter=_e.$7q.$E(n,t);this.LastDeliveryTime=i}ConversationItemMetadata.$1Tt=function(){return new _a.$4w("Metadata.ParentClientStoreId")};ConversationItemMetadata.$1Ts=function(){return new _a.$4w("Metadata.ParentClientStoreIdAndClutter")};ConversationItemMetadata.$2Ts=function(){return new _a.$4w("Metadata.LastDeliveryTime")};ConversationItemMetadata.prototype={ParentClientStoreId:null,ParentClientStoreIdAndClutter:null,LastDeliveryTime:null};_e.$PN=function(){_e.$PN.initializeBase(this)};_e.$PN.$5Ld=function(n){_a.$3.$K(n,"originalItem");var t=new _g.$7j;t.ItemId=n.ItemId;t.ConversationId=n.ConversationId;t.ParentFolderId=n.ParentFolderId;t.DateTimeCreated=n.DateTimeCreated;t.DateTimeSent=n.DateTimeSent;t.DateTimeReceived=n.DateTimeReceived;t.__PlaceHolderItem=!0;return t};_e.$PN.$1OJ=function(n){_a.$3.$K(n,"data");_a.$3.$K(n.ConversationId,"data.ConversationId");return _e.$PN.$7xS(n.ConversationId)};_e.$PN.$7xS=function(n){_a.$3.$K(n,"conversationId");_a.$3.$1G(n.Id,"conversationId.Id");return _e.$1l.$5h(n.Id)};_e.$PN.prototype={get_$iW:function(){return _e.$1G.get_$I().$2K3},$AEy:function(n){_a.$3.$K(n.ConversationId,"ConversationId");_a.$3.$1G(n.ConversationId.Id,"ConversationId.Id");_a.$3.$1G(n.SyncState,"SyncState");_a.$3.$K(n.ConversationNodes,"ConversationNodes");_a.$3.$pj(n.ConversationNodes.length,0,"ConversationNodes.Length");_a.$3.$K(n.LastModifiedTime,"LastModifiedTime")},$7xR:function(n){return _e.$PN.$1OJ(n)},$7xV:function(n){return new ItemMetadata}};_e.$bK=function(n,t,i){_a.$3.$K(n,"syncStateItemStore");_a.$3.$K(t,"conversationItemStore");_a.$3.$K(t,"conversationNodeItemStore");this.$2hs=n;this.$1tt=t;this.$5Jk=i};_e.$bK.$AAA=function(n,t,i){_a.$3.$K(n,"tx");_a.$3.$K(t,"conversationItemStore");_a.$3.$K(i,"conversationIds");for(var u=i,f=u.length,r=0;r<f;++r){var e=u[r];var o=n.$Dv(_e.$1G.get_$I().$iY.get_$1N());var s=new _a.$8o(_e.$6s.get_$3no(),e.Id);var h=new _a.$8P(s,null);o.$JP(h,function(i){i.$Ds(100,function(i,r,u){for(var e=r,s=e.length,f=0;f<s;++f){var h=e[f];var o=t.$14V(h);o.set_$5Pe(0);t.$uj(n,o,1,null)}},null)},null)}};_e.$bK.prototype={$2hs:null,$1tt:null,$5Jk:null,$5ra:0,$2Oq:function(n,t){_a.$3.$K(n,"successCallback");var r=null;var i=this,u=this,f=this;this.$1tt.$Bl(new _a.$6i("ConversationSyncStateProvider.GetState"),function(n){_e.$6s.$83C(n,i.$1tt,i.$5ra,function(t,u){var o=0;var f={};if(t.length)for(var e=0;e<t.length;e++)i.$5Jk.$Fu(n,_e.$1l.$5h(t[e].Id),function(n){n&&(f[n.get_$1r().ConversationId.Id]=n.get_$1r().SyncState);++o===t.length&&(r=i.$2hs.$rP(new ConversationItemSyncState(t,u,f)))},null);else r=i.$2hs.$rP(new ConversationItemSyncState(t,u,f))})},function(){n(r)},function(n){_js.Trace.logError(_e.$1n.$A,"ClientStore returned error while trying to fetch dirty conversation list or conversation sync state. Error = {0}",n.$3j);t&&t(new _e.$1g(n))})},$AAJ:function(n,t,i,r){r()},$3Wi:function(n,t){t()},$4Sd:function(n,t){_e.$bK.$AAA(n,this.$1tt,t.$6L)},$7rR:function(n){throw Error.notImplemented("NYI");},$2OD:function(){return new ConversationItemSyncState([],{},{})},$5Zq:function(n){return $5(n)?this.$2OD():n.get_$1r()},$5XO:function(n){throw Error.notImplemented("This is implemented only in MultiFolderSyncStateProvider");}};_e.$By=function(){_e.$By.initializeBase(this)};_e.$By.get_$33p=function(){return new _a.$4w("Data.InstanceKey")};_e.$By.$1OJ=function(n){_a.$3.$K(n,"data");_a.$3.$K(n.ItemId,"data.ItemId");_a.$3.$1G(n.ItemId.Id,"data.ItemId.Id");return _e.$1l.$5h(n.ItemId.Id)};_e.$By.$88x=function(n,t,i,r,u){_a.$3.$K(i,"folderMappings");_a.$3.$K(r,"successCallback");_a.$3.$85(t,0,10,"maxEntriesToReturn");var f=[];var e=0;var s={};var o=!1;n.$Bl(new _a.$6i("MessageItem.GetUnsyncedItems"),function(r){var u=r.$Dv(_e.$1G.get_$I().$zC.get_$1N());var h=new _a.$8o(MessageItemMetadata.$5hw(),"false");var c=new _a.$8P(h,[new _a.$If(MessageItemMetadata.$2CX(),1)]);u.$JP(c,function(r){r.$Ds(t*3,function(r,u,h){while(f.length<t&&e<u.length){var a=u[e];var c=n.$14V(a).get_$1r();var l=c.ItemId.Id;e||(o=i.doesIdEqualName(c.ParentFolderId,"drafts"));if(o===i.doesIdEqualName(c.ParentFolderId,"drafts")){Array.add(f,new _g.$1t(l));s[l]=c.ItemId.ChangeKey}e++}},null)},null)},function(){_js.Trace.logInfo(_e.$1n.$A,"Found {0} unsynced items",f.length);r(f,s,o)},function(n){_e.$1g.$DN(n,u)})};_e.$By.$7i6=function(n,t){_a.$3.$K(n,"item");var i=MessageItemRecord.$2Nu(n);return!$5(i.CustomSyncData)&&i.CustomSyncData.ItemShape>t};_e.$By.$2fN=function(n,t,i){_a.$3.$K(n,"item");_a.$3.$K(t,"isDataSynced");MessageItemRecord.$2Nu(n).CustomSyncData=new CustomSyncData(t,i)};_e.$By.$887=function(n){if(_g.$h.$1i.doesIdEqualName(n.ParentFolderId,"sentitems")){$5(n.DateTimeSent)&&_js.Trace.logError(_a.$0.$5c,"For item with item id {0}, the parent folder id is sent items folder i.e. {1} and the date time sent is undefined",n.ItemId.Id,n.ParentFolderId.Id);return n.DateTimeSent}else if(_g.$h.$1i.doesIdEqualName(n.ParentFolderId,"drafts")||_g.$h.$1i.doesIdEqualName(n.ParentFolderId,"outbox")){$5(n.DateTimeCreated)&&_js.Trace.logError(_a.$0.$5c,"For item with item id {0}, the parent folder id is drafts or outbox folder i.e. {1} and the date time created is undefined",n.ItemId.Id,n.ParentFolderId.Id);return n.DateTimeCreated}return n.DateTimeReceived};_e.$By.prototype={get_$iW:function(){return _e.$1G.get_$I().$zC},$5Gq:function(n,t,i){var r=null;if(n.__type===_g.$IV._dataContractName)r=_g.$IV.changeTimeZone;else if(n.__type===_g.$LI._dataContractName){if(t!==i&&n){r=_g.$LI.changeTimeZone;var u=n;if(u.ChangeHighlights){u.ChangeHighlights.Start=this.$6j.get_$Tt().$2x(t,i,u.ChangeHighlights.Start);u.ChangeHighlights.End=this.$6j.get_$Tt().$2x(t,i,u.ChangeHighlights.End)}}}else n.__type===_g.$KG._dataContractName?r=_g.$KG.changeTimeZone:n.__type===_g.$Mk._dataContractName&&(r=_g.$Mk.changeTimeZone);r?r(n,t,i,this.$6j.get_$Tt()):_e.$uN.prototype.$5Gq.call(this,n,t,i);if(n.ExtendedProperty)for(var o=n.ExtendedProperty,s=o.length,e=0;e<s;++e){var f=o[e];f.ExtendedFieldURI.PropertyTag===_g.$m.get_$jv().PropertyTag&&f.Value&&(f.Value=this.$6j.get_$Tt().$2x(t,i,f.Value))}},$AEy:function(n){_a.$3.$K(n.ItemId,"itemId");_a.$3.$1G(n.ItemId.Id,"itemId.Id");_a.$3.$1G(n.ItemId.ChangeKey,"itemId.ChangeKey");_a.$3.$K(n.ParentFolderId,"ParentFolderId");_a.$3.$1G(n.ParentFolderId.Id,"ParentFolderId.Id");_a.$3.$1G(n.DateTimeReceived,"DateTimeReceived");_a.$3.$1G(n.InstanceKey,"InstanceKey");var t=MessageItemRecord.$2Nu(n);$5(t.CustomSyncData)&&_e.$By.$2fN(n,CustomSyncData.$1uW,2)},$7xR:function(n){return _e.$By.$1OJ(n)},$7xV:function(n){var t=_e.$By.$887(n);var i=$5(n.IsClutter)?!1:n.IsClutter;return new MessageItemMetadata(n.ParentFolderId.Id,t,i,MessageItemRecord.$2Nu(n).CustomSyncData.IsDataSynced)}};function MessageItemMetadata(n,t,i,r){MessageItemMetadata.initializeBase(this);this.ParentClientStoreId=n;this.SortDateTime=t;this.ParentClientStoreIdAndClutter=_e.$7q.$E(n,i);this.IsDataSynced=r}MessageItemMetadata.$1Tt=function(){return new _a.$4w("Metadata.ParentClientStoreId")};MessageItemMetadata.$1Ts=function(){return new _a.$4w("Metadata.ParentClientStoreIdAndClutter")};MessageItemMetadata.$2CX=function(){return new _a.$4w("Metadata.SortDateTime")};MessageItemMetadata.$5hw=function(){return new _a.$4w("Metadata.IsDataSynced")};MessageItemMetadata.prototype={ParentClientStoreId:null,ParentClientStoreIdAndClutter:null,SortDateTime:null,IsDataSynced:null};_e.$lP=function(n,t){_e.$lP.initializeBase(this,[n,t])};_e.$lP.prototype={get_$vB:function(){return _e.$1G.get_$I().$zC.get_$1N()},$4iJ:function(n,t,i){var r=this;this.$1KP(n,t,function(n){if($5(n)){_js.Trace.logWarning(_a.$0.$5c,"Message with id {0} not found in local store",t);return}_e.$PO.$4iJ(n,i)})}};_e.$Ug=function(n,t){_e.$Ug.$$(this.$$gta["_e.$Ug"].TInterface,this.$$gta["_e.$Ug"].TItem).initializeBase(this,[n,t])};_e.$Ug.$$=function(n,t){var i="$Ug"+"$2"+"$"+n.getName().replace(/\./g,"_")+"$"+t.getName().replace(/\./g,"_");if(!_e[i]){var r=_e[i]=function(){(this.$$gta=this.$$gta||{})["_e.$Ug"]={TInterface:n,TItem:t};for(var r=[],i=0;i<arguments.length;++i)r[i]=arguments[i];_e.$Ug.apply(this,r)};r.registerClass("_e."+i,_e.$eP.$$(n,t,_g.$7j));var f=_e.$Ug.prototype;for(var e in f){var u={key:e,value:f[e]};"constructor"!==u.key&&(r.prototype[u.key]=u.value)}r.$3yd=function(n,t){var i;i=t==="Clutter"?new _a.$8o(MessageItemMetadata.$1Ts(),_e.$7q.$E(n,!0)):t==="NoClutter"?new _a.$8o(MessageItemMetadata.$1Ts(),_e.$7q.$E(n,!1)):new _a.$8o(MessageItemMetadata.$1Tt(),n);return i}}return _e[i]};_e.$Ug.prototype={$2k:null,$5Uh:null,$4C7:null,get_$o:function(){return this.$2k},get_$AIs:function(){return this.$5Uh},$5YR:function(n,t,i,r,u,f,e){_a.$3.$K(n,"folderId");_a.$3.$K(t,"folderItemStore");_a.$3.$K(i,"request");_a.$3.$K(r,"actionContext");_a.$3.$K(f,"successCallback");this.$2k=n;this.$5Uh=t;this.$4C7=u;var o=this;_e.$eP.prototype.$AIf.call(this,i.Paging,_e.$By.get_$33p(),function(){var t=_e.$Ug.$$(o.$$gta["_e.$Ug"].TInterface,o.$$gta["_e.$Ug"].TItem).$3yd(n,i.ClutterFilter);return new _a.$8P(t,[new _a.$If(MessageItemMetadata.$2CX(),1)])},f,e)},$5a4:function(n,t){t(this.$4C7.TotalCount)},$4UU:function(n,t){for(var u=this.$5Zi(this.$4C7.OldestReceivedTime),f=_a.$7.$3x(u).$L7().$5X(),i=0;i<n.length;++i){var e=this.$14V(n[i]);var r=e.get_$1r();var o=_a.$7.$3x(r.DateTimeReceived).$L7().$5X();if(o>=f){this.$9K8(r);Array.add(t,r)}else break}_js.Trace.logInfo(_e.$1n.$A,"GetItems: Returning {0} results to the caller",t.length)},$9K8:function(n){n.Body=null;n.NormalizedBody=null;n.UniqueBody=null;n.Attachments=null;n.ToRecipients=null;n.CcRecipients=null;n.BccRecipients=null}};_e.$2U=function(){_e.$2U.initializeBase(this)};_e.$2U.$7xU=function(n,t){_a.$3.$K(n,"folderId");_a.$3.$K(t,"personaId");return _e.$EM.$14T(n,t)};_e.$2U.$3kJ=function(n,t,i,r,u,f,e){_a.$3.$K(n,"store");_a.$3.$K(r,"folderId");_a.$3.$K(f,"successCallback");if(t<0)throw Error.argumentOutOfRange("offset");if(i<0)throw Error.argumentOutOfRange("maxItemsToReturn");var h=_e.$2U.$5KD(u);var o=[];var s=0;n.$Bl(new _a.$6i("PartialPersonaItem.BrowsePeople"),function(u){var f=u.$Dv(_e.$1G.get_$I().$1Tw.get_$1N());var e=new _a.$8o(_e.$2U.$1wk,r.Id);var c=new _a.$8P(e,h);f.$JP(c,function(r){r.$C(function(n){s=n},null);r.$1W9(t,function(){r.$Ds(i,function(t,i,r){for(var f=i,e=f.length,u=0;u<e;++u){var s=f[u];var h=n.$14V(s);Array.add(o,h.get_$1r().Persona)}},null)},null)},null)},function(){f(o,s)},function(n){_e.$1g.$DN(n,e)})};_e.$2U.$5KD=function(n){var i=null;if(!$5(n)){i=new Array(n.length);for(var t=0;t<n.length;t++){var r=_e.$2U.$5Zc(n[t].Path.FieldURI);var u=n[t].Order==="Ascending"?0:1;i[t]=new _a.$If(r,u)}}return i};_e.$2U.$7je=function(n,t){var i=n.Item;var r=i.Item.FieldURI;var u=_e.$2U.$5Zc(r);var f=i.FieldURIOrConstant.Item.Value;var e=_e.$2U.$8T2(f,t);return new _a.$OB(u,e,1,0)};_e.$2U.$5Zc=function(n){switch(n){case"PersonaCompanyName":return _e.$2U.$2sr;case"PersonaHomeCity":return _e.$2U.$32e;case"PersonaCreationTime":return _e.$2U.$2uF;case"PersonaRelevanceScore":return _e.$2U.$4Vk;case"PersonaDisplayNameFirstLast":return _e.$2U.$1Ck;case"PersonaDisplayNameLastFirst":return _e.$2U.$1Nq;case"PersonaWorkCity":return _e.$2U.$3YU;default:throw Error.invalidOperation(String.format("Sorting by '{0}' isn't supported",n));}};_e.$2U.$8T2=function(n,t){return t[n]};_e.$2U.prototype={get_$iW:function(){return _e.$1G.get_$I().$1Tw},$7xR:function(n){return _e.$2U.$7xU(n.FolderId,n.Persona.PersonaId)},$7xV:function(n){return new ItemMetadata},$AEy:function(n){_a.$3.$K(n.FolderId,"FolderId");_a.$3.$1G(n.FolderId.Id,"FolderId.Id");_a.$3.$K(n.Persona.PersonaId,"Persona.PersonaId");_a.$3.$1G(n.Persona.PersonaId.Id,"Persona.PersonaId.Id")},$5Gq:function(n,t,i){_e.$M2.$5Gn(n.Persona,t,i,this.$6j.get_$Tt())}};_e.$V9=function(n,t,i,r){_e.$V9.initializeBase(this,[n,t,i,!0,r,3])};function $3c7(n,t,i){for(var o=i,l=o.length,r=0;r<l;++r){var u=o[r];var f=null;if(t==="RowDeleted"){var s=n.$AHZ(u.$3D);if(!s){_js.Trace.logInfo(_a.$0.$QX,String.format("PersonaType item not present in client store id: {0}",u.$3D.toString()));return}f=s.get_$1r()}else{var a=u.$27;f=a.Data}for(var h=f.FolderIds,v=h.length,e=0;e<v;++e){var c=h[e];c&&_e.$2r.$5Vy(c.Id,t,n.get_$2fx())}}}_e.$V9.prototype={get_$vB:function(){return _e.$1G.get_$I().$1aD.get_$1N()},get_$2fx:function(){return!0},$80m:function(n){$3c7(this,"RowAdded",n.get_$lz());$3c7(this,"RowModified",n.get_$mU());$3c7(this,"RowDeleted",n.get_$13W())},$30F:function(n){return n.get_$3nE()}};_e.$1CZ=function(n){_e.$1CZ.initializeBase(this);this.$6j=n};_e.$1CZ.prototype={$6j:null,$6Qc:function(n){this.$6j.$qd(n)}};_e.$6P=function(n,t,i,r,u){_a.$3.$K(n,"completePersonaItemStore");_a.$3.$K(t,"partialPersonaItemStore");_a.$3.$K(i,"addressbookOperationItemStore");_a.$3.$K(r,"addressbookPersonaItemStore");_a.$3.$K(u,"clientStoreSettings");this.$1te=n;this.$uG=t;this.$3hP=i;this.$3hQ=r;this.$5Ht=u};_e.$6P.$$cctor=function(){_e.$6P.$2JS=[]};_e.$6P.$E=function(n){_a.$3.$m(n,"storeGetter");return new _e.$6P(n.get_$3nE(),n.get_$6Ps(),n.get_$7Yr(),n.get_$7Ys(),new _e.$AE(n))};_e.$6P.$9mL=function(n){_a.$3.$K(n,"observer");Array.add(_e.$6P.$2JS,n)};function $79T(n,t){var i=t.DisplayNameLastFirst||"";if(_js.$8.$15(i)){i+=t.Surname||"";i+=t.GivenName||""}return i}function $79S(n,t){var i=t.DisplayNameFirstLast||"";if(_js.$8.$15(i)){i+=t.GivenName||"";i+=t.Surname||""}return i}function $4uL(n,t,i,r,u){var f=$79P(n,i,r);var e=this;n.$uG.$Nr(t,f,function(t){t.$Ds(1,function(t,f,e){$79V(n,i,r,f);u()},null)})}function $79V(n,t,i,r){if(r.length>0){var u=n.$uG.$14V(r[0]);if(i===1){t.DisplayNameFirstLastSortKey=(u.get_$1r().Persona.DisplayNameFirstLastSortKey||"")+"00";t.DisplayNameFirstLastHeader=u.get_$1r().Persona.DisplayNameFirstLastHeader}else{t.DisplayNameLastFirstSortKey=(u.get_$1r().Persona.DisplayNameLastFirstSortKey||"")+"00";t.DisplayNameLastFirstHeader=u.get_$1r().Persona.DisplayNameLastFirstHeader}}}function $79P(n,t,i){var r=null;var u=null;if(i===1){r=_e.$2U.$3sT;u=$79S(n,t)}else{r=_e.$2U.$3sV;u=$79T(n,t)}var f=new _a.$OB(r,u,0,1);return new _a.$8P(f,[new _a.$If(r,1)])}function $79R(n,t,i){var r=new PartialPersonaRecord(t,i);return n.$uG.$rP(r)}function $79Q(n,t){var i=new _g.$D7;i.PersonaId=t.PersonaId;i.ADObjectId=t.ADObjectId;i.PersonaTypeString=t.PersonaTypeString;i.EmailAddress=t.EmailAddress;i.CompanyName=t.CompanyName;i.DisplayName=t.DisplayName;i.DisplayNameFirstLast=t.DisplayNameFirstLast;i.DisplayNameLastFirst=t.DisplayNameLastFirst;i.GivenName=t.GivenName;i.Surname=t.Surname;i.EmailAddresses=t.EmailAddresses;i.ImAddress=t.ImAddress;i.FileAs=t.FileAs;i.HomeCity=t.HomeCity;i.WorkCity=t.WorkCity;i.CreationTimeString=t.CreationTimeString;i.DisplayNameFirstLastHeader=t.DisplayNameFirstLastHeader;i.DisplayNameLastFirstHeader=t.DisplayNameLastFirstHeader;i.RelevanceScore=t.RelevanceScore;i.ThirdPartyPhotoUrlsArray=t.ThirdPartyPhotoUrlsArray;i.AttributionsArray=t.AttributionsArray;i.Alias=t.Alias;i.CompanyNameSortKey=t.CompanyNameSortKey;i.DisplayNameFirstLastSortKey=t.DisplayNameFirstLastSortKey;i.DisplayNameLastFirstSortKey=t.DisplayNameLastFirstSortKey;i.HomeCitySortKey=t.HomeCitySortKey;i.WorkCitySortKey=t.WorkCitySortKey;return i}function $79U(n,t,i){_e.$6P.$4cy?i(_e.$6P.$4cy):n.$5Ht.$86Q(t,i)}_e.$6P.prototype={$1te:null,$uG:null,$3hP:null,$3hQ:null,$5Ht:null,$3kJ:function(n,t,i,r,u,f){_e.$2U.$3kJ(this.$uG,n,t,i,r,u,f)},$9sq:function(n,t,i,r,u){_a.$3.$K(n,"condition");_a.$3.$K(t,"folderId");_a.$3.$K(i,"sortParams");_a.$3.$K(r,"successCallback");var f=-1;var e=this,o=this,s=this;this.$uG.$Bl(new _a.$6i("PersonaStore.SeekToCondition"),function(r){$79U(e,r,function(u){var e=_e.$2U.$5KD(i);var o=_e.$2U.$7je(n,u);var s=r.$Dv(_e.$1G.get_$I().$1Tw.get_$1N());var h=new _a.$8o(_e.$2U.$1wk,t.Id);var c=new _a.$8P(h,e);s.$JP(c,function(n){n.$1mJ(0,o,function(t){f=n.get_$JQ()},null)},null)})},function(){r(f)},function(n){_e.$1g.$DN(n,u)})},$Fu:function(n,t,i,r){var u=this;this.$1te.$Fu(n,_e.$M2.$3v5(t),function(n){i(n?n.get_$1r():null)},r)},$uj:function(n,t,i,r){var f=null;var s=this.$1te.$rP(t);var c=this;this.$1te.$uj(n,s,i,function(n){f=new _g.$1t(n.toString())});var e={};var h=new _a.$8o(_e.$2U.$3M2,t.PersonaId.Id);var u=this;this.$uG.$6UN(n,new _a.$8P(h,null),100,function(o,s,h,c){for(var v=h,d=v.length,l=0;l<d;++l){var g=v[l];var y=u.$uG.$14V(g);e[y.get_$1r().FolderId.Id]=y.get_$1y()}if(c){for(var nt=$79Q(u,t),tt=0,p=t.FolderIds,it=p.length,a=0;a<it;++a){var w=p[a];delete e[w.Id];var rt=$79R(u,nt,w);u.$uG.$uj(n,rt,i,function(n){++tt===t.FolderIds.length&&f&&_e.$1g.$AHa(_g.$1t,f,r)})}var b=e;for(var k in b){var ut={key:k,value:b[k]};u.$uG.$II(n,ut.value)}}},null);var o=this;Array.forEach(_e.$6P.$2JS,function(i){var r=i;r.$9Yo(t,n,o.$3hP,o.$3hQ)})},$II:function(n,t){var i=this;this.$Fu(n,t,function(r){i.$1te.$II(n,_e.$M2.$3v5(t));var u=new _a.$8o(_e.$2U.$3M2,t.Id);i.$uG.$1uq(n,u,null);r&&Array.forEach(_e.$6P.$2JS,function(t){var u=t;u.$6Ix(r,n,i.$3hP,i.$3hQ)})},null)},$qd:function(n){this.$1te.$qd(n);this.$uG.$qd(n)},$5W5:function(n,t,i){var r=2;var u=0;var f=this;$4uL(this,n,t,1,function(){++u===r&&i()});var e=this;$4uL(this,n,t,0,function(){++u===r&&i()})}};_e.$ff=function(n,t,i,r,u,f,e){_e.$ff.initializeBase(this);this.$6j=n;this.$5Ij=i;this.$6Pt=r;this.$Fj=t;this.$1XE=u;this.$1ut=f;this.$48v=e};function $4uM(n,t,i){for(var f=0,e=n.$1XE.length-i,r=Math.min(e,5),u=0;u<r;u++){var o=n.$1XE[i+u];var s=this;n.$6j.$uj(t,o,1,function(){++f===r&&$4uM(n,t,i+r)})}}_e.$ff.prototype={$6j:null,$1XE:null,$1ut:null,$5Ij:null,$6Pt:null,$2Ls:null,$1lM:null,$48v:null,$Fj:null,get_$5P6:function(){return this.$2Ls?_0365f.$5F.$C(this.$2Ls):0},get_$3Np:function(){return this.$1lM?this.$1lM.length:0},$9kz:function(n,t,i){this.$2Ls={};var r=this;_e.$3Z.$9kz(_bc.$qf,n,this.$5Ij,t,this.$2Ls,function(){_e.$3Z.$9kz(_bc.$rC,n,r.$6Pt,t,r.$2Ls,i)})},$9gf:function(n){},$6Qc:function(n){this.$1XE&&$4uM(this,n,0);if(this.$1ut)for(var i=this.$1ut,r=i.length,t=0;t<r;++t){var u=i[t];this.$6j.$II(n,u)}this.$48v&&this.$Fj.$9x0(n,this.$48v,null)}};function ConfigChangeCleanupModuleItem(n,t){_a.$3.$K(t,"syncManagerStartTime");this.ModuleType=n;this.SyncManagerStartTime=t}ConfigChangeCleanupModuleItem.prototype={ModuleType:0,SyncManagerStartTime:null};function MessageItemRecord(){MessageItemRecord.initializeBase(this)}MessageItemRecord.$2Nu=function(n){return n};MessageItemRecord.prototype={CustomSyncData:null};_e.$6A=function(){_e.$6A.initializeBase(this)};_e.$6A.$W=function(n,t,i,r,u){var f=n===Number||Type.isEnum(n)?0:n===Boolean?!1:null;t.$Bl(new _a.$6i(String.format("SettingItem.GetValue({0})",i)),function(r){_e.$6A.$AIq(n,t,r,i,function(n){f=n})},function(){r(f)},_e.$1g.$aG(u))};_e.$6A.$AIq=function(n,t,i,r,u){t.$Fu(i,_e.$1l.$5h(r),function(t){if(t){var i=t.get_$1r();u(i.Value)}else u(n===Number||Type.isEnum(n)?0:n===Boolean?!1:null)},null)};_e.$6A.$M=function(n,t,i,r,u,f){t.$Bl(new _a.$6i(String.format("SettingItem.SetValue({0})",i)),function(u){_e.$6A.$AIr(n,t,u,i,r,null)},function(){u()},_e.$1g.$aG(_e.$1g.$5Kk(f)))};_e.$6A.$AIr=function(n,t,i,r,u,f){var e=new SettingRecord;e.Id=r;e.Value=u;var o=t.$rP(e);o.$E1(i,function(){_e.$1g.$lC(f)})};_e.$6A.$2vi=function(n,t){_e.$y.$AHV(_e.$6A,n,_e.$1l.$5h(t),null)};_e.$6A.prototype={get_$iW:function(){return _e.$1G.get_$I().$2fj},$7xV:function(n){return new ItemMetadata},$7xR:function(n){return _e.$1l.$5h(n.Id)},$AEy:function(n){}};_e.$AE=function(n){this.$6j=n.get_$6df();this.$6kN=n.get_$1oP()};_e.$AE.$2Nr=function(n){var t=new _e.$UR(n,_e.$1n.$7s);return new _e.$AE(t)};_e.$AE.$7qb=function(n){_e.$6A.$2vi(n,"CalendarFolders")};_e.$AE.$7qq=function(n){_e.$6A.$2vi(n,"FavoriteFolders")};_e.$AE.$7rF=function(n){_e.$6A.$2vi(n,"OtherMailboxConfiguration")};function $4uO(n){_js.Trace.logInfo(_a.$0.$5c,"Mark email data as outdated");var t=new _e.$l6(_a.$74.$E());t.$3hB(11,"")}function $79X(n,t,i,r){_e.$6A.$M(String,n.$6j,"DatabaseId",t,i,r)}_e.$AE.prototype={$6j:null,$6kN:null,$82l:function(n,t){var i=this;_e.$6A.$W(String,this.$6j,"DatabaseId",n,function(n){t(n.$Sd())})},$86n:function(n,t){var i=this;_e.$6A.$W(Boolean,this.$6j,"Provisioned",n,function(n){t(n.$Sd())})},$rU:function(n,t){_e.$6A.$W(_g.$LT,this.$6j,"OwaUserConfiguration.1",n,t)},$9x8:function(n,t,i){_e.$6A.$M(Boolean,this.$6j,"Provisioned",n,t,i)},$1mr:function(n,t){var i=this,r=this;this.$rU(function(r){if(r){(r.UserOptions.ConversationSortOrder!==n.ConversationSortOrder||r.UserOptions.HideDeletedItems!==n.HideDeletedItems)&&$4uO(i);r.UserOptions.ConversationSortOrder=n.ConversationSortOrder;r.UserOptions.HideDeletedItems=n.HideDeletedItems;r.UserOptions.ShowSenderOnTopInListView=n.ShowSenderOnTopInListView;r.UserOptions.ShowPreviewTextInListView=n.ShowPreviewTextInListView;r.UserOptions.ShowInferenceUiElements=n.ShowInferenceUiElements;i.$6j.$Bl(new _a.$6i("Settings.SetLayoutSettings"),function(n){i.$3Rc(n,r,null)},function(){_js.Trace.logInfo(_a.$0.$5c,"SetLayoutSettings to offline store succeeded");t()},function(n){_js.Trace.logError(_a.$0.$5c,"SetLayoutSettings to offline store failed with dbError: {0}",n.$3j);t()})}else{_js.Trace.logWarning(_a.$0.$5c,"When user changes the UserConfig via inline settings, the OwaUserConfiguration has not been synced yet");t()}},function(n){_js.Trace.logError(_a.$0.$5c,"Mark email data outdated when we failed to GetOwaUserConfiguration with clientStoreError: {0}",n.get_$4y());$4uO(r);t()})},$3Rc:function(n,t,i){_e.$6A.$AIr(_g.$LT,this.$6j,n,"OwaUserConfiguration.1",t,i)},$9wt:function(n,t,i){var r=this;this.$rU(function(u){if(u){u.ViewStateConfiguration||(u.ViewStateConfiguration=new _g.$V1);n(u.ViewStateConfiguration);r.$6j.$Bl(new _a.$6i("Settings.SetOwaViewStateConfiguration"),function(n){r.$3Rc(n,u,null)},function(){t()},function(n){i(new _e.$1g(n))})}else t()},i)},$3Rg:function(n,t){var i=this,r=this;this.$rU(function(r){if(r){r.UserOptions.TimeZone=n;i.$6j.$Bl(new _a.$6i("Settings.SetTimeZone"),function(t){_e.$Qi.$2Ou(i.$6kN,t,function(u){for(var f=0;f<u.length;f++)u[f].get_$1r().TimeZoneId===n&&(r.UserOptions.MailboxTimeZoneOffset=[u[f].get_$1r()]);i.$3Rc(t,r,null)},function(n){_js.Trace.logError(_a.$0.$5c,"Failed to load the time zone offsets table: {0}",n.get_$4y())})},function(){_js.Trace.logInfo(_a.$0.$5c,"SetTimeZone {0} to offline store succeeded",n);t()},function(i){_js.Trace.logError(_a.$0.$5c,"SetTimeZone {0} to offline store failed with dbError: {1}",n,i.$3j);t()})}else t()},function(i){_js.Trace.logError(_a.$0.$5c,"SetTimeZone can't retrieve OwaUserConfiguration from offline store, new timezone {0} can't be updated to offline store. ClientStoreError is {1}",n,i.get_$4y());t()})},$84Q:function(n,t){_e.$6A.$AIq(_g.$ql,this.$6j,n,"IdentityCorrelationTable",t)},$9w5:function(n,t,i){_e.$6A.$AIr(_g.$ql,this.$6j,n,"IdentityCorrelationTable",t,i)},$7gy:function(n,t){_e.$6A.$2vi(n,"IdentityCorrelationTable")},$1xF:function(n,t){_e.$6A.$W(_g.$K1,this.$6j,"CalendarFolders",n,t)},$9v3:function(n,t,i){_e.$6A.$AIr(_g.$K1,this.$6j,n,"CalendarFolders",t,i)},$2zx:function(n,t){_e.$6A.$W(_g.$Pg,this.$6j,"FavoriteFolders",n,t)},$14g:function(n,t){_e.$6A.$W(_g.$S8,this.$6j,"OtherMailboxConfiguration",n,t)},$9vX:function(n,t,i){_e.$6A.$AIr(_g.$Pg,this.$6j,n,"FavoriteFolders",t,i)},$9wq:function(n,t,i){_e.$6A.$AIr(_g.$S8,this.$6j,n,"OtherMailboxConfiguration",t,i)},$84k:function(n,t){_e.$6A.$AIq(Boolean,this.$6j,n,"IsOfflineComponentReadyToUse",t)},$9wM:function(n,t,i){_e.$6A.$AIr(Boolean,this.$6j,n,"IsOfflineComponentReadyToUse",t,i)},$86Q:function(n,t){_e.$6A.$AIq(Object,this.$6j,n,"PersonaJumpHeaderMappings",t)},$9x0:function(n,t,i){_e.$6A.$AIr(Object,this.$6j,n,"PersonaJumpHeaderMappings",t,i)}};_e.$Qi=function(){_e.$Qi.initializeBase(this)};_e.$Qi.$2Ou=function(n,t,i,r){_a.$3.$K(n,"timeZoneOffsetsItemStore");_a.$3.$K(i,"successCallback");var u=[];var f=t.$Dv(_e.$1G.get_$I().$2Dh.get_$1N());f.$JP(null,function(t){t.$Ds(1e3,function(t,r,f){for(var e=0;e<r.length;++e)Array.add(u,n.$14V(r[e]));i(u)},null)},function(n){_e.$1g.$DN(n,r)})};_e.$Qi.prototype={get_$iW:function(){return _e.$1G.get_$I().$2Dh},$AEy:function(n){_a.$3.$K(n.TimeZoneId,"TimeZoneId")},$7xR:function(n){return _e.$1l.$5h(n.TimeZoneId)},$7xV:function(n){return new ItemMetadata}};_e.$nV=function(){_e.$nV.initializeBase(this)};_e.$nV.get_$5nO=function(){return new _a.$4w("Data.TombstoneType")};_e.$nV.prototype={get_$iW:function(){return _e.$1G.get_$I().$2Dm},$7xV:function(n){return new ItemMetadata},$7xR:function(n){return _e.$1l.$5h(n.Id)},$AEy:function(n){_a.$3.$1G(n.Id,"id")}};_e.$12E=function(n,t){_e.$12E.initializeBase(this,[n,t])};_e.$12E.prototype={$5Tb:function(n,t,i,r,u){_a.$3.$K(n,"tx");_a.$3.$K(i,"tombstonedItemsToBeDeleted");_a.$3.$K(r,"perItemCallback");_a.$3.$K(u,"completedCallback");var e=100;var o=[];var s=new _a.$8o(_e.$nV.get_$5nO(),t);var h=new _a.$8P(s,null);var f=this;this.$6UN(n,h,e,function(t,e,s,h){_js.Trace.logInfo(_e.$1n.$A,"Found {0} tombstoned items",o.length);for(var l=s,v=l.length,c=0;c<v;++c){var y=l[c];var a=f.$14V(y);r(a.get_$1r());Array.add(i,a.get_$1y())}if(h){_e.$CP.$AId(_bc.$1AI,n,f,i);u()}},null)}};_e.$yg=function(){};_e.$yg.registerInterface("_e.$yg");_e.$13x=function(n){_e.$13x.initializeBase(this,[n,"CalendarSyncState"]);this.$4BX=750};_e.$13x.prototype={$4BX:0,$5gL:function(n,t,i){var r=t;var f=i;if(r.TryToIncrementWindowSizeOnNextSync){_js.Trace.logInfo(_a.$0.$1Qp,"CalendarSyncState.TryToIncrementWindowSizeOnNextSync is true. Need to count the existing items in the store.");var u=this;f.$4Sc(n,function(){_e.$82.$88G(n,function(t){if(t>=u.$4BX){_js.Trace.logInfo(_a.$0.$1Qp,"Calendar sync have exceeded the limit ({0} stored items,) and therefore won't grow the sync window anymore (Approximate Window Size: {1} months).",u.$4BX,r.ApproximateWindowSize);r.TryToIncrementWindowSizeOnNextSync=!1}else _js.Trace.logInfo(_a.$0.$1Qp,"The number of stored calendar items ({0}) are below the limit --> Sync will try to grow the window on next attempt.",t);u.get_$c8().$4Sd(n,r)},function(n){_js.Trace.logError(_a.$0.$1Qp,"Unable to count the existing items in the store (Error: {0}).",n.$9S())})})}else _e.$eH.prototype.$5gL.call(this,n,t,i)}};_e.$82=function(n,t,i,r,u,f,e,o,s){this.$$d_$7rD=Function.createDelegate(this,this.$7rD);_e.$82.initializeBase(this);this.$1lM=_a.$3r.$$(_g.$6Y).$8V();this.$9B=n;this.$wT=_e.$ay.$8V(n);this.$6eW=t;this.$4er=i;this.$2j1=r;this.$3Nw=u;this.$6V8=f;this.$1uy=e;this.$389=o;this.$1KJ=s};_e.$82.$88G=function(n,t,i){_a.$3.$K(n,"tx");_a.$3.$K(t,"callback");var u=-1;var f=-1;var r=function(n){_e.$1g.$DN(n,i)};var e=n.$Dv(_e.$1G.get_$I().$wQ.get_$1N());e.$41s(null,function(n){n.$C(function(n){f!==-1?t(n+f):u=n},r)},r);var o=n.$Dv(_e.$1G.get_$I().$1BM.get_$1N());o.$41s(null,function(n){n.$C(function(n){u!==-1?t(n+u):f=n},r)},r)};_e.$82.$39c=function(n){};function $77H(n,t,i){var r=this;n.$AIN(_g.$1t,t,n.$1uy,_e.$64.$5T9,!0,function(){n.$AIN(_g.$6Y,t,n.$6V8,_e.$Dt.$1OJ,!1,function(){n.$AIN(_g.$6Y,t,n.$2j1,function(n){return n.CalendarItemType==="Single"?_e.$Dt.$1OJ(n):null},!1,i)})})}function $3bx(n,t,i,r,u){var o=n.$3Nw.length-i;var f=Math.min(o,r);_js.Trace.logInfo(_e.$3Z.$A,"CalendarSyncChangeUpdater: Persisting reucrrence masters with instances (startIndex: {0}; remaining: {1}; count: {2})...",i,o,f);if(f)for(var s=0,e=0;e<f;e++){var c=n.$3Nw[i+e];var h=$4tb(n,c);if(h){var l=this;_e.$3Z.$AHH(_bc.$LD,_g.$7j,n.$wT.$1sz,t,h,n.$$d_$7rD,function(e){_e.$82.$39c(e);++s===f&&$3bx(n,t,i+f,r,u)})}else{_js.Trace.logWarning(_e.$3Z.$A,"CalendarSyncChangeUpdater: The data is null/undefined in the RecurrenceMastersWithInstances list.");++s===f&&$3bx(n,t,i+f,r,u)}}else{_js.Trace.logInfo(_e.$3Z.$A,"CalendarSyncChangeUpdater: Done persisting {0} recurrence masters...",n.$3Nw.length);u()}}function $3bw(n,t,i,r,u){var s=n.$2j1.length-i;var f=Math.min(s,r);_js.Trace.logInfo(_e.$3Z.$A,"CalendarSyncChangeUpdater: Persisting updates (startIndex: {0}; remaining: {1}; count: {2})...",i,s,f);if(f)for(var h=0,e=0;e<f;e++){var c=n.$2j1[i+e];var o=$4tb(n,c);if(o){var l=this;_e.$3Z.$AHH(_bc.$MP,_g.$7j,n.$wT.$1BL,t,o,null,function(e){_e.$82.$39c(e);++h===f&&$3bw(n,t,i+f,r,u)})}else{_js.Trace.logWarning(_e.$3Z.$A,"CalendarSyncChangeUpdater: The data is '{0}' in the UpdatedItems list.",o);++h===f&&$3bw(n,t,i+f,r,u)}}else{_js.Trace.logInfo(_e.$3Z.$A,"CalendarSyncChangeUpdater: Done persisting {0} updates.",n.$2j1.length);_e.$1g.$lC(u)}}function $4tc(n,t){for(var r=n.$1uy,u=r.length,i=0;i<u;++i){var f=r[i];if(f.Id===t)return!0}return!1}function $4tb(n,t){var i;if($4tc(n,t.ItemId.Id)){_js.Trace.logInfo(_e.$3Z.$A,"Item present in delete list: {0}",t.ItemId.Id);return null}if(t.CalendarItemType==="Occurrence"){var r=n.$1KJ.get_$3o(t.UID);if(r)if($4tc(n,r)){_js.Trace.logWarning(_e.$3Z.$A,"The master item is deleted for the occurrence with Id {0}",t.ItemId.Id);return null}else{i=n.$389.get_$3o(r);i.ItemId=t.ItemId;i.CalendarItemType=t.CalendarItemType;i.Start=t.Start;i.StartWallClock=t.StartWallClock;i.End=t.End;i.EndWallClock=t.EndWallClock;i.Recurrence=undefined;i.IsRecurring=!0;i.ItemClass="IPM.Appointment.Occurrence"}else{_js.Trace.logInfo(_e.$3Z.$A,"The master item is not downloaded for the occurrence with UID {0}",t.UID);i=n.$389.get_$3o(t.ItemId.Id)}}else i=n.$389.get_$3o(t.ItemId.Id);if(!i){var u=String.format("Could not find the data for item (Type: {0}; ID: {1}; UID: {2}).",t.CalendarItemType,t.ItemId.Id,t.UID);_js.Trace.logError(_e.$3Z.$A,u);throw Error.create(u);}return i}function $77I(n,t,i){if(n.$6eW){_js.Trace.logInfo(_e.$3Z.$A,"Prune calendar items ending before (not including) the sync window's start time ('{0}')...",n.$4er);var r=new _a.$OB(_e.$64.$3u1,n.$4er,0,1);var u=this;n.$wT.$1BL.$1uq(t,r,function(){i()})}else i()}_e.$82.prototype={$wT:null,$2j1:null,$3Nw:null,$6V8:null,$1uy:null,$389:null,$1KJ:null,$4er:null,$6eW:!1,$9B:null,$13d:null,$1lM:null,get_$5P6:function(){return this.$13d?_0365f.$5F.$C(this.$13d):0},get_$3Np:function(){return this.$1lM?this.$1lM.$AHc():0},$9kz:function(n,t,i){this.$13d={};var r=this;_e.$3Z.$9kz(_bc.$LD,n,this.$9B.get_$mQ(),t,this.$13d,function(){_e.$3Z.$9kz(_bc.$MP,n,r.$9B.get_$1c(),t,r.$13d,i)})},$3wP:function(n){_e.$3Z.$3wP(this.$13d,n)},$9gf:function(n){var t=this;this.$3wP(function(i){var r=t.$1lM.get_$3o(i);$5(r)?_js.Trace.logInfo(_e.$3Z.$A,"Item data not found to reconcile (Id: {0}).",i):r.CalendarItemType==="RecurringMaster"?_e.$3Z.$AHH(_bc.$LD,_g.$6Y,t.$wT.$1sz,n,r,null,_e.$82.$39c):_e.$3Z.$AHH(_bc.$MP,_g.$6Y,t.$wT.$1BL,n,r,null,_e.$82.$39c)})},$6Qc:function(n){this.$4Sc(n,null)},$4Sc:function(n,t){var i=this;$77I(this,n,function(){_js.Trace.logInfo(_e.$3Z.$A,"CalendarSyncChangeUpdater: Successfully finished prunning calendar items.");$77H(i,n,function(){_js.Trace.logInfo(_e.$3Z.$A,"CalendarSyncChangeUpdater: Successfully finished persisting deletes.");$3bx(i,n,0,1,function(){_js.Trace.logInfo(_e.$3Z.$A,"CalendarSyncChangeUpdater: Successfully finished persisting recurrence masters.");$3bw(i,n,0,25,t)})})})},$AIN:function(n,t,i,r,u,f){var e=i.length;if(i&&e){var o;var a=this;var h=function(n){a.$wT.$5Op(t,n,function(){--e||f()})};if(u){var v=this;o=function(n){v.$wT.$1BL.$2va(t,n,function(){h(n)})}}else o=h;for(var c=i,y=c.length,s=0;s<y;++s){var p=c[s];var l=r(p);l?o(l):e===1?f():--e}}else f()},$7rD:function(n,t,i){var r=this;this.$wT.$5Ol(t,n.get_$1y(),function(u){u||r.$wT.$1BL.$II(t,n.get_$1y());r.$wT.$1sz.$uj(t,n,1,i)})}};_e.$jD=function(n,t,i){_e.$jD.initializeBase(this);_a.$3.$m(n,"calendarFolderId");_a.$3.$m(t,"windowStart");_a.$3.$m(i,"windowEnd");t.localeCompare(i)>0&&Error.argumentOutOfRange("windowStart",t,String.format("Window start has to be less than window end ({0}).",i));this.$5FB=n;this.$1Ki=t;this.$1XT=i};_e.$jD.prototype={$5FB:null,$1Ki:null,$1XT:null};_e.$p1=function(n){_e.$p1.initializeBase(this);_a.$3.$K(n,"cleaner");this.$5HG=n};_e.$p1.prototype={$5HG:null,$6Qc:function(n){_a.$3.$K(n,"tx");this.$5HG(n)}};function ConversationItemSyncState(n,t,i){ConversationItemSyncState.initializeBase(this,["ConversationNodeSyncStateId",n,t]);this.$5Jr=i}ConversationItemSyncState.prototype={$5Jr:null};_e.$bH=function(n,t,i,r,u){_e.$bH.initializeBase(this);_a.$3.$K(n,"itemStoreGetter");_a.$3.$K(t,"conversationChanges");_a.$3.$K(i,"itemChanges");_a.$3.$K(r,"itemIds");_a.$3.$K(u,"attachments");this.$9B=n;this.$5Jf=t;this.$5n4=i;this.$Bg=r;this.$9g=u};function $783(n,t,i,r,u,f){_a.$3.$K(t,"tx");var e=this;$784(n,t,i,f,function(){var f=[];_e.$3Z.$AHK(_bc.$MS,_g.$7j,n.get_$5sU(),t,r,function(n){return _e.$1l.$5h(n.ItemId.Id)},function(e){for(var l=r,a=l.length,o=0;o<a;++o){var s=l[o];var h=e.$NO(s.ItemId.Id)?e.get_$3o(s.ItemId.Id).get_$1r():null;var c=_g.$wB.$8UW(h,s);h&&(c=_g.$Rq.$5KG(h,c));Array.add(f,c)}_e.$3Z.$AHF(_bc.$kS,_g.$bJ,n.get_$5Jl(),t,i,null);_e.$3Z.$AHF(_bc.$MS,_g.$7j,n.get_$5sU(),t,f,null);_e.$3Z.$AHF(_bc.$qZ,AttachmentInfoRecord,n.get_$7bu(),t,u,null)})})}function $784(n,t,i,r,u){for(var o=0,e=i,s=e.length,f=0;f<s;++f){var h=e[f];var c=this;n.get_$5Jl().$Fu(t,_e.$1l.$5h(h.ConversationId.Id),function(f){if(f){var h=f.get_$1r();if(h.ConversationNodes)for(var c=h.ConversationNodes,y=c.length,e=0;e<y;++e)for(var l=c[e],s=0;s<l.Items.length;s++){var a=l.Items[s];var v=a.ItemId.Id;if(!r.get_$3o(v)){var p=n.get_$4gY().$rP(TombstonedItemRecord.$E(v,"MessageItem",a));p.$3Q0(t,1,null)}}}++o===i.length&&u()},null)}}_e.$bH.prototype={$9B:null,$5Jf:null,$5n4:null,$Bg:null,$9g:null,$2w7:null,$3sC:null,$5Jp:null,$8PU:null,get_$5P6:function(){return this.$2w7?_0365f.$5F.$C(this.$2w7)+_0365f.$5F.$C(this.$3sC):0},get_$3Np:function(){return this.$5Jp?this.$5Jp.length+this.$8PU.length:0},get_$5sU:function(){return this.$9B.get_$4y()},get_$5Jl:function(){return this.$9B.get_$Hi()},get_$7bu:function(){return this.$9B.get_$1Lx()},get_$4gY:function(){return this.$9B.get_$4gX()},$6Qc:function(n){$783(this,n,this.$5Jf,this.$5n4,this.$9g,this.$Bg)},$9kz:function(n,t,i){this.$2w7={};this.$3sC={};var r=this;_e.$3Z.$9kz(_bc.$kS,n,this.$9B.get_$Hi(),t,this.$2w7,function(){_e.$3Z.$9kz(_bc.$MS,n,r.$9B.get_$4y(),t,r.$3sC,i)})},$9gf:function(n){}};_e.$TX=function(n,t,i){_e.$TX.initializeBase(this,[n,t,i])};function $785(n,t,i){if(!t.GlobalItemChangeKeys||!t.GlobalItemReadFlags||!i.GlobalItemChangeKeys||!i.GlobalItemReadFlags)return!1;for(var f=0;f<t.GlobalItemIds.length;f++);for(var e=0;e<i.GlobalItemIds.length;e++);if(t.GlobalItemIds.length!==i.GlobalItemIds.length)return!1;var u=t.GlobalItemIds.length;if(t.GlobalItemChangeKeys.length!==u||i.GlobalItemChangeKeys.length!==u)return!1;for(var r=0;r<u;r++)if(t.GlobalItemIds[r].Id!==i.GlobalItemIds[r].Id||t.GlobalItemChangeKeys[r]!==i.GlobalItemChangeKeys[r])return!1;return!0}function $786(n,t,i){if(!n.get_$AIZ().length){i();return}var r=[];var u=this,f=this;_e.$3Z.$AHK(_bc.$18i,_g.$Wj,n.get_$5nN(),t,n.get_$AIZ(),function(n){return _e.$EM.$14T(n.FolderId,n.ConversationId)},function(t){for(var o=n.get_$AIZ(),h=o.length,e=0;e<h;++e){var u=o[e];var s=_e.$EM.$14T(u.FolderId,u.ConversationId);u.DirtyState=2;var f=t.$NO(s.get_$1fW().toString())?t.get_$3o(s.get_$1fW().toString()).get_$1r():null;if(f){if(n.get_$AIY()!==11&&n.get_$AIY()!==10||f.LastModifiedTime!==u.LastModifiedTime){f.DirtyState!==2&&$785(n,u,f)&&(u.DirtyState=1);Array.add(r,u)}}else Array.add(r,u)}n.set_$AIZ(r);i()})}_e.$TX.prototype={$6Qc:function(n){var t=this;$786(this,n,function(){_e.$YP.prototype.$4Sc.call(t,n,function(){t.$AIc(n)})})}};function EmailItemSyncState(n,t,i){EmailItemSyncState.initializeBase(this,[n,""]);_a.$3.$K(t,"itemIds");this.$5Gj=i;this.$6L=t}EmailItemSyncState.prototype={$6L:null,$5Gj:null};_e.$16Y=function(n,t,i,r){_e.$16Y.initializeBase(this,[n,t]);_a.$3.$1G(i,"outboxFolderId");_a.$3.$85(r,0,2147483647,"outboxFolderPositionIndex");this.$17n=i;this.$3L8=r};_e.$16Y.prototype={$17n:null,$3L8:0,$6Qc:function(n){_a.$3.$K(n,"tx");var t=this;this.get_$5nN().$1oq(n,_e.$1l.$5h(this.$17n),function(i){var u=i;var r=t.get_$AIe()[t.$3L8];if(u){r.TotalCount=u.get_$1r().TotalCount;r.UnreadCount=u.get_$1r().UnreadCount}else{r.TotalCount=0;r.UnreadCount=0}_e.$NW.prototype.$6Qc.call(t,n)},null)}};function MessageItemSyncState(n,t,i){MessageItemSyncState.initializeBase(this,["MessageItemSyncStateId",n,t]);this.$49u=i}MessageItemSyncState.prototype={$49u:!1};_e.$Uh=function(n,t,i,r,u){_e.$Uh.initializeBase(this,[n,t,i]);this.$29U=r;this.$1s2=u};function $79K(n,t){for(var i=0;i<n.$29U.length;i++){var r=n.$29U[i];var u=this;n.get_$5nN().$1oq(t,_e.$1l.$5h(r.ItemId.Id),function(n){var i=n;if(i){i.get_$1r().IsRead=r.IsRead;i.$3Q0(t,1,null)}},null)}}function $79J(n,t,i){var r;if(t&&i.ItemId.ChangeKey===t.ItemId.ChangeKey){r=_g.$Rq.$5KI(i,t);if((n.get_$AIY()===11||n.get_$AIY()===10)&&t.IsRead===i.IsRead)return null}else r=i;_e.$By.$2fN(r,"false",0);return r}_e.$Uh.prototype={$29U:null,$1s2:null,$6Qc:function(n){_a.$3.$K(n,"tx");var i=[];var r=this,t=this;_e.$3Z.$AHK(_bc.$MS,_g.$7j,this.get_$5nN(),n,this.get_$AIZ(),function(n){return _e.$1l.$5h(n.ItemId.Id)},function(r){for(var e=t.get_$AIZ(),s=e.length,u=0;u<s;++u){var f=e[u];var h=r.$NO(f.ItemId.Id)?r.get_$3o(f.ItemId.Id).get_$1r():null;var o=$79J(t,h,f);o&&Array.add(i,o)}t.set_$AIZ(i);t.$1s2&&t.$1s2.$5HM(n,t.get_$AIa(),0,function(){});$79K(t,n);_e.$YP.prototype.$4Sc.call(t,n,function(){t.$AIc(n)})})}};_e.$NB=function(n,t){this.$2fi=this.$$gta["_e.$NB"].TItem===Number||Type.isEnum(this.$$gta["_e.$NB"].TItem)?0:this.$$gta["_e.$NB"].TItem===Boolean?!1:null;_e.$NB.$$(this.$$gta["_e.$NB"].TItem).initializeBase(this);_a.$3.$K(n,"setting");_a.$3.$K(t,"persister");this.$2fi=n;this.$6Qe=t};_e.$NB.$$=function(n){var t="$NB"+"$1"+"$"+n.getName().replace(/\./g,"_");if(!_e[t]){var r=_e[t]=function(){(this.$$gta=this.$$gta||{})["_e.$NB"]={TItem:n};for(var i=[],t=0;t<arguments.length;++t)i[t]=arguments[t];_e.$NB.apply(this,i)};r.registerClass("_e."+t,_e.$3Z);var u=_e.$NB.prototype;for(var f in u){var i={key:f,value:u[f]};"constructor"!==i.key&&(r.prototype[i.key]=i.value)}}return _e[t]};_e.$NB.prototype={$6Qe:null,$6Qc:function(n){_a.$3.$K(n,"tx");this.$6Qe(this.$2fi,n)}};_e.$3g=function(){this.$$d_$9wK=Function.createDelegate(this,this.$9wK);this.$2no={};_e.$3g.resolveInheritance();this.apcl=this.$Y;this.rpcl=this.$q;_e.$3g.initializeBase(this);this.add_$4XD(this.$$d_$9wK);this.add_$6Wp(this.$$d_$9wK)};function $770(n,t){var i=t.request.actionHandler;if(i){n.$2no[t.id.toString()]=i;t.request.hasActionHandler=!0}}function $772(n,t){t.request.hasActionHandler&&(t.request.actionHandler=n.$2no[t.id.toString()])}function $771(n,t){delete n.$2no[t.toString()]}function $76y(n,t){_e.$Gl.$45N(t)?n.set_$41R(n.$14v+1):n.$1g3++}function $76z(n,t){_e.$Gl.$45N(t)?n.$14v<=0?_js.Trace.logWarning(_e.$3g.$A,"Trying to decrement HighPriorityActionCount when it is already <= 0, value = {0}",n.$14v):n.set_$41R(n.$14v-1):n.$1g3<=0?_js.Trace.logWarning(_e.$3g.$A,"Trying to decrement LowPriorityActionCount when it is already <= 0, value = {0}",n.$1g3):n.$1g3--}_e.$3g.prototype={$14v:0,$1g3:0,add_$8QA:function(n){this.$Y(_e.$3g.$2Tv.$1k,n)},remove_$8QA:function(n){this.$q(_e.$3g.$2Tv.$1k,n)},add_$6Wp:function(n){this.$Y(_e.$3g.$2dg.$1k,n)},remove_$6Wp:function(n){this.$q(_e.$3g.$2dg.$1k,n)},add_$4XD:function(n){this.$Y(_e.$3g.$2dr.$1k,n)},remove_$4XD:function(n){this.$q(_e.$3g.$2dr.$1k,n)},add_$5GG:function(n){this.$Y(_e.$3g.$2J6.$1k,n)},remove_$5GG:function(n){this.$Y(_e.$3g.$2J6.$1k,n)},add_$5iH:function(n){this.$Y(_e.$3g.$2Rq.$1k,n)},remove_$5iH:function(n){this.$Y(_e.$3g.$2Rq.$1k,n)},add_$9T2:function(n){this.$2G("HighPriorityActionEmptyChanged",n)},remove_$9T2:function(n){this.$2H("HighPriorityActionEmptyChanged",n)},get_$5o6:function(){return this.$W(_e.$3g.$2Tv)},set_$5o6:function(n){this.$M(_e.$3g.$2Tv,n);return n},get_$2df:function(){return this.$W(_e.$3g.$2dg)},set_$2df:function(n){this.$M(_e.$3g.$2dg,n);return n},get_$10r:function(){return this.$W(_e.$3g.$2dr)},set_$10r:function(n){this.$M(_e.$3g.$2dr,n);return n},get_$1tB:function(){return this.$W(_e.$3g.$2J6)},set_$1tB:function(n){this.$M(_e.$3g.$2J6,n);return n},get_$Cb:function(){return this.$W(_e.$3g.$2Rq)},set_$Cb:function(n){this.$M(_e.$3g.$2Rq,n);return n},get_$35Y:function(){return this.$14v>0},get_$41R:function(){return this.$14v},set_$41R:function(n){var t=this.$14v;this.$14v=n;(t<=0&&this.$14v>0||t>0&&this.$14v<=0)&&$ex(this,"HighPriorityActionEmptyChanged");return n},get_$8SS:function(){return this.$1g3},set_$8SS:function(n){this.$1g3=n;return n},$3u5:function(n,t,i){var r=new _g.$3z(n);var u=this;this.$7vd(r,function(n){r.id=n;_js.Trace.logInfo(_e.$3g.$A,"{0} enqueued",_g.$3z.$UW(r));$770(u,r);u.set_$5o6(r);u.set_$2df(!0);$76y(u,r);t(r)},i)},$85g:function(n,t){var i=this;this.$85h(function(t){if(t){_js.Trace.logInfo(_e.$3g.$A,"{0} retrieved as next request.",_g.$3z.$UW(t));$772(i,t)}else{_js.Trace.logInfo(_e.$3g.$A,"No requests available.");i.set_$2df(!1)}n(t)},t)},$85i:function(n,t){var i=this;this.$85j(function(t){if(t)_js.Trace.logInfo(_e.$3g.$A,"{0} retrieved as next response.",_g.$3z.$UW(t));else{_js.Trace.logInfo(_e.$3g.$A,"No responses available.");i.set_$10r(!1)}n(t)},t)},$5WL:function(n,t){this.$81L(n,t)},$34:function(n,t,i,r){$771(this,n);var u=this;this.$9nd(r,n,function(i,r){if(i){_js.Trace.logInfo(_e.$3g.$A,"Action Record {0} removed.",n);$76z(u,r)}else _js.Trace.logInfo(_e.$3g.$A,"Action Record {0} was not present.",n);t(i)},i)},$9xF:function(n,t,i){n.state=1;var r=this;this.$6nN(n,function(){_js.Trace.logInfo(_e.$3g.$A,"{0} response saved.",_g.$3z.$UW(n));r.set_$10r(!0);t()},i)},$ADV:function(n,t,i){n.state=0;var r=this;this.$6nN(n,function(){_js.Trace.logInfo(_e.$3g.$A,"{0} updated in the database.",_g.$3z.$UW(n));t()},i)},$9wK:function(n,t){_js.Trace.logInfo(_e.$3g.$A,"RequestAvailable : {0}",this.get_$2df());_js.Trace.logInfo(_e.$3g.$A,"ResponseAvailable: {0}",this.get_$10r());this.set_$Cb(!this.get_$2df()&&!this.get_$10r())}};_e.$Fv=function(n,t){this.$$d_$A44=Function.createDelegate(this,this.$A44);this.$$d_$9Yf=Function.createDelegate(this,this.$9Yf);this.$$d_$9Yg=Function.createDelegate(this,this.$9Yg);this.$$d_$9Qo=Function.createDelegate(this,this.$9Qo);this.$$d_$9Qp=Function.createDelegate(this,this.$9Qp);this.$x3="";this.$1z=t;this.$Hf=n};function $2FS(n){if(!n.$4UO&&n.get_$8Cj()&&n.get_$7fK()){n.$4UO=!0;n.$x3="Fetching next record...";n.$7xe(n.$$d_$9Qp,n.$$d_$9Qo)}}function $2lO(n){n.$4UO=!1;n.set_$5MT(null);$2FS(n)}_e.$Fv.prototype={$Hf:null,$x2:null,$4UO:!1,$1z:null,get_$7or:function(){return this.$x2?this.$x2.id:0},get_$5MT:function(){return this.$x2},set_$5MT:function(n){this.$x2=n;this.$x3=_g.$3z.$UW(n);return n},$A44:function(n,t){$2FS(this)},$9Qp:function(n){this.set_$5MT(n);this.$x2?this.$9jr(this.$$d_$9Yg,this.$$d_$9Yf):$2lO(this)},$9Qo:function(n){_js.Trace.logWarning(this.$1z,"Failed to fetch next record: {0}",n.message);$2lO(this)},$9Yg:function(){$2lO(this)},$9Yf:function(n){_js.Trace.logWarning(this.$1z,"Processing of {0} failed: {1}",this.$x3,n.message);$2lO(this)}};_e.$IE=function(n){_e.$IE.initializeBase(this,[n.$5BA]);_a.$3.$K(n.$7b,"clientStore");this.$7R=n};_e.$IE.prototype={$7R:null,$1At:function(n,t,i,r){var u=new _e.$AJ(t,this.$7R,n);var f=this,e=this;u.$AHP(function(){_g.$9M.prototype.$1At.call(f,n,t,i,r)},r,function(){_js.Trace.logWarning(_a.$0.$M6,"ApplyConversationAction was rejected by the offline proxy.");_g.$9M.prototype.$1At.call(e,n,t,i,r)})},$1NA:function(n,t,i,r){if(t.isQueued){var u=new _e.$PO(t,this.$7R,n);var f=this,e=this;u.$AHP(function(){_g.$9M.prototype.$1NA.call(f,n,t,function(n,t){n.response=_g.$BG.$xi(u.$33,-2);i(n,u.$33)},r)},r,function(){_js.Trace.logWarning(_a.$0.$M6,"CreateAttachment was rejected by the offline proxy.");e.$7R.get_$Kv().$1NA(n,t,i,r)})}else this.$7R.get_$Kv().$1NA(n,t,i,r)},$mi:function(n,t,i,r){if(t.isQueued){this.$7R.get_$1PK().$1ou(n);var u=new _e.$19(t,this.$7R,n);var f=this,e=this;u.$AHP(function(){_g.$9M.prototype.$mi.call(f,n,t,function(r,f){n.Body.MessageDisposition==="SendAndSaveCopy"&&t.clientStoreItem===2&&u.$6dD(t.itemIds[0],r.id);r.response=_g.$BG.$xi(u.$33,-2);i(r,u.$33)},r)},r,function(){e.$7R.get_$Kv().$mi(n,t,i,function(n){var t=new _bc.$GU(u.$GK,n);var i=Error.create("OfflineErrorInfo",t);r(i)})})}else this.$7R.get_$Kv().$mi(n,t,i,r)},$1u6:function(n,t,i,r){var u=new _e.$PP(t,this.$7R,n.Body.PropertyUpdates,n.Body.ParentFolderId,n.Body.PersonTypeString,this.$7R.get_$Df());var f=this,o=this,e=this;u.$AHP(function(){_g.$9M.prototype.$1u6.call(f,n,t,function(n,t){n.response=_g.$BG.$xi(u.get_$1u(),-2);i(n,u.get_$1u())},function(n){var t=new _bc.$GU(0,n);var i=Error.create(_e.$IE.$1jN,t);r(i)})},function(n){var t=new _bc.$GU(0,n);var i=Error.create(_e.$IE.$1jN,t);r(i)},function(){_g.$9M.prototype.$1u6.call(e,n,t,function(n,t){n.response=_g.$BG.$xi(null,-2);i(n,t)},function(n){var t=new _bc.$GU(0,n);var i=Error.create(_e.$IE.$1jN,t);r(i)})})},$1Nl:function(n,t,i,r,u){i.personaId=n=this.$7R.get_$1PK().$rW(n);var f=new _e.$bx(i,this.$7R,n,this.$7R.get_$Df());var e=this,o=this;f.$AHP(function(){_g.$9M.prototype.$1Nl.call(e,n,t,i,r,u)},u,function(){_g.$9M.prototype.$1Nl.call(o,n,t,i,r,u)})},$1b6:function(n,t,i,r){var u=new _e.$IG(t,this.$7R,n);var f=this,e=this;u.$AHP(function(){_g.$9M.prototype.$1b6.call(f,n,t,function(n,t){n.response=_g.$BG.$xi(u.$33,-2);i(n,u.$33)},r)},r,function(){_js.Trace.logWarning(_a.$0.$M6,"DeleteAttachment service command was rejected by the offline proxy.");_g.$9M.prototype.$1b6.call(e,n,t,i,r)})},$1vs:function(n,t,i,r){var u=new _e.$AO(t,this.$7R,n,_g.$h.$1i,this.$7R.get_$Df());var f=this,o=this,e=this;u.$AHP(function(){_g.$9M.prototype.$1vs.call(f,n,t,i,r)},function(n){_js.Trace.logError(_a.$0.$M6,"EmptyFolder service command failed. Exception: {0}",n);var t=new _bc.$GU(u.$GK,n);var i=Error.create(_e.$IE.$1jN,t);r(i)},function(){_js.Trace.logWarning(_a.$0.$M6,"EmptyFolder service command was rejected by the offline proxy.");e.$7R.get_$Kv().$1vs(n,t,i,function(n){var t=new _bc.$GU(u.$GK,n);var i=Error.create("OfflineErrorInfo",t);r(i)})})},$2yV:function(n,t,i,r){var u=new _e.$B0(t,this.$7R,n,this.$7R.get_$Df(),_g.$h.$1i,this.$7R.$Cn);var e=this,f=this;u.$AHP(function(){i(null,u.$33)},r,function(){_g.$9M.prototype.$2yV.call(f,n,t,i,r)})},$1xF:function(n,t,i){var r=new _e.$Tz(n,this.$7R,this.$7R.get_$Df());var f=this,u=this;r.$AHP(function(){t(null,r.$33)},i,function(){_g.$9M.prototype.$1xF.call(u,n,t,i)})},$2OK:function(n,t,i,r){var u=new _e.$Ph(t,this.$7R,n,this.$7R.get_$Df());var e=this,f=this;u.$AHP(function(){i(null,u.$33)},r,function(){_g.$9M.prototype.$2OK.call(f,n,t,i,r)})},$xY:function(n,t,i,r){var u=new _e.$Tq(t,this.$7R,n,this.$7R.get_$Df());var e=this,f=this;u.$AHP(function(){i(null,u.$33)},r,function(){_g.$9M.prototype.$xY.call(f,n,t,i,r)})},$2NN:function(n,t,i,r){var u=new _e.$3K(t,this.$7R,n,this.$7R.get_$Df(),_g.$h.$1i);var e=this,f=this;u.$AHP(function(){i(null,u.$33)},r,function(){_g.$9M.prototype.$2NN.call(f,n,t,i,r)})},$1cH:function(n,t,i,r){var u=new _e.$AP(t,this.$7R,n,this.$7R.get_$Df());var e=this,f=this;u.$AHP(function(){i(null,u.$33)},r,function(){_g.$9M.prototype.$1cH.call(f,n,t,i,r)})},$1xI:function(n,t,i,r){var u=new _e.$AR(t,this.$7R,n);var e=this,f=this;u.$AHP(function(){i(null,u.$33)},r,function(){_g.$9M.prototype.$1xI.call(f,n,t,i,r)})},$1cw:function(n,t,i){var r=new _e.$17f(n,this.$7R,this.$7R.get_$Df());var f=this,u=this;r.$AHP(function(){t(null,r.$Ck)},i,function(){_g.$9M.prototype.$1cw.call(u,n,t,i)})},$2Og:function(n,t,i,r){var u=new _e.$17h(t,this.$7R,n,this.$7R.get_$Df());var o=this;var f=function(){i(null,u.$33)};var e=this;u.$AHP(f,r,function(){u.$3vE?_g.$9M.prototype.$2Og.call(e,n,t,i,function(n){_js.Trace.logWarning(_a.$0.$M6,"GetPersona service command failed on the server. Falling back to the client store. Error: {0}",n.message);u.$AHP(f,r,function(){r(n)})}):_g.$9M.prototype.$2Og.call(e,n,t,i,r)})},$lq:function(n,t,i,r){this.$7R.get_$1PK().$1ou(n);if(t.clientStoreItem===1){var u=new _e.$77(t,this.$7R,n);var e=this,o=this;u.$AHP(function(){_g.$9M.prototype.$lq.call(e,n,t,function(n,t){n.response=_g.$BG.$xi(u.$33,-2);i(n,u.$33)},r)},r,function(){o.$7R.get_$Kv().$lq(n,t,i,function(n){var t=new _bc.$GU(u.$GK,n);var i=Error.create("OfflineErrorInfo",t);r(i)})})}else{var f=new _e.$3y(t,this.$7R,n);var s=this,h=this;f.$AHP(function(){_g.$9M.prototype.$lq.call(s,n,t,function(r,u){r.response=_g.$BG.$xi(f.$33,-2);n.Body.MessageDisposition==="SendAndSaveCopy"&&t.clientStoreItem===2&&f.$6dD(t.itemIds[0],r.id);i(r,f.$33)},r)},r,function(){_js.Trace.logWarning(_a.$0.$M6,"UpdateItem service command was rejected by the offline proxy.");h.$7R.get_$Kv().$lq(n,t,i,r)})}},$3f:function(n,t,i,r){this.$7R.$g3.$1ou(n);var u=new _e.$6e(t,this.$7R,n);var e=this,f=this;u.$AHP(function(){i(null,u.$33)},r,function(){_g.$9M.prototype.$3f.call(f,n,t,i,function(n){var t=new _bc.$GU(u.$GK,n);var i=Error.create("OfflineErrorInfo",t);r(i)})})},$im:function(n,t,i,r){this.$7R.get_$1PK().$1ou(n);var u=new _e.$9j(t,this.$7R,n);var f=this,e=this;u.$AHP(function(){_g.$9M.prototype.$im.call(f,n,t,i,r)},r,function(){e.$7R.get_$Kv().$im(n,t,i,function(n){var t=new _bc.$GU(u.$GK,n);var i=Error.create("OfflineErrorInfo",t);r(i)})})},$14j:function(n,t,i,r){var u=new _e.$U4(t,this.$7R,n,this.$7R.get_$Df());var e=this,f=this;u.$AHP(function(){i(null,u.$33)},r,function(){_g.$9M.prototype.$14j.call(f,n,t,i,r)})},$2bi:function(n,t,i,r){var u=new _e.$8O(t,this.$7R,n,this.$7R.get_$Df());var f=this,e=this;u.$AHP(function(){_g.$9M.prototype.$2bi.call(f,n,t,function(n){n.response=_g.$BG.$xi(u.$33,-2);i(n)},r)},r,function(){e.$7R.get_$Kv().$2bi(n,t,i,r)})},$1ow:function(n,t,i,r){t.personaId=n.Body.PersonaId=this.$7R.get_$1PK().$rW(n.Body.PersonaId);var u=new _e.$1H1(t,this.$7R,n.Body.PersonaId,n.Body.PropertyUpdates,n.Body.PersonTypeString);var f=this,o=this,e=this;u.$AHP(function(){_g.$9M.prototype.$1ow.call(f,n,t,function(n,t){n.response=_g.$BG.$xi(u.get_$1u(),-2);i(n,u.get_$1u())},function(n){var t=new _bc.$GU(0,n);var i=Error.create(_e.$IE.$1jN,t);r(i)})},function(n){var t=new _bc.$GU(0,n);var i=Error.create(_e.$IE.$1jN,t);r(i)},function(){_js.Trace.logWarning(_a.$0.$M6,"UpdatePersona service command was rejected by the offline proxy.");_g.$9M.prototype.$1ow.call(e,n,t,i,r)})},$rU:function(n,t,i){var r=new _e.$Pl(n,this.$7R);var f=this,u=this;r.$AHP(function(){t(null,r.$b)},i,function(){_g.$9M.prototype.$rU.call(u,n,t,i)})},$1p0:function(n,t,i,r){var u=new _e.$uW(t,this.$7R,n);var f=this,e=this;u.$AHP(function(){_g.$9M.prototype.$1p0.call(f,n,t,i,r)},r,function(){_js.Trace.logWarning(_a.$0.$M6,"UpdateUserConfiguration service command was rejected by the offline proxy.");_g.$9M.prototype.$1p0.call(e,n,t,i,r)})},$1mr:function(n,t,i,r){var u=this;_g.$9M.prototype.$1mr.call(this,n,t,function(f,e){var o=new _e.$gu(t,u.$7R,n);o.$AHP(function(){i(f,e)},r,function(){r(Error.create("SetLayoutSettings was rejected by the offline proxy."))})},r)},$3Rg:function(n,t,i,r){var u=this;_g.$9M.prototype.$3Rg.call(this,n,t,function(f,e){var o=new _e.$1Ek(t,u.$7R,n);o.$AHP(function(){i(f,e)},r,function(){_js.Trace.logWarning(_a.$0.$M6,"SetTimeZone service command was rejected by the offline proxy.")})},r)},$2OJ:function(n,t,i){var r=new _e.$pw(n,this.$7R,this.$7R.get_$Df());var f=this,u=this;r.$AHP(function(){t(null,r.$33)},i,function(){_g.$9M.prototype.$2OJ.call(u,n,t,i)})},$14g:function(n,t,i){var r=new _e.$q3(n,this.$7R,this.$7R.get_$Df());var f=this,u=this;r.$AHP(function(){t(null,r.$33)},i,function(){_g.$9M.prototype.$14g.call(u,n,t,i)})},$1T7:function(n,t,i,r){var u=new _e.$Mn(t,this.$7R,n);var f=this,e=this;u.$AHP(function(){_g.$9M.prototype.$1T7.call(f,n,t,i,r)},r,function(){e.$7R.get_$Kv().$1T7(n,t,i,function(n){var t=new _bc.$GU(u.$GK,n);var i=Error.create("OfflineErrorInfo",t);r(i)})})}};_e.$l6=function(n){this.$4q=n};_e.$l6.prototype={$4q:null,get_$7v2:function(){var n=this.get_$1tk();if(n)for(var t=0;t<n.length;t++){var i=n[t];if(i.ModuleType===11)return!0}return!1},get_$1tk:function(){return this.$AHL(Array,"ConfigChangeCleanupModuleList")},set_$1tk:function(n){n&&this.$4q.$DQ("ConfigChangeCleanupModuleList",JsonParser.serialize(n));return n},$3hB:function(n,t){var u=new ConfigChangeCleanupModuleItem(n,t);var i=this.get_$1tk();if(i){for(var f=!1,e=i,o=e.length,r=0;r<o;++r){var s=e[r];if(s.ModuleType===n){f=!0;break}}f||Array.add(i,u)}else i=[u];this.set_$1tk(i)},$6W6:function(n){var t=this.get_$1tk();if(t)for(var i=0;i<t.length;i++){var r=t[i];if(r.ModuleType===n){Array.removeAt(t,i);this.set_$1tk(t);return}}_js.Trace.logWarning(_a.$0.$1nq,"We didn't find {0} in the cleanup module list",n)},$82M:function(n){var t=null;var i=this.get_$1tk();if(i){t=[];for(var r=0;r<i.length;r++){var u=i[r];u.SyncManagerStartTime!==n&&Array.add(t,u.ModuleType)}}return t},$AHL:function(n,t){var i=this.$4q.$3f(t);return i?JsonParser.deserialize(i):n===Number||Type.isEnum(n)?0:n===Boolean?!1:null}};_e.$6G=function(n,t,i,r,u,f,e,o,s,h,c,l,a){this.$$d_$6pl=Function.createDelegate(this,this.$6pl);_e.$6G.resolveInheritance();this.dispose=this.$1R;_e.$6G.initializeBase(this,[n,i,r,u,f]);_a.$3.$1G(t,"timeZoneId");this.$7s=t;this.$9B=new _e.$UR(n,t);this.$6c8=new _e.$1EH(this.$9B);this.$2cf=o?"MOWA":"DOWA";this.$2Li=s;this.$2Lo=h;this.$Cn=l;this.$4Y=a;_js.Trace.logInfo(_e.$6G.$A,"Protocol: {0}",this.$2cf);_js.Trace.logInfo(_e.$6G.$A,"DeviceId: {0}",this.$2Li);_js.Trace.logInfo(_e.$6G.$A,"DeviceType: {0}",this.$2Lo);Sys.Net.WebRequestManager.add_invokingRequest(this.$$d_$6pl);this.$72=new _e.$AE(this.$9B);this.$g3=new _g.$MR;c&&this.$g3.$6d8(c);this.get_$Kv().$g3=this.$g3;this.$Hf=e;this.$Qg=new _e.$1D3(e,this.$g3);this.$5BA=new _g.$12x(this.get_$Kv(),this.$Qg);this.$5Hs=new _e.$IE(this)};function $4uK(n,t){if(t){var i=this;n.$72.$9w5(t,n.$g3.$5Lb(),function(){_js.Trace.logInfo(_e.$6G.$A,"Identity correlation table persisted.")})}}_e.$6G.prototype={$72:null,$Qg:null,$5BA:null,$5Hs:null,$g3:null,$4Y:null,$2cf:null,$2Li:null,$2Lo:null,$9B:null,$6c8:null,$Hf:null,$7s:null,$1ei:!1,$6Wt:null,$9q9:null,$Cn:null,$2y0:null,get_$7ww:function(){return this.$2y0},set_$7ww:function(n){this.$2y0=n;return n},get_$3YL:function(){return this.$5Hs},get_$7bm:function(){return _e.$5W.$1DQ()},get_$9uc:function(){return this.$6c8},get_$Zt:function(){return this.$Hf},set_$Zt:function(n){this.$Hf=n;return n},get_$1PK:function(){return this.$g3},get_$AU:function(){return this.$9B},get_$Df:function(){return this.$4Y.$rX()},get_$E6:function(){return this.$7s},set_$E6:function(n){this.$7s=n;return n},get_$8Mq:function(){return this.$1ei},$A4A:function(n){this.$6Wt=new _e.$tQ(this,n,this.$J);this.$9q9=new _e.$gR(this.$Hf,this.$$d_$29F,this.$J)},$2K7:function(n,t,i){this.$g3.$2K7(t,i);$4uK(this,n)},$2K8:function(n,t,i){this.$g3.$2K8(t,i);$4uK(this,n)},$rW:function(n){return this.$g3.$rW(n)},$6WN:function(n,t,i){var r=!1;var f=!1;var u=this,e=this,o=this;this.$7b.get_$13M().$Bl(new _a.$6i("OfflineMailboxDataContext.RemoveSendAction"),function(i){u.$9B.get_$h5().$Fu(i,_e.$1l.$5h(n),function(e){if(!e||!e.get_$1r()){_js.Trace.logWarning(_e.$6G.$A,"RemoveSendAction - Outbox item not found: {0}",n);t(r,f,null,null);return}_js.Trace.logInfo(_e.$6G.$A,"RemoveSendAction - Item found: {0}",n);var o=e.get_$UI();if(!o){_js.Trace.logWarning(_e.$6G.$A,"RemoveSendAction - Outbox item context is null: {0}",n);r=!0;t(r,f,null,null);return}_js.Trace.logInfo(_e.$6G.$A,"RemoveSendAction - Calling ActionQueue.Remove, action {0}: {1}",o.ActionId,n);u.$Hf.$34(o.ActionId,function(i){_js.Trace.logInfo(_e.$6G.$A,"RemoveSendAction - Removed Action {0} for item {1}. Results {2}",o.ActionId,n,i);r=o.ActionId!==u.$6Wt.get_$7or();t(r,o.SendAction===1,o.ParentConversationNodeId,o.ComplianceId)},function(n){_js.Trace.logError(_e.$6G.$A,"Failed to remove action from action queue, action id = {0}, Error = {1}",o.ActionId,n.message)},i)},null)},function(){_js.Trace.logInfo(_e.$6G.$A,"RemoveSendAction succeeded for outbox item id {0}.",n)},function(n){_js.Trace.logError(_e.$6G.$A,"RemoveSendAction failed. Error code: '{0}'  Error message: '{1}'",n.$Vs,n.$3j);var t=new _e.$1g(n);i(t.$Sd())})},$2xz:function(n,t,i,r,u){if(!this.$2y0||this.$2y0()){_js.Trace.logInfo(_e.$6G.$A,"ExecuteWithActionQueue enqueueing: {0}",n);var f=new _g.$a6(n,i,null);f.actionHandler=t;f.hasActionHandler=!0;this.$Hf.$3u5(f,r,u)}else _g.$1Y.prototype.$2xz.call(this,n,t,i,r,u)},$3rs:function(){_js.Trace.logInfo(_e.$6G.$A,"Deprovisioning {0}-{1}-{2}",this.$2cf,this.$2Li,this.$2Lo);this.$Hf.set_$1tB(!1);var t=new _g.$c7(this.$2Li,this.$2Lo);t.HasPAL=this.$2cf==="MOWA";var n=new _g.$K9("Exchange2013");n.TimeZoneContext=new _g.$Lo;n.TimeZoneContext.TimeZoneDefinition=new _g.$JZ;n.TimeZoneContext.TimeZoneDefinition.Id=this.$7s;var i=this,r=this;this.get_$Kv().$3rs(new _g.$c5(n,t),null,function(n,t){"Success"===t.Body.ResponseMessages.Items[0].ResponseClass?_js.Trace.logInfo(_e.$6G.$A,"...deprovisioning succeeded."):_js.Trace.logError(_e.$6G.$A,"Deprovision command failed. We're explicitly ignoring this failure. {0}",t.Body.ResponseMessages.Items[0].MessageText);Sys.Net.WebRequestManager.remove_invokingRequest(i.$$d_$6pl)},function(n){_js.Trace.logError(_e.$6G.$A,"Deprovision call failed. We're explicitly ignoring this failure. {0}",n)})},$6d4:function(n,t,i){if(this.$1ei===n){_js.Trace.logWarning(_e.$6G.$A,"IsOfflineComponentReadyToUse: value ({0}) has not changed. Skipping the write to the store.",this.$1ei);_e.$1g.$lC(t)}else{var r=this,u=this,f=this;this.$9B.$Bl(new _a.$6i("OfflineMailboxDataContext.SetIsOfflineComponentReadyToUse"),function(t){r.$72.$9wM(t,n,null)},function(){u.$1ei=n;_js.Trace.logInfo(_e.$6G.$A,"Successfully saved the new value for IsOfflineComponentReadyToUse: {0}",n);_e.$1g.$lC(t)},function(t){_js.Trace.logError(_e.$6G.$A,"IsOfflineComponentReadyToUse: Failed to persist the new value {0} and reverting to the old value {1}. Error: {2}",n,f.$1ei,t.$3j);_e.$1g.$DN(t,i)})}},$8Rh:function(n){var t=this,i=this,r=this;this.$9B.$Bl(new _a.$6i("OfflineMailboxDataContext.LoadIsOfflineComponentReadyToUse"),function(n){t.$72.$84k(n,function(n){t.$1ei=n})},function(){i.$1ei?_js.Trace.logInfo(_e.$6G.$A,"Offline component is ready to use."):_js.Trace.logWarning(_e.$6G.$A,"Offline is enabled but not ready to use yet.");n()},function(t){_js.Trace.logError(_e.$6G.$A,"IsOfflineComponentReadyToUse: Failed to fetch the setting. Falling back to kiosk mode. Error: {0}",t.$3j);n()})},$6pl:function(n,t){t.get_webRequest().get_headers()["X-OWA-Protocol"]=this.$2cf;t.get_webRequest().get_headers()["X-OWA-DeviceId"]=this.$2Li;t.get_webRequest().get_headers()["X-OWA-DeviceType"]=this.$2Lo},$49:function(){Sys.Net.WebRequestManager.remove_invokingRequest(this.$$d_$6pl);_g.$1Y.prototype.$49.call(this)}};_e.$1D3=function(n,t){_e.$1D3.initializeBase(this);_a.$3.$K(n,"actionQueue");_a.$3.$K(t,"identityCorrelationTable");this.$Hf=n;this.$g3=t};_e.$1D3.prototype={$Hf:null,$g3:null,$h:function(n,t,i,r,u,f){var e=this;this.$nV(t,i,r,function(t){u(t,n===Number||Type.isEnum(n)?0:n===Boolean?!1:null)},f)},$nV:function(n,t,i,r,u){_a.$3.$K(r,"invokeSucceeded");_a.$3.$K(u,"invokeFailed");var f=new _g.$a6(n,t,i);this.$g3.$1ou(t);this.$Hf.$3u5(f,r,u)}};_e.$tQ=function(n,t,i){this.$$d_$8Am=Function.createDelegate(this,this.$8Am);this.$$d_$7XL=Function.createDelegate(this,this.$7XL);_e.$tQ.initializeBase(this,[n.$Hf,_a.$0.$4Wj]);this.$QP=n;this.$Bv=n.$Bv;this.$1HT=n.get_$Kv();this.$2AF=n.$2AF;this.$5nU=t;var r=this;i.$Hd(_a.$lf,function(n){_js.Trace.logInfo(r.$1z,"RequestQueueProcessor received NonBootModelResponseProcessorReady event");r.$Hf.add_$6Wp(r.$$d_$A44);r.$Hf.add_$8QA(r.$$d_$7XL);r.$Hf.add_$4XD(r.$$d_$A44);r.$Hf.add_$5GG(r.$$d_$A44);i.$Hd(_a.$TR,r.$$d_$8Am);$2FS(r)})};function $79W(n,t,i){var r=n.$x2;var f=_a.$7.get_$2F();var e=n.$2AF.$6eB(r,n.$QP);_g.$3z.$4VL(r,f.$L7());if(e){_js.Trace.logInfo(n.$1z,"Saving {0} response.",n.$x3);n.$Hf.$9xF(r,t,i)}else{var u=3e4;r.response.fault&&r.response.fault.BackOffPeriodInMs&&(u=Math.min(r.response.fault.BackOffPeriodInMs,u));_js.Trace.logWarning(n.$1z,"Response from {0} was rejected. Updating count and delaying {1} ms before trying again.",n.$x3,u);_g.$Cj.$1oZ(r,!1,0);var o=this;n.$Hf.$ADV(r,function(){n.$5nU.$1s(n.$1z,"SetResponse",t,u)},i)}}_e.$tQ.prototype={$2AF:null,$QP:null,$Bv:null,$1HT:null,$5nU:null,get_$8Cj:function(){return this.$Hf.get_$2df()},get_$7fK:function(){if(this.$Hf.get_$1tB())if(this.$Bv.$QD)if(this.$Hf.get_$10r()){_js.Trace.logInfo(this.$1z,"Deferring FetchNextRecord (a.k.a. fetching of the next action record) because the action queue has pending responses.");return!1}else return!0;else{_js.Trace.logInfo(this.$1z,"Deferring FetchNextRecord (a.k.a. fetching of the next action record) because the application has lost network connectivity.");return!1}else{_js.Trace.logInfo(this.$1z,"Deferring FetchNextRecord (a.k.a. fetching of the next action record). This could happen due to multiple reasons. e.g. SyncManager is currently syncing OR this is not the primary window.");return!1}},$7xe:function(n,t){this.$Hf.$85g(n,t)},$9jr:function(n,t){_js.Trace.logInfo(this.$1z,"Processing {0} with an online call.",this.$x3);var i=this;this.$1HT.$43Q(this.$x2,function(){_js.Trace.logInfo(i.$1z,"Online processing of {0} completed.",_g.$3z.$UW(i.$x2));$79W(i,n,t)})},$7XL:function(n,t){_js.Trace.logInfo(this.$1z,"Ensuring connectivity to process {0}",_g.$3z.$UW(this.$Hf.get_$5o6()));this.$Bv.$2vp()},$8Am:function(n){$2FS(this)}};_e.$gR=function(n,t,i){_e.$gR.initializeBase(this,[n,_a.$0.$4XJ]);_a.$3.$K(t,"processResponse");_a.$3.$K(i,"eventAggregator");this.$3N0=t;var r=this;i.$Hd(_a.$lf,function(n){_js.Trace.logInfo(r.$1z,"ResponseQueueProcessor received NonBootModelResponseProcessorReady event");r.$Hf.add_$4XD(r.$$d_$A44);r.$Hf.add_$5GG(r.$$d_$A44);$2FS(r)})};function $4uN(n,t,i){_js.Trace.logInfo(n.$1z,"Removing {0} from the action queue.",n.$x3);var r=n.$x2;_g.$Cj.$1oZ(r,!0,0);var u=this;n.$Hf.$34(r.id,function(n){t()},i,null)}_e.$gR.prototype={$3N0:null,get_$8Cj:function(){return this.$Hf.get_$10r()},get_$7fK:function(){if(this.$Hf.get_$1tB())return!0;else{_js.Trace.logInfo(this.$1z,"Deferring FetchNextRecord (a.k.a. fetching of the next action record). This could happen due to multiple reasons. e.g. SyncManager is currently syncing OR this is not the primary window.");return!1}},$7xe:function(n,t){this.$Hf.$85i(n,t)},$9jr:function(n,t){_js.Trace.logInfo(this.$1z,"Processing response from {0}.",this.$x3);var u=_a.$7.get_$2F();var i=this,r=this;this.$3N0(this.$x2,function(){_js.Trace.logInfo(i.$1z,"Processing response from {0} succeeded.",i.$x3);_g.$3z.$4VL(i.$x2,u.$L7());$4uN(i,n,t)},function(i){_js.Trace.logWarning(r.$1z,"Processing response from {0} failed: {1}",r.$x3,i.message);$4uN(r,n,t)})}};_e.$6M=function(n){_e.$6M.initializeBase(this);_a.$3.$K(n,"clientStore");this.$6j=new(_e.$7t.$$(_bc.$18Y,_e.$Gl))(n,"UTC")};function $78J(n,t){var i=t.$Dv(_e.$1G.get_$I().$127.get_$1N());var r=new _a.$8o(ActionItemMetadata.$45O(),"true");var u=new _a.$8P(r,null);var f=this,e=this;i.$JP(u,function(t){t.$C(function(t){n.set_$41R(t)},null)},function(n){_js.Trace.logError(_a.$0.$8M,"Unable to retreive the number of high priority actions from the clientstore. Error = {0}",n.$3j)})}function $78K(n,t){var i=t.$Dv(_e.$1G.get_$I().$127.get_$1N());var r=new _a.$8o(ActionItemMetadata.$45O(),"false");var u=new _a.$8P(r,null);var f=this,e=this;i.$JP(u,function(t){t.$C(function(t){n.$1g3=t},null)},function(n){_js.Trace.logError(_a.$0.$8M,"Unable to retrieve the number of low priority actions from the clientstore. Error = {0}",n.$3j)})}function $4tw(n,t,i,r){var u=null;var f=this,e=this;$2lT(n,function(i,r){$4tx(n,i,r,t,function(n){u=n})},function(){i(u)},r)}function $4tx(n,t,i,r,u){var f=this;i.$JP(r,function(n){n.$Ds(1,function(n,t,i){if(t.length>0){var f=t[0].$27;var r=f.Data;r.id=t[0].$3D.$Tv();u(r)}else u(null)},null)},null)}function $4ty(n,t,i,r){var u=!1;var f=null;var e=_e.$1l.$5Va(i);var o=this;n.$6j.$Fu(t,e,function(n){if(n){u=!0;n.$2LZ(t)}f=u?n.get_$1r():null;r(u,f)},null)}function $2lT(n,t,i,r){var u=this,f=this,e=this;n.$6j.$Bl(new _a.$6i("DatabaseActionQueue.ExecuteTransaction"),function(n){var i=n.$Dv(_e.$1G.get_$I().$127.get_$1N());t(n,i)},function(){i()},function(n){var t=Error.create(n.$3j,n);r(t)})}_e.$6M.prototype={$6j:null,$8KD:function(n,t){var i=n.$Dv(_e.$1G.get_$I().$127.get_$1N());var r=new _a.$YQ(_e.$Gl.$2hN,0,1,0);var u=new _a.$8P(r,_e.$6M.$2h1);var f=this;$4tx(this,n,i,u,function(n){t(!n)})},$8Fx:function(n){$78J(this,n);$78K(this,n)},$7vd:function(n,t,i){var r=this.$6j.$rP(n);delete n.id;var u=this,f=this;$2lT(this,function(t,i){r.$E1(t,function(t){n.id=t.get_$1fW()})},function(){t(n.id)},i)},$85h:function(n,t){$4tw(this,_e.$6M.$6G5,n,t)},$85j:function(n,t){$4tw(this,_e.$6M.$6G7,n,t)},$81L:function(n,t){var i=[];var r=this,u=this;$2lT(this,function(n,t){t.$JP(_e.$6M.$5BM,function(n){n.$Ds(1e3,function(n,t,r){for(var u=0;u<t.length;++u){var e=t[u].$27;var f=e.Data;f.id=t[u].$3D.$Tv();Array.add(i,f)}},null)},null)},function(){n(i)},t)},$9nd:function(n,t,i,r){var u=!1;var f=null;if(n)$4ty(this,n,t,i);else{var e=this,o=this;$2lT(this,function(n,i){$4ty(e,n,t,function(n,t){u=n;f=t})},function(){i(u,f)},r)}},$6nN:function(n,t,i){var r=this;this.$7vd(n,function(n){t()},i)}};_e.$nt=function(n,t){_a.$3.$m(n,"nativeBridge");_a.$3.$m(t,"eventAggregator");this.$c=n;var i=this;t.$Hd(_a.$ii,function(){i.get_$5AT()&&_e.$6P.$9mL(i.get_$5AT())})};_e.$nt.prototype={$c:null,$dp:null,get_$5AT:function(){if(!this.$dp)switch(this.$c.get_$w4().get_$2oP().get_$2oO()){case 1:this.$dp=new _e.$Oy;break;case 2:this.$dp=new _e.$12q(this.$c.get_$w4());break;case 0:break}return this.$dp}};_e.$WN=function(){};_e.$WN.$E=function(n,t,i){var r=null;n.get_$A5O()?r=_e.$WN.$7mw(t,i):n.get_$4jk()?r=_e.$WN.$7kT(t):n.get_$2QQ()&&(r=new _e.$18l(n.get_$2QQ(),t));return r};_e.$WN.$7kT=function(n){var t=window.self;return new _e.$n3(t,n)};_e.$WN.$7mw=function(n,t){var i=new _e.$1F5(t.get_$ZZ(),_js.$J.get_$I());return new _e.$n3(i,n)};_e.$1Ib=function(){};_e.$1Ib.registerInterface("_e.$1Ib");_e.$xv=function(){};_e.$1IT=function(){};_e.$1IT.registerInterface("_e.$1IT");_e.$1IR=function(){};_e.$1IR.registerInterface("_e.$1IR");_e.$1HX=function(){};_e.$1HX.registerInterface("_e.$1HX");_e.$1Hf=function(){};_e.$1Hf.registerInterface("_e.$1Hf");_e.$5m=function(n,t,i){this.$fm=n;this.$1k=t;this.$2En=i;$3c1(this);this.$2ib=0};function $4u8(n,t,i){var r=n.$fm.open(n.$1k);_e.$3t.$10l(Object,_a.$Xs,"IdbBrowserDb.Initialize",r,i);var u=this;_e.$3t.$Ze(Object,_a.$Xs,"IdbBrowserDb.Initialize",r,function(r){n.$NT=r.target.result;if($78w(n)){var u=n.$NT.transaction(n.$NT.objectStoreNames,"readwrite");_e.$Nz.$Hd("IdbBrowserDb.Initialize",u,t,i);$78z(n,u)}else _e.$66.$1Uu(t)})}function $78w(n){return $4uA(n)&&$4u7(n)}function $4u7(n){return Array.indexOf(n.$NT.objectStoreNames,"__indexes")>=0}function $4uA(n){return Array.indexOf(n.$NT.objectStoreNames,"__versions")>=0}function $78u(n){$4uA(n)||n.$NT.createObjectStore("__versions",_a.$Ur.$7zf());$4u7(n)||n.$NT.createObjectStore("__indexes",_a.$Ur.$7zP())}function $78z(n,t){$792(n,t);$78y(n,t);$791(n,t)}function $78y(n,t){var i=t.objectStore("__indexes");var r=i.openCursor(_a.$7E.$1Lb(),"next");var u=this;_e.$3t.$Ze(_a.$Fa,_a.$JD,"IdbBrowserDb.PopulateIndexInformation",r,function(t){if(t.target.result){var i=t.target.result.value;var r=_e.$Ny.$E(i);n.$7N.$1rN(i.storeName,r);_a.$RY.$Ds(t.target.result)}})}function $792(n,t){var i=t.objectStore("__versions");$78x(n,i);$790(n,i)}function $790(n,t){for(var i=0;i<n.$NT.objectStoreNames.length;++i)if(!n.$NT.objectStoreNames[i].startsWith("__")){var r=t.get(n.$NT.objectStoreNames[i]);var u=this;_e.$3t.$Ze(_a.$Fb,Object,"IdbBrowserDb.PopulateObjectStoreVersion",r,function(t){var i=t.target.result;n.$7N.$D(i.name,i.version)})}}function $791(n,t){var i=t.objectStore("__versions");var r=i.get("__settings");var u=this;_e.$3t.$Ze(_a.$Fb,Object,"IdbBrowserDb.PopulateSettingsInformation",r,function(t){var i=t.target.result;i&&(n.$2Qx=i)})}function $78x(n,t){var i=t.get("__db");var r=this;_e.$3t.$Ze(_a.$Fb,Object,"",i,function(t){_e.$66.$1Uu(function(){var i=t.target.result;n.$CH=i.version})})}function $78s(n,t,i,r){var u=new _e.$qk(n.$NT,r,i);try{t(u)}catch(f){_js.Trace.logError(_a.$0.$DH,"aborting transaction due to exception during schema update: "+f.message);r.abort()}}function $794(n,t,i){var r=i.objectStore("__versions");r.put(new _e.$xx("__db",t),"__db")}function $793(n,t,i){var u=i.objectStore("__versions");var r=$78r(n,n.$2Qx);r.$1r7=t;u.put(r,"__settings")}function $78v(n,t,i,r,u,f){var s=n.$7N.$3g();var h=n.$NT.version+1;n.$NT.close();$3c1(n);var e=n.$fm.open(n.$1k,h);var o="IdbBrowserDb.InternalChangeSchema";var c=this;_e.$3t.$AEB(o,e,function(u){n.$NT=u.target.result;$795(n,t,i,s,u.target.transaction,r,f)});_e.$3t.$1Uu(Object,_a.$Xs,o,e,u);_e.$3t.$10l(Object,_a.$Xs,o,e,f)}function $795(n,t,i,r,u,f,e){var o=this;_e.$Nz.$Hd("UpgradeDatabaseVersion",u,function(){n.$7N=r;n.$CH=t;n.$2Qx.$1r7=i},e);$78u(n);$794(n,t,u);$793(n,i,u);$78s(n,f,r,u)}function $3c2(n,t){if(!n.$7N.$1nb(t))throw Error.invalidOperation("The object store "+t+" does not exist.");}function $78q(n){}function $4u9(n){return!!n.$NT}function $3c1(n){n.$NT=null;n.$CH="";n.$2Qx=new _e.$xv;n.$7N=new _e.$xu;n.$NE=new _a.$zf(n);n.$gy=new _a.$Sm}function $78t(n,t,i){$4u9(n)?t():$4u8(n,t,i)}function $78r(n,t){var i=new _e.$xv;i.$1r7=t.$1r7;return i}_e.$5m.prototype={$fm:null,$1k:null,$2En:null,$NE:null,$gy:null,$CH:null,$2Qx:null,$NT:null,$7N:null,$2ib:0,get_$36:function(){return this.$CH},get_$1TX:function(){return this.$7N.get_$1TX()},get_$1r7:function(){return this.$2Qx.$1r7||new Array(0)},$3m8:function(n,t,i,r,u){var f=this;$78t(this,function(){$78v(f,n,t,i,r,u)},u)},$Bl:function(n,t,i,r){$78q(this);var u=this.$2ib++;var f=this.$NT.transaction(this.get_$1TX(),"readwrite");var e=new _e.$18m(f,this.$7N,this.$NE,this.$gy,n);this.$2En.$4BK(u);_js.Trace.logInfo(_a.$0.$DH,"starting transaction {0}",n.$Zi);var o=this,s=this;_e.$Nz.$Hd(n.$Zi,f,function(){_js.Trace.logInfo(_a.$0.$DH,"transaction {0} ended in success.",n.$Zi);o.$2En.$238(u);e.$3NH();_e.$66.$1Uu(i)},function(t){_js.Trace.logInfo(_a.$0.$DH,"transaction {0} ended in error.",n.$Zi);s.$2En.$238(u);t=e.$2ne?new _a.$Av(5,"Transaction manually aborted."):t;_e.$66.$DN(t,r)});try{t(e)}catch(h){_js.Trace.logException(_a.$0.$DH,h,"IDB caught an exception on the transaction callback and will abort.");f.abort()}},$6q2:function(n,t){this.$4O();var i=this.$fm.deleteDatabase(this.$1k);_e.$3t.$1Uu(Object,_a.$Xs,"IdbBrowserDb.Wipe",i,n);_e.$3t.$10l(Object,_a.$Xs,"IdbBrowserDb.Wipe",i,t)},$4O:function(){if($4u9(this)){this.$NT.close();$3c1(this)}},$Hd:function(n,t){_a.$3.$1G(n,"objectStoreName");_a.$3.$K(t,"notificationCallback");n=n.toLowerCase();$3c2(this,n);this.$NE.$Hd(n,t)},$11q:function(n){_a.$3.$1G(n,"objectStoreName");n=n.toLowerCase();this.$NE.$11q(n)},$4hs:function(){this.$NE.$4hs()},$85o:function(n){_a.$3.$1G(n,"objectStoreName");n=n.toLowerCase();$3c2(this,n);return this.$7N.$1cz(n)},$5Lm:function(n){_a.$3.$1G(n,"objectStoreName");n=n.toLowerCase();$3c2(this,n);var t=new _e.$5m.$8F6(n,this.$gy);this.$gy.$5AD(t);return t}};_e.$5m.$8F6=function(n,t){_e.$5m.$8F6.initializeBase(this,[n,t])};_e.$66=function(n,t){_e.$66.initializeBase(this,[n,t])};_e.$66.$10m=function(n,t){var i=n;var r=_e.$66.$A9L(n);_js.Trace.logError(_a.$0.$DH,"IndexedDb Error: {0}",i);_e.$66.$10l(r,i,t)};_e.$66.$10l=function(n,t,i){_e.$66.$DN(new _e.$66(n,t),i)};_e.$66.$DN=function(n,t){t&&t(n)};_e.$66.$1Uu=function(n){n&&n()};_e.$66.$lC=function(n,t,i){i&&i(t)};_e.$66.$A9L=function(n){var t=0;switch(n){case"UnknownError":t=0;break;case"ConstraintError":t=1;break;case"DataError":t=0;break;case"TransactionInactiveError":t=0;break;case"ReadOnlyError":t=1;break;case"VersionError":t=0;break;case"NotFoundError":t=2;break;case"InvalidStateError":t=0;break;case"InvalidAccessError":t=0;break;case"TimeoutError":t=4;break;case"AbortError":t=5;break;case"QuotaExceededError":t=3;break;case"SyntaxError":t=0;break;case"DataCloneError":t=1;break}return t};_e.$18l=function(n,t){_e.$18l.initializeBase(this);this.$fm=n;this.$2En=t};_e.$18l.prototype={$fm:null,$2En:null,$9eC:function(n,t,i,r){_a.$3.$K(i,"successCallback");_a.$3.$1G(n,"name");var u=new _e.$5m(this.$fm,n,this.$2En);var f=this;$4u8(u,function(){i(u)},r)},$7qm:function(n,t,i){_a.$3.$K(t,"successCallback");_a.$3.$1G(n,"name");this.$fm.deleteDatabase(n);t()}};_e.$Gv=function(n,t,i,r){this.$B2=n;this.$1Hg=t;this.$7N=i;this.$tu=r};_e.$Gv.$6op=function(n){_a.$3.$K(n,"id");var t=n.$Tv();_a.$3.$K(t,"id must be provided");_a.$3.$1G(t.toString(),"id must be provided");return t};function $4uC(n,t,i,r){var u=t?new _a.$8P(t.$7h,null):null;var f=this;_e.$2M.$E(n.$B2.get_$41p(),n.$1Hg,n.$7N,u,1,function(n){i(n)},r)}function $4uB(n,t){$796(n,t);$797(n,t)}function $797(n,t){if(t.$H0)for(var i=0;i<t.$H0.length;++i)if(!n.$7N.$2PS(t.$H0[i].$Ha.$5t)){var r=String.format("KeyPath {0} is being sorted but it is not an indexed field",t.$H0[i].$Ha.$5t);_a.$Av.$1K2(1,r)}}function $796(n,t){if(t.$7h)for(var r=t.$7h.$1mD,i=0;i<r.length;++i)if(!n.$7N.$2PS(r[i].$5t)){var u=String.format("KeyPath {0} is being queried but it is not an indexed field",r[i].$5t);_a.$Av.$1K2(1,u)}}_e.$Gv.prototype={$B2:null,$1Hg:null,$7N:null,$tu:null,$494:0,get_$1N:function(){return this.$7N.get_$1N()},$3f:function(n,t,i){var r=_e.$Gv.$6op(n);_a.$3.$K(t,"successCallback");var u=this.$1Hg.get(r);var f="IdbBrowserDbObjectStore.GetItem";var e=this;_e.$3t.$EB(_a.$Fb,Object,f,u,function(n){_js.Trace.logError(_a.$0.$DH,"Error getting object from store:{0} with id:{1}. Error:{2}",e.get_$1N(),r,n.target.error);_e.$66.$10m(n.target.error.name,i)});var o=this;_e.$3t.$Ze(_a.$Fb,Object,f,u,function(n){var i=null;var r=n.target.result;r&&(i=r.data);_e.$66.$lC(Object,i,t)})},$im:function(n,t,i){this.$tu.$17a(this,n);this.$B2.get_$1jB()(this.get_$1N(),2,n,null);var f=_e.$Gv.$6op(n);var r=_a.$Fb.$34(this.$1Hg,f);var u="IdbBrowserDbObjectStore.DeleteItem";_e.$3t.$1Uu(_a.$Fb,Boolean,u,r,t);var e=this;_e.$3t.$EB(_a.$Fb,Boolean,u,r,function(t){_js.Trace.logError(_a.$0.$DH,"Error deleting from object store:{0} the id:{1}. ErrorCode:{2}",e.get_$1N(),n.$Tv(),t.target.error);_e.$66.$10m(t.target.error.name,i)})},$1t:function(n,t){this.$tu.$1jU(this);var i=this.$1Hg.clear();var r="IdbBrowserDbObjectStore.Clear";_e.$3t.$1Uu(_a.$Fb,Object,r,i,n);var u=this;_e.$3t.$EB(_a.$Fb,Object,r,i,function(n){_js.Trace.logError(_a.$0.$DH,"Error clearing from object store:{0}. ErrorCode:{1}",u.get_$1N(),n.target.error);_e.$66.$10m(n.target.error.name,t)})},$9ky:function(n,t,i,r){_a.$3.$K(t,"json");this.$tu.$1jV(this,n,t);for(var s=new _e.$18t(t,{}),e=0;e<this.$7N.get_$2QS().length;++e)this.$7N.get_$2QS()[e].$7ax(s,n,this.get_$1N());var u=n.$Tv();if(u===null){var o=_a.$7.get_utcNow().$5X();o<=this.$494&&(o=this.$494+1);u=this.$494=o}var h=!0;var y=!1;if(this.$B2.get_$1KE().$4Zt){var c=this.$1Hg.count(_a.$7E.$6LA(u));var l="IdbBrowserDbObjectStore.Count";var p=this;_e.$3t.$10l(_a.$Fa,Number,l,c,function(t){_js.Trace.logInfo(_a.$0.$5c,"Database query with ClientStoreId = {0} failed with error: {1}",n.toString(),t.$3j)});var w=this;_e.$3t.$Ze(_a.$Fa,Number,l,c,function(n){h=!!n.target.result})}var a=this.$1Hg.put(s,u);var v="IdbBrowserDbObjectStore.Put";_e.$3t.$10l(_a.$Fb,Object,v,a,r);var f=this;_e.$3t.$Ze(_a.$Fb,Object,v,a,function(r){y=!0;_e.$66.$lC(_a.$OK,new _a.$OK(r.target.result),i);h?f.$B2.get_$1jB()(f.get_$1N(),1,n,t):f.$B2.get_$1jB()(f.get_$1N(),0,n,t)})},$JP:function(n,t,i){_a.$3.$K(t,"successCallback");n&&$4uB(this,n);var r=this;$4uC(this,n,function(u){_e.$2M.$E(r.$B2.get_$41p(),r.$1Hg,r.$7N,n,0,function(n){var i=new _e.$18s(r.$B2,n,u);_e.$66.$lC(_a.$19t,i,t)},i)},i)},$41s:function(n,t,i){_a.$3.$K(t,"successCallback");var r=n?new _a.$8P(n,null):null;r&&$4uB(this,r);var u=this;$4uC(this,r,function(n){_e.$2M.$E(u.$B2.get_$41p(),u.$1Hg,u.$7N,r,1,function(i){var r=new _e.$18r(u.$B2,i,n);_e.$66.$lC(_a.$19s,r,t)},i)},i)}};_e.$18m=function(n,t,i,r,u){this.$32t=n;this.$tu=new _a.$Sl(this,r);this.$7N=t;this.$1HK=new _a.$zd(i);this.$ei=u};_e.$18m.prototype={$32t:null,$7N:null,$tu:null,$1HK:null,$ei:null,$2ne:!1,get_$1KE:function(){return this.$ei},get_$41p:function(){return this.$32t},get_$1jB:function(){return this.$1HK.$$d_$9lC},$3NH:function(){this.$1HK.$3NH(this.$ei)},$Dv:function(n){n=n.toLowerCase();if(!this.$7N.$1nb(n))throw Error.invalidOperation("storeName "+n+" does not exist.");var t=this.$32t.objectStore(n);return new _e.$Gv(this,t,this.$7N.$88F(n),this.$tu)},$2nd:function(){this.$2ne=!0;this.$32t.abort()}};_e.$18n=function(n,t){_e.$18n.initializeBase(this,[n,t,new _a.$4w("metadata."+n)])};_e.$18n.prototype={$7ax:function(n,t,i){_e.$Ny.$4ix(this.$lc[0],n,t,i);_e.$Ny.$4ix(this.$lc[1],n,t,i);var r=this.$lc[0].$1DO(n.data);var u=this.$lc[1].$1DO(n.data);n.metadata[this.$2QT]=_e.$7q.$E(r,u)}};_e.$Ny=function(n,t,i){this.$2QT=n;this.$lc=new Array(0);this.$5nv=i;for(var r=0;r<t.length;++r)Array.add(this.$lc,new _a.$4w(t[r]))};_e.$Ny.$E=function(n){if(n.keyPaths.length===1)return new _e.$18v(n.indexName,n.keyPaths);else if(n.keyPaths.length===2)return new _e.$18n(n.indexName,n.keyPaths);else throw Error.argument("fields","composite keys can only have two columns");};_e.$Ny.$4ix=function(n,t,i,r){var u=n.$1DO(t.data);if($5(u)){var f=String.format("KeyPath {0} is a declared index on store {1} but does not exist in object with id {2}",n.$5t,r,i.$Tv());_js.Trace.logError(_a.$0.$DH,f);throw Error.invalidOperation(f);}if(!String.isInstanceOfType(u)&&!Number.isInstanceOfType(u)){var e=String.format("KeyPath {0} is a declared index on store {1} but the object with id {2} is attempting to store the non-primitive type {3}.",n.$5t,r,i.$Tv(),Object.getType(u).getName());throw Error.invalidOperation(e);}};_e.$Ny.prototype={$2QT:null,$lc:null,$5nv:null};_e.$18o=function(n,t,i,r){this.storeName=n;this.indexName=t;this.keyPaths=new Array(i.length);this.storeVersion=r;for(var u=0;u<i.length;++u)this.keyPaths[u]=i[u].$5t.$5t};_e.$18o.prototype={storeName:null,indexName:null,keyPaths:null,storeVersion:null};_e.$xu=function(){this.$tt={}};_e.$xu.prototype={$tt:null,get_$1TX:function(){var n=[];var t=this.$tt;for(var i in t){var r={key:i,value:t[i]};Array.add(n,r.key)}return n},$1cz:function(n){return this.$tt[n].get_$36()},$88F:function(n){return this.$tt[n]},$D:function(n,t){this.$tt[n]=new _e.$xu.$5S1(n,t)},$1nb:function(n){return n in this.$tt},$3g:function(){var n=new _e.$xu;n.$tt={};var t=this.$tt;for(var i in t){var r={key:i,value:t[i]};var u=r.value;n.$tt[r.key]=u.$3g()}return n},$34:function(n){delete this.$tt[n]},$1rN:function(n,t){var i=this.$tt[n];i.$1rN(t)},$5ee:function(n,t){var i=this.$tt[n];return i.$5ee(t)}};_e.$xu.$5S1=function(n,t){this.$1k=n;this.$CH=t;this.$42G={};this.$4cc={};this.$3nK={};this.$2HI=[];this.$42F=[]};_e.$xu.$5S1.prototype={$CH:null,$1k:null,$42G:null,$4cc:null,$3nK:null,$2HI:null,$42F:null,get_$1N:function(){return this.$1k},get_$36:function(){return this.$CH},get_$2QS:function(){return this.$42F},$1rN:function(n){this.$42G[n.$2QT]=n;for(var t=0;t<n.$lc.length;++t)Array.indexOf(this.$2HI,n.$lc[t].$5t)<0&&Array.add(this.$2HI,n.$lc[t].$5t);n.$lc.length===1?this.$4cc[n.$lc[0].$5t]=n:this.$3nK[n.$lc[0].$5t+n.$lc[1].$5t]=n;Array.add(this.$42F,n)},$5ee:function(n){return n in this.$42G},$2PS:function(n){if(n===_a.$4w.$3D.$5t)return!0;else{for(var t=0;t<this.$2HI.length;++t)if(this.$2HI[t]===n)return!0;return!1}},$1xK:function(n,t){var i=null;if(t.$5t===_a.$4w.$3D.$5t)i=n;else{var r=this.$4cc[t.$5t];r&&(i=n.index(r.$2QT))}return i},$2zm:function(n,t,i){var r=null;if(t===i)r=this.$1xK(n,t);else{var u=this.$3nK[t.$5t+i.$5t];u&&(r=n.index(u.$2QT))}return r},$3g:function(){for(var t=new _e.$xu.$5S1(this.$1k,this.$CH),i=this.get_$2QS(),r=i.length,n=0;n<r;++n){var u=i[n];t.$1rN(u)}return t}};_e.$MQ=function(n,t){_e.$MQ.initializeBase(this,[null]);_a.$3.$K(n,"idbCursorRequest");this.$HI=new(_e.$dw.$$(_a.$JD))(n,t)};_e.$MQ.prototype={$HI:null,get_$8Hj:function(){return this.$HI.get_$1an()},get_$5ft:function(){return this.$HI.get_$1CE()},get_$8Hi:function(){return this.$HI.get_$3px()},$C:function(n,t){this.$HI.$C(n,t)},$5gI:function(n,t,i){this.$HI.$1W9(n,t,i)},$43D:function(n,t){this.$HI.$Ds(n,t)},$41:function(n,t){this.$HI.$41(n,t)}};_e.$dw=function(n,t){this.$$d_$8Bk=Function.createDelegate(this,this.$8Bk);this.$$d_$8Bm=Function.createDelegate(this,this.$8Bm);_a.$3.$K(n,"idbCursorRequest");this.$1kQ=null;this.$y9=n;this.$uW=t;var i="IdbQueryCursorStrategyImpl";_e.$3t.$Ze(_a.$Fa,this.$$gta["_e.$dw"].TCursor,i,this.$y9,this.$$d_$8Bm);_e.$3t.$EB(_a.$Fa,this.$$gta["_e.$dw"].TCursor,i,this.$y9,this.$$d_$8Bk)};_e.$dw.$$=function(n){var t="$dw"+"$1"+"$"+n.getName().replace(/\./g,"_");if(!_e[t]){var r=_e[t]=function(){(this.$$gta=this.$$gta||{})["_e.$dw"]={TCursor:n};for(var i=[],t=0;t<arguments.length;++t)i[t]=arguments[t];_e.$dw.apply(this,i)};r.registerClass("_e."+t);var u=_e.$dw.prototype;for(var f in u){var i={key:f,value:u[f]};"constructor"!==i.key&&(r.prototype[i.key]=i.value)}}return _e[t]};_e.$dw.prototype={$y9:null,$uW:null,$1kQ:null,get_$1an:function(){var n=null;this.$y9.result&&(n=this.$y9.result.value);return n},get_$1CE:function(){var n=null;this.$y9.result&&(n=this.$y9.result.primaryKey);return n},get_$3px:function(){return""},$C:function(n,t){var i="IdbQueryCursorStrategyImpl.Count";var r=this.$uW?this.$y9.source.count(this.$uW):this.$y9.source.count();_e.$3t.$10l(_a.$Fa,Number,i,r,t);var u=this;_e.$3t.$Ze(_a.$Fa,Number,i,r,function(t){_e.$66.$lC(Number,t.target.result,n)})},$1W9:function(n,t,i){this.$1kQ=new _e.$xw(t,i);this.$y9.result.advance(n)},$Ds:function(n,t){this.$1kQ=new _e.$xw(n,t);_a.$RY.$Ds(this.$y9.result)},$41:function(n,t){n()},$8Bm:function(n){var t=this;_e.$66.$1Uu(function(){var n=t.$1kQ;t.$1kQ=null;n.get_$Ze()()})},$8Bk:function(n){var t=this.$1kQ;this.$1kQ=null;t.get_$EB()(n.target.error)}};_e.$xw=function(n,t){this.$6iw=n;this.$1d=t};_e.$xw.prototype={$6iw:null,$1d:null,get_$Ze:function(){return this.$6iw},get_$EB:function(){return this.$1d}};_e.$kU=function(n,t){_e.$kU.initializeBase(this,[t]);this.$7h=n};_e.$kU.prototype={$7h:null,get_$8Hj:function(){return this.$QB.get_$1an()},get_$5ft:function(){return this.$QB.get_$1CE()},get_$8Hi:function(){return this.$QB.get_$3px()},$43D:function(n,t){var i=this,r=this;this.$QB.$Ds(function(){i.$QB.$PS===2?n():i.$7h.$5lV(i.$QB.get_$1CE(),i.$QB.get_$1an().data)?n():i.$43D(n,t)},function(n){t(n)})}};_e.$18q=function(n,t){_e.$18q.initializeBase(this,[t]);this.$317=n};_e.$18q.prototype={$317:null,get_$8Hj:function(){return this.$QB.get_$1an()},get_$5ft:function(){return this.$QB.get_$1CE()},get_$8Hi:function(){for(var t="",n=0;n<this.$317.length;++n){var i=this.$317[n].$5t===_a.$4w.$3D.$5t?this.$QB.get_$1CE():this.$317[n].$1DO(this.$QB.get_$1an().data);$5(i)||(t+=i.toString())}return t},$43D:function(n,t){this.$QB.$Ds(n,t)}};_e.$18r=function(n,t,i){this.$$d_$5ZE=Function.createDelegate(this,this.$5ZE);this.$HI=new _e.$RZ(n,t,i)};_e.$18r.prototype={$HI:null,$C:function(n,t){this.$HI.$C(n,t)},$Ds:function(n,t,i){this.$HI.$Ds(_a.$OK,n,this.$$d_$5ZE,t,i)},$5ZE:function(n){return new _a.$OK(n.get_$1CE())}};_e.$18s=function(n,t,i){this.$$d_$5ZE=Function.createDelegate(this,this.$5ZE);this.$HI=new _e.$RZ(n,t,i)};_e.$18s.prototype={$HI:null,get_$JQ:function(){return this.$HI.$8y},$C:function(n,t){this.$HI.$C(n,t)},$Ds:function(n,t,i){_a.$3.$K(t,"successCallback");var r=this;this.$HI.$Ds(_a.$g4,n,this.$$d_$5ZE,function(n,i,r){t(n,i,r)},i)},$1mJ:function(n,t,i,r){this.$HI.$1mJ(n,t,i,r)},$1W9:function(n,t,i){this.$HI.$1W9(n,t,i)},$5ZE:function(n){var t=n.get_$1an();var i=n.get_$1CE();return new _a.$g4(new _a.$OK(i),t.data)}};_e.$RZ=function(n,t,i){this.$B2=n;this.$1nc=t;this.$5KR=i;this.$8y=0};function $3c3(n){if(n.$17x>0)throw Error.invalidOperation("an asynchronous operation is already in progress");}_e.$RZ.prototype={$B2:null,$1nc:null,$5KR:null,$8y:0,$17x:0,$C:function(n,t){this.$5KR.$C(n,t)},$Ds:function(n,t,i,r,u){_a.$3.$K(r,"successCallback");$3c3(this);if(this.$1nc.get_$3Y()===2)r(this.$B2,[],!0);else{this.$17x++;var f=this,e=this;this.$AHE(n,t,[],i,function(n,t,i){f.$17x--;r&&r(n,t,i)},function(n){e.$17x--;u&&u(n)})}},$1mJ:function(n,t,i,r){_a.$3.$K(i,"successCallback");_a.$3.$K(t,"condition");$3c3(this);this.$17x++;var u=this,f=this;this.$1nc.$1mJ(t,function(n,t){u.$8y+=t;u.$17x--;!n&&t>0&&u.$8y--;i&&i(n)},function(n){f.$17x--;r&&r(n)})},$1W9:function(n,t,i){this.$8y+=n;$3c3(this);this.$17x++;var r=this,u=this;this.$1nc.$1W9(n,function(){r.$17x--;t&&t()},function(n){u.$17x--;i&&i(n)})},$AHE:function(n,t,i,r,u,f){var e=this,o=this;this.$1nc.$Ds(function(){e.$8y++;if(e.$1nc.get_$3Y()===2)u(e.$B2,i,!0);else{Array.add(i,r(e.$1nc));t--;t>0?e.$AHE(n,t,i,r,u,f):u(e.$B2,i,!1)}},function(n){_e.$66.$10m(n.name,f)})}};_e.$Cy=function(n,t,i,r){this.$$d_$7i7=Function.createDelegate(this,this.$7i7);_e.$Cy.initializeBase(this,[[t],r]);this.$4Nc=n;this.$Ha=t;this.$GN=i;this.$1xv=0;this.$1P6=new Array(0)};function $798(n,t,i){n.$1P6=new Array(0);n.$1xv=0;var r="";if(n.$QB.$PS===2)t();else{r=n.$QB.get_$3px();$4uD(n,r,t,i)}}function $4uD(n,t,i,r){if(n.$QB.$PS===1&&n.$QB.get_$3px()===t){var u=n.$Ha.$5t===_a.$4w.$3D.$5t?n.$QB.get_$1CE():n.$Ha.$1DO(n.$QB.get_$1an().data);Array.add(n.$1P6,new _e.$Cy.$A3Z(n.$QB.get_$1CE(),u));var f=this;n.$QB.$Ds(function(){$4uD(n,t,i,r)},r)}else{$79A(n);i()}}function $79A(n){n.$1P6.length>0&&n.$1P6.sort(n.$$d_$7i7)}function $799(n,t,i){var u=n.$1P6[n.$1xv].get_$Q();var r=n.$4Nc.get(u);n.$1P6[n.$1xv]=null;n.$1xv++;var f="IdbQuerySortStrategy.Next";var e=this;_e.$3t.$Ze(_a.$Fb,Object,f,r,function(i){$4uE(n,u,i.target.result);t()});var o=this;_e.$3t.$EB(_a.$Fb,Object,f,r,function(){i(r.error)})}function $4uE(n,t,i){n.$5Mi=t;n.$5Mt=i;n.$5Md=i?n.$Ha.$1DO(i.data):null}_e.$Cy.prototype={$4Nc:null,$Ha:null,$GN:0,$5Mt:null,$5Mi:null,$5Md:null,$1P6:null,$1xv:0,get_$8Hj:function(){return this.$5Mt},get_$5ft:function(){return this.$5Mi},get_$8Hi:function(){return this.$5Md.toString()},$43D:function(n,t){$4uE(this,null,null);if(this.$1xv<this.$1P6.length)$799(this,n,t);else if(this.$QB.$PS===2)n();else{var i=this;$798(this,function(){i.$43D(n,t)},t)}},$41:function(n,t){var i=this;this.$QB.$Ds(function(){i.$43D(n,t)},t)},$7i7:function(n,t){var i=n;var r=t;return this.$GN?r.$5Ie(i):i.$5Ie(r)}};_e.$Cy.$A3Z=function(n,t){this.$C3=n;this.$6hK=t};_e.$Cy.$A3Z.prototype={$C3:null,$6hK:null,get_$Q:function(){return this.$C3},get_$19H:function(){return this.$6hK},$5Ie:function(n){return Number.isInstanceOfType(this.get_$19H())&&Number.isInstanceOfType(n.get_$19H())?this.get_$19H()-n.get_$19H():String.isInstanceOfType(this.get_$19H())&&String.isInstanceOfType(n.get_$19H())?this.get_$19H()===n.get_$19H()?0:this.get_$19H()>n.get_$19H()?1:-1:0}};_e.$2M=function(n){this.$QB=n;this.$PS=0;this.$2Jp=null};_e.$2M.$E=function(n,t,i,r,u,f,e){_a.$3.$K(t,"object store");_a.$3.$K(f,"success");f=_e.$2M.$7bh(n,f,e);_e.$2M.$8Mo(r)?_e.$2M.$5Ky(t,u,f):_e.$2M.$8KE(r)?_e.$2M.$7lS(t,i,r,u,f):_e.$2M.$8Li(r)?_e.$2M.$7mZ(t,i,r,u,f):_e.$2M.$8Nb(r)&&_e.$2M.$7nW(t,i,r,u,f)};_e.$2M.$7lS=function(n,t,i,r,u){switch(_e.$2M.$3yJ(i)){case 0:_e.$2M.$5Ky(n,r,u);break;case 1:_e.$2M.$7lT(n,t,i,r,u);break;case 2:_e.$2M.$7lR(n,t,i,u);break}};_e.$2M.$7mZ=function(n,t,i,r,u){switch(_e.$2M.$3yJ(i)){case 0:_e.$2M.$7mb(n,t,i,r,u);break;case 1:_e.$2M.$7mc(n,t,i,u);break;case 2:_e.$2M.$7ma(n,t,i,u);break}};_e.$2M.$7nW=function(n,t,i,r,u){switch(_e.$2M.$3yJ(i)){case 0:_e.$2M.$7nY(n,t,i,r,u);break;case 1:_e.$2M.$7nZ(n,t,i,u);break;case 2:_e.$2M.$7nX(n,t,i,u);break}};_e.$2M.$5Ky=function(n,t,i){_e.$2M.$7l3(n,i)};_e.$2M.$7lT=function(n,t,i,r,u){var f=i.$H0[0].$Ha;var e=i.$H0[0].$GN;var o=t.$1xK(n,f);o?_e.$2M.$1u2(n,o,e,null,r,u):_e.$2M.$7l2(n,u,f,e)};_e.$2M.$7lR=function(n,t,i,r){var u=t.$2zm(n,i.$H0[0].$Ha,i.$H0[1].$Ha);var f=i.$H0[0].$GN;var e=i.$H0[1].$GN;f===e&&u?_e.$2M.$1u2(n,u,f,null,0,r):_e.$2M.$7l1(n,i.$H0[0],i.$H0[1],r)};_e.$2M.$7mb=function(n,t,i,r,u){_e.$2M.$5L0(n,t,i,r,u)};_e.$2M.$7mc=function(n,t,i,r){var u=i.$7h;var f=i.$H0[0];if(u.get_$UR().$5t===f.$Ha.$5t){var e=t.$1xK(n,u.get_$UR());if(e){var s=_e.$2M.$2u9(u);_e.$2M.$1u2(n,e,f.$GN,s,0,r)}else{_js.Trace.logWarning(_a.$0.$DH,"This query would run faster with an index on {0}",u.get_$UR().$5t);_e.$2M.$3oZ(n,u,f,r)}}else{var o=t.$2zm(n,u.get_$UR(),f.$Ha);if(o){var h=_a.$7E.$1sa(_e.$7q.$E(u.$vG,""),_e.$7q.$E(u.$vG,"￿"),!0,!0);_e.$2M.$1u2(n,o,f.$GN,h,0,r)}else{_js.Trace.logWarning(_a.$0.$DH,"This query would run faster with an index on {0}:{1}",u.get_$UR().$5t,f.$Ha.$5t);_e.$2M.$3oZ(n,u,f,r)}}};_e.$2M.$7ma=function(n,t,i,r){var u=i.$7h;var f=i.$H0[0];var e=i.$H0[1];var o=t.$2zm(n,u.get_$UR(),f.$Ha);if(o){var s=_a.$7E.$1sa(_e.$7q.$E(u.$vG,""),_e.$7q.$E(u.$vG,"￿"),!0,!0);_e.$2M.$7mL(n,o,u,s,_e.$2M.$3qT(f.$GN),[u.get_$UR(),f.$Ha],e,r)}else if(f.$GN===e.$GN){o=t.$2zm(n,f.$Ha,e.$Ha);if(o)_e.$2M.$7mK(n,o,null,u,r);else{_js.Trace.logWarning(_a.$0.$DH,"This query would run faster with an index on {0}:{1}",f.$Ha.$5t,e.$Ha.$5t);_e.$2M.$3oY(n,u,f,e,r)}}else{_js.Trace.logWarning(_a.$0.$DH,"This query would run faster with an index on {0}:{1}",u.get_$UR().$5t,f.$Ha.$5t);_e.$2M.$3oY(n,u,f,e,r)}};_e.$2M.$7nY=function(n,t,i,r,u){_e.$2M.$5L0(n,t,i,r,u)};_e.$2M.$7nZ=function(n,t,i,r){var u=i.$7h;var f=i.$H0[0];var e=t.$1xK(n,u.get_$UR());if(e){var o=_e.$2M.$2u9(u);u.get_$UR().$5t===f.$Ha.$5t?_e.$2M.$1u2(n,e,f.$GN,o,0,r):_e.$2M.$7mN(n,e,o,f,r)}else{_js.Trace.logWarning(_a.$0.$DH,"This query would run faster with an index on {0}",u.get_$UR().$5t);_e.$2M.$3oZ(n,u,f,r)}};_e.$2M.$7nX=function(n,t,i,r){var u=i.$7h;var f=i.$H0[0];var e=i.$H0[1];var o=t.$1xK(n,u.get_$UR());if(o){var s=_e.$2M.$2u9(u);_e.$2M.$7mM(n,o,s,f,e,r)}else{_js.Trace.logWarning(_a.$0.$DH,"This query would run faster with an index on {0}",u.get_$UR().$5t);_e.$2M.$3oY(n,u,f,e,r)}};_e.$2M.$5L0=function(n,t,i,r,u){var f=t.$1xK(n,i.$7h.$1mD[0]);if(f){var e=_e.$2M.$2u9(i.$7h);_e.$2M.$1u2(n,f,0,e,r,u)}else{_js.Trace.logWarning(_a.$0.$DH,"This query would run faster with an index on {0}",i.$7h.$1mD[0].$5t);_e.$2M.$7l0(n,i.$7h,u)}};_e.$2M.$7mN=function(n,t,i,r,u){_js.Trace.logInfo(_a.$0.$DH,"Creating Sort(Index) strategy.");var f=t.openCursor(i,"next");_e.$3t.$Ze(_a.$Fa,_a.$JD,"CreateIndexSortStrategy",f,function(t){var f=new _e.$MQ(t.target,i);var e=new _e.$Cy(n,r.$Ha,r.$GN,f);u(e)})};_e.$2M.$7mK=function(n,t,i,r,u){_js.Trace.logInfo(_a.$0.$DH,"Creating Filter(Index) strategy.");var f=t.openCursor(i,"next");_e.$3t.$Ze(_a.$Fa,_a.$JD,"CreateIndexFilterStrategy",f,function(n){var t=new _e.$MQ(n.target,i);var f=new _e.$kU(r,t);u(f)})};_e.$2M.$7mM=function(n,t,i,r,u,f){_js.Trace.logInfo(_a.$0.$DH,"Creating Sort(Sort(Index)) strategy.");var e=t.openCursor(i,"next");_e.$3t.$Ze(_a.$Fa,_a.$JD,"CreateIndexSortSortStrategy",e,function(t){var e=new _e.$MQ(t.target,i);var o=new _e.$Cy(n,r.$Ha,r.$GN,e);var s=new _e.$Cy(n,u.$Ha,u.$GN,o);f(s)})};_e.$2M.$7mL=function(n,t,i,r,u,f,e,o){_js.Trace.logInfo(_a.$0.$DH,"Creating Sort(Group((Index)) strategy.");var s=t.openCursor(r,u);_e.$3t.$Ze(_a.$Fa,_a.$JD,"CreateIndexGroupSortStrategy",s,function(t){var i=new _e.$MQ(t.target,r);var u=new _e.$18q(f,i);var s=new _e.$Cy(n,e.$Ha,e.$GN,u);o(s)})};_e.$2M.$3oZ=function(n,t,i,r){_js.Trace.logInfo(_a.$0.$DH,"Creating Sort(Filter((Cursor)) strategy.");var u=_a.$7E.$1Lb();var f=n.openCursor(u,"next");_e.$3t.$Ze(_a.$Fa,_a.$JD,"CreateCursorFilterSortStrategy",f,function(f){var e=new _e.$MQ(f.target,u);var o=new _e.$kU(t,e);var s=new _e.$Cy(n,i.$Ha,i.$GN,o);r(s)})};_e.$2M.$3oY=function(n,t,i,r,u){_js.Trace.logInfo(_a.$0.$DH,"Creating Sort(Sort(Filter((Cursor))) strategy.");var f=_a.$7E.$1Lb();var e=n.openCursor(f,"next");_e.$3t.$Ze(_a.$Fa,_a.$JD,"CreateCursorFilterSortSortStrategy",e,function(e){var o=new _e.$MQ(e.target,f);var s=new _e.$kU(t,o);var h=new _e.$Cy(n,i.$Ha,i.$GN,s);var c=new _e.$Cy(n,r.$Ha,r.$GN,h);u(c)})};_e.$2M.$7l0=function(n,t,i){_js.Trace.logInfo(_a.$0.$DH,"Creating Filter(Cursor) strategy.");var r=_a.$7E.$1Lb();var u=n.openCursor(r,"next");_e.$3t.$Ze(_a.$Fa,_a.$JD,"CreateCursorFilterStrategy",u,function(n){var u=new _e.$MQ(n.target,r);var f=new _e.$kU(t,u);i(f)})};_e.$2M.$7l1=function(n,t,i,r){_js.Trace.logInfo(_a.$0.$DH,"Creating Sort(Sort(Cursor)) strategy.");var u=_a.$7E.$1Lb();var f=n.openCursor(u,"next");_e.$3t.$Ze(_a.$Fa,_a.$JD,"CreateCursorSortSortStrategy",f,function(f){var e=new _e.$MQ(f.target,u);var o=new _e.$Cy(n,t.$Ha,t.$GN,e);var s=new _e.$Cy(n,i.$Ha,i.$GN,o);r(s)})};_e.$2M.$7l2=function(n,t,i,r){_js.Trace.logInfo(_a.$0.$DH,"Creating Sort(Cursor) strategy.");var u=_a.$7E.$1Lb();var f=n.openCursor(u,_e.$2M.$3qT(r));_e.$3t.$Ze(_a.$Fa,_a.$JD,"CreateCursorSortStrategy",f,function(f){var e=new _e.$MQ(f.target,u);var o=new _e.$Cy(n,i,r,e);t(o)})};_e.$2M.$1u2=function(n,t,i,r,u,f){_js.Trace.logInfo(_a.$0.$DH,"Creating Index strategy.");var e=t.openCursor(r,_e.$2M.$3qT(i));_e.$3t.$Ze(_a.$Fa,_a.$JD,"CreateIndexStrategy",e,function(n){f(new _e.$MQ(n.target,r))})};_e.$2M.$7l3=function(n,t){_js.Trace.logInfo(_a.$0.$DH,"Creating Cursor strategy.");var i=_a.$7E.$1Lb();var r=n.openCursor(i,"next");_e.$3t.$Ze(_a.$Fa,_a.$JD,"CreateCursorStrategy",r,function(n){t(new _e.$MQ(n.target,i))})};_e.$2M.$3yJ=function(n){return n.$H0&&n.$H0.length?n.$H0.length===1?1:n.$H0.length===2?2:0:0};_e.$2M.$8Li=function(n){return!!n&&!!n.$7h&&_a.$8o.isInstanceOfType(n.$7h)};_e.$2M.$8KE=function(n){return!!n&&!n.$7h};_e.$2M.$8Mo=function(n){return!n};_e.$2M.$8Nb=function(n){return!!n&&!!n.$7h&&(_a.$YQ.isInstanceOfType(n.$7h)||_a.$OB.isInstanceOfType(n.$7h))};_e.$2M.$3qT=function(n){return n?"prev":"next"};_e.$2M.$2u9=function(n){var i=null;if(_a.$YQ.isInstanceOfType(n)){var t=n;switch(t.$1dy){case 0:i=_a.$7E.$1sa(t.$15v,t.$18k,!1,!1);break;case 3:i=_a.$7E.$1sa(t.$15v,t.$18k,!0,!0);break;case 1:i=_a.$7E.$1sa(t.$15v,t.$18k,!0,!1);break;case 2:i=_a.$7E.$1sa(t.$15v,t.$18k,!1,!0);break;default:break}}else if(_a.$OB.isInstanceOfType(n)){var r=n;var u=!r.$1sY;i=r.$3Km?_a.$7E.$AEL(r.$1MC,u):_a.$7E.$8SO(r.$1MC,u)}else if(_a.$8o.isInstanceOfType(n)){var f=n;i=_a.$7E.$6LA(f.$vG)}return i};_e.$2M.$7bh=function(n,t,i){var r=n.onerror;n.onerror=function(t){n.onerror=r;_e.$66.$10m(t.target.error.name,i);r&&r(t)};var u=t;t=function(t){n.onerror=r;u(t)};return t};function $4uF(n,t,i,r){if(n.$PS===2)i(t);else{var u=this,f=this;n.$Ds(function(){$4uF(n,t+1,i,r)},function(n){_e.$66.$10m(n.name,r)})}}function $4uG(n,t,i,r,u){var f=n.$PS?1:0;var e=this,o=this;n.$Ds(function(){i+=f;if(n.$PS===2)r(!1,i);else if(t.$5lV(n.get_$1CE(),n.get_$1an().data)){n.$PS=0;r(!0,i)}else $4uG(n,t,i,r,u)},function(n){_e.$66.$10m(n.name,u)})}function $3c4(n){if(!n.$PS)throw Error.invalidOperation("cannot ask for value before calling next");}function $2lV(n){n.$PS=n.get_$5ft()!==null?1:2}_e.$2M.prototype={$QB:null,$PS:0,$2Jp:0,get_$1an:function(){$3c4(this);return this.get_$8Hj()},get_$1CE:function(){$3c4(this);return this.get_$5ft()},get_$3px:function(){$3c4(this);return this.get_$8Hi()},get_$3Y:function(){return this.$PS},$C:function(n,t){if(this.$2Jp===null){_js.Trace.logWarning(_a.$0.$DH,"Asking for Count on anything other than a cusor strategy will require query traversal.");var i=this;$4uF(this,0,function(t){i.$2Jp=t;n(i.$2Jp)},t)}else n(this.$2Jp)},$Ds:function(n,t){switch(this.$PS){case 0:var i=this;this.$41(function(){$2lV(i);n()},t);break;case 1:var r=this;this.$43D(function(){$2lV(r);n()},t);break;case 2:throw Error.invalidOperation("The end of the content was reached by the previous call to next!");}},$1mJ:function(n,t,i){$4uG(this,n,0,t,i)},$1W9:function(n,t,i){if(n&&this.$PS!==2)switch(this.$PS){case 0:var r=this,f=this;this.$41(function(){$2lV(r);r.$1W9(n-1,t,i)},function(n){_e.$66.$10m(n.name,i)});break;case 1:var u=this,e=this;this.$5gI(n,function(){$2lV(u);_e.$66.$1Uu(t)},function(n){_e.$66.$10m(n.name,i)});break;case 2:throw Error.invalidOperation("The end of the content was reached by the previous call to next!");}else _e.$66.$1Uu(t)},$41:function(n,t){this.$43D(n,t)},$5gI:function(n,t,i){if(n&&this.$PS!==2){var r=this;this.$Ds(function(){r.$5gI(n-1,t,i)},i)}else t()}};_e.$18t=function(n,t){this.data=n;this.metadata=t};_e.$18t.prototype={data:null,metadata:null};_e.$qk=function(n,t,i){this.$NT=n;this.$B2=t;this.$7N=i;this.$4j3=t.objectStore("__versions");this.$42H=t.objectStore("__indexes")};function $79B(n,t,i){var r=!1;if(i.storeName===t){r=!0;if(n.$7N.$1nb(t)){var u=n.$7N.$1cz(t);var f=i.storeVersion||"";u===f&&(r=!1)}}return r}_e.$qk.prototype={$NT:null,$B2:null,$4j3:null,$42H:null,$7N:null,$7n7:function(n,t,i,r){if(this.$7N.$1nb(n))throw Error.invalidOperation("the object store: "+n+" already exists.");if(n.startsWith("__"))throw Error.invalidOperation("the object store: "+n+" begins with the reserved prefix __.");this.$NT.createObjectStore(n,new _a.$Ur(null,i));this.$7N.$D(n,t);this.$4j3.put(new _e.$xx(n,t),n)},$6WB:function(n){if(this.$7N.$1nb(n)){var r=this.$NT.deleteObjectStore(n);this.$7N.$34(n);var u=_a.$Fb.$34(this.$4j3,n);var t=this.$42H.openCursor(_a.$7E.$1Lb(),"next");var i=this;_e.$3t.$Ze(_a.$Fa,_a.$JD,"RemoveObjectStore",t,function(t){if(t.target.result){var r=t.target.result.value;$79B(i,n,r)&&_a.$RY.$34(t.target.result);_a.$RY.$Ds(t.target.result)}})}},$D9:function(n,t){if(this.$7N.$1nb(n)){var i=t.$Tv();var r=this.$B2.objectStore(n);_a.$Fb.$34(r,i)}},$5LN:function(n,t,i){if(!this.$7N.$1nb(t))throw Error.invalidOperation("the object store: "+t+" does not exist.");if(this.$7N.$5ee(t,n))throw Error.invalidOperation("the object store: "+t+" already has index "+n+" declared.");var f=this.$7N.$1cz(t);var r=new _e.$18o(t,n,i,f);this.$42H.put(r);var e=this.$B2.objectStore(t);var u=_e.$Ny.$E(r);e.createIndex(n,u.$5nv.$5t,_a.$UI.$3rB);this.$7N.$1rN(r.storeName,u)}};_e.$18v=function(n,t){_e.$18v.initializeBase(this,[n,t,new _a.$4w("data."+t[0])])};_e.$18v.prototype={$7ax:function(n,t,i){_e.$Ny.$4ix(this.$lc[0],n,t,i)}};_e.$Nz=function(){};_e.$Nz.$Hd=function(n,t,i,r){t.oncomplete=function(){_js.Trace.logInfo(_a.$0.$DH,"idb transaction successfully completed");var t=new _a.$Jd(_a.$2x.$14X(_a.$0.$DH),n);_a.$2x.$k3(t,function(){_e.$66.$1Uu(i)})};t.onabort=function(t){_js.Trace.logInfo(_a.$0.$DH,"idb transaction aborted!");var i="AbortError";if(t.target.error){i=t.target.error.name;_js.Trace.logError(_a.$0.$DH,"aborted due to error: "+i)}var u=new _a.$Jd(_a.$2x.$14X(_a.$0.$DH),n);_a.$2x.$k3(u,function(){_e.$66.$10m(i,r)})}};_e.$xx=function(n,t){this.name=n.toLowerCase();this.version=t};_e.$xx.prototype={name:null,version:null};_e.$1Hc=function(){};_e.$1Hc.registerInterface("_e.$1Hc");_e.$1Ha=function(){};_e.$1Ha.registerInterface("_e.$1Ha");_e.$BE=function(n,t){this.$$d_$8I7=Function.createDelegate(this,this.$8I7);this.$NT=n;this.$7N=_e.$Fr.$qp();this.$NE=new _a.$zf(this);this.$gy=new _a.$Sm;this.$CH="";this.$1A8=t;this.$2ib=0;this.$1r6=new Array(0)};_e.$BE.$7kC=function(n,t,i){var r=null;try{r=new _e.$8Q(t,i);n(r)}finally{r&&r.$1R()}};_e.$BE.$7n8=function(n){var t=String.format("CREATE TABLE IF NOT EXISTS {0}({1} TEXT, {2} TEXT, {3} TEXT)","__OBJECTSTORE","StoreName","IndexName","IndexKeyPath");var i=new Array(0);_e.$5C.$HC(n,"SqlBrowserDb.CreateObjectStoreMetaTable",t,i,null,null)};_e.$BE.$7oc=function(n){var t=String.format("CREATE TABLE IF NOT EXISTS {0}({1} TEXT PRIMARY KEY, {2} TEXT)","__VERSIONS","EntityName","VersionName");var i=new Array(0);_e.$5C.$HC(n,"SqlBrowserDb.CreateVersionMetaTable",t,i,null,null)};_e.$BE.$7kN=function(n){var t=String.format("CREATE TABLE IF NOT EXISTS {0}({1} TEXT PRIMARY KEY, {2} TEXT)","__BLOBS","StoreName","Blobs");var i=new Array(0);_e.$5C.$HC(n,"SqlBrowserDb.CreateBlobMetaTable",t,i,null,null)};_e.$BE.$7o3=function(n){var t=String.format("CREATE TABLE IF NOT EXISTS {0}({1} TEXT PRIMARY KEY, {2} TEXT)","__SETTINGS","Id","Value");var i=new Array(0);_e.$5C.$HC(n,"SqlBrowserDb.CreateBlobMetaTable",t,i,null,null)};_e.$BE.$AE6=function(n,t){var i=String.format("INSERT OR REPLACE INTO {0} ({1}, {2}) VALUES(?, ?)","__VERSIONS","EntityName","VersionName");var r=["db",t];_e.$5C.$HC(n,"SqlBrowserDb.UpdateVersionMetaTable",i,r,null,null)};_e.$BE.$ABA=function(n,t){var i=String.format("INSERT OR REPLACE INTO {0} ({1}, {2}) VALUES(?, ?)","__SETTINGS","Id","Value");var r=["Features",JsonParser.serialize(t)];_e.$5C.$HC(n,"SqlBrowserDb.UpdateActivatedFeatures",i,r,null,null)};function $79Y(n,t){var r=null;var u=null;var f=null;var e=null;var i=String.format("SELECT * FROM {0}","__OBJECTSTORE");var o=new Array(0);var s=this;_e.$5C.$HC(t,"SqlBrowserDb.PopulateMetadataFromDatabase1",i,o,function(t,i){r=i;$2lW(n,r,u,f,e)},null);i=String.format("SELECT * FROM {0}","__VERSIONS");var h=this;_e.$5C.$HC(t,"SqlBrowserDb.PopulateMetadataFromDatabas2",i,o,function(t,i){u=i;$2lW(n,r,u,f,e)},null);i=String.format("SELECT * FROM {0}","__BLOBS");var c=this;_e.$5C.$HC(t,"SqlBrowserDb.PopulateMetadataFromDatabase3",i,o,function(t,i){f=i;$2lW(n,r,u,f,e)},null);i=String.format("SELECT * FROM {0}","__SETTINGS");var l=this;_e.$5C.$HC(t,"SqlBrowserDb.PopulateMetadataFromDatabase4",i,o,function(t,i){e=i;$2lW(n,r,u,f,e)},null)}function $2lW(n,t,i,r,u){if(t&&i&&r&&u){n.$7N=_e.$Fr.$7m1(t,i,r);$79a(n,i);$79Z(n,u)}}function $79a(n,t){for(var i=0;i<t.rows.length;++i){var r=t.rows.item(i);if(r.EntityName==="db"){n.$CH=r.VersionName;break}}}function $79Z(n,t){for(var i=0;i<t.rows.length;++i){var r=t.rows.item(i);if(r.Id==="Features"){var u=r.Value;n.$1r6=JsonParser.deserialize(u);break}}n.$1r6=n.$1r6||new Array(0)}_e.$BE.prototype={$NT:null,$1A8:null,$7N:null,$NE:null,$gy:null,$CH:null,$1r6:null,$2ib:0,get_$36:function(){return this.$CH},get_$1TX:function(){return this.$7N.get_$1TX()},get_$1r7:function(){return this.$1r6},$3m8:function(n,t,i,r,u){var o=this.$7N.$3g();var e=this.$2ib++;this.$1A8.$4BK(e);var h=this,s=this,f=this;this.$NT.transaction(function(r){_e.$BE.$7kC(i,r,o);_e.$BE.$AE6(r,n);_e.$BE.$ABA(r,t)},function(n){s.$1A8.$238(e);_e.$Be.$2de(n,u)},function(){f.$1A8.$238(e);f.$7N=o.$3g();f.$CH=n;f.$1r6=t;r&&r()})},$Bl:function(n,t,i,r){var u=null;var f=this.$2ib++;this.$1A8.$4BK(f);var e=this,o=this,s=this;this.$NT.transaction(function(i){_js.Trace.logInfo(_a.$0.$ZZ,"queuing transaction {0} with id {1}",n.$Zi,f);u=new _e.$5C(i,e.$7N,e.$NE,e.$gy,n);t(u)},function(t){var i=_a.$6.aes(_a.$0.$ZZ,"SqlDbFailure");try{_js.Trace.logInfo(_a.$0.$ZZ,"transaction {0} ended in error.",n.$Zi);o.$1A8.$238(f);u&&u.$2ne?_e.$Be.$10l(5,"transaction aborted",r):_e.$Be.$8Jh(t)?o.$1A8.$8Th():u&&u.get_$5o7()?_e.$Be.$2de(u.get_$5o7(),r):_e.$Be.$2de(t,r)}finally{_a.$6.aee(i)}},function(){_js.Trace.logInfo(_a.$0.$ZZ,"transaction {0} with id {1} ended in success.",n.$Zi,f);var t=_a.$6.aes(_a.$0.$ZZ,"SqlDbSuccess");try{s.$1A8.$238(f);u&&u.$3NH();_e.$Be.$9oo(i,u.$ei.$Zi)}finally{_a.$6.aee(t)}})},$6q2:function(n,t){var i=this,r=this;this.$3m8("",new Array(0),this.$$d_$8I7,function(){n&&n()},function(n){t&&t(n)})},$Hd:function(n,t){this.$NE.$Hd(n,t)},$11q:function(n){this.$NE.$11q(n)},$4hs:function(){this.$NE.$4hs()},$5Lm:function(n){if(!this.$7N.$1wP(n))throw Error.invalidOperation(String.format("The object store {0} does not exist",n));var t=new _e.$BE.$A3m(n,this.$gy);this.$gy.$5AD(t);return t},$41:function(n,t){_a.$3.$K(n,"success");var i=this,r=this,u=this;this.$NT.transaction(function(n){_e.$BE.$7n8(n);_e.$BE.$7oc(n);_e.$BE.$7kN(n);_e.$BE.$7o3(n);$79Y(i,n)},function(n){_e.$Be.$2de(n,t)},function(){n()})},$85o:function(n){var t=this.$7N.$1wP(n);t||Error.invalidOperation(String.format("The storeName {0} doesn't exist",n));return t.$CH},$4O:function(){},$8I7:function(n){for(var t=n,r=this.get_$1TX(),i=0;i<r.length;++i)t.$6WB(r[i]);t.$9ku();t.$9kw();t.$9kt();t.$9kv()}};_e.$BE.$A3m=function(n,t){_e.$BE.$A3m.initializeBase(this,[n,t])};_e.$Be=function(n,t){_e.$Be.initializeBase(this,[n,t])};_e.$Be.$2de=function(n,t){var i=n.message;var r=_e.$Be.$A9M(n);_js.Trace.logError(_a.$0.$ZZ,"SQL Error - code "+r+": {0}",i);_e.$Be.$10l(r,i,t)};_e.$Be.$10l=function(n,t,i){if(i){var r=new _a.$Jd(_a.$2x.$14X(_a.$0.$ZZ),"SQLBrowserDBError.ReportError");r.$2Mp=r.$2C+"_"+t;_a.$2x.$k3(r,function(){i(new _e.$Be(n,t))})}};_e.$Be.$9on=function(n,t,i,r){if(n){var u=new _a.$Jd(_a.$2x.$14X(_a.$0.$ZZ),"SQLBrowserDBError.ReportStatementSuccess_"+r);_a.$2x.$k3(u,function(){n(t,i)})}};_e.$Be.$9oo=function(n,t){if(n){var i=new _a.$Jd(_a.$2x.$14X(_a.$0.$ZZ),"SQLBrowserDBError.ReportTransactionSuccess_"+t);_a.$2x.$k3(i,function(){n()})}};_e.$Be.$8Jh=function(n){var t=n.code;var i=(n.message||"").toLowerCase();var r=!t&&i.indexOf("closed")>=0;_js.Trace.logWarning(_a.$0.$ZZ,"returning {0} for the sql error with code {1} and message {2} in IsDatabaseClosedError.",r,t,i);return r};_e.$Be.$A9M=function(n){var t=0;switch(n.code){case 6:t=1;break;case 1:t=0;break;case 4:t=3;break;case 5:t=0;break;case 7:t=4;break;case 3:t=0;break;case 0:t=0;break;case 2:t=0;break}return t};_e.$n3=function(n,t){_e.$n3.initializeBase(this);this.$6py=n;this.$1A8=t};function $79b(n,t,i,r,u){_a.$3.$1G(t,"name");r.val=null;u.val="";try{r.val=n.$6py.openDatabase(t,"",_u.Strings.l_OWA_Text,i*1048576,null)}catch(f){u.val=f.message;r.val=null}return!!r.val}_e.$n3.prototype={$6py:null,$1A8:null,$9eC:function(n,t,i,r){_a.$3.$K(i,"success");var u;var f;var e,o,s;if(s=$79b(this,n,t,e={val:u},o={val:f}),u=e.val,f=o.val,s){var h=new _e.$BE(u,this.$1A8);var c=this,l=this;h.$41(function(){i(h)},function(n){r&&r(n)})}else r&&r(new _a.$Av(0,f))},$7qm:function(n,t,i){var r=this,u=this;this.$9eC(n,5,function(n){n.$6q2(function(){t()},function(n){i&&i(n)})},function(n){i&&i(n)})}};_e.$Di=function(n,t,i,r){this.$B2=n;this.$7N=t;this.$29P=i;this.$tu=r};_e.$Di.$80Z=function(n,t){var i=null;n.rows.length&&(i=_e.$h5.$2OE(0,n,t).$27);return i};function $4uP(n,t){if(t){$79f(n,t);$79g(n,t)}}function $79g(n,t){if(t.$H0)for(var i=0;i<t.$H0.length;++i)if(!n.$7N.$2PS(t.$H0[i].$Ha.$5t)){var r=String.format("KeyPath {0} is being sorted but it is not an indexed field",t.$H0[i].$Ha.$5t);_a.$Av.$1K2(1,r)}}function $79f(n,t){if(t.$7h)for(var r=t.$7h.$1mD,i=0;i<r.length;++i)if(!n.$7N.$2PS(r[i].$5t)){var u=String.format("KeyPath {0} is being queried but it is not an indexed field",r[i].$5t);_a.$Av.$1K2(1,u)}}function $79d(n,t,i){var r=[];var f={};Array.add(r,t);for(var e=0;e<n.$7N.get_$2CT().length;++e){var o=n.$7N.get_$2CT()[e];var p=o.$1DO(i);f[o.$5t]=p;o.$7qr(i)}try{Array.add(r,JsonParser.serialize(i));for(var s=0;s<n.get_$1yw().length;++s){var h=n.get_$1yw()[s];var c=f[h];$79i(n,t,h,c);$79j(n,t,h,c);Array.add(r,c)}for(var l=0;l<n.$7N.get_$2IO().length;++l){var v=n.$7N.get_$2IO()[l].$5t;var u=f[v];u=undefined===u?null:u;$79h(n,t,v,u);Array.add(r,u)}}finally{for(var a=0;a<n.$7N.get_$2CT().length;++a){var y=n.$7N.get_$2CT()[a];var w=f[y.$5t];y.$2BV(i,w)}}return r}function $79i(n,t,i,r){if($5(r)){var u=String.format("KeyPath {0} is a declared index on store {1} but does not exist in object with id {2}",i,n.$7N.get_$of(),t);_a.$Av.$1K2(1,u)}}function $79h(n,t,i,r){if(r&&!String.isInstanceOfType(r)){var u=String.format("KeyPath {0} is a blob store {1} but it is not a string {2}",i,n.$7N.get_$of(),t);_a.$Av.$1K2(1,u)}}function $79j(n,t,i,r){if(!String.isInstanceOfType(r)&&!Number.isInstanceOfType(r)){var u=String.format("KeyPath {0} is a declared index on store {1} but the object with id {2} is attempting to store the non-primitive type {3}.",i,n.$7N.get_$of(),t,Object.getType(r).getName());_a.$Av.$1K2(1,u)}}function $79e(n){for(var t=new Sys.StringBuilder("(?, ?"),i=0;i<n.get_$1yw().length;++i)t.append(", ?");for(var r=0;r<n.$7N.get_$2IO().length;++r)t.append(", ?");t.append(")");return t.toString()}function $79c(n){for(var t=new Sys.StringBuilder(String.format("({0}, {1}",_e.$F9.$17T,"json")),i=0;i<n.get_$1yw().length;++i)t.append(String.format(", [{0}]",n.get_$1yw()[i]));for(var r=0;r<n.$7N.get_$2IO().length;++r)t.append(String.format(", [{0}]",n.$7N.get_$2IO()[r].$5t));t.append(")");return t.toString()}_e.$Di.prototype={$B2:null,$7N:null,$29P:null,$tu:null,get_$1N:function(){return this.$7N.get_$of()},get_$1yw:function(){return this.$7N.get_$1yw()},$3f:function(n,t,i){_a.$3.$K(n,"id must be provided");_a.$3.$K(n.$Tv(),"id must be provided");_a.$3.$K(t,"success callback must be provided");var r=n.$Tv();_a.$3.$K(r,"id must be provided");_a.$3.$1G(r.toString(),"id must be provided");var u=String.format("SELECT * FROM [{0}] WHERE {1} = ?",this.$7N.get_$of(),_e.$F9.$17T);var f=[r];var e=this;_e.$5C.$HC(this.$B2.$B2,this.$B2.$ei.$Zi,u,f,function(n,i){var r=_e.$Di.$80Z(i,e.$7N.get_$2CT());t(r)},i)},$im:function(n,t,i){_a.$3.$K(n,"id must be provided");var r=n.$Tv();_a.$3.$K(r,"id must be provided");_a.$3.$1G(r.toString(),"id must be provided");var f=String.format("DELETE FROM [{0}] WHERE {1} = ?",this.$7N.get_$of(),_e.$F9.$17T);var e=[r];this.$tu.$17a(this,n);var u=this;_e.$5C.$HC(this.$B2.$B2,this.$B2.$ei.$Zi,f,e,function(){u.$29P&&u.$29P(u.get_$1N(),2,n,null);t&&t()},i)},$1t:function(n,t){var i=String.format("DELETE FROM [{0}]",this.$7N.get_$of());var r=[];this.$tu.$1jU(this);var u=this;_e.$5C.$HC(this.$B2.$B2,this.$B2.$ei.$Zi,i,r,function(){n&&n()},t)},$9ky:function(n,t,i,r){_a.$3.$K(n,"id must be provided");_a.$3.$K(t,"json must be provided");var f=!0;var e=!1;if(this.$B2.$ei.$4Zt){var o=String.format("SELECT COUNT(*) FROM [{0}] WHERE {1} = ?",this.$7N.get_$of(),_e.$F9.$17T);var s=[n.$Tv()];var l=this,a=this;_e.$5C.$HC(this.$B2.$B2,this.$B2.$ei.$Zi,o,s,function(n,t){var i=t.rows.item(0)["COUNT(*)"];f=!!i},function(t){_js.Trace.logInfo(_a.$0.$5c,"Database query with ClientStoreId = {0} failed with error: {1}",n.toString(),t.$3j)})}var h=String.format("INSERT OR REPLACE INTO [{0}] {1} VALUES {2}",this.$7N.get_$of(),$79c(this),$79e(this));var c=$79d(this,n.$Tv(),t);this.$tu.$1jV(this,n,t);var u=this;_e.$5C.$HC(this.$B2.$B2,this.$B2.$ei.$Zi,h,c,function(r,o){e=!0;u.$29P&&(f?u.$29P(u.get_$1N(),1,n,t):u.$29P(u.get_$1N(),0,n,t));n.$Tv()||(n=new _a.$OK(o.insertId));i&&i(n)},r)},$JP:function(n,t,i){_a.$3.$K(t,"success");$4uP(this,n);t(new _e.$h5(this.$B2,n,this.$7N.get_$of(),this.$7N.get_$2CT()))},$41s:function(n,t,i){_a.$3.$K(t,"success");var r=new _a.$8P(n,null);$4uP(this,r);t(new _e.$h4(this.$B2,r,this.$7N.get_$of()))}};_e.$5C=function(n,t,i,r,u){this.$B2=n;this.$7N=t;this.$tu=new _a.$Sl(this,r);this.$1HK=null;this.$ei=u;i&&(this.$1HK=new _a.$zd(i))};_e.$5C.$HC=function(n,t,i,r,u,f){var s="";var h="";if(_js.Trace.$2v&&_js.Trace.$Tw===5){for(var e="{ ",o=0;o<r.length;++o){e+=r[o]?r[o].toString():"null";o<r.length-1&&(e+=", ")}e+=" }";s=String.format("ExecuteSql => {0} {1}",i,e.substr(0,50));h=String.format("ExecuteSql => {0} {1}",i,e.substr(0,256))}n.executeSql(i,r,function(n,i){var r=_a.$6.aes(_a.$0.$ZZ,"ExecuteSqlSuccess");try{_e.$Be.$9on(u,n,i,t)}finally{_a.$6.aee(r)}},function(t,r){var u=_a.$6.aes(_a.$0.$ZZ,"ExecuteSqlFailure");try{n.lastBrowserDbTransactionError=r;i!=="BOGUS SQL STATEMENT TO FORCE ROLLBACK"&&_e.$Be.$2de(r,f);return!0}finally{_a.$6.aee(u)}})};_e.$5C.prototype={$B2:null,$7N:null,$1HK:null,$tu:null,$ei:null,$2ne:!1,get_$1KE:function(){return this.$ei},get_$5o7:function(){return this.$B2.lastBrowserDbTransactionError},get_$7wD:function(){var n=null;this.$1HK&&(n=this.$1HK.$$d_$9lC);return n},$2nd:function(){this.$2ne=!0;_e.$5C.$HC(this.$B2,"SqlBrowserDbTransaction.Abort","BOGUS SQL STATEMENT TO FORCE ROLLBACK",[],null,null)},$Dv:function(n){var t=this.$7N.$85n(n);if(!t)throw Error.invalidOperation(String.format("Object store {0} does not exist",n));return new _e.$Di(this,t,this.get_$7wD(),this.$tu)},$3NH:function(){this.$1HK&&this.$1HK.$3NH(this.$ei)}};_e.$F9=function(){};_e.$1F2=function(n,t,i){_e.$1F2.initializeBase(this,[n,t,i]);this.$7h=n.$7h};_e.$1F2.prototype={$7h:null,get_$AFw:function(){return"WHERE ["+this.$7h.get_$UR().$5t+"] = ?"},get_$6pv:function(){return[this.$7h.$vG]}};_e.$1F3=function(n,t,i){_e.$1F3.initializeBase(this,[n,t,i]);this.$7h=n.$7h};_e.$1F3.prototype={$7h:null,get_$AFw:function(){var n=" ["+this.$7h.get_$UR().$5t+"] ";return"WHERE"+n+this.get_$8Qn()+" ? AND"+n+this.get_$9qm()+" ?"},get_$6pv:function(){return[this.$7h.$15v,this.$7h.$18k]},get_$8Qn:function(){var n=">";this.$7h.$1dy&&this.$7h.$1dy!==2||(n+="=");return n},get_$9qm:function(){var n="<";this.$7h.$1dy&&this.$7h.$1dy!==1||(n+="=");return n}};_e.$1F4=function(n,t,i){_e.$1F4.initializeBase(this,[n,t,i]);this.$7h=n.$7h};_e.$1F4.prototype={$7h:null,get_$AFw:function(){var n;switch(this.$7h.$3Km){case 0:n=this.$7h.$1sY===1?">=":">";break;case 1:n=this.$7h.$1sY===1?"<=":"<";break;default:throw Error.invalidOperation("OperatorType is not supported.");}return"WHERE ["+this.$7h.get_$UR().$5t+"] "+n+" ?"},get_$6pv:function(){return[this.$7h.$1MC]}};_e.$Fr=function(){this.$xQ=[]};_e.$Fr.$qp=function(){return new _e.$Fr};_e.$Fr.$7m1=function(n,t,i){for(var c=new _e.$Fr,l={},r={},u=0;u<t.rows.length;++u){var a=t.rows.item(u);var v=a.EntityName.toLowerCase();l[v]=a.VersionName;r[v]=null}for(var f=0;f<i.rows.length;++f){for(var y=i.rows.item(f),nt=y.StoreName.toLowerCase(),tt=JsonParser.deserialize(y.Blobs),p=[],w=tt,it=w.length,e=0;e<it;++e){var rt=w[e];Array.add(p,new _a.$4w(rt))}r[nt]=p}for(var b=n.rows,o=0;o<b.length;++o){var s=b.item(o);var h=s.StoreName;var k=s.IndexName;var d=s.IndexKeyPath;var g=$4uT(c,h,l[h.toLowerCase()],r[h.toLowerCase()]);_js.$8.$a(k)||g.$1rN(k);_js.$8.$a(d)||g.$5A1(new _a.$4w(d))}return c};function $2lX(n,t){return n.$xQ[t]}function $4uT(n,t,i,r){var u=n.$1wP(t);if(!u){u=new _e.$11e(t,i,r);Array.add(n.$xQ,u)}return u}_e.$Fr.prototype={get_$1TX:function(){for(var t=[],n=0;n<this.$xQ.length;++n){var i=$2lX(this,n);Array.add(t,i.$Zb)}return t},$D:function(n,t,i){$4uT(this,n,t,i)},$34:function(n){for(var t=0;t<this.$xQ.length;++t){var i=$2lX(this,t);if(i.$351(n.$Zb)){Array.removeAt(this.$xQ,t);break}}},$3g:function(){for(var t=new _e.$Fr,n=0;n<this.$xQ.length;++n){var i=$2lX(this,n);Array.add(t.$xQ,i.$3g())}return t},$3uo:function(n){return!!this.$1wP(n)},$1wP:function(n){for(var i=null,t=0;t<this.$xQ.length;++t){var r=$2lX(this,t);if(r.$351(n)){i=r;break}}return i},$85n:function(n){return this.$1wP(n)}};_e.$11e=function(n,t,i){this.$Zb=n;this.$CH=t;this.$1M8=i||[];this.$1nT=Array.clone(this.$1M8);this.$2QU={};this.$1yv={}};_e.$11e.prototype={$Zb:null,$CH:null,$1M8:null,$1nT:null,$2QU:null,$1yv:null,get_$of:function(){return this.$Zb},get_$1yw:function(){var n=[];var t=this.$1yv;for(var i in t){var r={key:i,value:t[i]};Array.add(n,r.value)}return n},get_$2CT:function(){return this.$1nT},get_$2IO:function(){return this.$1M8},$351:function(n){return this.$Zb.toLowerCase()===n.toLowerCase()},$3g:function(){var n=new _e.$11e(this.$Zb,this.$CH,this.$1M8);n.$2QU=_0365f.$5F.$3g(this.$2QU);n.$1yv=_0365f.$5F.$3g(this.$1yv);n.$1nT=Array.clone(this.$1nT);return n},$1rN:function(n){this.$2QU[n.toLowerCase()]=n},$5A1:function(n){this.$1yv[n.$5t.toLowerCase()]=n.$5t;Array.add(this.$1nT,n)},$8D3:function(n){return n.toLowerCase()in this.$2QU},$2PS:function(n){return n.toLowerCase()in this.$1yv||n.toLowerCase()===_e.$F9.$17T}};_e.$HG=function(n,t,i){this.$4A=n;this.$Zb=t;this.$6dt=i};_e.$HG.$E=function(n,t,i){var r=null;n&&n.$7h?_a.$8o.isInstanceOfType(n.$7h)?r=new _e.$1F2(n,t,i):_a.$YQ.isInstanceOfType(n.$7h)?r=new _e.$1F3(n,t,i):_a.$OB.isInstanceOfType(n.$7h)&&(r=new _e.$1F4(n,t,i)):r=new _e.$HG(n,t,i);return r};_e.$HG.$888=function(n){return n?"DESC":"ASC"};function $79t(n){return!!n.$4A&&!!n.$4A.$H0&&n.$4A.$H0.length>0}function $2lY(n,t){var i="SELECT "+t+" FROM ["+n.$Zb+"]";var r=n.get_$AFw();r&&(i+=" "+r);var u=n.get_$9eq();u&&(i+=" "+u);return i}_e.$HG.prototype={$4A:null,$Zb:null,$6dt:0,get_$9tl:function(){return this.$6dt===1?$2lY(this,"*"):$2lY(this,_e.$F9.$17T)},get_$9t1:function(){return $2lY(this,"COUNT(*)")},get_$4dE:function(){var n=[];this.get_$6pv()&&Array.addRange(n,this.get_$6pv());return n},get_$AFw:function(){return""},get_$6pv:function(){return[]},get_$9eq:function(){var t="";if($79t(this)){t="ORDER BY";for(var n=0;n<this.$4A.$H0.length;++n){var i=this.$4A.$H0[n];t+=" ["+i.$Ha.$5t+"] "+_e.$HG.$888(i.$GN)+(n<this.$4A.$H0.length-1?",":"")}}return t},$9tW:function(){for(var n=[],t=0;t<arguments.length;++t)n[t]=arguments[t];for(var r="",i=0;i<n.length;++i){r+="["+n[i].$5t+"]";i+1<n.length&&(r+=", ")}return $2lY(this,r)}};_e.$h4=function(n,t,i){this.$HI=new _e.$Ll(n,_e.$HG.$E(t,i,0))};_e.$h4.$2OE=function(n,t){var i=t.rows.item(n);var r=i[_e.$F9.$17T];return new _a.$OK(r)};_e.$h4.prototype={$HI:null,$C:function(n,t){this.$HI.$C(n,t)},$Ds:function(n,t,i){this.$HI.$Ds(_a.$OK,n,_e.$h4.$2OE,t,i)}};_e.$h5=function(n,t,i,r){this.$HI=new _e.$Ll(n,_e.$HG.$E(t,i,1));this.$1nT=r};_e.$h5.$2OE=function(n,t,i){for(var u=t.rows.item(n),s=u.json,f=JsonParser.deserialize(s),e=i,h=e.length,r=0;r<h;++r){var o=e[r];var c=u[o.$5t];o.$2BV(f,c)}return new _a.$g4(_e.$h4.$2OE(n,t),f)};_e.$h5.prototype={$HI:null,$1nT:null,get_$JQ:function(){return this.$HI.$8y},$C:function(n,t){this.$HI.$C(n,t)},$Ds:function(n,t,i){var f=this;var r=t?function(n,i,r){t(n,i,r)}:null;var u=this;this.$HI.$Ds(_a.$g4,n,function(n,t){return _e.$h5.$2OE(n,t,u.$1nT)},r,i)},$1mJ:function(n,t,i,r){this.$HI.$1mJ(n,t,i,r)},$1W9:function(n,t,i){this.$HI.$1W9(n,t,i)}};_e.$Ll=function(n,t){this.$B2=n;this.$1nX=t};_e.$Ll.$7xv=function(n,t){for(var i=0;i<n.rows.length;++i)if(t.$8Nw(n.rows.item(i)))return i;return-1};_e.$Ll.$5Eb=function(n,t,i){var r=String.format(" LIMIT {0} OFFSET {1}",i,t);return n+r};function $4uU(n){if(n.$1pW)throw Error.invalidOperation("An async operation is currently in progress");}_e.$Ll.prototype={$1nX:null,$B2:null,$8y:0,$1pW:!1,$C:function(n,t){var i=this;_e.$5C.$HC(this.$B2.$B2,this.$B2.$ei.$Zi,this.$1nX.get_$9t1(),this.$1nX.get_$4dE(),function(t,i){var r=i.rows.item(0)["COUNT(*)"];n(r)},t)},$Ds:function(n,t,i,r,u){$4uU(this);this.$1pW=!0;var e=_e.$Ll.$5Eb(this.$1nX.get_$9tl(),this.$8y,t);this.$8y=this.$8y+t;var f=this,o=this;_e.$5C.$HC(this.$B2.$B2,this.$B2.$ei.$Zi,e,this.$1nX.get_$4dE(),function(n,u){f.$1pW=!1;if(r){for(var o=u.rows.length,h=_a.$6.ads(_a.$0.$ZZ,"SqlQueryResultImpl.Next_BuildResultsFromRow_"+o),s=new Array(o),e=0;e<o;++e){var c=i(e,u);s[e]=c}_a.$6.ade(h);r(f.$B2,s,s.length<t)}},function(n){o.$1pW=!1;u&&u(n)})},$1mJ:function(n,t,i,r){$4uU(this);_a.$3.$K(t,"condition cannot be null");this.$1pW=!0;this.$5gF(t,this.$8y,i,r)},$1W9:function(n,t,i){this.$8y+=n;t()},$5gF:function(n,t,i,r){var f;var e=_e.$Ll.$5Eb((f=this.$1nX).$9tW.apply(f,n.$1mD),t,500);var u=this,o=this;_e.$5C.$HC(this.$B2.$B2,this.$B2.$ei.$Zi,e,this.$1nX.get_$4dE(),function(f,e){var o=_e.$Ll.$7xv(e,n);var s=o!==-1;var h=e.rows.length>0;if(s||!h){u.$1pW=!1;u.$8y=t+o;i(s)}else u.$5gF(n,t+e.rows.length,i,r)},function(n){o.$1pW=!1;r&&r(n)})}};_e.$8Q=function(n,t){_e.$8Q.initializeBase(this);this.$BY=n;this.$1jK=t};_e.$8Q.$7gG=function(n){if(n.startsWith("__"))throw Error.create("An object store cannot be created with a name beginning with __");};_e.$8Q.$7dP=function(n){for(var t="(",i=0;i<n.length;++i){i>0&&(t+=", ");t+=String.format("[{0}]",n[i].$5t.$5t)}t+=")";return t};_e.$8Q.$7gP=function(n){if(n.length>2)throw Error.invalidOperation("Cannot create a multi-column index with more than two fields");};_e.$8Q.$7gK=function(n,t){if(n.$8D3(t))throw Error.invalidOperation(String.format("The index {0} already exists",t));};function $79z(n,t,i,r){for(var u=0;u<i.length;++u){var f=i[u];if(!r.$2PS(f.$5t.$5t)){$79y(n,r,f);$79v(n,r,t,f)}}}function $7A1(n,t,i,r){var u=i?"INTEGER PRIMARY KEY AUTOINCREMENT":"TEXT PRIMARY KEY";var f=$7A3(n,r);var e=String.format("CREATE TABLE [{0}]({1} {3}, {2} BLOB"+f+")",t,_e.$F9.$17T,"json",u);var o=new Array(0);_e.$5C.$HC(n.$BY,"SqlSchemaUpdater.CreateUnderlyingObjectStoreTable",e,o,null,null)}function $7A3(n,t){var u="";if(t&&t.length>0){for(var i=new Sys.StringBuilder,r=0;r<t.length;++r){i.append(", [");i.append(t[r].$5t);i.append("] BLOB")}u=i.toString()}return u}function $79x(n,t,i){var r=String.format("INSERT OR REPLACE INTO {0} ({1}, {2}) VALUES (?, ?)","__VERSIONS","EntityName","VersionName");var u=[t,i];_e.$5C.$HC(n.$BY,"SqlSchemaUpdater.AddStoreVersionToVersionsTable",r,u,null,null)}function $79u(n,t,i,r){var f="[]";if(r){for(var e=[],o=r,s=o.length,u=0;u<s;++u){var h=o[u];Array.add(e,h.$5t)}f=JsonParser.serialize(e)}var c=String.format("INSERT OR REPLACE INTO {0} ({1}, {2}) VALUES (?,?)","__BLOBS","StoreName","Blobs");var l=[t,f];_e.$5C.$HC(n.$BY,"SqlSchemaUpdater.AddBlobPathsToBlobTable",c,l,null,null)}function $79w(n,t,i,r){var u=String.format("INSERT INTO {0} VALUES(?,?,?)","__OBJECTSTORE");var f=[t,"",""];_e.$5C.$HC(n.$BY,"SqlSchemaUpdater.AddStoreNameToObjectStoreMetadata",u,f,null,null);n.$1jK.$D(t,i,r)}function $7A4(n,t){var i=String.format("DELETE FROM {0} WHERE {1} = ?","__OBJECTSTORE","StoreName");var r=[t.$Zb];_e.$5C.$HC(n.$BY,"SqlSchemaUpdater.RemoveStoreNameFromObjectStoreMetadata",i,r,null,null);n.$1jK.$34(t)}function $4uW(n,t){var i=String.format("DROP TABLE IF EXISTS [{0}]",t);var r=new Array(0);_e.$5C.$HC(n.$BY,"SqlSchemaUpdater.RemoveUnderlyingObjectStoreTable",i,r,null,null)}function $7A2(n,t){if(n.$1jK.$3uo(t)){var i=new _e.$Be(1,String.format("The object store {0} already exists.",t));throw Error.create(i.$3j,i);}}function $4uV(n,t){var i=n.$1jK.$1wP(t);if(!i){var r=new _e.$Be(1,String.format("The object store {0} was not found.",t));throw Error.create(r.$3j,r);}return i}function $7A0(n,t,i,r){var u=_e.$8Q.$7dP(r);var f=String.format("CREATE INDEX [{0}] ON [{1}] {2}",t,i.get_$of(),u);var e=new Array(0);_e.$5C.$HC(n.$BY,"SqlSchemaUpdater.CreateSqlIndexOnColumns",f,e,null,null)}function $79v(n,t,i,r){var u=String.format("INSERT INTO {0} VALUES(?,?,?)","__OBJECTSTORE");var f=[t.$Zb,i,r.$5t.$5t];_e.$5C.$HC(n.$BY,"SqlSchemaUpdater.AddIndexInformationToMetaTable",u,f,null,null);t.$5A1(r.$5t)}function $79y(n,t,i){var r=String.format("ALTER TABLE [{0}] ADD COLUMN [{1}] {2}",t.get_$of(),i.$5t.$5t,_a.$l0.$9S(i.$Ad));var u=new Array(0);_e.$5C.$HC(n.$BY,"SqlSchemaUpdater.AlterTableToAddColumnForIndex",r,u,null,null)}_e.$8Q.prototype={$1jK:null,$BY:null,$7n7:function(n,t,i,r){$7A2(this,n);_e.$8Q.$7gG(n);$4uW(this,n);$7A1(this,n,i,r);$79x(this,n,t);$79u(this,n,t,r);$79w(this,n,t,r)},$6WB:function(n){if(this.$1jK.$3uo(n)){var t=$4uV(this,n);$4uW(this,t.$Zb);$7A4(this,t)}},$D9:function(n,t){if(this.$1jK.$3uo(n)){var i=String.format("DELETE FROM [{0}] WHERE {1} = ?",n,_e.$F9.$17T);var r=[t.$Tv()];_e.$5C.$HC(this.$BY,"SqlSchemaUpdater.RemoveItem",i,r,null,null)}},$5LN:function(n,t,i){_e.$8Q.$7gP(i);var r=$4uV(this,t);_e.$8Q.$7gK(r,n);$79z(this,n,i,r);$7A0(this,n,r,i);r.$1rN(n)},$9ku:function(){var n=String.format("DELETE FROM {0}","__OBJECTSTORE");var t=new Array(0);_e.$5C.$HC(this.$BY,"SqlSchemaUpdater.PurgeObjectStoreMetadata",n,t,null,null)},$9kw:function(){var n=String.format("DELETE FROM {0}","__VERSIONS");var t=new Array(0);_e.$5C.$HC(this.$BY,"SqlSchemaUpdater.PurgeVersionMetadata",n,t,null,null)},$9kt:function(){var n=String.format("DELETE FROM {0}","__BLOBS");var t=new Array(0);_e.$5C.$HC(this.$BY,"SqlSchemaUpdater.PurgeBlobMetadata",n,t,null,null)},$9kv:function(){var n=String.format("DELETE FROM {0}","__SETTINGS");var t=new Array(0);_e.$5C.$HC(this.$BY,"SqlSchemaUpdater.PurgeSettingsMetadata",n,t,null,null)},$49:function(){this.$BY=null}};_e.$h3=function(n,t){this.transaction=this.$Bl;this.$11S=n;this.$2Tj=t;this.$3WR=[];this.$3WS=!1};function $4uQ(n){if(!n.$3WS&&n.$3WR.length>0){n.$3WS=!0;var t=Array.dequeue(n.$3WR);var i=this;t.$A40(function(){n.$3WS=!1;$4uQ(n)})}}_e.$h3.prototype={$11S:null,$2Tj:null,$3WS:!1,$3WR:null,$Bl:function(n,t,i){_a.$3.$K(n,"transaction");var r=new _e.$5D(this.$11S,this.$2Tj,i,t);try{n(r);Array.enqueue(this.$3WR,r);$4uQ(this)}catch(u){_js.Trace.logException(_a.$0.$ZZ,u,"Exception caught in transaction callback.");if(t){var f=String.format("Exception caught in transaction callback. {0}",u.message);var e=new _a.$zV(0,f);t(e)}}}};_e.$1F0=function(n){_e.$1F0.initializeBase(this);this.insertId=n.insertId;this.rowsAffected=n.rowsAffected;this.rows=new _e.$1F1(n)};_e.$1F1=function(n){_e.$1F1.initializeBase(this);this.length=n.rows.length;this.$3Hn=n};_e.$1F1.prototype={$3Hn:null,item:function(n){for(var i={},r=this.$3Hn.rows[n],t=0;t<this.$3Hn.columnNames.length;++t){var u=this.$3Hn.columnNames[t];i[u]=r[t]}return i}};_e.$n4=function(n,t,i,r){_a.$3.$1G(n,"sql");_a.$3.$K(t,"args");_a.$3.$K(i,"successCallback");_a.$3.$K(r,"errorCallback");this.$6hn=n;this.$1rw=t;this.$6ix=i;this.$5S4=r};_e.$n4.prototype={$6hn:null,$1rw:null,$6ix:null,$5S4:null,$7Z7:function(n){var t=this,i=this;n.$7Yo(this.$6hn,this.$1rw,function(n){t.$6ix(n)},function(n){i.$5S4(n)})}};_e.$5D=function(n,t,i,r){this.$$d_$5Il=Function.createDelegate(this,this.$5Il);this.executeSql=this.$HC;this.$11S=n;this.$2Tj=t;this.$4QL=$79p(this,i);this.$4Ow=$79o(this,r);this.$7r=0;this.$18M=[];$79q(this,r)};function $79k(n){_js.Trace.logInfo(_e.$5D.$A,"Committing transaction");$3c8(n,1);n.$7r=2;var i=this,r=this;var t=new _e.$n4("COMMIT TRANSACTION",[],function(){n.$5Il()},function(t){_js.Trace.logError(_e.$5D.$A,"Commit error: {0}",t.message);$3c9(n,t)});Array.enqueue(n.$18M,t);$2FT(n)}function $3c9(n,t){$4uR(n);n.$4Ow&&n.$4Ow(t)}function $4uR(n){n.$11S=null;n.$4Ok&&n.$4Ok()}function $79s(n,t){var i=new _a.$zV(0,"Exception occurred on a transaction callback. "+t.message);$4uS(n,i)}function $4uS(n,t){_js.Trace.logInfo(_e.$5D.$A,"Rolling back transaction");$3c8(n,1);n.$7r=2;Array.clear(n.$18M);var r=this,u=this;var i=new _e.$n4("ROLLBACK TRANSACTION",[],function(){$3c9(n,t)},function(i){_js.Trace.logWarning(_e.$5D.$A,"Rollback error: {0}",i.message);$3c9(n,t)});Array.enqueue(n.$18M,i);$2FT(n)}function $79o(n,t){if(t){var i=this;return function(n){try{t(n)}catch(i){_js.Trace.logException(_e.$5D.$A,i,"Exception during transaction error callback.")}}}else return null}function $79p(n,t){if(t){var i=this;return function(){try{t()}catch(n){_js.Trace.logException(_e.$5D.$A,n,"Exception during transaction success callback.")}}}else return null}function $79n(n,t){var i=this;return function(i){n.$7r!==2&&t&&$79r(n,t,i)}}function $79m(n,t){var i=this;return function(i){n.$7r!==2&&$4uS(n,i);t&&t(n,i)}}function $79r(n,t,i){try{t(n,new _e.$1F0(i))}catch(r){_js.Trace.logException(_e.$5D.$A,r,"Exception during transaction callback.");$79s(n,r)}}function $79l(n){n.$18M.length||$79k(n)}function $79q(n,t){var r=this,u=this;var i=new _e.$n4("BEGIN IMMEDIATE TRANSACTION",[],function(){},function(n){_js.Trace.logError(_e.$5D.$A,"BEGIN error: {0}",n.message);t&&t(n)});Array.enqueue(n.$18M,i)}function $2FT(n){if(!n.$44h&&n.$18M.length>0){for(var t=n.$11S.$7kM();n.$18M.length>0&&t.get_$7vx()<4194304;){var i=Array.dequeue(n.$18M);i.$7Z7(t)}n.$44h=!0;var r=this;t.$s(function(){n.$44h=!1;n.$7r!==2&&$79l(n);$2FT(n)})}}function $3c8(n,t){if(n.$7r!==t)throw Error.invalidOperation(String.format("transaction state expected {0}.  Actual {1}.",t,n.$7r));}_e.$5D.prototype={$2Tj:null,$4QL:null,$4Ow:null,$11S:null,$4Ok:null,$7r:0,$18M:null,$44h:!1,$5Sf:!1,$46h:!1,$HC:function(n,t,i,r){this.$5Sf=!0;if(this.$7r===2)throw Error.invalidOperation("ExecuteSql cannot be invoked on a completed transaction.");var f=new _e.$n4(n,t,$79n(this,i),$79m(this,r));Array.enqueue(this.$18M,f);if(this.$7r&&!this.$46h){this.$46h=!0;var u=this;this.$2Tj.$1s(_a.$0.$2hA,"ExecuteSql",function(){u.$46h=!1;$2FT(u)},0)}},$A40:function(n){$3c8(this,0);this.$4Ok=n;if(this.$5Sf){_js.Trace.logInfo(_e.$5D.$A,"Starting transaction.");this.$7r=1;$2FT(this)}else{this.$7r=2;this.$2Tj.$1s(_a.$0.$2hA,"ExecuteSql",this.$$d_$5Il,0)}},$5Il:function(){$4uR(this);this.$4QL&&this.$4QL()}};_e.$1F5=function(n,t){this.openDatabase=this.$9eC;this.$11S=n;this.$6q9=t};_e.$1F5.prototype={$11S:null,$6q9:null,$9eC:function(n,t,i,r,u){return new _e.$h3(this.$11S,this.$6q9)}};_e.$AJ=function(n,t,i){_e.$AJ.initializeBase(this,[n,t,i,i.Body.ConversationActions.length])};function $774(n,t,i,r){var u=_e.$EM.$14T(t,n.$RB.ConversationId);var f=this,e=this;n.$Bl(function(t){n.$BY=t;n.get_$AU().get_$Jl().$Fu(n.$BY,u,function(t){$4tU(n,t,u)},null)},function(){i()},_e.$1g.$aG(r))}function $775(n,t,i){n.$5iu=!0;var r=this,u=this;n.$Bl(function(t){n.$BY=t;_e.$6s.$3xN(t,n.get_$AU().get_$Jl(),n.$RB.ConversationId,function(t){for(var r=t,f=r.length,i=0;i<f;++i){var u=r[i];var e=_e.$EM.$14T(u.get_$1r().FolderId,n.$RB.ConversationId);$4tU(n,u,e)}})},function(){t()},_e.$1g.$aG(i))}function $4tU(n,t,i){if(t){var r=t.get_$1r();var u=r.FolderId;var f=this;n.get_$AU().get_$2r().$Fu(n.$BY,_e.$1l.$5h(u.Id),function(u){$777(n,u,r);$776(n,i,t,r);$779(n,r)},null)}}function $777(n,t,i){if(t){var f=t.get_$1r();var r=f;switch(n.$RB.Action){case"Delete":case"AlwaysDelete":case"Move":i.UnreadCount>0&&(r.UnreadCount-=i.UnreadCount);r.TotalCount-=i.MessageCount;break;case"SetReadState":if(n.$RB.IsRead)i.UnreadCount>0&&(r.UnreadCount-=i.UnreadCount);else{var u=i.MessageCount;i.UnreadCount>0&&(u=i.MessageCount-i.UnreadCount);r.UnreadCount+=u}break;default:_js.Trace.logInfo(_e.$AJ.$A,"{0} not implemented in client store.",n.$RB.Action);break}t.$E1(n.$BY,null)}}function $776(n,t,i,r){switch(n.$RB.Action){case"Delete":case"AlwaysDelete":case"Move":n.get_$AU().get_$Jl().$II(n.$BY,t);break;case"SetReadState":r.UnreadCount=n.$RB.IsRead?0:r.MessageCount;n.$5iu&&(r.GlobalUnreadCount=n.$RB.IsRead?0:r.GlobalMessageCount);n.get_$AU().get_$Jl().$uj(n.$BY,i,0,null);break;case"Flag":r.FlagStatus=n.$RB.Flag.FlagStatus;n.get_$AU().get_$Jl().$uj(n.$BY,i,0,null);break;case"SetClutterState":r.HasClutter=n.$RB.IsClutter;n.get_$AU().get_$Jl().$uj(n.$BY,i,0,null);break;default:_js.Trace.logInfo(_e.$AJ.$A,"UpdateConversation: {0} not implemented in client store.",n.$RB.Action);break}}function $779(n,t){var i=t.ItemIds;if(i)for(var u=i.length,r=0;r<u;r++){var f=i[r];$778(n,f)}}function $778(n,t){if(t&&t.Id){var i=_e.$1l.$5h(t.Id);switch(n.$RB.Action){case"Delete":case"AlwaysDelete":case"Move":n.get_$AU().get_$4y().$II(n.$BY,i);break;case"SetReadState":var r=this;$3br(n,i,function(t,i){i.get_$1r().IsRead=n.$RB.IsRead});break;case"Flag":var u=this;$3br(n,i,function(t,i){i.get_$1r().Flag=n.$RB.Flag});break;case"SetClutterState":var f=this;$3br(n,i,function(t,i){i.get_$1r().IsClutter=n.$RB.IsClutter});break;default:_js.Trace.logInfo(_e.$AJ.$A,"UpdateMessages: {0} not implemented in client store.",n.$RB.Action);break}}}function $3br(n,t,i){var r=this;n.get_$AU().get_$4y().$Fu(n.$BY,t,function(t){if(t){i(n.$RB,t);t.$E1(n.$BY,null)}},null)}_e.$AJ.prototype={$BY:null,$RB:null,$5iu:!1,get_$Ri:function(){return"ApplyConversationAction"},$7g4:function(n,t,i){this.$s(n,t,i)},$7wZ:function(n,t,i,r){this.$RB=this.get_$3Or().Body.ConversationActions[n];if(this.get_$AHO()&&this.get_$AHO().isActionGlobal)$775(this,t,i);else{var u=null;if(this.$RB.ContextFolderId)u=this.$RB.ContextFolderId.BaseFolderId;else if(this.get_$AHO()&&this.get_$AHO().folderIdForInstanceKeysToRemoveFromPendingOperations)u=new _g.$3R(this.get_$AHO().folderIdForInstanceKeysToRemoveFromPendingOperations);else{_js.Trace.logInfo(_a.$0.$M6,"This action {0}:{1} does not contain a valid folder id. Completing the service command without performing any real action.",this.get_$Ri(),this.$RB.Action);t();return}$774(this,u,t,i)}}};_e.$af=function(n,t,i){_e.$af.$$(this.$$gta["_e.$af"].TRequest,this.$$gta["_e.$af"].TActionContext).initializeBase(this,[n,t]);_a.$3.$m(i,"request");_a.$3.$m(i.Header,"request.Header");_a.$3.$m(i.Header.TimeZoneContext,"request.Header.TimeZoneContext");_a.$3.$m(i.Header.TimeZoneContext.TimeZoneDefinition,"request.Header.TimeZoneContext.TimeZoneDefinition");this.$BA=i};_e.$af.$$=function(n,t){var i="$af"+"$2"+"$"+n.getName().replace(/\./g,"_")+"$"+t.getName().replace(/\./g,"_");if(!_e[i]){var u=_e[i]=function(){(this.$$gta=this.$$gta||{})["_e.$af"]={TRequest:n,TActionContext:t};for(var r=[],i=0;i<arguments.length;++i)r[i]=arguments[i];_e.$af.apply(this,r)};u.registerClass("_e."+i,_e.$69.$$(t));var f=_e.$af.prototype;for(var e in f){var r={key:e,value:f[e]};"constructor"!==r.key&&(u.prototype[r.key]=r.value)}}return _e[i]};_e.$af.prototype={$BA:null,get_timeZone:function(){return this.$BA.Header.TimeZoneContext.TimeZoneDefinition.Id},get_$3Or:function(){return this.$BA}};_e.$oR=function(n,t,i,r,u){_e.$oR.$$(this.$$gta["_e.$oR"].TRequest,this.$$gta["_e.$oR"].TActionContext).initializeBase(this,[n,t,i,r]);this.$1z=u};_e.$oR.$$=function(n,t){var i="$oR"+"$2"+"$"+n.getName().replace(/\./g,"_")+"$"+t.getName().replace(/\./g,"_");if(!_e[i]){var u=_e[i]=function(){(this.$$gta=this.$$gta||{})["_e.$oR"]={TRequest:n,TActionContext:t};for(var r=[],i=0;i<arguments.length;++i)r[i]=arguments[i];_e.$oR.apply(this,r)};u.registerClass("_e."+i,_e.$fB.$$(n,t));var f=_e.$oR.prototype;for(var e in f){var r={key:e,value:f[e]};"constructor"!==r.key&&(u.prototype[r.key]=r.value)}}return _e[i]};_e.$oR.prototype={$2zT_3:!1,$4Ql:null,$1z:null,get_$ok:function(){this.$4Ql||(this.$4Ql=this.$87r());return this.$4Ql},$AJM:function(n,t,i,r,u){var e=null;_js.Trace.logInfo(this.$1z,"Opening transaction to move message to Outbox. {0}",this.$6l9);var f=this,s=this,o=this;this.$Bl(function(i){if(n){_js.Trace.logInfo(f.$1z,"Getting message to move to Outbox. {0}",f.$6l9);f.get_$AU().get_$4y().$Fu(i,_e.$1l.$5h(n.Id),function(n){_js.Trace.logInfo(f.$1z,"Calling getMessageToSaveCallback. {0}",f.$6l9);e=t(n,i);_js.Trace.logInfo(f.$1z,"Checking for existing Outbox item before save. {0}",f.$6l9);f.$9rt(e,n,i);_js.Trace.logInfo(f.$1z,"Deleting message from Drafts. {0}",f.$6l9);f.$7qn(n,i);f.$5OW(e,i)},null)}else{_js.Trace.logInfo(f.$1z,"Calling getMessageToSaveCallback. {0}",f.$6l9);e=t(null,i);_js.Trace.logInfo(f.$1z,"Saving message to Outbox. {0}",f.$6l9);f.$6ZL(e,null,!0,i);f.$5OW(e,i)}},function(){_js.Trace.logInfo(s.$1z,"Successfully moved message to Outbox. {0}",s.$6l9);s.$6Xr(e);r()},function(n){_js.Trace.logInfo(o.$1z,"Reporting store error. {0}",o.$6l9);o.$6Xr(e);o.$AHQ(i,new _e.$1g(n),u)})},$AJN:function(n,t,i,r,u){_js.Trace.logInfo(this.$1z,"Opening transaction to move Outbox item to Drafts. {0}",this.$6l9);var o=this,f=this,e=this;this.$Bl(function(i){o.$8Hs(i,n,t)},function(){if(f.$2zT_3){_js.Trace.logInfo(f.$1z,"Generating notifications to refresh inbox count. {0}",f.$6l9);_e.$2r.$2zS(f.get_$ok().$1dg.Id,null,"Reload","serviceCommand",_e.$2r.$yI,_e.$2r.$yI,!0)}_js.Trace.logInfo(f.$1z,"Successfully moved message from outbox to drafts. {0}",f.$6l9);r()},function(n){_js.Trace.logInfo(e.$1z,"Reporting store error {0}. {1}",n.$3j,e.$6l9);e.$AHQ(i,new _e.$1g(n),u)})},$AJO:function(n){var u=10;var e="; ";var f;var t="";f=n?n.length<=u?n.length:u:0;for(var i=0;i<=f-1;i++){var r=n[i].Name;if(r&&r.length>0){var o=t.length?e:"";t+=o+r}}return t},$8Hs:function(n,t,i){_js.Trace.logInfo(this.$1z,"Getting OutboxItem for move back to Drafts. {0}",this.$6l9);var r=this;this.get_$AU().get_$h5().$Fu(n,_e.$1l.$5h(this.get_$ok().$PN.Id),function(u){var e=null;var o=null;var s=null;if(u){e=u.get_$1r().NormalizedBody;o=u.get_$1r().UniqueBody;s=u.get_$1r().Preview;_js.Trace.logInfo(r.$1z,"Deleting OutboxItem. {0}",r.$6l9);r.get_$4y().$1ux(n,null,"HardDelete",u,null,r.get_$4Am(),!0)}else _js.Trace.logWarning(_e.$1n.$A,"Outbox item with id {0} was not found in the client store. {1}",r.get_$ok().$PN.Id,r.$6l9);_js.Trace.logInfo(r.$1z,"Calling getMessageToSaveCallback. {0}",r.$6l9);var f=t(n);f.get_$1r().NormalizedBody=e;f.get_$1r().UniqueBody=o;f.get_$1r().Preview=s;if(i){_js.Trace.logInfo(r.$1z,"Saving item to drafts. {0}",r.$6l9);r.$3Q2(f,!0,n)}else{_js.Trace.logInfo(r.$1z,"Checking for existing draft before save. {0}",r.$6l9);r.$9ru(f,n)}},null)},$6ZN:function(n,t,i){this.$9xE(n,t);n.$E1(i,null)},$9xE:function(n,t){n.$8G4(this.$87n(),t,this.$879(),"NoError");var i=n.get_$1r();i.IsRead=!0},$6Xr:function(n){if(n){n.$9nJ();_a.$1X.$AIG(_g.$9r,n.get_$1r()).IsRead=undefined}},$9rt:function(n,t,i){var r=this;this.get_$AU().get_$h5().$Fu(i,_e.$1l.$5h(n.get_$1r().ItemId.Id),function(u){var f=!1;u?_js.Trace.logWarning(r.$1z,"Message from Drafts is already in the Outbox. Folder count won't be incremented since message will be replaced. {0}",r.$6l9):f=!0;r.$6ZL(n,t,f,i)},null)},$6ZL:function(n,t,i,r){_js.Trace.logInfo(this.$1z,"Moving to outbox: Id="+(n.get_$1y()?n.get_$1y().toString():"null")+"; ItemId="+(n.get_$1r()?JsonParser.serialize(n.get_$1r().ItemId):"null")+"; Subject="+(n.get_$1r()?n.get_$1r().Subject:"null"));if(t&&t.get_$1r().ConversationId){var f=t.get_$1r();_js.Trace.logInfo(this.$1z,"Removing item part from conversation for conversation id={0}. {1}",f.ConversationId.Id,this.$6l9);var u=this;this.get_$Jl().$4W6(r,f.ConversationId,f.ParentFolderId,f,this.get_$4Am(),function(t){_js.Trace.logInfo(u.$1z,"Removed item part from conversation. ParentConversationNodeId={0}. {1}",t||"null",u.$6l9);_js.Trace.logInfo(u.$1z,"Saving item to Outbox. {0}",u.$6l9);u.$6ZN(n,t,r)})}else{_js.Trace.logInfo(this.$1z,"Saving item to Outbox. {0}",this.$6l9);this.$6ZN(n,null,r)}if(i){_js.Trace.logInfo(this.$1z,"Incrementing Outbox folder count. {0}",this.$6l9);this.get_$AU().get_$2r().$2QN(r,n.get_$1r().ParentFolderId,1,0)}},$7qn:function(n,t){if(n){_js.Trace.logInfo(this.$1z,"Draft message found - deleting from Drafts. {0}",this.$6l9);this.get_$4y().$1ux(t,this.get_$Jl(),"HardDelete",n,null,this.get_$4Am(),!0)}else _js.Trace.logInfo(this.$1z,"Draft message not found. {0}",this.$6l9)},$5OW:function(n,t){if(n&&n.get_$1r()&&_e.$19.$5h3(n.get_$1r().__type)){var i=n.get_$1r();if(i.ReferenceItemId&&i.ReferenceItemId.__type===_g.$1t._dataContractName){_js.Trace.logInfo(this.$1z,"Deleting approval request message with id {0}. {1}",i.ReferenceItemId.Id,this.$6l9);this.get_$4y().$3rf(t,this.get_$Jl(),"HardDelete",i.ReferenceItemId,null,this.get_$4Am())}}},$9ru:function(n,t){var i=this;this.get_$AU().get_$4y().$Fu(t,_e.$1l.$5h(n.get_$1r().ItemId.Id),function(r){if(r)if(r.get_$1r().ConversationId){_js.Trace.logInfo(i.$1z,"Draft message with id {0} was found in the client store. Removing from conversation {1}",n.get_$1r().ItemId.Id,i.$6l9);var u=r.get_$1r();i.get_$Jl().$4W6(t,u.ConversationId,u.ParentFolderId,u,i.get_$4Am(),function(r){_js.Trace.logInfo(i.$1z,"RemoveItemPartFromConversation success callback. {0}",i.$6l9);i.$3Q2(n,!1,t)})}else{_js.Trace.logInfo(i.$1z,"Draft message with id {0} was found in the client store. It does not have a ConversationId. {1}",n.get_$1r().ItemId.Id,i.$6l9);i.$3Q2(n,!1,t)}else{_js.Trace.logInfo(i.$1z,"Draft message with id {0} was not found in the client store. {1}",n.get_$1r().ItemId.Id,i.$6l9);i.$3Q2(n,!0,t)}},null)},$3Q2:function(n,t,i){_js.Trace.logInfo(this.$1z,"Saving to Drafts via update: Id={0}; ItemId={1}; Subject={2}. {3}",n.get_$1y()?n.get_$1y().toString():"null",n.get_$1r()?JsonParser.serialize(n.get_$1r().ItemId):"null",n.get_$1r()?n.get_$1r().Subject:"null",this.$6l9);n.$E1(i,null);if(t){_js.Trace.logInfo(this.$1z,"Increment drafts folder count after message is moved to drafts. {0}",this.$6l9);this.get_$AU().get_$2r().$2QN(i,n.get_$1r().ParentFolderId,1,0)}if(!!(!!this.get_$ok().$Cv&!!this.get_$ok().$Wk)){_js.Trace.logInfo(this.$1z,"Adding item to conversation. {0}",this.$6l9);this.$7YE(i,n.get_$1r())}},$7YE:function(n,t){if(!this.get_$ok().$Wk){_js.Trace.logInfo(this.$1z,"Skipping AddItemToConversation: ParentConversationNodeId is null");return}var i=this;this.get_$Jl().$5A4(n,this.get_$ok().$Cv,t,this.get_$ok().$Wk,this.get_$ok().$38D,this.get_$4Am(),function(n){if(n){_js.Trace.logInfo(i.$1z,"Item was added to the conversation. ItemId '{0}' ConversationId '{1}' ParentConversationNodeId '{2}'",t.ItemId.Id,i.get_$ok().$Cv.Id,i.get_$ok().$Wk);i.$2zT_3=!0}else _js.Trace.logInfo(i.$1z,"Conversation not found. ItemId '{0}' ConversationId '{1}' ParentConversationNodeId '{2}'",t.ItemId.Id,i.get_$ok().$Cv.Id,i.get_$ok().$Wk)})}};_e.$PO=function(n,t,i){_e.$PO.initializeBase(this,[n,t,i,i.Body.Attachments.length]);this.get_$AHO().parentItemId=this.get_$3Or().Body.ParentItemId;this.get_$AHO().attachmentIds=new Array(this.get_$AIw());this.$Dz=new _g.$aX;this.$Dz.ResponseCode="NoError";this.$Dz.ResponseClass="Success";this.$Dz.Attachments=new Array(this.get_$AIw());this.$33=new _g.$Ta;this.$33.Header=_e.$8e.$Wx;this.$33.Body.ResponseMessages=new _g.$Fy;this.$33.Body.ResponseMessages.Items=[this.$Dz]};_e.$PO.$4iJ=function(n,t){var i=n;$5(i.Attachments)&&(i.Attachments=[]);i.HasAttachments=!0;Array.add(i.Attachments,t)};_e.$PO.prototype={$33:null,$Dz:null,get_$Ri:function(){return"CreateAttachment"},$7g4:function(n,t,i){this.$s(n,t,i)},$7wZ:function(n,t,i,r){if(this.get_$AHO().clientStoreItem===2){var u=this.get_$3Or().Body.Attachments[n];var f=this.get_$3Or().Body.ParentItemId;var s=new _bc.$Bi;var e=s.get_$3l();this.get_$AHO().attachmentIds[n]=e;u.AttachmentId=new _g.$Ag(e.Id);this.$Dz.Attachments[n]=u;var o=this,h=this,c=this;this.$Bl(function(n){o.get_$AU().get_$4y().$4iJ(n,o.get_$AU().get_$5c().$jM(f.Id),u)},function(){_js.Trace.logInfo(_e.$PO.$A,"Successfully updated message with server id {0} in local store.",f.Id);u.AttachmentId.RootItemId=f.Id;u.AttachmentId.RootItemChangeKey=f.ChangeKey;t()},function(n){_e.$1g.$DN(n,i)})}else{_js.Trace.logWarning(_e.$PO.$A,"ClientStoreItem type {0} is not supported.",this.get_$AHO().clientStoreItem);t();return}}};_e.$19=function(n,t,i){this.$2dv=null;this.$GK=0;_e.$19.initializeBase(this,[n,t,i,i.Body.Items.length,_e.$19.$A]);this.get_$AHO().itemIds=new Array(i.Body.Items.length);this.get_$AHO().uIds=new Array(i.Body.Items.length);this.get_$AHO().createdCalendarItemIds=new Array(i.Body.Items.length);this.$9d=new Array(this.get_$AIw());this.$33=new _g.$Tc;this.$33.Header=_e.$8e.$Wx;this.$33.Body.ResponseMessages=new _g.$Fy;this.$33.Body.ResponseMessages.Items=this.$9d};_e.$19.$4aL=function(n,t,i){var r=null;$5(i)?t&&t.BodyType==="Text"&&!$5(t.Value)&&(r=t.Value):r=i;if(!$5(r)){var f=_a.$1d.$1Bw(r,!0);var u=new _g.$6b("HTML",f);n.NormalizedBody=u;n.UniqueBody=u;n.Preview=r}};_e.$19.$21P=function(n){return n===_g.$In._dataContractName||n===_g.$Ha._dataContractName||n===_g.$Gd._dataContractName||n===_g.$Hy._dataContractName};_e.$19.$5h3=function(n){return n===_g.$Ls._dataContractName||n===_g.$QP._dataContractName};_e.$19.$8MA=function(n){return n===_g.$NJ._dataContractName||n===_g.$Ne._dataContractName||n===_g.$Ou._dataContractName};_e.$19.$1cx=function(n,t,i,r){t.val=n.__type===_g.$NJ._dataContractName;i.val=n.__type===_g.$Ou._dataContractName;r.val=n.__type===_g.$Ne._dataContractName};function $78A(n,t,i,r,u){_js.Trace.logInfo(_e.$19.$A,"ExecuteMessageItemStep");if(n.get_$AHO()&&n.get_$AHO().explicitLogonUser){_js.Trace.logInfo(_e.$19.$A,"MessageRequest - operations on this mailbox is not supported in offline: {0}",n.get_$AHO().explicitLogonUser);n.$88=!0;n.$GK=17;r();return}_a.$3.$K(n.get_$AHO().parentFolderId,"ParentFolderId");$78H(n,t);n.$AIx(t.ItemId);n.get_$3Or().Body.MessageDisposition==="SaveOnly"&&(n.$9d[i].Items[0].ItemId=t.ItemId);var e=!1;var f=null;if(_e.$19.$21P(t.__type)){e=!0;f=t}if(n.get_$3Or().Body.MessageDisposition==="SendAndSaveCopy"){var o=null;var s=null;if(e){var h=this;o=function(t,r){n.get_$AHO().itemIds[i]=f.ItemId;t&&(f.ConversationId=t.get_$1r().ConversationId);return n.get_$AU().get_$h5().$rP(f)};s=f.UpdateResponseItemId}else{var c=this;o=function(r,u){var f=n.get_$AU().get_$h5().$rP(t);n.get_$AHO().itemIds[i]=t.ItemId;return f}}_js.Trace.logInfo(_e.$19.$A,"Moving item to Outbox. {0}",n.$6l9);var l=this,a=this;n.$AJM(s,o,n.$9d[i],function(){$1L1(n,t);r()},function(i){$1L1(n,t);u(i)})}else if(n.get_$AHO().outboxItemId){_js.Trace.logInfo(_e.$19.$A,"Moving a message from Outbox back to Drafts. {0}",n.$6l9);var v=this,y=this,p=this;n.$AJN(function(r){var u=n.get_$AU().get_$4y().$rP(t);n.get_$AHO().itemIds[i]=t.ItemId;return u},!e,n.$9d[i],function(){$1L1(n,t);r()},function(i){$1L1(n,t);u(i)})}else if(e){_js.Trace.logInfo(_e.$19.$A,"Creating a SmartResponse for ReferenceItemId={0}. {1}",JsonParser.serialize(f.ReferenceItemId),n.$6l9);if(f.UpdateResponseItemId)if(n.get_$3Or().Body.MessageDisposition==="SaveOnly"){_js.Trace.logInfo(_e.$19.$A,"Updating an existing SmartResponse. {0}",n.$6l9);$78I(n,f,i,r,u)}else throw Error.invalidOperation("Unknown SmartResponse operation.");else{_js.Trace.logInfo(_e.$19.$A,"Creating a SmartResponse in Drafts. {0}",n.$6l9);$4tr(n,t,i,r,u)}}else{_js.Trace.logInfo(_e.$19.$A,"Creating a message in the Drafts or Outbox. {0}",n.$6l9);$4tr(n,t,i,r,u)}}function $4tq(n,t,i){if(!$5(n.get_$AHO().clientStoreBodyValue)){n.$3PJ=t.val.Value;n.$2dv=t.val.BodyType;t.val=new _g.$6b(i,n.get_$AHO().clientStoreBodyValue);n.get_$AHO().clientStoreBodyValue=null}}function $78I(n,t,i,r,u){n.get_$AHO().itemIds[i]=t.UpdateResponseItemId;_js.Trace.logInfo(_e.$19.$A,"Opening transaction to update a SmartResponse. {0}",n.$6l9);var f=this,e=this,o=this;n.$AHR(new _a.$6i("CreateItem.UpdateSmartResponse",!1),function(i){_js.Trace.logInfo(_e.$19.$A,"Updating SmartResponse. {0}",n.$6l9);n.get_$AU().get_$4y().$1KP(i,_e.$1l.$5h(t.ItemId.Id),function(i){if($5(i)){_js.Trace.logWarning(_e.$19.$A,"Message with id {0} not found in local store",t.ItemId.Id);return}_js.Trace.logInfo(_e.$19.$A,"Retrieved SmartResponse from the local store for update. {0}",n.$6l9);var r=i;r.__type=t.__type;r.ReferenceItemId=t.ReferenceItemId;r.NewBodyContent=t.NewBodyContent;r.BccRecipients=t.BccRecipients;r.CcRecipients=t.CcRecipients;r.ToRecipients=t.ToRecipients;r.From=t.From;r.Subject=t.Subject;r.Importance=t.Importance;r.NormalizedBody=t.NormalizedBody;r.UniqueBody=r.NormalizedBody;r.Preview=t.Preview;r.RightsManagementLicenseData=t.RightsManagementLicenseData;if(t.ExtendedProperty)for(var e=0;e<t.ExtendedProperty.length;e++){var f=t.ExtendedProperty[e];var u=f.ExtendedFieldURI;u.DistinguishedPropertySetId==="Common"?u.PropertyId===34229?_e.$3y.$SD(r,u,f.Value):u.PropertyId===34232?_e.$3y.$SD(r,u,f.Value):u.PropertyId===34230?_e.$3y.$SD(r,u,f.Value):u.PropertyId===34231&&_e.$3y.$SD(r,u,f.Value):u.DistinguishedPropertySetId==="PublicStrings"&&u.PropertyName.startsWith("cecp-")&&_e.$3y.$SD(r,u,f.Value)}_js.Trace.logInfo(_e.$19.$A,"Smart response with updates going to client store via create: ReferenceItemId={0}; Subject={1}. {2}",JsonParser.serialize(r.ReferenceItemId),r.Subject,n.$6l9)})},function(){_js.Trace.logInfo(_e.$19.$A,"Successfully updated message in local store. {0}",n.$6l9);$1L1(n,t);r()},function(i){_js.Trace.logInfo(_e.$19.$A,"Reporting store error. {0}",n.$6l9);$1L1(n,t);_e.$1g.$DN(i,u)})}function $4tr(n,t,i,r,u){var f=n.get_$AU().get_$4y().$rP(t);n.get_$AHO().itemIds[i]=t.ItemId;var e=null;_js.Trace.logInfo(_e.$19.$A,"Opening transaction to save message item via create. Id={0}; Subject={1}; {2}",f.get_$1y()?f.get_$1y().toString():"null",t.Subject,n.$6l9);var o=this,s=this,h=this;n.$Bl(function(i){_js.Trace.logInfo(_e.$19.$A,"Saving item. {0}",n.$6l9);f.$E1(i,function(n){e=n});_js.Trace.logInfo(_e.$19.$A,"Incrementing folder count. {0}",n.$6l9);n.get_$AU().get_$2r().$2QN(i,t.ParentFolderId,1,0);if(_e.$19.$21P(t.__type)&&n.get_$3Or().Body.MessageDisposition==="SaveOnly"){_js.Trace.logInfo(_e.$19.$A,"Adding item (SmartResponse) to conversation. {0}",n.$6l9);$787(n,i,t)}},function(){_js.Trace.logInfo(_e.$19.$A,"Successfully created message in local store id={0}. {1}",e,n.$6l9);$1L1(n,t);if(n.$2zT){_js.Trace.logInfo(_e.$19.$A,"Generating notifications to refresh inbox count. {0}",n.$6l9);_e.$2r.$2zS(n.get_$AHO().inboxFolderId.Id,null,"Reload","serviceCommand",_e.$2r.$yI,_e.$2r.$yI,!0)}_js.Trace.logInfo(_e.$19.$A,"Calling succeededCallback. {0}",n.$6l9);r()},function(r){_js.Trace.logInfo(_e.$19.$A,"Reporting store error {0}. {1}",r.$3j,n.$6l9);$1L1(n,t);n.$AHQ(n.$9d[i],new _e.$1g(r),u)})}function $787(n,t,i){if(!n.get_$AHO().parentConversationNodeId){_js.Trace.logInfo(_e.$19.$A,"Skipping AddItemToConversation: ParentConversationNodeId is null");return}var r=this;n.get_$Jl().$5A4(t,n.get_$AHO().conversationId,i,n.get_$AHO().parentConversationNodeId,n.get_$AHO().itemPartsOrderDescending,n.get_$4Am(),function(t){if(t){_js.Trace.logInfo(_e.$19.$A,"Item was added to the conversation. ItemId '{0}' ConversationId '{1}' ParentConversationNodeId '{2}'",i.ItemId.Id,n.get_$AHO().conversationId.Id,n.get_$AHO().parentConversationNodeId);n.$2zT=!0}else _js.Trace.logInfo(_e.$19.$A,"Conversation not found. ItemId '{0}' ConversationId '{1}' ParentConversationNodeId '{2}'",i.ItemId.Id,n.get_$AHO().conversationId.Id,n.get_$AHO().parentConversationNodeId)})}function $788(n,t,i,r,u){var f=t;if($78E(n,f)){n.$88=!0;n.$GK=1;r()}else if(f.Recurrence){n.$88=!0;n.$GK=2;r()}else if($78D(n,f)){n.$88=!0;n.$GK=10;r()}else{var e=this,o=this;n.get_$AHN().$8LT(f.Start,f.End,function(){var t=_0365f.$2d.$3g(f,!0,!0);t.ParentFolderId||(t.ParentFolderId=n.get_$AHO().calendarFolderId);$78G(n,t,i,r,u)},function(){n.$88=!0;n.$GK=11;r()})}}function $78D(n,t){return!!t.ParentFolderId&&t.ParentFolderId.Id!==n.get_$AHO().calendarFolderId.Id||!!n.get_$3Or().Body.SavedItemFolderId&&n.get_$3Or().Body.SavedItemFolderId.BaseFolderId.__type===_g.$3R._dataContractName&&n.get_$3Or().Body.SavedItemFolderId.BaseFolderId.Id!==n.get_$AHO().calendarFolderId.Id}function $78H(n,t){var r=_e.$19.$21P(t.__type);var i=r?t:null;var u=new _bc.$Bi;t.InstanceKey=u.get_$Ey();t.ItemId=r&&i.UpdateResponseItemId?i.UpdateResponseItemId:u.$5S;n.get_$3Or().Body.MessageDisposition==="SendAndSaveCopy"&&(t.ItemId=_bc.OutboxItemContext.$5K7(t.ItemId,_e.$19.$A));t.DateTimeCreated=_a.$7.$Ex(_a.$7.get_$2F());t.DateTimeReceived=t.DateTimeCreated;t.LastModifiedTime=_a.$7.$Ex(_a.$7.get_$2F());t.ParentFolderId=n.get_$AHO().parentFolderId;var o=r?i.NewBodyContent:null;var s=n.get_$AHO().bodySubstring||"";_e.$19.$4aL(t,o,s);if(r){var f;$4tq(n,f={val:i.NewBodyContent},i.NewBodyContent.BodyType);i.NewBodyContent=f.val}else{var e;$4tq(n,e={val:t.Body},"Text");t.Body=e.val}n.get_$3Or().Body.MessageDisposition==="SaveOnly"&&(t.IsDraft=!0);t.RightsManagementLicenseData=n.get_$AHO().rightsManagementLicenseData;n.get_$AHO().conversationId&&(t.ConversationId=n.get_$AHO().conversationId);_e.$19.$5h3(t.__type)&&(t.ItemClass=t.__type===_g.$Ls._dataContractName?"IPM.Note.Microsoft.Approval.Reply.Approve":"IPM.Note.Microsoft.Approval.Reply.Reject");t.DisplayTo=n.$AJO(t.ToRecipients)}function $1L1(n,t){t.ItemId=undefined;t.InstanceKey=undefined;t.DateTimeCreated=undefined;t.DateTimeReceived=undefined;t.LastModifiedTime=undefined;t.ParentFolderId=undefined;t.NormalizedBody=undefined;t.UniqueBody=undefined;t.Preview=undefined;t.IsDraft=undefined;t.ConversationId=undefined;t.InternetMessageId=undefined;t.ItemClass=undefined;t.DisplayTo=undefined;n.$3PJ&&(_e.$19.$21P(t.__type)?t.NewBodyContent.Value=n.$3PJ:t.Body.Value=n.$3PJ);n.$2dv!==null&&(_e.$19.$21P(t.__type)?t.NewBodyContent.BodyType=n.$2dv:t.Body.BodyType=n.$2dv);t.RightsManagementLicenseData=undefined}function $78G(n,t,i,r,u){var e=new _bc.$Bi;var f=e.$5S;$4tm(n,t);t.ItemId=f;t.UID=e.get_$19u();t.IsMeeting=!1;t.HasAttachments=!1;t.ResponseType="Organizer";t.IsOrganizer=!0;t.ResponseObjects=new Array(1);t.ResponseObjects[0]=new _g.$Ha;t.Organizer=new _g.$Bc;t.Organizer.Mailbox=new _g.$1q;t.Organizer.Mailbox.EmailAddress=n.get_$AHO().userEmailAddress;t.Organizer.Mailbox.Name=n.get_$AHO().userDisplayName;t.Organizer.Mailbox.RoutingType="SMTP";t.Organizer.Mailbox.MailboxType="Mailbox";t.StartWallClock=t.Start;t.StartTimeZoneId=n.get_$3Or().Header.TimeZoneContext.TimeZoneDefinition.Id;t.EndWallClock=t.End;t.EndTimeZoneId=n.get_$3Or().Header.TimeZoneContext.TimeZoneDefinition.Id;_e.$AL.$4Tg(t);var o=n.get_$AU().get_$1c().$rP(t);var s=this,h=this,c=this;n.$Bl(function(i){o.$E1(i,function(r){_js.Trace.logInfo(_e.$19.$A,"Successfully created calendar item with id {0} to local store.",r.toString());if(t.ReminderIsSet){_js.Trace.logInfo(_e.$19.$A,"A reminder is set on calendar item with Id {0}. Creating a reminder.",f.Id);n.get_$AHN().$4YB(i,t,f,function(n){_js.Trace.logInfo(_e.$19.$A,"Successfully created reminder for calendar item with id {0} to local store.",r.toString())})}})},function(){_js.Trace.logInfo(_e.$19.$A,"Successfully created calendar item and reminder with id {0} to local store.",f);n.$9d[i].Items[0].ItemId=f;n.get_$AHO().itemIds[i]=f;n.get_$AHO().uIds[i]=e.get_$19u();r()},function(t){n.$AHQ(n.$9d[i],new _e.$1g(t),u)})}function $78E(n,t){return!$5(t.RequiredAttendees)&&t.RequiredAttendees.length>0||!$5(t.OptionalAttendees)&&t.OptionalAttendees.length>0}function $789(n,t,i,r,u){if(!_e.$19.$8MA(t.__type)){_js.Trace.logWarning(_e.$19.$A,"MeetingRequest - Response type not support in offline: {0}",t.__type);n.$88=!0;n.$GK=15;r();return}var f=t;var h,c,l;var a,v,y;_e.$19.$1cx(f,a={val:h},v={val:c},y={val:l});h=a.val;c=v.val;l=y.val;if(f.ReferenceItemId.__type!==_g.$1t._dataContractName&&f.ReferenceItemId.__type!==_g.$7b._dataContractName){n.$88=!0;n.$GK=14;r();return}var e=f.ReferenceItemId;var s=_a.$7.$Ex(_a.$7.get_$2F());if(n.get_$AHO().isReferencedItemMeetingRequest){n.$9d[i].Items=new Array(3);var o=_e.$1l.$5h(e.Id);var p=this,w=this,b=this;n.$Bl(function(t){n.get_$AU().get_$4y().$Fu(t,o,function(r){if($5(r)||$5(r.get_$1r())){_js.Trace.logWarning(_e.$19.$A,"MeetingRequest - Message with id {0} not found in local store",o);n.$88=!0;return}var u=r.get_$1r();if(u.IsDelegated){_js.Trace.logInfo(_e.$19.$A,"MeetingRequest - Message with id {0} is delegated and will not be processed by offline service command",o);n.$88=!0;n.$GK=3;return}if(u.IsOutOfDate){_js.Trace.logError(_e.$19.$A,"MeetingRequest - Message with id {0} is out of date and should not be used to respond to a meeting request",o);return}u.ResponseType=$4to(n,f);u.FreeBusyType=$4tn(n,f,u.IntendedFreeBusyStatus);u.AppointmentReplyTime=s;var e=new _g.$LI;e.ItemId=u.ItemId;n.$9d[i].Items[2]=e;n.get_$4y().$1ux(t,n.get_$Jl(),"MoveToDeletedItems",r,n.get_$AHO().deletedItemsFolderId,n.get_$4Am());$78F(n,t,i,r,f,s)},null)},function(){_js.Trace.logInfo(_e.$19.$A,"Successfully responded to message with id {0}.",o);r()},function(t){if(n.$88&&t.$Vs===5)u(new _e.$1g(t));else{_js.Trace.logError(_e.$19.$A,"MeetingRequest - Error while processing message with id:{0}. Error: {1}",o,t.$3j);n.$AHQ(n.$9d[i],new _e.$1g(t),u)}})}else{n.$9d[i].Items=new Array(2);var k=this,d=this,g=this;n.$Bl(function(t){e.__type===_g.$7b._dataContractName?n.get_$AHN().$5YN(t,e,function(r){_e.$Dt.$3k3(t,n.get_$AU().get_$mQ(),r,function(u){if(!u||!u.get_$1r()){_js.Trace.logWarning(_e.$19.$A,"MeetingRequest - Calendar master item with uid {0} could not be found in client store.",r);n.$88=!0;return}_js.Trace.logInfo(_e.$19.$A,"MeetingRequest - Calendar master item with uid {0} found in client store.",r);$4tv(n,t,i,u,f,s);$78C(n,f,u)})},function(){n.$88=!0}):$4tp(n,t,_e.$1l.$5h(e.Id),i,f,s,null)},function(){e.__type===_g.$7b._dataContractName?_js.Trace.logInfo(_e.$19.$A,"Successfully responded to calendar master item with occurrence id {0}.",e.OccurrenceId):_js.Trace.logInfo(_e.$19.$A,"Successfully responded to calendar item with id {0}.",e.Id);r()},function(t){if(n.$88&&t.$Vs===5)u(new _e.$1g(t));else{e.__type===_g.$7b._dataContractName?_js.Trace.logError(_e.$19.$A,"MeetingRequest - Error while processing calendar master item with ocurrence id:{0}. Error: {1}",e.OccurrenceId,t.$3j):_js.Trace.logError(_e.$19.$A,"MeetingRequest - Error while processing calendar item with id:{0}. Error: {1}",e.Id,t.$3j);n.$AHQ(n.$9d[i],new _e.$1g(t),u)}})}}function $78F(n,t,i,r,u,f){var e=r.get_$1r();if($5(e.AssociatedCalendarItemId)||$5(e.AssociatedCalendarItemId.Id)){if(e.CalendarItemType!=="Single"){var o=String.format("MeetingRequest: No associated calendar item found in meeting request. Cannot create recurring meeting calendar item for the recurring meeting request with id {0}. The call should be forwarded to online proxy. Rolling back.",e.ItemId.Id);_js.Trace.logWarning(_e.$19.$A,o);n.$88=!0;n.$GK=4;t.$2nd();return}$4tk(n,t,i,r,u,f,!1)}else{var s=_e.$1l.$5h(e.AssociatedCalendarItemId.Id);$4tp(n,t,s,i,u,f,r)}}function $4tp(n,t,i,r,u,f,e){if(n.get_$AHO().referencedCalendarItemType==="RecurringMaster"){var o=this;n.get_$AU().get_$mQ().$Fu(t,i,function(e){if($5(e)||$5(e.get_$1r()))if(n.get_$AHO().isReferencedItemMeetingRequest){var o=String.format("MeetingRequest: Recurring master with id {0} not found. Cannot create recurring meeting calendar item for a recurring meeting request. The call should be forwarded to online proxy. Rolling back.",i);_js.Trace.logWarning(_e.$19.$A,o);n.$88=!0;n.$GK=4;t.$2nd();return}else{_js.Trace.logWarning(_e.$19.$A,"MeetingRequest: Recurring master with id {0} not found in local store.",i);n.$88=!0;return}$4tv(n,t,r,e,u,f)},null)}else{var s=this;n.get_$AU().get_$1c().$Fu(t,i,function(o){if($5(o)||$5(o.get_$1r())){if(n.get_$AHO().isReferencedItemMeetingRequest&&n.get_$AHO().referencedCalendarItemType==="Single"){_js.Trace.logWarning(_e.$19.$A,"MeetingRequest - Calendar with id {0} not found in local store, creating one while sync doesn't happen.",i);$4tk(n,t,r,e,u,f,!0)}else{_js.Trace.logWarning(_e.$19.$A,"MeetingRequest - Calendar with id {0} not found in local store",i);n.$88=!0}return}$4ts(n,t,r,o,u,f)},null)}}function $4tm(n,t){var i=new _g.$RG;i.CreateAssociated=!1;i.CreateContents=!1;i.CreateHierarchy=!1;i.Delete=!0;i.Modify=!0;i.Read=!0;i.ViewPrivateItems=!0;t.EffectiveRights=i;t.CalendarItemType="Single";t.IsCancelled=!1}function $4tk(n,t,i,r,u,f,e){var s=r.get_$1r();var o=new _g.$6Y;$4tm(n,o);var c=new _bc.$Bi;var h;h=e?s.AssociatedCalendarItemId:c.$5S;o.ParentFolderId=n.get_$AHO().calendarFolderId;o.ItemId=h;o.UID=c.get_$19u();o.ResponseType=s.ResponseType;o.Start=s.Start;o.End=s.End;o.ResponseObjects=s.ResponseObjects;o.IsResponseRequested=s.IsResponseRequested;o.ConversationId=s.ConversationId;o.Subject=s.Subject;o.IsMeeting=!0;o.Organizer=s.From;o.IsOrganizer=s.IsOrganizer;o.Location=s.Location;o.HasAttachments=s.HasAttachments;o.Body=s.UniqueBody;o.ReminderIsSet=!0;o.ReminderMinutesBeforeStart=5;o.StartWallClock=s.StartWallClock;o.StartTimeZoneId=s.StartTimeZoneId;o.EndWallClock=s.EndWallClock;o.EndTimeZoneId=s.EndTimeZoneId;_e.$AL.$4Tg(o);var l=n.get_$AU().get_$1c().$rP(o);var a=this;l.$E1(t,function(a){_js.Trace.logInfo(_e.$19.$A,"Successfully created calendar item with id {0} to local store.",a.toString());n.get_$AHO().createdCalendarItemIds[i]=h;n.get_$AHO().uIds[i]=c.get_$19u();var v=new _g.$6Y;v.ItemId=h;n.$9d[i].Items[0]=v;if(o.ReminderIsSet){_js.Trace.logInfo(_e.$19.$A,"A reminder is set on calendar item with Id {0}. Creating a reminder.",h.Id);n.get_$AHN().$4YB(t,o,h,function(n){_js.Trace.logInfo(_e.$19.$A,"Successfully created reminder for calendar item with id {0} to local store.",a.toString())})}if(!e){_js.Trace.logInfo(_e.$19.$A,"Created calendar item without associated calendar item id. Updating meeting request with new value.");s.AssociatedCalendarItemId=o.ItemId;r.$E1(t,function(n){_js.Trace.logInfo(_e.$19.$A,"Successfully updated meeting request {0} with new Associated calendar item id {1}.",n,s.AssociatedCalendarItemId.Id)})}$4ts(n,t,i,l,u,f)})}function $4tv(n,t,i,r,u,f){var o,s,h;var c,l,a;_e.$19.$1cx(u,c={val:o},l={val:s},a={val:h});o=c.val;s=l.val;h=a.val;var e=r.get_$1r();var v=new _g.$6Y;v.ItemId=e.ItemId;n.$9d[i].Items[0]=v;$4tu(n,e,u,f);if(o||s){var y=this;_e.$64.$7cx(t,n.get_$AU().get_$1c(),e.UID,function(i,r){var e=i.get_$1r();(e.CalendarItemType==="Occurrence"||h)&&$4tt(n,t,i,u,f)});var p=this;r.$E1(t,function(n){_js.Trace.logInfo(_e.$19.$A,"Successfully updated calendar master item with id {0}.",n)})}else{_js.Trace.logInfo(_e.$19.$A,"Response is declient, deleting occurrences/exceptions and reminders for master item with id {0}.",r.get_$1y());n.get_$AHN().$3rR(t,r.get_$1y(),r.get_$1r());_js.Trace.logInfo(_e.$19.$A,"Response is decline, deleting calendar master item with id {0}.",r.get_$1y());n.get_$AU().get_$mQ().$II(t,r.get_$1y())}$4tl(n,t,i,e,u,f)}function $4ts(n,t,i,r,u,f){var e=r.get_$1r();var o=new _g.$6Y;o.ItemId=e.ItemId;n.$9d[i].Items[0]=o;$4tt(n,t,r,u,f);$4tl(n,t,i,e,u,f)}function $4tt(n,t,i,r,u){var f,e,o;var s,h,c;_e.$19.$1cx(r,s={val:f},h={val:e},c={val:o});f=s.val;e=h.val;o=c.val;var l=i.get_$1r();$4tu(n,l,r,u);if(f||e){var a=this;i.$E1(t,function(n){_js.Trace.logInfo(_e.$19.$A,"Successfully updated calendar item with id {0}.",n)})}else{_js.Trace.logInfo(_e.$19.$A,"Response is decline, deleting calendar item with id {0}.",i.get_$1y());n.get_$AU().get_$1c().$II(t,i.get_$1y());_js.Trace.logInfo(_e.$19.$A,"Response is decline, deleting reminder with id {0}.",i.get_$1y());n.get_$AU().get_$Iq().$II(t,i.get_$1y())}}function $4tu(n,t,i,r){n.get_$AHO().referencedCalendarItemType!=="RecurringMaster"&&i.ReferenceItemId.__type!==_g.$7b._dataContractName&&t.CalendarItemType==="Occurrence"&&(t.CalendarItemType="Exception");t.ResponseType=$4to(n,i);t.FreeBusyType=$4tn(n,i,t.IntendedFreeBusyStatus);t.AppointmentReplyTime=r}function $4tl(n,t,i,r,u,f){var l=!1;var h,c,a;var v,y,p;_e.$19.$1cx(u,v={val:h},y={val:c},p={val:a});h=v.val;c=y.val;a=p.val;var e=new _g.$KG;var w=new _bc.$Bi;var b=w.$5S;_js.Trace.logInfo(_e.$19.$A,"Create meeting response called. Populating properties.");e.ItemId=b;e.InstanceKey=w.get_$Ey();e.DateTimeCreated=f;e.DateTimeReceived=f;e.LastModifiedTime=f;e.Start=r.Start;e.End=r.End;e.Location=r.Location;e.Sensitivity=r.Sensitivity;e.Importance=r.Importance;e.AssociatedCalendarItemId=r.ItemId;e.Body=r.Body;e.ToRecipients=[r.Organizer.Mailbox];var o=new _g.$Bc;o.Mailbox=new _g.$1q;o.Mailbox.EmailAddress=n.get_$AHO().userEmailAddress;o.Mailbox.Name=n.get_$AHO().userDisplayName;o.Mailbox.RoutingType="SMTP";o.Mailbox.MailboxType="Mailbox";e.From=o;e.Sender=o;e.IsRead=!0;e.HasAttachments=!1;if(n.get_$3Or().Body.MessageDisposition==="SaveOnly"){e.IsDraft=!0;e.ParentFolderId=n.get_$AHO().draftsFolderId}else{e.IsDraft=!1;e.ParentFolderId=n.get_$AHO().outboxFolderId;l=!0}e.ResponseType=r.ResponseType;var s;if(h){e.ItemClass="IPM.Schedule.Meeting.Resp.Pos";s=_u.Strings.l_AcceptForResponseMessageSubject_Text}else if(c){e.ItemClass="IPM.Schedule.Meeting.Resp.Tent";s=_u.Strings.l_TentativeForResponseMessageSubject_Text}else{e.ItemClass="IPM.Schedule.Meeting.Resp.Neg";s=_u.Strings.l_DeclineForResponseMessageSubject_Text}e.Subject=s+r.Subject;e.ResponseObjects=[new _g.$Hy,new _g.$Gd,new _g.$Ha];var k;k=l?n.get_$AU().get_$h5().$rP(e):n.get_$AU().get_$4y().$rP(e);_js.Trace.logInfo(_e.$19.$A,"Saving meeting response with id {0} into client store.",e.ItemId.Id);var d=this;k.$E1(t,function(r){_js.Trace.logInfo(_e.$19.$A,"Successfully saved meeting response with id {0} into client store.",e.ItemId.Id);var u=new _g.$KG;u.ItemId=e.ItemId;n.$9d[i].Items[1]=u;n.get_$AHO().itemIds[i]=b;n.get_$AU().get_$2r().$2QN(t,e.ParentFolderId,1,0)})}function $4to(n,t){var i=null;var r,u,f;var e,o,s;_e.$19.$1cx(t,e={val:r},o={val:u},s={val:f});r=e.val;u=o.val;f=s.val;if(r)i="Accept";else if(u)i="Tentative";else if(f)i="Decline";else throw Error.argumentType("responseItem has invalid response type");return i}function $4tn(n,t,i){var r=null;$5(i)&&(i="NoData");var u,f,e;var o,s,h;_e.$19.$1cx(t,o={val:u},s={val:f},h={val:e});u=o.val;f=s.val;e=h.val;if(f)r=i==="Free"?"Free":"Tentative";else if(u)r=i==="NoData"?"Busy":i;else if(e)r="Free";else throw Error.argumentType("responseItem has invalid response type");return r}function $78C(n,t,i){var u=t.ReferenceItemId;_js.Trace.logInfo(_e.$19.$A,"MeetingRequest - Filling Conflict Info for master for occurrence with id {0}",u.OccurrenceId);var r=i.get_$1r();t.AdditionalInfo||(t.AdditionalInfo=new _g.$YM);t.AdditionalInfo.Organizer=r.Organizer;t.AdditionalInfo.Start=r.Start;t.AdditionalInfo.End=r.End;t.AdditionalInfo.Subject=r.Subject;t.AdditionalInfo.IsResponseRequested=r.IsResponseRequested;t.AdditionalInfo.ConversationId=r.ConversationId;t.AdditionalInfo.Recurrence=r.Recurrence;t.AdditionalInfo.Location=r.Location}function $78B(n,t,i,r,u){if(!(t.__type===_g.$QQ._dataContractName)){_js.Trace.logWarning(_e.$19.$A,"Remove item wasn't supposed to receive an item type that's not a RemoveItemType : {0}.",Object.getType(t));throw Error.argumentType("item",Object.getType(t),Object.getType(new _g.$QQ),"Remove item wasn't supposed to receive an item type that's not a RemoveItemType.");}var o=t;var e=o.ReferenceItemId;var f=_e.$1l.$5h(e.Id);var s=this,h=this,c=this;n.$Bl(function(t){n.get_$AU().get_$4y().$Fu(t,f,function(r){if($5(r)||$5(r.get_$1r())){_js.Trace.logWarning(_e.$19.$A,"RemoveItem - Message with id {0} not found in local store",f);n.$88=!0;return}_js.Trace.logInfo(_e.$19.$A,"RemoveItem - Cancellation message with id {0} found in client store.",f);var u=r.get_$1r();if(u.IsDelegated){_js.Trace.logInfo(_e.$19.$A,"RemoveItem - Message with id {0} is delegated and will not be processed by offline service command",f);n.$88=!0;n.$GK=3;return}if(u.IsOutOfDate){_js.Trace.logError(_e.$19.$A,"RemoveItem - Message with id {0} is out of date and should not be used to respond to a meeting request",f);return}if($5(u.AssociatedCalendarItemId)){_js.Trace.logWarning(_e.$19.$A,"RemoveItem - Meeting cancelation message doesn't have associated calendar item and cannot be processed offline",f);n.$88=!0;return}n.get_$4y().$1ux(t,n.get_$Jl(),"MoveToDeletedItems",r,_g.$28.$BJ("deleteditems"),n.get_$4Am());n.get_$AHO().referencedCalendarItemType==="RecurringMaster"?n.$AJe(_bc.$LD,t,u.AssociatedCalendarItemId,n.get_$AU().get_$mQ()):n.$AJe(_bc.$MP,t,u.AssociatedCalendarItemId,n.get_$AU().get_$1c());n.$9d[i].Items=new Array(2);var e=new _g.$Mk;e.ItemId=u.ItemId;n.$9d[i].Items[0]=e;var o=new _g.$6Y;o.ItemId=u.AssociatedCalendarItemId;n.$9d[i].Items[1]=o},null)},function(){_js.Trace.logInfo(_e.$19.$A,"Successfully remove item from calendar referred by cancellation message with id {0}.",e.Id);r()},function(t){if(n.$88&&t.$Vs===5)u(new _e.$1g(t));else{_js.Trace.logError(_e.$19.$A,"RemoveItem - Error while processing message with id:{0}. Error: {1}",e.Id,t.$3j);n.$AHQ(n.$9d[i],new _e.$1g(t),u)}})}_e.$19.prototype={$33:null,$9d:null,$3PJ:null,$88:!1,$2zT:!1,get_$Ri:function(){return"CreateItem"},$6dD:function(n,t){_e.$GW.$6cI(this.get_$AU().get_$h5(),n,t,_e.$19.$A)},$87r:function(){return _e.$ZR.$7ly(this.get_$AHO())},$879:function(){return this.get_$3Or().Body.ComplianceId},$87n:function(){return 0},$7g4:function(n,t,i){if(this.get_$AHO().clientStoreItem){var r=this,u=this;this.$s(function(){if(r.$88){_js.Trace.logInfo(_e.$19.$A,"CreateItem: Call rejected by create item service command. The call should be forwarded to online proxy.");i(-1)}else{r.get_$AHO().clientStoreItem===4&&(r.get_$3Or().Body.GenerateResponseMessageOnFailure=!0);n()}},function(n){if(u.$88){_js.Trace.logInfo(_e.$19.$A,"CreateItem: Rollback happened. Call rejected by create item service command. The call should be forwarded to online proxy.");i(-1)}else t(n)},i)}else{_js.Trace.logWarning(_e.$19.$A,"The item will not be created in the local store because ClientStoreItem.None was passed.");i(-1)}},$7wZ:function(n,t,i,r){if(this.$88){t();return}var u=this.get_$3Or().Body.Items[n];var f=new _g.$YL;f.ResponseCode="NoError";f.ResponseClass="Success";f.Items=[new _g.$7j];this.$9d[n]=f;if(this.get_$AHO().clientStoreItem===2)$78A(this,u,n,t,i);else if(this.get_$AHO().clientStoreItem===1)$788(this,u,n,t,i);else if(this.get_$AHO().clientStoreItem===4)$789(this,u,n,t,i);else if(this.get_$AHO().clientStoreItem===5)$78B(this,u,n,t,i);else{_js.Trace.logWarning(_e.$19.$A,"ClientStoreItem type {0} is not supported.",this.get_$AHO().clientStoreItem);t();return}},$AJe:function(n,t,i,r){var u=this;r.$Fu(t,_e.$1l.$5h(i.Id),function(r){if(!r||!r.get_$1r()){_js.Trace.logWarning(_e.$19.$A,"RemoveItem - Associated calendar item (type: '{0}') with id {1} could no be found in client store. Rolling back transaction.",n.getName(),i.Id);u.$88=!0;u.$GK=13;t.$2nd();return}_js.Trace.logInfo(_e.$19.$A,"RemoveItem - Associated calendar item (type: '{0}') with id {1} found in client store. Deleting it.",n.getName(),i.Id);u.get_$AHN().$3rR(t,r.get_$1y(),r.get_$1r())},null)}};_e.$K=function(){};_e.$K.$5CA=function(n,t){for(var r=[],k=n.AttributionsArray,sf=k.length,l=0;l<sf;++l){var d=k[l];d.IsWritable&&Array.add(r,d.Id)}if(!r.length){var hf=n.AttributionsArray.length;var o=new _g.$NQ(hf.toString(),new _g.$1t("TEMPID"),"Outlook");o.IsWritable=!0;o.IsQuickContact=!1;o.IsHidden=!1;o.FolderId=null;for(var a=new Array(n.AttributionsArray.length+1),h=0;h<n.AttributionsArray.length;++h)a[h]=n.AttributionsArray[h];a[n.AttributionsArray.length]=o;n.AttributionsArray=a;Array.add(r,o.Id)}for(var u=!1,g=!1,f=!1,s=!1,nt="",tt="",it="",rt=t,cf=rt.length,v=0;v<cf;++v){var i=rt[v];var ut=i.Path;if(!ut)break;switch(ut.FieldURI){case"PersonaFileAsIds":var ft;_e.$K.$AHS(_g.$3O,Object,r,ft={val:n.FileAsIdsArray},i.OldValue,i.NewValue,_e.$K.$KW,null,_e.$K.$KX,_e.$K.$Kf,_e.$K.$L2,_e.$K.$Kd,_e.$K.$L1);n.FileAsIdsArray=ft.val;if(n.FileAsId===i.OldValue||_js.$8.$15(n.FileAsId)&&_js.$8.$15(i.OldValue)){n.FileAsId=i.NewValue;u=!0}break;case"PersonaDisplayNamePrefixes":var et;_e.$K.$AHS(_g.$3O,Object,r,et={val:n.DisplayNamePrefixesArray},i.OldValue,i.NewValue,_e.$K.$KW,null,_e.$K.$KX,_e.$K.$Kf,_e.$K.$L2,_e.$K.$Kd,_e.$K.$L1);n.DisplayNamePrefixesArray=et.val;if(n.DisplayNamePrefix===i.OldValue||_js.$8.$15(n.DisplayNamePrefix)&&_js.$8.$15(i.OldValue)){n.DisplayNamePrefix=i.NewValue;u=!0}break;case"PersonaGivenNames":var ot;_e.$K.$AHS(_g.$3O,Object,r,ot={val:n.GivenNamesArray},i.OldValue,i.NewValue,_e.$K.$KW,null,_e.$K.$KX,_e.$K.$Kf,_e.$K.$L2,_e.$K.$Kd,_e.$K.$L1);n.GivenNamesArray=ot.val;if(n.GivenName===i.OldValue||_js.$8.$15(n.GivenName)&&_js.$8.$15(i.OldValue)){n.GivenName=i.NewValue;u=!0}break;case"PersonaMiddleNames":var st;_e.$K.$AHS(_g.$3O,Object,r,st={val:n.MiddleNamesArray},i.OldValue,i.NewValue,_e.$K.$KW,null,_e.$K.$KX,_e.$K.$Kf,_e.$K.$L2,_e.$K.$Kd,_e.$K.$L1);n.MiddleNamesArray=st.val;if(n.MiddleName===i.OldValue||_js.$8.$15(n.MiddleName)&&_js.$8.$15(i.OldValue)){n.MiddleName=i.NewValue;u=!0}break;case"PersonaSurnames":var ht;_e.$K.$AHS(_g.$3O,Object,r,ht={val:n.SurnamesArray},i.OldValue,i.NewValue,_e.$K.$KW,null,_e.$K.$KX,_e.$K.$Kf,_e.$K.$L2,_e.$K.$Kd,_e.$K.$L1);n.SurnamesArray=ht.val;if(n.Surname===i.OldValue||_js.$8.$15(n.Surname)&&_js.$8.$15(i.OldValue)){n.Surname=i.NewValue;u=!0}break;case"PersonaDisplayNames":var ct;_e.$K.$AHS(_g.$3O,Object,r,ct={val:n.DisplayNamesArray},i.OldValue,i.NewValue,_e.$K.$KW,null,_e.$K.$KX,_e.$K.$Kf,_e.$K.$L2,_e.$K.$Kd,_e.$K.$L1);n.DisplayNamesArray=ct.val;if(n.DisplayName===i.OldValue||_js.$8.$15(n.DisplayName)&&_js.$8.$15(i.OldValue)){n.DisplayName=i.NewValue;u=!0;g=!0}break;case"PersonaGenerations":var lt;_e.$K.$AHS(_g.$3O,Object,r,lt={val:n.GenerationsArray},i.OldValue,i.NewValue,_e.$K.$KW,null,_e.$K.$KX,_e.$K.$Kf,_e.$K.$L2,_e.$K.$Kd,_e.$K.$L1);n.GenerationsArray=lt.val;if(n.Generation===i.OldValue||_js.$8.$15(n.Generation)&&_js.$8.$15(i.OldValue)){n.Generation=i.NewValue;u=!0}break;case"PersonaNicknames":var at;_e.$K.$AHS(_g.$3O,Object,r,at={val:n.NicknamesArray},i.OldValue,i.NewValue,_e.$K.$KW,null,_e.$K.$KX,_e.$K.$Kf,_e.$K.$L2,_e.$K.$Kd,_e.$K.$L1);n.NicknamesArray=at.val;if(n.Nickname===i.OldValue||_js.$8.$15(n.Nickname)&&_js.$8.$15(i.OldValue)){n.Nickname=i.NewValue;u=!0}break;case"PersonaInitials":var vt;_e.$K.$AHS(_g.$3O,Object,r,vt={val:n.InitialsArray},i.OldValue,i.NewValue,_e.$K.$KW,null,_e.$K.$KX,_e.$K.$Kf,_e.$K.$L2,_e.$K.$Kd,_e.$K.$L1);n.InitialsArray=vt.val;break;case"PersonaYomiCompanyNames":var yt;_e.$K.$AHS(_g.$3O,Object,r,yt={val:n.YomiCompanyNamesArray},i.OldValue,i.NewValue,_e.$K.$KW,null,_e.$K.$KX,_e.$K.$Kf,_e.$K.$L2,_e.$K.$Kd,_e.$K.$L1);n.YomiCompanyNamesArray=yt.val;break;case"PersonaYomiFirstNames":var pt;_e.$K.$AHS(_g.$3O,Object,r,pt={val:n.YomiFirstNamesArray},i.OldValue,i.NewValue,_e.$K.$KW,null,_e.$K.$KX,_e.$K.$Kf,_e.$K.$L2,_e.$K.$Kd,_e.$K.$L1);n.YomiFirstNamesArray=pt.val;if(n.YomiFirstName===i.OldValue||_js.$8.$15(n.YomiFirstName)&&_js.$8.$15(i.OldValue)){n.YomiFirstName=i.NewValue;u=!0}break;case"PersonaYomiLastNames":var wt;_e.$K.$AHS(_g.$3O,Object,r,wt={val:n.YomiLastNamesArray},i.OldValue,i.NewValue,_e.$K.$KW,null,_e.$K.$KX,_e.$K.$Kf,_e.$K.$L2,_e.$K.$Kd,_e.$K.$L1);n.YomiLastNamesArray=wt.val;if(n.YomiLastName===i.OldValue||_js.$8.$15(n.YomiLastName)&&_js.$8.$15(i.OldValue)){n.YomiLastName=i.NewValue;u=!0}break;case"PersonaBusinessPhoneNumbers":var bt;_e.$K.$AHS(_g.$5H,Number,r,bt={val:n.BusinessPhoneNumbersArray},i.OldValue,i.NewValue,_e.$K.$Xe,"Business",_e.$K.$Xf,_e.$K.$Y2,_e.$K.$ZU,_e.$K.$Xy,_e.$K.$ZS);n.BusinessPhoneNumbersArray=bt.val;s=!0;break;case"PersonaBusinessPhoneNumbers2":var kt;_e.$K.$AHS(_g.$5H,Number,r,kt={val:n.BusinessPhoneNumbers2Array},i.OldValue,i.NewValue,_e.$K.$Xe,"Business",_e.$K.$Xf,_e.$K.$Y2,_e.$K.$ZU,_e.$K.$Xy,_e.$K.$ZS);n.BusinessPhoneNumbers2Array=kt.val;break;case"PersonaHomePhones":var dt;_e.$K.$AHS(_g.$5H,Number,r,dt={val:n.HomePhonesArray},i.OldValue,i.NewValue,_e.$K.$Xe,"Home",_e.$K.$Xf,_e.$K.$Y2,_e.$K.$ZU,_e.$K.$Xy,_e.$K.$ZS);n.HomePhonesArray=dt.val;s=!0;break;case"PersonaHomePhones2":var gt;_e.$K.$AHS(_g.$5H,Number,r,gt={val:n.HomePhones2Array},i.OldValue,i.NewValue,_e.$K.$Xe,"Home",_e.$K.$Xf,_e.$K.$Y2,_e.$K.$ZU,_e.$K.$Xy,_e.$K.$ZS);n.HomePhones2Array=gt.val;break;case"PersonaMobilePhones":var ni;_e.$K.$AHS(_g.$5H,Number,r,ni={val:n.MobilePhonesArray},i.OldValue,i.NewValue,_e.$K.$Xe,"Mobile",_e.$K.$Xf,_e.$K.$Y2,_e.$K.$ZU,_e.$K.$Xy,_e.$K.$ZS);n.MobilePhonesArray=ni.val;s=!0;break;case"PersonaAssistantPhoneNumbers":var ti;_e.$K.$AHS(_g.$5H,Number,r,ti={val:n.AssistantPhoneNumbersArray},i.OldValue,i.NewValue,_e.$K.$Xe,"Assistant",_e.$K.$Xf,_e.$K.$Y2,_e.$K.$ZU,_e.$K.$Xy,_e.$K.$ZS);n.AssistantPhoneNumbersArray=ti.val;break;case"PersonaCallbackPhones":var ii;_e.$K.$AHS(_g.$5H,Number,r,ii={val:n.CallbackPhonesArray},i.OldValue,i.NewValue,_e.$K.$Xe,"Callback",_e.$K.$Xf,_e.$K.$Y2,_e.$K.$ZU,_e.$K.$Xy,_e.$K.$ZS);n.CallbackPhonesArray=ii.val;break;case"PersonaCarPhones":var ri;_e.$K.$AHS(_g.$5H,Number,r,ri={val:n.CarPhonesArray},i.OldValue,i.NewValue,_e.$K.$Xe,"Car",_e.$K.$Xf,_e.$K.$Y2,_e.$K.$ZU,_e.$K.$Xy,_e.$K.$ZS);n.CarPhonesArray=ri.val;break;case"PersonaHomeFaxes":var ui;_e.$K.$AHS(_g.$5H,Number,r,ui={val:n.HomeFaxesArray},i.OldValue,i.NewValue,_e.$K.$Xe,"HomeFax",_e.$K.$Xf,_e.$K.$Y2,_e.$K.$ZU,_e.$K.$Xy,_e.$K.$ZS);n.HomeFaxesArray=ui.val;break;case"PersonaOrganizationMainPhones":var fi;_e.$K.$AHS(_g.$5H,Number,r,fi={val:n.OrganizationMainPhonesArray},i.OldValue,i.NewValue,_e.$K.$Xe,"OrganizationMain",_e.$K.$Xf,_e.$K.$Y2,_e.$K.$ZU,_e.$K.$Xy,_e.$K.$ZS);n.OrganizationMainPhonesArray=fi.val;break;case"PersonaOtherFaxes":var ei;_e.$K.$AHS(_g.$5H,Number,r,ei={val:n.OtherFaxesArray},i.OldValue,i.NewValue,_e.$K.$Xe,"OtherFax",_e.$K.$Xf,_e.$K.$Y2,_e.$K.$ZU,_e.$K.$Xy,_e.$K.$ZS);n.OtherFaxesArray=ei.val;break;case"PersonaOtherTelephones":var oi;_e.$K.$AHS(_g.$5H,Number,r,oi={val:n.OtherTelephonesArray},i.OldValue,i.NewValue,_e.$K.$Xe,"Other",_e.$K.$Xf,_e.$K.$Y2,_e.$K.$ZU,_e.$K.$Xy,_e.$K.$ZS);n.OtherTelephonesArray=oi.val;s=!0;break;case"PersonaOtherPhones2":var si;_e.$K.$AHS(_g.$5H,Number,r,si={val:n.OtherPhones2Array},i.OldValue,i.NewValue,_e.$K.$Xe,"Other",_e.$K.$Xf,_e.$K.$Y2,_e.$K.$ZU,_e.$K.$Xy,_e.$K.$ZS);n.OtherPhones2Array=si.val;break;case"PersonaPagers":var hi;_e.$K.$AHS(_g.$5H,Number,r,hi={val:n.PagersArray},i.OldValue,i.NewValue,_e.$K.$Xe,"Pager",_e.$K.$Xf,_e.$K.$Y2,_e.$K.$ZU,_e.$K.$Xy,_e.$K.$ZS);n.PagersArray=hi.val;break;case"PersonaRadioPhones":var ci;_e.$K.$AHS(_g.$5H,Number,r,ci={val:n.RadioPhonesArray},i.OldValue,i.NewValue,_e.$K.$Xe,"Radio",_e.$K.$Xf,_e.$K.$Y2,_e.$K.$ZU,_e.$K.$Xy,_e.$K.$ZS);n.RadioPhonesArray=ci.val;break;case"PersonaTelexNumbers":var li;_e.$K.$AHS(_g.$5H,Number,r,li={val:n.TelexNumbersArray},i.OldValue,i.NewValue,_e.$K.$Xe,"Telex",_e.$K.$Xf,_e.$K.$Y2,_e.$K.$ZU,_e.$K.$Xy,_e.$K.$ZS);n.TelexNumbersArray=li.val;break;case"PersonaTTYTDDPhoneNumbers":var ai;_e.$K.$AHS(_g.$5H,Number,r,ai={val:n.TTYTDDPhoneNumbersArray},i.OldValue,i.NewValue,_e.$K.$Xe,"TTYTDD",_e.$K.$Xf,_e.$K.$Y2,_e.$K.$ZU,_e.$K.$Xy,_e.$K.$ZS);n.TTYTDDPhoneNumbersArray=ai.val;break;case"PersonaWorkFaxes":var vi;_e.$K.$AHS(_g.$5H,Number,r,vi={val:n.WorkFaxesArray},i.OldValue,i.NewValue,_e.$K.$Xe,"BusinessFax",_e.$K.$Xf,_e.$K.$Y2,_e.$K.$ZU,_e.$K.$Xy,_e.$K.$ZS);n.WorkFaxesArray=vi.val;break;case"PersonaEmails1":var yi=new _g.$1q;yi.EmailAddress=i.OldValue;var pi=new _g.$1q;pi.EmailAddress=i.NewValue;var wi;_e.$K.$AHS(_g.$Bm,Object,r,wi={val:n.Emails1Array},yi,pi,_e.$K.$1C0,0,_e.$K.$1C1,_e.$K.$1DW,_e.$K.$1JN,_e.$K.$1DK,_e.$K.$1JH);n.Emails1Array=wi.val;f=!0;nt=i.OldValue;break;case"PersonaEmails1DisplayNames":var bi=new _g.$1q;bi.Name=i.OldValue;var ki=new _g.$1q;ki.Name=i.NewValue;var di;_e.$K.$AHS(_g.$Bm,Object,r,di={val:n.Emails1Array},bi,ki,_e.$K.$1C0,1,_e.$K.$1C1,_e.$K.$1DW,_e.$K.$1JN,_e.$K.$1DK,_e.$K.$1JH);n.Emails1Array=di.val;f=!0;break;case"PersonaEmails1OriginalDisplayNames":var gi=new _g.$1q;gi.OriginalDisplayName=i.OldValue;var nr=new _g.$1q;nr.OriginalDisplayName=i.NewValue;var tr;_e.$K.$AHS(_g.$Bm,Object,r,tr={val:n.Emails1Array},gi,nr,_e.$K.$1C0,2,_e.$K.$1C1,_e.$K.$1DW,_e.$K.$1JN,_e.$K.$1DK,_e.$K.$1JH);n.Emails1Array=tr.val;f=!0;break;case"PersonaEmails2":var ir=new _g.$1q;ir.EmailAddress=i.OldValue;var rr=new _g.$1q;rr.EmailAddress=i.NewValue;var ur;_e.$K.$AHS(_g.$Bm,Object,r,ur={val:n.Emails2Array},ir,rr,_e.$K.$1C0,0,_e.$K.$1C1,_e.$K.$1DW,_e.$K.$1JN,_e.$K.$1DK,_e.$K.$1JH);n.Emails2Array=ur.val;f=!0;tt=i.OldValue;break;case"PersonaEmails2DisplayNames":var fr=new _g.$1q;fr.Name=i.OldValue;var er=new _g.$1q;er.Name=i.NewValue;var or;_e.$K.$AHS(_g.$Bm,Object,r,or={val:n.Emails2Array},fr,er,_e.$K.$1C0,1,_e.$K.$1C1,_e.$K.$1DW,_e.$K.$1JN,_e.$K.$1DK,_e.$K.$1JH);n.Emails2Array=or.val;f=!0;break;case"PersonaEmails2OriginalDisplayNames":var sr=new _g.$1q;sr.OriginalDisplayName=i.OldValue;var hr=new _g.$1q;hr.OriginalDisplayName=i.NewValue;var cr;_e.$K.$AHS(_g.$Bm,Object,r,cr={val:n.Emails2Array},sr,hr,_e.$K.$1C0,2,_e.$K.$1C1,_e.$K.$1DW,_e.$K.$1JN,_e.$K.$1DK,_e.$K.$1JH);n.Emails2Array=cr.val;f=!0;break;case"PersonaEmails3":var lr=new _g.$1q;lr.EmailAddress=i.OldValue;var ar=new _g.$1q;ar.EmailAddress=i.NewValue;var vr;_e.$K.$AHS(_g.$Bm,Object,r,vr={val:n.Emails3Array},lr,ar,_e.$K.$1C0,0,_e.$K.$1C1,_e.$K.$1DW,_e.$K.$1JN,_e.$K.$1DK,_e.$K.$1JH);n.Emails3Array=vr.val;f=!0;it=i.OldValue;break;case"PersonaEmails3DisplayNames":var yr=new _g.$1q;yr.Name=i.OldValue;var pr=new _g.$1q;pr.Name=i.NewValue;var wr;_e.$K.$AHS(_g.$Bm,Object,r,wr={val:n.Emails3Array},yr,pr,_e.$K.$1C0,1,_e.$K.$1C1,_e.$K.$1DW,_e.$K.$1JN,_e.$K.$1DK,_e.$K.$1JH);n.Emails3Array=wr.val;f=!0;break;case"PersonaEmails3OriginalDisplayNames":var br=new _g.$1q;br.OriginalDisplayName=i.OldValue;var kr=new _g.$1q;kr.OriginalDisplayName=i.NewValue;var dr;_e.$K.$AHS(_g.$Bm,Object,r,dr={val:n.Emails3Array},br,kr,_e.$K.$1C0,2,_e.$K.$1C1,_e.$K.$1DW,_e.$K.$1JN,_e.$K.$1DK,_e.$K.$1JH);n.Emails3Array=dr.val;f=!0;break;case"PersonaBusinessHomePages":var gr;_e.$K.$AHS(_g.$3O,Object,r,gr={val:n.BusinessHomePagesArray},i.OldValue,i.NewValue,_e.$K.$KW,null,_e.$K.$KX,_e.$K.$Kf,_e.$K.$L2,_e.$K.$Kd,_e.$K.$L1);n.BusinessHomePagesArray=gr.val;break;case"PersonaPersonalHomePages":var nu;_e.$K.$AHS(_g.$3O,Object,r,nu={val:n.PersonalHomePagesArray},i.OldValue,i.NewValue,_e.$K.$KW,null,_e.$K.$KX,_e.$K.$Kf,_e.$K.$L2,_e.$K.$Kd,_e.$K.$L1);n.PersonalHomePagesArray=nu.val;break;case"PersonaOfficeLocations":var tu;_e.$K.$AHS(_g.$3O,Object,r,tu={val:n.OfficeLocationsArray},i.OldValue,i.NewValue,_e.$K.$KW,null,_e.$K.$KX,_e.$K.$Kf,_e.$K.$L2,_e.$K.$Kd,_e.$K.$L1);n.OfficeLocationsArray=tu.val;break;case"PersonaImAddresses":var iu;_e.$K.$AHS(_g.$3O,Object,r,iu={val:n.ImAddressesArray},i.OldValue,i.NewValue,_e.$K.$KW,null,_e.$K.$KX,_e.$K.$Kf,_e.$K.$L2,_e.$K.$Kd,_e.$K.$L1);n.ImAddressesArray=iu.val;(n.ImAddress===i.OldValue||_js.$8.$15(n.ImAddress)&&_js.$8.$15(i.OldValue))&&(n.ImAddress=i.NewValue);break;case"PersonaBusinessAddresses":var ru;_e.$K.$AHS(_g.$E4,Number,r,ru={val:n.BusinessAddressesArray},i.OldValue,i.NewValue,_e.$K.$3pI,"Business",_e.$K.$3pJ,_e.$K.$3zC,_e.$K.$4av,_e.$K.$3x8,_e.$K.$4aB);n.BusinessAddressesArray=ru.val;break;case"PersonaHomeAddresses":var uu;_e.$K.$AHS(_g.$E4,Number,r,uu={val:n.HomeAddressesArray},i.OldValue,i.NewValue,_e.$K.$3pI,"Home",_e.$K.$3pJ,_e.$K.$3zC,_e.$K.$4av,_e.$K.$3x8,_e.$K.$4aB);n.HomeAddressesArray=uu.val;break;case"PersonaOtherAddresses":var fu;_e.$K.$AHS(_g.$E4,Number,r,fu={val:n.OtherAddressesArray},i.OldValue,i.NewValue,_e.$K.$3pI,"Other",_e.$K.$3pJ,_e.$K.$3zC,_e.$K.$4av,_e.$K.$3x8,_e.$K.$4aB);n.OtherAddressesArray=fu.val;break;case"PersonaTitles":var eu;_e.$K.$AHS(_g.$3O,Object,r,eu={val:n.TitlesArray},i.OldValue,i.NewValue,_e.$K.$KW,null,_e.$K.$KX,_e.$K.$Kf,_e.$K.$L2,_e.$K.$Kd,_e.$K.$L1);n.TitlesArray=eu.val;(n.Title===i.OldValue||_js.$8.$15(n.Title)&&_js.$8.$15(i.OldValue))&&(n.Title=i.NewValue);break;case"PersonaDepartments":var ou;_e.$K.$AHS(_g.$3O,Object,r,ou={val:n.DepartmentsArray},i.OldValue,i.NewValue,_e.$K.$KW,null,_e.$K.$KX,_e.$K.$Kf,_e.$K.$L2,_e.$K.$Kd,_e.$K.$L1);n.DepartmentsArray=ou.val;(n.Department===i.OldValue||_js.$8.$15(n.Department)&&_js.$8.$15(i.OldValue))&&(n.Department=i.NewValue);break;case"PersonaCompanyNames":var su;_e.$K.$AHS(_g.$3O,Object,r,su={val:n.CompanyNamesArray},i.OldValue,i.NewValue,_e.$K.$KW,null,_e.$K.$KX,_e.$K.$Kf,_e.$K.$L2,_e.$K.$Kd,_e.$K.$L1);n.CompanyNamesArray=su.val;if(n.CompanyName===i.OldValue||_js.$8.$15(n.CompanyName)&&_js.$8.$15(i.OldValue)){n.CompanyName=i.NewValue;n.CompanyNameSortKey=null}break;case"PersonaManagers":var hu;_e.$K.$AHS(_g.$3O,Object,r,hu={val:n.ManagersArray},i.OldValue,i.NewValue,_e.$K.$KW,null,_e.$K.$KX,_e.$K.$Kf,_e.$K.$L2,_e.$K.$Kd,_e.$K.$L1);n.ManagersArray=hu.val;break;case"PersonaAssistantNames":var cu;_e.$K.$AHS(_g.$3O,Object,r,cu={val:n.AssistantNamesArray},i.OldValue,i.NewValue,_e.$K.$KW,null,_e.$K.$KX,_e.$K.$Kf,_e.$K.$L2,_e.$K.$Kd,_e.$K.$L1);n.AssistantNamesArray=cu.val;break;case"PersonaProfessions":var lu;_e.$K.$AHS(_g.$3O,Object,r,lu={val:n.ProfessionsArray},i.OldValue,i.NewValue,_e.$K.$KW,null,_e.$K.$KX,_e.$K.$Kf,_e.$K.$L2,_e.$K.$Kd,_e.$K.$L1);n.ProfessionsArray=lu.val;break;case"PersonaBodies":var au;_e.$K.$AHS(_g.$Jl,Object,r,au={val:n.BodiesArray},i.OldValue,i.NewValue,_e.$K.$7kP,null,_e.$K.$7kQ,_e.$K.$898,_e.$K.$9y0,_e.$K.$81o,_e.$K.$9uu);n.BodiesArray=au.val;break;case"PersonaSpouseNames":var vu;_e.$K.$AHS(_g.$3O,Object,r,vu={val:n.SpouseNamesArray},i.OldValue,i.NewValue,_e.$K.$KW,null,_e.$K.$KX,_e.$K.$Kf,_e.$K.$L2,_e.$K.$Kd,_e.$K.$L1);n.SpouseNamesArray=vu.val;break;case"PersonaChildren":var yu;_e.$K.$AHS(_g.$Kb,Object,r,yu={val:n.ChildrenArray},i.OldValue,i.NewValue,_e.$K.$7oB,null,_e.$K.$7oC,_e.$K.$899,_e.$K.$9y1,_e.$K.$81p,_e.$K.$9uv);n.ChildrenArray=yu.val;break;case"PersonaHobbies":var pu;_e.$K.$AHS(_g.$3O,Object,r,pu={val:n.HobbiesArray},i.OldValue,i.NewValue,_e.$K.$KW,null,_e.$K.$KX,_e.$K.$Kf,_e.$K.$L2,_e.$K.$Kd,_e.$K.$L1);n.HobbiesArray=pu.val;break;case"PersonaSchools":var wu;_e.$K.$AHS(_g.$3O,Object,r,wu={val:n.SchoolsArray},i.OldValue,i.NewValue,_e.$K.$KW,null,_e.$K.$KX,_e.$K.$Kf,_e.$K.$L2,_e.$K.$Kd,_e.$K.$L1);n.SchoolsArray=wu.val;break;case"PersonaWeddingAnniversariesLocal":var bu;_e.$K.$AHS(_g.$3O,Object,r,bu={val:n.WeddingAnniversariesLocalArray},i.OldValue,i.NewValue,_e.$K.$KW,null,_e.$K.$KX,_e.$K.$Kf,_e.$K.$L2,_e.$K.$Kd,_e.$K.$L1);n.WeddingAnniversariesLocalArray=bu.val;break;case"PersonaBirthdaysLocal":var ku;_e.$K.$AHS(_g.$3O,Object,r,ku={val:n.BirthdaysLocalArray},i.OldValue,i.NewValue,_e.$K.$KW,null,_e.$K.$KX,_e.$K.$Kf,_e.$K.$L2,_e.$K.$Kd,_e.$K.$L1);n.BirthdaysLocalArray=ku.val;break;case"PersonaLocations":var du;_e.$K.$AHS(_g.$3O,Object,r,du={val:n.LocationsArray},i.OldValue,i.NewValue,_e.$K.$KW,null,_e.$K.$KX,_e.$K.$Kf,_e.$K.$L2,_e.$K.$Kd,_e.$K.$L1);n.LocationsArray=du.val;(n.Location===i.OldValue||_js.$8.$15(n.Location)&&_js.$8.$15(i.OldValue))&&(n.Location=i.NewValue);break;case"PersonaType":(n.PersonaTypeString===i.OldValue||_js.$8.$15(n.PersonaTypeString)&&_js.$8.$15(i.OldValue))&&(n.PersonaTypeString=i.NewValue);break;default:break}}if(u){g||(n.DisplayName=_g.$70.$3ki(n.DisplayNamePrefix,n.GivenName,n.MiddleName,n.Surname,n.Generation,n.YomiFirstName,n.YomiLastName));n.FileAs=_g.$70.$7eD(n.FileAsId,n.GivenName,n.MiddleName,n.Surname,n.Generation,n.DisplayName,n.CompanyName)}if(f){var e=[];if(!$5(n.Emails1Array))for(var gu=n.Emails1Array,lf=gu.length,y=0;y<lf;++y){var nf=gu[y];var af=nf.Value.Name===nt;_e.$K.$3h5(e,nf,af)}if(!$5(n.Emails2Array))for(var tf=n.Emails2Array,vf=tf.length,p=0;p<vf;++p){var rf=tf[p];var yf=rf.Value.Name===tt;_e.$K.$3h5(e,rf,yf)}if(!$5(n.Emails3Array))for(var uf=n.Emails3Array,pf=uf.length,w=0;w<pf;++w){var ff=uf[w];var wf=ff.Value.Name===it;_e.$K.$3h5(e,ff,wf)}if(e.length>0){for(var b=new Array(e.length),c=0;c<e.length;++c)b[c]=e[c];n.EmailAddresses=b;n.EmailAddress=b[0]}}if(u||f||s){var ef,of;_g.$70.$3kj(n.GivenName,n.MiddleName,n.Surname,n.DisplayName,n.CompanyName,n.EmailAddress,n.MobilePhonesArray,n.HomePhonesArray,n.BusinessPhoneNumbersArray,n.OtherTelephonesArray,_e.$K.$83P,_e.$K.$fu,ef={val:n.DisplayNameFirstLast},of={val:n.DisplayNameLastFirst});n.DisplayNameFirstLast=ef.val;n.DisplayNameLastFirst=of.val;n.DisplayNameFirstLastSortKey=null;n.DisplayNameLastFirstSortKey=null;n.DisplayNameFirstLastHeader=_e.$K.$2br;n.DisplayNameLastFirstHeader=_e.$K.$2br}};_e.$K.$83t=function(n){var t=null;$5(n)||n.length>0&&!$5(n[0].Value)&&!_js.$8.$15(n[0].Value.Number)&&(t=n[0].Value.Number);return t};_e.$K.$83P=function(n){var t=null;$5(n)||_js.$8.$15(n.EmailAddress)||(t=n.RoutingType.toUpperCase()==="EX"?n.OriginalDisplayName:n.EmailAddress);return t};_e.$K.$fu=function(n){if(Array.isInstanceOfType(n)){var t=n;return _e.$K.$83t(t)}return null};_e.$K.$3h5=function(n,t,i){($5(t.Value.Name)||i)&&(t.Value.Name=t.Value.EmailAddress);$5(t.Value.RoutingType)&&(t.Value.RoutingType="SMTP");Array.add(n,t.Value)};_e.$K.$KW=function(n,t){return new _g.$3O(n)};_e.$K.$KX=function(n){for(var i=new Array(n.length),t=0;t<n.length;++t)i[t]=n[t];return i};_e.$K.$Kf=function(n){return n.Value};_e.$K.$L2=function(n,t,i){n.Value=t};_e.$K.$Kd=function(n){return n.Attributions};_e.$K.$L1=function(n,t){n.Attributions=t};_e.$K.$7oB=function(n,t){var i=new _g.$Kb;i.Values=n.split(",;");return i};_e.$K.$7oC=function(n){for(var i=new Array(n.length),t=0;t<n.length;++t)i[t]=n[t];return i};_e.$K.$899=function(n){return n.Values.join(", ")};_e.$K.$9y1=function(n,t,i){n.Values=t.split(",;")};_e.$K.$81p=function(n){return n.Attributions};_e.$K.$9uv=function(n,t){n.Attributions=t};_e.$K.$Xe=function(n,t){return new _g.$5H(new _g.$3G(n,t))};_e.$K.$Xf=function(n){for(var i=new Array(n.length),t=0;t<n.length;++t)i[t]=n[t];return i};_e.$K.$Y2=function(n){return n.Value.Number};_e.$K.$ZU=function(n,t,i){var r=n.Value.Type;n.Value=new _g.$3G(t,r)};_e.$K.$Xy=function(n){return n.Attributions};_e.$K.$ZS=function(n,t){n.Attributions=t};_e.$K.$1C0=function(n,t){var i=new _g.$Bm;i.Value=n;return i};_e.$K.$1C1=function(n){for(var i=new(_0365f.$n.$$(_g.$Bm)),t=0;t<n.length;++t){var r=_e.$K.$5MD(n[t]);_e.$K.$15(r)||i.$D(n[t])}return i.get_$C()>0?i.$6W():null};_e.$K.$1DW=function(n){return _e.$K.$5MD(n)};_e.$K.$5MD=function(n){var t=new _g.$1q;t.Name=n.Value.Name;t.EmailAddress=n.Value.EmailAddress;t.RoutingType=n.Value.RoutingType;t.OriginalDisplayName=n.Value.OriginalDisplayName;return t};_e.$K.$1JN=function(n,t,i){n.Value||(n.Value=new _g.$1q);var r=t;var u=i;switch(u){case 1:n.Value.Name=r.Name;break;case 2:n.Value.OriginalDisplayName=r.OriginalDisplayName;break;case 0:n.Value.EmailAddress=r.EmailAddress;if(n.Value.EmailAddress===""){n.Value.Name="";n.Value.RoutingType=""}break;default:throw Error.notImplemented("Invalid enum type: "+_e.$K.$2xH.toString(u));}};_e.$K.$1DK=function(n){return n.Attributions};_e.$K.$1JH=function(n,t){n.Attributions=t};_e.$K.$3pI=function(n,t){var i=_g.$OY.$5J0(n,t);return new _g.$E4(i)};_e.$K.$3pJ=function(n){for(var i=new Array(n.length),t=0;t<n.length;++t)i[t]=n[t];return i};_e.$K.$3zC=function(n){var t=n.Value;return _g.$OY.$3nN(t.Street,t.City,t.State,t.PostalCode,t.Country)};_e.$K.$4av=function(n,t,i){var r=_g.$OY.$5J0(t,n.Value.Type);n.Value=r};_e.$K.$3x8=function(n){return n.Attributions};_e.$K.$4aB=function(n,t){n.Attributions=t};_e.$K.$7kP=function(n,t){var i=new _g.$6b("Text",n);return new _g.$Jl(i)};_e.$K.$7kQ=function(n){for(var i=new Array(n.length),t=0;t<n.length;++t)i[t]=n[t];return i};_e.$K.$898=function(n){return n.Value.Value};_e.$K.$9y0=function(n,t,i){var r=new _g.$6b("Text",t);n.Value=r};_e.$K.$81o=function(n){return n.Attributions};_e.$K.$9uu=function(n,t){n.Attributions=t};_e.$K.$AHS=function(n,t,i,r,u,f,e,o,s,h,c,l,a){var v=[];if(r.val&&r.val.length)for(var st=r.val,wt=st.length,g=0;g<wt;++g){var y=st[g];var nt=h(y);var ht=l(y);if(_e.$K.$15(nt)&&_e.$K.$15(u)||_e.$K.$7bB(u,nt,o)){for(var tt=!1,it=!1,ct=ht,bt=ct.length,rt=0;rt<bt;++rt){var kt=ct[rt];Array.contains(i,kt)?tt=!0:it=!0}if(tt&&!it){if(!_e.$K.$8P6(f)){c(y,f,o);Array.add(v,y)}}else if(tt&&it){for(var lt=e(f,o),at=e(nt,o),w=[],b=[],vt=ht,dt=vt.length,ut=0;ut<dt;++ut){var ft=vt[ut];Array.contains(i,ft)?Array.add(w,ft):Array.add(b,ft)}for(var yt=new Array(w.length),k=0;k<w.length;++k)yt[k]=w[k];a(lt,yt);for(var pt=new Array(b.length),d=0;d<b.length;++d)pt[d]=b[d];a(at,pt);_e.$K.$15(f)||Array.add(v,lt);Array.add(v,at)}else Array.add(v,y)}else Array.add(v,y)}else if(!_e.$K.$15(f)){for(var et=e(f,o),ot=new Array(i.length),p=0;p<i.length;++p)ot[p]=i[p];a(et,ot);Array.add(v,et)}r.val=v.length>0?s(v):null};_e.$K.$7bB=function(n,t,i){if(!$5(n)&&!$5(t)){if(String.isInstanceOfType(n))return t===n;if(_g.$2R.$YG(n)){var r=n;var u=t;var f=i;switch(f){case 0:return _js.$8.$15(r.EmailAddress)&&_js.$8.$15(u.EmailAddress)?!0:u.EmailAddress===r.EmailAddress;case 1:return _js.$8.$15(r.Name)&&_js.$8.$15(u.Name)?!0:u.Name===r.Name;case 2:return _js.$8.$15(r.OriginalDisplayName)&&_js.$8.$15(u.OriginalDisplayName)?!0:u.OriginalDisplayName===r.OriginalDisplayName;default:throw Error.notImplemented("Invalid enum type: "+_e.$K.$2xH.toString(f));}}throw Error.notImplemented("Unimplemented object type "+Object.getType(n).toString());}return!1};_e.$K.$15=function(n){if($5(n))return!0;if(String.isInstanceOfType(n))return _js.$8.$15(n);if(_g.$2R.$YG(n))return _js.$8.$15(n.EmailAddress)&&_js.$8.$15(n.Name);throw Error.notImplemented("Unimplemented object type "+Object.getType(n).toString());};_e.$K.$8P6=function(n){if(String.isInstanceOfType(n))return _e.$K.$15(n);if(_g.$2R.$YG(n))return $5(n);throw Error.notImplemented("Unimplemented object type "+Object.getType(n).toString());};_e.$K.$2xH=function(){};_e.$K.$2xH.prototype={address:0,name:1,originalDisplayName:2};_e.$K.$2xH.registerEnum("_e.$K.$2xH",!1);_e.$uT=function(n,t,i,r){_e.$uT.$$(this.$$gta["_e.$uT"].TActionContext).initializeBase(this,[n,t]);this.$2ce=i;this.$6Qz=r};_e.$uT.$$=function(n){var t="$uT"+"$1"+"$"+n.getName().replace(/\./g,"_");if(!_e[t]){var r=_e[t]=function(){(this.$$gta=this.$$gta||{})["_e.$uT"]={TActionContext:n};for(var i=[],t=0;t<arguments.length;++t)i[t]=arguments[t];_e.$uT.apply(this,i)};r.registerClass("_e."+t,_e.$69.$$(n));var u=_e.$uT.prototype;for(var f in u){var i={key:f,value:u[f]};"constructor"!==i.key&&(r.prototype[i.key]=i.value)}}return _e[t]};_e.$uT.prototype={$2ce:null,$18:null,$6Qz:null,get_$1u:function(){return this.$18},set_$1u:function(n){this.$18=n;return n},get_$AIW:function(){return this.$2ce},set_$AIW:function(n){this.$2ce=n;return n},get_$AIX:function(){return this.$6Qz}};_e.$PP=function(n,t,i,r,u,f){_e.$PP.initializeBase(this,[n,t,i,u]);_a.$3.$m(i,"propertyUpdates");_a.$3.$m(r,"parentFolder");_a.$3.$m(n.personaId,"actionContext.PersonaId");_a.$3.$1G(n.personaId.Id,"actionContext.PersonaId.Id");this.$Kw=r;this.$4Y=f};_e.$PP.prototype={$Kw:null,$4Y:null,$2k:null,get_$Ri:function(){return"CreatePersona"},$7g4:function(n,t,i){if(this.get_$AIX()===_e.$K.$3sf){i(-1);return}var r=this.$Kw.BaseFolderId;if(_g.$7N.isInstanceOfType(r)){var u=this;this.$4Y.$T3(2,new _a.$Kd,function(f){if(f){var e=r.Id;_e.$8H.$1cZ(u.get_$AU().get_$2r(),e,function(r){if(r){u.$2k=r.get_$1r().FolderId;u.$s(n,t,i)}else{_js.Trace.logWarning(_e.$PP.$A,"Couldn't find a folder with the distinguished id '{0}', so reject this command.",e);i(-1)}},function(n){_js.Trace.logError(_e.$PP.$A,"Couldn't find a folder with the distinguished id because of failure: '{0}'",n.get_$4y());t(n.$Sd())})}else{_js.Trace.logWarning(_e.$PP.$A,"Couldn't find a folder with the distinguished id because folder hierarchy wasn't synced.");i(-1)}})}else{this.$2k=r;this.$s(n,t,i)}},$7wm:function(n,t,i){var r=new _g.$D7;r.PersonaId=this.get_$AHO().personaId;r.PersonaTypeString="Person";r.FolderIds=[this.$2k];this.get_$AHO().createPersonaUnderMyContactsFolder&&Array.add(r.FolderIds,_g.$28.$BJ("mycontacts"));r.CreationTimeString=_a.$7.$Ex(_a.$7.get_$2F());r.DisplayNameFirstLastHeader=_e.$K.$2br;r.DisplayNameLastFirstHeader=_e.$K.$2br;r.FileAsId="LastCommaFirst";var u=new _g.$NQ("0",new _g.$1t(this.get_$AHO().personaId.Id),"Outlook");u.IsWritable=!0;u.IsQuickContact=!1;u.IsHidden=!1;u.FolderId=null;r.AttributionsArray=[u];_e.$K.$5CA(r,this.get_$AIW());var f=this,e=this,o=this;this.$Bl(function(n){var t=_e.$6P.$E(f.get_$AU());t.$5W5(n,r,function(){t.$uj(n,r,0,null)});f.set_$1u(r)},function(){n()},function(n){_e.$1g.$DN(n,function(n){t(n)})})}};_e.$bx=function(n,t,i,r){_e.$bx.initializeBase(this,[n,t]);_a.$3.$m(i,"personaId");this.$Ci=i;this.$4Y=r};_e.$bx.prototype={$Ci:null,$4Y:null,get_$Ri:function(){return"DeletePersona"},$7g4:function(n,t,i){var r=this;this.$4Y.$T3(8,new _a.$Kd,function(u){if(u)r.$s(n,t,i);else{_js.Trace.logWarning(_e.$bx.$A,"Couldn't find the persona because people module wasn't synced.");i(-1)}})},$7wm:function(n,t,i){var r=this,u=this,f=this;this.$Bl(function(n){var t=_e.$6P.$E(r.get_$AU());t.$Fu(n,r.$Ci,function(i){$5(i)?_a.$Av.$1K2(2,"PersonaId to delete is not present in persona store"):t.$II(n,i.PersonaId)},null)},function(){n()},function(n){_e.$1g.$DN(n,t)})}};_e.$IG=function(n,t,i){_e.$IG.initializeBase(this,[n,t,i,i.Body.AttachmentIds.length]);this.$9d=new Array(this.get_$AIw());this.$33=new _g.$Td;this.$33.Header=_e.$8e.$Wx;this.$33.Body.ResponseMessages=new _g.$Fy;this.$33.Body.ResponseMessages.Items=this.$9d};function $78L(n,t,i,r){var u=t;if($5(u.Attachments)){_js.Trace.logWarning(_e.$IG.$A,"Item with id {0} has no attachments in local store",u.ItemId.Id);return}var f=$78M(n,u,i);r.deletedAttachment=f;if(!f){_js.Trace.logWarning(_e.$IG.$A,"Attachment with id {0} not found on item with id {1} in local store",i,u.ItemId.Id);return}if(!u.Attachments.length){u.Attachments=undefined;u.HasAttachments=!1}}function $78M(n,t,i){for(var f=t.Attachments,e=f.length,r=0;r<e;++r){var u=f[r];if(u.AttachmentId.Id===i){Array.remove(t.Attachments,u);return u}}return null}_e.$IG.prototype={$33:null,$9d:null,get_$Ri:function(){return"DeleteAttachment"},$7g4:function(n,t,i){this.$s(n,t,i)},$7wZ:function(n,t,i,r){var f=this.get_$AHO().itemContexts[n];if(f.clientStoreItem===2){var u=new _g.$bo;u.ResponseCode="NoError";u.ResponseClass="Success";var e=f.parentItemId;u.RootItemId=new _g.$gU;u.RootItemId.RootItemId=e.Id;u.RootItemId.RootItemChangeKey=e.ChangeKey;this.$9d[n]=u;var o=this,s=this,h=this;this.$Bl(function(t){o.get_$AU().get_$4y().$1KP(t,_e.$1l.$5h(e.Id),function(t){if($5(t)){_js.Trace.logWarning(_e.$IG.$A,"Message with id {0} not found in local store",e.Id);return}$78L(o,t,o.get_$3Or().Body.AttachmentIds[n].Id,f)})},function(){t()},function(n){_e.$1g.$DN(n,i)})}else{_js.Trace.logWarning(_e.$IG.$A,"ClientStoreItem type {0} is not supported.",f.clientStoreItem);t();return}}};_e.$9j=function(n,t,i){this.$GK=0;_e.$9j.initializeBase(this,[n,t,i,i.Body.ItemIds.length])};function $78N(n,t,i,r){if(t.__type!==_g.$1t._dataContractName&&t.__type!==_g.$7b._dataContractName){n.$88=!0;n.$GK=14;i();return}var u=this,f=this,e=this;n.$Bl(function(i){if(t.__type===_g.$7b._dataContractName)n.get_$AHN().$5YN(i,t,function(t){_e.$Dt.$3k3(i,n.get_$AU().get_$mQ(),t,function(r){if(!r||!r.get_$1r()){_js.Trace.logWarning(_e.$9j.$A,"DeleteCalendarItem - Calendar master item with uid {0} could not be found in client store.",t);n.$88=!0;return}_js.Trace.logInfo(_e.$9j.$A,"DeleteCalendarItem - Calendar master item with uid {0} found in client store. Deleting it.",t);n.$AJL(_bc.$LD,i,r)})},function(){n.$88=!0});else{var u=t;var r=_e.$1l.$5h(u.Id);n.get_$AHO().isReferencedItemRecurringMaster?n.$AJK(_bc.$LD,i,r,n.get_$AU().get_$mQ()):n.$AJK(_bc.$MP,i,r,n.get_$AU().get_$1c())}},function(){if(t.__type===_g.$7b._dataContractName)_js.Trace.logInfo(_e.$9j.$A,"Successfully deleted calendar master, occurrences, exceptions and reminders with from master of occurrence with id {0} from local store.",t.OccurrenceId);else{var r=t;n.get_$AHO().isReferencedItemRecurringMaster?_js.Trace.logInfo(_e.$9j.$A,"Successfully deleted calendar master, occurrences, exceptions and reminders with from calendar master with id {0} from local store.",r.Id):_js.Trace.logInfo(_e.$9j.$A,"Successfully deleted calendar item and reminder with id {0} from local store.",r.Id)}i()},function(n){r(new _e.$1g(new _a.$Av(0,n.$3j)))})}function $78O(n,t,i,r){var u=this,f=this;n.$Bl(function(i){n.get_$4y().$3rf(i,n.get_$Jl(),n.get_$3Or().Body.DeleteType,t,_g.$28.$BJ("deleteditems"),n.get_$4Am())},function(){i()},_e.$1g.$aG(r))}_e.$9j.prototype={$88:!1,get_$Ri:function(){return"DeleteItem"},$7g4:function(n,t,i){if(this.get_$AHO().clientStoreItem){var r=this;this.$s(function(){r.$88?i(-1):n()},t,i)}else{_js.Trace.logInfo(_e.$9j.$A,"ClientStoreItem.None was passed. Request will be sent to the server.");n()}},$7wZ:function(n,t,i,r){if(this.$88){t();return}var f=this.get_$3Or().Body.ItemIds[n];if(this.get_$AHO().clientStoreItem===2){var u=f;_js.Trace.logInfo(_e.$9j.$A,"Step {0} called for delete message item with id {1}",n.toString(),u.Id);var e=this,o=this;$78O(this,u,function(){_js.Trace.logInfo(_e.$9j.$A,"Successfully deleted message with id {0} from client store.",u.Id);t()},function(n){i(n)})}else if(this.get_$AHO().clientStoreItem===1){_js.Trace.logInfo(_e.$9j.$A,"Step {0} called for deleting an calendar item",n.toString());$78N(this,f,t,i)}else{_js.Trace.logWarning(_e.$9j.$A,"ClientStoreItem {0} is not supported.",this.get_$AHO().clientStoreItem);t()}},$AJK:function(n,t,i,r){var u=this;r.$Fu(t,i,function(r){if(!r||!r.get_$1r()){_js.Trace.logWarning(_e.$9j.$A,"Calendar item (type: {0}) with id {1} could no be found in client store.",n.getName(),i);u.$88=!0;return}_js.Trace.logInfo(_e.$9j.$A,"Calendar item (type: {0}) with id {1} found in client store. Deleting it.",n.getName(),r.get_$1y());u.$AJL(n,t,r)},null)},$AJL:function(n,t,i){if(i.get_$1r().IsMeeting){_js.Trace.logInfo(_e.$9j.$A,"Offline delete calendar item with id {0} was rejected because it's a meeting. Request will go directly to the server.",i.get_$1y());this.$88=!0;this.$GK=5;return}this.get_$AHN().$3rR(t,i.get_$1y(),i.get_$1r())}};_e.$AO=function(n,t,i,r,u){this.$GK=0;this.$27F=-1;_e.$AO.initializeBase(this,[n,t,i,i.Body.FolderIds.length]);_a.$3.$m(r,"folderMappings");_a.$3.$m(u,"syncManager");this.$1i=r;this.$4Y=u};_e.$AO.$47J=function(n,t,i,r){if(t&&t.explicitLogonUser){_js.Trace.logInfo(_e.$AO.$A,"Not-supported: Offline EmptyFolder only supports primary mailbox, other mailbox calls are not supported.");i.val=307;r.val=17;return!1}if(!t.$44R){_js.Trace.logInfo(_e.$AO.$A,"Not-supported: Offline EmptyFolder currently only supports conversation view.");i.val=312;r.val=20;return!1}i.val=-1;r.val=0;return!0};_e.$AO.$83x=function(n,t){for(var i=null,u=t,e=u.length,r=0;r<e;++r){var f=u[r];if(f.FolderId.Id===n.Id){i=f;break}}return i&&!_js.$8.$a(i.LastSuccessfulSyncTime)?_a.$7.$3x(i.LastSuccessfulSyncTime):null};function $2lU(n,t,i,r){n.$27F=i;n.$GK=r;t(n.$27F)}function $78R(n,t,i,r,u){var f=this,e=this;n.$AHR(new _a.$6i("EmptyFolder.EmptyFolderInClientStore",!1),function(i){n.get_$AHO().$44R?n.get_$AU().get_$Jl().$1uq(i,_e.$RA.$3yd(t.Id,n.get_$AHO().$9h),function(){$78S(n,t,i)}):$2lU(n,u,312,20)},function(){i()},_e.$1g.$aG(r))}function $78S(n,t,i){if(n.get_$AHO().$9h==="All"||n.get_$AHO().$9h==="Clutter"){var r=this;n.get_$AU().get_$2r().$Fu(i,_e.$1l.$5h(t.Id),function(t){if(t){var r=t.get_$1r();var u=0;var f=0;if(n.get_$AHO().$9h==="Clutter"){u=r.TotalCount-r.ClutterCount;f=r.UnreadCount-r.UnreadClutterCount}r.TotalCount=u;r.UnreadCount=f;r.ClutterCount=0;r.UnreadClutterCount=0;t.$E1(i,null)}},null)}}_e.$AO.prototype={$1i:null,$4Y:null,get_$Ri:function(){return"EmptyFolder"},$7g4:function(n,t,i){var r,u,f;(f=_e.$AO.$47J(this.get_$3Or().Body,this.get_$AHO(),r={val:this.$27F},u={val:this.$GK}),this.$27F=r.val,this.$GK=u.val,f)?this.$s(n,t,i):$2lU(this,i,this.$27F,this.$GK)},$7wZ:function(n,t,i,r){var f=this.get_$AHO().$9h!=="All"?this.get_$AHO().$6hS:this.get_$3Or().Body.FolderIds[n];_a.$3.$K(f,"FolderId for current step cannot be null");var u=null;if(_g.$7N.isInstanceOfType(f)){var o=f;u=this.$1i.nameToId(o.Id)}else u=f;_a.$3.$9t(!!u,"[EmptyFolder::ExecuteCurrentStep] currentFolderId should not be null.");var e=this;this.$4Y.$1fE(4,new _bc.$IH(u),function(n,f){_js.Trace.logInfo(_e.$AO.$A,"Offline EmptyFolder only supports synced folders.");if(n){var o=_e.$AO.$83x(u,f);_js.Trace.logInfo(_e.$AO.$A,"[EmptyFolder::ExecuteCurrentStep] folderLastSyncTime = '{0}'",o?o.toString():"null");if(o){e.get_$3Or().Body.ClientLastSyncTime=o.$9L();$78R(e,u,t,i,r)}else{_js.Trace.logError(_e.$AO.$A,"[EmptyFolder::ExecuteCurrentStep] folderLastSyncTime is null for synced folder '{0}'.",u.Id);$2lU(e,r,301,19)}}else{_js.Trace.logInfo(_e.$AO.$A,"[EmptyFolder::ExecuteCurrentStep] Offline EmptyFolder service command only supports synced folders.");$2lU(e,r,301,18)}})}};_e.$AP=function(n,t,i,r){this.$K7=-1;_e.$AP.initializeBase(this,[n,t,i]);_a.$3.$K(i.Body.ParentFolderId,"ParentFolderId");_a.$3.$K(i.Body.Paging,"Paging");_a.$3.$m(r,"syncManager");this.$4Y=r;this.$33=new _g.$PY;this.$33.Header=_e.$8e.$Wx;this.$33.Body=new _g.$X8};_e.$AP.$$cctor=function(){_e.$69.$$(_g.$FV).$AHM("FindConversation")};function $78U(n,t,i,r){r.val=null;for(var f=!0,s=i,l=s.length,o=0;o<l;++o){var h=s[o];if(h.FolderId.Id===n.$2k.Id){r.val=h;break}}if(r.val)if(_g.$CC.isInstanceOfType(t.Paging)){var u=t.Paging;if(u.MaxEntriesReturned<=0||u.BasePoint!=="Beginning"||u.Offset+u.MaxEntriesReturned>r.val.SyncMinimum&&n.$s0()){_js.Trace.logInfo(_e.$AP.$A,"Non-supported IndexedPageView paging values. Offset={0}, MaxEntriesReturned={1}, BasePoint={2}, SyncMinimum={3}, IsConnected={4}",u.Offset,u.MaxEntriesReturned,u.BasePoint,r.val.SyncMinimum,n.$s0());f=!1}}else if(_g.$Ka.isInstanceOfType(t.Paging)){var e=t.Paging;if(e.MaxEntriesReturned<=0||e.MaxEntriesReturned>r.val.SyncMinimum&&n.$s0()){_js.Trace.logInfo(_e.$AP.$A,"Non-supported SeekToConditionPageView paging values. MaxEntriesReturned={0}, BasePoint={1}, SyncMinimum={2}, IsConnected={3}",e.MaxEntriesReturned,e.BasePoint,r.val.SyncMinimum,n.$s0());f=!1}else if(e.BasePoint==="Beginning"){var c=n.get_$AU().get_$Jl().$5Zi(r.val.OldestDeliveryTime);var a=_a.$7.$3x(c).$5X();var v=_a.$7.$3x(n.get_$AHO().itemLastDeliveryTime).$5X();if(v<a){_js.Trace.logInfo(_e.$AP.$A,"Requested item's last delivery time [{0}] is less than the oldest synced item's last delivery time [{1}]. Rejecting the request.",n.get_$AHO().itemLastDeliveryTime,c);f=!1}}}else{_js.Trace.logInfo(_e.$AP.$A,"Non-supported paging type. PagingType={0}",t.Paging);f=!1}else{_js.Trace.logInfo(_e.$AP.$A,"Could not find the conversation view data for the folder specified");f=!1}return f}function $78T(n,t,i,r){n.$33.Body.ResponseCode="NoError";n.$33.Body.ResponseClass="Success";n.$33.Body.Conversations=t;n.$33.Body.TotalConversationsInView=i;n.$33.Body.IndexedOffset=r}_e.$AP.prototype={$4Y:null,$33:null,$2k:null,$88:!1,get_$Ri:function(){return"FindConversation"},$7g4:function(n,t,i){var r,u;if(!(u=_g.$FV.$47J(this.get_$3Or().Body,this.get_$AHO(),r={val:this.$K7}),this.$K7=r.val,u)){_js.Trace.logInfo(_e.$AP.$A,"Not-supported: Request contains query string or view filter or explicit logon or from filter.");i(this.$K7);return}this.$2k=this.$3xl(this.get_$3Or().Body.ParentFolderId.BaseFolderId);var f=this;this.$s(function(){if(f.$88){_js.Trace.logInfo(_e.$AP.$A,"Client store unable to fulfil request. Forwarding request to the server.");i(f.$K7)}else n()},t,i)},$7wm:function(n,t,i){var r=this;this.$1fE(4,new _bc.$IH(this.$2k),function(i,u){var f=null;var e,o;if(!i||!(o=$78U(r,r.get_$3Or().Body,u,e={val:f}),f=e.val,o)){r.$88=!0;r.$K7=i?100:301;_js.Trace.logInfo(_e.$AP.$A,"Rejecting the request to the server with RejectCode {0}",_0365f.$S3.toString(r.$K7));n();return}_js.Trace.logInfo(_e.$AP.$A,"FindConversationAction is trying to use client store to get {0} rows",r.get_$3Or().Body.Paging.MaxEntriesReturned);r.get_$AU().get_$Jl().$5X0(r.$2k.Id,r.get_$3Or().Body,r.get_$AHO(),f,function(t,i,u){_js.Trace.logInfo(_e.$AP.$A,"Obtained {0} conversations from the clientstore.  MoreItemsOnServer = {1}, IsConnected = {2}",t.length,f.MoreItemsOnServer,r.$s0());var e=r.get_$3Or().Body.Paging.MaxEntriesReturned;if(t.length<e&&f.MoreItemsOnServer&&r.$s0()||!t.length&&f.MoreItemsOnServer){_js.Trace.logInfo(_e.$AP.$A,"The client store was requested {0} rows but returned only {1} AND there are more changes on the server. Hence, rejecting the request to the server.",e,t.length);r.$88=!0;r.$K7=302;n();return}_js.Trace.logInfo(_e.$AP.$A,"FindConversationAction is returning {0} rows from client store. TotalConversationsInView={1}, indexOffset={2}",t.length,f.TotalConversationsInView,u);$78T(r,t,f.TotalConversationsInView,u);n()},function(n){r.$AHQ(r.$33.Body,n,t)})})},$1fE:function(n,t,i){this.$4Y.$1fE(n,t,i)},$s0:function(){return _g.$1Y.$w.$Bv.$QD}};_e.$B0=function(n,t,i,r,u,f){_e.$B0.initializeBase(this,[n,t,i,i.Body.ParentFolderIds.length]);_a.$3.$m(r,"syncManager");_a.$3.$m(u,"folderMappings");_a.$3.$m(f,"sessionSettings");this.$4Y=r;this.$1i=u;this.$Cn=f;this.$9d=new Array(this.get_$AIw());this.$33=new _g.$RL;this.$33.Header=_e.$8e.$Wx;this.$33.Body.ResponseMessages=new _g.$Fy;this.$33.Body.ResponseMessages.Items=this.$9d};function $78X(n,t,i,r,u,f){_js.Trace.logInfo(_e.$B0.$A,"Processing FindFolder with shallow traversal for folder {0} in client store.",t);var e=this,o=this;i.$88I(t,function(i){$78V(n,t,r,u,f,i)},function(t){n.$AHQ(r,t,f)})}function $78W(n,t,i,r,u,f){_js.Trace.logInfo(_e.$B0.$A,"Processing FindFolder with deep traversal for folder {0} in client store.",t);if(n.$1i.doesIdEqualName(new _g.$3R(t),"msgfolderroot")){_js.Trace.logInfo(_e.$B0.$A,"Processing FindFolder with deep traversal for msgfolderroot in client store.");var o=this,s=this;i.$81I(function(t){var i=t[0].get_$1r();Array.removeAt(t,0);$4tz(n,r,t,i);u()},function(t){n.$AHQ(r,t,f)})}else{var e="Deep traversal is supported only for msgrootFolder. Actual folderId = "+t;_js.Trace.logError(_e.$B0.$A,e);f(new _e.$1g(new _a.$Av(1,e)))}}function $78V(n,t,i,r,u,f){var e=this,o=this,s=this;n.$Bl(function(r){n.get_$AU().get_$2r().$Fu(r,_e.$1l.$5h(t),function(r){if(!r){_js.Trace.logWarning(_a.$0.$M6,"Could not find folder with id = {0} in the ClientStore",t);return}$4tz(n,i,f,r.get_$1r())},null)},function(){r()},function(n){i.ResponseCode="ErrorDataSourceOperation";i.ResponseClass="Error";i.MessageText=n.$3j;_e.$1g.$DN(n,u)})}function $4tz(n,t,i,r){for(var f=t.RootFolder.Folders,u=0;u<i.length;++u)f[f.length]=i[u].get_$1r();t.RootFolder.ParentFolder=r}function $78Y(n,t){if(_g.$7N.isInstanceOfType(t)){var i=t;var r=i.Id;if(r==="archivemsgfolderroot"||i.Mailbox&&n.$Cn&&i.Mailbox.EmailAddress!==n.$Cn.get_$AM())return!1}else if(n.$1i.doesIdEqualName(t,"archivemsgfolderroot"))return!1;return!0}_e.$B0.prototype={$4Y:null,$1i:null,$33:null,$9d:null,$88:!1,$Cn:null,get_$Ri:function(){return"FindFolder"},$7g4:function(n,t,i){var r=this;this.$4Y.$T3(2,new _a.$Kd,function(u){if(u){var f=r.get_$3Or().Body.Traversal;if(f!=="Deep"&&f!=="Shallow"){_js.Trace.logInfo(_e.$B0.$A,"Rejecting request: FindFolder requested with unsupported traversal {0}.",f);i(-1)}else r.$s(function(){r.$88?i(-1):n()},t,i)}else i(-1)})},$7wZ:function(n,t,i,r){var f=this.get_$3Or().Body.ParentFolderIds[n];if(!$78Y(this,f)){_js.Trace.logInfo(_e.$B0.$A,"Not-supported: Request with DistinguishedFolderId.");this.$88=!0;t();return}if(_g.$7N.isInstanceOfType(f)){var s=f.Id;var e=String.format("Failed to find distinguished folder with id '{0}'",s);_js.Trace.logError(_e.$B0.$A,e);i(new _e.$1g(new _a.$Av(2,e)))}else{var o=f.Id;var u=new _g.$ca;u.ResponseCode="NoError";u.ResponseClass="Success";u.RootFolder=new _g.$cX;this.$9d[n]=u;this.get_$3Or().Body.Traversal==="Shallow"?$78X(this,o,this.get_$AU().get_$5Uf(),u,t,i):this.get_$3Or().Body.Traversal==="Deep"&&$78W(this,o,this.get_$AU().get_$5Uf(),u,t,i)}}};_e.$3K=function(n,t,i,r,u){_e.$3K.initializeBase(this,[n,t,i]);_a.$3.$m(r,"syncManager");_a.$3.$m(u,"folderMappings");this.$4Y=r;this.$1i=u;this.$33=new _g.$L8;this.$33.Header=_e.$8e.$Wx;this.$33.Body.ResponseMessages=new _g.$Fy;this.$33.Body.ResponseMessages.Items=new Array(1)};_e.$3K.$$cctor=function(){_e.$69.$$(_g.$9G).$AHM("FindItem")};_e.$3K.$5Ia=function(n,t){var r=n;var u=t;var f=r.get_$5Ax();var e=u.get_$5Ax();var i=f.$9K(e);if(i)return i;!r.get_$Ao()&&u.get_$Ao()?i=1:r.get_$Ao()&&!u.get_$Ao()&&(i=-1);if(i)return i;i=u.get_$5n6()-r.get_$5n6();return i?i:f.$2U(e)};_e.$3K.$8Uf=function(n,t,i,r){for(var e=n.length,o=e>0?n[e-1]:null,s=t.length,u=i;u<s;u++){var f=t[u];if(o&&f.get_$3hi().localeCompare(o.get_$y())<=0)_0365f.$FI.$33n(n,f,_e.$3K.$5Ia);else if(n.length<r)Array.add(n,f);else break}};function $78e(n){var r=!1;var t=_g.$9G.$5Wa(n.get_$3Or().Body);if(_g.$7N.isInstanceOfType(t)){var i=t;if($5(i.Mailbox)){n.$2k=n.$1i.nameToId(i.Id);n.$13l=i.Id;n.$2wf=!0;r=!0;_js.Trace.logInfo(_e.$3K.$A,"Converted distinguished folder id '{0}' to actual folder id '{1}'",n.$13l,n.$2k.Id)}else _js.Trace.logInfo(_e.$3K.$A,"This is a mailbox-specific call for ('{0}'). Multiple mailboxes are not supported in offline.",i.Mailbox.EmailAddress)}else if(_g.$3R.isInstanceOfType(t)){n.$2k=t;r=!0}else _js.Trace.logWarning(_e.$3K.$A,"FolderId {0} is not of a known folder type.",t);return r}function $78a(n,t,i,r){_js.Trace.logInfo(_e.$3K.$A,"FindCalendarItemsByIndex");if(n.get_$3Or().Body.Paging.MaxEntriesReturned<0)throw Error.invalidOperation("FindCalendarItemsByIndex called with a negative MaxEntriesReturned in the paging.");var f=new _e.$5h(n.get_$AU().get_$1c());var u=n.get_$3Or().Body.Paging;var e=u.Condition.$6aC;if(u.Offset){var s=_a.$6.acsa(_a.$0.$11F,"FindCalendarItemsByIndex_SeekToConditionWithOffset",!0);var l=this,a=this;f.$9ss(e,function(e){_a.$6.acea(s);n.get_$AHO().firstMatchingRowIndex=e;n.get_$AHO().loadedStartIndex=Math.max(0,e+u.Offset);var o=new _g.$CC("Beginning");o.Offset=n.get_$AHO().loadedStartIndex;o.MaxEntriesReturned=u.MaxEntriesReturned;$78c(n,t,f,o,i,r)},function(i){n.$AHQ(t,i,r)})}else{var o=_a.$6.acsa(_a.$0.$11F,"FindCalendarItemsByIndex_SeekToConditionNoOffset",!0);var h=this,c=this;f.$81B(n.$2k.Id,e,u.MaxEntriesReturned,n.get_$3Or().Body.ItemShape,function(e,s){_a.$6.acea(o);$4u1(n,t,i,r,f,e,s,u.MaxEntriesReturned)},function(i){n.$AHQ(t,i,r)})}}function $78f(n,t,i,r){if(_e.$3K.$3He&&!n.get_$AHO().isReload){i(_e.$3K.$3He);return}var u=this;t.$85Z(n.$2k.Id,n.get_$3Or().Body.ItemShape,function(t){for(var l=t.length,a=_a.$6.acss(_a.$0.$11F,"UnfoldMultidayItems_ProcessMultidayEvents_"+l),r=[],u=0,v=t.length;u<v;u++){var s=t[u];var f=s.get_$1r();var e=_a.$7.$3x(f.Start);var o=_a.$7.$3x(f.End);s.get_$5R()&&(o=o.$9v(-1));for(var h=1;e.$9K(o)<0;){e=e.$2w(1);var y=_0365f.$2d.$3g(f);var c=n.get_$AU().get_$1c().$rP(y);c.get_$1r().unfoldedIndex=h;_0365f.$FI.$33n(r,c,_e.$3K.$5Ia);h++}}_e.$3K.$3He=r;_a.$6.aces(a);i(r)},r)}function $4u1(n,t,i,r,u,f,e,o){var s=_a.$6.acsa(_a.$0.$11F,"ProcessAgendaViewItems_UnfoldMultidayItems",!0);var h=this;$78f(n,u,function(r){_a.$6.acea(s);var c=r.length;var y=_a.$6.acss(_a.$0.$11F,"ProcessAgendaViewItems_ProcessUnfoldedMultidayItems_"+c);if(e>0){var p=n.get_$AHO().loadedStartIndex;var h;n.get_$AHO().tableSize=e+c;var w=f[0];var b=w.get_$y();for(h=0;h<c;h++){var k=r[h];if(b.localeCompare(k.get_$3hi())<0)break}_e.$3K.$8Uf(f,r,h,o);var l=n.get_$3Or().Body.Paging;var d=l.Condition.$2ee;var u;var a=f.length;for(u=0;u<a;u++){var g=f[u];if(g.get_$3hi().localeCompare(d)>=0)break}u===a&&u--;n.get_$AHO().firstMatchingRowIndex=u+p+h;n.get_$AHO().loadedStartIndex=Math.max(0,n.get_$AHO().firstMatchingRowIndex+l.Offset);var v=Math.max(u+l.Offset,0);var nt=v+o;var tt=f;f=tt.slice(v,nt);_js.Trace.logInfo(_e.$3K.$A,"GetCalendarItemsByIndex will return {0} items.",f.length)}else{n.get_$AHO().firstMatchingRowIndex=0;n.get_$AHO().loadedStartIndex=0}_a.$6.aces(y);$4u3(n,t,i,f)},r)}function $78c(n,t,i,r,u,f){var e=_a.$6.acsa(_a.$0.$11F,"GetCalendarItemsByIndex",!0);var o=this,s=this;i.$81A(n.$2k.Id,r.Offset,r.MaxEntriesReturned,n.get_$3Or().Body.ItemShape,function(o,s){_a.$6.acea(e);$4u1(n,t,u,f,i,o,s,r.MaxEntriesReturned)},function(i){n.$AHQ(t,i,f)})}function $78Z(n,t,i,r){_js.Trace.logInfo(_e.$3K.$A,"FindItem for CalendarPageView is trying to fetch data from the client store");var u=n.get_$3Or().Body.Paging;var f=new _e.$5h(n.get_$AU().get_$1c());var e=_a.$6.acsa(_e.$3K.$A,"FindItem_GetCalendarView",!0);var o=this,s=this;f.$5Wk(n.$2k.Id,u.StartDate,u.EndDate,n.get_$3Or().Body.ItemShape,function(r){_a.$6.acea(e);var u=_a.$6.acss(_e.$3K.$A,"GetCalendarView_Success");$4u3(n,t,i,r);_a.$6.aces(u)},function(i){n.$AHQ(t,i,r)})}function $4u3(n,t,i,r){var f=_a.$6.acss(_e.$3K.$A,"AddingtoResponseMsg_"+r.length);t.RootFolder.Items=new Array(r.length);for(var u=0;u<r.length;u++)t.RootFolder.Items[u]=r[u].get_$1r();_a.$6.aces(f);i()}function $78b(n,t,i,r){var u=n.get_$3Or().Body.Paging.MaxEntriesReturned;_js.Trace.logInfo(_e.$3K.$A,"FindItem for folder outbox is trying to fetch {0} items from the client store",u);var f=this,e=this;n.get_$AU().get_$h5().$5YR(n.$2k.Id,n.get_$AU().get_$2r(),n.get_$3Or().Body,n.get_$AHO(),null,function(r,u,f){$4u2(n,t,r,u,f);_js.Trace.logInfo(_e.$3K.$A,"FindItemAction is returning {0} rows from client store, total count={1}, indexOffset={2}",r.length,u,f);i()},function(t){n.$AHQ(n.$33.Body.ResponseMessages.Items[0],t,r)})}function $4u0(n,t,i,r){var u=n.get_$3Or().Body.Paging.MaxEntriesReturned;_js.Trace.logInfo(_e.$3K.$A,"FindItem for folder '{0}' is trying to fetch {1} items from the client store",n.$13l,u);var f=this;n.$1fE(5,new _bc.$IH(n.$2k),function(f,e){var o=e;if(!f||!$78d(n,n.get_$3Or().Body,o)){_js.Trace.logInfo(_e.$3K.$A,"The folder is not synced in date mode or the request cannot be processed offline. Hence, rejecting the request to the server. isSynced={0}",f);n.$4Mc=!0;i();return}n.get_$AU().get_$4y().$5YR(n.$2k.Id,n.get_$AU().get_$2r(),n.get_$3Or().Body,n.get_$AHO(),o,function(r,f,e){_js.Trace.logInfo(_e.$3K.$A,"Obtained {0} messages from the clientstore.  MoreItemsOnServer = {1}, IsConnected = {2}",r.length,o.MoreItemsOnServer,n.$s0());if(r.length<u&&o.MoreItemsOnServer&&n.$s0()||!r.length&&o.MoreItemsOnServer){_js.Trace.logInfo(_e.$3K.$A,"The client store was requested {0} rows but returned only {1} AND we are CONNECTED. Hence, rejecting the request to the server.",u,r.length);n.$4Mc=!0;i();return}$4u2(n,t,r,o.TotalCount,e);_js.Trace.logInfo(_e.$3K.$A,"FindItemAction is returning {0} rows from client store",r.length);i()},function(t){n.$AHQ(n.$33.Body.ResponseMessages.Items[0],t,r)})})}function $78d(n,t,i){var r=!0;if(i)if(_g.$CC.isInstanceOfType(t.Paging)){var u=t.Paging;if(u.MaxEntriesReturned<=0||u.BasePoint!=="Beginning"||u.Offset+u.MaxEntriesReturned>i.SyncMinimum&&n.$s0()){_js.Trace.logInfo(_e.$3K.$A,"Non-supported IndexedPageView paging values. Offset={0}, MaxEntriesReturned={1}, BasePoint={2}, SyncMinimum={3}, IsConnected={4}",u.Offset,u.MaxEntriesReturned,u.BasePoint,i.SyncMinimum,n.$s0());r=!1}}else if(_g.$Ka.isInstanceOfType(t.Paging)){var f=t.Paging;if(_g.$O6.isInstanceOfType(f.Condition.Item)){if(f.MaxEntriesReturned<=0||f.MaxEntriesReturned>i.SyncMinimum&&n.$s0()){_js.Trace.logInfo(_e.$3K.$A,"Non-supported SeekToConditionPageView paging values. MaxEntriesReturned={0}, BasePoint={1}, SyncMinimum={2}, IsConnected={3}",f.MaxEntriesReturned,f.BasePoint,i.SyncMinimum,n.$s0());r=!1}else if(f.BasePoint==="Beginning"){var e=n.get_$AU().get_$4y().$5Zi(i.OldestReceivedTime);var o=_a.$7.$3x(e).$5X();var s=_a.$7.$3x(n.get_$AHO().itemReceivedTime).$5X();if(s<o){_js.Trace.logInfo(_e.$3K.$A,"Requested item's received time [{0}] is less than the oldest synced item's receivedtime [{1}]. Rejecting the request to the server.",n.get_$AHO().itemReceivedTime,e);r=!1}}}else{_js.Trace.logInfo(_e.$3K.$A,"Non-supported SeekToConditionPageView paging values. Paging type is {0}",Object.getType(f.Condition.Item));r=!1}}else{_js.Trace.logInfo(_e.$3K.$A,"Non-supported paging type. PagingType={0}",t.Paging);r=!1}else{_js.Trace.logInfo(_e.$3K.$A,"Rejecting request to the server as message sync state context for the folder '{0}' is null.",n.$2k.Id);r=!1}return r}function $4u2(n,t,i,r,u){var f=_a.$6.acss(_a.$0.$11F,"FindItem:ProcessMessages");t.RootFolder.Items=i;t.RootFolder.TotalItemsInView=r;t.RootFolder.IndexedPagingOffset=u;_a.$6.aces(f)}_e.$3K.prototype={$4Y:null,$1i:null,$33:null,$2k:null,$13l:"calendar",$2wf:!1,$4Mc:!1,get_$Ri:function(){return"FindItem"},get_$9z1:function(){return _g.$9G.$5js(this.get_$3Or().Body)},$7g4:function(n,t,i){var f=_a.$6.acsa(_a.$0.$11F,"FindItemCheckAndExecute-Preprocessing",!0);var e=this;var u=function(){e.$s(function(){e.$4Mc?i(-1):n()},t,i)};if($78e(this))if(_g.$Ks.isInstanceOfType(this.get_$3Or().Body.Paging)){var r=this.get_$3Or().Body.Paging;var s=this;this.$T3(10,new _e.$jD(this.$2k.Id,r.StartDate,r.EndDate),function(n){if(n){_a.$6.acea(f);_js.Trace.logInfo(_e.$3K.$A,"Processing the request by the offline store as the calendar module is synced.");u()}else{_js.Trace.logInfo(_e.$3K.$A,"Rejecting the call as the calendar folder is not synced OR the date range is not synced. FolderId='{0}', StartDate={1}, EndDate={2}, ",s.$2k.Id,r.StartDate,r.EndDate);i(-1)}})}else if(this.$2wf&&this.$13l==="calendar")if(_g.$JU.isInstanceOfType(this.get_$3Or().Body.Paging)){_a.$6.acea(f);_js.Trace.logInfo(_e.$3K.$A,"Processing the request by the offline store as the view is offline-only.");u()}else{var o=String.format("{0} isn't supported for calendar folders.",Object.getType(this.get_$3Or().Body.Paging));_js.Trace.logInfo(_e.$3K.$A,o);t(Error.invalidOperation(o))}else if(this.get_$9z1())u();else{_js.Trace.logInfo(_e.$3K.$A,"Rejecting the call as it is not supported in the client store");i(-1)}else{_js.Trace.logWarning(_e.$3K.$A,"Rejecting the call as parent folder id is not valid.");i(-1)}},$7wm:function(n,t,i){var r=new _g.$Pb;r.ResponseCode="NoError";r.ResponseClass="Success";r.RootFolder=new _g.$Pa;this.$33.Body.ResponseMessages.Items[0]=r;var u=this.get_$3Or().Body.Paging;if(_g.$Ks.isInstanceOfType(u))$78Z(this,r,n,t);else if(this.$2wf&&this.$13l==="calendar"&&_g.$JU.isInstanceOfType(this.get_$3Or().Body.Paging))$78a(this,r,n,t);else if(_g.$9G.$5m3(u)||_g.$9G.$5m5(u)){_js.Trace.logInfo(_e.$3K.$A,"FindItem for {0} paging is using client store",Object.getType(u));if(this.$2wf)if(this.$13l==="outbox")$78b(this,r,n,t);else if(this.$13l==="calendar")throw Error.invalidOperation("FindItem with IndexedPageView isn't supported for calendar folders.");else $4u0(this,r,n,t);else $4u0(this,r,n,t)}else{var f=String.format("FindItem called with invalid folder ID and paging. FID={0}, Paging={1}",this.$2k.Id,Object.getType(u));throw Error.invalidOperation(f);}},$T3:function(n,t,i){this.$4Y.$T3(n,t,i)},$1fE:function(n,t,i){this.$4Y.$1fE(n,t,i)},$s0:function(){return _g.$1Y.$w.$Bv.$QD}};_e.$Tq=function(n,t,i,r){_e.$Tq.initializeBase(this,[n,t,i]);_a.$3.$m(r,"syncManager");this.$4Y=r;this.$33=new _g.$Ts;this.$33.Header=_e.$8e.$Wx};_e.$Tq.$8Jv=function(n){return _g.$7N.isInstanceOfType(n)&&n.Id==="directory"};function $4u4(n,t,i,r,u){var f=this,e=this;t.$3kJ(i.Offset,i.MaxEntriesReturned,n.$2k,n.get_$3Or().Body.SortOrder,function(t,u){n.$33.Body.ResponseCode="NoError";n.$33.Body.ResponseClass="Success";n.$33.Body.ResultSet=t;n.$33.Body.TotalNumberOfPeopleInView=u;n.$33.Body.FirstLoadedRowIndex=i.Offset;r()},function(t){n.$33.Body.ResponseCode="ErrorDataSourceOperation";n.$33.Body.ResponseClass="Error";n.$33.Body.MessageText=t.get_$4y();u(t)})}_e.$Tq.prototype={$4Y:null,$33:null,$2k:null,get_$Ri:function(){return"FindPeople"},$7g4:function(n,t,i){var r=this.get_$3Or().Body.ParentFolderId?this.get_$3Or().Body.ParentFolderId.BaseFolderId:null;var f=_g.$3R.isInstanceOfType(r);if(!_js.$8.$a(this.get_$3Or().Body.QueryString)||this.get_$3Or().Body.Restriction||this.get_$3Or().Body.AggregationRestriction||!f||_e.$Tq.$8Jv(r)||_g.$9G.$46j(r))i(-1);else{var u=this;this.$4Y.$T3(8,new _a.$Kd,function(f){if(f)if(_g.$7N.isInstanceOfType(r))_a.$3.$9t(!1,"FindPeople is not supported with DistinguishedFolderId as ParentFolderId, offending Folder Id: "+r.Id);else{u.$2k=r;u.$s(n,t,i)}else i(-1)})}},$7wm:function(n,t,i){_a.$3.$85(this.get_$3Or().Body.SortOrder.length,1,2,"expecting 1 - 2 sort columns");_a.$3.$9t(_g.$CC.isInstanceOfType(this.get_$3Or().Body.IndexedPageItemView)||_g.$JU.isInstanceOfType(this.get_$3Or().Body.IndexedPageItemView),"Browse People only support IndexedPageView or SeekToConditionWithOffsetPageView.");var r=_e.$6P.$E(this.get_$AU());if(_g.$CC.isInstanceOfType(this.get_$3Or().Body.IndexedPageItemView)){var o=this.get_$3Or().Body.IndexedPageItemView;$4u4(this,r,o,n,t);return}var s=_a.$6.acsa(_a.$0.$AC,"FindPeople.SeekToCondition",!0);var u=this.get_$3Or().Body.IndexedPageItemView;var e=this,f=this;r.$9sq(u.Condition,this.$2k,this.get_$3Or().Body.SortOrder,function(i){_a.$6.acea(s);e.$33.Body.FirstMatchingRowIndex=i;var f=new _g.$CC("Beginning");f.Offset=Math.max(0,i+u.Offset);f.MaxEntriesReturned=u.MaxEntriesReturned;$4u4(e,r,f,n,t)},function(n){f.$33.Body.ResponseCode="ErrorDataSourceOperation";f.$33.Body.ResponseClass="Error";f.$33.Body.MessageText=n.get_$4y();t(n)})}};_e.$Ph=function(n,t,i,r){this.$K7=-1;_e.$Ph.initializeBase(this,[n,t,i,i.Body.FolderIds.length]);this.$4Y=r;this.$9d=new Array(this.get_$AIw());this.$33=new _g.$U2;this.$33.Header=_e.$8e.$Wx;this.$33.Body.ResponseMessages=new _g.$Fy;this.$33.Body.ResponseMessages.Items=this.$9d};_e.$Ph.prototype={$4Y:null,$33:null,$9d:null,$88:!1,get_$Ri:function(){return"GetFolder"},$7g4:function(n,t,i){var r=this;this.$4Y.$T3(2,new _a.$Kd,function(u){u?r.$s(function(){r.$88?i(r.$K7):n()},t,i):i(301)})},$7wZ:function(n,t,i,r){var e=this.get_$3Or().Body.FolderIds[n];var u=new _g.$cj;u.ResponseCode="NoError";u.ResponseClass="Success";u.Folders=new Array(0);this.$9d[n]=u;var o=u.Folders;if(_g.$7N.isInstanceOfType(e)){var f=e;if(f.Id==="archivemsgfolderroot"){this.$88=!0;this.$K7=100;t()}else if(f.Mailbox){_js.Trace.logInfo(_e.$Ph.$A,"This is a mailbox-specific call for ('{0}'). Multiple mailboxes are not supported in offline.",f.Mailbox.EmailAddress);this.$88=!0;this.$K7=100;t()}else{var h=this,c=this;_e.$8H.$1cZ(this.get_$AU().get_$2r(),f.Id,function(n){if(n)o[o.length]=n.get_$1r();else{_js.Trace.logWarning(_e.$Ph.$A,"Could not find folder with DistinguishedFolderId = {0} in the ClientStore",f.Id);var i=new _g.$EN;i.DisplayName=_e.$8H.$4N1}t()},function(n){u.ResponseCode="ErrorDataSourceOperation";u.ResponseClass="Error";u.MessageText=n.get_$4y();i(n)})}}else{var s=this,l=this,a=this;this.$Bl(function(n){s.get_$AU().get_$2r().$Fu(n,_e.$1l.$5h(e.Id),function(n){if(n)o[o.length]=n.get_$1r();else{_js.Trace.logInfo(_e.$Ph.$A,"Could not find folder with id = {0} in the ClientStore - rejecting command.",e.Id);s.$88=!0;s.$K7=302}},null)},function(){t()},function(n){u.ResponseCode="ErrorDataSourceOperation";u.ResponseClass="Error";u.MessageText=n.$3j;_e.$1g.$DN(n,i)})}}};_e.$Tz=function(n,t,i){_e.$Tz.initializeBase(this,[n,t]);_a.$3.$m(i,"syncManager");this.$4Y=i;this.$33=null};_e.$Tz.prototype={$4Y:null,$33:null,get_$Ri:function(){return"GetCalendarFolders"},$7g4:function(n,t,i){var r=this;this.$4Y.$T3(9,new _a.$Kd,function(u){if(u){_js.Trace.logInfo(_e.$Tz.$A,"Executing offline GetCalendarFolders command.");r.$s(n,t,i)}else{_js.Trace.logInfo(_e.$Tz.$A,"Offline GetCalendarFolders command rejected.");i(301)}})},$7wm:function(n,t,i){var r=this;this.get_$4am().$1xF(function(t){r.$33=t;n()},t)}};_e.$AR=function(n,t,i){this.$K7=-1;this.$48W={};_e.$AR.initializeBase(this,[n,t,i]);_a.$3.$K(n.lastModifiedTimeDictionary,"lastModifiedTimeDictionary");this.$33=new _g.$RP;this.$33.Header=_e.$8e.$Wx;this.$33.Body.ResponseMessages=new _g.$Fy};_e.$AR.$$cctor=function(){_e.$69.$$(_g.$kH).$AHM("GetConversationItems")};function $78h(n,t){for(var e=n.$2K2.get_$1r().ConversationId.Id,u=n.$2K2.get_$1r().ConversationNodes,o=u.length,i=0;i<o;++i)for(var f=u[i],r=0;r<f.Items.length;r++){var s=f.Items[r];n.$3W7++;var h=this;n.get_$AU().get_$4y().$Fu(t,_e.$1l.$5h(s.ItemId.Id),function(t){if(t&&_e.$By.$7i6(t.get_$1r(),0)){_js.Trace.logInfo(_e.$AR.$A,"Adding item with id '{0}' to the dictionary for conversation with id '{1}'",t.get_$1r().ItemId.Id,e);n.$48W[t.get_$1r().ItemId.Id]=t.get_$1r();n.$4gk++}},null)}}function $78i(n){for(var u=n.$2K2.get_$1r().ConversationNodes,f=u.length,i=0;i<f;++i)for(var r=u[i],t=0;t<r.Items.length;t++){var e=n.$48W[r.Items[t].ItemId.Id];r.Items[t]=e}}function $78g(n,t){n.$33.Body.ResponseMessages.Items=new Array(t.length);for(var i=0;i<t.length;i++){var r=new _g.$d4;r.ResponseCode="NoError";r.ResponseClass="Success";r.Conversation=t[i].get_$1r();n.$33.Body.ResponseMessages.Items[i]=r}}function $78j(n,t){for(var u=t,o=u.length,r=0;r<o;++r){var i=u[r];var f=n.get_$AHO().lastModifiedTimeDictionary[i.get_$1r().ConversationId.Id];var e=_a.$7.$3x(i.get_$1r().LastModifiedTime).$5X();if(e<f){_js.Trace.logInfo(_e.$AR.$A,"LastModifiedTime does not match for conversation with id {0}, client store item value = {1}:{2}, requested value = {3}",i.get_$1r().ConversationId.Id,i.get_$1r().LastModifiedTime,e,f);return!0}}return!1}_e.$AR.prototype={$33:null,$88:!1,$3W7:0,$4gk:0,$2K2:null,get_$Ri:function(){return"GetConversationItems"},$7g4:function(n,t,i){var r=this.get_$AHO().currentUserOptionsSortOrder;if($5(r)||r===this.get_$3Or().Body.SortOrder)if($5(this.get_$AHO().currentUserOptionsIgnoringDeletedItems)||this.get_$AHO().currentUserOptionsIgnoringDeletedItems===this.get_$AHO().requestIgnoringDeleteditems)if(this.get_$3Or().Body.MaxItemsToReturn<=20){var u=this;this.$s(function(){if(u.$88){_js.Trace.logInfo(_e.$AR.$A,"Client store unable to fulfil request. Forwarding request to the server.");i(u.$K7)}else n()},t,i)}else{_js.Trace.logInfo(_e.$AR.$A,"{0} requested item parts is greater than {1} itemparts supported by the clientstore. Hence, rejecting the request",this.get_$3Or().Body.MaxItemsToReturn,20);i(100)}else{_js.Trace.logInfo(_e.$AR.$A,"Request specified a Hide Deleted Items option of {0} while the current UserOptions has Hided Deleted Items set to {1}, rejecting the request",this.get_$AHO().requestIgnoringDeleteditems,this.get_$AHO().currentUserOptionsIgnoringDeletedItems);i(304)}else{_js.Trace.logInfo(_e.$AR.$A,"Request specified SortOrder of {0} while the current UserOptions has set SortOrder to {1}, rejecting the request",this.get_$3Or().Body.SortOrder,r);i(304)}},$7wm:function(n,t,i){var e=this.get_$3Or().Body.Conversations;_a.$3.$85(e.length,1,1,"Invalid number of conversations requested. Number = "+e.length);var o=new _e.$l6(_a.$74.$E());if(o.get_$7v2()){_js.Trace.logInfo(_e.$AR.$A,"Offline email data is outdated, forwarding request to the server.");this.$88=!0;this.$K7=301;n()}else{var f=_e.$1l.$5h(e[0].ConversationId.Id);var u=this,r=this,s=this;this.$Bl(function(n){u.get_$AU().get_$Hi().$Fu(n,f,function(t){u.$2K2=t;if(t&&!$78j(u,[t]))$78h(u,n);else{u.$88=!0;u.$K7=t?306:305;_js.Trace.logInfo(_e.$AR.$A,"id '{0}' rejectCode: {1}, forwarding request to the server",f,_0365f.$S3.toString(u.$K7))}},null)},function(){if(!r.$88&&r.$3W7>0&&r.$3W7===r.$4gk){_js.Trace.logInfo(_e.$AR.$A,"All items found for conversation with id '{0}'. Providing data to the caller",f);$78i(r);$78g(r,[r.$2K2]);n()}else{_js.Trace.logInfo(_e.$AR.$A,"Couldn't find all items for conversation with id '{0}', forwarding request to the server. Total items requested = {1}, total items found = {2}",f,r.$3W7,r.$4gk);r.$88=!0;r.$K7=302;n()}},function(n){t(new _e.$1g(new _a.$Av(0,n.$3j)))})}}};_e.$pw=function(n,t,i){_e.$pw.initializeBase(this,[n,t]);_a.$3.$m(i,"syncManager");this.$4Y=i;this.$33=null};_e.$pw.prototype={$4Y:null,$33:null,get_$Ri:function(){return"GetFavoriteFolders"},$7g4:function(n,t,i){var r=this;this.$4Y.$T3(6,new _a.$Kd,function(u){u?r.$s(n,t,i):i(301)})},$7wm:function(n,t,i){var r=this;this.get_$4am().$2zx(function(t){r.$33=t;n()},t)}};_e.$6e=function(n,t,i){this.$K7=-1;this.$GK=0;_e.$6e.initializeBase(this,[n,t,i,i.Body.ItemIds.length]);this.$9d=new Array(this.get_$AIw());this.$33=new _g.$RQ;this.$33.Header=_e.$8e.$Wx;this.$33.Body.ResponseMessages=new _g.$Fy;this.$33.Body.ResponseMessages.Items=this.$9d};_e.$6e.$$cctor=function(){_e.$69.$$(_g.$XV).$AHM("GetItem")};function $78m(n,t,i){return _bc.$MS.isInstanceOfType(t)?$78n(n,t,i):_bc.$MP.isInstanceOfType(t)?$78k(n,t,i):_bc.$LD.isInstanceOfType(t)?$78l(n,t,i):!0}function $78o(n,t,i,r,u){var f=null;var e=null;var o=this,s=this,h=this;n.$Bl(function(i){n.get_$AU().get_$1c().$Fu(i,_e.$1l.$5h(t.OccurrenceId),function(r){if(r&&r.get_$1r()){f=r.get_$19u();_e.$Dt.$3k3(i,n.get_$AU().get_$mQ(),f,function(n){e=n})}else _js.Trace.logInfo(_e.$6e.$A,"GetCalendarItem: Occurrence with id {0} not found in local store",t.OccurrenceId)},null)},function(){if(f)$3c0(n,f,e,i,r);else{n.$88=!0;n.$K7=302;r()}},function(t){_e.$1g.$DN(t,function(t){n.$AHQ(i,t,u)})})}function $3c0(n,t,i,r,u){var f=_a.$6.acss(_a.$0.$30E,"CheckAndReturnItemFromClientStore");r.ResponseCode="NoError";r.ResponseClass="Success";r.Items=new Array(0);var e=r.Items;if(i&&i.get_$4i0())if($78m(n,i,n.get_$3Or().Body.ItemShape)){_js.Trace.logInfo(_e.$6e.$A,"Item {0} retrieved for local store satisfies request.",i.get_$1y());e[0]=i.get_$4i0()}else{_js.Trace.logWarning(_e.$6e.$A,"Item {0} retrieved for local store does not satisfy request.",i.get_$1y());n.$88=!0;n.$K7=303}else{_js.Trace.logInfo(_e.$6e.$A,"Item with id {0} not found in local store",t);n.$88=!0;n.$K7=302}u();_a.$6.aces(f)}function $78n(n,t,i){var r=t.get_$1r();var u=!1;if(n.get_$AHO().requireNormalizedBody&&!t.get_$1r().NormalizedBody){_js.Trace.logInfo(_e.$6e.$A,"Item with id {0} does not contain the NormalizedBody shape. So rejecting to server.",t.get_$1y());n.$88=!0;n.$K7=303}else if(i.BodyType){if(r.Body)if(r.Body.BodyType==="HTML"&&i.BodyType==="HTML"||r.Body.BodyType==="Text"&&i.BodyType==="Text"){_js.Trace.logInfo(_e.$6e.$A,"Message body type matches response shape body type. ItemId: {0} body type: {1}",r.ItemId.Id,r.Body.BodyType);u=!0}else _js.Trace.logInfo(_e.$6e.$A,"Message body type doesn't match response shape body type. ItemId: {0}  Message body type: {1}  Response shape body type: {2}",r.ItemId.Id,r.Body.BodyType,i.BodyType);else if(_e.$19.$21P(r.__type)){var f=t.get_$1r();if(f.NewBodyContent){_js.Trace.logInfo(_e.$6e.$A,"Item is a SmartResponse. ItemId: {0}",r.ItemId.Id);u=!0}else throw Error.invalidOperation(String.format("SmartResponse.NewBodyContent is undefined. ItemId: {0}",r.ItemId.Id));}}else u=!0;return u}function $78k(n,t,i){return $4u6(n,t.get_$1r(),i)}function $78l(n,t,i){return $4u6(n,t.get_$1r(),i)}function $4u6(n,t,i){if(i.BodyType==="Text"){t.TextBody||(t.TextBody=new _g.$6b("Text",t.Preview));t.Body=t.TextBody}if(t.Body.IsTruncated){_js.Trace.logWarning(_a.$0.$6y,"Truncated body type {0} on item with id {1}. Rejecting call.",t.Body.BodyType,t.ItemId.Id);n.$GK=16;return!1}t.TextBody=undefined;return!0}_e.$6e.prototype={$33:null,$9d:null,$88:!1,get_$Ri:function(){return"GetItem"},$7g4:function(n,t,i){if(this.get_$AHO().clientStoreItem){var r=this;this.$s(function(){r.$88?i(r.$K7):n()},t,i)}else{_js.Trace.logInfo(_e.$6e.$A,"ClientStoreItem.None was passed. Request will be sent to the server.");i(100)}},$7wZ:function(n,t,i,r){if(this.$88){t();return}var u=new _g.$YL;this.$9d[n]=u;var f=this.get_$3Or().Body.ItemIds[n];if(this.get_$AHO().clientStoreItem===2)this.$AJH(_bc.$MS,f,u,this.get_$AU().get_$4y(),t,i);else if(this.get_$AHO().clientStoreItem===3)this.$AJH(_bc.$19n,f,u,this.get_$AU().get_$h5(),t,i);else if(this.get_$AHO().clientStoreItem===1)if(f.__type===_g.$7b._dataContractName){var c=f;$78o(this,c,u,t,i)}else if(f.__type===_g.$VK._dataContractName){_js.Trace.logInfo(_e.$6e.$A,"GetCalendarItem: RecurringMasterItemIdRanges isn't supported on offline getitem service command. Rejecting call.");this.$88=!0;this.$K7=100;t()}else{var o=null;var s=f;var e=_e.$1l.$5h(s.Id);var h=this,l=this,a=this;this.$Bl(function(n){_js.Trace.logInfo(_e.$6e.$A,"GetCalendarItem: Trying to find item with Id {0} in CalendarItem table",e);h.get_$AU().get_$1c().$Fu(n,e,function(t){if($5(t)||$5(t.get_$1r())){_js.Trace.logInfo(_e.$6e.$A,"GetCalendarItem: Trying to find item with Id {0} in CalendarRecurrenceMaster table",e);h.get_$AU().get_$mQ().$Fu(n,e,function(n){o=n},null)}else o=t},null)},function(){$3c0(l,s.Id,o,u,t)},function(n){_e.$1g.$DN(n,function(n){a.$AHQ(u,n,i)})})}else{this.$88=!0;this.$K7=100;t()}},$AJH:function(n,t,i,r,u,f){var e=t;_js.Trace.logInfo(_e.$6e.$A,"GetItem called for id {1}",e.Id);var o=n===Number||Type.isEnum(n)?0:n===Boolean?!1:null;var c=this,s=this,h=this;this.$Bl(function(n){r.$1oq(n,_e.$1l.$5h(e.Id),function(n){o=n},null)},function(){$3c0(s,e.Id,o,i,u)},function(n){_js.Trace.logInfo(_e.$6e.$A,"GetItem. Reporting store error {0}. id {1}",n.$3j,e.Id);h.$AHQ(i,new _e.$1g(n),f)})}};_e.$Pl=function(n,t){_e.$Pl.initializeBase(this,[n,t])};_e.$Pl.prototype={$b:null,get_$Ri:function(){return"GetOwaUserConfiguration"},$7g4:function(n,t,i){var r=this,u=this;this.get_$4am().$rU(function(u){r.$b=u;if(r.$b)r.$s(n,t,i);else{_js.Trace.logInfo(_e.$Pl.$A,"GetOwaUserconfiguration: Invoking rejected callback.");i(301)}},function(n){_js.Trace.logInfo(_e.$Pl.$A,"GetOwaUserconfiguration: Failed to load : {0}",n.get_$4y());t(Error.create(n.get_$4y()))})},$7wm:function(n,t,i){if(this.$b)n();else{_js.Trace.logInfo(_e.$Pl.$A,"GetOwaUserconfiguration: Invoking rejected callback.");i(301)}}};_e.$q3=function(n,t,i){_e.$q3.initializeBase(this,[n,t]);_a.$3.$m(i,"syncManager");this.$4Y=i;this.$33=null};_e.$q3.prototype={$4Y:null,$33:null,get_$Ri:function(){return"GetOtherMailboxConfiguration"},$7g4:function(n,t,i){var r=this;this.$4Y.$T3(13,new _a.$Kd,function(u){u?r.$s(n,t,i):i(301)})},$7wm:function(n,t,i){var r=this;this.get_$4am().$14g(function(t){r.$33=t;n()},t)}};_e.$17f=function(n,t,i){_e.$17f.initializeBase(this,[n,t]);_a.$3.$m(i,"syncManager");this.$4Y=i};_e.$17f.prototype={$4Y:null,$Ck:null,get_$Ri:function(){return"GetPeopleFilters"},$7g4:function(n,t,i){var r=this;this.$4Y.$T3(7,new _a.$Kd,function(u){u?r.$s(n,t,i):i(301)})},$7wm:function(n,t,i){var r=this,u=this;_e.$H9.$1cw(this.get_$AU().get_$4SK(),function(t){r.$Ck=new Array(t.length);for(var i=0;i<t.length;++i)r.$Ck[i]=t[i].get_$1r();n()},function(n){t(n)})}};_e.$17h=function(n,t,i,r){_e.$17h.initializeBase(this,[n,t,i]);_a.$3.$m(r,"syncManager");this.$4Y=r;this.$33=new _g.$U3;this.$33.Header=_e.$8e.$Wx};_e.$17h.prototype={$4Y:null,$33:null,$3vE:!1,get_$Ri:function(){return"GetPersona"},$7g4:function(n,t,i){if(this.get_$3Or().Body.EmailAddress){i(100);return}if(this.get_$AHO().hasGALComponent){this.$3vE=!0;i(303);return}_a.$3.$m(this.get_$3Or().Body.PersonaId,"PersonaId");_a.$3.$m(this.get_$3Or().Body.PersonaId.Id,"PersonaId.Id");var r=this;this.$4Y.$T3(8,new _a.$Kd,function(u){u?r.$s(function(){if(r.$33.Body.Persona)if(r.$33.Body.Persona.ADObjectId){r.$3vE=!0;i(303)}else n();else i(302)},t,i):i(301)})},$7wm:function(n,t,i){var r=this,f=this,u=this;this.$Bl(function(n){var t=_e.$6P.$E(r.get_$AU());t.$Fu(n,r.get_$3Or().Body.PersonaId,function(n){if(n){r.$33.Body.ResponseCode="NoError";r.$33.Body.ResponseClass="Success";r.$33.Body.Persona=n}else{r.$33.Body.ResponseCode="ErrorItemNotFound";r.$33.Body.ResponseClass="Error"}},null)},function(){n()},function(n){_e.$1g.$DN(n,function(n){u.$AHQ(u.$33.Body,n,t)})})}};_e.$Mn=function(n,t,i){this.$GK=0;_e.$Mn.initializeBase(this,[n,t,i,i.Body.ItemIds.length])};function $79L(n,t,i,r){var u=this,f=this;n.$Bl(function(i){n.get_$4y().$3rf(i,n.get_$Jl(),"HardDelete",t,null,n.get_$4Am())},function(){i()},_e.$1g.$aG(r))}_e.$Mn.prototype={$88:!1,get_$Ri:function(){return"MoveItem"},$7g4:function(n,t,i){if(this.get_$AHO().clientStoreItem===2){var r=this;this.$s(function(){r.$88?i(-1):n()},t,i)}else{_js.Trace.logInfo(_e.$Mn.$A,"ClientStoreItem.{0} was passed. Request will be sent to the server.",this.get_$AHO().clientStoreItem);i(-1)}},$7wZ:function(n,t,i,r){if(this.$88){t();return}var f=this.get_$3Or().Body.ItemIds[n];if(!_g.$1t.isInstanceOfType(f)){this.$88=!0;this.$GK=12;t();return}var u=f;_js.Trace.logInfo(_e.$Mn.$A,"Step {0} called for id {1}",n.toString(),u.Id);var e=this,o=this;$79L(this,u,function(){_js.Trace.logInfo(_e.$Mn.$A,"Successfully deleted message with id {0} from client store.",u.Id);t()},function(n){i(n)})}};_e.$fB=function(n,t,i,r){this.$$d_$2xy=Function.createDelegate(this,this.$2xy);this.$AS=-1;this.$6l9="";_e.$fB.$$(this.$$gta["_e.$fB"].TRequest,this.$$gta["_e.$fB"].TActionContext).initializeBase(this,[n,t,i]);this.$4da=r};_e.$fB.$$=function(n,t){var i="$fB"+"$2"+"$"+n.getName().replace(/\./g,"_")+"$"+t.getName().replace(/\./g,"_");if(!_e[i]){var u=_e[i]=function(){(this.$$gta=this.$$gta||{})["_e.$fB"]={TRequest:n,TActionContext:t};for(var r=[],i=0;i<arguments.length;++i)r[i]=arguments[i];_e.$fB.apply(this,r)};u.registerClass("_e."+i,_e.$af.$$(n,t));var f=_e.$fB.prototype;for(var e in f){var r={key:e,value:f[e]};"constructor"!==r.key&&(u.prototype[r.key]=r.value)}}return _e[i]};_e.$fB.prototype={$4da:0,$5SX:null,$5SV:null,$5SW:null,get_$AIw:function(){return this.$4da},$7wm:function(n,t,i){this.$5SX=n;this.$5SV=t;this.$5SW=i;this.$2xy()},$AIx:function(n){_a.$3.$K(n,"itemId");this.$6l9="ItemId ="+JsonParser.serialize(n)},$2xy:function(){this.$AS++;this.$AS===this.$4da?this.$5SX():this.$7wZ(this.$AS,this.$$d_$2xy,this.$5SV,this.$5SW)}};_e.$8O=function(n,t,i,r){_e.$8O.initializeBase(this,[n,t,i]);_a.$3.$m(r,"syncManager");this.$4Y=r;this.$33=new _g.$OU;this.$33.Header=_e.$8e.$Wx};function $79M(n,t,i){var r=n.get_$AU().get_$Iq();var u=this;r.$Fu(t,_e.$1l.$5h(i.Id),function(u){if(!u||!u.get_$1r()){_js.Trace.logWarning(_e.$8O.$A,"PerformReminderAction-Dismiss: Reminder item with id {0} could no be found in client store.",i);return}_js.Trace.logInfo(_e.$8O.$A,"PerformReminderAction-Dismiss: Reminder item with id {0} found in client store. Dismissing it.",u.get_$1y());r.$II(t,u.get_$1y());_js.Trace.logInfo(_e.$8O.$A,"PerformReminderAction-Dismiss: Successfully deleted (dismissed) reminder item with id {0} from client store.",u.get_$1y());$79O(n,t,i,u.get_$1r())},null)}function $79O(n,t,i,r){var u=this;n.get_$AU().get_$1c().$1KP(t,_e.$1l.$5h(i.Id),function(n){if($5(n)){var u=String.format("PerformReminderAction-Dismiss: Calendar item with id {0} not found in local store. Calendar item couldn't be updated for reminder with Subject:{1}, Reminder Time: {2}, Start date:{3}, End date {4}.",i.Id,r.Subject,r.ReminderTime.toString(),r.StartDate.toString(),r.EndDate.toString());_js.Trace.logWarning(_e.$8O.$A,u);return}var t=n;t.ReminderIsSet=!1;_js.Trace.logInfo(_e.$8O.$A,"PerformReminderAction-Dismiss: Successfully updated calendar item with id {0} from client store.",t.ItemId.Id)})}function $79N(n,t,i,r){var u=this;n.get_$AU().get_$Iq().$1KP(t,_e.$1l.$5h(i.Id),function(n){if($5(n)){_js.Trace.logWarning(_e.$8O.$A,"PerformReminderAction-Snooze: Reminder item with id {0} not found in local store",i.Id);return}var t=n;t.ReminderTime=_a.$7.$aV(r);_js.Trace.logInfo(_e.$8O.$A,"PerformReminderAction-Snooze: Successfully updated (snooze) reminder item with id {0} from client store.",t.ItemId.Id)})}_e.$8O.prototype={$4Y:null,$33:null,get_$Ri:function(){return"PerformReminderAction"},$7g4:function(n,t,i){var r=this;this.$4Y.$T3(3,new _a.$Kd,function(u){if(u)r.$s(n,t,i);else{_js.Trace.logInfo(_e.$8O.$A,"PerformReminderAction: Rejecting the call as the reminder module is not synced");i(-1)}})},$7wm:function(n,t,i){var r=this,u=this,f=this;this.$Bl(function(n){for(var u=r.get_$3Or().Body.ReminderItemActions,e=u.length,i=0;i<e;++i){var t=u[i];var f=t.ItemId;if(t.ActionType)if(t.ActionType===1){var o=_a.$7.$3x(t.NewReminderTime);$79N(r,n,f,o)}else throw Error.argument("ActionType",String.format("Reminder Action Type not supported {0}",_g.$10r.toString(t.ActionType)));else $79M(r,n,f)}},function(){_js.Trace.logInfo(_e.$8O.$A,"PerformReminderAction: Successfully performed reminder actions to local store.");u.$33.Body.ResponseCode="NoError";u.$33.Body.ResponseClass="Success";n()},function(n){_js.Trace.logError(_e.$8O.$A,"PerformReminderAction: Failed to perform reminder actions to local store.");var i=new _e.$1g(new _a.$Av(0,n.$3j));f.$AHQ(f.$33.Body,i,t)})}};_e.$8e=function(){};_e.$8e.$$cctor=function(){_e.$8e.$Wx=new _g.$eI;_e.$8e.$Wx.ServerVersionInfo=new _g.$gi;_e.$8e.$Wx.ServerVersionInfo.Version="Exchange2013"};_e.$69=function(n,t){_a.$3.$K(n,"actionContext");_a.$3.$K(t.get_$AU(),"serviceCommandContext.ItemStoreGetter");_a.$3.$1G(t.get_$E6(),"serviceCommandContext.TimeZone");this.$OE=n;this.$6c7=t;this.$9B=t.get_$AU()};_e.$69.$$=function(n){var i="$69"+"$1"+"$"+n.getName().replace(/\./g,"_");if(!_e[i]){var t=_e[i]=function(){(this.$$gta=this.$$gta||{})["_e.$69"]={TActionContext:n};for(var i=[],t=0;t<arguments.length;++t)i[t]=arguments[t];_e.$69.apply(this,i)};t.registerClass("_e."+i);var u=_e.$69.prototype;for(var f in u){var r={key:f,value:u[f]};"constructor"!==r.key&&(t.prototype[r.key]=r.value)}t.$AHM=function(n){_a.$3.$9t(!t.$Zf[0][n],"PerfCounter for "+n+" already exists");var r=new _a.$9u("Svc","BHits",4,!1,n);t.$Zf[0][n]=r;var i=new _a.$9u("Svc","SHits",2,!1,n);i.set_$1kY(r);t.$Zf[1][n]=i;i=new _a.$9u("Svc","FHits",2,!1,n);i.set_$1kY(r);t.$Zf[2][n]=i;i=new _a.$9u("Svc","RHits",2,!1,n);i.set_$1kY(r);t.$Zf[3][n]=i};t.$33J=function(n,t){var i=t[n];i&&i.$155()};t.$Zf=new Array(4);t.$$cctor=function(){for(var n=0;n<4;n++)t.$Zf[n]={}};t.$$cctor()}return _e[i]};_e.$69.prototype={$OE:null,$6c7:null,$2VW:null,$2tX:null,$3kw:null,$Fj:null,$9B:null,$3Ot:null,$2vx:null,get_$4y:function(){this.$2VW||(this.$2VW=new _e.$lO(this.$9B));return this.$2VW},get_$Jl:function(){this.$2tX||(this.$2tX=new _e.$C9(this.$9B));return this.$2tX},get_$AHN:function(){this.$3kw||(this.$3kw=new _e.$AL(this.$9B));return this.$3kw},get_$AHO:function(){return this.$OE},get_$7s2:function(){return this.$2vx},set_$7s2:function(n){this.$3Ot&&(this.$3Ot.$1v8=n);this.$2vx=n;return n},get_$4am:function(){this.$Fj||(this.$Fj=new _e.$AE(this.$9B));return this.$Fj},get_$AU:function(){return this.$9B},get_$4Am:function(){return _g.$1Y.$w},$AHP:function(n,t,i){var o=_g.$3U.$3yx(this.$OE);this.$3Ot=OwaApplication.get_$1Ux().$6Wu(this.get_$Ri(),!0,o);_e.$69.$$(this.$$gta["_e.$69"].TActionContext).$33J(this.get_$Ri(),_e.$69.$$(this.$$gta["_e.$69"].TActionContext).$Zf[0]);if(this.$6c7.get_$8Mq()){var f=null;var s=_a.$6.ads(_a.$0.$Eh,"OfflineInvoke_"+this.get_$Ri());var u=this,r=this,e=this;this.$7g4(function(){_a.$6.are(f);var t=_a.$6.aes(_a.$0.$Eh,"OfflineResponse_"+u.get_$Ri());try{u.$3nF(200);n()}finally{_e.$69.$$(u.$$gta["_e.$69"].TActionContext).$33J(u.get_$Ri(),_e.$69.$$(u.$$gta["_e.$69"].TActionContext).$Zf[1]);_a.$6.aee(t)}},function(n){_a.$6.are(f);var i=_a.$6.aes(_a.$0.$Eh,"OfflineResponseFailed_"+r.get_$Ri());try{r.set_$7s2(n.message);r.$3nF(500);t(n)}finally{_e.$69.$$(r.$$gta["_e.$69"].TActionContext).$33J(r.get_$Ri(),_e.$69.$$(r.$$gta["_e.$69"].TActionContext).$Zf[2]);_a.$6.aee(i)}},function(n){_a.$6.are(f);var t=_a.$6.aes(_a.$0.$Eh,"OfflineResponseRejected_"+e.get_$Ri()+"_"+_0365f.$S3.toString(n));try{e.$6VX(n,i)}finally{_a.$6.aee(t)}});_a.$6.ade(s);f=_a.$6.ars(_a.$0.$Eh,"OfflineRequest_"+this.get_$Ri())}else{var h=_a.$6.ads(_a.$0.$Eh,"CommandRejected_"+this.get_$Ri());_js.Trace.logWarning(_a.$0.$M6,"The offline component is not ready to use yet. {0} is rejected.",this.get_$Ri());this.$6VX(1,i);_a.$6.ade(h)}},$s:function(n,t,i){var r=this;this.$7wm(n,function(n){t(n.$Sd())},i)},$AHQ:function(n,t,i){n.ResponseCode="ErrorDataSourceOperation";n.ResponseClass="Error";n.MessageText=t.get_$4y();_js.Trace.logError(_a.$0.$M6,"Processing clientstore error '{0}' in servicecommand {1}",t.get_$4y(),this.get_$Ri());i(t)},$Bl:function(n,t,i){this.$9B.$Bl(new _a.$6i(this.get_$Ri()),n,t,i)},$AHR:function(n,t,i,r){this.$9B.$Bl(n,t,i,r)},$3xl:function(n){return _g.$7N.isInstanceOfType(n)?_g.$h.$1i.nameToId(n.Id):n},$3nF:function(n){_js.Trace.logInfo(_a.$0.$M6,"ServiceCommand {0} completed. Status {1}. Details {2}",this.get_$Ri(),n,this.$2vx);OwaApplication.get_$1Ux().$6Wq(this.$3Ot,n,this.$2vx,null,null,null,null)},$6VX:function(n,t){_e.$69.$$(this.$$gta["_e.$69"].TActionContext).$33J(this.get_$Ri(),_e.$69.$$(this.$$gta["_e.$69"].TActionContext).$Zf[3]);_js.Trace.logInfo(_a.$0.$M6,"Rejecting the service command '{0}' from the offline component (Reason: {1})...",this.get_$Ri(),_0365f.$S3.toString(n));this.$3nF(302);this.$OE.offlineRejectCode=n;t()}};_e.$gu=function(n,t,i){_e.$gu.initializeBase(this,[n,t]);this.$2Zu=i};_e.$gu.prototype={$2Zu:null,get_$Ri:function(){return"SetLayoutSettings"},$7g4:function(n,t,i){this.$s(n,t,i)},$7wm:function(n,t,i){_js.Trace.logInfo(_e.$gu.$A,"SetLayoutSettings ExecuteInternal invoked.");this.get_$4am().$1mr(this.$2Zu,n)}};_e.$1Ek=function(n,t,i){_e.$1Ek.initializeBase(this,[n,t]);this.$2Zv=i};_e.$1Ek.prototype={$2Zv:null,get_$Ri:function(){return"SetTimeZone"},$7g4:function(n,t,i){this.$s(n,t,i)},$7wm:function(n,t,i){this.get_$4am().$3Rg(this.$2Zv,n)}};_e.$77=function(n,t,i){this.$GK=0;_e.$77.initializeBase(this,[n,t,i,i.Body.ItemChanges.length]);this.$9d=new Array(this.get_$AIw());this.$33=new _g.$Ss;this.$33.Header=_e.$8e.$Wx;this.$33.Body.ResponseMessages=new _g.$Fy;this.$33.Body.ResponseMessages.Items=this.$9d};function $7A5(n,t,i,r){r.val=0;if(t.IsMeeting){r.val=6;return!0}else if(t.CalendarItemType==="RecurringMaster"){r.val=7;return!0}for(var u=0;u<i.length;u++)if(i[u].Path.__type===_g.$1V._dataContractName){var f=i[u].Path;switch(f.FieldURI){case"RequiredAttendees":case"OptionalAttendees":case"Resources":r.val=9;return!0;case"Recurrence":r.val=t.CalendarItemType==="Single"?2:8;return!0}}return!1}function $7A7(n,t,i,r,u){var e=!1;r.val=i.StartWallClock;u.val=i.EndWallClock;for(var f=0;f<t.length;f++)if(t[f].__type===_g.$75._dataContractName&&t[f].Item.__type===_g.$6Y._dataContractName&&t[f].Path.__type===_g.$1V._dataContractName){var o=t[f].Item;var s=t[f].Path;switch(s.FieldURI){case"Start":r.val=o.Start;e=!0;break;case"End":u.val=o.End;e=!0;break}}return e}function $7AA(n,t,i){for(var r=0;r<i.length;r++)if(i[r].__type===_g.$75._dataContractName)$7A8(n,t,i[r]);else if(i[r].__type===_g.$Et._dataContractName)$7A6(n,t,i[r]);else break;t.CalendarItemType==="Occurrence"&&(t.CalendarItemType="Exception")}function $7A8(n,t,i){var u=null;if(i.Path.__type===_g.$1V._dataContractName)u=i.Path;else if(i.Path.__type===_g.$CQ._dataContractName){var e=i.Item.ExtendedProperty;if(!e){_js.Trace.logWarning(_e.$77.$A,"UpdateCalendarItem-SetCalendarItemProperty: ignoring null extended properties.");return}for(var o=e,s=o.length,f=0;f<s;++f){var h=o[f];_e.$3y.$1mp(t,h)}return}else throw Error.argument(String.format("UpdateCalendarItem-SetCalendarItemProperty: Property path type {0} is not supported.",Object.getType(i.Path).getName()));var r=null;if(i.Item.__type===_g.$6Y._dataContractName)r=i.Item;else throw Error.argument(String.format("UpdateCalendarItem-SetCalendarItemProperty: Property update item type {0} is not supported.",Object.getType(i.Item).getName()));switch(u.FieldURI){case"Subject":t.Subject=r.Subject;break;case"Body":t.Body=r.Body;_e.$AL.$4Tg(t);break;case"IsAllDayEvent":t.IsAllDayEvent=r.IsAllDayEvent;break;case"StartTimeZone":t.StartTimeZoneId=r.StartTimeZone.Id;break;case"Start":t.Start=r.Start;t.StartWallClock=r.Start;break;case"EndTimeZone":t.EndTimeZoneId=r.EndTimeZone.Id;break;case"End":t.End=r.End;t.EndWallClock=r.End;break;case"LegacyFreeBusyStatus":t.FreeBusyType=r.FreeBusyType;break;case"ReminderIsSet":t.ReminderIsSet=r.ReminderIsSet;break;case"ReminderMinutesBeforeStart":t.ReminderMinutesBeforeStart=r.ReminderMinutesBeforeStart;break;case"Sensitivity":t.Sensitivity=r.Sensitivity;break;case"Location":case"EnhancedLocation":t.Location=r.Location;break;case"Categories":t.Categories=r.Categories;break;case"InboxReminders":t.InboxReminders=r.InboxReminders;break;default:throw Error.invalidOperation(String.format("UpdateCalendarItem-SetProperty: Field uri {0} is not supported.",u.FieldURI));}}function $7A6(n,t,i){var r=null;if(i.Path.__type===_g.$1V._dataContractName)r=i.Path;else throw Error.argument(String.format("UpdateCalendarItem-DeleteProperty: Property path type {0} is not supported.",Object.getType(i.Path).getName()));switch(r.FieldURI){case"Location":case"EnhancedLocation":t.Location=null;break;case"InboxReminders":t.InboxReminders=null;break;default:throw Error.invalidOperation(String.format("UpdateCalendarItem-DeleteProperty: Field uri {0} is not supported.",r.FieldURI));}}function $7AB(n,t,i,r){var u=_e.$1l.$5h(i.ItemId.Id);var f=n.get_$AU().get_$Iq();if(i.ReminderIsSet){var e=this;f.$1KP(t,u,function(f){if($5(f)){_js.Trace.logInfo(_e.$77.$A,"UpdateCalendarItem: Reminder is set but no reminder with id {0} was found in local store. Creating a reminder.",i.ItemId.Id);n.get_$AHN().$4YB(t,i,i.ItemId,function(n){_js.Trace.logInfo(_e.$77.$A,"UpdateCalendarItem: Reminder with id {0} created successfuly.",n)})}else{_js.Trace.logInfo(_e.$77.$A,"UpdateCalendarItem: Reminder with id {0} found. Updating properties.",u);var e=f;$7AC(n,e,i,r)}})}else{_js.Trace.logInfo(_e.$77.$A,"UpdateCalendarItem: Reminder not set on calendar item with id {0}. Deleting reminder if one exist.",i.ItemId.Id);f.$II(t,u)}}function $7AC(n,t,i,r){for(var u=0;u<r.length;u++)r[u].__type===_g.$75._dataContractName?$7A9(n,t,i,r[u]):_js.Trace.logInfo(_e.$77.$A,"UpdateCalendarItem: Property update type {0} is not handled for reminders.",Object.getType(r[u]).getName())}function $7A9(n,t,i,r){var f=null;if(r.Path.__type===_g.$1V._dataContractName)f=r.Path;else if(r.Path.__type===_g.$CQ._dataContractName){_js.Trace.logInfo(_e.$77.$A,"UpdateCalendarItem-SetReminderItemProperty: ExtendedPropertyUri is not handled for reminders.");return}else throw Error.argument(String.format("UpdateCalendarItem-SetReminderItemProperty: Property path type {0} is not supported.",Object.getType(r.Path).getName()));var u=null;if(r.Item.__type===_g.$6Y._dataContractName)u=r.Item;else throw Error.argument(String.format("UpdateCalendarItem-SetReminderItemProperty: Property update item type {0} is not supported.",Object.getType(r.Item).getName()));switch(f.FieldURI){case"Subject":t.Subject=u.Subject;break;case"Start":var e=_a.$7.$3x(u.Start);t.StartDate=u.Start;t.ReminderTime=_a.$7.$aV(e.$Bp(-i.ReminderMinutesBeforeStart));break;case"ReminderMinutesBeforeStart":var o=_a.$7.$3x(t.StartDate);t.ReminderTime=_a.$7.$aV(o.$Bp(-i.ReminderMinutesBeforeStart));break;case"End":t.EndDate=u.End;break;case"EnhancedLocation":t.Location=u.Location?u.Location.DisplayName:null;break;default:_js.Trace.logInfo(_e.$77.$A,"UpdateCalendarItem-SetReminderItemProperty: Field uri {0} is not handled for reminders.",f.FieldURI);break}}_e.$77.prototype={$33:null,$9d:null,$88:!1,get_$Ri:function(){return"UpdateCalendarItem"},$7g4:function(n,t,i){if(this.get_$AHO().clientStoreItem===1){var r=this;this.$s(function(){if(r.$88){_js.Trace.logInfo(_e.$77.$A,"UpdateCalendarItem: Call rejected by updated calendar item service command. The call should be forwarded to online proxy.");i(-1)}else n()},t,i)}else throw Error.argument("ClientStoreItem",String.format("ClientStoreItem {0} is not supported.",this.get_$AHO().clientStoreItem));},$7wZ:function(n,t,i,r){if(this.$88){t();return}var o=this.get_$3Or().Body.ItemChanges[n];var u=o.ItemId;_js.Trace.logInfo(_e.$77.$A,"Step {0} called for id {1}",n.toString(),u.Id);var e=new _g.$Zp;e.ResponseCode="NoError";e.ResponseClass="Success";e.Items=[new _g.$7j];e.Items[0].ItemId=u;this.$9d[n]=e;var f=this,s=this,h=this;this.$Bl(function(n){if(f.get_$AHO().isReferencedItemRecurring)if(u.__type===_g.$7b._dataContractName){_js.Trace.logInfo(_e.$77.$A,"UpdateCalendarItem: RecurringMasterItemId isn't supported on offline updateitem service command. Rejecting call.");f.$88=!0}else f.$AJI(_bc.$LD,n,u,o.Updates,f.get_$AU().get_$mQ());else f.$AJI(_bc.$MP,n,u,o.Updates,f.get_$AU().get_$1c())},function(){_js.Trace.logInfo(_e.$77.$A,"Successfully updated calendar item with server id {0} in local store.",u.Id);t()},function(n){_js.Trace.logError(_e.$77.$A,"Failed to updated calendar item with server id {0} in local store. Error: {1}.",u.Id,n.$3j);i(new _e.$1g(new _a.$Av(0,n.$3j)))})},$AJI:function(n,t,i,r,u){var f=this;u.$Fu(t,_e.$1l.$5h(i.Id),function(u){if($5(u)){_js.Trace.logWarning(_e.$77.$A,"UpdateCalendarItem: Calendar item (type: '{0}') with id {1} was not found in local store",n.getName(),i.Id);f.$88=!0}else{var e,o;var s,h,c;(c=$7A7(f,r,u.get_$1r(),s={val:e},h={val:o}),e=s.val,o=h.val,c)?f.get_$AHN().$8LU(t,e,o,function(){f.$AJJ(n,t,u,r)},function(){f.$88=!0;f.$GK=11}):f.$AJJ(n,t,u,r)}},null)},$AJJ:function(n,t,i,r){var u;var f=i.get_$1r();var e,o;if(o=$7A5(this,f,r,e={val:u}),u=e.val,o){this.$88=!0;this.$GK=u}else{$7AA(this,f,r);$7AB(this,t,f,r);i.$E1(t,null)}}};_e.$3y=function(n,t,i){_e.$3y.initializeBase(this,[n,t,i,i.Body.ItemChanges.length,_e.$3y.$A]);this.$9d=new Array(this.get_$AIw());this.$33=new _g.$Ss;this.$33.Header=_e.$8e.$Wx;this.$33.Body.ResponseMessages=new _g.$Fy;this.$33.Body.ResponseMessages.Items=this.$9d;this.get_$AHO().itemIds=new Array(i.Body.ItemChanges.length)};_e.$3y.$SD=function(n,t,i){var r=new _g.$Cv;r.ExtendedFieldURI=t;r.Value=i;_e.$3y.$1mp(n,r)};_e.$3y.$1mp=function(n,t){if($5(n.ExtendedProperty)){n.ExtendedProperty=new Array(1);n.ExtendedProperty[0]=t}else{for(var i=0;i<n.ExtendedProperty.length;i++)if(n.ExtendedProperty[i].ExtendedFieldURI.PropertySetId===t.ExtendedFieldURI.PropertySetId&&n.ExtendedProperty[i].ExtendedFieldURI.PropertyTag===t.ExtendedFieldURI.PropertyTag&&n.ExtendedProperty[i].ExtendedFieldURI.PropertyId===t.ExtendedFieldURI.PropertyId&&n.ExtendedProperty[i].ExtendedFieldURI.DistinguishedPropertySetId===t.ExtendedFieldURI.DistinguishedPropertySetId){n.ExtendedProperty[i]=t;return}var r=[];Array.addRange(r,n.ExtendedProperty);Array.add(r,t);n.ExtendedProperty=r}};function $7AI(n,t,i,r,u,f){_js.Trace.logInfo(_e.$3y.$A,"Opening a transaction to update a MessageItem. {0}",n.$6l9);var e=this,o=this,s=this;n.$AHR(new _a.$6i("UpdateItem.UpdateMessageItem",!1),function(r){_js.Trace.logInfo(_e.$3y.$A,"Getting a MessageItem for update. {0}",n.$6l9);n.get_$AU().get_$4y().$1KP(r,_e.$1l.$5h(i.Id),function(u){if($5(u)){_js.Trace.logWarning(_e.$3y.$A,"Message with id {0} was not found in client store. {1}",i.Id,n.$6l9);return}_js.Trace.logInfo(_e.$3y.$A,"MessageItem retrieved for update. {0}",n.$6l9);$4uZ(n,r,u,t.Updates);var f=u;$5(n.get_$AHO().bodySubstring)||_e.$19.$4aL(f,null,n.get_$AHO().bodySubstring);_js.Trace.logInfo(_e.$3y.$A,"Message with updates going to client store via update ItemId={0}; Subject{1}. {2}",JsonParser.serialize(f.ItemId),f.Subject,n.$6l9)})},function(){_js.Trace.logInfo(_e.$3y.$A,"Successfully updated message in local store. {0}",n.$6l9);u()},function(t){_js.Trace.logInfo(_e.$3y.$A,"Reporting store error {0}. {1}",t.$3j,n.$6l9);n.$AHQ(n.$9d[r],new _e.$1g(t),f)})}function $4uZ(n,t,i,r){$4uX(n,t,i,r);var u=i;n.get_$AHO().isUpdatingRightsManagementLicenseData&&(u.RightsManagementLicenseData=n.get_$AHO().rightsManagementLicenseData);u.LastModifiedTime=_a.$7.$Ex(_a.$7.get_$2F())}function $7AE(n,t,i,r,u,f){_a.$3.$K(n.get_$AHO().outboxFolderId,"OutboxFolderId");var o=!!u;var e;if(o)e=_0365f.$5F.$3g(u.get_$1r());else{_js.Trace.logInfo(_e.$3y.$A,"Message with id {0} not found in local store",t.Id);e=new _g.$9r}$4uY(n,e,t,n.get_$AHO().outboxFolderId,!1,o);e.ItemId=_bc.OutboxItemContext.$5K7(e.ItemId,_e.$3y.$A);n.get_$AHO().itemIds[r]=e.ItemId;$4uX(n,f,e,i.Updates);return n.get_$AU().get_$h5().$rP(e)}function $4uY(n,t,i,r,u,f){if(!f){t.DateTimeCreated=_a.$7.$Ex(_a.$7.get_$2F());t.DateTimeReceived||(t.DateTimeReceived=t.DateTimeCreated);t.ItemId=new _g.$1t(i.Id);t.ItemId.ChangeKey=i.ChangeKey;t.InstanceKey=(new _bc.$Bi).get_$Ey()}t.ParentFolderId=r;_e.$19.$4aL(t,null,n.get_$AHO().bodySubstring);t.IsDraft=u;n.get_$AHO().isUpdatingRightsManagementLicenseData&&(t.RightsManagementLicenseData=n.get_$AHO().rightsManagementLicenseData);n.get_$AHO().conversationId&&(t.ConversationId=n.get_$AHO().conversationId)}function $4uX(n,t,i,r){for(var u=i,o=0;o<r.length;o++){var s=r[o];if(s&&s.__type===_g.$Et._dataContractName){var a=s.Path;if("From"===a.FieldURI){u.From=null;continue}else{var c=s.Path;if(c.DistinguishedPropertySetId==="Sharing"&&c.PropertyId===35356)continue}}var h=r[o];var l=h.Path;var f=h.Item;if(!l||!f)break;switch(l.FieldURI){case"BccRecipients":u.BccRecipients=f.BccRecipients;break;case"Body":u.Body=f.Body.BodyType==="HTML"?new _g.$6b(n.get_$AHO().isTextBodyValue?"Text":f.Body.BodyType,n.get_$AHO().clientStoreBodyValue):f.Body;(u.__type===_g.$Gd._dataContractName||u.__type===_g.$Hy._dataContractName||u.__type===_g.$Ha._dataContractName)&&(u.__type=_g.$9r._dataContractName);break;case"CcRecipients":u.CcRecipients=f.CcRecipients;break;case"Importance":u.Importance=f.Importance;break;case"Subject":u.Subject=f.Subject;break;case"From":u.From=f.From;break;case"ToRecipients":u.ToRecipients=f.ToRecipients;u.DisplayTo=n.$AJO(f.ToRecipients);break;case"IsRead":$7AH(n,t,u,f.IsRead);break;case"Flag":$7AF(n,t,u,f.Flag);break;case"ItemPolicyTag":u.PolicyTag=f.PolicyTag;break;case"ItemArchiveTag":u.ArchiveTag=f.ArchiveTag;break;case"Sensitivity":u.Sensitivity=f.Sensitivity;break;case"IsDeliveryReceiptRequested":u.IsDeliveryReceiptRequested=f.IsDeliveryReceiptRequested;break;case"IsReadReceiptRequested":u.IsReadReceiptRequested=f.IsReadReceiptRequested;break;case"IsClutter":$7AG(n,t,u,f.IsClutter);break;case"ItemClass":u.ItemClass=f.ItemClass;break;case"ModernReminders":u.ModernReminders=f.ModernReminders;break;case"MimeContent":u.MimeContent=f.MimeContent;break;default:var e=h.Path;if(e.DistinguishedPropertySetId==="Sharing"&&e.PropertyId===35356)continue;if(e.DistinguishedPropertySetId==="Common")if(e.PropertyId===34229){_e.$3y.$SD(u,e,f.ExtendedProperty[0].Value);break}else if(e.PropertyId===34232){_e.$3y.$SD(u,e,f.ExtendedProperty[0].Value);break}else if(e.PropertyId===34230){_e.$3y.$SD(u,e,f.ExtendedProperty[0].Value);break}else if(e.PropertyId===34231){_e.$3y.$SD(u,e,f.ExtendedProperty[0].Value);break}if(e.DistinguishedPropertySetId==="InternetHeaders"&&(e.PropertyName==="X-Ms-Exchange-Organization-Dlp-SenderOverrideJustification"||e.PropertyName==="X-Ms-Exchange-Organization-Dlp-FalsePositive"))break;if(e.DistinguishedPropertySetId==="PublicStrings"&&e.PropertyName.startsWith("cecp-")){_e.$3y.$SD(u,e,f.ExtendedProperty[0].Value);break}break}}}function $7AG(n,t,i,r){if(i.IsClutter!==r){i.IsClutter=r;if(i.ConversationId&&i.ConversationId.Id){var u=_e.$EM.$14T(i.ParentFolderId,i.ConversationId);var f=this;n.get_$AU().get_$Jl().$Fu(t,u,function(n){if(n){for(var u=n.get_$1r(),e=!1,f=0;f<u.ItemIds.length;f++)if(u.ItemIds[f].Id===i.ItemId.Id){e=!0;break}if(e&&(!r||!u.HasClutter)){u.HasClutter=r;n.$E1(t,null)}}},null)}}}function $7AH(n,t,i,r){if(i.IsRead!==r){i.IsRead=r;var u=this;n.get_$AU().get_$2r().$Fu(t,_e.$1l.$5h(i.ParentFolderId.Id),function(u){if(u){var f=u.get_$1r();r&&f.UnreadCount>0?f.UnreadCount--:r||f.UnreadCount++;u.$E1(t,null);if(i.ConversationId&&i.ConversationId.Id){var e=_e.$EM.$14T(i.ParentFolderId,i.ConversationId);n.get_$AU().get_$Jl().$Fu(t,e,function(n){if(n){for(var u=n.get_$1r(),e=!1,f=0;f<u.ItemIds.length;f++)if(u.ItemIds[f].Id===i.ItemId.Id){e=!0;break}if(e){r&&u.UnreadCount>0?u.UnreadCount--:r||u.UnreadCount++;n.$E1(t,null)}}},null)}}},null)}}function $7AF(n,t,i,r){_a.$3.$pj(n.get_$AHO().flag,null,"UpdateItemContext.Flag can't be null when Flag is being updated.");_a.$3.$KI(n.get_$AHO().flag.FlagStatus,r.FlagStatus,"UpdateItemContext.Flag.FlagStatus should match the FlagStatus in SetItemPropertyUpdate.");i.Flag=n.get_$AHO().flag;if(i.ConversationId){var u=_e.$EM.$14T(i.ParentFolderId,i.ConversationId);var f=this;n.get_$AU().get_$Jl().$Fu(t,u,function(u){if(u)if(n.get_$AHO().isFlagConversation){u.get_$1r().FlagStatus=n.get_$AHO().flag.FlagStatus;u.$E1(t,null)}else $7AD(n,t,i,r.FlagStatus,u)},null)}}function $7AD(n,t,i,r,u){for(var f=u.get_$1r(),o=[],s=!1,e=0;e<f.ItemIds.length;e++)f.ItemIds[e].Id===i.ItemId.Id?s=!0:Array.add(o,_e.$1l.$5h(f.ItemIds[e].Id));if(s){var h=f.FlagStatus;if(r>=h||!o.length){f.FlagStatus=r;u.$E1(t,null);return}var c=this,l=this;n.get_$AU().get_$4y().$7cy(t,o,function(n){for(var i=0;i<n.length;i++){n[i].get_$1r().Flag.FlagStatus>r&&(r=n[i].get_$1r().Flag.FlagStatus);if(r==="Flagged"){f.FlagStatus=r;u.$E1(t,null);break}}f.FlagStatus=r;u.$E1(t,null)},function(n){_js.Trace.logError(_e.$3y.$A,"Error binding to messages in conversation with id {0}, Error {1}",f.ConversationId.Id,n.get_$4y())})}}_e.$3y.prototype={$33:null,$9d:null,get_$Ri:function(){return"UpdateItem"},$6dD:function(n,t){_e.$GW.$6cI(this.get_$AU().get_$h5(),n,t,_e.$3y.$A)},$87r:function(){return _e.$ZR.$7m2(this.get_$AHO())},$879:function(){return this.get_$3Or().Body.ComplianceId},$87n:function(){return 1},$7g4:function(n,t,i){this.$s(n,t,i)},$7wm:function(n,t,i){var r=this;_e.$fB.prototype.$7wm.call(this,function(){r.get_$AHO().clientStoreBodyValue=null;n()},t,i)},$7wZ:function(n,t,i,r){var e=this.get_$3Or().Body.ItemChanges[n];var u=e.ItemId;this.$AIx(u);_js.Trace.logInfo(_e.$3y.$A,"ExecuteCurrentStep called for step={0}. {1}",n.toString(),this.$6l9);var f=new _g.$Zp;f.ResponseCode="NoError";f.ResponseClass="Success";if(this.get_$3Or().Body.MessageDisposition==="SaveOnly"){f.Items=[new _g.$7j];f.Items[0].ItemId=u}this.$9d[n]=f;if(!this.get_$AHO().clientStoreItem){_js.Trace.logInfo(_e.$3y.$A,"ClientStoreItem.None was passed. Request will be sent to the server. {0}",this.$6l9);t();return}if(this.get_$AHO().clientStoreItem===2)if(this.get_$3Or().Body.MessageDisposition==="SendAndSaveCopy"){_js.Trace.logInfo(_e.$3y.$A,"Moving Draft item to Outbox. {0}",this.$6l9);var s=this;this.$AJM(u,function(t,i){return $7AE(s,u,e,n,t,i)},f,t,i)}else if(this.get_$AHO().outboxItemId){_js.Trace.logInfo(_e.$3y.$A,"Moving Outbox item back to Drafts. {0}",this.$6l9);var o=this;this.$AJN(function(n){var t=new _g.$9r;$4uY(o,t,u,o.get_$AHO().parentFolderId,!0,!1);var i=o.get_$AU().get_$4y().$rP(t);$4uZ(o,n,i.get_$1r(),e.Updates);return i},!1,this.$9d[n],t,i)}else{_js.Trace.logInfo(_e.$3y.$A,"Updating MessageItem. {0}",this.$6l9);$7AI(this,e,u,n,t,i)}else{_js.Trace.logWarning(_e.$3y.$A,"ClientStoreItem is not supported. ClientStoreItem={0}. {1}",this.get_$AHO().clientStoreItem,this.$6l9);t()}}};_e.$1H1=function(n,t,i,r,u){_e.$1H1.initializeBase(this,[n,t,r,u]);_a.$3.$m(i,"personaId");_a.$3.$1G(i.Id,"personaId.Id");this.$Ci=i};_e.$1H1.prototype={$Ci:null,get_$Ri:function(){return"UpdatePersona"},$7g4:function(n,t,i){if(this.get_$AIX()===_e.$K.$3sf){i(-1);return}this.$s(n,t,i)},$7wm:function(n,t,i){var r=this,u=this,f=this;this.$Bl(function(n){var t=_e.$6P.$E(r.get_$AU());t.$Fu(n,r.$Ci,function(i){if(!$5(i)){_e.$K.$5CA(i,r.get_$AIW());t.$5W5(n,i,function(){t.$uj(n,i,0,null)})}r.set_$1u(i)},null)},function(){n()},function(n){_e.$1g.$DN(n,t)})}};_e.$U4=function(n,t,i,r){_e.$U4.initializeBase(this,[n,t,i]);_a.$3.$m(r,"syncManager");this.$4Y=r;this.$33=new _g.$Nn;this.$33.Header=_e.$8e.$Wx};function $78p(n){return n.get_$3Or().Body.ReminderType===1||n.get_$3Or().Body.ReminderType===2||n.get_$3Or().Body.ReminderType===3?!1:!0}_e.$U4.prototype={$33:null,$4Y:null,get_$Ri:function(){return"GetReminders"},$7g4:function(n,t,i){if($78p(this)){var r=this;this.$T3(3,new _a.$Kd,function(u){if(u)r.$s(n,t,i);else{_js.Trace.logInfo(_e.$U4.$A,"Rejecting the call as the reminderm module is not synced");i(301)}})}else i(100)},$7wm:function(n,t,i){var r=this,u=this;_e.$Aa.$14j(this.get_$AU().get_$Iq(),this.get_$3Or().Body.MaxItems,this.get_$3Or().Body.BeginTime,this.get_$3Or().Body.EndTime,function(t){r.$33.Body.ResponseCode="NoError";r.$33.Body.ResponseClass="Success";r.$33.Body.Reminders=new Array(t.length);for(var i=0;i<t.length;++i){var u=t[i].get_$1r();r.$33.Body.Reminders[i]=u}n()},function(n){u.$33.Body.ResponseCode="ErrorDataSourceOperation";u.$33.Body.ResponseClass="Error";u.$33.Body.MessageText=n.get_$4y();t(n)})},$T3:function(n,t,i){this.$4Y.$T3(n,t,i)}};_e.$uW=function(n,t,i){this.$$d_$AE7=Function.createDelegate(this,this.$AE7);_e.$uW.initializeBase(this,[n,t,i])};_e.$uW.prototype={get_$Ri:function(){return"UpdateViewStateConfiguration"},$7g4:function(n,t,i){this.$s(n,t,i)},$7wm:function(n,t,i){this.get_$4am().$9wt(this.$$d_$AE7,n,t)},$AE7:function(n){for(var r=this.get_$3Or().Body.UserConfiguration.Dictionary,u=r.length,i=0;i<u;++i){var t=r[i];switch(t.DictionaryKey.Value[0]){case"CalendarViewTypeNarrow":n.CalendarViewTypeNarrow=Number.parseInvariant(t.DictionaryValue.Value[0]);break;case"CalendarViewTypeWide":n.CalendarViewTypeWide=Number.parseInvariant(t.DictionaryValue.Value[0]);break;case"CalendarViewTypeDesktop":n.CalendarViewTypeDesktop=Number.parseInvariant(t.DictionaryValue.Value[0]);break;case"CalendarSidePanelIsExpanded":n.CalendarSidePanelIsExpanded=Boolean.parse(t.DictionaryValue.Value[0]);break;case"FolderViewState":n.FolderViewState=t.DictionaryValue.Value;break;case"SchedulingViewType":n.SchedulingViewType=Number.parseInvariant(t.DictionaryValue.Value[0]);break;case"SchedulingLastUsedRoomListName":n.SchedulingLastUsedRoomListName=t.DictionaryValue.Value[0];break;case"SchedulingLastUsedRoomListEmailAddress":n.SchedulingLastUsedRoomListEmailAddress=t.DictionaryValue.Value[0];break;case"SearchHistory":n.SearchHistory=t.DictionaryValue.Value;break;case"CalendarSidePanelMonthPickerCount":n.CalendarSidePanelMonthPickerCount=Number.parseInvariant(t.DictionaryValue.Value[0]);break;case"SelectedCalendarsDesktop":n.SelectedCalendarsDesktop=t.DictionaryValue.Value;break;case"SelectedCalendarsTWide":n.SelectedCalendarsTWide=t.DictionaryValue.Value;break;case"SelectedCalendarsTNarrow":n.SelectedCalendarsTNarrow=t.DictionaryValue.Value;break;case"AttachmentsFilePickerViewTypeMouse":n.AttachmentsFilePickerViewTypeForMouse=Number.parseInvariant(t.DictionaryValue.Value[0]);break;case"AttachmentsFilePickerViewTypeTouch":n.AttachmentsFilePickerViewTypeForTouch=Number.parseInvariant(t.DictionaryValue.Value[0]);break;case"BookmarkedWeatherLocations":n.BookmarkedWeatherLocations=t.DictionaryValue.Value;break;case"CurrentWeatherLocationBookmarkIndex":n.CurrentWeatherLocationBookmarkIndex=Number.parseInvariant(t.DictionaryValue.Value[0]);break}}}};_e.$AL=function(n){_e.$AL.initializeBase(this,[n])};_e.$AL.$4Tg=function(n){if(n.Body&&n.Body.Value)if(n.Body.BodyType==="Text"){n.TextBody=n.Body;var f=_a.$1d.$1Bw(n.TextBody.Value);n.Body=new _g.$6b("HTML",f);_js.Trace.logInfo(_a.$0.$6y,"Created Body from TextBody for new created item with client id {0}",n.ItemId.Id)}else{var i=_a.$1d.$7xP(n.Body.Value);i||(i=n.Body.Value);var t=null;var r,u;if(u=_a.$1d.$7jP(i,r={val:t}),t=r.val,u)_js.Trace.logInfo(_a.$0.$6y,"Created TextBody from body for new created item with client id {0}",n.ItemId.Id);else{_js.Trace.logWarning(_a.$0.$6y,"HTML body couldn't be converted to TEXT for item with client id {0}. Setting Text body to empty.",n.ItemId.Id);t=""}n.TextBody=new _g.$6b("Text",t)}};function $4tZ(n,t,i,r,u,f){if($5(t)){_js.Trace.logWarning(_e.$AL.$A,"No calendar sync state was found. Considering item outside sync range.");f();return}var e=t.get_$1r();if(!e.IsSynced){_js.Trace.logInfo(_e.$AL.$A,"Calendar isn't synced. Considering item outside sync range.");f();return}var o=_a.$7.$3x(i);var s=_a.$7.$3x(r);var h=_a.$7.$3x(e.WindowStart);var c=_a.$7.$3x(e.WindowEnd);s.$2U(h)<0||o.$2U(c)>0?f():u()}function $77G(n,t,i){var r=n.$9B.get_$Iq();var u=this;r.$Fu(t,i,function(n){if(!n||!n.get_$1r()){_js.Trace.logWarning(_e.$AL.$A,"Reminder item with id {0} could no be found in client store.",i);return}_js.Trace.logInfo(_e.$AL.$A,"Reminder item with id {0} found in client store. Deleting it.",n.get_$1y());r.$II(t,i);_js.Trace.logInfo(_e.$AL.$A,"Successfully deleted reminder item with id {0} from client store.",n.get_$1y())},null)}_e.$AL.prototype={$4YB:function(n,t,i,r){var f=_a.$7.$3x(t.Start);var e=_a.$7.$aV(f.$Bp(-t.ReminderMinutesBeforeStart));var u=new _g.$Od(t.Subject,e,t.Start,t.End,i,t.UID);t.Location&&(u.Location=t.Location.DisplayName);var o=this.$9B.get_$Iq().$rP(u);o.$E1(n,r)},$3rR:function(n,t,i){var r=this.$9B.get_$1c();if(i.CalendarItemType==="RecurringMaster"){_js.Trace.logInfo(_e.$AL.$A,"Item {0} is a recurring master. Deleteting occurrences/exceptions and master",t);var u=_e.$ay.$8V(this.$9B);var e=this;u.$5Op(n,t,function(){});var f=new _a.$8o(_e.$Aa.$19v,i.UID);var o=this;this.$9B.get_$Iq().$1uq(n,f,function(){});this.$9B.get_$mQ().$II(n,t)}else{r.$II(n,t);$77G(this,n,t)}},$8LT:function(n,t,i,r){var u=new _e.$nJ(this.$9B.get_$pd(),"CalendarSyncState");var f=this,e=this;u.$2Oq(function(u){$4tZ(f,u,n,t,i,r)},function(n){r()})},$8LU:function(n,t,i,r,u){var f=new _e.$nJ(this.$9B.get_$pd(),"CalendarSyncState");var e=this;f.$5Zh(n,function(n){$4tZ(e,n,t,i,r,u)})},$5YN:function(n,t,i,r){var u=this;this.$9B.get_$1c().$Fu(n,_e.$1l.$5h(t.OccurrenceId),function(n){if(!n||!n.get_$1r()){_js.Trace.logWarning(_e.$AL.$A,"Occurrence item with id {0} could no be found in client store.",t.OccurrenceId);r();return}_js.Trace.logInfo(_e.$AL.$A,"Occurrence item with id {0} found in client store. Master Uid is {1}.",n.get_$1y(),n.get_$19u());i(n.get_$19u())},null)}};_e.$C9=function(n){_e.$C9.initializeBase(this,[n])};function $77z(n,t,i,r,u,f,e){var o=this;n.$9B.get_$Hi().$Fu(t,_e.$1l.$5h(i.Id),function(i){if(!i){_js.Trace.logInfo(_e.$1n.$A,"ConversationNodeItem not found in the clientstore. Hence, not adding the itempart");e(!1);return}var o=i.get_$1r();var h=(new _bc.$Bi).$5S.Id;var s=new _g.$TV(h);s.ParentInternetMessageId=u;var c=_e.$PN.$5Ld(r);s.Items=[c];f?Array.insert(o.ConversationNodes,0,s):Array.add(o.ConversationNodes,s);o.LastModifiedTime=$2lS(n,o.LastModifiedTime);i.$E1(t,null);_js.Trace.logInfo(_e.$1n.$A,"Successfully updated and saved the conversationNodeItem");e(!0)},null)}function $780(n,t,i,r,u,f){var e=this;n.$9B.get_$Hi().$Fu(t,_e.$1l.$5h(i.Id),function(e){if(!e){_js.Trace.logInfo(_e.$1n.$A,"ConversationNodeItem not found in the clientstore. Hence, not removing the itempart");f(null);return}for(var o=e.get_$1r(),a=null,l=!1,c=0;c<o.ConversationNodes.length;c++){var s=o.ConversationNodes[c];if(s.Items.length===1&&$2lR(n,s.Items[0].ItemId,r.ItemId,u)){a=s.ParentInternetMessageId;_js.Trace.logInfo(_e.$1n.$A,"Removing the whole ConversationNode at index {0}",c);Array.removeAt(o.ConversationNodes,c);l=!0;break}else for(var h=0,h=0;h<s.Items.length;h++){var v=s.Items[h];if($2lR(n,v.ItemId,r.ItemId,u)){_js.Trace.logInfo(_e.$1n.$A,"Removing the item at index {0}",h);Array.removeAt(s.Items,h);l=!0;break}}if(l)break}if(l){o.LastModifiedTime=$2lS(n,o.LastModifiedTime);if(o.ConversationNodes.length){e.$E1(t,null);_js.Trace.logInfo(_e.$1n.$A,"Successfully removed item from the conversationNode")}f(a)}else{_js.Trace.logInfo(_e.$1n.$A,"ItemId {0} not removed from conversationNode with id {0}",r.ItemId.Id,i.Id);f(null)}},null)}function $781(n,t,i,r,u,f){_js.Trace.logInfo(_e.$1n.$A,"Update metadata properties for all conversations with id {0} for addition. The itempart added has id {1}",i,r.ItemId.Id);var e=this;_e.$6s.$3xN(t,n.$9B.get_$Jl(),i,function(i){for(var c=i,y=c.length,s=0;s<y;++s){for(var l=c[s],u=l.get_$1r(),a=u.GlobalItemIds,p=a.length,h=0;h<p;++h){var w=a[h];if($2lR(n,w,r.ItemId,f))throw Error.invalidOperation(String.format("itempart is already a part of the conversation, id = {0}, GlobalItemIds = [{1}]",r.ItemId.Id,u.GlobalItemIds.join(",")));}var e=new _g.$1t(r.ItemId.Id);e.ChangeKey=r.ItemId.ChangeKey;Array.add(u.GlobalItemIds,e);if(r.IsDraft&&!r.IsSubmitted)if(u.DraftItemIds){for(var v=!1,o=0;o<u.DraftItemIds.length;o++)if(u.DraftItemIds[o].Id===e.Id){v=!0;u.DraftItemIds[o]=e;break}v||Array.add(u.DraftItemIds,e)}else u.DraftItemIds=[e];u.GlobalMessageCount++;u.LastModifiedTime=$2lS(n,u.LastModifiedTime);l.$E1(t,null)}})}function $782(n,t,i,r,u,f){_js.Trace.logInfo(_e.$1n.$A,"Update metadata properties for all conversations with id {0} for remove. The itempart removed has id {1}",i,u.ItemId.Id);var e=this;_e.$6s.$3xN(t,n.$9B.get_$Jl(),i,function(i){for(var a=i,p=a.length,c=0;c<p;++c){for(var l=a[c],e=l.get_$1r(),v=!1,o=0;o<e.GlobalItemIds.length;o++){var y=e.GlobalItemIds[o];if(y.Id===u.ItemId.Id){Array.removeAt(e.GlobalItemIds,o);if(e.DraftItemIds)for(var s=0;s<e.DraftItemIds.length;s++)e.DraftItemIds[s].Id===y.Id&&Array.removeAt(e.DraftItemIds,s);v=!0}}if(v){if(e.GlobalMessageCount<=0)throw Error.invalidOperation("conversation.GlobalMessageCount "+e.GlobalMessageCount+" is less than or equal to 0");e.GlobalMessageCount--;if(!$5(u.IsRead)&&!u.IsRead){if(e.GlobalUnreadCount<=0)throw Error.invalidOperation("conversation.GlobalUnreadCount "+e.GlobalUnreadCount+" is less than or equal to 0");e.GlobalUnreadCount--}if(e.MessageCount<=0)throw Error.invalidOperation("conversation.MessageCount "+e.MessageCount+" is less than or equal to 0");if(e.FolderId.Id===r.Id){e.MessageCount--;if(!$5(u.IsRead)&&!u.IsRead){if(e.UnreadCount<=0)throw Error.invalidOperation("conversation.UnreadCount "+e.UnreadCount+" is less than or equal to 0");e.UnreadCount--}for(var h=0;h<e.ItemIds.length;h++)$2lR(n,e.ItemIds[h],u.ItemId,f)&&Array.removeAt(e.ItemIds,h)}e.LastModifiedTime=$2lS(n,e.LastModifiedTime);if(e.ItemIds.length){l.$E1(t,null);_js.Trace.logInfo(_e.$1n.$A,"Saved the updated conversation object")}else{e.MessageCount&&_js.Trace.logWarning(_e.$1n.$A,"ConversationHelper.UpdateConversationMetadataForRemove, Conversation.ItemIds.length == 0 but conversation MessageCount = {0}",e.MessageCount);l.$2LZ(t);_js.Trace.logInfo(_e.$1n.$A,"Last itemPart for this folder in this conversation, hence deleted the listView entry for this conversation")}}else _js.Trace.logInfo(_e.$1n.$A,"ItemPart not found in the GlobalItemIds list, conversation JSON = {0}",JsonParser.serialize(e))}})}function $2lR(n,t,i,r){return t.Id===i.Id||t.Id===r.$rW(i).Id||r.$rW(t).Id===i.Id}function $2lS(n,t){return _a.$7.$3x(t).$9v(1).$9L()}_e.$C9.prototype={$5A4:function(n,t,i,r,u,f,e){_a.$3.$K(n,"tx");_a.$3.$K(t,"conversationId");_a.$3.$K(i,"itemPartToAdd");_a.$3.$1G(r,"parentConversationNodeId");_a.$3.$K(f,"mailboxDataContext");_a.$3.$K(e,"successCallback");_js.Trace.logInfo(_e.$1n.$A,"Adding itemPart with id {0} to conversation with id {1}",i.ItemId.Id,t.Id);var o=this;$77z(this,n,t,i,r,u,function(u){if(!u){_js.Trace.logInfo(_e.$1n.$A,"ConversationNode not found in the clientstore. Hence, not updating conversation metadata properties also");e(!1);return}$781(o,n,t,i,r,f);if(i.ConversationId&&i.ConversationId!==t)throw Error.invalidOperation(String.format("The itemPartToAdd already has a different conversationId. conversationId = {0}, itemPartToAdd.ConversationId = {1}",t.Id,i.ConversationId.Id));else i.ConversationId=t;_js.Trace.logInfo(_e.$1n.$A,"Successfully added itempart to the conversation");e(!0)})},$4W6:function(n,t,i,r,u,f){_a.$3.$K(t,"conversationId");_a.$3.$K(i,"itemOriginalParentFolderId");_a.$3.$K(r,"itemPartToRemove");_a.$3.$K(u,"mailboxDataContext");_a.$3.$K(f,"successCallback");_js.Trace.logInfo(_e.$1n.$A,"Removing itemPart with id {0} from conversation with id {1}",r.ItemId.Id,t);var e=this;$780(this,n,t,r,u,function(o){_js.Trace.logInfo(_e.$1n.$A,"Successfully updated the conversationNodeItem. Retreived parentConversationIndex = ",o);$782(e,n,t,i,r,u);f(o)})}};_e.$lO=function(n){_e.$lO.initializeBase(this,[n])};_e.$lO.$88w=function(n,t){return!n.IsRead&&!_g.$h.$1i.doesIdEqualName(t,"outbox")&&!_g.$h.$1i.doesIdEqualName(t,"drafts")?1:0};_e.$lO.prototype={$3rf:function(n,t,i,r,u,f){_a.$3.$K(n,"tx");_a.$3.$K(t,"conversationHelper");_a.$3.$K(r,"messageItemId");_a.$3.$K(f,"mailboxDataContext");var e=this;this.$9B.get_$4y().$Fu(n,_e.$1l.$5h(r.Id),function(o){if(!o){_js.Trace.logWarning(_e.$1n.$A,"Message item with id {0} was not found in the client store.",r.Id);return}e.$1ux(n,t,i,o,u,f)},null)},$3rg:function(n,t,i){_a.$3.$K(n,"tx");_a.$3.$K(t,"outboxItemId");_a.$3.$K(i,"mailboxDataContext");var r=this;this.$9B.get_$h5().$Fu(n,_e.$1l.$5h(t.Id),function(u){if(!u){_js.Trace.logWarning(_e.$1n.$A,"Outbox item with id {0} was not found in the client store.",t.Id);return}r.$1ux(n,null,"HardDelete",u,null,i,!0)},null)},$1ux:function(n,t,i,r,u,f,e){_a.$3.$K(n,"tx");_a.$3.$K(f,"mailboxDataContext");e||_a.$3.$K(t,"conversationHelper");_a.$3.$K(r,"messageItem");i==="MoveToDeletedItems"&&_a.$3.$K(u,"deletedItemsFolderId");var o=r.get_$1r();var c=o.IsRead?0:1;var s=new _g.$3R(o.ParentFolderId.Id);var h=_e.$lO.$88w(o,s);if(i==="MoveToDeletedItems"&&o.ParentFolderId.Id!==u.Id){o.ParentFolderId=u;r.$E1(n,null);this.$9B.get_$2r().$5Nr(n,s,1,h);this.$9B.get_$2r().$2QN(n,o.ParentFolderId,1,c)}else{_js.Trace.logInfo(_a.$0.$M6,"Deleting the message with id {0}",o.ItemId.Id);r.$2LZ(n);this.$9B.get_$2r().$5Nr(n,s,1,h)}if(!e&&o.ConversationId){var l=this;t.$4W6(n,o.ConversationId,s,o,f,function(n){})}}};_e.$ZR=function(){};_e.$ZR.$7ly=function(n){var t=new _e.$ZR;t.$1dg=n.inboxFolderId;t.$17n=n.outboxFolderId;t.$PN=n.outboxItemId;t.$Gt=n.parentFolderId;t.$Cv=n.conversationId;t.$Wk=n.parentConversationNodeId;t.$38D=n.itemPartsOrderDescending;return t};_e.$ZR.$7m2=function(n){var t=new _e.$ZR;t.$1dg=n.inboxFolderId;t.$17n=n.outboxFolderId;t.$PN=n.outboxItemId;t.$Gt=n.parentFolderId;t.$Cv=n.conversationId;t.$Wk=n.parentConversationNodeId;t.$38D=n.itemPartsOrderDescending;return t};_e.$ZR.prototype={$1dg:null,$17n:null,$PN:null,$Gt:null,$Cv:null,$Wk:null,$38D:!1,get_inboxFolderId:function(){return this.$1dg},get_outboxFolderId:function(){return this.$17n},get_outboxItemId:function(){return this.$PN},get_parentFolderId:function(){return this.$Gt},get_conversationId:function(){return this.$Cv},get_parentConversationNodeId:function(){return this.$Wk},get_itemPartsOrderDescending:function(){return this.$38D}};_e.$1Ln=function(n){_a.$3.$K(n,"itemStoreGetter");this.$9B=n};_e.$1Ln.prototype={$9B:null};_e.$1EH=function(n){this.$2VW=new _e.$lO(n);this.$2tX=new _e.$C9(n)};_e.$1EH.prototype={$2VW:null,$2tX:null,$3yC:function(){return this.$2VW}};_e.$3t.registerClass("_e.$3t");CoreStorageComponent.registerClass("CoreStorageComponent",null,_a.$1L9);_e.$7q.registerClass("_e.$7q");_e.$5W.registerClass("_e.$5W",null,IAttachmentsCleanupManager);AddressbookPostalAddress.registerClass("AddressbookPostalAddress");AddressbookEmailAddressInfo.registerClass("AddressbookEmailAddressInfo");AddressbookItemMetaData.registerClass("AddressbookItemMetaData");AddressbookPhoneNumberInfo.registerClass("AddressbookPhoneNumberInfo");AddressbookPostalAddressInfo.registerClass("AddressbookPostalAddressInfo");_e.$Oy.registerClass("_e.$Oy");_e.$12q.registerClass("_e.$12q",_e.$Oy);_e.$3Z.registerClass("_e.$3Z");_e.$o9.registerClass("_e.$o9",_e.$3Z);_e.$y.registerClass("_e.$y",null,_bc.$19G);_e.$50.registerClass("_e.$50",_e.$uN.$$(AttachmentInfoRecord),_bc.$qZ,_bc.$19G);ItemMetadata.registerClass("ItemMetadata");AttachmentInfoMetadata.registerClass("AttachmentInfoMetadata",ItemMetadata);_e.$v6.registerClass("_e.$v6",_e.$7t.$$(_bc.$qZ,_e.$50),IAttachmentInfoItemStore,_bc.$19I);_e.$FJ.registerClass("_e.$FJ");_e.$M5.registerClass("_e.$M5");CustomSyncData.registerClass("CustomSyncData");_e.$4W.registerClass("_e.$4W",_a.$R);_e.$4W.prototype.$9S=_a.$R.prototype.$9S;_e.$15y.registerClass("_e.$15y");_e.$CP.registerClass("_e.$CP",_e.$3Z);_e.$Ff.registerClass("_e.$Ff");_e.$8H.registerClass("_e.$8H",_e.$uN.$$(_g.$13a),_bc.$1Kt,_bc.$19G);_e.$ck.registerClass("_e.$ck",_e.$7t.$$(_bc.$1Kt,_e.$8H),_bc.$194,_bc.$19I);_e.$UR.registerClass("_e.$UR",null,_bc.$1Kk);_e.$yv.registerClass("_e.$yv",null,IItemStoreGetterFactory);_e.$By.registerClass("_e.$By",_e.$uN.$$(_g.$7j),_bc.$MS,_bc.$19G);_e.$GW.registerClass("_e.$GW",_e.$By,_bc.$19n,_bc.$MS,_bc.$19G);_e.$1By.registerClass("_e.$1By",_e.$Ug.$$(_bc.$19n,_e.$GW),_bc.$19o,_bc.$19I);_e.$H9.registerClass("_e.$H9",_e.$uN.$$(_g.$fZ),_bc.$e9,_bc.$19G);PersistedDataRecord.registerClass("PersistedDataRecord");_e.$Aa.registerClass("_e.$Aa",_e.$uN.$$(_g.$Od),_bc.$YF,_bc.$19G);_e.$1l.registerClass("_e.$1l",null,_a.$qe);_e.$Gl.registerClass("_e.$Gl",_e.$uN.$$(_g.$3z),_bc.$18Y,_bc.$19G);ActionItemMetadata.registerClass("ActionItemMetadata",ItemMetadata);_e.$6w.registerClass("_e.$6w");_e.$12o.registerClass("_e.$12o",_e.$uN.$$(AddressbookOperation),_bc.$xd,_bc.$19G);_e.$12p.registerClass("_e.$12p",_e.$uN.$$(AddressbookPersona),_bc.$xe,_bc.$19G);_e.$TC.registerClass("_e.$TC",_e.$pO.$$(_bc.$MP));_e.$cl.registerClass("_e.$cl",_e.$pO.$$(_bc.$1Kt));_e.$tH.registerClass("_e.$tH",_e.$pO.$$(_bc.$YF));_e.$64.registerClass("_e.$64",_e.$uN.$$(_g.$6Y),_bc.$MP,_bc.$1Ku,_bc.$19G);CalendarItemMetadata.registerClass("CalendarItemMetadata",ItemMetadata);_e.$Dt.registerClass("_e.$Dt",_e.$uN.$$(_g.$6Y),_bc.$LD,_bc.$1Ku,_bc.$19G);_e.$5h.registerClass("_e.$5h");_e.$5h.$3lJ.registerClass("_e.$5h.$3lJ");_e.$5h.$AIg.registerClass("_e.$5h.$AIg",_e.$5h.$3lJ);_e.$5h.$9yc.registerClass("_e.$5h.$9yc",_e.$5h.$AIg);_e.$5h.$8SL.registerClass("_e.$5h.$8SL",_e.$5h.$AIg);_e.$13l.registerClass("_e.$13l",_e.$3Z);_e.$ay.registerClass("_e.$ay");_e.$1n.registerClass("_e.$1n",null,IClientStore);_e.$TO.registerClass("_e.$TO",_js.$15l,_a.$1L7,Sys.IDisposable);_e.$1g.registerClass("_e.$1g",null,_bc.$1Kv);_e.$M2.registerClass("_e.$M2",_e.$uN.$$(_g.$D7),_bc.$qf,_bc.$19G);_e.$14g.registerClass("_e.$14g",_e.$pO.$$(_bc.$18i));_e.$6s.registerClass("_e.$6s",_e.$uN.$$(_g.$Wj),_bc.$18i,_bc.$19G);_e.$RA.registerClass("_e.$RA",_e.$eP.$$(_bc.$18i,_e.$6s,_g.$Wj),_bc.$18j,_bc.$19I);_e.$eH.registerClass("_e.$eH",null,_e.$1L0);_e.$wA.registerClass("_e.$wA",_e.$eH);_e.$1G.registerClass("_e.$1G",null,_e.$xp);_e.$9D.registerClass("_e.$9D",null,_e.$1Km);_e.$Tv.registerClass("_e.$Tv",_e.$7t.$$(_bc.$1Kt,_e.$8H),_bc.$193,_bc.$19I);_e.$EM.registerClass("_e.$EM",_e.$1l);_e.$EM.prototype.toString=_e.$1l.prototype.toString;FolderItemMetadata.registerClass("FolderItemMetadata",ItemMetadata);_e.$kd.registerClass("_e.$kd",_e.$uN.$$(InlineImageRecord),_bc.$19F,_bc.$19G);_e.$yN.registerClass("_e.$yN",_e.$7t.$$(_bc.$19F,_e.$kd),IInlineImageItemStore,_bc.$19I);_e.$6Z.registerClass("_e.$6Z");_e.$1AG.registerClass("_e.$1AG",null,_e.$y5);_e.$D0.registerClass("_e.$D0",null,_e.$y6);_e.$9H.registerClass("_e.$9H");_e.$1BG.registerClass("_e.$1BG",_e.$pO.$$(_bc.$MS));_e.$zK.registerClass("_e.$zK",_e.$eH);_e.$1BH.registerClass("_e.$1BH",_e.$YP.$$(_bc.$MS,_g.$7j));_e.$lQ.registerClass("_e.$lQ",null,_e.$1IF);_e.$nJ.registerClass("_e.$nJ",null,_e.$1IF);_e.$1BV.registerClass("_e.$1BV",_e.$nJ);_e.$zS.registerClass("_e.$zS",_e.$eH);_e.$2r.registerClass("_e.$2r");_e.$1Bx.registerClass("_e.$1Bx",_e.$pO.$$(_bc.$19n));_e.$Uz.registerClass("_e.$Uz",_e.$pO.$$(_bc.$ym));_e.$Lm.registerClass("_e.$Lm",_e.$uN.$$(SyncState),_bc.$rM,_bc.$19G);_e.$1Fx.registerClass("_e.$1Fx");ConversationItemMetadata.registerClass("ConversationItemMetadata",ItemMetadata);_e.$PN.registerClass("_e.$PN",_e.$uN.$$(_g.$bJ),_bc.$kS,_bc.$19G);_e.$bK.registerClass("_e.$bK",null,_e.$1IF);MessageItemMetadata.registerClass("MessageItemMetadata",ItemMetadata);_e.$lP.registerClass("_e.$lP",_e.$Ug.$$(_bc.$MS,_e.$By),_bc.$19N,_bc.$19I);_e.$2U.registerClass("_e.$2U",_e.$uN.$$(PartialPersonaRecord),_bc.$rC,_bc.$19G);_e.$V9.registerClass("_e.$V9",_e.$pO.$$(_bc.$qf));_e.$1CZ.registerClass("_e.$1CZ",_e.$3Z);_e.$6P.registerClass("_e.$6P",null,_bc.$19q);_e.$ff.registerClass("_e.$ff",_e.$3Z,_e.$yg);ConfigChangeCleanupModuleItem.registerClass("ConfigChangeCleanupModuleItem");MessageItemRecord.registerClass("MessageItemRecord",_g.$7j);_e.$6A.registerClass("_e.$6A",_e.$uN.$$(SettingRecord),_bc.$ym,_bc.$19G);_e.$AE.registerClass("_e.$AE",null,_bc.$1Kq);_e.$Qi.registerClass("_e.$Qi",_e.$uN.$$(_g.$Zk),_bc.$kx,_bc.$19G);_e.$nV.registerClass("_e.$nV",_e.$uN.$$(TombstonedItemRecord),_bc.$1AI,_bc.$19G);_e.$12E.registerClass("_e.$12E",_e.$7t.$$(_bc.$1AI,_e.$nV),_bc.$1AJ,_bc.$19I);_e.$13x.registerClass("_e.$13x",_e.$eH);_e.$82.registerClass("_e.$82",_e.$3Z,_e.$yg);_e.$jD.registerClass("_e.$jD",_a.$Kd);_e.$p1.registerClass("_e.$p1",_e.$3Z);EmailItemSyncState.registerClass("EmailItemSyncState",SyncState);ConversationItemSyncState.registerClass("ConversationItemSyncState",EmailItemSyncState);_e.$bH.registerClass("_e.$bH",_e.$3Z,_e.$yg);_e.$TX.registerClass("_e.$TX",_e.$YP.$$(_bc.$18i,_g.$Wj));_e.$16Y.registerClass("_e.$16Y",_e.$NW.$$(_bc.$1Kt,_g.$13a));MessageItemSyncState.registerClass("MessageItemSyncState",EmailItemSyncState);_e.$Uh.registerClass("_e.$Uh",_e.$YP.$$(_bc.$MS,_g.$7j));_e.$3g.registerClass("_e.$3g",_js.$9,_bc.$1Kl,_js.$yO);_e.$Fv.registerClass("_e.$Fv");_e.$IE.registerClass("_e.$IE",_g.$9M,_g.$1Iy);_e.$l6.registerClass("_e.$l6");_e.$6G.registerClass("_e.$6G",_g.$1Y,_bc.$YC,_g.$1I0,Sys.IDisposable,_bc.$1LQ);_e.$1D3.registerClass("_e.$1D3",_g.$1Le,_g.$1Iy);_e.$tQ.registerClass("_e.$tQ",_e.$Fv);_e.$gR.registerClass("_e.$gR",_e.$Fv);_e.$6M.registerClass("_e.$6M",_e.$3g);_e.$nt.registerClass("_e.$nt");_e.$WN.registerClass("_e.$WN",null,_a.$xh);_e.$xv.registerClass("_e.$xv");_e.$5m.registerClass("_e.$5m",null,_a.$1LV);_e.$5m.$8F6.registerClass("_e.$5m.$8F6",_a.$Zm);_e.$66.registerClass("_e.$66",_a.$Av);_e.$18l.registerClass("_e.$18l",_e.$WN);_e.$Gv.registerClass("_e.$Gv",null,_a.$1LM);_e.$18m.registerClass("_e.$18m",null,_e.$1Ib,_a.$1LS);_e.$Ny.registerClass("_e.$Ny");_e.$18n.registerClass("_e.$18n",_e.$Ny);_e.$18o.registerClass("_e.$18o");_e.$xu.registerClass("_e.$xu",null,_e.$1IT);_e.$xu.$5S1.registerClass("_e.$xu.$5S1",null,_e.$1IR);_e.$2M.registerClass("_e.$2M",null,_e.$1HX,_e.$1Hf);_e.$MQ.registerClass("_e.$MQ",_e.$2M);_e.$xw.registerClass("_e.$xw");_e.$kU.registerClass("_e.$kU",_e.$2M);_e.$18q.registerClass("_e.$18q",_e.$2M);_e.$18r.registerClass("_e.$18r",null,_a.$19s);_e.$18s.registerClass("_e.$18s",null,_a.$19t);_e.$RZ.registerClass("_e.$RZ");_e.$Cy.registerClass("_e.$Cy",_e.$18q);_e.$Cy.$A3Z.registerClass("_e.$Cy.$A3Z");_e.$18t.registerClass("_e.$18t");_e.$qk.registerClass("_e.$qk",null,_a.$1Kp);_e.$18v.registerClass("_e.$18v",_e.$Ny);_e.$Nz.registerClass("_e.$Nz");_e.$xx.registerClass("_e.$xx");_e.$BE.registerClass("_e.$BE",null,_a.$1LV);_e.$BE.$A3m.registerClass("_e.$BE.$A3m",_a.$Zm);_e.$Be.registerClass("_e.$Be",_a.$Av);_e.$n3.registerClass("_e.$n3",_e.$WN);_e.$Di.registerClass("_e.$Di",null,_a.$1LM);_e.$5C.registerClass("_e.$5C",null,_a.$1LS);_e.$F9.registerClass("_e.$F9");_e.$HG.registerClass("_e.$HG");_e.$1F2.registerClass("_e.$1F2",_e.$HG);_e.$1F3.registerClass("_e.$1F3",_e.$HG);_e.$1F4.registerClass("_e.$1F4",_e.$HG);_e.$Fr.registerClass("_e.$Fr",null,_e.$1Hc);_e.$11e.registerClass("_e.$11e",null,_e.$1Ha);_e.$h4.registerClass("_e.$h4",null,_a.$19s);_e.$h5.registerClass("_e.$h5",null,_a.$19t);_e.$Ll.registerClass("_e.$Ll");_e.$8Q.registerClass("_e.$8Q",_js.$15l,_a.$1Kp);_e.$h3.registerClass("_e.$h3",null,_a.$1I9);_e.$1F0.registerClass("_e.$1F0",_a.ISqlResultSet);_e.$1F1.registerClass("_e.$1F1",_a.ISqlResultSetRowList);_e.$n4.registerClass("_e.$n4");_e.$5D.registerClass("_e.$5D",null,_a.$1I8);_e.$1F5.registerClass("_e.$1F5",null,_a.$1I6);_e.$AJ.registerClass("_e.$AJ",_e.$fB.$$(_g.$WB,_g.$uy));_e.$PO.registerClass("_e.$PO",_e.$fB.$$(_g.$Wk,_g.$wH));_e.$19.registerClass("_e.$19",_e.$oR.$$(_g.$bb,_g.$14s));_e.$K.registerClass("_e.$K");_e.$PP.registerClass("_e.$PP",_e.$uT.$$(_g.$14z));_e.$bx.registerClass("_e.$bx",_e.$69.$$(_g.$15S));_e.$IG.registerClass("_e.$IG",_e.$fB.$$(_g.$bm,_g.$15L));_e.$9j.registerClass("_e.$9j",_e.$fB.$$(_g.$bt,_g.$15Q));_e.$AO.registerClass("_e.$AO",_e.$fB.$$(_g.$cH,_g.$160));_e.$AP.registerClass("_e.$AP",_e.$af.$$(_g.$cV,_g.$FV));_e.$B0.registerClass("_e.$B0",_e.$fB.$$(_g.$cW,_g.$16K));_e.$3K.registerClass("_e.$3K",_e.$af.$$(_g.$MH,_g.$9G));_e.$Tq.registerClass("_e.$Tq",_e.$af.$$(_g.$cb,_g.$16M));_e.$Ph.registerClass("_e.$Ph",_e.$fB.$$(_g.$XS,_g.$xK));_e.$Tz.registerClass("_e.$Tz",_e.$69.$$(_g.$16v));_e.$AR.registerClass("_e.$AR",_e.$af.$$(_g.$d2,_g.$kH));_e.$pw.registerClass("_e.$pw",_e.$69.$$(_g.$xJ));_e.$6e.registerClass("_e.$6e",_e.$fB.$$(_g.$Pj,_g.$XV));_e.$Pl.registerClass("_e.$Pl",_e.$69.$$(_g.$xO));_e.$q3.registerClass("_e.$q3",_e.$69.$$(_g.$17c));_e.$17f.registerClass("_e.$17f",_e.$69.$$(_g.$xP));_e.$17h.registerClass("_e.$17h",_e.$af.$$(_g.$dS,_g.$17i));_e.$Mn.registerClass("_e.$Mn",_e.$fB.$$(_g.$f7,_g.$1BU));_e.$8O.registerClass("_e.$8O",_e.$af.$$(_g.$OT,_g.$1CR));_e.$8e.registerClass("_e.$8e");_e.$gu.registerClass("_e.$gu",_e.$69.$$(_g.$1EU));_e.$1Ek.registerClass("_e.$1Ek",_e.$69.$$(_g.$1Em));_e.$77.registerClass("_e.$77",_e.$fB.$$(_g.$iB,_g.$1Gx));_e.$3y.registerClass("_e.$3y",_e.$oR.$$(_g.$iB,_g.$1Gx));_e.$1H1.registerClass("_e.$1H1",_e.$uT.$$(_g.$1H2));_e.$U4.registerClass("_e.$U4",_e.$af.$$(_g.$ML,_g.$xQ));_e.$uW.registerClass("_e.$uW",_e.$af.$$(_g.$iI,_g.$1H3));_e.$1Ln.registerClass("_e.$1Ln");_e.$AL.registerClass("_e.$AL",_e.$1Ln);_e.$C9.registerClass("_e.$C9",_e.$1Ln,_bc.$1LN);_e.$lO.registerClass("_e.$lO",_e.$1Ln,_bc.$1LL);_e.$ZR.registerClass("_e.$ZR");_e.$1EH.registerClass("_e.$1EH",null,_bc.$1LR);_e.$7q.$4ci=-0xffffffffffff;_e.$5W.$A=_a.$0.$3j6;_e.$5W.$w=null;_e.$50.$4C3=new _a.$4w("Data.MessageID");_e.$50.$4C5=new _a.$4w("Data.MessageReceivedDateTime");_e.$50.$3jF=new _a.$4w("Data.AttachmentType");_e.$50.$3jE=new _a.$4w("Metadata.AttachmentTypeAndSyncStatus");CustomSyncData.$1uW="";_e.$4W.$5HQ="ct";_e.$4W.$4gi="tct";_e.$4W.$4gh="tctbtc";_e.$4W.$4gA="tcc";_e.$4W.$4NR="ncc";_e.$4W.$4NS="nccnc";_e.$4W.$4g9="tcnc";_e.$4W.$4NQ="ncnc";_e.$4W.$4gB="tcm";_e.$4W.$4NU="nmc";_e.$4W.$4g7="tcia";_e.$4W.$4NT="noiac";_e.$4W.$4NW="notick";_e.$y.$A=_a.$0.$4df;_e.$y.$2eL=new _a.$4w("Data.SaveMode");_e.$y.$5oF=new _a.$4w("Data.LastModifiedOnClient");_e.$y.$5oK=new _a.$4w("Data.LastSynchronizedToServer");_e.$Aa.$3AJ=200;_e.$Aa.$6EJ=0;_e.$Aa.$4Vx=new _a.$4w("Data.ReminderTime");_e.$Aa.$19v=new _a.$4w("Data.UID");_e.$Gl.$2hN=new _a.$4w("Data.state");_e.$64.$A=_a.$0.$4de;_e.$64.$2Cj=new _a.$4w("Data.Start");_e.$64.$3u1=new _a.$4w("Data.End");_e.$64.$19v=new _a.$4w("Data.UID");_e.$64.$2x0=new _a.$4w("Metadata.DurationInHours");_e.$Dt.$19v=new _a.$4w("Data.UID");_e.$5h.$A=_a.$0.$1c;_e.$1n.$A=_a.$0.$5c;_e.$1n.$7s="UTC";_e.$1g.$3NU=new Sys.EventHandlerList;_e.$1G.$CH="15.00.0342.00";_e.$1G.$w=null;_e.$1G.$1VH=[new _a.$5R(_e.$y.$2eL,1)];_e.$8H.$4N1="";_e.$kd.$5E5=new _a.$4w("Data.Blob");_e.$D0.$7pL=new Array(0);_e.$9H.$QV=new Array(0);_e.$eH.$A=_a.$0.$1Qp;_e.$2r.$yI=-1;_e.$Lm.$5rs=100;_e.$3Z.$A=_a.$0.$4eX;_e.$6s.$7jG="ConversationTopic";_e.$2U.$1wk=new _a.$4w("Data.FolderId.Id");_e.$2U.$3M2=new _a.$4w("Data.Persona.PersonaId.Id");_e.$2U.$3sT=new _a.$4w("Data.Persona.DisplayNameFirstLast");_e.$2U.$1Ck=new _a.$4w("Data.Persona.DisplayNameFirstLastSortKey");_e.$2U.$3sV=new _a.$4w("Data.Persona.DisplayNameLastFirst");_e.$2U.$1Nq=new _a.$4w("Data.Persona.DisplayNameLastFirstSortKey");_e.$2U.$7hv=new _a.$4w("Data.Persona.CompanyName");_e.$2U.$2sr=new _a.$4w("Data.Persona.CompanyNameSortKey");_e.$2U.$8Ek=new _a.$4w("Data.Persona.HomeCity");_e.$2U.$32e=new _a.$4w("Data.Persona.HomeCitySortKey");_e.$2U.$AGA=new _a.$4w("Data.Persona.WorkCity");_e.$2U.$3YU=new _a.$4w("Data.Persona.WorkCitySortKey");_e.$2U.$2uF=new _a.$4w("Data.Persona.CreationTimeString");_e.$2U.$4Vk=new _a.$4w("Data.Persona.RelevanceScore");_e.$6P.$2JS=null;_e.$6P.$4cy=null;_e.$6P.$$cctor();_e.$3g.$A=_a.$0.$Zt;_e.$3g.$2Tv=new _H("LastEnqueuedAction",_g.$3z,_e.$3g);_e.$3g.$2dg=new _H("RequestAvailable",Boolean,_e.$3g,!0);_e.$3g.$2dr=new _H("ResponseAvailable",Boolean,_e.$3g,!0);_e.$3g.$2J6=new _H("CanProcess",Boolean,_e.$3g,!0);_e.$3g.$2Rq=new _H("IsEmpty",Boolean,_e.$3g,!1);_e.$IE.$1jN="OfflineErrorInfo";_e.$6G.$A=_a.$0.$4Nk;_e.$6M.$2h1=[new _a.$If(_a.$4w.$3D,0)];_e.$6M.$6G4=new _a.$8o(_e.$Gl.$2hN,0);_e.$6M.$6G5=new _a.$8P(_e.$6M.$6G4,_e.$6M.$2h1);_e.$6M.$6G6=new _a.$8o(_e.$Gl.$2hN,1);_e.$6M.$6G7=new _a.$8P(_e.$6M.$6G6,_e.$6M.$2h1);_e.$6M.$5BM=new _a.$8P(null,_e.$6M.$2h1);_e.$F9.$17T=_a.$4w.$3D.$5t;_e.$5D.$A=_a.$0.$2hA;_e.$AJ.$A=_a.$0.$1At;_e.$PO.$A=_a.$0.$1P;_e.$19.$A=_a.$0.$3ou;_e.$K.$2br="#";_e.$K.$3sf="DistributionList";_e.$PP.$A=_a.$0.$4a3;_e.$bx.$A=_a.$0.$4a4;_e.$IG.$A=_a.$0.$1P;_e.$9j.$A=_a.$0.$3re;_e.$AO.$A=_a.$0.$M6;_e.$AP.$A=_a.$0.$3vV;_e.$AP.$$cctor();_e.$B0.$A=_a.$0.$3vW;_e.$3K.$A=_a.$0.$11F;_e.$3K.$3He=null;_e.$3K.$$cctor();_e.$Ph.$A=_a.$0.$3xo;_e.$Tz.$A=_a.$0.$3xE;_e.$AR.$A=_a.$0.$3xP;_e.$AR.$$cctor();_e.$pw.$A=_a.$0.$2zx;_e.$6e.$A=_a.$0.$30E;_e.$6e.$$cctor();_e.$Pl.$A=_a.$0.$4a5;_e.$q3.$A=_a.$0.$14g;_e.$Mn.$A=_a.$0.$4M5;_e.$8O.$A=_a.$0.$4a7;_e.$8e.$Wx=null;_e.$8e.$$cctor();_e.$gu.$A=_a.$0.$1mr;_e.$77.$A=_a.$0.$4i8;_e.$3y.$A=_a.$0.$4iI;_e.$U4.$A=_a.$0.$4a6;_e.$uW.$A=_a.$0.$4a8;_e.$AL.$A=_a.$0.$3lA