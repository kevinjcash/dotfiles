Type.registerNamespace("_z");_z.$8T=function(n){this.$$d_$5bM=Function.createDelegate(this,this.$5bM);this.$$d_$9UL=Function.createDelegate(this,this.$9UL);this.$$d_$8BL=Function.createDelegate(this,this.$8BL);this.$$d_$3RY=Function.createDelegate(this,this.$3RY);this.$$d_$42v=Function.createDelegate(this,this.$42v);this.$$d_$82U=Function.createDelegate(this,this.$82U);this.$$d_$88f=Function.createDelegate(this,this.$88f);this.$$d_$86s=Function.createDelegate(this,this.$86s);this.$$d_$F8=Function.createDelegate(this,this.$F8);this.$1Cw=new _b.$uZ;_z.$8T.initializeBase(this,[n]);this.$1Ov=null;this.$2Ot=null;this.$14b=null;this.$ty=null;this.$19L=null;this.$yD=null;this.$lD=null;this.$2C1=!1};function $58Y(n,t){if(n.$13r)if(t){var i=n.get_$H().find("iframe").get(0);$5(i)||$5(i.contentWindow)||$5(i.contentWindow.document)||$5(i.contentWindow.document.documentElement)?_js.Trace.logWarning(_a.$0.$5O,"Editor - BindHtml5Droppable's iframeElement.ContentWindow.Document.DocumentElement is not accessible."):n.$13r.$2IL($(i.contentWindow.document.documentElement)[0])}else{var r=n.get_$H().find("textarea").get(0);r?n.$13r.$2IL($(r)[0]):_js.Trace.logWarning(_a.$0.$5O,"Editor - BindHtml5Droppable's textarea is not accessible.")}}function $58a(n,t){if(n.$13r)if(t){var i=n.get_$H().find("iframe").get(0);i&&i.contentWindow&&i.contentWindow.document&&i.contentWindow.document.documentElement?n.$13r.$4hb($(i.contentWindow.document.documentElement)[0]):_js.Trace.logWarning(_a.$0.$5O,"Editor - UnbindHtml5Droppable's iframeElement.ContentWindow.Document.DocumentElement is not accessible.")}else{var r=n.get_$H().find("textarea").get(0);r?n.$13r.$4hb($(r)[0]):_js.Trace.logWarning(_a.$0.$5O,"Editor - UnbindHtml5Droppable's textarea is not accessible.")}}function $58Z(n,t){n.$XT=new _b.$Dm(t)}function $3gH(n,t){if(!n.$3wk&&n.$XT){var i=n.$XT.$3yO();var r=n.$XT.$3yN();var u=n.$XT.$85H();var f=n.$XT.$85G();n.$3wk=t.offsetParent.offsetHeight-t.offsetTop-i-r-u-f}return n.$3wk}function $7Vv(n,t){if(_d.$r6.isInstanceOfType(t)){var i=t;n.$6U8(i.$z,i.$6Wb)}else if(_d.$sw.isInstanceOfType(t)){var r=t;n.$9kk(r.$z)}else if(_d.$yP.isInstanceOfType(t)){var u=t;n.$9kj(u.$5DJ)}else n.$7wX(t)}function $7Vw(n){_js.Trace.logInfo(_a.$0.$5O,"Editor ResetInsertCommandProperty From null to the insertCommand");$N(n,"ResizeCommand")}_z.$8T.prototype={$Ap:!1,$2C1:!1,$1fI:!1,$2co:null,$CY:null,$6eA:null,$5UX:null,$1Ov:null,$2Ot:null,$14b:null,$7j:!1,$Nd:!1,$19L:null,$ty:null,$vi:!1,$yD:null,$T0:!1,$1O3:null,$E4:null,$1Aq:null,$DO:null,$18f:null,$EW:null,$1zC:null,$3YH:!1,$4bU:!1,$13r:null,$lD:null,$15D:null,$cP:null,$Vr:0,$mX:null,$1jZ:null,$x:null,$1Sx:0,$6E9:0,$4Ld:0,$15R:!1,$XT:null,$ci:!1,$sS:0,$3wk:0,$xP:"0",$3SM:!1,$Y1:null,$LY:!0,$OA:null,get_$9z4:function(){return this.$4bU},set_$9z4:function(n){if(this.$4bU!==n){this.$7am(n);this.$4bU=n}return n},get_$4Wz:function(){return this.$lD},set_$4Wz:function(n){if(!this.$lD){this.$lD=new _C(this.$$d_$F8,this.get_$1a());$N(this,"ResizeCommand")}return n},get_$al:function(){return this.$15D},set_$al:function(n){if(n!==this.$15D){this.$15D=n;$N(this,"InputFiles")}return n},get_$1M5:function(){return this.$cP},set_$1M5:function(n){if(n!==this.$cP){this.$cP=n;$N(this,"Base64ImageContent")}return n},get_$2JZ:function(){return this.$Vr},set_$2JZ:function(n){if(n!==this.$Vr){this.$Vr=n;$N(this,"ClipboardImageSize")}return n},get_$2Ja:function(){return this.$mX},set_$2Ja:function(n){if(n!==this.$mX){this.$mX=n;$N(this,"ClipboardImageType")}return n},get_$CZ:function(){return this.$CY},set_$CZ:function(n){if(n!==this.$CY){this.$CY=n;$N(this,"Content")}return n},get_$3yf:function(){return this.$1Ov},set_$3yf:function(n){if(!this.$1Ov){this.$1Ov=new _C(this.$$d_$86s,this.get_$1a());$N(this,"GetRawContentCommand")}return n},get_$20u:function(){return this.$Ap},set_$20u:function(n){if(this.$Ap!==n){this.$Ap=n;this.$9ki();$N(this,"IsPlainTextContent")}return n},get_$3SU:function(){return this.$2C1},set_$3SU:function(n){this.$2C1!==n&&(this.$2C1=n);return n},get_$88g:function(){return this.$2Ot},set_$88g:function(n){if(!this.$2Ot){this.$2Ot=new _C(this.$$d_$88f,this.get_$1a());$N(this,"GetTextContentCommand")}return n},get_$2O7:function(){return this.$14b},set_$2O7:function(n){if(!this.$14b){this.$14b=new _C(this.$$d_$82U,this.get_$1a());$N(this,"GetContentCommand")}return n},get_$2hT:function(){return this.$19L},set_$2hT:function(n){if(this.$19L!==n){this.$19L=n;$N(this,"StringAttachContent")}return n},get_$2Em:function(){return this.$vi},set_$2Em:function(n){if(this.$vi!==n){this.$vi=n;$N(this,"WasStringAttachments")}return n},get_$5fX:function(){return this.$1zC},set_$5fX:function(n){if(this.$1zC!==n){this.$1zC=n;$N(this,"InsertionContent");this.get_$Gg()||(this.$3YH=!0)}return n},get_$8HJ:function(){return this.$yD},set_$8HJ:function(n){if(!this.$yD){this.$yD=new _C(this.$$d_$42v,this.get_$1a());$N(this,"InsertContentCommand")}return n},get_$4eT:function(){return""},set_$4eT:function(n){this.$6jB(!0,n);return n},get_$4eV:function(){return""},set_$4eV:function(n){this.$6jB(!1,n);return n},get_$1vk:function(){return null},set_$1vk:function(n){return n},get_$D2:function(){return this.$7j},set_$D2:function(n){this.$7j=n;$N(this,"IsInitialized");return n},get_$sD:function(){return this.$Nd},set_$sD:function(n){this.$Nd=n;$N(this,"IsReady");return n},get_$Eb:function(){return this.$1fI},set_$Eb:function(n){if(this.$1fI!==n){this.$1fI=n;if(n&&this.get_$Z()){var t=this.get_$Z().$d.get_$3w();(t===1||t===2||t===3)&&this.$9qJ()}}return n},get_$1IG:function(){return this.$2co},set_$1IG:function(n){this.$2co=n;_js.$8.$a(this.$2co)||this.$1fI||this.$9x9();return n},get_$3y3:function(){return this.$Y1},set_$3y3:function(n){if(n!==this.$Y1){this.$Y1=n;$N(this,"GetLinkPreviewRequest")}return n},get_$22M:function(){return null},set_$22M:function(n){n&&this.$8HM(n);return n},get_$1AC:function(){return this.$OA},set_$1AC:function(n){if(n!==this.$OA){this.$OA=n;$N(this,"YouTubePlayerAnchorClicked")}return n},get_$2re:function(){return null},set_$2re:function(n){n&&$7Vv(this,n);return n},get_$204:function(){return this.$15R},set_$204:function(n){if(n!==this.$15R){this.$15R=n;$N(this,"IsExtendable")}return n},get_$5R5:function(){return this.$xP},set_$5R5:function(n){if(this.$xP!==n){this.$xP=n;$N(this,"EditorTabIndex")}return n},get_$1Q:function(){_js.Trace.logWarning(_a.$0.$5O,"AbstractEditor.Text does not have an implementation for get Text(), inheriting classes can override this if needed.");return""},set_$1Q:function(n){_js.Trace.logWarning(_a.$0.$5O,"AbstractEditor.Text does not have an implementation for set Text(), inheriting classes can override this if needed.");return n},get_$pR:function(){return this.$6eA},set_$pR:function(n){this.$6eA=n;return n},get_$1wj:function(){return this.$5UX},set_$1wj:function(n){this.$5UX=n;return n},get_$2D1:function(){return!1},$FZ:function(){this.$T0=!0},$l1:function(){this.$T0=!1},$TZ:function(){},$42v:function(){if(_js.$8.$a(this.$1zC)){_js.Trace.logInfo(_a.$0.$5O,"Attempt to insert empty content, operation ignored.");return}if(this.get_$Gg())this.$3YH=!1;else{this.$3YH=!0;return}this.$6U8(this.$1zC,!1)},$6jB:function(n,t){this.$9kl(n,t)},$F8:function(){_js.Trace.logWarning(_a.$0.$5O,"AbstractEditor.Resize does not have an implementation for Resize(), inheriting classes can override this if needed.")},$AAY:function(n){_js.Trace.logWarning(_a.$0.$5O,"AbstractEditor.UnbindCommands does not have an implementation for UnbindCommands(), inheriting classes can override this if needed.")},$5Dz:function(n){_js.Trace.logWarning(_a.$0.$5O,"AbstractEditor.BindCommands does not have an implementation for BindCommands(), inheriting classes can override this if needed.")},$LQ:function(){_js.Trace.logWarning(_a.$0.$5O,"AbstractEditor.Focus is not implemented");return!1},$9vW:function(n){this.$13r=n},$9LX:function(){},$9LW:function(){},$9TB:function(n){n.dataTransfer.dropEffect=this.$1Cw.$2x("move",null)},$9T9:function(n){n.dataTransfer.dropEffect=this.$1Cw.$2x("move",null)},$9TA:function(n){n.dataTransfer.dropEffect=this.$1Cw.$2x("move",null)},$9TD:function(n,t){var i=!1;t.val=!1;if(!$5(n)&&!$5(n.dataTransfer)){var u=n.dataTransfer;var r=n.dataTransfer.getData("Text");if(_js.$8.$15(r))if(_a.UserAgent.getInstance().get_$2NG()){if(!$5(u.files)){this.set_$al(new _h.$X7(u.files));if(this.$1jZ){this.$1jZ.$s();t.val=!0}i=!0}}else{_js.Trace.logInfo(_a.$0.$5O,"Your browser does not support FileAPI, so drag-and-drop functionality is not available.");if(this.$x){this.$x.$5Z(680);this.$x.$2j(680)}i=!0}else if(this.$ty&&r.startsWith("{")&&r.endsWith("}")){this.set_$2hT(r);this.$ty.$s();i=this.$vi;t.val=i;this.set_$2Em(!1)}}return i},$9qJ:function(){},$9kk:function(n){},$9kj:function(n){},$9kl:function(n,t){},$7am:function(n){},$9ki:function(){},$9x9:function(){},$7wX:function(n){},$8HM:function(n){},$5bM:function(n){this.$3RY()},$9UL:function(n){var t=new _a.$AG(n);if(t&&!!(t.get_$6R()===9&!t.$M7())){this.set_$5fX("    ");this.$42v();t.$AE()}this.$3RY()},$4Oe:function(){_js.Trace.logInfo(_a.$0.$5O,"Editor - DataContextUpdated");_js.$D.prototype.$4Oe.call(this);if(!this.get_$Z()){this.$14b=null;this.$1Ov=null;this.$yD=null}$7Vw(this)},$Hw:function(){this.$3YH&&this.$42v();_js.$5.prototype.$Hw.call(this)},$49:function(){_js.$D.prototype.$49.call(this);if(this.$13r){this.$13r.$1R();this.$13r=null}},$8BL:function(n){_js.$J.get_$I().$1s(_a.$0.$5O,"HandleHeightEvent",this.$$d_$3RY,0)}};_z.$8G=function(n,t,i){this.$$d_$8B4=Function.createDelegate(this,this.$8B4);this.$$d_$5bM=Function.createDelegate(this,this.$5bM);this.$$d_$5bG=Function.createDelegate(this,this.$5bG);_z.$8G.initializeBase(this,[n]);this.$B=t;this.$109=null;this.$9f=$(window.document.createElement("Textarea"));$58Z(this,this.$9f);var r=this;this.$9f.change(function(n){$7Vx(r)});this.$9f.addClass("textarea");this.get_$H().append(this.$9f);this.set_$204(!0);this.$5bH=new _C(this.$$d_$5bG,this.get_$1a());this.$1B6=i};_z.$8G.$5l0=function(n){var t=n.instance;if(n.newValue){t.$9f.attr("readonly","true");t.$9f.addClass("textboxDisabled")}else{t.$9f.removeAttr("readonly");t.$9f.removeClass("textboxDisabled")}};function $7Vx(n){n.$109&&n.$109.$s()}function $58b(n){n.$9f.unbind("paste");n.$9f.unbind("cut");n.$9f.unbind("keyup");n.$9f.unbind("keydown");_a.UserAgent.getInstance().$9W&&n.$9f.unbind("beforedeactivate")}function $58c(n,t){n.$9f.val(t);n.set_$CZ(t);n.$3RY()}function $3gI(n){if(!n.$284){n.$284=n.$9f.css("height");_js.Trace.logInfo(_a.$0.$5O,"ExtendableEditor get original height "+n.$284)}}_z.$8G.prototype={$109:null,$mK:null,$9f:null,$RE:null,$EX:null,$2xg:!1,$5bH:null,$1PC:!1,$B:null,$284:null,$1b3:!1,$2LO:!1,$4XO:!1,$1B6:null,get_$Cc:function(){return this.$W(_z.$8G.$213)},set_$Cc:function(n){this.$M(_z.$8G.$213,n);return n},get_$JX:function(){return this.$W(_z.$8G.$2BY)},set_$JX:function(n){this.$M(_z.$8G.$2BY,n);return n},get_$6IW:function(){return this.$109},set_$6IW:function(n){if(this.$109!==n){this.$109=n;$N(this,"OnContentChangedCommand")}return n},get_$3NY:function(){return this.$CY},set_$3NY:function(n){if(n!==this.$CY){$58c(this,n);$AO(this,"RawContent","TextContent")}return n},get_$6k0:function(){return this.$CY},set_$6k0:function(n){n!==this.$CY&&$58c(this,n);return n},get_$1vk:function(){return this.$RE},set_$1vk:function(n){if(this.$RE!==n){if(this.$RE&&this.$RE.length>0)for(var r=this.$RE.split(" "),t=0;t<r.length;t++)this.$9f.removeClass(r[t]);this.$RE=n;if(this.$RE&&this.$RE.length>0)for(var u=this.$RE.split(" "),i=0;i<u.length;i++)this.$9f.addClass(u[i]);"TouchNarrow"===this.$B.get_$L()&&this.$9f.css("line-height",String.format("23{0}","px"));$N(this,"EditorCssClass")}return n},get_$J5:function(){return this.$EX},set_$J5:function(n){this.$EX=n;$N(this,"EnterCommand");return n},get_$7vk:function(){return this.$2xg},set_$7vk:function(n){this.$2xg=n;$N(this,"EnterWithoutLineBreak");return n},$3RY:function(){if(this.$15R)if(this.$T0&&this.$XT&&this.get_$Z()&&!this.get_$Z().$jf){this.$ci=!1;$3gI(this);var n;var t=!1;if(this.$sS){n=this.$XT.$3yn();_js.Trace.logInfo(_a.$0.$5O,"ExtendableEditor get current scroll height "+n.toString()+", last scroll height "+this.$sS.toString())}else{this.$sS=this.$XT.$3yn();n=this.$sS;t=!0;_js.Trace.logInfo(_a.$0.$5O,"ExtendableEditor get current scroll height and setup last scroll height to "+n.toString())}if(n){if(n!==this.$sS||t){var i=this.$XT.$3yO();var r=this.$XT.$3yN();var u=n-i-r;this.$9f.css("height",u+"px");_js.Trace.logInfo(_a.$0.$5O,"ExtendableEditor set new height "+u.toString()+" = Scroll height "+n.toString()+" - padding top "+i.toString()+" - padding bottom "+r.toString());this.$sS=n}}else{this.$ci=!0;_js.Trace.logInfo(_a.$0.$5O,"ExtendableEditor has scroll height 0, which means it is not visible yet, set the deferred set height flag.")}}else{this.$ci=!0;_js.Trace.logInfo(_a.$0.$5O,"Remember a deferred request to set height")}else _js.Trace.logInfo(_a.$0.$5O,"Skip SetHeight since the ExtendableEditor is not extendable")},$F8:function(){if(!this.$3SM){var i=this.$XT.$3yn();var r=this.$XT.$3yO();var u=this.$XT.$3yN();var t=i-r-u;var n=-1;switch(this.$B.get_$L()){case"TouchWide":n=this.$6E9;break;case"TouchNarrow":n=this.$4Ld;break;default:throw Error.argument("Current layout","Unsupported layout: "+this.$B.get_$L());}t<n&&(t=n);$3gI(this);this.$9f.css("height",t+"px")}},$FZ:function(){_js.Trace.logInfo(_a.$0.$l,"ExtendableEditor.PostTransitionIn");_z.$8T.prototype.$FZ.call(this);this.$4au();if(_a.UserAgent.getInstance().$Cs.get_$3r()===5||_a.UserAgent.getInstance().$Cs.get_$3r()===3&&_y.$x.$w.get_$L()!=="Mouse"){var n=this;_js.$J.get_$I().$1s(_a.$0.$l,"RemoveBodyFocusHandler",function(){n.$3RX()},500)}else this.$3RX();this.$ci&&this.$3RY()},$LQ:function(){this.$9f.focus();return!0},$7d6:function(){this.$9f.blur()},$4au:function(){if(!this.$1PC){this.$9f.bind("paste",this.$$d_$8BL);this.$9f.bind("cut",this.$$d_$8BL);this.$9f.keydown(this.$$d_$9UL);this.$9f.keyup(this.$$d_$5bM);_a.UserAgent.getInstance().$9W&&this.$9f.bind("beforedeactivate",this.$$d_$8B4);this.$1PC=!0}},$3RX:function(){var n=this.$9f?this.$9f[0]:null;if(this.$4XO||this.$2LO){_js.Trace.logInfo(_a.$0.$5O,"Skipping set full screen height and reset deferred set full screen height since we have already restored original height or has a deferred restore.");this.$1b3=!1}else if(n&&n.offsetParent&&this.$XT){this.$1b3=!1;$3gI(this);var t=$3gH(this,n);this.$9f.css("height",t+"px");_js.Trace.logInfo(_a.$0.$5O,"Set full screen height "+t);this.$sS=0;this.$3RY()}else{_js.Trace.logInfo(_a.$0.$5O,"Skipping set height to full screen, set deferred flag");this.$1b3=!0}},$9qJ:function(){this.$1b3=!1;if(this.$9f&&this.$284&&this.$T0&&this.get_$Z()&&!this.get_$Z().$jf){this.$2LO=!1;this.$4XO=!0;_js.Trace.logInfo(_a.$0.$5O,"Restore to original height "+this.$284);this.$9f.css("height",this.$284);this.$sS=0;this.$3RY()}else{this.$2LO=!0;_js.Trace.logInfo(_a.$0.$5O,"Skip restore to original height")}},$Hw:function(){_z.$8T.prototype.$Hw.call(this);this.set_$MC(2);this.$T0&&this.$4au();this.get_$JX()&&this.$LQ();this.$2LO?this.$9qJ():this.$1b3&&this.$3RX();this.$ci&&this.$3RY();this.$9f&&!_js.$8.$a(this.$1O3)&&this.$9f.attr("aria-label",this.$1O3);if(this.$9f&&this.$xP){var n=this.$9f.get(0);var t=parseInt(this.$xP);n.tabIndex=t}this.set_$D2(!0)},$JR:function(){$58b(this);this.set_$D2(!1);this.$1PC=!1;this.$4XO=!1;this.$1b3=!1;this.get_$Z()&&_d.$Ao.isInstanceOfType(this.get_$Z())&&this.$B&&"TouchNarrow"===this.$B.get_$L()&&this.get_$Z().$9qQ()},$5bM:function(n){if(!this.$2xg&&this.$EX&&this.$EX.$2T){var t=new _a.$AG(n);t.get_$6R()!==13||t.$M7()||this.$5bG()}this.get_$Z()&&_d.$Ao.isInstanceOfType(this.get_$Z())&&this.$B&&"TouchNarrow"===this.$B.get_$L()&&this.get_$Z().$9gB();_z.$8T.prototype.$5bM.call(this,n)},$8B4:function(n){$5(window.document.selection)||(this.$mK=document.selection.createRange())},$49:function(){$58b(this);this.$1PC=!1;_z.$8T.prototype.$49.call(this)},$6U8:function(n,t){var r;var u;var f=this.$9f.val();if($5(window.document.selection)){r=this.$9f.prop("selectionStart");u=t?this.$9f.prop("selectionEnd"):r;this.$9f.val(f.substring(0,r)+n+f.substr(u));this.$9f.get(0).focus();if(t){var e=r+n.length;this.$9f.prop("selectionStart",e);this.$9f.prop("selectionEnd",e)}}else{this.$9f.get(0).focus();var i=this.$mK;if(!i)if(document.selection.type!=="None")i=document.selection.createRange();else{var o=this.$9f.get(0);i=o.createTextRange();i.collapse(!1)}var s=i.duplicate();i.text=n;i.collapse(!0);i.moveToBookmark(s.getBookmark());try{i.select()}catch(h){_js.Trace.logException(this.get_$1a(),h,"Failed to select range")}}this.$86s();this.$3RY()},$88f:function(){this.$82U()},$86s:function(){this.$82U()},$82U:function(){this.set_$CZ(this.$9f.val());$N(this,"RawContent");$N(this,"TextContent")},$cv:function(){if(!this.$2xg)return _js.$D.prototype.$cv.call(this);var n=new _o365c.$O;n.set_$Q("ENTER");n.$26=0;n.$5J=this.$5bH;n.$Ws=!0;var t=new _o365c.$1R;t.set_$22([n]);return[t]},$9kj:function(n){this.$1B6&&this.$1B6.$1s4&&this.$9kk(this.$1B6.$1s4.$5Ea(n))},$9kk:function(n){var t=this.$9f.val();var i=this.$9f.prop("selectionStart");var r=this.$9f.prop("selectionEnd");this.$9f.val(n+t);this.$9f.prop("selectionStart",i+n.length);this.$9f.prop("selectionEnd",r+n.length);this.$86s();this.$3RY()},$5bG:function(){if(this.$EX&&this.$EX.$2T){var n=this.$9f.val();_js.$8.$a(n)||(n=n.trimEnd());this.set_$CZ(n);this.$EX.$s();this.$9f.val("")}}};_z.$8T.registerClass("_z.$8T",_js.$5,_b.$19D);_z.$8G.registerClass("_z.$8G",_z.$8T);_z.$8G.$213=new _H("IsReadOnly",Boolean,_z.$8G,!1,_z.$8G.$5l0,null);_z.$8G.$2BY=new _H("SetFocusOnActive",Boolean,_z.$8G)